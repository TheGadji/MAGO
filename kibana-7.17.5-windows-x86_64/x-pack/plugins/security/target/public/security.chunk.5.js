/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.security_bundle_jsonpfunction=window.security_bundle_jsonpfunction||[]).push([[5],{207:function(e,t,i){switch(window.__kbnThemeTag__){case"v7dark":return i(208);case"v7light":return i(210);case"v8dark":return i(212);case"v8light":return i(214)}},208:function(e,t,i){var o=i(15),n=i(209);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var s={insert:"head",singleton:!1};o(n,s);e.exports=n.locals||{}},209:function(e,t,i){var o=i(16),n=i(57),s=i(59),a=i(60);t=o(!1);var r=n(s),l=n(a);t.push([e.i,".loginWelcome{position:fixed;top:0;left:0;right:0;bottom:0;z-index:10000;background:inherit;background-color:#141519;opacity:0;overflow:auto;animation:kibanaFullScreenGraphics_FadeIn 500ms cubic-bezier(0.694, 0.0482, 0.335, 1) 0s forwards}.kbnBody--hasHeaderBanner .loginWelcome{top:32px}.loginWelcome::before{position:absolute;top:0;left:0;z-index:1;width:310px;height:477px;content:url("+r+")}.loginWelcome::after{position:fixed;bottom:0;right:0;z-index:1;width:313px;height:461px;content:url("+l+")}@keyframes kibanaFullScreenGraphics_FadeIn{from{opacity:0}to{opacity:1}}.loginWelcome__header{position:relative;padding:32px;z-index:10}.loginWelcome__logo{display:inline-block;width:80px;height:80px;line-height:80px;text-align:center;background-color:#1D1E24;border-radius:100%;padding:16px;box-shadow:0 6px 12px -1px rgba(0,0,0,0.2),0 4px 4px -1px rgba(0,0,0,0.2),0 2px 2px 0 rgba(0,0,0,0.2);margin-bottom:32px}.loginWelcome__logo .euiIcon{vertical-align:baseline}.loginWelcome__content{position:relative;margin:auto;max-width:460px;padding-left:32px;padding-right:32px;z-index:10}.loginWelcome__content.loginWelcome__contentDisabledForm{max-width:700px}\n",""]),e.exports=t},210:function(e,t,i){var o=i(15),n=i(211);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var s={insert:"head",singleton:!1};o(n,s);e.exports=n.locals||{}},211:function(e,t,i){var o=i(16),n=i(57),s=i(61),a=i(62);t=o(!1);var r=n(s),l=n(a);t.push([e.i,".loginWelcome{position:fixed;top:0;left:0;right:0;bottom:0;z-index:10000;background:inherit;background-color:#fafbfd;opacity:0;overflow:auto;animation:kibanaFullScreenGraphics_FadeIn 500ms cubic-bezier(0.694, 0.0482, 0.335, 1) 0s forwards}.kbnBody--hasHeaderBanner .loginWelcome{top:32px}.loginWelcome::before{position:absolute;top:0;left:0;z-index:1;width:310px;height:477px;content:url("+r+")}.loginWelcome::after{position:fixed;bottom:0;right:0;z-index:1;width:313px;height:461px;content:url("+l+")}@keyframes kibanaFullScreenGraphics_FadeIn{from{opacity:0}to{opacity:1}}.loginWelcome__header{position:relative;padding:32px;z-index:10}.loginWelcome__logo{display:inline-block;width:80px;height:80px;line-height:80px;text-align:center;background-color:#fff;border-radius:100%;padding:16px;box-shadow:0 6px 12px -1px rgba(152,162,179,0.2),0 4px 4px -1px rgba(152,162,179,0.2),0 2px 2px 0 rgba(152,162,179,0.2);margin-bottom:32px}.loginWelcome__logo .euiIcon{vertical-align:baseline}.loginWelcome__content{position:relative;margin:auto;max-width:460px;padding-left:32px;padding-right:32px;z-index:10}.loginWelcome__content.loginWelcome__contentDisabledForm{max-width:700px}\n",""]),e.exports=t},212:function(e,t,i){var o=i(15),n=i(213);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var s={insert:"head",singleton:!1};o(n,s);e.exports=n.locals||{}},213:function(e,t,i){var o=i(16),n=i(57),s=i(59),a=i(60);t=o(!1);var r=n(s),l=n(a);t.push([e.i,".loginWelcome{position:fixed;top:0;left:0;right:0;bottom:0;z-index:10000;background:inherit;background-color:#141519;opacity:0;overflow:auto;animation:kibanaFullScreenGraphics_FadeIn 500ms cubic-bezier(0.694, 0.0482, 0.335, 1) 0s forwards}.kbnBody--hasHeaderBanner .loginWelcome{top:32px}.loginWelcome::before{position:absolute;top:0;left:0;z-index:1;width:310px;height:477px;content:url("+r+")}.loginWelcome::after{position:fixed;bottom:0;right:0;z-index:1;width:313px;height:461px;content:url("+l+")}@keyframes kibanaFullScreenGraphics_FadeIn{from{opacity:0}to{opacity:1}}.loginWelcome__header{position:relative;padding:32px;z-index:10}.loginWelcome__logo{display:inline-block;width:80px;height:80px;line-height:80px;text-align:center;background-color:#1D1E24;border-radius:100%;padding:16px;box-shadow:0 0.9px 4px -1px rgba(0,0,0,0.2),0 2.6px 8px -1px rgba(0,0,0,0.15),0 5.7px 12px -1px rgba(0,0,0,0.125),0 15px 15px -1px rgba(0,0,0,0.1);margin-bottom:32px}.loginWelcome__logo .euiIcon{vertical-align:baseline}.loginWelcome__content{position:relative;margin:auto;max-width:460px;padding-left:32px;padding-right:32px;z-index:10}.loginWelcome__content.loginWelcome__contentDisabledForm{max-width:700px}\n",""]),e.exports=t},214:function(e,t,i){var o=i(15),n=i(215);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var s={insert:"head",singleton:!1};o(n,s);e.exports=n.locals||{}},215:function(e,t,i){var o=i(16),n=i(57),s=i(61),a=i(62);t=o(!1);var r=n(s),l=n(a);t.push([e.i,".loginWelcome{position:fixed;top:0;left:0;right:0;bottom:0;z-index:10000;background:inherit;background-color:#fafbfd;opacity:0;overflow:auto;animation:kibanaFullScreenGraphics_FadeIn 500ms cubic-bezier(0.694, 0.0482, 0.335, 1) 0s forwards}.kbnBody--hasHeaderBanner .loginWelcome{top:32px}.loginWelcome::before{position:absolute;top:0;left:0;z-index:1;width:310px;height:477px;content:url("+r+")}.loginWelcome::after{position:fixed;bottom:0;right:0;z-index:1;width:313px;height:461px;content:url("+l+")}@keyframes kibanaFullScreenGraphics_FadeIn{from{opacity:0}to{opacity:1}}.loginWelcome__header{position:relative;padding:32px;z-index:10}.loginWelcome__logo{display:inline-block;width:80px;height:80px;line-height:80px;text-align:center;background-color:#fff;border-radius:100%;padding:16px;box-shadow:0 0.9px 4px -1px rgba(0,0,0,0.08),0 2.6px 8px -1px rgba(0,0,0,0.06),0 5.7px 12px -1px rgba(0,0,0,0.05),0 15px 15px -1px rgba(0,0,0,0.04);margin-bottom:32px}.loginWelcome__logo .euiIcon{vertical-align:baseline}.loginWelcome__content{position:relative;margin:auto;max-width:460px;padding-left:32px;padding-right:32px;z-index:10}.loginWelcome__content.loginWelcome__contentDisabledForm{max-width:700px}\n",""]),e.exports=t},216:function(e,t,i){switch(window.__kbnThemeTag__){case"v7dark":return i(217);case"v7light":return i(219);case"v8dark":return i(221);case"v8light":return i(223)}},217:function(e,t,i){var o=i(15),n=i(218);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var s={insert:"head",singleton:!1};o(n,s);e.exports=n.locals||{}},218:function(e,t,i){(t=i(16)(!1)).push([e.i,".secLoginCard{display:block;box-shadow:none;padding:16px;text-align:left;width:100%}.secLoginCard:hover .secLoginCard__title{text-decoration:underline}.secLoginCard:disabled{pointer-events:none}.secLoginCard:not(.secLoginCard-isLoading):disabled .secLoginCard__title,.secLoginCard:not(.secLoginCard-isLoading):disabled .secLoginCard__hint{color:#535966}.secLoginCard:focus{animation:350ms cubic-bezier(0.694, 0.0482, 0.335, 1) 1 normal forwards focusRingAnimate !important;border-color:transparent;border-radius:4px}.secLoginCard:focus .secLoginCard__title{text-decoration:underline}.secLoginCard:focus+.secLoginCard{border-color:transparent}.secLoginCard+.secLoginCard{border-top:1px solid #343741}.secLoginCard__hint{font-size:12px;font-size:.75rem;line-height:1.5;color:#98A2B3;margin-top:4px}.secLoginAssistanceMessage{margin-top:-48px;padding:0 16px}\n",""]),e.exports=t},219:function(e,t,i){var o=i(15),n=i(220);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var s={insert:"head",singleton:!1};o(n,s);e.exports=n.locals||{}},220:function(e,t,i){(t=i(16)(!1)).push([e.i,".secLoginCard{display:block;box-shadow:none;padding:16px;text-align:left;width:100%}.secLoginCard:hover .secLoginCard__title{text-decoration:underline}.secLoginCard:disabled{pointer-events:none}.secLoginCard:not(.secLoginCard-isLoading):disabled .secLoginCard__title,.secLoginCard:not(.secLoginCard-isLoading):disabled .secLoginCard__hint{color:#98A2B3}.secLoginCard:focus{animation:350ms cubic-bezier(0.694, 0.0482, 0.335, 1) 1 normal forwards focusRingAnimate !important;border-color:transparent;border-radius:4px}.secLoginCard:focus .secLoginCard__title{text-decoration:underline}.secLoginCard:focus+.secLoginCard{border-color:transparent}.secLoginCard+.secLoginCard{border-top:1px solid #D3DAE6}.secLoginCard__hint{font-size:12px;font-size:.75rem;line-height:1.5;color:#69707D;margin-top:4px}.secLoginAssistanceMessage{margin-top:-48px;padding:0 16px}\n",""]),e.exports=t},221:function(e,t,i){var o=i(15),n=i(222);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var s={insert:"head",singleton:!1};o(n,s);e.exports=n.locals||{}},222:function(e,t,i){(t=i(16)(!1)).push([e.i,".secLoginCard{display:block;box-shadow:none;padding:16px;text-align:left;width:100%}.secLoginCard:hover .secLoginCard__title{text-decoration:underline}.secLoginCard:disabled{pointer-events:none}.secLoginCard:not(.secLoginCard-isLoading):disabled .secLoginCard__title,.secLoginCard:not(.secLoginCard-isLoading):disabled .secLoginCard__hint{color:#535966}.secLoginCard:focus{outline:2px solid currentColor;border-color:transparent;border-radius:6px}.secLoginCard:focus:focus-visible{outline-style:auto}.secLoginCard:focus:not(:focus-visible){outline:none}.secLoginCard:focus .secLoginCard__title{text-decoration:underline}.secLoginCard:focus+.secLoginCard{border-color:transparent}.secLoginCard+.secLoginCard{border-top:1px solid #343741}.secLoginCard__hint{font-size:12px;font-size:.85714rem;line-height:1.14286rem;color:#98A2B3;margin-top:4px}.secLoginAssistanceMessage{margin-top:-48px;padding:0 16px}\n",""]),e.exports=t},223:function(e,t,i){var o=i(15),n=i(224);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var s={insert:"head",singleton:!1};o(n,s);e.exports=n.locals||{}},224:function(e,t,i){(t=i(16)(!1)).push([e.i,".secLoginCard{display:block;box-shadow:none;padding:16px;text-align:left;width:100%}.secLoginCard:hover .secLoginCard__title{text-decoration:underline}.secLoginCard:disabled{pointer-events:none}.secLoginCard:not(.secLoginCard-isLoading):disabled .secLoginCard__title,.secLoginCard:not(.secLoginCard-isLoading):disabled .secLoginCard__hint{color:#98A2B3}.secLoginCard:focus{outline:2px solid currentColor;border-color:transparent;border-radius:6px}.secLoginCard:focus:focus-visible{outline-style:auto}.secLoginCard:focus:not(:focus-visible){outline:none}.secLoginCard:focus .secLoginCard__title{text-decoration:underline}.secLoginCard:focus+.secLoginCard{border-color:transparent}.secLoginCard+.secLoginCard{border-top:1px solid #D3DAE6}.secLoginCard__hint{font-size:12px;font-size:.85714rem;line-height:1.14286rem;color:#69707D;margin-top:4px}.secLoginAssistanceMessage{margin-top:-48px;padding:0 16px}\n",""]),e.exports=t},306:function(e,t,i){"use strict";i.r(t),i.d(t,"LoginPage",(function(){return login_page_LoginPage})),i.d(t,"renderLoginPage",(function(){return O}));var o=i(1),n=i.n(o),s=(i(207),i(4)),a=i(50),r=i.n(a),l=i(3),c=i(7),d=i.n(c),g=i(12),u=i(2),p=i(8),x=i(9),h=i(24),m=i.n(h),b=(i(216),i(99)),f=i.n(b);class validate_login_LoginValidator{constructor(e={}){n()(this,"shouldValidate",void 0),this.shouldValidate=e.shouldValidate}enableValidation(){this.shouldValidate=!0}disableValidation(){this.shouldValidate=!1}validateUsername(e){return this.shouldValidate?e?{isInvalid:!1}:j(u.i18n.translate("xpack.security.authentication.login.validateLogin.requiredUsernameErrorMessage",{defaultMessage:"Username is required"})):{isInvalid:!1}}validatePassword(e){return this.shouldValidate?e?{isInvalid:!1}:j(u.i18n.translate("xpack.security.authentication.login.validateLogin.requiredPasswordErrorMessage",{defaultMessage:"Password is required"})):{isInvalid:!1}}validateForLogin(e,t){const{isInvalid:i}=this.validateUsername(e),{isInvalid:o}=this.validatePassword(t);return i||o?j():{isInvalid:!1}}}function j(e){return{isInvalid:!0,error:e}}var L,v=i(0);let _,y;!function(e){e[e.None=0]="None",e[e.Form=1]="Form",e[e.Selector=2]="Selector",e[e.AutoLogin=3]="AutoLogin"}(L||(L={})),function(e){e[e.None=0]="None",e[e.Info=1]="Info",e[e.Danger=2]="Danger"}(_||(_={})),function(e){e[e.Selector=0]="Selector",e[e.Form=1]="Form",e[e.LoginHelp=2]="LoginHelp"}(y||(y={}));class login_form_LoginForm extends l.Component{constructor(e){var t;super(e),n()(this,"validator",void 0),n()(this,"suggestedProvider",void 0),n()(this,"renderLoginAssistanceMessage",(()=>this.props.loginAssistanceMessage?Object(v.jsx)("div",{"data-test-subj":"loginAssistanceMessage",className:"secLoginAssistanceMessage"},Object(v.jsx)(s.EuiHorizontalRule,{size:"half"}),Object(v.jsx)(s.EuiText,{size:"xs"},Object(v.jsx)(f.a,null,this.props.loginAssistanceMessage))):null)),n()(this,"renderMessage",(()=>{const{message:e}=this.state;return e.type===_.Danger?Object(v.jsx)(l.Fragment,null,Object(v.jsx)(s.EuiCallOut,{size:"s",color:"danger","data-test-subj":"loginErrorMessage",title:e.content,role:"alert"}),Object(v.jsx)(s.EuiSpacer,{size:"l"})):e.type===_.Info?Object(v.jsx)(l.Fragment,null,Object(v.jsx)(s.EuiCallOut,{size:"s",color:"primary","data-test-subj":"loginInfoMessage",title:e.content,role:"status"}),Object(v.jsx)(s.EuiSpacer,{size:"l"})):null})),n()(this,"renderLoginForm",(()=>{const e=this.showLoginSelector()?Object(v.jsx)(s.EuiFlexItem,{grow:!1},Object(v.jsx)(s.EuiButtonEmpty,{"data-test-subj":"loginBackToSelector",size:"xs",onClick:()=>this.onPageModeChange(y.Selector)},Object(v.jsx)(p.FormattedMessage,{id:"xpack.security.loginPage.loginSelectorLinkText",defaultMessage:"More login options"}))):null;return Object(v.jsx)(s.EuiPanel,{"data-test-subj":"loginForm"},Object(v.jsx)("form",{onSubmit:this.submitLoginForm},Object(v.jsx)(s.EuiFormRow,m()({label:Object(v.jsx)(p.FormattedMessage,{id:"xpack.security.login.basicLoginForm.usernameFormRowLabel",defaultMessage:"Username"})},this.validator.validateUsername(this.state.username)),Object(v.jsx)(s.EuiFieldText,{autoComplete:"off",id:"username",name:"username","data-test-subj":"loginUsername",value:this.state.username,onChange:this.onUsernameChange,disabled:!this.isLoadingState(L.None),isInvalid:!1,"aria-required":!0,inputRef:this.setUsernameInputRef})),Object(v.jsx)(s.EuiFormRow,m()({label:Object(v.jsx)(p.FormattedMessage,{id:"xpack.security.login.basicLoginForm.passwordFormRowLabel",defaultMessage:"Password"})},this.validator.validatePassword(this.state.password)),Object(v.jsx)(s.EuiFieldPassword,{autoComplete:"off",id:"password",name:"password","data-test-subj":"loginPassword",type:"dual",value:this.state.password,onChange:this.onPasswordChange,disabled:!this.isLoadingState(L.None),isInvalid:!1,"aria-required":!0})),Object(v.jsx)(s.EuiSpacer,null),Object(v.jsx)(s.EuiFlexGroup,{responsive:!1,alignItems:"center",gutterSize:"s"},Object(v.jsx)(s.EuiFlexItem,{grow:!1},Object(v.jsx)(s.EuiButton,{fill:!0,type:"submit",color:"primary",onClick:this.submitLoginForm,isDisabled:!this.isLoadingState(L.None),isLoading:this.isLoadingState(L.Form),"data-test-subj":"loginSubmit"},Object(v.jsx)(p.FormattedMessage,{id:"xpack.security.login.basicLoginForm.logInButtonLabel",defaultMessage:"Log in"}))),e)))})),n()(this,"renderSelector",(()=>{const e=this.props.selector.providers.filter((e=>e.showInSelector));return Object(v.jsx)(s.EuiPanel,{"data-test-subj":"loginSelector",paddingSize:"none"},e.map((e=>{var t;return Object(v.jsx)("button",{key:e.name,"data-test-subj":`loginCard-${e.type}/${e.name}`,disabled:!this.isLoadingState(L.None),onClick:()=>e.usesLoginForm?this.onPageModeChange(y.Form):this.loginWithSelector({provider:e}),className:"secLoginCard "+(this.isLoadingState(L.Selector,e.name)?"secLoginCard-isLoading":"")},Object(v.jsx)(s.EuiFlexGroup,{alignItems:"center",gutterSize:"m",responsive:!1},Object(v.jsx)(s.EuiFlexItem,{grow:!1},Object(v.jsx)(s.EuiIcon,{size:"xl",type:e.icon?e.icon:"empty"})),Object(v.jsx)(s.EuiFlexItem,null,Object(v.jsx)(s.EuiTitle,{size:"xs",className:"secLoginCard__title"},Object(v.jsx)("p",null,null!==(t=e.description)&&void 0!==t?t:Object(v.jsx)(p.FormattedMessage,{id:"xpack.security.loginPage.loginProviderDescription",defaultMessage:"Log in with {providerType}/{providerName}",values:{providerType:e.type,providerName:e.name}}))),e.hint?Object(v.jsx)("p",{className:"secLoginCard__hint"},e.hint):null),this.isLoadingState(L.Selector,e.name)?Object(v.jsx)(s.EuiFlexItem,{grow:!1},Object(v.jsx)(s.EuiLoadingSpinner,{size:"m"})):null))})))})),n()(this,"renderLoginHelp",(()=>Object(v.jsx)(s.EuiPanel,{"data-test-subj":"loginHelp"},Object(v.jsx)(s.EuiText,null,Object(v.jsx)(f.a,null,this.props.loginHelp||""))))),n()(this,"renderPageModeSwitchLink",(()=>this.state.mode===y.LoginHelp?Object(v.jsx)(l.Fragment,null,Object(v.jsx)(s.EuiSpacer,null),Object(v.jsx)(s.EuiText,{size:"xs",className:"eui-textCenter"},Object(v.jsx)(s.EuiLink,{"data-test-subj":"loginBackToLoginLink",onClick:()=>this.onPageModeChange(this.state.previousMode)},Object(v.jsx)(p.FormattedMessage,{id:"xpack.security.loginPage.goBackToLoginLink",defaultMessage:"Take me back to Login"})))):this.props.loginHelp?Object(v.jsx)(l.Fragment,null,Object(v.jsx)(s.EuiSpacer,null),Object(v.jsx)(s.EuiText,{size:"xs",className:"eui-textCenter"},Object(v.jsx)(s.EuiLink,{"data-test-subj":"loginHelpLink",onClick:()=>this.onPageModeChange(y.LoginHelp)},Object(v.jsx)(p.FormattedMessage,{id:"xpack.security.loginPage.loginHelpLinkText",defaultMessage:"Need help?"})))):null)),n()(this,"renderAutoLoginOverlay",(()=>Object(v.jsx)(s.EuiFlexGroup,{"data-test-subj":"autoLoginOverlay",alignItems:"center",justifyContent:"center",gutterSize:"m",responsive:!1},Object(v.jsx)(s.EuiFlexItem,{grow:!1},Object(v.jsx)(s.EuiLoadingSpinner,{size:"l"})),Object(v.jsx)(s.EuiFlexItem,{grow:!1},Object(v.jsx)(s.EuiText,{size:"m",className:"eui-textCenter"},Object(v.jsx)(p.FormattedMessage,{id:"xpack.security.loginPage.autoLoginAuthenticatingLabel",defaultMessage:"Authenticating…"})))))),n()(this,"onPageModeChange",(e=>{this.setState({message:{type:_.None},mode:e,previousMode:this.state.mode})})),n()(this,"onUsernameChange",(e=>{this.setState({username:e.target.value})})),n()(this,"onPasswordChange",(e=>{this.setState({password:e.target.value})})),n()(this,"submitLoginForm",(async e=>{e.preventDefault(),this.validator.enableValidation();const{username:t,password:i}=this.state;if(this.validator.validateForLogin(t,i).isInvalid)return this.forceUpdate();this.setState({loadingState:{type:L.Form},message:{type:_.None}});const o=this.props.selector.providers.find((e=>e.usesLoginForm));try{const{location:e}=await this.props.http.post("/internal/security/login",{body:JSON.stringify({providerType:o.type,providerName:o.name,currentURL:window.location.href,params:{username:t,password:i}})});window.location.href=e}catch(e){var n;const t=401===(null===(n=e.response)||void 0===n?void 0:n.status)?u.i18n.translate("xpack.security.login.basicLoginForm.usernameOrPasswordIsIncorrectErrorMessage",{defaultMessage:"Username or password is incorrect. Please try again."}):u.i18n.translate("xpack.security.login.basicLoginForm.unknownErrorMessage",{defaultMessage:"We couldn't log you in. Please try again."});this.setState({message:{type:_.Danger,content:t},loadingState:{type:L.None}})}})),n()(this,"loginWithSelector",(async({provider:{type:e,name:t},autoLogin:i})=>{this.setState({loadingState:i?{type:L.AutoLogin}:{type:L.Selector,providerName:t},message:{type:_.None}});try{const{location:i}=await this.props.http.post("/internal/security/login",{body:JSON.stringify({providerType:e,providerName:t,currentURL:window.location.href})});window.location.href=i}catch(e){var o,n;this.props.notifications.toasts.addError(null!=e&&null!==(o=e.body)&&void 0!==o&&o.message?new Error(null==e||null===(n=e.body)||void 0===n?void 0:n.message):e,{title:u.i18n.translate("xpack.security.loginPage.loginSelectorErrorMessage",{defaultMessage:"Could not perform login."}),toastMessage:null==e?void 0:e.message}),this.setState({loadingState:{type:L.None}})}})),this.validator=new validate_login_LoginValidator({shouldValidate:!1}),this.suggestedProvider=this.props.authProviderHint?this.props.selector.providers.find((({name:e})=>e===this.props.authProviderHint)):void 0;const i=!this.showLoginSelector()||null!==(t=this.suggestedProvider)&&void 0!==t&&t.usesLoginForm?y.Form:y.Selector;this.state={loadingState:{type:L.None},username:"",password:"",message:this.props.message||{type:_.None},mode:i,previousMode:i}}async componentDidMount(){var e;!1===(null===(e=this.suggestedProvider)||void 0===e?void 0:e.usesLoginForm)&&await this.loginWithSelector({provider:this.suggestedProvider,autoLogin:!0})}render(){return this.isLoadingState(L.AutoLogin)?this.renderAutoLoginOverlay():Object(v.jsx)(l.Fragment,null,this.renderLoginAssistanceMessage(),this.renderMessage(),this.renderContent(),this.renderPageModeSwitchLink())}renderContent(){switch(this.state.mode){case y.Form:return this.renderLoginForm();case y.Selector:return this.renderSelector();case y.LoginHelp:return this.renderLoginHelp()}}setUsernameInputRef(e){e&&e.focus()}isLoadingState(e,t){const{loadingState:i}=this.state;return i.type===e&&(i.type!==L.Selector||i.providerName===t)}showLoginSelector(){return this.props.selector.enabled&&this.props.selector.providers.some((e=>!e.usesLoginForm&&e.showInSelector))}}const w=e=>Object(v.jsx)(s.EuiPanel,null,Object(v.jsx)(s.EuiText,{color:"danger",style:{textAlign:"center"}},Object(v.jsx)("p",null,e.title)),Object(v.jsx)(s.EuiText,{style:{textAlign:"center"}},Object(v.jsx)("p",null,e.message))),C={SESSION_EXPIRED:{type:_.Info,content:u.i18n.translate("xpack.security.login.sessionExpiredDescription",{defaultMessage:"Your session has timed out. Please log in again."})},AUTHENTICATION_ERROR:{type:_.Info,content:u.i18n.translate("xpack.security.login.authenticationErrorDescription",{defaultMessage:"An unexpected authentication error occurred. Please log in again."})},LOGGED_OUT:{type:_.Info,content:u.i18n.translate("xpack.security.login.loggedOutDescription",{defaultMessage:"You have logged out of Elastic."})},UNAUTHENTICATED:{type:_.Danger,content:u.i18n.translate("xpack.security.unauthenticated.errorDescription",{defaultMessage:"We hit an authentication error. Please check your credentials and try again. If you still can't log in, contact your system administrator."})}};class login_page_LoginPage extends l.Component{constructor(...e){super(...e),n()(this,"state",{loginState:null}),n()(this,"getLoginForm",(({layout:e,requiresSecureConnection:t,isSecureConnection:i,isCookiesEnabled:o,selector:n,loginHelp:a})=>{if(0===n.providers.length)return Object(v.jsx)(w,{title:Object(v.jsx)(p.FormattedMessage,{id:"xpack.security.loginPage.noLoginMethodsAvailableTitle",defaultMessage:"Login is disabled."}),message:Object(v.jsx)(p.FormattedMessage,{id:"xpack.security.loginPage.noLoginMethodsAvailableMessage",defaultMessage:"Contact your system administrator."})});if(t&&!i)return Object(v.jsx)(w,{title:Object(v.jsx)(p.FormattedMessage,{id:"xpack.security.loginPage.requiresSecureConnectionTitle",defaultMessage:"A secure connection is required for log in"}),message:Object(v.jsx)(p.FormattedMessage,{id:"xpack.security.loginPage.requiresSecureConnectionMessage",defaultMessage:"Contact your system administrator."})});if(!o)return function(){try{return window.self!==window.top}catch(e){return!0}}()?Object(v.jsx)("div",{style:{maxWidth:"36em",margin:"auto",textAlign:"center"}},Object(v.jsx)(s.EuiText,{color:"subdued"},Object(v.jsx)("p",null,"None"!==this.props.sameSiteCookies?Object(v.jsx)(p.FormattedMessage,{id:"xpack.security.loginPage.openInNewWindowOrChangeKibanaConfigTitle",defaultMessage:"To view this content, open it in a new window or ask your administrator to allow cross-origin cookies."}):Object(v.jsx)(p.FormattedMessage,{id:"xpack.security.loginPage.openInNewWindowOrChangeBrowserSettingsTitle",defaultMessage:"To view this content, open it in a new window or adjust your browser settings to allow third-party cookies."}))),Object(v.jsx)(s.EuiSpacer,null),Object(v.jsx)(s.EuiButton,{href:window.location.href,target:"_blank",iconType:"popout",iconSide:"right",fill:!0},Object(v.jsx)(p.FormattedMessage,{id:"xpack.security.loginPage.openInNewWindowButton",defaultMessage:"Open in new window"}))):Object(v.jsx)(w,{title:Object(v.jsx)(p.FormattedMessage,{id:"xpack.security.loginPage.requiresCookiesTitle",defaultMessage:"Cookies are required to log in to Elastic"}),message:Object(v.jsx)(p.FormattedMessage,{id:"xpack.security.loginPage.requiresCookiesMessage",defaultMessage:"Enable cookies in your browser settings to continue."})});if("error-es-unavailable"===e)return Object(v.jsx)(w,{title:Object(v.jsx)(p.FormattedMessage,{id:"xpack.security.loginPage.esUnavailableTitle",defaultMessage:"Cannot connect to the Elasticsearch cluster"}),message:Object(v.jsx)(p.FormattedMessage,{id:"xpack.security.loginPage.esUnavailableMessage",defaultMessage:"See the Kibana logs for details and try reloading the page."})});if("error-xpack-unavailable"===e)return Object(v.jsx)(w,{title:Object(v.jsx)(p.FormattedMessage,{id:"xpack.security.loginPage.xpackUnavailableTitle",defaultMessage:"Cannot connect to the Elasticsearch cluster currently configured for Kibana."}),message:Object(v.jsx)(p.FormattedMessage,{id:"xpack.security.loginPage.xpackUnavailableMessage",defaultMessage:"To use the full set of free features in this distribution of Kibana, please update Elasticsearch to the default distribution."})});if("form"!==e)return Object(v.jsx)(w,{title:Object(v.jsx)(p.FormattedMessage,{id:"xpack.security.loginPage.unknownLayoutTitle",defaultMessage:"Unsupported login form layout."}),message:Object(v.jsx)(p.FormattedMessage,{id:"xpack.security.loginPage.unknownLayoutMessage",defaultMessage:"See the Kibana logs for details and try reloading the page."})});const{searchParams:r}=new URL(window.location.href);return Object(v.jsx)(login_form_LoginForm,{http:this.props.http,notifications:this.props.notifications,selector:n,message:C[r.get(x.d)],loginAssistanceMessage:this.props.loginAssistanceMessage,loginHelp:a,authProviderHint:r.get(x.a)||void 0})}))}async componentDidMount(){const e=new g.BehaviorSubject(1);this.props.http.addLoadingCountSource(e.asObservable());try{this.setState({loginState:await this.props.http.get("/internal/security/login_state")})}catch(e){this.props.fatalErrors.add(e)}e.next(0),e.complete()}render(){const e=this.state.loginState;if(!e)return null;const t=!!window.location.protocol.match(/^https/),i=window.navigator.cookieEnabled,{allowLogin:o,layout:n,requiresSecureConnection:a}=e,l=!(a&&!t||!i)&&(o&&"form"===n),c=r()("loginWelcome__content","eui-textCenter",{loginWelcome__contentDisabledForm:!l}),d=r()("loginWelcome__content","loginWelcome-body",{loginWelcome__contentDisabledForm:!l});return Object(v.jsx)("div",{className:"loginWelcome login-form"},Object(v.jsx)("header",{className:"loginWelcome__header"},Object(v.jsx)("div",{className:c},Object(v.jsx)(s.EuiSpacer,{size:"xxl"}),Object(v.jsx)("span",{className:"loginWelcome__logo"},Object(v.jsx)(s.EuiIcon,{type:"logoElastic",size:"xxl"})),Object(v.jsx)(s.EuiTitle,{size:"m",className:"loginWelcome__title"},Object(v.jsx)("h1",null,Object(v.jsx)(p.FormattedMessage,{id:"xpack.security.loginPage.welcomeTitle",defaultMessage:"Welcome to Elastic"}))),Object(v.jsx)(s.EuiSpacer,{size:"xl"}))),Object(v.jsx)("div",{className:d},Object(v.jsx)(s.EuiFlexGroup,{gutterSize:"l"},Object(v.jsx)(s.EuiFlexItem,null,this.getLoginForm({...e,isSecureConnection:t,isCookiesEnabled:i})))))}}function O(e,t,i){return d.a.render(Object(v.jsx)(e.Context,null,Object(v.jsx)(login_page_LoginPage,i)),t),()=>d.a.unmountComponentAtNode(t)}}}]);