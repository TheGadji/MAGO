/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.infra_bundle_jsonpfunction=window.infra_bundle_jsonpfunction||[]).push([[10],{147:function(e,t,n){!function(e,t,n,a,i,r,o){"use strict";function s(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e)}return this}function l(e,t){switch(arguments.length){case 0:break;case 1:this.interpolator(e);break;default:this.interpolator(t).domain(e)}return this}var u=Array.prototype,c=u.map,d=u.slice,m={name:"implicit"};function g(){var e=t.map(),n=[],a=[],i=m;function r(t){var r=t+"",o=e.get(r);if(!o){if(i!==m)return i;e.set(r,o=n.push(t))}return a[(o-1)%a.length]}return r.domain=function(a){if(!arguments.length)return n.slice();n=[],e=t.map();for(var i,o,s=-1,l=a.length;++s<l;)e.has(o=(i=a[s])+"")||e.set(o,n.push(i));return r},r.range=function(e){return arguments.length?(a=d.call(e),r):a.slice()},r.unknown=function(e){return arguments.length?(i=e,r):i},r.copy=function(){return g(n,a).unknown(i)},s.apply(r,arguments),r}function h(){var e,t,a=g().unknown(void 0),i=a.domain,r=a.range,o=[0,1],l=!1,u=0,c=0,d=.5;function m(){var a=i().length,s=o[1]<o[0],m=o[s-0],g=o[1-s];e=(g-m)/Math.max(1,a-u+2*c),l&&(e=Math.floor(e)),m+=(g-m-e*(a-u))*d,t=e*(1-u),l&&(m=Math.round(m),t=Math.round(t));var h=n.range(a).map((function(t){return m+e*t}));return r(s?h.reverse():h)}return delete a.unknown,a.domain=function(e){return arguments.length?(i(e),m()):i()},a.range=function(e){return arguments.length?(o=[+e[0],+e[1]],m()):o.slice()},a.rangeRound=function(e){return o=[+e[0],+e[1]],l=!0,m()},a.bandwidth=function(){return t},a.step=function(){return e},a.round=function(e){return arguments.length?(l=!!e,m()):l},a.padding=function(e){return arguments.length?(u=Math.min(1,c=+e),m()):u},a.paddingInner=function(e){return arguments.length?(u=Math.min(1,e),m()):u},a.paddingOuter=function(e){return arguments.length?(c=+e,m()):c},a.align=function(e){return arguments.length?(d=Math.max(0,Math.min(1,e)),m()):d},a.copy=function(){return h(i(),o).round(l).paddingInner(u).paddingOuter(c).align(d)},s.apply(m(),arguments)}function p(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return p(t())},e}function f(){return p(h.apply(null,arguments).paddingInner(1))}function y(e){return function(){return e}}function b(e){return+e}var E=[0,1];function v(e){return e}function x(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:y(isNaN(t)?NaN:.5)}function _(e){var t,n=e[0],a=e[e.length-1];return n>a&&(t=n,n=a,a=t),function(e){return Math.max(n,Math.min(a,e))}}function M(e,t,n){var a=e[0],i=e[1],r=t[0],o=t[1];return i<a?(a=x(i,a),r=n(o,r)):(a=x(a,i),r=n(r,o)),function(e){return r(a(e))}}function S(e,t,a){var i=Math.min(e.length,t.length)-1,r=new Array(i),o=new Array(i),s=-1;for(e[i]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++s<i;)r[s]=x(e[s],e[s+1]),o[s]=a(t[s],t[s+1]);return function(t){var a=n.bisect(e,t,1,i)-1;return o[a](r[a](t))}}function T(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function C(){var e,t,n,i,r,o,s=E,l=E,u=a.interpolate,m=v;function g(){return i=Math.min(s.length,l.length)>2?S:M,r=o=null,h}function h(t){return isNaN(t=+t)?n:(r||(r=i(s.map(e),l,u)))(e(m(t)))}return h.invert=function(n){return m(t((o||(o=i(l,s.map(e),a.interpolateNumber)))(n)))},h.domain=function(e){return arguments.length?(s=c.call(e,b),m===v||(m=_(s)),g()):s.slice()},h.range=function(e){return arguments.length?(l=d.call(e),g()):l.slice()},h.rangeRound=function(e){return l=d.call(e),u=a.interpolateRound,g()},h.clamp=function(e){return arguments.length?(m=e?_(s):v,h):m!==v},h.interpolate=function(e){return arguments.length?(u=e,g()):u},h.unknown=function(e){return arguments.length?(n=e,h):n},function(n,a){return e=n,t=a,g()}}function O(e,t){return C()(e,t)}function j(e,t,a,r){var o,s=n.tickStep(e,t,a);switch((r=i.formatSpecifier(null==r?",f":r)).type){case"s":var l=Math.max(Math.abs(e),Math.abs(t));return null!=r.precision||isNaN(o=i.precisionPrefix(s,l))||(r.precision=o),i.formatPrefix(r,l);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(o=i.precisionRound(s,Math.max(Math.abs(e),Math.abs(t))))||(r.precision=o-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(o=i.precisionFixed(s))||(r.precision=o-2*("%"===r.type))}return i.format(r)}function w(e){var t=e.domain;return e.ticks=function(e){var a=t();return n.ticks(a[0],a[a.length-1],null==e?10:e)},e.tickFormat=function(e,n){var a=t();return j(a[0],a[a.length-1],null==e?10:e,n)},e.nice=function(a){null==a&&(a=10);var i,r=t(),o=0,s=r.length-1,l=r[o],u=r[s];return u<l&&(i=l,l=u,u=i,i=o,o=s,s=i),(i=n.tickIncrement(l,u,a))>0?(l=Math.floor(l/i)*i,u=Math.ceil(u/i)*i,i=n.tickIncrement(l,u,a)):i<0&&(l=Math.ceil(l*i)/i,u=Math.floor(u*i)/i,i=n.tickIncrement(l,u,a)),i>0?(r[o]=Math.floor(l/i)*i,r[s]=Math.ceil(u/i)*i,t(r)):i<0&&(r[o]=Math.ceil(l*i)/i,r[s]=Math.floor(u*i)/i,t(r)),e},e}function k(){var e=O(v,v);return e.copy=function(){return T(e,k())},s.apply(e,arguments),w(e)}function F(e){var t;function n(e){return isNaN(e=+e)?t:e}return n.invert=n,n.domain=n.range=function(t){return arguments.length?(e=c.call(t,b),n):e.slice()},n.unknown=function(e){return arguments.length?(t=e,n):t},n.copy=function(){return F(e).unknown(t)},e=arguments.length?c.call(e,b):[0,1],w(n)}function I(e,t){var n,a=0,i=(e=e.slice()).length-1,r=e[a],o=e[i];return o<r&&(n=a,a=i,i=n,n=r,r=o,o=n),e[a]=t.floor(r),e[i]=t.ceil(o),e}function L(e){return Math.log(e)}function P(e){return Math.exp(e)}function D(e){return-Math.log(-e)}function R(e){return-Math.exp(-e)}function N(e){return isFinite(e)?+("1e"+e):e<0?0:e}function A(e){return 10===e?N:e===Math.E?Math.exp:function(t){return Math.pow(e,t)}}function H(e){return e===Math.E?Math.log:10===e&&Math.log10||2===e&&Math.log2||(e=Math.log(e),function(t){return Math.log(t)/e})}function U(e){return function(t){return-e(-t)}}function z(e){var t,a,r=e(L,P),o=r.domain,s=10;function l(){return t=H(s),a=A(s),o()[0]<0?(t=U(t),a=U(a),e(D,R)):e(L,P),r}return r.base=function(e){return arguments.length?(s=+e,l()):s},r.domain=function(e){return arguments.length?(o(e),l()):o()},r.ticks=function(e){var i,r=o(),l=r[0],u=r[r.length-1];(i=u<l)&&(g=l,l=u,u=g);var c,d,m,g=t(l),h=t(u),p=null==e?10:+e,f=[];if(!(s%1)&&h-g<p){if(g=Math.round(g)-1,h=Math.round(h)+1,l>0){for(;g<h;++g)for(d=1,c=a(g);d<s;++d)if(!((m=c*d)<l)){if(m>u)break;f.push(m)}}else for(;g<h;++g)for(d=s-1,c=a(g);d>=1;--d)if(!((m=c*d)<l)){if(m>u)break;f.push(m)}}else f=n.ticks(g,h,Math.min(h-g,p)).map(a);return i?f.reverse():f},r.tickFormat=function(e,n){if(null==n&&(n=10===s?".0e":","),"function"!=typeof n&&(n=i.format(n)),e===1/0)return n;null==e&&(e=10);var o=Math.max(1,s*e/r.ticks().length);return function(e){var i=e/a(Math.round(t(e)));return i*s<s-.5&&(i*=s),i<=o?n(e):""}},r.nice=function(){return o(I(o(),{floor:function(e){return a(Math.floor(t(e)))},ceil:function(e){return a(Math.ceil(t(e)))}}))},r}function J(){var e=z(C()).domain([1,10]);return e.copy=function(){return T(e,J()).base(e.base())},s.apply(e,arguments),e}function B(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function Y(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function V(e){var t=1,n=e(B(t),Y(t));return n.constant=function(n){return arguments.length?e(B(t=+n),Y(t)):t},w(n)}function q(){var e=V(C());return e.copy=function(){return T(e,q()).constant(e.constant())},s.apply(e,arguments)}function W(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function $(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function G(e){return e<0?-e*e:e*e}function Q(e){var t=e(v,v),n=1;function a(){return 1===n?e(v,v):.5===n?e($,G):e(W(n),W(1/n))}return t.exponent=function(e){return arguments.length?(n=+e,a()):n},w(t)}function Z(){var e=Q(C());return e.copy=function(){return T(e,Z()).exponent(e.exponent())},s.apply(e,arguments),e}function K(){return Z.apply(null,arguments).exponent(.5)}function X(){var e,t=[],a=[],i=[];function r(){var e=0,r=Math.max(1,a.length);for(i=new Array(r-1);++e<r;)i[e-1]=n.quantile(t,e/r);return o}function o(t){return isNaN(t=+t)?e:a[n.bisect(i,t)]}return o.invertExtent=function(e){var n=a.indexOf(e);return n<0?[NaN,NaN]:[n>0?i[n-1]:t[0],n<i.length?i[n]:t[t.length-1]]},o.domain=function(e){if(!arguments.length)return t.slice();t=[];for(var a,i=0,o=e.length;i<o;++i)null==(a=e[i])||isNaN(a=+a)||t.push(a);return t.sort(n.ascending),r()},o.range=function(e){return arguments.length?(a=d.call(e),r()):a.slice()},o.unknown=function(t){return arguments.length?(e=t,o):e},o.quantiles=function(){return i.slice()},o.copy=function(){return X().domain(t).range(a).unknown(e)},s.apply(o,arguments)}function ee(){var e,t=0,a=1,i=1,r=[.5],o=[0,1];function l(t){return t<=t?o[n.bisect(r,t,0,i)]:e}function u(){var e=-1;for(r=new Array(i);++e<i;)r[e]=((e+1)*a-(e-i)*t)/(i+1);return l}return l.domain=function(e){return arguments.length?(t=+e[0],a=+e[1],u()):[t,a]},l.range=function(e){return arguments.length?(i=(o=d.call(e)).length-1,u()):o.slice()},l.invertExtent=function(e){var n=o.indexOf(e);return n<0?[NaN,NaN]:n<1?[t,r[0]]:n>=i?[r[i-1],a]:[r[n-1],r[n]]},l.unknown=function(t){return arguments.length?(e=t,l):l},l.thresholds=function(){return r.slice()},l.copy=function(){return ee().domain([t,a]).range(o).unknown(e)},s.apply(w(l),arguments)}function te(){var e,t=[.5],a=[0,1],i=1;function r(r){return r<=r?a[n.bisect(t,r,0,i)]:e}return r.domain=function(e){return arguments.length?(t=d.call(e),i=Math.min(t.length,a.length-1),r):t.slice()},r.range=function(e){return arguments.length?(a=d.call(e),i=Math.min(t.length,a.length-1),r):a.slice()},r.invertExtent=function(e){var n=a.indexOf(e);return[t[n-1],t[n]]},r.unknown=function(t){return arguments.length?(e=t,r):e},r.copy=function(){return te().domain(t).range(a).unknown(e)},s.apply(r,arguments)}var ne=1e3,ae=60*ne,ie=60*ae,re=24*ie,oe=7*re,se=30*re,le=365*re;function ue(e){return new Date(e)}function ce(e){return e instanceof Date?+e:+new Date(+e)}function de(e,t,a,i,r,o,s,l,u){var d=O(v,v),m=d.invert,g=d.domain,h=u(".%L"),p=u(":%S"),f=u("%I:%M"),y=u("%I %p"),b=u("%a %d"),E=u("%b %d"),x=u("%B"),_=u("%Y"),M=[[s,1,ne],[s,5,5*ne],[s,15,15*ne],[s,30,30*ne],[o,1,ae],[o,5,5*ae],[o,15,15*ae],[o,30,30*ae],[r,1,ie],[r,3,3*ie],[r,6,6*ie],[r,12,12*ie],[i,1,re],[i,2,2*re],[a,1,oe],[t,1,se],[t,3,3*se],[e,1,le]];function S(n){return(s(n)<n?h:o(n)<n?p:r(n)<n?f:i(n)<n?y:t(n)<n?a(n)<n?b:E:e(n)<n?x:_)(n)}function C(t,a,i,r){if(null==t&&(t=10),"number"==typeof t){var o=Math.abs(i-a)/t,s=n.bisector((function(e){return e[2]})).right(M,o);s===M.length?(r=n.tickStep(a/le,i/le,t),t=e):s?(r=(s=M[o/M[s-1][2]<M[s][2]/o?s-1:s])[1],t=s[0]):(r=Math.max(n.tickStep(a,i,t),1),t=l)}return null==r?t:t.every(r)}return d.invert=function(e){return new Date(m(e))},d.domain=function(e){return arguments.length?g(c.call(e,ce)):g().map(ue)},d.ticks=function(e,t){var n,a=g(),i=a[0],r=a[a.length-1],o=r<i;return o&&(n=i,i=r,r=n),n=(n=C(e,i,r,t))?n.range(i,r+1):[],o?n.reverse():n},d.tickFormat=function(e,t){return null==t?S:u(t)},d.nice=function(e,t){var n=g();return(e=C(e,n[0],n[n.length-1],t))?g(I(n,e)):d},d.copy=function(){return T(d,de(e,t,a,i,r,o,s,l,u))},d}function me(){return s.apply(de(r.timeYear,r.timeMonth,r.timeWeek,r.timeDay,r.timeHour,r.timeMinute,r.timeSecond,r.timeMillisecond,o.timeFormat).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function ge(){return s.apply(de(r.utcYear,r.utcMonth,r.utcWeek,r.utcDay,r.utcHour,r.utcMinute,r.utcSecond,r.utcMillisecond,o.utcFormat).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function he(){var e,t,n,a,i,r=0,o=1,s=v,l=!1;function u(t){return isNaN(t=+t)?i:s(0===n?.5:(t=(a(t)-e)*n,l?Math.max(0,Math.min(1,t)):t))}return u.domain=function(i){return arguments.length?(e=a(r=+i[0]),t=a(o=+i[1]),n=e===t?0:1/(t-e),u):[r,o]},u.clamp=function(e){return arguments.length?(l=!!e,u):l},u.interpolator=function(e){return arguments.length?(s=e,u):s},u.unknown=function(e){return arguments.length?(i=e,u):i},function(i){return a=i,e=i(r),t=i(o),n=e===t?0:1/(t-e),u}}function pe(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function fe(){var e=w(he()(v));return e.copy=function(){return pe(e,fe())},l.apply(e,arguments)}function ye(){var e=z(he()).domain([1,10]);return e.copy=function(){return pe(e,ye()).base(e.base())},l.apply(e,arguments)}function be(){var e=V(he());return e.copy=function(){return pe(e,be()).constant(e.constant())},l.apply(e,arguments)}function Ee(){var e=Q(he());return e.copy=function(){return pe(e,Ee()).exponent(e.exponent())},l.apply(e,arguments)}function ve(){return Ee.apply(null,arguments).exponent(.5)}function xe(){var e=[],t=v;function a(a){if(!isNaN(a=+a))return t((n.bisect(e,a)-1)/(e.length-1))}return a.domain=function(t){if(!arguments.length)return e.slice();e=[];for(var i,r=0,o=t.length;r<o;++r)null==(i=t[r])||isNaN(i=+i)||e.push(i);return e.sort(n.ascending),a},a.interpolator=function(e){return arguments.length?(t=e,a):t},a.copy=function(){return xe(t).domain(e)},l.apply(a,arguments)}function _e(){var e,t,n,a,i,r,o,s=0,l=.5,u=1,c=v,d=!1;function m(e){return isNaN(e=+e)?o:(e=.5+((e=+r(e))-t)*(e<t?a:i),c(d?Math.max(0,Math.min(1,e)):e))}return m.domain=function(o){return arguments.length?(e=r(s=+o[0]),t=r(l=+o[1]),n=r(u=+o[2]),a=e===t?0:.5/(t-e),i=t===n?0:.5/(n-t),m):[s,l,u]},m.clamp=function(e){return arguments.length?(d=!!e,m):d},m.interpolator=function(e){return arguments.length?(c=e,m):c},m.unknown=function(e){return arguments.length?(o=e,m):o},function(o){return r=o,e=o(s),t=o(l),n=o(u),a=e===t?0:.5/(t-e),i=t===n?0:.5/(n-t),m}}function Me(){var e=w(_e()(v));return e.copy=function(){return pe(e,Me())},l.apply(e,arguments)}function Se(){var e=z(_e()).domain([.1,1,10]);return e.copy=function(){return pe(e,Se()).base(e.base())},l.apply(e,arguments)}function Te(){var e=V(_e());return e.copy=function(){return pe(e,Te()).constant(e.constant())},l.apply(e,arguments)}function Ce(){var e=Q(_e());return e.copy=function(){return pe(e,Ce()).exponent(e.exponent())},l.apply(e,arguments)}function Oe(){return Ce.apply(null,arguments).exponent(.5)}e.scaleBand=h,e.scalePoint=f,e.scaleIdentity=F,e.scaleLinear=k,e.scaleLog=J,e.scaleSymlog=q,e.scaleOrdinal=g,e.scaleImplicit=m,e.scalePow=Z,e.scaleSqrt=K,e.scaleQuantile=X,e.scaleQuantize=ee,e.scaleThreshold=te,e.scaleTime=me,e.scaleUtc=ge,e.scaleSequential=fe,e.scaleSequentialLog=ye,e.scaleSequentialPow=Ee,e.scaleSequentialSqrt=ve,e.scaleSequentialSymlog=be,e.scaleSequentialQuantile=xe,e.scaleDiverging=Me,e.scaleDivergingLog=Se,e.scaleDivergingPow=Ce,e.scaleDivergingSqrt=Oe,e.scaleDivergingSymlog=Te,e.tickFormat=j,Object.defineProperty(e,"__esModule",{value:!0})}(t,n(262),n(127),n(263),n(265),n(210),n(266))},208:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(68),i=n(2);t.default=function(e){void 0===e&&(e=new Set);var t=i.useState(e),n=t[0],r=t[1],o=i.useMemo((function(){return{add:function(e){return r((function(t){return new Set(a.__spreadArrays(Array.from(t),[e]))}))},remove:function(e){return r((function(t){return new Set(Array.from(t).filter((function(t){return t!==e})))}))},toggle:function(e){return r((function(t){return t.has(e)?new Set(Array.from(t).filter((function(t){return t!==e}))):new Set(a.__spreadArrays(Array.from(t),[e]))}))},reset:function(){return r(e)}}}),[r]),s=a.__assign({has:i.useCallback((function(e){return n.has(e)}),[n])},o);return[n,s]}},210:function(e,t,n){!function(e){"use strict";var t=new Date,n=new Date;function a(e,i,r,o){function s(t){return e(t=0===arguments.length?new Date:new Date(+t)),t}return s.floor=function(t){return e(t=new Date(+t)),t},s.ceil=function(t){return e(t=new Date(t-1)),i(t,1),e(t),t},s.round=function(e){var t=s(e),n=s.ceil(e);return e-t<n-e?t:n},s.offset=function(e,t){return i(e=new Date(+e),null==t?1:Math.floor(t)),e},s.range=function(t,n,a){var r,o=[];if(t=s.ceil(t),a=null==a?1:Math.floor(a),!(t<n&&a>0))return o;do{o.push(r=new Date(+t)),i(t,a),e(t)}while(r<t&&t<n);return o},s.filter=function(t){return a((function(n){if(n>=n)for(;e(n),!t(n);)n.setTime(n-1)}),(function(e,n){if(e>=e)if(n<0)for(;++n<=0;)for(;i(e,-1),!t(e););else for(;--n>=0;)for(;i(e,1),!t(e););}))},r&&(s.count=function(a,i){return t.setTime(+a),n.setTime(+i),e(t),e(n),Math.floor(r(t,n))},s.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?s.filter(o?function(t){return o(t)%e==0}:function(t){return s.count(0,t)%e==0}):s:null}),s}var i=a((function(){}),(function(e,t){e.setTime(+e+t)}),(function(e,t){return t-e}));i.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?a((function(t){t.setTime(Math.floor(t/e)*e)}),(function(t,n){t.setTime(+t+n*e)}),(function(t,n){return(n-t)/e})):i:null};var r=i.range,o=1e3,s=6e4,l=36e5,u=864e5,c=6048e5,d=a((function(e){e.setTime(e-e.getMilliseconds())}),(function(e,t){e.setTime(+e+t*o)}),(function(e,t){return(t-e)/o}),(function(e){return e.getUTCSeconds()})),m=d.range,g=a((function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*o)}),(function(e,t){e.setTime(+e+t*s)}),(function(e,t){return(t-e)/s}),(function(e){return e.getMinutes()})),h=g.range,p=a((function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*o-e.getMinutes()*s)}),(function(e,t){e.setTime(+e+t*l)}),(function(e,t){return(t-e)/l}),(function(e){return e.getHours()})),f=p.range,y=a((function(e){e.setHours(0,0,0,0)}),(function(e,t){e.setDate(e.getDate()+t)}),(function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*s)/u}),(function(e){return e.getDate()-1})),b=y.range;function E(e){return a((function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)}),(function(e,t){e.setDate(e.getDate()+7*t)}),(function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*s)/c}))}var v=E(0),x=E(1),_=E(2),M=E(3),S=E(4),T=E(5),C=E(6),O=v.range,j=x.range,w=_.range,k=M.range,F=S.range,I=T.range,L=C.range,P=a((function(e){e.setDate(1),e.setHours(0,0,0,0)}),(function(e,t){e.setMonth(e.getMonth()+t)}),(function(e,t){return t.getMonth()-e.getMonth()+12*(t.getFullYear()-e.getFullYear())}),(function(e){return e.getMonth()})),D=P.range,R=a((function(e){e.setMonth(0,1),e.setHours(0,0,0,0)}),(function(e,t){e.setFullYear(e.getFullYear()+t)}),(function(e,t){return t.getFullYear()-e.getFullYear()}),(function(e){return e.getFullYear()}));R.every=function(e){return isFinite(e=Math.floor(e))&&e>0?a((function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)}),(function(t,n){t.setFullYear(t.getFullYear()+n*e)})):null};var N=R.range,A=a((function(e){e.setUTCSeconds(0,0)}),(function(e,t){e.setTime(+e+t*s)}),(function(e,t){return(t-e)/s}),(function(e){return e.getUTCMinutes()})),H=A.range,U=a((function(e){e.setUTCMinutes(0,0,0)}),(function(e,t){e.setTime(+e+t*l)}),(function(e,t){return(t-e)/l}),(function(e){return e.getUTCHours()})),z=U.range,J=a((function(e){e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCDate(e.getUTCDate()+t)}),(function(e,t){return(t-e)/u}),(function(e){return e.getUTCDate()-1})),B=J.range;function Y(e){return a((function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCDate(e.getUTCDate()+7*t)}),(function(e,t){return(t-e)/c}))}var V=Y(0),q=Y(1),W=Y(2),$=Y(3),G=Y(4),Q=Y(5),Z=Y(6),K=V.range,X=q.range,ee=W.range,te=$.range,ne=G.range,ae=Q.range,ie=Z.range,re=a((function(e){e.setUTCDate(1),e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCMonth(e.getUTCMonth()+t)}),(function(e,t){return t.getUTCMonth()-e.getUTCMonth()+12*(t.getUTCFullYear()-e.getUTCFullYear())}),(function(e){return e.getUTCMonth()})),oe=re.range,se=a((function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)}),(function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()}),(function(e){return e.getUTCFullYear()}));se.every=function(e){return isFinite(e=Math.floor(e))&&e>0?a((function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),(function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n*e)})):null};var le=se.range;e.timeDay=y,e.timeDays=b,e.timeFriday=T,e.timeFridays=I,e.timeHour=p,e.timeHours=f,e.timeInterval=a,e.timeMillisecond=i,e.timeMilliseconds=r,e.timeMinute=g,e.timeMinutes=h,e.timeMonday=x,e.timeMondays=j,e.timeMonth=P,e.timeMonths=D,e.timeSaturday=C,e.timeSaturdays=L,e.timeSecond=d,e.timeSeconds=m,e.timeSunday=v,e.timeSundays=O,e.timeThursday=S,e.timeThursdays=F,e.timeTuesday=_,e.timeTuesdays=w,e.timeWednesday=M,e.timeWednesdays=k,e.timeWeek=v,e.timeWeeks=O,e.timeYear=R,e.timeYears=N,e.utcDay=J,e.utcDays=B,e.utcFriday=Q,e.utcFridays=ae,e.utcHour=U,e.utcHours=z,e.utcMillisecond=i,e.utcMilliseconds=r,e.utcMinute=A,e.utcMinutes=H,e.utcMonday=q,e.utcMondays=X,e.utcMonth=re,e.utcMonths=oe,e.utcSaturday=Z,e.utcSaturdays=ie,e.utcSecond=d,e.utcSeconds=m,e.utcSunday=V,e.utcSundays=K,e.utcThursday=G,e.utcThursdays=ne,e.utcTuesday=W,e.utcTuesdays=ee,e.utcWednesday=$,e.utcWednesdays=te,e.utcWeek=V,e.utcWeeks=K,e.utcYear=se,e.utcYears=le,Object.defineProperty(e,"__esModule",{value:!0})}(t)},251:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(68),i=n(252),r=a.__importDefault(n(254));t.default=function(e,t){r.default(e,t,i.isDeepEqual)}},252:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isDeepEqual=t.off=t.on=t.isClient=void 0;var a=n(68).__importDefault(n(253));t.isClient="object"==typeof window,t.on=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return e.addEventListener.apply(e,t)},t.off=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return e.removeEventListener.apply(e,t)},t.isDeepEqual=a.default},253:function(e,t,n){"use strict";e.exports=function e(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){if(t.constructor!==n.constructor)return!1;var a,i,r;if(Array.isArray(t)){if((a=t.length)!=n.length)return!1;for(i=a;0!=i--;)if(!e(t[i],n[i]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if((a=(r=Object.keys(t)).length)!==Object.keys(n).length)return!1;for(i=a;0!=i--;)if(!Object.prototype.hasOwnProperty.call(n,r[i]))return!1;for(i=a;0!=i--;){var o=r[i];if(("_owner"!==o||!t.$$typeof)&&!e(t[o],n[o]))return!1}return!0}return t!=t&&n!=n}},254:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e,t,n){var i=a.useRef(void 0);i.current&&n(t,i.current)||(i.current=t),a.useEffect(e,i.current)}},262:function(e,t,n){!function(e){"use strict";var t="$";function n(){}function a(e,t){var a=new n;if(e instanceof n)e.each((function(e,t){a.set(t,e)}));else if(Array.isArray(e)){var i,r=-1,o=e.length;if(null==t)for(;++r<o;)a.set(r,e[r]);else for(;++r<o;)a.set(t(i=e[r],r,e),i)}else if(e)for(var s in e)a.set(s,e[s]);return a}function i(){var e,t,n,i=[],u=[];function c(n,r,o,s){if(r>=i.length)return null!=e&&n.sort(e),null!=t?t(n):n;for(var l,u,d,m=-1,g=n.length,h=i[r++],p=a(),f=o();++m<g;)(d=p.get(l=h(u=n[m])+""))?d.push(u):p.set(l,[u]);return p.each((function(e,t){s(f,t,c(e,r,o,s))})),f}function d(e,n){if(++n>i.length)return e;var a,r=u[n-1];return null!=t&&n>=i.length?a=e.entries():(a=[],e.each((function(e,t){a.push({key:t,values:d(e,n)})}))),null!=r?a.sort((function(e,t){return r(e.key,t.key)})):a}return n={object:function(e){return c(e,0,r,o)},map:function(e){return c(e,0,s,l)},entries:function(e){return d(c(e,0,s,l),0)},key:function(e){return i.push(e),n},sortKeys:function(e){return u[i.length-1]=e,n},sortValues:function(t){return e=t,n},rollup:function(e){return t=e,n}}}function r(){return{}}function o(e,t,n){e[t]=n}function s(){return a()}function l(e,t,n){e.set(t,n)}function u(){}n.prototype=a.prototype={constructor:n,has:function(e){return t+e in this},get:function(e){return this[t+e]},set:function(e,n){return this[t+e]=n,this},remove:function(e){var n=t+e;return n in this&&delete this[n]},clear:function(){for(var e in this)e[0]===t&&delete this[e]},keys:function(){var e=[];for(var n in this)n[0]===t&&e.push(n.slice(1));return e},values:function(){var e=[];for(var n in this)n[0]===t&&e.push(this[n]);return e},entries:function(){var e=[];for(var n in this)n[0]===t&&e.push({key:n.slice(1),value:this[n]});return e},size:function(){var e=0;for(var n in this)n[0]===t&&++e;return e},empty:function(){for(var e in this)if(e[0]===t)return!1;return!0},each:function(e){for(var n in this)n[0]===t&&e(this[n],n.slice(1),this)}};var c=a.prototype;function d(e,t){var n=new u;if(e instanceof u)e.each((function(e){n.add(e)}));else if(e){var a=-1,i=e.length;if(null==t)for(;++a<i;)n.add(e[a]);else for(;++a<i;)n.add(t(e[a],a,e))}return n}function m(e){var t=[];for(var n in e)t.push(n);return t}function g(e){var t=[];for(var n in e)t.push(e[n]);return t}function h(e){var t=[];for(var n in e)t.push({key:n,value:e[n]});return t}u.prototype=d.prototype={constructor:u,has:c.has,add:function(e){return this[t+(e+="")]=e,this},remove:c.remove,clear:c.clear,values:c.keys,size:c.size,empty:c.empty,each:c.each},e.nest=i,e.set=d,e.map=a,e.keys=m,e.values=g,e.entries=h,Object.defineProperty(e,"__esModule",{value:!0})}(t)},263:function(e,t,n){!function(e,t){"use strict";function n(e,t,n,a,i){var r=e*e,o=r*e;return((1-3*e+3*r-o)*t+(4-6*r+3*o)*n+(1+3*e+3*r-3*o)*a+o*i)/6}function a(e){var t=e.length-1;return function(a){var i=a<=0?a=0:a>=1?(a=1,t-1):Math.floor(a*t),r=e[i],o=e[i+1],s=i>0?e[i-1]:2*r-o,l=i<t-1?e[i+2]:2*o-r;return n((a-i/t)*t,s,r,o,l)}}function i(e){var t=e.length;return function(a){var i=Math.floor(((a%=1)<0?++a:a)*t),r=e[(i+t-1)%t],o=e[i%t],s=e[(i+1)%t],l=e[(i+2)%t];return n((a-i/t)*t,r,o,s,l)}}function r(e){return function(){return e}}function o(e,t){return function(n){return e+n*t}}function s(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(a){return Math.pow(e+a*t,n)}}function l(e,t){var n=t-e;return n?o(e,n>180||n<-180?n-360*Math.round(n/360):n):r(isNaN(e)?t:e)}function u(e){return 1==(e=+e)?c:function(t,n){return n-t?s(t,n,e):r(isNaN(t)?n:t)}}function c(e,t){var n=t-e;return n?o(e,n):r(isNaN(e)?t:e)}var d=function e(n){var a=u(n);function i(e,n){var i=a((e=t.rgb(e)).r,(n=t.rgb(n)).r),r=a(e.g,n.g),o=a(e.b,n.b),s=c(e.opacity,n.opacity);return function(t){return e.r=i(t),e.g=r(t),e.b=o(t),e.opacity=s(t),e+""}}return i.gamma=e,i}(1);function m(e){return function(n){var a,i,r=n.length,o=new Array(r),s=new Array(r),l=new Array(r);for(a=0;a<r;++a)i=t.rgb(n[a]),o[a]=i.r||0,s[a]=i.g||0,l[a]=i.b||0;return o=e(o),s=e(s),l=e(l),i.opacity=1,function(e){return i.r=o(e),i.g=s(e),i.b=l(e),i+""}}}var g=m(a),h=m(i);function p(e,t){t||(t=[]);var n,a=e?Math.min(t.length,e.length):0,i=t.slice();return function(r){for(n=0;n<a;++n)i[n]=e[n]*(1-r)+t[n]*r;return i}}function f(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function y(e,t){return(f(t)?p:b)(e,t)}function b(e,t){var n,a=t?t.length:0,i=e?Math.min(a,e.length):0,r=new Array(i),o=new Array(a);for(n=0;n<i;++n)r[n]=O(e[n],t[n]);for(;n<a;++n)o[n]=t[n];return function(e){for(n=0;n<i;++n)o[n]=r[n](e);return o}}function E(e,t){var n=new Date;return e=+e,t=+t,function(a){return n.setTime(e*(1-a)+t*a),n}}function v(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function x(e,t){var n,a={},i={};for(n in null!==e&&"object"==typeof e||(e={}),null!==t&&"object"==typeof t||(t={}),t)n in e?a[n]=O(e[n],t[n]):i[n]=t[n];return function(e){for(n in a)i[n]=a[n](e);return i}}var _=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,M=new RegExp(_.source,"g");function S(e){return function(){return e}}function T(e){return function(t){return e(t)+""}}function C(e,t){var n,a,i,r=_.lastIndex=M.lastIndex=0,o=-1,s=[],l=[];for(e+="",t+="";(n=_.exec(e))&&(a=M.exec(t));)(i=a.index)>r&&(i=t.slice(r,i),s[o]?s[o]+=i:s[++o]=i),(n=n[0])===(a=a[0])?s[o]?s[o]+=a:s[++o]=a:(s[++o]=null,l.push({i:o,x:v(n,a)})),r=M.lastIndex;return r<t.length&&(i=t.slice(r),s[o]?s[o]+=i:s[++o]=i),s.length<2?l[0]?T(l[0].x):S(t):(t=l.length,function(e){for(var n,a=0;a<t;++a)s[(n=l[a]).i]=n.x(e);return s.join("")})}function O(e,n){var a,i=typeof n;return null==n||"boolean"===i?r(n):("number"===i?v:"string"===i?(a=t.color(n))?(n=a,d):C:n instanceof t.color?d:n instanceof Date?E:f(n)?p:Array.isArray(n)?b:"function"!=typeof n.valueOf&&"function"!=typeof n.toString||isNaN(n)?x:v)(e,n)}function j(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}function w(e,t){var n=l(+e,+t);return function(e){var t=n(e);return t-360*Math.floor(t/360)}}function k(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var F,I,L,P,D=180/Math.PI,R={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function N(e,t,n,a,i,r){var o,s,l;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(l=e*n+t*a)&&(n-=e*l,a-=t*l),(s=Math.sqrt(n*n+a*a))&&(n/=s,a/=s,l/=s),e*a<t*n&&(e=-e,t=-t,l=-l,o=-o),{translateX:i,translateY:r,rotate:Math.atan2(t,e)*D,skewX:Math.atan(l)*D,scaleX:o,scaleY:s}}function A(e){return"none"===e?R:(F||(F=document.createElement("DIV"),I=document.documentElement,L=document.defaultView),F.style.transform=e,e=L.getComputedStyle(I.appendChild(F),null).getPropertyValue("transform"),I.removeChild(F),N(+(e=e.slice(7,-1).split(","))[0],+e[1],+e[2],+e[3],+e[4],+e[5]))}function H(e){return null==e?R:(P||(P=document.createElementNS("http://www.w3.org/2000/svg","g")),P.setAttribute("transform",e),(e=P.transform.baseVal.consolidate())?N((e=e.matrix).a,e.b,e.c,e.d,e.e,e.f):R)}function U(e,t,n,a){function i(e){return e.length?e.pop()+" ":""}function r(e,a,i,r,o,s){if(e!==i||a!==r){var l=o.push("translate(",null,t,null,n);s.push({i:l-4,x:v(e,i)},{i:l-2,x:v(a,r)})}else(i||r)&&o.push("translate("+i+t+r+n)}function o(e,t,n,r){e!==t?(e-t>180?t+=360:t-e>180&&(e+=360),r.push({i:n.push(i(n)+"rotate(",null,a)-2,x:v(e,t)})):t&&n.push(i(n)+"rotate("+t+a)}function s(e,t,n,r){e!==t?r.push({i:n.push(i(n)+"skewX(",null,a)-2,x:v(e,t)}):t&&n.push(i(n)+"skewX("+t+a)}function l(e,t,n,a,r,o){if(e!==n||t!==a){var s=r.push(i(r)+"scale(",null,",",null,")");o.push({i:s-4,x:v(e,n)},{i:s-2,x:v(t,a)})}else 1===n&&1===a||r.push(i(r)+"scale("+n+","+a+")")}return function(t,n){var a=[],i=[];return t=e(t),n=e(n),r(t.translateX,t.translateY,n.translateX,n.translateY,a,i),o(t.rotate,n.rotate,a,i),s(t.skewX,n.skewX,a,i),l(t.scaleX,t.scaleY,n.scaleX,n.scaleY,a,i),t=n=null,function(e){for(var t,n=-1,r=i.length;++n<r;)a[(t=i[n]).i]=t.x(e);return a.join("")}}}var z=U(A,"px, ","px)","deg)"),J=U(H,", ",")",")"),B=Math.SQRT2,Y=2,V=4,q=1e-12;function W(e){return((e=Math.exp(e))+1/e)/2}function $(e){return((e=Math.exp(e))-1/e)/2}function G(e){return((e=Math.exp(2*e))-1)/(e+1)}function Q(e,t){var n,a,i=e[0],r=e[1],o=e[2],s=t[0],l=t[1],u=t[2],c=s-i,d=l-r,m=c*c+d*d;if(m<q)a=Math.log(u/o)/B,n=function(e){return[i+e*c,r+e*d,o*Math.exp(B*e*a)]};else{var g=Math.sqrt(m),h=(u*u-o*o+V*m)/(2*o*Y*g),p=(u*u-o*o-V*m)/(2*u*Y*g),f=Math.log(Math.sqrt(h*h+1)-h),y=Math.log(Math.sqrt(p*p+1)-p);a=(y-f)/B,n=function(e){var t=e*a,n=W(f),s=o/(Y*g)*(n*G(B*t+f)-$(f));return[i+s*c,r+s*d,o*n/W(B*t+f)]}}return n.duration=1e3*a,n}function Z(e){return function(n,a){var i=e((n=t.hsl(n)).h,(a=t.hsl(a)).h),r=c(n.s,a.s),o=c(n.l,a.l),s=c(n.opacity,a.opacity);return function(e){return n.h=i(e),n.s=r(e),n.l=o(e),n.opacity=s(e),n+""}}}var K=Z(l),X=Z(c);function ee(e,n){var a=c((e=t.lab(e)).l,(n=t.lab(n)).l),i=c(e.a,n.a),r=c(e.b,n.b),o=c(e.opacity,n.opacity);return function(t){return e.l=a(t),e.a=i(t),e.b=r(t),e.opacity=o(t),e+""}}function te(e){return function(n,a){var i=e((n=t.hcl(n)).h,(a=t.hcl(a)).h),r=c(n.c,a.c),o=c(n.l,a.l),s=c(n.opacity,a.opacity);return function(e){return n.h=i(e),n.c=r(e),n.l=o(e),n.opacity=s(e),n+""}}}var ne=te(l),ae=te(c);function ie(e){return function n(a){function i(n,i){var r=e((n=t.cubehelix(n)).h,(i=t.cubehelix(i)).h),o=c(n.s,i.s),s=c(n.l,i.l),l=c(n.opacity,i.opacity);return function(e){return n.h=r(e),n.s=o(e),n.l=s(Math.pow(e,a)),n.opacity=l(e),n+""}}return a=+a,i.gamma=n,i}(1)}var re=ie(l),oe=ie(c);function se(e,t){for(var n=0,a=t.length-1,i=t[0],r=new Array(a<0?0:a);n<a;)r[n]=e(i,i=t[++n]);return function(e){var t=Math.max(0,Math.min(a-1,Math.floor(e*=a)));return r[t](e-t)}}function le(e,t){for(var n=new Array(t),a=0;a<t;++a)n[a]=e(a/(t-1));return n}e.interpolate=O,e.interpolateArray=y,e.interpolateBasis=a,e.interpolateBasisClosed=i,e.interpolateCubehelix=re,e.interpolateCubehelixLong=oe,e.interpolateDate=E,e.interpolateDiscrete=j,e.interpolateHcl=ne,e.interpolateHclLong=ae,e.interpolateHsl=K,e.interpolateHslLong=X,e.interpolateHue=w,e.interpolateLab=ee,e.interpolateNumber=v,e.interpolateNumberArray=p,e.interpolateObject=x,e.interpolateRgb=d,e.interpolateRgbBasis=g,e.interpolateRgbBasisClosed=h,e.interpolateRound=k,e.interpolateString=C,e.interpolateTransformCss=z,e.interpolateTransformSvg=J,e.interpolateZoom=Q,e.piecewise=se,e.quantize=le,Object.defineProperty(e,"__esModule",{value:!0})}(t,n(264))},264:function(e,t,n){!function(e){"use strict";function t(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function n(e,t){var n=Object.create(e.prototype);for(var a in t)n[a]=t[a];return n}function a(){}var i=.7,r=1/i,o="\\s*([+-]?\\d+)\\s*",s="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",l="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",u=/^#([0-9a-f]{3,8})$/,c=new RegExp("^rgb\\("+[o,o,o]+"\\)$"),d=new RegExp("^rgb\\("+[l,l,l]+"\\)$"),m=new RegExp("^rgba\\("+[o,o,o,s]+"\\)$"),g=new RegExp("^rgba\\("+[l,l,l,s]+"\\)$"),h=new RegExp("^hsl\\("+[s,l,l]+"\\)$"),p=new RegExp("^hsla\\("+[s,l,l,s]+"\\)$"),f={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function y(){return this.rgb().formatHex()}function b(){return k(this).formatHsl()}function E(){return this.rgb().formatRgb()}function v(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=u.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?x(t):3===n?new T(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?_(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?_(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=c.exec(e))?new T(t[1],t[2],t[3],1):(t=d.exec(e))?new T(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=m.exec(e))?_(t[1],t[2],t[3],t[4]):(t=g.exec(e))?_(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=h.exec(e))?w(t[1],t[2]/100,t[3]/100,1):(t=p.exec(e))?w(t[1],t[2]/100,t[3]/100,t[4]):f.hasOwnProperty(e)?x(f[e]):"transparent"===e?new T(NaN,NaN,NaN,0):null}function x(e){return new T(e>>16&255,e>>8&255,255&e,1)}function _(e,t,n,a){return a<=0&&(e=t=n=NaN),new T(e,t,n,a)}function M(e){return e instanceof a||(e=v(e)),e?new T((e=e.rgb()).r,e.g,e.b,e.opacity):new T}function S(e,t,n,a){return 1===arguments.length?M(e):new T(e,t,n,null==a?1:a)}function T(e,t,n,a){this.r=+e,this.g=+t,this.b=+n,this.opacity=+a}function C(){return"#"+j(this.r)+j(this.g)+j(this.b)}function O(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===e?")":", "+e+")")}function j(e){return((e=Math.max(0,Math.min(255,Math.round(e)||0)))<16?"0":"")+e.toString(16)}function w(e,t,n,a){return a<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new I(e,t,n,a)}function k(e){if(e instanceof I)return new I(e.h,e.s,e.l,e.opacity);if(e instanceof a||(e=v(e)),!e)return new I;if(e instanceof I)return e;var t=(e=e.rgb()).r/255,n=e.g/255,i=e.b/255,r=Math.min(t,n,i),o=Math.max(t,n,i),s=NaN,l=o-r,u=(o+r)/2;return l?(s=t===o?(n-i)/l+6*(n<i):n===o?(i-t)/l+2:(t-n)/l+4,l/=u<.5?o+r:2-o-r,s*=60):l=u>0&&u<1?0:s,new I(s,l,u,e.opacity)}function F(e,t,n,a){return 1===arguments.length?k(e):new I(e,t,n,null==a?1:a)}function I(e,t,n,a){this.h=+e,this.s=+t,this.l=+n,this.opacity=+a}function L(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}t(a,v,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:y,formatHex:y,formatHsl:b,formatRgb:E,toString:E}),t(T,S,n(a,{brighter:function(e){return e=null==e?r:Math.pow(r,e),new T(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=null==e?i:Math.pow(i,e),new T(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:C,formatHex:C,formatRgb:O,toString:O})),t(I,F,n(a,{brighter:function(e){return e=null==e?r:Math.pow(r,e),new I(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?i:Math.pow(i,e),new I(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,a=n+(n<.5?n:1-n)*t,i=2*n-a;return new T(L(e>=240?e-240:e+120,i,a),L(e,i,a),L(e<120?e+240:e-120,i,a),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===e?")":", "+e+")")}}));var P=Math.PI/180,D=180/Math.PI,R=18,N=.96422,A=1,H=.82521,U=4/29,z=6/29,J=3*z*z,B=z*z*z;function Y(e){if(e instanceof W)return new W(e.l,e.a,e.b,e.opacity);if(e instanceof te)return ne(e);e instanceof T||(e=M(e));var t,n,a=Z(e.r),i=Z(e.g),r=Z(e.b),o=$((.2225045*a+.7168786*i+.0606169*r)/A);return a===i&&i===r?t=n=o:(t=$((.4360747*a+.3850649*i+.1430804*r)/N),n=$((.0139322*a+.0971045*i+.7141733*r)/H)),new W(116*o-16,500*(t-o),200*(o-n),e.opacity)}function V(e,t){return new W(e,0,0,null==t?1:t)}function q(e,t,n,a){return 1===arguments.length?Y(e):new W(e,t,n,null==a?1:a)}function W(e,t,n,a){this.l=+e,this.a=+t,this.b=+n,this.opacity=+a}function $(e){return e>B?Math.pow(e,1/3):e/J+U}function G(e){return e>z?e*e*e:J*(e-U)}function Q(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function Z(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function K(e){if(e instanceof te)return new te(e.h,e.c,e.l,e.opacity);if(e instanceof W||(e=Y(e)),0===e.a&&0===e.b)return new te(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*D;return new te(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function X(e,t,n,a){return 1===arguments.length?K(e):new te(n,t,e,null==a?1:a)}function ee(e,t,n,a){return 1===arguments.length?K(e):new te(e,t,n,null==a?1:a)}function te(e,t,n,a){this.h=+e,this.c=+t,this.l=+n,this.opacity=+a}function ne(e){if(isNaN(e.h))return new W(e.l,0,0,e.opacity);var t=e.h*P;return new W(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}t(W,q,n(a,{brighter:function(e){return new W(this.l+R*(null==e?1:e),this.a,this.b,this.opacity)},darker:function(e){return new W(this.l-R*(null==e?1:e),this.a,this.b,this.opacity)},rgb:function(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return new T(Q(3.1338561*(t=N*G(t))-1.6168667*(e=A*G(e))-.4906146*(n=H*G(n))),Q(-.9787684*t+1.9161415*e+.033454*n),Q(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}})),t(te,ee,n(a,{brighter:function(e){return new te(this.h,this.c,this.l+R*(null==e?1:e),this.opacity)},darker:function(e){return new te(this.h,this.c,this.l-R*(null==e?1:e),this.opacity)},rgb:function(){return ne(this).rgb()}}));var ae=-.14861,ie=1.78277,re=-.29227,oe=-.90649,se=1.97294,le=se*oe,ue=se*ie,ce=ie*re-oe*ae;function de(e){if(e instanceof ge)return new ge(e.h,e.s,e.l,e.opacity);e instanceof T||(e=M(e));var t=e.r/255,n=e.g/255,a=e.b/255,i=(ce*a+le*t-ue*n)/(ce+le-ue),r=a-i,o=(se*(n-i)-re*r)/oe,s=Math.sqrt(o*o+r*r)/(se*i*(1-i)),l=s?Math.atan2(o,r)*D-120:NaN;return new ge(l<0?l+360:l,s,i,e.opacity)}function me(e,t,n,a){return 1===arguments.length?de(e):new ge(e,t,n,null==a?1:a)}function ge(e,t,n,a){this.h=+e,this.s=+t,this.l=+n,this.opacity=+a}t(ge,me,n(a,{brighter:function(e){return e=null==e?r:Math.pow(r,e),new ge(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?i:Math.pow(i,e),new ge(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=isNaN(this.h)?0:(this.h+120)*P,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),a=Math.cos(e),i=Math.sin(e);return new T(255*(t+n*(ae*a+ie*i)),255*(t+n*(re*a+oe*i)),255*(t+n*(se*a)),this.opacity)}})),e.color=v,e.cubehelix=me,e.gray=V,e.hcl=ee,e.hsl=F,e.lab=q,e.lch=X,e.rgb=S,Object.defineProperty(e,"__esModule",{value:!0})}(t)},265:function(e,t,n){!function(e){"use strict";function t(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,a=e.slice(0,n);return[a.length>1?a[0]+a.slice(2):a,+e.slice(n+1)]}function n(e){return(e=t(Math.abs(e)))?e[1]:NaN}function a(e,t){return function(n,a){for(var i=n.length,r=[],o=0,s=e[0],l=0;i>0&&s>0&&(l+s+1>a&&(s=Math.max(1,a-l)),r.push(n.substring(i-=s,i+s)),!((l+=s+1)>a));)s=e[o=(o+1)%e.length];return r.reverse().join(t)}}function i(e){return function(t){return t.replace(/[0-9]/g,(function(t){return e[+t]}))}}var r,o=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function s(e){if(!(t=o.exec(e)))throw new Error("invalid format: "+e);var t;return new l({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function l(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}function u(e){e:for(var t,n=e.length,a=1,i=-1;a<n;++a)switch(e[a]){case".":i=t=a;break;case"0":0===i&&(i=a),t=a;break;default:if(!+e[a])break e;i>0&&(i=0)}return i>0?e.slice(0,i)+e.slice(t+1):e}function c(e,n){var a=t(e,n);if(!a)return e+"";var i=a[0],o=a[1],s=o-(r=3*Math.max(-8,Math.min(8,Math.floor(o/3))))+1,l=i.length;return s===l?i:s>l?i+new Array(s-l+1).join("0"):s>0?i.slice(0,s)+"."+i.slice(s):"0."+new Array(1-s).join("0")+t(e,Math.max(0,n+s-1))[0]}function d(e,n){var a=t(e,n);if(!a)return e+"";var i=a[0],r=a[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")}s.prototype=l.prototype,l.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var m={"%":function(e,t){return(100*e).toFixed(t)},b:function(e){return Math.round(e).toString(2)},c:function(e){return e+""},d:function(e){return Math.round(e).toString(10)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},g:function(e,t){return e.toPrecision(t)},o:function(e){return Math.round(e).toString(8)},p:function(e,t){return d(100*e,t)},r:d,s:c,X:function(e){return Math.round(e).toString(16).toUpperCase()},x:function(e){return Math.round(e).toString(16)}};function g(e){return e}var h,p=Array.prototype.map,f=["y","z","a","f","p","n","Âµ","m","","k","M","G","T","P","E","Z","Y"];function y(e){var t=void 0===e.grouping||void 0===e.thousands?g:a(p.call(e.grouping,Number),e.thousands+""),o=void 0===e.currency?"":e.currency[0]+"",l=void 0===e.currency?"":e.currency[1]+"",c=void 0===e.decimal?".":e.decimal+"",d=void 0===e.numerals?g:i(p.call(e.numerals,String)),h=void 0===e.percent?"%":e.percent+"",y=void 0===e.minus?"-":e.minus+"",b=void 0===e.nan?"NaN":e.nan+"";function E(e){var n=(e=s(e)).fill,a=e.align,i=e.sign,g=e.symbol,p=e.zero,E=e.width,v=e.comma,x=e.precision,_=e.trim,M=e.type;"n"===M?(v=!0,M="g"):m[M]||(void 0===x&&(x=12),_=!0,M="g"),(p||"0"===n&&"="===a)&&(p=!0,n="0",a="=");var S="$"===g?o:"#"===g&&/[boxX]/.test(M)?"0"+M.toLowerCase():"",T="$"===g?l:/[%p]/.test(M)?h:"",C=m[M],O=/[defgprs%]/.test(M);function j(e){var o,s,l,m=S,g=T;if("c"===M)g=C(e)+g,e="";else{var h=(e=+e)<0||1/e<0;if(e=isNaN(e)?b:C(Math.abs(e),x),_&&(e=u(e)),h&&0==+e&&"+"!==i&&(h=!1),m=(h?"("===i?i:y:"-"===i||"("===i?"":i)+m,g=("s"===M?f[8+r/3]:"")+g+(h&&"("===i?")":""),O)for(o=-1,s=e.length;++o<s;)if(48>(l=e.charCodeAt(o))||l>57){g=(46===l?c+e.slice(o+1):e.slice(o))+g,e=e.slice(0,o);break}}v&&!p&&(e=t(e,1/0));var j=m.length+e.length+g.length,w=j<E?new Array(E-j+1).join(n):"";switch(v&&p&&(e=t(w+e,w.length?E-g.length:1/0),w=""),a){case"<":e=m+e+g+w;break;case"=":e=m+w+e+g;break;case"^":e=w.slice(0,j=w.length>>1)+m+e+g+w.slice(j);break;default:e=w+m+e+g}return d(e)}return x=void 0===x?6:/[gprs]/.test(M)?Math.max(1,Math.min(21,x)):Math.max(0,Math.min(20,x)),j.toString=function(){return e+""},j}function v(e,t){var a=E(((e=s(e)).type="f",e)),i=3*Math.max(-8,Math.min(8,Math.floor(n(t)/3))),r=Math.pow(10,-i),o=f[8+i/3];return function(e){return a(r*e)+o}}return{format:E,formatPrefix:v}}function b(t){return h=y(t),e.format=h.format,e.formatPrefix=h.formatPrefix,h}function E(e){return Math.max(0,-n(Math.abs(e)))}function v(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(n(t)/3)))-n(Math.abs(e)))}function x(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,n(t)-n(e))+1}b({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"}),e.FormatSpecifier=l,e.formatDefaultLocale=b,e.formatLocale=y,e.formatSpecifier=s,e.precisionFixed=E,e.precisionPrefix=v,e.precisionRound=x,Object.defineProperty(e,"__esModule",{value:!0})}(t)},266:function(e,t,n){!function(e,t){"use strict";function n(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function a(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function i(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function r(e){var r=e.dateTime,o=e.date,l=e.time,u=e.periods,c=e.days,d=e.shortDays,m=e.months,be=e.shortMonths,Ee=g(u),ve=h(u),xe=g(c),_e=h(c),Me=g(d),Se=h(d),Te=g(m),Ce=h(m),Oe=g(be),je=h(be),we={a:Be,A:Ye,b:Ve,B:qe,c:null,d:D,e:D,f:U,H:R,I:N,j:A,L:H,m:z,M:J,p:We,q:$e,Q:fe,s:ye,S:B,u:Y,U:V,V:q,w:W,W:$,x:null,X:null,y:G,Y:Q,Z:Z,"%":pe},ke={a:Ge,A:Qe,b:Ze,B:Ke,c:null,d:K,e:K,f:ae,H:X,I:ee,j:te,L:ne,m:ie,M:re,p:Xe,q:et,Q:fe,s:ye,S:oe,u:se,U:le,V:ue,w:ce,W:de,x:null,X:null,y:me,Y:ge,Z:he,"%":pe},Fe={a:Re,A:Ne,b:Ae,B:He,c:Ue,d:T,e:T,f:F,H:O,I:O,j:C,L:k,m:S,M:j,p:De,q:M,Q:L,s:P,S:w,u:f,U:y,V:b,w:p,W:E,x:ze,X:Je,y:x,Y:v,Z:_,"%":I};function Ie(e,t){return function(n){var a,i,r,o=[],l=-1,u=0,c=e.length;for(n instanceof Date||(n=new Date(+n));++l<c;)37===e.charCodeAt(l)&&(o.push(e.slice(u,l)),null!=(i=s[a=e.charAt(++l)])?a=e.charAt(++l):i="e"===a?" ":"0",(r=t[a])&&(a=r(n,i)),o.push(a),u=l+1);return o.push(e.slice(u,l)),o.join("")}}function Le(e,r){return function(o){var s,l,u=i(1900,void 0,1);if(Pe(u,e,o+="",0)!=o.length)return null;if("Q"in u)return new Date(u.Q);if("s"in u)return new Date(1e3*u.s+("L"in u?u.L:0));if(r&&!("Z"in u)&&(u.Z=0),"p"in u&&(u.H=u.H%12+12*u.p),void 0===u.m&&(u.m="q"in u?u.q:0),"V"in u){if(u.V<1||u.V>53)return null;"w"in u||(u.w=1),"Z"in u?(l=(s=a(i(u.y,0,1))).getUTCDay(),s=l>4||0===l?t.utcMonday.ceil(s):t.utcMonday(s),s=t.utcDay.offset(s,7*(u.V-1)),u.y=s.getUTCFullYear(),u.m=s.getUTCMonth(),u.d=s.getUTCDate()+(u.w+6)%7):(l=(s=n(i(u.y,0,1))).getDay(),s=l>4||0===l?t.timeMonday.ceil(s):t.timeMonday(s),s=t.timeDay.offset(s,7*(u.V-1)),u.y=s.getFullYear(),u.m=s.getMonth(),u.d=s.getDate()+(u.w+6)%7)}else("W"in u||"U"in u)&&("w"in u||(u.w="u"in u?u.u%7:"W"in u?1:0),l="Z"in u?a(i(u.y,0,1)).getUTCDay():n(i(u.y,0,1)).getDay(),u.m=0,u.d="W"in u?(u.w+6)%7+7*u.W-(l+5)%7:u.w+7*u.U-(l+6)%7);return"Z"in u?(u.H+=u.Z/100|0,u.M+=u.Z%100,a(u)):n(u)}}function Pe(e,t,n,a){for(var i,r,o=0,l=t.length,u=n.length;o<l;){if(a>=u)return-1;if(37===(i=t.charCodeAt(o++))){if(i=t.charAt(o++),!(r=Fe[i in s?t.charAt(o++):i])||(a=r(e,n,a))<0)return-1}else if(i!=n.charCodeAt(a++))return-1}return a}function De(e,t,n){var a=Ee.exec(t.slice(n));return a?(e.p=ve[a[0].toLowerCase()],n+a[0].length):-1}function Re(e,t,n){var a=Me.exec(t.slice(n));return a?(e.w=Se[a[0].toLowerCase()],n+a[0].length):-1}function Ne(e,t,n){var a=xe.exec(t.slice(n));return a?(e.w=_e[a[0].toLowerCase()],n+a[0].length):-1}function Ae(e,t,n){var a=Oe.exec(t.slice(n));return a?(e.m=je[a[0].toLowerCase()],n+a[0].length):-1}function He(e,t,n){var a=Te.exec(t.slice(n));return a?(e.m=Ce[a[0].toLowerCase()],n+a[0].length):-1}function Ue(e,t,n){return Pe(e,r,t,n)}function ze(e,t,n){return Pe(e,o,t,n)}function Je(e,t,n){return Pe(e,l,t,n)}function Be(e){return d[e.getDay()]}function Ye(e){return c[e.getDay()]}function Ve(e){return be[e.getMonth()]}function qe(e){return m[e.getMonth()]}function We(e){return u[+(e.getHours()>=12)]}function $e(e){return 1+~~(e.getMonth()/3)}function Ge(e){return d[e.getUTCDay()]}function Qe(e){return c[e.getUTCDay()]}function Ze(e){return be[e.getUTCMonth()]}function Ke(e){return m[e.getUTCMonth()]}function Xe(e){return u[+(e.getUTCHours()>=12)]}function et(e){return 1+~~(e.getUTCMonth()/3)}return we.x=Ie(o,we),we.X=Ie(l,we),we.c=Ie(r,we),ke.x=Ie(o,ke),ke.X=Ie(l,ke),ke.c=Ie(r,ke),{format:function(e){var t=Ie(e+="",we);return t.toString=function(){return e},t},parse:function(e){var t=Le(e+="",!1);return t.toString=function(){return e},t},utcFormat:function(e){var t=Ie(e+="",ke);return t.toString=function(){return e},t},utcParse:function(e){var t=Le(e+="",!0);return t.toString=function(){return e},t}}}var o,s={"-":"",_:" ",0:"0"},l=/^\s*\d+/,u=/^%/,c=/[\\^$*+?|[\]().{}]/g;function d(e,t,n){var a=e<0?"-":"",i=(a?-e:e)+"",r=i.length;return a+(r<n?new Array(n-r+1).join(t)+i:i)}function m(e){return e.replace(c,"\\$&")}function g(e){return new RegExp("^(?:"+e.map(m).join("|")+")","i")}function h(e){for(var t={},n=-1,a=e.length;++n<a;)t[e[n].toLowerCase()]=n;return t}function p(e,t,n){var a=l.exec(t.slice(n,n+1));return a?(e.w=+a[0],n+a[0].length):-1}function f(e,t,n){var a=l.exec(t.slice(n,n+1));return a?(e.u=+a[0],n+a[0].length):-1}function y(e,t,n){var a=l.exec(t.slice(n,n+2));return a?(e.U=+a[0],n+a[0].length):-1}function b(e,t,n){var a=l.exec(t.slice(n,n+2));return a?(e.V=+a[0],n+a[0].length):-1}function E(e,t,n){var a=l.exec(t.slice(n,n+2));return a?(e.W=+a[0],n+a[0].length):-1}function v(e,t,n){var a=l.exec(t.slice(n,n+4));return a?(e.y=+a[0],n+a[0].length):-1}function x(e,t,n){var a=l.exec(t.slice(n,n+2));return a?(e.y=+a[0]+(+a[0]>68?1900:2e3),n+a[0].length):-1}function _(e,t,n){var a=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return a?(e.Z=a[1]?0:-(a[2]+(a[3]||"00")),n+a[0].length):-1}function M(e,t,n){var a=l.exec(t.slice(n,n+1));return a?(e.q=3*a[0]-3,n+a[0].length):-1}function S(e,t,n){var a=l.exec(t.slice(n,n+2));return a?(e.m=a[0]-1,n+a[0].length):-1}function T(e,t,n){var a=l.exec(t.slice(n,n+2));return a?(e.d=+a[0],n+a[0].length):-1}function C(e,t,n){var a=l.exec(t.slice(n,n+3));return a?(e.m=0,e.d=+a[0],n+a[0].length):-1}function O(e,t,n){var a=l.exec(t.slice(n,n+2));return a?(e.H=+a[0],n+a[0].length):-1}function j(e,t,n){var a=l.exec(t.slice(n,n+2));return a?(e.M=+a[0],n+a[0].length):-1}function w(e,t,n){var a=l.exec(t.slice(n,n+2));return a?(e.S=+a[0],n+a[0].length):-1}function k(e,t,n){var a=l.exec(t.slice(n,n+3));return a?(e.L=+a[0],n+a[0].length):-1}function F(e,t,n){var a=l.exec(t.slice(n,n+6));return a?(e.L=Math.floor(a[0]/1e3),n+a[0].length):-1}function I(e,t,n){var a=u.exec(t.slice(n,n+1));return a?n+a[0].length:-1}function L(e,t,n){var a=l.exec(t.slice(n));return a?(e.Q=+a[0],n+a[0].length):-1}function P(e,t,n){var a=l.exec(t.slice(n));return a?(e.s=+a[0],n+a[0].length):-1}function D(e,t){return d(e.getDate(),t,2)}function R(e,t){return d(e.getHours(),t,2)}function N(e,t){return d(e.getHours()%12||12,t,2)}function A(e,n){return d(1+t.timeDay.count(t.timeYear(e),e),n,3)}function H(e,t){return d(e.getMilliseconds(),t,3)}function U(e,t){return H(e,t)+"000"}function z(e,t){return d(e.getMonth()+1,t,2)}function J(e,t){return d(e.getMinutes(),t,2)}function B(e,t){return d(e.getSeconds(),t,2)}function Y(e){var t=e.getDay();return 0===t?7:t}function V(e,n){return d(t.timeSunday.count(t.timeYear(e)-1,e),n,2)}function q(e,n){var a=e.getDay();return e=a>=4||0===a?t.timeThursday(e):t.timeThursday.ceil(e),d(t.timeThursday.count(t.timeYear(e),e)+(4===t.timeYear(e).getDay()),n,2)}function W(e){return e.getDay()}function $(e,n){return d(t.timeMonday.count(t.timeYear(e)-1,e),n,2)}function G(e,t){return d(e.getFullYear()%100,t,2)}function Q(e,t){return d(e.getFullYear()%1e4,t,4)}function Z(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+d(t/60|0,"0",2)+d(t%60,"0",2)}function K(e,t){return d(e.getUTCDate(),t,2)}function X(e,t){return d(e.getUTCHours(),t,2)}function ee(e,t){return d(e.getUTCHours()%12||12,t,2)}function te(e,n){return d(1+t.utcDay.count(t.utcYear(e),e),n,3)}function ne(e,t){return d(e.getUTCMilliseconds(),t,3)}function ae(e,t){return ne(e,t)+"000"}function ie(e,t){return d(e.getUTCMonth()+1,t,2)}function re(e,t){return d(e.getUTCMinutes(),t,2)}function oe(e,t){return d(e.getUTCSeconds(),t,2)}function se(e){var t=e.getUTCDay();return 0===t?7:t}function le(e,n){return d(t.utcSunday.count(t.utcYear(e)-1,e),n,2)}function ue(e,n){var a=e.getUTCDay();return e=a>=4||0===a?t.utcThursday(e):t.utcThursday.ceil(e),d(t.utcThursday.count(t.utcYear(e),e)+(4===t.utcYear(e).getUTCDay()),n,2)}function ce(e){return e.getUTCDay()}function de(e,n){return d(t.utcMonday.count(t.utcYear(e)-1,e),n,2)}function me(e,t){return d(e.getUTCFullYear()%100,t,2)}function ge(e,t){return d(e.getUTCFullYear()%1e4,t,4)}function he(){return"+0000"}function pe(){return"%"}function fe(e){return+e}function ye(e){return Math.floor(+e/1e3)}function be(t){return o=r(t),e.timeFormat=o.format,e.timeParse=o.parse,e.utcFormat=o.utcFormat,e.utcParse=o.utcParse,o}be({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var Ee="%Y-%m-%dT%H:%M:%S.%LZ";function ve(e){return e.toISOString()}var xe=Date.prototype.toISOString?ve:e.utcFormat(Ee);function _e(e){var t=new Date(e);return isNaN(t)?null:t}var Me=+new Date("2000-01-01T00:00:00.000Z")?_e:e.utcParse(Ee);e.isoFormat=xe,e.isoParse=Me,e.timeFormatDefaultLocale=be,e.timeFormatLocale=r,Object.defineProperty(e,"__esModule",{value:!0})}(t,n(210))},267:function(e,t,n){!function(e,t){"use strict";function n(e){return function(){return e}}var a=Math.abs,i=Math.atan2,r=Math.cos,o=Math.max,s=Math.min,l=Math.sin,u=Math.sqrt,c=1e-12,d=Math.PI,m=d/2,g=2*d;function h(e){return e>1?0:e<-1?d:Math.acos(e)}function p(e){return e>=1?m:e<=-1?-m:Math.asin(e)}function f(e){return e.innerRadius}function y(e){return e.outerRadius}function b(e){return e.startAngle}function E(e){return e.endAngle}function v(e){return e&&e.padAngle}function x(e,t,n,a,i,r,o,s){var l=n-e,u=a-t,d=o-i,m=s-r,g=m*l-d*u;if(!(g*g<c))return[e+(g=(d*(t-r)-m*(e-i))/g)*l,t+g*u]}function _(e,t,n,a,i,r,s){var l=e-n,c=t-a,d=(s?r:-r)/u(l*l+c*c),m=d*c,g=-d*l,h=e+m,p=t+g,f=n+m,y=a+g,b=(h+f)/2,E=(p+y)/2,v=f-h,x=y-p,_=v*v+x*x,M=i-r,S=h*y-f*p,T=(x<0?-1:1)*u(o(0,M*M*_-S*S)),C=(S*x-v*T)/_,O=(-S*v-x*T)/_,j=(S*x+v*T)/_,w=(-S*v+x*T)/_,k=C-b,F=O-E,I=j-b,L=w-E;return k*k+F*F>I*I+L*L&&(C=j,O=w),{cx:C,cy:O,x01:-m,y01:-g,x11:C*(i/M-1),y11:O*(i/M-1)}}function M(){var e=f,o=y,M=n(0),S=null,T=b,C=E,O=v,j=null;function w(){var n,f,y=+e.apply(this,arguments),b=+o.apply(this,arguments),E=T.apply(this,arguments)-m,v=C.apply(this,arguments)-m,w=a(v-E),k=v>E;if(j||(j=n=t.path()),b<y&&(f=b,b=y,y=f),b>c)if(w>g-c)j.moveTo(b*r(E),b*l(E)),j.arc(0,0,b,E,v,!k),y>c&&(j.moveTo(y*r(v),y*l(v)),j.arc(0,0,y,v,E,k));else{var F,I,L=E,P=v,D=E,R=v,N=w,A=w,H=O.apply(this,arguments)/2,U=H>c&&(S?+S.apply(this,arguments):u(y*y+b*b)),z=s(a(b-y)/2,+M.apply(this,arguments)),J=z,B=z;if(U>c){var Y=p(U/y*l(H)),V=p(U/b*l(H));(N-=2*Y)>c?(D+=Y*=k?1:-1,R-=Y):(N=0,D=R=(E+v)/2),(A-=2*V)>c?(L+=V*=k?1:-1,P-=V):(A=0,L=P=(E+v)/2)}var q=b*r(L),W=b*l(L),$=y*r(R),G=y*l(R);if(z>c){var Q,Z=b*r(P),K=b*l(P),X=y*r(D),ee=y*l(D);if(w<d&&(Q=x(q,W,X,ee,Z,K,$,G))){var te=q-Q[0],ne=W-Q[1],ae=Z-Q[0],ie=K-Q[1],re=1/l(h((te*ae+ne*ie)/(u(te*te+ne*ne)*u(ae*ae+ie*ie)))/2),oe=u(Q[0]*Q[0]+Q[1]*Q[1]);J=s(z,(y-oe)/(re-1)),B=s(z,(b-oe)/(re+1))}}A>c?B>c?(F=_(X,ee,q,W,b,B,k),I=_(Z,K,$,G,b,B,k),j.moveTo(F.cx+F.x01,F.cy+F.y01),B<z?j.arc(F.cx,F.cy,B,i(F.y01,F.x01),i(I.y01,I.x01),!k):(j.arc(F.cx,F.cy,B,i(F.y01,F.x01),i(F.y11,F.x11),!k),j.arc(0,0,b,i(F.cy+F.y11,F.cx+F.x11),i(I.cy+I.y11,I.cx+I.x11),!k),j.arc(I.cx,I.cy,B,i(I.y11,I.x11),i(I.y01,I.x01),!k))):(j.moveTo(q,W),j.arc(0,0,b,L,P,!k)):j.moveTo(q,W),y>c&&N>c?J>c?(F=_($,G,Z,K,y,-J,k),I=_(q,W,X,ee,y,-J,k),j.lineTo(F.cx+F.x01,F.cy+F.y01),J<z?j.arc(F.cx,F.cy,J,i(F.y01,F.x01),i(I.y01,I.x01),!k):(j.arc(F.cx,F.cy,J,i(F.y01,F.x01),i(F.y11,F.x11),!k),j.arc(0,0,y,i(F.cy+F.y11,F.cx+F.x11),i(I.cy+I.y11,I.cx+I.x11),k),j.arc(I.cx,I.cy,J,i(I.y11,I.x11),i(I.y01,I.x01),!k))):j.arc(0,0,y,R,D,k):j.lineTo($,G)}else j.moveTo(0,0);if(j.closePath(),n)return j=null,n+""||null}return w.centroid=function(){var t=(+e.apply(this,arguments)+ +o.apply(this,arguments))/2,n=(+T.apply(this,arguments)+ +C.apply(this,arguments))/2-d/2;return[r(n)*t,l(n)*t]},w.innerRadius=function(t){return arguments.length?(e="function"==typeof t?t:n(+t),w):e},w.outerRadius=function(e){return arguments.length?(o="function"==typeof e?e:n(+e),w):o},w.cornerRadius=function(e){return arguments.length?(M="function"==typeof e?e:n(+e),w):M},w.padRadius=function(e){return arguments.length?(S=null==e?null:"function"==typeof e?e:n(+e),w):S},w.startAngle=function(e){return arguments.length?(T="function"==typeof e?e:n(+e),w):T},w.endAngle=function(e){return arguments.length?(C="function"==typeof e?e:n(+e),w):C},w.padAngle=function(e){return arguments.length?(O="function"==typeof e?e:n(+e),w):O},w.context=function(e){return arguments.length?(j=null==e?null:e,w):j},w}function S(e){this._context=e}function T(e){return new S(e)}function C(e){return e[0]}function O(e){return e[1]}function j(){var e=C,a=O,i=n(!0),r=null,o=T,s=null;function l(n){var l,u,c,d=n.length,m=!1;for(null==r&&(s=o(c=t.path())),l=0;l<=d;++l)!(l<d&&i(u=n[l],l,n))===m&&((m=!m)?s.lineStart():s.lineEnd()),m&&s.point(+e(u,l,n),+a(u,l,n));if(c)return s=null,c+""||null}return l.x=function(t){return arguments.length?(e="function"==typeof t?t:n(+t),l):e},l.y=function(e){return arguments.length?(a="function"==typeof e?e:n(+e),l):a},l.defined=function(e){return arguments.length?(i="function"==typeof e?e:n(!!e),l):i},l.curve=function(e){return arguments.length?(o=e,null!=r&&(s=o(r)),l):o},l.context=function(e){return arguments.length?(null==e?r=s=null:s=o(r=e),l):r},l}function w(){var e=C,a=null,i=n(0),r=O,o=n(!0),s=null,l=T,u=null;function c(n){var c,d,m,g,h,p=n.length,f=!1,y=new Array(p),b=new Array(p);for(null==s&&(u=l(h=t.path())),c=0;c<=p;++c){if(!(c<p&&o(g=n[c],c,n))===f)if(f=!f)d=c,u.areaStart(),u.lineStart();else{for(u.lineEnd(),u.lineStart(),m=c-1;m>=d;--m)u.point(y[m],b[m]);u.lineEnd(),u.areaEnd()}f&&(y[c]=+e(g,c,n),b[c]=+i(g,c,n),u.point(a?+a(g,c,n):y[c],r?+r(g,c,n):b[c]))}if(h)return u=null,h+""||null}function d(){return j().defined(o).curve(l).context(s)}return c.x=function(t){return arguments.length?(e="function"==typeof t?t:n(+t),a=null,c):e},c.x0=function(t){return arguments.length?(e="function"==typeof t?t:n(+t),c):e},c.x1=function(e){return arguments.length?(a=null==e?null:"function"==typeof e?e:n(+e),c):a},c.y=function(e){return arguments.length?(i="function"==typeof e?e:n(+e),r=null,c):i},c.y0=function(e){return arguments.length?(i="function"==typeof e?e:n(+e),c):i},c.y1=function(e){return arguments.length?(r=null==e?null:"function"==typeof e?e:n(+e),c):r},c.lineX0=c.lineY0=function(){return d().x(e).y(i)},c.lineY1=function(){return d().x(e).y(r)},c.lineX1=function(){return d().x(a).y(i)},c.defined=function(e){return arguments.length?(o="function"==typeof e?e:n(!!e),c):o},c.curve=function(e){return arguments.length?(l=e,null!=s&&(u=l(s)),c):l},c.context=function(e){return arguments.length?(null==e?s=u=null:u=l(s=e),c):s},c}function k(e,t){return t<e?-1:t>e?1:t>=e?0:NaN}function F(e){return e}function I(){var e=F,t=k,a=null,i=n(0),r=n(g),o=n(0);function s(n){var s,l,u,c,d,m=n.length,h=0,p=new Array(m),f=new Array(m),y=+i.apply(this,arguments),b=Math.min(g,Math.max(-g,r.apply(this,arguments)-y)),E=Math.min(Math.abs(b)/m,o.apply(this,arguments)),v=E*(b<0?-1:1);for(s=0;s<m;++s)(d=f[p[s]=s]=+e(n[s],s,n))>0&&(h+=d);for(null!=t?p.sort((function(e,n){return t(f[e],f[n])})):null!=a&&p.sort((function(e,t){return a(n[e],n[t])})),s=0,u=h?(b-m*v)/h:0;s<m;++s,y=c)l=p[s],c=y+((d=f[l])>0?d*u:0)+v,f[l]={data:n[l],index:s,value:d,startAngle:y,endAngle:c,padAngle:E};return f}return s.value=function(t){return arguments.length?(e="function"==typeof t?t:n(+t),s):e},s.sortValues=function(e){return arguments.length?(t=e,a=null,s):t},s.sort=function(e){return arguments.length?(a=e,t=null,s):a},s.startAngle=function(e){return arguments.length?(i="function"==typeof e?e:n(+e),s):i},s.endAngle=function(e){return arguments.length?(r="function"==typeof e?e:n(+e),s):r},s.padAngle=function(e){return arguments.length?(o="function"==typeof e?e:n(+e),s):o},s}S.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t)}}};var L=D(T);function P(e){this._curve=e}function D(e){function t(t){return new P(e(t))}return t._curve=e,t}function R(e){var t=e.curve;return e.angle=e.x,delete e.x,e.radius=e.y,delete e.y,e.curve=function(e){return arguments.length?t(D(e)):t()._curve},e}function N(){return R(j().curve(L))}function A(){var e=w().curve(L),t=e.curve,n=e.lineX0,a=e.lineX1,i=e.lineY0,r=e.lineY1;return e.angle=e.x,delete e.x,e.startAngle=e.x0,delete e.x0,e.endAngle=e.x1,delete e.x1,e.radius=e.y,delete e.y,e.innerRadius=e.y0,delete e.y0,e.outerRadius=e.y1,delete e.y1,e.lineStartAngle=function(){return R(n())},delete e.lineX0,e.lineEndAngle=function(){return R(a())},delete e.lineX1,e.lineInnerRadius=function(){return R(i())},delete e.lineY0,e.lineOuterRadius=function(){return R(r())},delete e.lineY1,e.curve=function(e){return arguments.length?t(D(e)):t()._curve},e}function H(e,t){return[(t=+t)*Math.cos(e-=Math.PI/2),t*Math.sin(e)]}P.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(e,t){this._curve.point(t*Math.sin(e),t*-Math.cos(e))}};var U=Array.prototype.slice;function z(e){return e.source}function J(e){return e.target}function B(e){var a=z,i=J,r=C,o=O,s=null;function l(){var n,l=U.call(arguments),u=a.apply(this,l),c=i.apply(this,l);if(s||(s=n=t.path()),e(s,+r.apply(this,(l[0]=u,l)),+o.apply(this,l),+r.apply(this,(l[0]=c,l)),+o.apply(this,l)),n)return s=null,n+""||null}return l.source=function(e){return arguments.length?(a=e,l):a},l.target=function(e){return arguments.length?(i=e,l):i},l.x=function(e){return arguments.length?(r="function"==typeof e?e:n(+e),l):r},l.y=function(e){return arguments.length?(o="function"==typeof e?e:n(+e),l):o},l.context=function(e){return arguments.length?(s=null==e?null:e,l):s},l}function Y(e,t,n,a,i){e.moveTo(t,n),e.bezierCurveTo(t=(t+a)/2,n,t,i,a,i)}function V(e,t,n,a,i){e.moveTo(t,n),e.bezierCurveTo(t,n=(n+i)/2,a,n,a,i)}function q(e,t,n,a,i){var r=H(t,n),o=H(t,n=(n+i)/2),s=H(a,n),l=H(a,i);e.moveTo(r[0],r[1]),e.bezierCurveTo(o[0],o[1],s[0],s[1],l[0],l[1])}function W(){return B(Y)}function $(){return B(V)}function G(){var e=B(q);return e.angle=e.x,delete e.x,e.radius=e.y,delete e.y,e}var Q={draw:function(e,t){var n=Math.sqrt(t/d);e.moveTo(n,0),e.arc(0,0,n,0,g)}},Z={draw:function(e,t){var n=Math.sqrt(t/5)/2;e.moveTo(-3*n,-n),e.lineTo(-n,-n),e.lineTo(-n,-3*n),e.lineTo(n,-3*n),e.lineTo(n,-n),e.lineTo(3*n,-n),e.lineTo(3*n,n),e.lineTo(n,n),e.lineTo(n,3*n),e.lineTo(-n,3*n),e.lineTo(-n,n),e.lineTo(-3*n,n),e.closePath()}},K=Math.sqrt(1/3),X=2*K,ee={draw:function(e,t){var n=Math.sqrt(t/X),a=n*K;e.moveTo(0,-n),e.lineTo(a,0),e.lineTo(0,n),e.lineTo(-a,0),e.closePath()}},te=.8908130915292852,ne=Math.sin(d/10)/Math.sin(7*d/10),ae=Math.sin(g/10)*ne,ie=-Math.cos(g/10)*ne,re={draw:function(e,t){var n=Math.sqrt(t*te),a=ae*n,i=ie*n;e.moveTo(0,-n),e.lineTo(a,i);for(var r=1;r<5;++r){var o=g*r/5,s=Math.cos(o),l=Math.sin(o);e.lineTo(l*n,-s*n),e.lineTo(s*a-l*i,l*a+s*i)}e.closePath()}},oe={draw:function(e,t){var n=Math.sqrt(t),a=-n/2;e.rect(a,a,n,n)}},se=Math.sqrt(3),le={draw:function(e,t){var n=-Math.sqrt(t/(3*se));e.moveTo(0,2*n),e.lineTo(-se*n,-n),e.lineTo(se*n,-n),e.closePath()}},ue=-.5,ce=Math.sqrt(3)/2,de=1/Math.sqrt(12),me=3*(de/2+1),ge={draw:function(e,t){var n=Math.sqrt(t/me),a=n/2,i=n*de,r=a,o=n*de+n,s=-r,l=o;e.moveTo(a,i),e.lineTo(r,o),e.lineTo(s,l),e.lineTo(ue*a-ce*i,ce*a+ue*i),e.lineTo(ue*r-ce*o,ce*r+ue*o),e.lineTo(ue*s-ce*l,ce*s+ue*l),e.lineTo(ue*a+ce*i,ue*i-ce*a),e.lineTo(ue*r+ce*o,ue*o-ce*r),e.lineTo(ue*s+ce*l,ue*l-ce*s),e.closePath()}},he=[Q,Z,ee,oe,re,le,ge];function pe(){var e=n(Q),a=n(64),i=null;function r(){var n;if(i||(i=n=t.path()),e.apply(this,arguments).draw(i,+a.apply(this,arguments)),n)return i=null,n+""||null}return r.type=function(t){return arguments.length?(e="function"==typeof t?t:n(t),r):e},r.size=function(e){return arguments.length?(a="function"==typeof e?e:n(+e),r):a},r.context=function(e){return arguments.length?(i=null==e?null:e,r):i},r}function fe(){}function ye(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function be(e){this._context=e}function Ee(e){return new be(e)}function ve(e){this._context=e}function xe(e){return new ve(e)}function _e(e){this._context=e}function Me(e){return new _e(e)}function Se(e,t){this._basis=new be(e),this._beta=t}be.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:ye(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:ye(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},ve.prototype={areaStart:fe,areaEnd:fe,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:ye(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},_e.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,a=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,a):this._context.moveTo(n,a);break;case 3:this._point=4;default:ye(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},Se.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var a,i=e[0],r=t[0],o=e[n]-i,s=t[n]-r,l=-1;++l<=n;)a=l/n,this._basis.point(this._beta*e[l]+(1-this._beta)*(i+a*o),this._beta*t[l]+(1-this._beta)*(r+a*s));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};var Te=function e(t){function n(e){return 1===t?new be(e):new Se(e,t)}return n.beta=function(t){return e(+t)},n}(.85);function Ce(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function Oe(e,t){this._context=e,this._k=(1-t)/6}Oe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:Ce(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:Ce(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var je=function e(t){function n(e){return new Oe(e,t)}return n.tension=function(t){return e(+t)},n}(0);function we(e,t){this._context=e,this._k=(1-t)/6}we.prototype={areaStart:fe,areaEnd:fe,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:Ce(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var ke=function e(t){function n(e){return new we(e,t)}return n.tension=function(t){return e(+t)},n}(0);function Fe(e,t){this._context=e,this._k=(1-t)/6}Fe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Ce(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var Ie=function e(t){function n(e){return new Fe(e,t)}return n.tension=function(t){return e(+t)},n}(0);function Le(e,t,n){var a=e._x1,i=e._y1,r=e._x2,o=e._y2;if(e._l01_a>c){var s=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,l=3*e._l01_a*(e._l01_a+e._l12_a);a=(a*s-e._x0*e._l12_2a+e._x2*e._l01_2a)/l,i=(i*s-e._y0*e._l12_2a+e._y2*e._l01_2a)/l}if(e._l23_a>c){var u=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,d=3*e._l23_a*(e._l23_a+e._l12_a);r=(r*u+e._x1*e._l23_2a-t*e._l12_2a)/d,o=(o*u+e._y1*e._l23_2a-n*e._l12_2a)/d}e._context.bezierCurveTo(a,i,r,o,e._x2,e._y2)}function Pe(e,t){this._context=e,this._alpha=t}Pe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,a=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+a*a,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:Le(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var De=function e(t){function n(e){return t?new Pe(e,t):new Oe(e,0)}return n.alpha=function(t){return e(+t)},n}(.5);function Re(e,t){this._context=e,this._alpha=t}Re.prototype={areaStart:fe,areaEnd:fe,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,a=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+a*a,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:Le(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var Ne=function e(t){function n(e){return t?new Re(e,t):new we(e,0)}return n.alpha=function(t){return e(+t)},n}(.5);function Ae(e,t){this._context=e,this._alpha=t}Ae.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,a=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+a*a,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Le(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var He=function e(t){function n(e){return t?new Ae(e,t):new Fe(e,0)}return n.alpha=function(t){return e(+t)},n}(.5);function Ue(e){this._context=e}function ze(e){return new Ue(e)}function Je(e){return e<0?-1:1}function Be(e,t,n){var a=e._x1-e._x0,i=t-e._x1,r=(e._y1-e._y0)/(a||i<0&&-0),o=(n-e._y1)/(i||a<0&&-0),s=(r*i+o*a)/(a+i);return(Je(r)+Je(o))*Math.min(Math.abs(r),Math.abs(o),.5*Math.abs(s))||0}function Ye(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function Ve(e,t,n){var a=e._x0,i=e._y0,r=e._x1,o=e._y1,s=(r-a)/3;e._context.bezierCurveTo(a+s,i+s*t,r-s,o-s*n,r,o)}function qe(e){this._context=e}function We(e){this._context=new $e(e)}function $e(e){this._context=e}function Ge(e){return new qe(e)}function Qe(e){return new We(e)}function Ze(e){this._context=e}function Ke(e){var t,n,a=e.length-1,i=new Array(a),r=new Array(a),o=new Array(a);for(i[0]=0,r[0]=2,o[0]=e[0]+2*e[1],t=1;t<a-1;++t)i[t]=1,r[t]=4,o[t]=4*e[t]+2*e[t+1];for(i[a-1]=2,r[a-1]=7,o[a-1]=8*e[a-1]+e[a],t=1;t<a;++t)n=i[t]/r[t-1],r[t]-=n,o[t]-=n*o[t-1];for(i[a-1]=o[a-1]/r[a-1],t=a-2;t>=0;--t)i[t]=(o[t]-i[t+1])/r[t];for(r[a-1]=(e[a]+i[a-1])/2,t=0;t<a-1;++t)r[t]=2*e[t+1]-i[t+1];return[i,r]}function Xe(e){return new Ze(e)}function et(e,t){this._context=e,this._t=t}function tt(e){return new et(e,.5)}function nt(e){return new et(e,0)}function at(e){return new et(e,1)}function it(e,t){if((i=e.length)>1)for(var n,a,i,r=1,o=e[t[0]],s=o.length;r<i;++r)for(a=o,o=e[t[r]],n=0;n<s;++n)o[n][1]+=o[n][0]=isNaN(a[n][1])?a[n][0]:a[n][1]}function rt(e){for(var t=e.length,n=new Array(t);--t>=0;)n[t]=t;return n}function ot(e,t){return e[t]}function st(){var e=n([]),t=rt,a=it,i=ot;function r(n){var r,o,s=e.apply(this,arguments),l=n.length,u=s.length,c=new Array(u);for(r=0;r<u;++r){for(var d,m=s[r],g=c[r]=new Array(l),h=0;h<l;++h)g[h]=d=[0,+i(n[h],m,h,n)],d.data=n[h];g.key=m}for(r=0,o=t(c);r<u;++r)c[o[r]].index=r;return a(c,o),c}return r.keys=function(t){return arguments.length?(e="function"==typeof t?t:n(U.call(t)),r):e},r.value=function(e){return arguments.length?(i="function"==typeof e?e:n(+e),r):i},r.order=function(e){return arguments.length?(t=null==e?rt:"function"==typeof e?e:n(U.call(e)),r):t},r.offset=function(e){return arguments.length?(a=null==e?it:e,r):a},r}function lt(e,t){if((a=e.length)>0){for(var n,a,i,r=0,o=e[0].length;r<o;++r){for(i=n=0;n<a;++n)i+=e[n][r][1]||0;if(i)for(n=0;n<a;++n)e[n][r][1]/=i}it(e,t)}}function ut(e,t){if((s=e.length)>0)for(var n,a,i,r,o,s,l=0,u=e[t[0]].length;l<u;++l)for(r=o=0,n=0;n<s;++n)(i=(a=e[t[n]][l])[1]-a[0])>0?(a[0]=r,a[1]=r+=i):i<0?(a[1]=o,a[0]=o+=i):(a[0]=0,a[1]=i)}function ct(e,t){if((n=e.length)>0){for(var n,a=0,i=e[t[0]],r=i.length;a<r;++a){for(var o=0,s=0;o<n;++o)s+=e[o][a][1]||0;i[a][1]+=i[a][0]=-s/2}it(e,t)}}function dt(e,t){if((i=e.length)>0&&(a=(n=e[t[0]]).length)>0){for(var n,a,i,r=0,o=1;o<a;++o){for(var s=0,l=0,u=0;s<i;++s){for(var c=e[t[s]],d=c[o][1]||0,m=(d-(c[o-1][1]||0))/2,g=0;g<s;++g){var h=e[t[g]];m+=(h[o][1]||0)-(h[o-1][1]||0)}l+=d,u+=m*d}n[o-1][1]+=n[o-1][0]=r,l&&(r-=u/l)}n[o-1][1]+=n[o-1][0]=r,it(e,t)}}function mt(e){var t=e.map(gt);return rt(e).sort((function(e,n){return t[e]-t[n]}))}function gt(e){for(var t,n=-1,a=0,i=e.length,r=-1/0;++n<i;)(t=+e[n][1])>r&&(r=t,a=n);return a}function ht(e){var t=e.map(pt);return rt(e).sort((function(e,n){return t[e]-t[n]}))}function pt(e){for(var t,n=0,a=-1,i=e.length;++a<i;)(t=+e[a][1])&&(n+=t);return n}function ft(e){return ht(e).reverse()}function yt(e){var t,n,a=e.length,i=e.map(pt),r=mt(e),o=0,s=0,l=[],u=[];for(t=0;t<a;++t)n=r[t],o<s?(o+=i[n],l.push(n)):(s+=i[n],u.push(n));return u.reverse().concat(l)}function bt(e){return rt(e).reverse()}Ue.prototype={areaStart:fe,areaEnd:fe,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}},qe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Ve(this,this._t0,Ye(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(t=+t,(e=+e)!==this._x1||t!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,Ve(this,Ye(this,n=Be(this,e,t)),n);break;default:Ve(this,this._t0,n=Be(this,e,t))}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}},(We.prototype=Object.create(qe.prototype)).point=function(e,t){qe.prototype.point.call(this,t,e)},$e.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,a,i,r){this._context.bezierCurveTo(t,e,a,n,r,i)}},Ze.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),2===n)this._context.lineTo(e[1],t[1]);else for(var a=Ke(e),i=Ke(t),r=0,o=1;o<n;++r,++o)this._context.bezierCurveTo(a[0][r],i[0][r],a[1][r],i[1][r],e[o],t[o]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}},et.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}}this._x=e,this._y=t}},e.arc=M,e.area=w,e.areaRadial=A,e.curveBasis=Ee,e.curveBasisClosed=xe,e.curveBasisOpen=Me,e.curveBundle=Te,e.curveCardinal=je,e.curveCardinalClosed=ke,e.curveCardinalOpen=Ie,e.curveCatmullRom=De,e.curveCatmullRomClosed=Ne,e.curveCatmullRomOpen=He,e.curveLinear=T,e.curveLinearClosed=ze,e.curveMonotoneX=Ge,e.curveMonotoneY=Qe,e.curveNatural=Xe,e.curveStep=tt,e.curveStepAfter=at,e.curveStepBefore=nt,e.line=j,e.lineRadial=N,e.linkHorizontal=W,e.linkRadial=G,e.linkVertical=$,e.pie=I,e.pointRadial=H,e.radialArea=A,e.radialLine=N,e.stack=st,e.stackOffsetDiverging=ut,e.stackOffsetExpand=lt,e.stackOffsetNone=it,e.stackOffsetSilhouette=ct,e.stackOffsetWiggle=dt,e.stackOrderAppearance=mt,e.stackOrderAscending=ht,e.stackOrderDescending=ft,e.stackOrderInsideOut=yt,e.stackOrderNone=rt,e.stackOrderReverse=bt,e.symbol=pe,e.symbolCircle=Q,e.symbolCross=Z,e.symbolDiamond=ee,e.symbolSquare=oe,e.symbolStar=re,e.symbolTriangle=le,e.symbolWye=ge,e.symbols=he,Object.defineProperty(e,"__esModule",{value:!0})}(t,n(268))},268:function(e,t,n){!function(e){"use strict";var t=Math.PI,n=2*t,a=1e-6,i=n-a;function r(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function o(){return new r}r.prototype=o.prototype={constructor:r,moveTo:function(e,t){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(e,t){this._+="L"+(this._x1=+e)+","+(this._y1=+t)},quadraticCurveTo:function(e,t,n,a){this._+="Q"+ +e+","+ +t+","+(this._x1=+n)+","+(this._y1=+a)},bezierCurveTo:function(e,t,n,a,i,r){this._+="C"+ +e+","+ +t+","+ +n+","+ +a+","+(this._x1=+i)+","+(this._y1=+r)},arcTo:function(e,n,i,r,o){e=+e,n=+n,i=+i,r=+r,o=+o;var s=this._x1,l=this._y1,u=i-e,c=r-n,d=s-e,m=l-n,g=d*d+m*m;if(o<0)throw new Error("negative radius: "+o);if(null===this._x1)this._+="M"+(this._x1=e)+","+(this._y1=n);else if(g>a)if(Math.abs(m*u-c*d)>a&&o){var h=i-s,p=r-l,f=u*u+c*c,y=h*h+p*p,b=Math.sqrt(f),E=Math.sqrt(g),v=o*Math.tan((t-Math.acos((f+g-y)/(2*b*E)))/2),x=v/E,_=v/b;Math.abs(x-1)>a&&(this._+="L"+(e+x*d)+","+(n+x*m)),this._+="A"+o+","+o+",0,0,"+ +(m*h>d*p)+","+(this._x1=e+_*u)+","+(this._y1=n+_*c)}else this._+="L"+(this._x1=e)+","+(this._y1=n)},arc:function(e,r,o,s,l,u){e=+e,r=+r,u=!!u;var c=(o=+o)*Math.cos(s),d=o*Math.sin(s),m=e+c,g=r+d,h=1^u,p=u?s-l:l-s;if(o<0)throw new Error("negative radius: "+o);null===this._x1?this._+="M"+m+","+g:(Math.abs(this._x1-m)>a||Math.abs(this._y1-g)>a)&&(this._+="L"+m+","+g),o&&(p<0&&(p=p%n+n),p>i?this._+="A"+o+","+o+",0,1,"+h+","+(e-c)+","+(r-d)+"A"+o+","+o+",0,1,"+h+","+(this._x1=m)+","+(this._y1=g):p>a&&(this._+="A"+o+","+o+",0,"+ +(p>=t)+","+h+","+(this._x1=e+o*Math.cos(l))+","+(this._y1=r+o*Math.sin(l))))},rect:function(e,t,n,a){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)+"h"+ +n+"v"+ +a+"h"+-n+"Z"},toString:function(){return this._}},e.path=o,Object.defineProperty(e,"__esModule",{value:!0})}(t)},294:function(e,t,n){"use strict";n.r(t),n.d(t,"renderApp",(function(){return ll}));var a=n(2),i=n.n(a),r=n(26),o=n.n(r),s=n(66),l=n(40),u=(n(188),n(189)),c=n(184),d=n(12),m=n(35),g=n.n(m),h=n(1),p=n(100),f=n.n(p),y=n(52),b=n(3),E=n(107),v=n(198),x=n(86),_=n(199),M=n(200),S=n(33),T=n(95);const C=e=>{Object(M.a)(S.b,T.d,e)};var O=n(82),j=n(106),w=n(180),k=n(17),F=n(0),I=n(18);const L=async(e,t)=>{const{spaceId:n,sourceId:a,jobTypes:i}=e,r=await t("/api/ml/jobs/jobs_summary",{method:"POST",body:JSON.stringify(P.encode({jobIds:i.map((e=>Object(O.k)(n,a,e)))}))});return Object(I.b)(z)(r)},P=F.type({jobIds:F.array(F.string)}),D=F.keyof({started:null,starting:null,stopped:null,stopping:null,"":null}),R=F.keyof({closed:null,closing:null,deleting:null,failed:null,opened:null,opening:null}),N=F.partial({per_partition_categorization:F.intersection([F.type({enabled:F.boolean}),F.partial({stop_on_warn:F.boolean})])}),A=F.keyof({ok:null,warn:null}),H=F.type({categorization_status:A,categorized_doc_count:F.number,dead_category_count:F.number,frequent_category_count:F.number,log_time:F.number,rare_category_count:F.number,total_category_count:F.number}),U=F.intersection([F.type({id:F.string,jobState:R}),F.partial({awaitingNodeAssignment:F.boolean,datafeedIndices:F.array(F.string),datafeedState:D,fullJob:F.partial({analysis_config:N,create_time:F.number,custom_settings:O.q,finished_time:F.number,model_size_stats:H,datafeed_config:F.partial({runtime_mappings:F.UnknownRecord})})})]),z=F.array(U),J=async(e,t)=>{const n=await t(`/api/ml/modules/get_module/${e}`,{method:"GET"});return Object(I.b)(Y)(n)},B=F.type({id:F.string,config:F.type({custom_settings:O.q})}),Y=F.type({id:F.string,jobs:F.array(B)}),V=async(e,t)=>{const{moduleId:n,start:a,end:i,spaceId:r,sourceId:o,indexPattern:s,jobOverrides:l=[],datafeedOverrides:u=[],query:c,useDedicatedIndex:d=!1}=e,m=await t(`/api/ml/modules/setup/${n}`,{method:"POST",body:JSON.stringify(Q.encode({start:a,end:i,indexPatternName:s,prefix:Object(O.l)(r,o),startDatafeed:!0,jobOverrides:l,datafeedOverrides:u,query:c,useDedicatedIndex:d}))});return Object(I.b)(te)(m)},q=F.partial({start:F.number,end:F.number}),W=F.type({job_id:F.string,custom_settings:O.q}),$=F.object,G=F.intersection([F.strict({indexPatternName:F.string,prefix:F.string,startDatafeed:F.boolean,jobOverrides:F.array(W),datafeedOverrides:F.array($),useDedicatedIndex:F.boolean}),F.exact(F.partial({query:F.object}))]),Q=F.intersection([q,G]),Z=F.type({reason:F.string,type:F.string}),K=F.type({status:F.number,error:F.intersection([Z,F.type({root_cause:F.array(Z)})])}),X=F.intersection([F.type({id:F.string,started:F.boolean,success:F.boolean}),F.partial({awaitingNodeAssignment:F.boolean,error:K})]),ee=F.intersection([F.type({id:F.string,success:F.boolean}),F.partial({error:K})]),te=F.type({datafeeds:F.array(X),jobs:F.array(ee)});var ne=n(97);const ae=async(e,t)=>{const{indices:n,timestampField:a,startTime:i,endTime:r,runtimeMappings:o}=e,s=await t(ne.c,{method:"POST",body:JSON.stringify(ne.t.encode({data:{endTime:r,indices:n,startTime:i,timestampField:a,runtimeMappings:o}}))});return Object(I.b)(ne.u)(s)},ie=async(e,t)=>{const{indices:n,fields:a,runtimeMappings:i}=e,r=await t(ne.d,{method:"POST",body:JSON.stringify(ne.w.encode({data:{indices:n,fields:a,runtimeMappings:i}}))});return Object(I.b)(ne.x)(r)},re=async e=>{const t=await e("/api/ml/jobs/deleting_jobs_tasks");return Object(I.b)(le)(t)},oe=F.type({jobIds:F.array(F.string)}),se=F.record(F.string,F.type({deleted:F.boolean})),le=F.type({jobIds:F.array(F.string)}),ue=F.type({datafeedIds:F.array(F.string)}),ce=F.record(F.string,F.type({stopped:F.boolean})),de=async(e,t,n,a)=>{try{await(async(e,t)=>{const{spaceId:n,sourceId:a,jobTypes:i}=e,r=await t("/api/ml/jobs/stop_datafeeds",{method:"POST",body:JSON.stringify(ue.encode({datafeedIds:i.map((e=>Object(O.i)(n,a,e)))}))});return Object(I.b)(ce)(r)})({spaceId:e,sourceId:t,jobTypes:n},a)}catch(e){var i;if(404!==(null==e||null===(i=e.res)||void 0===i?void 0:i.status))throw e}return await me(e,t,n,a)},me=async(e,t,n,a)=>{const i=await(async(e,t)=>{const{spaceId:n,sourceId:a,jobTypes:i}=e,r=await t("/api/ml/jobs/delete_jobs",{method:"POST",body:JSON.stringify(oe.encode({jobIds:i.map((e=>Object(O.k)(n,a,e)))}))});return Object(I.b)(se)(r)})({spaceId:e,sourceId:t,jobTypes:n},a);return await ge(e,t,n,a),i},ge=async(e,t,n,a)=>{const i=n.map((n=>Object(O.k)(e,t,n)));for(;;){const{jobIds:e}=await re(a);if(!e.some((e=>i.includes(e))))return!0;await he(1e3)}},he=e=>new Promise((t=>setTimeout(t,e))),pe="logs_ui_categories",fe=h.i18n.translate("xpack.infra.logs.analysis.logEntryCategoriesModuleName",{defaultMessage:"Categorization"}),ye=h.i18n.translate("xpack.infra.logs.analysis.logEntryCategoriesModuleDescription",{defaultMessage:"Use Machine Learning to automatically categorize log messages."}),be=(e,t)=>O.t.reduce(((n,a)=>({...n,[a]:Object(O.k)(e,t,a)})),{}),Ee={moduleId:pe,moduleName:fe,moduleDescription:ye,jobTypes:O.t,bucketSpan:O.c,getJobIds:be,getJobSummary:async(e,t,n)=>{const a=await L({spaceId:e,sourceId:t,jobTypes:O.t},n),i=Object.values(be(e,t));return a.filter((e=>i.includes(e.id)))},getModuleDefinition:async e=>await J(pe,e),setUpModule:async(e,t,n,{spaceId:a,sourceId:i,indices:r,timestampField:o,runtimeMappings:s},l)=>{const u=r.join(","),c=[{job_id:"log-entry-categories-count",analysis_config:{bucket_span:`${O.c}ms`},data_description:{time_field:o},custom_settings:{logs_source_config:{indexPattern:u,timestampField:o,bucketSpan:O.c,datasetFilter:n}}}],d=[{job_id:"log-entry-categories-count",runtime_mappings:s}],m={bool:{filter:[..."includeSome"===n.type?[{terms:{"event.dataset":n.datasets}}]:[],{exists:{field:"message"}}]}};return V({moduleId:pe,start:e,end:t,spaceId:a,sourceId:i,indexPattern:u,jobOverrides:c,datafeedOverrides:d,query:m,useDedicatedIndex:!0},l)},cleanUpModule:async(e,t,n)=>await de(e,t,O.t,n),validateSetupDatasets:async(e,t,n,a,i,r)=>await ae({indices:e,timestampField:t,startTime:n,endTime:a,runtimeMappings:i},r),validateSetupIndices:async(e,t,n,a)=>await ie({indices:e,fields:[{name:t,validTypes:["date"]},{name:O.z,validTypes:["keyword"]},{name:O.d,validTypes:["text"]}],runtimeMappings:n},a)};var ve=n(83),xe=n.n(ve),_e=n(19),Me=n(84);const Se=({jobTypes:e})=>({jobStatus:e.reduce(((e,t)=>({...e,[t]:"unknown"})),{}),jobSummaries:[],lastSetupErrorMessages:[],setupStatus:{type:"initializing"}}),Te=e=>t=>t.filter((t=>t.id===e&&t.success&&!t.error)).length>0,Ce=e=>t=>t.filter((t=>t.id===e&&t.success&&t.started&&!t.error)).length>0,Oe=e=>t=>t.filter((t=>t.id===e)).map((e=>"failed"===e.jobState||""===e.datafeedState?"failed":"closed"===e.jobState&&"stopped"===e.datafeedState&&e.fullJob&&null!=e.fullJob.finished_time?"finished":"closed"===e.jobState||"closing"===e.jobState||"stopped"===e.datafeedState?"stopped":"opening"===e.jobState&&!1===e.awaitingNodeAssignment?"initializing":"opened"===e.jobState&&"started"===e.datafeedState||"opening"===e.jobState&&"starting"===e.datafeedState&&!0===e.awaitingNodeAssignment?"started":"unknown"))[0]||"missing",je=e=>t=>Object.entries(e).reduce(((e,[,t])=>"missing"===t?{type:"required"}:"required"===e.type||"succeeded"===e.type?e:"skipped"===e.type||Object(O.p)(t)?{type:"skipped",newlyCreated:"skipped"===e.type&&e.newlyCreated}:e),t),we=e=>null!=e.error,ke=e=>Object(a.useReducer)((e=>(t,n)=>{switch(n.type){case"startedSetup":return{...t,jobStatus:e.reduce(((e,t)=>({...e,[t]:"initializing"})),{}),setupStatus:{type:"pending"}};case"finishedSetup":{const{datafeedSetupResults:a,jobSetupResults:i,jobSummaries:r,spaceId:o,sourceId:s}=n,l=e.reduce(((e,t)=>({...e,[t]:Te(Object(O.k)(o,s,t))(i)&&Ce(Object(O.i)(o,s,t))(a)?"started":"failed"})),{}),u=Object.values(l).every((e=>"started"===e||"starting"===e))?{type:"succeeded"}:{type:"failed",reasons:[...Object.values(a).filter(we).map((e=>{var t;return null===(t=e.error.error)||void 0===t?void 0:t.reason})),...Object.values(i).filter(we).map((e=>{var t;return null===(t=e.error.error)||void 0===t?void 0:t.reason}))]};return{...t,jobStatus:l,jobSummaries:r,setupStatus:u}}case"failedSetup":return{...t,jobStatus:e.reduce(((e,t)=>({...e,[t]:"failed"})),{}),setupStatus:{type:"failed",reasons:["unknown"]}};case"fetchingJobStatuses":return{...t,setupStatus:"unknown"===t.setupStatus.type?{type:"initializing"}:t.setupStatus};case"fetchedJobStatuses":{const{payload:a,spaceId:i,sourceId:r}=n,{setupStatus:o}=t,s=e.reduce(((e,t)=>({...e,[t]:Oe(Object(O.k)(i,r,t))(a)})),{}),l=je(s)(o);return{...t,jobSummaries:a,jobStatus:s,setupStatus:l}}case"failedFetchingJobStatuses":return{...t,setupStatus:{type:"unknown"},jobStatus:e.reduce(((e,t)=>({...e,[t]:"unknown"})),{})};case"viewedResults":return{...t,setupStatus:{type:"skipped",newlyCreated:!0}};default:return t}})(e),{jobTypes:e},Se);var Fe=n(64);const Ie=({sourceConfiguration:e,moduleDescriptor:t})=>{const{services:n}=Object(_e.b)(),{spaceId:i,sourceId:r,timestampField:o,runtimeMappings:s}=e,[l,u]=ke(t.jobTypes),c=Object(Fe.useUiTracker)({app:"infra_logs"}),[,d]=Object(Me.c)({cancelPreviousOn:"resolution",createPromise:async()=>(u({type:"fetchingJobStatuses"}),await t.getJobSummary(i,r,n.http.fetch)),onResolve:e=>{u({type:"fetchedJobStatuses",payload:e,spaceId:i,sourceId:r})},onReject:()=>{u({type:"failedFetchingJobStatuses"})}},[i,r]),[,m]=Object(Me.c)({cancelPreviousOn:"resolution",createPromise:async(e,a,l,c)=>{u({type:"startedSetup"});return{setupResult:await t.setUpModule(a,l,c,{indices:e,sourceId:r,spaceId:i,timestampField:o,runtimeMappings:s},n.http.fetch),jobSummaries:await t.getJobSummary(i,r,n.http.fetch)}},onResolve:({setupResult:{datafeeds:e,jobs:t},jobSummaries:n})=>{if([...e,...t].reduce(((e,t)=>[...e,...Object.keys(t)]),[]).some((e=>"error"===e))){[...e,...t].filter((e=>void 0!==e.error)).map((e=>{var t,n,a;return null!==(t=null===(n=e.error)||void 0===n||null===(a=n.error)||void 0===a?void 0:a.reason)&&void 0!==t?t:""})).filter((e=>e.includes("because it has no mappings"))).length>0?c({metric:"logs_ml_setup_error_bad_indices_or_mappings"}):c({metric:"logs_ml_setup_error_unknown_cause"})}u({type:"finishedSetup",datafeedSetupResults:e,jobSetupResults:t,jobSummaries:n,spaceId:i,sourceId:r})},onReject:e=>{var t;u({type:"failedSetup"}),403===(null==e||null===(t=e.body)||void 0===t?void 0:t.statusCode)&&c({metric:"logs_ml_setup_error_lack_of_privileges"})}},[t.setUpModule,i,r,o]),[g,h]=Object(Me.c)({cancelPreviousOn:"resolution",createPromise:async()=>await t.cleanUpModule(i,r,n.http.fetch)},[i,r]),p=Object(a.useMemo)((()=>"pending"===g.state),[g.state]),f=Object(a.useCallback)(((e,t,n,a)=>{u({type:"startedSetup"}),h().then((()=>{m(e,t,n,a)})).catch((()=>{u({type:"failedSetup"})}))}),[h,u,m]),y=Object(a.useCallback)((()=>{u({type:"viewedResults"})}),[u]),b=Object(a.useMemo)((()=>t.getJobIds(i,r)),[t,i,r]);return{cleanUpAndSetUpModule:f,cleanUpModule:h,fetchJobStatus:d,isCleaningUp:p,jobIds:b,jobStatus:l.jobStatus,jobSummaries:l.jobSummaries,lastSetupErrorMessages:l.lastSetupErrorMessages,moduleDescriptor:t,setUpModule:m,setupStatus:l.setupStatus,sourceConfiguration:e,viewResults:y}};var Le=n(165),Pe=n.n(Le);const De=({moduleDescriptor:e,sourceConfiguration:t})=>({getIsJobConfigurationOutdated:Object(a.useMemo)((()=>Re(e,t)),[t,e])}),Re=({bucketSpan:e},t)=>n=>{var a;if(!n.fullJob||!n.fullJob.custom_settings||!n.fullJob.datafeed_config)return!1;const i=n.fullJob.custom_settings.logs_source_config,r=null!==(a=n.fullJob.datafeed_config.runtime_mappings)&&void 0!==a?a:{};return!(i&&i.bucketSpan===e&&i.indexPattern&&Ne(new Set(i.indexPattern.split(",")),new Set(t.indices))&&i.timestampField===t.timestampField&&Pe()(r,t.runtimeMappings))},Ne=(e,t)=>Array.from(e).every((e=>t.has(e))),Ae=({sourceConfiguration:{spaceId:e,sourceId:t},moduleDescriptor:n})=>{const{services:i}=Object(_e.b)(),[r,o]=Object(a.useState)(),s=Object(a.useMemo)((()=>r?r.jobs.reduce(((n,a)=>({...n,[Object(O.k)(e,t,a.id)]:a})),{}):{}),[r,t,e]),[l,u]=Object(Me.c)({cancelPreviousOn:"resolution",createPromise:async()=>await n.getModuleDefinition(i.http.fetch),onResolve:e=>{o(e)},onReject:()=>{o(void 0)}},[n.getModuleDefinition,e,t]),c=Object(a.useCallback)((e=>{var t,n,a;const i=s[e.id];if(null==i)return!1;const r=null==i?void 0:i.config.custom_settings.job_revision;return(null!==(t=null===(n=e.fullJob)||void 0===n||null===(a=n.custom_settings)||void 0===a?void 0:a.job_revision)&&void 0!==t?t:0)<(null!=r?r:0)}),[s]);return{fetchModuleDefinition:u,fetchModuleDefinitionRequestState:l.state,getIsJobDefinitionOutdated:c,jobDefinitionByJobId:s,moduleDefinition:r}};var He=n(251),Ue=n.n(He);const ze=({jobSummaries:e})=>{const{services:{http:{fetch:t}}}=Object(_e.b)(),[n,i]=Object(a.useState)([]),r=Object(a.useMemo)((()=>e.filter(Je)),[e]),o=Object(a.useMemo)((()=>r.filter(Be)),[r]),[s,l]=Object(Me.c)({cancelPreviousOn:"creation",createPromise:e=>Promise.all(e.map((({jobId:e,startTime:n,endTime:a})=>(async({jobIds:e,startTime:t,endTime:n,includeCategorizerStatuses:a},i)=>{const r=await i(ne.b,{method:"POST",body:JSON.stringify(ne.j.encode({data:{jobIds:e,timeRange:{startTime:t,endTime:n},includeCategorizerStatuses:a}}))});return Object(I.b)(ne.k)(r)})({jobIds:[e],startTime:n,endTime:a,includeCategorizerStatuses:["warn"]},t)))),onResolve:e=>{i(e.flatMap((({data:{datasetStats:e}})=>e)))}},[]);Ue()((()=>{l(o.map((e=>{var t,n,a,i,r;return{jobId:e.id,startTime:null!==(t=null===(n=e.fullJob)||void 0===n?void 0:n.create_time)&&void 0!==t?t:0,endTime:null!==(a=null===(i=e.fullJob)||void 0===i||null===(r=i.model_size_stats)||void 0===r?void 0:r.log_time)&&void 0!==a?a:Date.now()}})))}),[o]);return{categoryQualityWarnings:Object(a.useMemo)((()=>[...r.filter((e=>!Be(e))).map((e=>{var t;return{type:"categoryQualityWarning",jobId:e.id,dataset:"",reasons:null!==(t=e.fullJob)&&void 0!==t&&t.model_size_stats?Ye(e.fullJob.model_size_stats):[]}})),...n.map((e=>({type:"categoryQualityWarning",jobId:e.job_id,dataset:e.dataset,reasons:Ye(e)})))]),[r,n]),lastLatestWarnedDatasetsStatsRequestErrors:"rejected"===s.state?s.value:null,isLoadingCategoryQualityWarnings:"pending"===s.state}},Je=e=>{var t,n;return"warn"===(null===(t=e.fullJob)||void 0===t||null===(n=t.model_size_stats)||void 0===n?void 0:n.categorization_status)},Be=e=>{var t,n,a;return null!==(t=null===(n=e.fullJob)||void 0===n||null===(a=n.analysis_config)||void 0===a?void 0:a.per_partition_categorization)&&void 0!==t&&t},Ye=({categorized_doc_count:e,dead_category_count:t,frequent_category_count:n,rare_category_count:a,total_category_count:i})=>{const r=a/i,o=i/e,s=t/i;return[...1===i?[{type:"singleCategory"}]:[],...r>=.9?[{type:"manyRareCategories",rareCategoriesRatio:r}]:[],...e>100&&o>=.5?[{type:"manyCategories",categoriesDocumentRatio:o}]:[],...0===n?[{type:"noFrequentCategories"}]:[],...s>=.5?[{type:"manyDeadCategories",deadCategoriesRatio:s}]:[]]},[Ve,qe]=xe()((({indexPattern:e,sourceId:t,spaceId:n,timestampField:i,runtimeMappings:r})=>{const o=Object(a.useMemo)((()=>({indices:e.split(","),sourceId:t,spaceId:n,timestampField:i,runtimeMappings:r})),[e,t,n,i,r]),s=Ie({moduleDescriptor:Ee,sourceConfiguration:o}),{getIsJobConfigurationOutdated:l}=De({sourceConfiguration:o,moduleDescriptor:Ee}),{fetchModuleDefinition:u,getIsJobDefinitionOutdated:c}=Ae({sourceConfiguration:o,moduleDescriptor:Ee}),{categoryQualityWarnings:d}=ze({jobSummaries:s.jobSummaries}),m=Object(a.useMemo)((()=>s.jobSummaries.some(l)),[l,s.jobSummaries]),g=Object(a.useMemo)((()=>s.jobSummaries.some(c)),[c,s.jobSummaries]),h=Object(a.useMemo)((()=>Object.values(s.jobStatus).some((e=>"stopped"===e))),[s.jobStatus]);return{...s,categoryQualityWarnings:d,fetchModuleDefinition:u,hasOutdatedJobConfigurations:m,hasOutdatedJobDefinitions:g,hasStoppedJobs:h}}));var We=n(28),$e=n(166),Ge=n.n($e);const Qe=({cleanUpAndSetUpModule:e,moduleDescriptor:{validateSetupDatasets:t,validateSetupIndices:n},setUpModule:i,sourceConfiguration:r})=>{const{services:o}=Object(_e.b)(),[s,l]=Object(a.useState)(Date.now()-24192e5),[u,c]=Object(a.useState)(void 0),d=Object(a.useMemo)((()=>null==s||null==u||s<u),[u,s]),[m,g]=Object(a.useState)(r.indices.map((e=>({name:e,validity:"unknown"})))),h=Object(a.useCallback)((e=>g((t=>t.map((t=>{const n=e.filter((({index:e})=>e===t.name));return n.length>0?{validity:"invalid",name:t.name,errors:n}:"valid"===t.validity?{...t,validity:"valid",errors:[]}:{validity:"valid",name:t.name,isSelected:!Object(O.o)(t.name),availableDatasets:[],datasetFilter:{type:"includeAll"}}}))))),[]),p=Object(a.useCallback)((e=>g((t=>t.map((t=>{if("valid"!==t.validity)return t;const n=e.filter((({indexName:e})=>e===t.name)),a=n.flatMap((({datasets:e})=>e)),i=n.length>0?Object(O.g)(t.datasetFilter,(e=>a.includes(e))):t.datasetFilter;return{...t,availableDatasets:a,datasetFilter:i}}))))),[]),f=Object(a.useMemo)((()=>m.filter((e=>"valid"===e.validity)).map((e=>e.name))),[m]),y=Object(a.useMemo)((()=>m.filter((e=>"valid"===e.validity&&e.isSelected)).map((e=>e.name))),[m]),b=Object(a.useMemo)((()=>m.flatMap((e=>"valid"===e.validity?e.datasetFilter:{type:"includeAll"})).reduce(O.f,{type:"includeAll"})),[m]),[E,v]=Object(Me.c)({cancelPreviousOn:"resolution",createPromise:async()=>await n(r.indices,r.timestampField,r.runtimeMappings,o.http.fetch),onResolve:({data:{errors:e}})=>{h(e)},onReject:()=>{g([])}},[r.indices,r.timestampField]),[x,_]=Object(Me.c)({cancelPreviousOn:"resolution",createPromise:async()=>0===f.length?{data:{datasets:[]}}:await t(f,r.timestampField,null!=s?s:0,null!=u?u:Date.now(),r.runtimeMappings,o.http.fetch),onResolve:({data:{datasets:e}})=>{p(e)}},[f,r.timestampField,s,u]),M=Object(a.useCallback)((()=>i(y,s,u,b)),[i,y,s,u,b]),S=Object(a.useCallback)((()=>e(y,s,u,b)),[e,y,s,u,b]),T=Object(a.useMemo)((()=>"pending"===E.state||"pending"===x.state),[x.state,E.state]),C=Object(a.useMemo)((()=>T?[]:[..."rejected"===E.state||"rejected"===x.state?[{error:"NETWORK_ERROR"}]:[],...m.reduce(((e,t)=>"invalid"===t.validity&&y.includes(t.name)?[...e,...t.errors]:e),[]),...0===y.length?[{error:"TOO_FEW_SELECTED_INDICES"}]:[],...d?[]:[{error:"INVALID_TIME_RANGE"}]]),[T,E.state,x.state,m,y,d]),j=Ge()(s),w=Ge()(u),k=Ge()(f);return Object(a.useEffect)((()=>{d&&v()}),[d,v]),Object(a.useEffect)((()=>{d&&(s===j&&u===w&&Object(We.isEqual)(f,k)||_())}),[u,d,w,j,k,s,f,_]),{cleanUpAndSetUp:S,datasetFilter:b,endTime:u,isValidating:T,selectedIndexNames:y,setEndTime:c,setStartTime:l,setUp:M,startTime:s,validatedIndices:m,setValidatedIndices:g,validationErrors:C}};var Ze=n(155),Ke=n(156);const Xe=({onClose:e})=>{const{categoryQualityWarnings:t,cleanUpAndSetUp:n,endTime:r,fetchJobStatus:o,isValidating:s,lastSetupErrorMessages:l,moduleDescriptor:u,setEndTime:c,setStartTime:m,setValidatedIndices:g,setUp:h,setupStatus:p,startTime:y,validatedIndices:b,validationErrors:E,viewResults:v}=(()=>{const{categoryQualityWarnings:e,cleanUpAndSetUpModule:t,fetchJobStatus:n,lastSetupErrorMessages:a,moduleDescriptor:i,setUpModule:r,setupStatus:o,sourceConfiguration:s,viewResults:l}=qe(),{cleanUpAndSetUp:u,endTime:c,isValidating:d,setEndTime:m,setStartTime:g,setValidatedIndices:h,setUp:p,startTime:f,validatedIndices:y,validationErrors:b}=Qe({cleanUpAndSetUpModule:t,moduleDescriptor:i,setUpModule:r,sourceConfiguration:s});return{categoryQualityWarnings:e,cleanUpAndSetUp:u,endTime:c,fetchJobStatus:n,isValidating:d,lastSetupErrorMessages:a,moduleDescriptor:i,setEndTime:m,setStartTime:g,setValidatedIndices:h,setUp:p,setupStatus:o,startTime:f,validatedIndices:y,validationErrors:b,viewResults:l}})();f()((()=>{o()}));const x=Object(a.useCallback)((()=>{v(),e()}),[v,e]),_=Object(a.useMemo)((()=>[Object(Ze.a)({setStartTime:m,setEndTime:c,startTime:y,endTime:r,isValidating:s,validatedIndices:b,setupStatus:p,setValidatedIndices:g,validationErrors:E,previousQualityWarnings:t}),Object(Ke.a)({cleanUpAndSetUp:n,errorMessages:l,isConfigurationValid:E.length<=0&&!s,setUp:h,setupStatus:p,viewResults:x})]),[t,n,r,s,l,c,m,h,g,p,y,b,E,x]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(d.EuiTitle,{size:"s"},i.a.createElement("h3",null,u.moduleName," ")),i.a.createElement(d.EuiText,{size:"s"},u.moduleDescription),i.a.createElement(d.EuiSpacer,null),i.a.createElement(d.EuiSteps,{steps:_}))},et="logs_ui_analysis",tt=h.i18n.translate("xpack.infra.logs.analysis.logEntryRateModuleName",{defaultMessage:"Log rate"}),nt=h.i18n.translate("xpack.infra.logs.analysis.logEntryRateModuleDescription",{defaultMessage:"Use Machine Learning to automatically detect anomalous log entry rates."}),at=(e,t)=>O.w.reduce(((n,a)=>({...n,[a]:Object(O.k)(e,t,a)})),{}),it={moduleId:et,moduleName:tt,moduleDescription:nt,jobTypes:O.w,bucketSpan:O.c,getJobIds:at,getJobSummary:async(e,t,n)=>{const a=await L({spaceId:e,sourceId:t,jobTypes:O.w},n),i=Object.values(at(e,t));return a.filter((e=>i.includes(e.id)))},getModuleDefinition:async e=>await J(et,e),setUpModule:async(e,t,n,{spaceId:a,sourceId:i,indices:r,timestampField:o,runtimeMappings:s},l)=>{const u=r.join(","),c=[{job_id:"log-entry-rate",analysis_config:{bucket_span:`${O.c}ms`},data_description:{time_field:o},custom_settings:{logs_source_config:{indexPattern:u,timestampField:o,bucketSpan:O.c}}}],d=[{job_id:"log-entry-rate",runtime_mappings:s}],m="includeSome"===n.type?{bool:{filter:[{terms:{"event.dataset":n.datasets}}]}}:void 0;return V({moduleId:et,start:e,end:t,spaceId:a,sourceId:i,indexPattern:u,jobOverrides:c,datafeedOverrides:d,query:m,useDedicatedIndex:!0},l)},cleanUpModule:async(e,t,n)=>await de(e,t,O.w,n),validateSetupDatasets:async(e,t,n,a,i,r)=>await ae({indices:e,timestampField:t,startTime:n,endTime:a,runtimeMappings:i},r),validateSetupIndices:async(e,t,n,a)=>await ie({indices:e,fields:[{name:t,validTypes:["date"]},{name:O.z,validTypes:["keyword"]}],runtimeMappings:n},a)},[rt,ot]=xe()((({indexPattern:e,sourceId:t,spaceId:n,timestampField:i,runtimeMappings:r})=>{const o=Object(a.useMemo)((()=>({indices:e.split(","),sourceId:t,spaceId:n,timestampField:i,runtimeMappings:r})),[e,t,n,i,r]),s=Ie({moduleDescriptor:it,sourceConfiguration:o}),{getIsJobConfigurationOutdated:l}=De({sourceConfiguration:o,moduleDescriptor:it}),{fetchModuleDefinition:u,getIsJobDefinitionOutdated:c}=Ae({sourceConfiguration:o,moduleDescriptor:it}),d=Object(a.useMemo)((()=>s.jobSummaries.some(l)),[l,s.jobSummaries]),m=Object(a.useMemo)((()=>s.jobSummaries.some(c)),[c,s.jobSummaries]),g=Object(a.useMemo)((()=>Object.values(s.jobStatus).some((e=>"stopped"===e))),[s.jobStatus]);return{...s,fetchModuleDefinition:u,hasOutdatedJobConfigurations:d,hasOutdatedJobDefinitions:m,hasStoppedJobs:g}})),st=()=>{const{cleanUpAndSetUpModule:e,lastSetupErrorMessages:t,moduleDescriptor:n,setUpModule:a,setupStatus:i,sourceConfiguration:r,viewResults:o}=ot(),{cleanUpAndSetUp:s,endTime:l,isValidating:u,setEndTime:c,setStartTime:d,setValidatedIndices:m,setUp:g,startTime:h,validatedIndices:p,validationErrors:f}=Qe({cleanUpAndSetUpModule:e,moduleDescriptor:n,setUpModule:a,sourceConfiguration:r});return{cleanUpAndSetUp:s,endTime:l,isValidating:u,lastSetupErrorMessages:t,moduleDescriptor:n,setEndTime:c,setStartTime:d,setValidatedIndices:m,setUp:g,setupStatus:i,startTime:h,validatedIndices:p,validationErrors:f,viewResults:o}},[lt,ut]=xe()(st),ct=({onClose:e})=>{const{cleanUpAndSetUp:t,endTime:n,isValidating:r,lastSetupErrorMessages:o,moduleDescriptor:s,setEndTime:l,setStartTime:u,setValidatedIndices:c,setUp:m,setupStatus:g,startTime:h,validatedIndices:p,validationErrors:f,viewResults:y}=st(),b=Object(a.useCallback)((()=>{y(),e()}),[y,e]),E=Object(a.useMemo)((()=>[Object(Ze.a)({setStartTime:u,setEndTime:l,startTime:h,endTime:n,isValidating:r,validatedIndices:p,setupStatus:g,setValidatedIndices:c,validationErrors:f}),Object(Ke.a)({cleanUpAndSetUp:t,errorMessages:o,isConfigurationValid:f.length<=0&&!r,setUp:m,setupStatus:g,viewResults:b})]),[t,n,r,o,l,u,m,c,g,h,p,f,b]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(d.EuiTitle,{size:"s"},i.a.createElement("h3",null,s.moduleName," ")),i.a.createElement(d.EuiText,{size:"s"},s.moduleDescription),i.a.createElement(d.EuiSpacer,null),i.a.createElement(d.EuiSteps,{steps:E}))},dt=F.type({capabilities:F.type({canGetJobs:F.boolean,canCreateJob:F.boolean,canDeleteJob:F.boolean,canOpenJob:F.boolean,canCloseJob:F.boolean,canForecastJob:F.boolean,canGetDatafeeds:F.boolean,canStartStopDatafeed:F.boolean,canUpdateJob:F.boolean,canUpdateDatafeed:F.boolean,canPreviewDatafeed:F.boolean}),isPlatinumOrTrialLicense:F.boolean,mlFeatureEnabledInSpace:F.boolean,upgradeInProgress:F.boolean}),[mt,gt]=xe()((()=>{const{services:e}=Object(_e.b)(),[t,n]=Object(a.useState)(ht),[i,r]=Object(Me.c)({cancelPreviousOn:"resolution",createPromise:async()=>{const t=await e.http.fetch("/api/ml/ml_capabilities");return Object(I.b)(dt)(t)},onResolve:e=>{n(e)}},[]);Object(a.useEffect)((()=>{r()}),[r]);const o=Object(a.useMemo)((()=>"pending"===i.state),[i.state]),s=t.capabilities.canCreateJob,l=t.capabilities.canGetJobs;return{hasLogAnalysisCapabilites:t.isPlatinumOrTrialLicense&&t.mlFeatureEnabledInSpace,hasLogAnalysisReadCapabilities:l,hasLogAnalysisSetupCapabilities:s,isLoading:o}})),ht={capabilities:{canGetJobs:!1,canCreateJob:!1,canDeleteJob:!1,canOpenJob:!1,canCloseJob:!1,canForecastJob:!1,canGetDatafeeds:!1,canStartStopDatafeed:!1,canUpdateJob:!1,canUpdateDatafeed:!1,canPreviewDatafeed:!1,canGetCalendars:!1,canCreateCalendar:!1,canDeleteCalendar:!1,canGetFilters:!1,canCreateFilter:!1,canDeleteFilter:!1,canFindFileStructure:!1,canGetDataFrameJobs:!1,canDeleteDataFrameJob:!1,canPreviewDataFrameJob:!1,canCreateDataFrameJob:!1,canStartStopDataFrameJob:!1},isPlatinumOrTrialLicense:!1,mlFeatureEnabledInSpace:!1,upgradeInProgress:!1};var pt=n(187),ft=n(75);const yt=({jobId:e,hasSetupCapabilities:t,moduleDescription:n,moduleName:r,moduleStatus:o,onViewSetup:s})=>{const{services:{ml:l,application:{navigateToUrl:u},notifications:{toasts:c}}}=Object(_e.b)(),[m,g]=Object(a.useState)("");Object(a.useEffect)((()=>{(async()=>{l.locator?g(await l.locator.getUrl({page:"jobs",pageState:{jobId:e}})):c.addWarning({title:Object(ft.mountReactNode)(i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logs.analysis.mlNotAvailable",defaultMessage:"ML plugin is not available"}))})})()}));const h="required"===o.type?i.a.createElement(d.EuiIcon,{size:"xxl",type:"machineLearningApp"}):i.a.createElement(d.EuiIcon,{color:"secondary",size:"xxl",type:"check"}),p="required"===o.type?i.a.createElement(pt.a,{hasSetupCapabilities:t,onClick:s},i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logs.analysis.enableAnomalyDetectionButtonLabel",defaultMessage:"Enable anomaly detection"})):i.a.createElement(i.a.Fragment,null,i.a.createElement(pt.b,{hasSetupCapabilities:t,onClick:s}),m?i.a.createElement(i.a.Fragment,null,i.a.createElement(d.EuiSpacer,{size:"xs"}),i.a.createElement(d.EuiButtonEmpty,{onClick:async()=>{await u(m)}},i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logs.analysis.viewInMlButtonLabel",defaultMessage:"View in Machine Learning"}))):null);return i.a.createElement(d.EuiCard,{description:n,footer:i.a.createElement("div",null,p),icon:h,title:r})},bt=({onViewModuleSetup:e})=>{const{hasLogAnalysisSetupCapabilities:t}=gt(),{setupStatus:n,jobIds:r}=ot(),{setupStatus:o,jobIds:s}=qe(),l=Object(a.useCallback)((()=>{e("logs_ui_analysis")}),[e]),u=Object(a.useCallback)((()=>{e("logs_ui_categories")}),[e]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(d.EuiFlexGroup,null,i.a.createElement(d.EuiFlexItem,null,i.a.createElement(yt,{jobId:r["log-entry-rate"],hasSetupCapabilities:t,moduleDescription:it.moduleDescription,moduleName:it.moduleName,moduleStatus:n,onViewSetup:l})),i.a.createElement(d.EuiFlexItem,null,i.a.createElement(yt,{jobId:s["log-entry-categories-count"],hasSetupCapabilities:t,moduleDescription:Ee.moduleDescription,moduleName:Ee.moduleName,moduleStatus:o,onViewSetup:u}))))},Et=["logs_ui_analysis","logs_ui_categories"],[vt,xt]=xe()((({initialFlyoutView:e={view:"hidden"}})=>{const[t,n]=Object(a.useState)(e),i=Object(a.useCallback)((()=>n({view:"hidden"})),[]),r=Object(a.useCallback)((()=>n({view:"moduleList"})),[]),o=Object(a.useCallback)((e=>{n({view:"moduleSetup",module:e})}),[n]);return{closeFlyout:i,flyoutView:t,setFlyoutView:n,showModuleList:r,showModuleSetup:o}})),_t="logAnalysisSetupFlyoutHeading",Mt=({allowedModules:e=Et})=>{const{closeFlyout:t,flyoutView:n,showModuleList:a,showModuleSetup:r}=xt();return"hidden"===n.view?null:i.a.createElement(d.EuiFlyout,{"aria-labelledby":_t,maxWidth:800,onClose:t},i.a.createElement(d.EuiFlyoutHeader,{hasBorder:!0},i.a.createElement(d.EuiTitle,null,i.a.createElement("h2",{id:_t},i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logs.analysis.setupFlyoutTitle",defaultMessage:"Anomaly detection with Machine Learning"})))),i.a.createElement(d.EuiFlyoutBody,null,"moduleList"===n.view?i.a.createElement(bt,{onViewModuleSetup:r}):"moduleSetup"===n.view&&e.includes(n.module)?i.a.createElement(St,{moduleId:n.module,onClose:t,onViewModuleList:e.length>1?a:void 0}):null))},St=({moduleId:e,onClose:t,onViewModuleList:n})=>{switch(e){case"logs_ui_analysis":return i.a.createElement(Tt,{onViewModuleList:n},i.a.createElement(ct,{onClose:t}));case"logs_ui_categories":return i.a.createElement(Tt,{onViewModuleList:n},i.a.createElement(Xe,{onClose:t}))}},Tt=({children:e,onViewModuleList:t})=>i.a.createElement(d.EuiFlexGroup,{alignItems:"flexStart",direction:"column",gutterSize:"none"},t?i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(d.EuiButtonEmpty,{flush:"left",iconSide:"left",iconType:"arrowLeft",onClick:t},i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logs.analysis.setupFlyoutGotoListButtonLabel",defaultMessage:"All Machine Learning jobs"}))):null,i.a.createElement(d.EuiFlexItem,null,e));var Ct=n(185),Ot=n(8),jt=n.n(Ot),wt=n(63),kt=n.n(wt),Ft=n(126),It=n.n(Ft),Lt=n(16),Pt=n(162);const Dt=({hasSetupCapabilities:e,moduleName:t,onRecreateMlJob:n})=>i.a.createElement(Pt.a,{hasSetupCapabilities:e,title:h.i18n.translate("xpack.infra.logs.analysis.jobConfigurationOutdatedCalloutTitle",{defaultMessage:"The {moduleName} ML job configuration is outdated",values:{moduleName:t}}),onRecreateMlJob:n},i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logs.analysis.jobConfigurationOutdatedCalloutMessage",defaultMessage:"The {moduleName} ML job was created using a different source configuration. Recreate the job to apply the current configuration. This removes previously detected anomalies.",values:{moduleName:t},tagName:"p"})),Rt=({hasSetupCapabilities:e,moduleName:t,onRecreateMlJob:n})=>i.a.createElement(Pt.a,{hasSetupCapabilities:e,title:h.i18n.translate("xpack.infra.logs.analysis.jobDefinitionOutdatedCalloutTitle",{defaultMessage:"The {moduleName} ML job definition is outdated",values:{moduleName:t}}),onRecreateMlJob:n},i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logs.analysis.jobDefinitionOutdatedCalloutMessage",defaultMessage:"A newer version of the {moduleName} ML job is available. Recreate the job to deploy the newer version. This removes previously detected anomalies.",values:{moduleName:t},tagName:"p"})),Nt=()=>i.a.createElement(d.EuiCallOut,{color:"primary",title:At},i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logs.analysis.jobStoppedCalloutMessage",defaultMessage:"The ML job has been stopped manually or due to a lack of resources. New log entries will not be processed until the job has been restarted.",tagName:"p"})),At=h.i18n.translate("xpack.infra.logs.analysis.jobStoppedCalloutTitle",{defaultMessage:"ML job stopped"});var Ht=n(36);const Ut=({href:e})=>{const{services:{application:t}}=Object(_e.b)(),n=Object(a.useCallback)((n=>{e&&Object(Ht.a)(n)&&t.navigateToUrl(e)}),[e,t]);return i.a.createElement(d.EuiButton,{fill:!1,size:"s",onClick:n},i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logs.analysis.analyzeInMlButtonLabel",defaultMessage:"Analyze in ML"}))},zt=()=>i.a.createElement(d.EuiCallOut,{color:"success",title:h.i18n.translate("xpack.infra.logs.analysis.onboardingSuccessTitle",{defaultMessage:"Success!"})},i.a.createElement("p",null,h.i18n.translate("xpack.infra.logs.analysis.onboardingSuccessContent",{defaultMessage:"Please allow a few minutes for our machine learning robots to begin collecting data."}))),Jt=({hasOutdatedJobConfigurations:e,hasOutdatedJobDefinitions:t,hasSetupCapabilities:n,hasStoppedJobs:a,isFirstUse:r,moduleName:o,onRecreateMlJobForReconfiguration:s,onRecreateMlJobForUpdate:l})=>i.a.createElement(i.a.Fragment,null,t?i.a.createElement(Rt,{hasSetupCapabilities:n,moduleName:o,onRecreateMlJob:l}):null,e?i.a.createElement(Dt,{hasSetupCapabilities:n,moduleName:o,onRecreateMlJob:s}):null,a?i.a.createElement(Nt,null):null,r?i.a.createElement(zt,null):null);var Bt=n(201);const Yt=({hasOutdatedJobConfigurations:e,hasOutdatedJobDefinitions:t,hasSetupCapabilities:n,hasStoppedJobs:a,isFirstUse:r,moduleName:o,onRecreateMlJobForReconfiguration:s,onRecreateMlJobForUpdate:l,qualityWarnings:u})=>i.a.createElement(i.a.Fragment,null,i.a.createElement(Jt,{hasOutdatedJobConfigurations:e,hasOutdatedJobDefinitions:t,hasSetupCapabilities:n,hasStoppedJobs:a,isFirstUse:r,moduleName:o,onRecreateMlJobForReconfiguration:s,onRecreateMlJobForUpdate:l}),i.a.createElement(Bt.b,{hasSetupCapabilities:n,qualityWarnings:u,onRecreateMlJob:s})),Vt=xe()((e=>{const[t,n]=Object(a.useState)(),{startTimestamp:i,endTimestamp:r,sourceId:o}=e;return[{startTimestamp:i,endTimestamp:r,sourceId:o,contextEntry:t},{setContextEntry:n}]})),qt=()=>window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,Wt=()=>window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;var $t=n(203);const Gt=()=>{const[{contextEntry:e,startTimestamp:t,endTimestamp:n,sourceId:r},{setContextEntry:o}]=Object(a.useContext)(Vt.Context),s=Object(a.useCallback)((()=>o(void 0)),[o]),{width:l,height:u}=function(){const[e,t]=Object(a.useState)({width:qt(),height:Wt()});return Object(a.useEffect)((()=>{const e=Object(We.throttle)((()=>{t({width:qt(),height:Wt()})}),250);return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),[]),e}(),c=Object(a.useMemo)((()=>{if(e&&!Object(We.isEmpty)(e.context))return Object.entries(e.context).reduce(((e,[t,n])=>{const a=`${t} : "${n}"`;return e.length>0?`${e} AND ${a}`:a}),"")}),[e]);return e?i.a.createElement(d.EuiModal,{onClose:s,maxWidth:!1},i.a.createElement(Qt,{width:l-50,height:u-50},i.a.createElement(d.EuiFlexGroup,{direction:"column",responsive:!1,wrap:!1,style:{height:"100%"}},i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(Zt,{context:e.context})),i.a.createElement(d.EuiFlexItem,{grow:1},i.a.createElement($t.a,{sourceId:r,startTimestamp:t,endTimestamp:n,query:c,center:e.cursor,highlight:e.id,height:"100%"}))))):null},Qt=Lt.euiStyled.div`
  padding: 16px;
  width: ${e=>"number"==typeof e.width?`${e.width}px`:e.width};
  height: ${e=>"number"==typeof e.height?`${e.height}px`:e.height};
  max-height: 75vh; // Same as EuiModal
`,Zt=({context:e})=>{let t;if("container.id"in e&&(t=i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logs.viewInContext.logsFromContainerTitle",defaultMessage:"Displayed logs are from container {container}",values:{container:e["container.id"]}})),"host.name"in e){const n=e["log.file.path"].length>45?e["log.file.path"].slice(0,20)+"..."+e["log.file.path"].slice(-25):e["log.file.path"];t=i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logs.viewInContext.logsFromFileTitle",defaultMessage:"Displayed logs are from file {file} and host {host}",values:{file:i.a.createElement(d.EuiToolTip,{content:e["log.file.path"]},i.a.createElement("span",null,n)),host:e["host.name"]}})}return i.a.createElement(d.EuiText,{size:"s"},i.a.createElement("p",null,i.a.createElement(d.EuiTextColor,{color:"subdued"},t)))};var Kt=n(143),Xt=n(71),en=n.n(Xt),tn=n(208),nn=n.n(tn);const an=({isExpanded:e,item:t,onCollapse:n,onExpand:r})=>{const o=Object(a.useCallback)((()=>e?n(t):r(t)),[e,t,n,r]);return i.a.createElement(d.EuiButtonIcon,{onClick:o,"aria-label":e?rn:on,iconType:e?"arrowUp":"arrowDown"})},rn=h.i18n.translate("xpack.infra.table.collapseRowLabel",{defaultMessage:"Collapse"}),on=h.i18n.translate("xpack.infra.table.expandRowLabel",{defaultMessage:"Expand"});var sn=n(170);const ln=({datasets:e})=>i.a.createElement("ul",null,e.map((e=>{const t=Object(O.j)(e.name);return i.a.createElement("li",{key:t},i.a.createElement(sn.a,{anomalyScore:e.maximumAnomalyScore}))})));var un=n(102);const cn=({categoryId:e,endTime:t,exampleCount:n,sourceId:i,startTime:r})=>{const{services:o}=Object(_e.b)(),[s,l]=Object(a.useState)([]),[u,c]=Object(Me.c)({cancelPreviousOn:"creation",createPromise:async()=>await(async(e,t)=>{const{sourceId:n,startTime:a,endTime:i,categoryId:r,exampleCount:o}=e,s=await t(un.f,{method:"POST",body:JSON.stringify(un.t.encode({data:{categoryId:r,exampleCount:o,sourceId:n,timeRange:{startTime:a,endTime:i}}}))});return Object(I.b)(un.u)(s)})({sourceId:i,startTime:r,endTime:t,categoryId:e,exampleCount:n},o.http.fetch),onResolve:({data:{examples:e}})=>{l(e)}},[e,t,n,i,r]),d=Object(a.useMemo)((()=>"pending"===u.state),[u.state]);return{getLogEntryCategoryExamples:c,hasFailedLoadingLogEntryCategoryExamples:Object(a.useMemo)((()=>"rejected"===u.state),[u.state]),isLoadingLogEntryCategoryExamples:d,logEntryCategoryExamples:s}},dn=({onReload:e})=>i.a.createElement(d.EuiFlexGroup,{alignItems:"center"},i.a.createElement(d.EuiFlexItem,{grow:!1,className:"eui-textNoWrap"},i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logs.logEntryExamples.exampleEmptyDescription",defaultMessage:"No examples found within the selected time range. Increase the log entry retention period to improve message sample availability."})),i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(d.EuiButton,{onClick:e,size:"s"},i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logs.logEntryExamples.exampleEmptyReloadButtonLabel",defaultMessage:"Reload"})))),mn=({onRetry:e})=>i.a.createElement(d.EuiFlexGroup,{alignItems:"center"},i.a.createElement(d.EuiFlexItem,{grow:!1,className:"eui-textNoWrap"},i.a.createElement(d.EuiTextColor,{color:"danger"},i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logs.logEntryExamples.exampleLoadingFailureDescription",defaultMessage:"Failed to load examples."}))),i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(d.EuiButton,{onClick:e,size:"s"},i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logs.logEntryExamples.exampleLoadingFailureRetryButtonLabel",defaultMessage:"Retry"})))),gn=({exampleCount:e})=>i.a.createElement(i.a.Fragment,null,Array.from(new Array(e),((e,t)=>i.a.createElement(d.EuiLoadingContent,{key:t,lines:1})))),hn=({isLoading:e,hasFailedLoading:t,exampleCount:n,hasResults:a,onReload:r,children:o})=>i.a.createElement(pn,null,e?i.a.createElement(gn,{exampleCount:n}):t?i.a.createElement(mn,{onRetry:r}):a?o:i.a.createElement(dn,{onReload:r})),pn=Lt.euiStyled.div`
  align-items: stretch;
  flex-direction: column;
  flex: 1 0 0%;
  overflow: hidden;
  padding-top: 1px; // Buffer for the "Reload" buttons' hover state
`;var fn=n(14),yn=n(153),bn=n(146);const En=({id:e,dataset:t,message:n,timestamp:r,timeRange:o,tiebreaker:s,context:l})=>{const u=Object(Fe.useUiTracker)({app:"infra_logs"}),[,{setContextEntry:c}]=Object(a.useContext)(Vt.Context),d=Object(O.j)(t),[m,g]=Object(a.useState)(!1),p=Object(a.useCallback)((()=>g(!0)),[]),f=Object(a.useCallback)((()=>g(!1)),[]),[y,b]=Object(a.useState)(!1),E=Object(a.useCallback)((()=>b(!0)),[]),v=Object(a.useCallback)((()=>b(!1)),[]),x=Object(Ht.b)({app:"logs",pathname:"stream",search:{logPosition:Object(fn.encode)({end:kt()(o.endTime).format("YYYY-MM-DDTHH:mm:ss.SSSZ"),position:{tiebreaker:s,time:r},start:kt()(o.startTime).format("YYYY-MM-DDTHH:mm:ss.SSSZ"),streamLive:!1}),flyoutOptions:Object(fn.encode)({surroundingLogsId:e}),logFilter:Object(fn.encode)({expression:`${O.z}: ${t}`,kind:"kuery"})}});return i.a.createElement(yn.e,{scale:"medium",onMouseEnter:p,onMouseLeave:f},i.a.createElement(yn.a,Tn[xn],i.a.createElement(yn.f,{format:"dateTime",time:r})),i.a.createElement(yn.a,Tn[_n],i.a.createElement(yn.d,{columnValue:{columnId:_n,message:[{field:"message",value:[n],highlights:[]}]},highlights:vn,isActiveHighlight:!1,wrapMode:"none"})),i.a.createElement(yn.a,Tn[Mn],i.a.createElement(yn.c,{columnValue:{columnId:Mn,field:"event.dataset",value:[d],highlights:[]},highlights:vn,isActiveHighlight:!1,wrapMode:"none"})),i.a.createElement(yn.a,Tn[Sn],m||y?i.a.createElement(bn.a,{isOpen:y,onOpen:E,onClose:v,items:[{label:h.i18n.translate("xpack.infra.logs.categoryExample.viewInStreamText",{defaultMessage:"View in stream"}),onClick:x.onClick,href:x.href},{label:h.i18n.translate("xpack.infra.logs.categoryExample.viewInContextText",{defaultMessage:"View in context"}),onClick:()=>{const t={id:e,index:"",context:l,cursor:{time:r,tiebreaker:s},columns:[]};u({metric:"view_in_context__categories"}),c(t)}}]}):null))},vn=[],xn="category-example-timestamp-column",_n="category-examples-message-column",Mn="category-examples-dataset-column",Sn="category-examples-icon-column",Tn={[xn]:{growWeight:0,shrinkWeight:0,baseWidth:"332px"},[_n]:{growWeight:1,shrinkWeight:0,baseWidth:"0%"},[Mn]:{growWeight:0,shrinkWeight:0,baseWidth:"400px"},[Sn]:{growWeight:0,shrinkWeight:0,baseWidth:"32px"}},Cn=({categoryId:e,timeRange:t,sourceId:n})=>{const{getLogEntryCategoryExamples:r,hasFailedLoadingLogEntryCategoryExamples:o,isLoadingLogEntryCategoryExamples:s,logEntryCategoryExamples:l}=cn({categoryId:e,endTime:t.endTime,exampleCount:5,sourceId:n,startTime:t.startTime});return Object(a.useEffect)((()=>{r()}),[r]),i.a.createElement(hn,{isLoading:s,hasFailedLoading:o,hasResults:l.length>0,exampleCount:5,onReload:r},l.map(((e,n)=>i.a.createElement(En,{key:n,id:e.id,dataset:e.dataset,message:e.message,timeRange:t,timestamp:e.timestamp,tiebreaker:e.tiebreaker,context:e.context}))))},On=Object(a.memo)((({maximumSegmentCount:e=30,regularExpression:t})=>{const n=t.split(Fn);return i.a.createElement(jn,null,n.slice(0,e).map(((e,t)=>[t>0?i.a.createElement(wn,{key:`wildcard-${t}`},"â"):null,i.a.createElement(kn,{key:`segment-${t}`},e.replace(In,"$1"))])),n.length>e?i.a.createElement(wn,{title:h.i18n.translate("xpack.infra.logs.logEntryCategories.truncatedPatternSegmentDescription",{defaultMessage:"{extraSegmentCount, plural, one {one more segment} other {# more segments}}",values:{extraSegmentCount:n.length-e}})},"â¦"):null)})),jn=Lt.euiStyled.span`
  font-family: ${e=>e.theme.eui.euiCodeFontFamily};
  word-break: break-all;
`,wn=Lt.euiStyled.span`
  color: ${e=>e.theme.eui.euiColorMediumShade};
`,kn=Lt.euiStyled.span`
  font-weight: bold;
`,Fn=/\.[+*]\??/g,In=/\\([\\^$*+?.()\[\]])/g;var Ln=n(69),Pn=n(142);const Dn=({categorizationJobId:e,categoryId:t,dataset:n,timeRange:r})=>{const{services:{ml:o,http:s,application:l}}=Object(_e.b)(),u=Object(Ln.useMlHref)(o,s.basePath.get(),{page:Ln.ML_PAGES.SINGLE_METRIC_VIEWER,pageState:{jobIds:[e],timeRange:{from:kt()(r.startTime).format("YYYY-MM-DDTHH:mm:ss.SSSZ"),to:kt()(r.endTime).format("YYYY-MM-DDTHH:mm:ss.SSSZ"),mode:"absolute"},entities:{[Pn.i]:n,mlcategory:`${t}`}}}),c=Object(a.useCallback)((e=>{u&&Object(Ht.a)(e)&&l.navigateToUrl(u)}),[l,u]);return i.a.createElement(d.EuiToolTip,{content:Nn,delay:"long"},i.a.createElement(d.EuiButtonIcon,{"aria-label":Rn,iconType:"machineLearningApp","data-test-subj":"analyzeCategoryDatasetInMlButton",href:u,onClick:c}))},Rn=h.i18n.translate("xpack.infra.logs.logEntryCategories.analyzeCategoryInMlButtonLabel",{defaultMessage:"Analyze in ML"}),Nn=h.i18n.translate("xpack.infra.logs.logEntryCategories.analyzeCategoryInMlTooltipDescription",{defaultMessage:"Analyze this category in the ML app."}),An=({categorizationJobId:e,categoryId:t,datasets:n,timeRange:a})=>i.a.createElement("ul",null,n.map((n=>{const r=Object(O.j)(n.name);return i.a.createElement("li",{key:r},i.a.createElement(Dn,{categorizationJobId:e,categoryId:t,dataset:n.name,timeRange:a}))}))),Hn=({datasets:e})=>i.a.createElement("ul",null,e.map((e=>{const t=Object(O.j)(e.name);return i.a.createElement("li",{key:t},i.a.createElement(Un,null,t))}))),Un=Lt.euiStyled.div`
  display: inline-block;
  margin-bottom: 2.5px;
  margin-top: 1px;
`,zn=({currentValue:e,previousValue:t})=>{const n=e/t-1;return n<0?i.a.createElement(Yn,null,i.a.createElement(d.EuiIcon,{type:"sortDown",color:"danger"}),i.a.createElement(d.EuiTextColor,{color:"danger"},Jn(n))):n>0&&Number.isFinite(n)?i.a.createElement(Yn,null,i.a.createElement(d.EuiIcon,{type:"sortUp",color:"success"}),i.a.createElement(d.EuiTextColor,{color:"secondary"},Jn(n))):n>0&&!Number.isFinite(n)?i.a.createElement(Yn,null,i.a.createElement(d.EuiIcon,{type:"sortUp",color:"success"}),i.a.createElement(d.EuiTextColor,{color:"secondary"},Bn)):null},Jn=e=>en()(e).format("+0,0 %"),Bn=h.i18n.translate("xpack.infra.logs.logEntryCategories.newCategoryTrendLabel",{defaultMessage:"new"}),Yn=Lt.euiStyled.span`
  white-space: nowrap;
`;var Vn=n(65),qn=n(77),Wn=n(110),$n=n(117);const Gn=["value"],Qn={height:20,width:100},Zn=({metric:e,timeRange:t})=>{const[n]=Object(Wn.a)("theme:darkMode"),r=Object($n.a)(),o=Object(a.useMemo)((()=>[qn.EUI_SPARKLINE_THEME_PARTIAL,n?qn.EUI_CHARTS_THEME_DARK.theme:qn.EUI_CHARTS_THEME_LIGHT.theme]),[n]),s=Object(a.useMemo)((()=>({max:t.endTime,min:t.startTime})),[t]);return i.a.createElement(Vn.Chart,{size:Qn},i.a.createElement(Vn.Settings,{showLegend:!1,theme:o,tooltip:"none",xDomain:s}),i.a.createElement(Vn.AreaSeries,{data:e,id:"metric",xAccessor:"timestamp",xScaleType:"time",yAccessors:Gn,timeZone:r}))},Kn=({currentCount:e,histograms:t,timeRange:n})=>{const r=Object(a.useMemo)((()=>{var e,n,a;return null!==(e=null===(n=t.find((e=>"history"===e.histogramId)))||void 0===n||null===(a=n.buckets)||void 0===a?void 0:a.map((({startTime:e,logEntryCount:t})=>({timestamp:e,value:t}))))&&void 0!==e?e:[]}),[t]),o=Object(a.useMemo)((()=>{var e,n,a,i;return null!==(e=null===(n=t.find((e=>"reference"===e.histogramId)))||void 0===n||null===(a=n.buckets)||void 0===a||null===(i=a[0])||void 0===i?void 0:i.logEntryCount)&&void 0!==e?e:0}),[t]),s=Object(a.useMemo)((()=>({endTime:n.endTime,startTime:n.startTime-(n.endTime-n.startTime)})),[n.endTime,n.startTime]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(Zn,{metric:r,timeRange:s}),i.a.createElement(zn,{previousValue:o,currentValue:e}))},Xn=Object(Lt.euiStyled)((({categorizationJobId:e,className:t,sourceId:n,timeRange:r,topCategories:o,sortOptions:s,changeSortOptions:l})=>{const u=Object(a.useMemo)((()=>({sort:s})),[s]),c=Object(a.useCallback)((({sort:e={}})=>{l(e)}),[l]),[m,{add:g,remove:h}]=nn()(new Set),p=Object(a.useMemo)((()=>ea(r,e,m,g,h)),[e,h,g,m,r]),f=Object(a.useMemo)((()=>[...m].reduce(((e,t)=>({...e,[t]:i.a.createElement(Cn,{categoryId:t,sourceId:n,timeRange:r})})),{})),[m,n,r]);return i.a.createElement(d.EuiBasicTable,{columns:p,itemIdToExpandedRowMap:f,itemId:"categoryId",items:o,rowProps:{className:`${t} euiTableRow--topAligned`},onChange:c,sorting:u})}))`
  &.euiTableRow--topAligned .euiTableRowCell {
    vertical-align: top;
  }
`,ea=(e,t,n,a,r)=>[{align:"right",field:"logEntryCount",name:h.i18n.translate("xpack.infra.logs.logEntryCategories.countColumnTitle",{defaultMessage:"Message count"}),sortable:!0,render:e=>en()(e).format("0,0"),width:"120px"},{field:"histograms",name:h.i18n.translate("xpack.infra.logs.logEntryCategories.trendColumnTitle",{defaultMessage:"Trend"}),render:(t,n)=>i.a.createElement(Kn,{currentCount:n.logEntryCount,histograms:t,timeRange:e}),width:"220px"},{field:"regularExpression",name:h.i18n.translate("xpack.infra.logs.logEntryCategories.categoryColumnTitle",{defaultMessage:"Category"}),truncateText:!0,render:e=>i.a.createElement(On,{regularExpression:e})},{field:"datasets",name:h.i18n.translate("xpack.infra.logs.logEntryCategories.datasetColumnTitle",{defaultMessage:"Datasets"}),render:e=>i.a.createElement(Hn,{datasets:e}),width:"200px"},{align:"right",field:"maximumAnomalyScore",name:h.i18n.translate("xpack.infra.logs.logEntryCategories.maximumAnomalyScoreColumnTitle",{defaultMessage:"Maximum anomaly score"}),sortable:!0,render:(e,t)=>i.a.createElement(ln,{datasets:t.datasets}),width:"160px"},{actions:[{render:n=>i.a.createElement(An,{categorizationJobId:t,categoryId:n.categoryId,datasets:n.datasets,timeRange:e})}],width:"40px"},{align:"right",isExpander:!0,render:e=>i.a.createElement(an,{isExpanded:n.has(e.categoryId),item:e.categoryId,onCollapse:r,onExpand:a}),width:"40px"}],ta=({isLoadingTopCategories:e=!1,jobId:t,sourceId:n,timeRange:a,topCategories:r,sortOptions:o,changeSortOptions:s})=>i.a.createElement(i.a.Fragment,null,i.a.createElement(Kt.a,{isLoading:e,loadingChildren:i.a.createElement(aa,null)},i.a.createElement(Xn,{categorizationJobId:t,sourceId:n,timeRange:a,topCategories:r,sortOptions:o,changeSortOptions:s}))),na=h.i18n.translate("xpack.infra.logs.logEntryCategories.topCategoriesSectionLoadingAriaLabel",{defaultMessage:"Loading message categories"}),aa=()=>i.a.createElement(d.EuiLoadingSpinner,{size:"xl","aria-label":na}),ia=({categoriesCount:e,filteredDatasets:t,endTime:n,onGetLogEntryCategoryDatasetsError:i,onGetTopLogEntryCategoriesError:r,sourceId:o,startTime:s})=>{const[l,u]=Object(a.useState)({field:"maximumAnomalyScore",direction:"desc"}),{services:c}=Object(_e.b)(),[d,m]=Object(a.useState)([]),[g,h]=Object(a.useState)([]),[p,f]=Object(Me.c)({cancelPreviousOn:"creation",createPromise:async()=>await(async(e,t)=>{const{sourceId:n,startTime:a,endTime:i,categoryCount:r,datasets:o,sort:s}=e,l=i-a,u=await t(un.d,{method:"POST",body:JSON.stringify(un.p.encode({data:{sourceId:n,timeRange:{startTime:a,endTime:i},categoryCount:r,datasets:o,histograms:[{id:"history",timeRange:{startTime:a-l,endTime:i},bucketCount:10},{id:"reference",timeRange:{startTime:a-l,endTime:a},bucketCount:1}],sort:s}}))});return Object(I.b)(un.q)(u)})({sourceId:o,startTime:s,endTime:n,categoryCount:e,datasets:t,sort:l},c.http.fetch),onResolve:({data:{categories:e}})=>{m(e)},onReject:e=>{e instanceof Error&&!(e instanceof Me.a)&&r&&r(e)}},[e,n,t,o,s,l]),[y,b]=Object(Me.c)({cancelPreviousOn:"creation",createPromise:async()=>await(async(e,t)=>{const{sourceId:n,startTime:a,endTime:i}=e,r=await t(un.e,{method:"POST",body:JSON.stringify(un.r.encode({data:{sourceId:n,timeRange:{startTime:a,endTime:i}}}))});return Object(I.b)(un.s)(r)})({sourceId:o,startTime:s,endTime:n},c.http.fetch),onResolve:({data:{datasets:e}})=>{h(e)},onReject:e=>{e instanceof Error&&!(e instanceof Me.a)&&i&&i(e)}},[e,n,o,s]),E=Object(a.useMemo)((()=>"pending"===p.state),[p.state]),v=Object(a.useMemo)((()=>"pending"===y.state),[y.state]);return{getLogEntryCategoryDatasets:b,getTopLogEntryCategories:f,isLoading:Object(a.useMemo)((()=>E||v),[v,E]),isLoadingLogEntryCategoryDatasets:v,isLoadingTopLogEntryCategories:E,logEntryCategoryDatasets:g,topLogEntryCategories:d,sortOptions:l,changeSortOptions:u}};var ra=n(20),oa=n(21),sa=n(29),la=n(99),ua=n(125);const ca=F.union([F.type({interval:F.number,isPaused:F.boolean}),F[void 0]]),da=F.type({startTime:F.string,endTime:F.string}),ma=F.union([da,F[void 0]]),ga={from:"now-2w",to:"now"},ha=({hasData:e=!0,"data-test-subj":t,...n})=>{const{services:{observability:{navigation:{PageTemplate:a}},docLinks:r}}=Object(_e.b)(),{http:o}=Object(b.useKibana)().services,s=o.basePath.get(),l=e?void 0:{solution:h.i18n.translate("xpack.infra.logs.noDataConfig.solutionName",{defaultMessage:"Observability"}),actions:{beats:{title:h.i18n.translate("xpack.infra.logs.noDataConfig.beatsCard.title",{defaultMessage:"Add a logging integration"}),description:h.i18n.translate("xpack.infra.logs.noDataConfig.beatsCard.description",{defaultMessage:"Use the Elastic Agent or Beats to send logs to Elasticsearch. We make it easy with integrations for many popular systems and apps."}),href:s+"/app/integrations/browse"}},docsLink:r.links.observability.guide};return i.a.createElement(a,g()({"data-test-subj":e?t:"noDataPage",noDataConfig:l},n))},pa=({availableDatasets:e,isLoading:t=!1,onChangeDatasetSelection:n,selectedDatasets:r})=>{const o=Object(a.useMemo)((()=>e.map((e=>({value:e,label:Object(O.j)(e)})))),[e]),s=Object(a.useMemo)((()=>o.filter((({value:e})=>null!=e&&r.includes(e)))),[o,r]),l=Object(a.useCallback)((e=>n(e.map((({value:e})=>e)).filter(ya))),[n]);return i.a.createElement(d.EuiComboBox,{"aria-label":fa,isLoading:t,onChange:l,options:o,placeholder:fa,selectedOptions:s})},fa=h.i18n.translate("xpack.infra.logs.analysis.datasetFilterPlaceholder",{defaultMessage:"Filter by datasets"}),ya=e=>null!=e,ba=({onOpenSetup:e,pageTitle:t})=>{Object(Fe.useTrackPageview)({app:"infra_logs",path:"log_entry_categories_results"}),Object(Fe.useTrackPageview)({app:"infra_logs",path:"log_entry_categories_results",delay:15e3});const{services:{ml:n,http:r}}=Object(_e.b)(),{sourceStatus:o}=Object(x.c)(),{hasLogAnalysisSetupCapabilities:s}=gt(),{fetchJobStatus:l,fetchModuleDefinition:u,moduleDescriptor:c,setupStatus:m,hasOutdatedJobConfigurations:g,hasOutdatedJobDefinitions:h,hasStoppedJobs:p,jobIds:f,categoryQualityWarnings:y,sourceConfiguration:{sourceId:E}}=qe(),{timeRange:v,setTimeRange:_,autoRefresh:M,setAutoRefresh:S}=(()=>{const[e]=Object(ua.a)(ga),{from:t,to:n}=e(),[a,i]=Object(la.b)({defaultState:{startTime:t,endTime:n},decodeUrlState:e=>Object(sa.pipe)(ma.decode(e),Object(ra.fold)(Object(oa.constant)(void 0),oa.identity)),encodeUrlState:ma.encode,urlStateKey:"timeRange",writeDefaultState:!0});Object(ua.b)(ga,{from:a.startTime,to:a.endTime});const[r,o]=Object(la.b)({defaultState:{isPaused:!1,interval:6e4},decodeUrlState:e=>Object(sa.pipe)(ca.decode(e),Object(ra.fold)(Object(oa.constant)(void 0),oa.identity)),encodeUrlState:ca.encode,urlStateKey:"autoRefresh",writeDefaultState:!0});return{timeRange:a,setTimeRange:i,autoRefresh:r,setAutoRefresh:o}})(),[T,C]=Object(a.useState)((()=>({lastChangedTime:Date.now(),timeRange:Ea(v)}))),[O,j]=Object(a.useState)([]),{services:w}=Object(b.useKibana)(),k=Object(a.useCallback)((e=>{var t;null===(t=w.notifications)||void 0===t||t.toasts.addError(e,{title:va})}),[w.notifications]),{getLogEntryCategoryDatasets:F,getTopLogEntryCategories:I,isLoadingLogEntryCategoryDatasets:L,isLoadingTopLogEntryCategories:P,logEntryCategoryDatasets:D,topLogEntryCategories:R,sortOptions:N,changeSortOptions:A}=ia({categoriesCount:25,endTime:T.timeRange.endTime,filteredDatasets:O,onGetTopLogEntryCategoriesError:k,sourceId:E,startTime:T.timeRange.startTime}),H=Object(a.useCallback)((({start:e,end:t})=>{C((n=>({...n,timeRange:Ea({startTime:e,endTime:t}),lastChangedTime:Date.now()})))}),[C]),U=Object(a.useCallback)((e=>{e.isInvalid||(_({startTime:e.start,endTime:e.end}),H(e))}),[_,H]),z=Object(a.useCallback)((({isPaused:e,refreshInterval:t})=>{S({isPaused:e,interval:t})}),[S]),J=Object(a.useMemo)((()=>R.length>0),[R.length]),B=Object(a.useMemo)((()=>("skipped"===m.type&&!!m.newlyCreated||"succeeded"===m.type)&&!J),[J,m]);Object(a.useEffect)((()=>{I()}),[I,O,T.lastChangedTime,N]),Object(a.useEffect)((()=>{F()}),[F,T.lastChangedTime]),Object(a.useEffect)((()=>{u()}),[u]),It()((()=>{l()}),3e4),It()((()=>{H({start:v.startTime,end:v.endTime})}),M.isPaused?null:M.interval);const Y=Object(Ln.useMlHref)(n,r.basePath.get(),{page:Ln.ML_PAGES.ANOMALY_EXPLORER,pageState:{jobIds:[f["log-entry-categories-count"]],timeRange:{from:kt()(T.timeRange.startTime).format("YYYY-MM-DDTHH:mm:ss.SSSZ"),to:kt()(T.timeRange.endTime).format("YYYY-MM-DDTHH:mm:ss.SSSZ"),mode:"absolute"}}});return i.a.createElement(Vt.Provider,{sourceId:E,startTimestamp:T.timeRange.startTime,endTimestamp:T.timeRange.endTime},i.a.createElement(ha,{hasData:"missing"!==(null==o?void 0:o.logIndexStatus),pageHeader:{pageTitle:t,rightSideItems:[i.a.createElement(pt.b,{hasSetupCapabilities:s,onClick:e,size:"s"}),i.a.createElement(Ut,{href:Y})]}},i.a.createElement(d.EuiFlexGroup,{direction:"column"},i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(d.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"center"},i.a.createElement(d.EuiFlexItem,null,i.a.createElement(pa,{availableDatasets:D,isLoading:L,onChangeDatasetSelection:j,selectedDatasets:O})),i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(d.EuiSuperDatePicker,{start:v.startTime,end:v.endTime,onTimeChange:U,isPaused:M.isPaused,refreshInterval:M.interval,onRefreshChange:z})))),i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(Ln.MLJobsAwaitingNodeWarning,{jobIds:Object.values(f)}),i.a.createElement(Yt,{hasOutdatedJobConfigurations:g,hasOutdatedJobDefinitions:h,hasSetupCapabilities:s,hasStoppedJobs:p,isFirstUse:B,moduleName:c.moduleName,onRecreateMlJobForReconfiguration:e,onRecreateMlJobForUpdate:e,qualityWarnings:y})),i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(ta,{isLoadingTopCategories:P,jobId:f["log-entry-categories-count"],sourceId:E,timeRange:T.timeRange,topCategories:R,sortOptions:N,changeSortOptions:A})))),i.a.createElement(Gt,null))},Ea=e=>({startTime:kt()(jt.a.parse(e.startTime,{momentInstance:kt.a})).valueOf(),endTime:kt()(jt.a.parse(e.endTime,{momentInstance:kt.a,roundUp:!0})).valueOf()}),va=(Object(Lt.euiStyled)(d.EuiPage)`
  flex: 1 0 0%;
  flex-direction: column;

  .euiFlexGroup--responsive > .euiFlexItem {
    flex-basis: auto !important;
  }
`,h.i18n.translate("xpack.infra.logs.logEntryCategories.loadDataErrorTitle",{defaultMessage:"Failed to load category data"})),xa=({onOpenSetup:e})=>(Object(Fe.useTrackPageview)({app:"infra_logs",path:"log_entry_categories_setup"}),Object(Fe.useTrackPageview)({app:"infra_logs",path:"log_entry_categories_setup",delay:15e3}),i.a.createElement(d.EuiEmptyPrompt,{"data-test-subj":"logEntryCategoriesSetupPage",title:i.a.createElement("h2",null,i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logs.logEntryCategories.setupTitle",defaultMessage:"Set up log category analysis"})),body:i.a.createElement(d.EuiText,{size:"s"},i.a.createElement("p",null,i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logs.logEntryCategories.setupDescription",defaultMessage:"To enable log categories, set up a machine learning job."}))),actions:i.a.createElement(d.EuiButton,{fill:!0,onClick:e},i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logs.logEntryCategories.showAnalysisSetupButtonLabel",defaultMessage:"ML setup"}))})),_a=h.i18n.translate("xpack.infra.logs.logCategoriesTitle",{defaultMessage:"Categories"}),Ma=()=>{const{hasLogAnalysisCapabilites:e,hasLogAnalysisReadCapabilities:t,hasLogAnalysisSetupCapabilities:n}=gt(),{fetchJobStatus:r,setupStatus:o,jobStatus:s}=qe(),{showModuleSetup:l}=xt(),u=Object(a.useCallback)((()=>l("logs_ui_categories")),[l]);return Object(a.useEffect)((()=>{t&&r()}),[r,t]),e?t?"initializing"===o.type?i.a.createElement(j.a,{message:h.i18n.translate("xpack.infra.logs.logEntryCategories.jobStatusLoadingMessage",{defaultMessage:"Checking status of categorization jobs..."})}):"unknown"===o.type?i.a.createElement(Ta,{isEmptyState:!0},i.a.createElement(w.a,{retry:r})):Object(O.p)(s["log-entry-categories-count"])?i.a.createElement(i.a.Fragment,null,i.a.createElement(ba,{onOpenSetup:u,pageTitle:_a}),i.a.createElement(Mt,{allowedModules:Sa})):n?i.a.createElement(i.a.Fragment,null,i.a.createElement(Ta,{isEmptyState:!0},i.a.createElement(xa,{onOpenSetup:u})),i.a.createElement(Mt,{allowedModules:Sa})):i.a.createElement(Ta,{isEmptyState:!0},i.a.createElement(w.c,null)):i.a.createElement(Ta,{isEmptyState:!0},i.a.createElement(w.b,null)):i.a.createElement(Ct.a,{"data-test-subj":"logsLogEntryCategoriesPage",pageHeader:{pageTitle:_a}})},Sa=["logs_ui_categories"],Ta=({children:e,...t})=>{const{sourceStatus:n}=Object(x.c)();return i.a.createElement(ha,g()({hasData:"missing"!==(null==n?void 0:n.logIndexStatus),"data-test-subj":"logsLogEntryCategoriesPage",pageHeader:t.isEmptyState?void 0:{pageTitle:_a}},t),e)};var Ca=n(72),Oa=n(6);const ja=({errors:e,onRetry:t})=>{const n=Object(Ht.b)({app:"logs",pathname:"/settings"});return i.a.createElement(ha,{isEmptyState:!0},i.a.createElement(d.EuiEmptyPrompt,{iconType:"alert",iconColor:"danger",title:i.a.createElement("h2",null,i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logSourceErrorPage.failedToLoadSourceTitle",defaultMessage:"Failed to load configuration"})),body:i.a.createElement(i.a.Fragment,null,i.a.createElement("p",null,i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logSourceErrorPage.failedToLoadSourceMessage",defaultMessage:"Errors occurred while attempting to load the configuration. Try again or change the configuration to fix the problem."})),e.map((e=>i.a.createElement(i.a.Fragment,{key:e.name},i.a.createElement(wa,{error:e}),i.a.createElement(d.EuiSpacer,null))))),actions:[i.a.createElement(d.EuiButton,{onClick:t,iconType:"refresh",fill:!0},i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logSourceErrorPage.tryAgainButtonLabel",defaultMessage:"Try again"})),i.a.createElement(d.EuiButtonEmpty,g()({iconType:"gear"},n),i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logSourceErrorPage.navigateToSettingsButtonLabel",defaultMessage:"Change configuration"}))]}))},wa=({error:e})=>{var t,n,a,r,o,s;return e instanceof Oa.d?i.a.createElement(ka,{title:i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logSourceErrorPage.resolveLogSourceConfigurationErrorTitle",defaultMessage:"Failed to resolve the log source configuration"})},Object(Ca.isSavedObjectNotFoundError)(e.cause)?i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logSourceErrorPage.savedObjectNotFoundErrorMessage",defaultMessage:"Failed to locate that {savedObjectType}: {savedObjectId}",values:{savedObjectType:e.cause.savedObjectType,savedObjectId:e.cause.savedObjectId}}):`${null!==(t=null===(n=e.cause)||void 0===n?void 0:n.message)&&void 0!==t?t:e.message}`):e instanceof Oa.a?i.a.createElement(ka,{title:i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logSourceErrorPage.fetchLogSourceConfigurationErrorTitle",defaultMessage:"Failed to load the log source configuration"})},`${null!==(a=null===(r=e.cause)||void 0===r?void 0:r.message)&&void 0!==a?a:e.message}`):e instanceof Oa.b?i.a.createElement(ka,{title:i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logSourceErrorPage.fetchLogSourceStatusErrorTitle",defaultMessage:"Failed to determine the status of the log source"})},`${null!==(o=null===(s=e.cause)||void 0===s?void 0:s.message)&&void 0!==o?o:e.message}`):i.a.createElement(ka,{title:e.name},`${e.message}`)},ka=({title:e,children:t})=>i.a.createElement(d.EuiCallOut,{className:"eui-textLeft",color:"danger",iconType:"alert",title:e},i.a.createElement("p",null,t));var Fa=n(111),Ia=n(171);const La=({children:e})=>{const{hasFailedLoading:t,isLoading:n,isUninitialized:a,latestLoadSourceFailures:r,loadSource:o,resolvedSourceConfiguration:s,sourceId:l}=Object(x.c)(),{space:u}=Object(Ia.a)();return null==u?null:t?i.a.createElement(ja,{errors:r,onRetry:o}):n||a?i.a.createElement(Fa.a,null):null!=s?i.a.createElement(Ve,{indexPattern:s.indices,sourceId:l,spaceId:u.id,timestampField:s.timestampField,runtimeMappings:s.runtimeMappings},i.a.createElement(vt,null,e)):null},Pa=()=>(C([{text:T.c}]),i.a.createElement(d.EuiErrorBoundary,null,i.a.createElement(La,null,i.a.createElement(Ma,null))));var Da=n(22),Ra=n(124),Na=n(204);const Aa=F.type({sourceId:F.string,logEntryId:F.string}),Ha=F.type({id:F.string,index:F.string,fields:F.array(Ra.e),cursor:Ra.d}),Ua=F.intersection([F.type({data:F.union([Ha,F.null])}),F.partial({errors:F.array(Na.a)})]);var za=n(154);const Ja=Object(za.b)(null,Object(I.b)(Ua)),Ba=Object(Lt.euiStyled)(d.EuiFlyoutBody)`
  & .euiFlyoutBody__overflow {
    display: flex;
    flex-direction: column;
  }

  & .euiFlyoutBody__overflowContent {
    align-items: center;
    align-self: stretch;
    display: flex;
    flex-direction: column;
    flex-grow: 1;
    justify-content: center;
    overflow: hidden;
  }
`,Ya=({errors:e,onRetry:t,title:n})=>{const a=e.some((e=>"aborted"!==e.type))?"danger":"warning";return i.a.createElement(d.EuiCallOut,{color:a,iconType:"alert",title:n},null==e?void 0:e.map(((e,t)=>i.a.createElement(Va,{key:t,error:e}))),t?i.a.createElement(d.EuiButton,{color:a,size:"s",onClick:t},i.a.createElement(k.FormattedMessage,{id:"xpack.infra.dataSearch.loadingErrorRetryButtonLabel",defaultMessage:"Retry"})):null)},Va=({error:e})=>"aborted"===e.type?i.a.createElement(qa,{error:e}):"shardFailure"===e.type?i.a.createElement($a,{error:e}):i.a.createElement(Wa,{error:e}),qa=({})=>i.a.createElement(k.FormattedMessage,{tagName:"p",id:"xpack.infra.dataSearch.abortedRequestErrorMessage",defaultMessage:"The request was aborted."}),Wa=({error:e})=>{var t;return i.a.createElement("p",null,null!==(t=e.message)&&void 0!==t?t:`${e}`)},$a=({error:e})=>i.a.createElement(k.FormattedMessage,{tagName:"p",id:"xpack.infra.dataSearch.shardFailureErrorMessage",defaultMessage:"Index {indexName}: {errorMessage}",values:{indexName:e.shardInfo.index,errorMessage:e.message}}),Ga=({label:e,maxValue:t,onCancel:n,value:r})=>{const o=Object(a.useMemo)((()=>Number.isFinite(t)&&Number.isFinite(r)?`${r} / ${t}`:void 0),[r,t]);return i.a.createElement(d.EuiFlexGroup,{alignItems:"center"},i.a.createElement(d.EuiFlexItem,null,i.a.createElement(d.EuiProgress,{label:e,size:"s",max:t,value:r,valueText:o})),n?i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(d.EuiButtonIcon,{color:"danger",iconType:"cross",onClick:n,title:Qa,"aria-label":Qa})):null)},Qa=h.i18n.translate("xpack.infra.dataSearch.cancelButtonLabel",{defaultMessage:"Cancel request"});var Za=n(144);const Ka=["container.id","host.ip","kubernetes.pod.uid"],Xa=({logEntry:e})=>{const{hide:t,isVisible:n,show:r}=Object(Za.a)(!1),o=Object(a.useMemo)((()=>ti(e)),[e]),s=Object(a.useMemo)((()=>ei(e)),[e]),l=Object(Ht.b)({app:"uptime",...s||{}}),u=Object(Ht.b)({app:"apm",...o||{}}),c=Object(a.useMemo)((()=>[i.a.createElement(d.EuiContextMenuItem,g()({"data-test-subj":"logEntryActionsMenuItem uptimeLogEntryActionsMenuItem",disabled:!s,icon:"uptimeApp",key:"uptimeLink"},l),i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logEntryActionsMenu.uptimeActionLabel",defaultMessage:"View status in Uptime"})),i.a.createElement(d.EuiContextMenuItem,g()({"data-test-subj":"logEntryActionsMenuItem apmLogEntryActionsMenuItem",disabled:!o,icon:"apmApp",key:"apmLink"},u),i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logEntryActionsMenu.apmActionLabel",defaultMessage:"View in APM"}))]),[s,o,u,l]),m=Object(a.useMemo)((()=>c.length>0),[c]);return i.a.createElement(d.EuiPopover,{anchorPosition:"downRight",button:i.a.createElement(d.EuiButton,{"data-test-subj":"logEntryActionsMenuButton",disabled:!m,iconSide:"right",iconType:"arrowDown",onClick:r},i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logEntryActionsMenu.buttonLabel",defaultMessage:"Investigate"})),closePopover:t,id:"logEntryActionsMenu",isOpen:n,panelPaddingSize:"none"},i.a.createElement(d.EuiContextMenuPanel,{items:c}))},ei=e=>{const t=e.fields.filter((({field:e,value:t})=>null!=t&&Ka.includes(e))).reduce(((e,t)=>{const{field:n,value:a}=t;return e.concat(a.map((e=>`${n}:${e}`)))}),[]);if(0!==t.length)return{app:"uptime",hash:"/",search:{search:`${t.join(" or ")}`}}},ti=e=>{var t,n;const a=null===(t=e.fields.find((({field:e,value:t})=>"string"==typeof t[0]&&"trace.id"===e)))||void 0===t||null===(n=t.value)||void 0===n?void 0:n[0];if("string"!=typeof a)return;const i=e.fields.find((({field:e})=>"@timestamp"===e)),r=i?i.value[0]:null,{rangeFrom:o,rangeTo:s}="number"==typeof r?(()=>{const e=new Date(r),t=new Date(r);return e.setMinutes(e.getMinutes()-10),t.setMinutes(t.getMinutes()+10),{rangeFrom:e.toISOString(),rangeTo:t.toISOString()}})():{rangeFrom:"now-1y",rangeTo:"now"};return{app:"apm",pathname:Object(Fe.getApmTraceUrl)({traceId:a,rangeFrom:o,rangeTo:s})}};var ni=n(128),ai=n(183);const ii=({logEntry:e,onSetFieldFilter:t})=>{const n=Object(a.useMemo)((()=>t?n=>()=>{F.array(ni.c).is(n.value)&&(null==t||t({language:"kuery",query:`${ci(n.field)}:${n.value.map(ci).join(" OR ")}`},e.id,e.cursor))}:void 0),[e,t]),r=Object(a.useMemo)((()=>[{field:"field",name:h.i18n.translate("xpack.infra.logFlyout.fieldColumnLabel",{defaultMessage:"Field"}),sortable:!0},{actions:[{type:"icon",icon:"filter",name:li,description:ui,available:()=>!!n,onClick:e=>null==n?void 0:n(e)()}]},{field:"value",name:h.i18n.translate("xpack.infra.logFlyout.valueColumnLabel",{defaultMessage:"Value"}),render:(e,t)=>i.a.createElement(ai.a,{highlightTerms:ri,isActiveHighlight:!1,value:t.value})}]),[n]);return i.a.createElement(d.EuiInMemoryTable,{columns:r,items:e.fields,search:si,sorting:oi})},ri=[],oi={sort:{field:"field",direction:"asc"}},si={box:{incremental:!0,schema:!0}},li=h.i18n.translate("xpack.infra.logFlyout.filterAriaLabel",{defaultMessage:"Filter"}),ui=h.i18n.translate("xpack.infra.logFlyout.setFilterTooltip",{defaultMessage:"View event with filter"}),ci=e=>"string"==typeof e?`"${e.replace(/"/g,'\\"')}"`:e,di=({logEntryId:e,onCloseFlyout:t,onSetFieldFilter:n,sourceId:r})=>{var o;const{cancelRequest:s,errors:l,fetchLogEntry:u,isRequestRunning:c,loaded:m,logEntry:g,total:h}=(({sourceId:e,logEntryId:t})=>{const{search:n,requests$:i}=Object(za.c)({getRequest:Object(a.useCallback)((()=>t&&e?{request:{params:Aa.encode({sourceId:e,logEntryId:t})},options:{strategy:"infra-log-entry"}}:null),[e,t]),parseResponses:Ja}),{cancelRequest:r,isRequestRunning:o,isResponsePartial:s,latestResponseData:l,latestResponseErrors:u,loaded:c,total:d}=Object(za.e)(i);return{cancelRequest:r,errors:u,fetchLogEntry:n,isRequestRunning:o,isResponsePartial:s,loaded:c,logEntry:null!=l?l:null,total:d}})({sourceId:r,logEntryId:e});return Object(a.useEffect)((()=>{r&&e&&u()}),[u,r,e]),i.a.createElement(d.EuiFlyout,{onClose:t,size:"m"},i.a.createElement(d.EuiFlyoutHeader,{hasBorder:!0},i.a.createElement(d.EuiFlexGroup,{alignItems:"center"},i.a.createElement(d.EuiFlexItem,null,i.a.createElement(d.EuiTitle,{size:"s"},i.a.createElement("h3",{id:"flyoutTitle"},i.a.createElement(k.FormattedMessage,{defaultMessage:"Details for log entry {logEntryId}",id:"xpack.infra.logFlyout.flyoutTitle",values:{logEntryId:e?i.a.createElement("code",null,e):""}}))),g?i.a.createElement(i.a.Fragment,null,i.a.createElement(d.EuiSpacer,{size:"s"}),i.a.createElement(d.EuiTextColor,{color:"subdued"},i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logFlyout.flyoutSubTitle",defaultMessage:"From index {indexName}",values:{indexName:i.a.createElement("code",null,g.index)}}))):null),i.a.createElement(d.EuiFlexItem,{style:{padding:8},grow:!1},g?i.a.createElement(Xa,{logEntry:g}):null))),c?i.a.createElement(Ba,null,i.a.createElement("div",{style:{width:"75%"}},i.a.createElement(Ga,{label:mi,maxValue:h,onCancel:s,value:m}))):g?i.a.createElement(d.EuiFlyoutBody,{banner:(null!==(o=null==l?void 0:l.length)&&void 0!==o?o:0)>0?i.a.createElement(Ya,{title:gi,errors:null!=l?l:[],onRetry:u}):void 0},i.a.createElement(ii,{logEntry:g,onSetFieldFilter:n})):i.a.createElement(Ba,null,i.a.createElement("div",{style:{width:"75%"}},i.a.createElement(Ya,{title:gi,errors:null!=l?l:[],onRetry:u}))))},mi=h.i18n.translate("xpack.infra.logFlyout.loadingMessage",{defaultMessage:"Searching log entry in shards"}),gi=h.i18n.translate("xpack.infra.logFlyout.loadingErrorCalloutTitle",{defaultMessage:"Error while searching the log entry"});var hi=n(105);let pi;!function(e){e.hidden="hidden",e.visible="visible"}(pi||(pi={}));const fi=xe()((()=>{const[e,t]=Object(a.useState)(!1),[n,i]=Object(a.useState)(null),[r,o]=Object(a.useState)(null);return{isFlyoutOpen:e,closeFlyout:Object(a.useCallback)((()=>t(!1)),[]),openFlyout:Object(a.useCallback)((e=>{e&&i(e),t(!0)}),[]),logEntryId:n,setLogEntryId:i,surroundingLogsId:r,setSurroundingLogsId:o}})),[yi,bi]=fi,Ei=()=>{const{isFlyoutOpen:e,openFlyout:t,closeFlyout:n,logEntryId:a,setLogEntryId:r,surroundingLogsId:o,setSurroundingLogsId:s}=bi();return i.a.createElement(hi.a,{urlState:{flyoutVisibility:e?pi.visible:pi.hidden,flyoutId:a,surroundingLogsId:o},urlStateKey:"flyoutOptions",mapToUrlState:vi,onChange:e=>{e&&e.flyoutId&&r(e.flyoutId),e&&e.surroundingLogsId&&s(e.surroundingLogsId),e&&e.flyoutVisibility===pi.visible&&t(),e&&e.flyoutVisibility===pi.hidden&&n()},onInitialize:e=>{e&&e.flyoutId&&r(e.flyoutId),e&&e.surroundingLogsId&&s(e.surroundingLogsId),e&&e.flyoutVisibility===pi.visible&&t(),e&&e.flyoutVisibility===pi.hidden&&n()}})},vi=e=>e?{flyoutId:xi(e.flyoutId),flyoutVisibility:Mi(e.flyoutVisibility),surroundingLogsId:_i(e.surroundingLogsId)}:void 0,xi=e=>e&&Object(We.isString)(e)?e:void 0,_i=e=>e&&Object(We.isString)(e)?e:void 0,Mi=e=>{if(e){if("visible"===e)return pi.visible;if("hidden"===e)return pi.hidden}};var Si=n(49),Ti=n(103);const Ci=({embeddableType:e})=>i.a.createElement(d.EuiCallOut,{size:"s",color:"warning",title:h.i18n.translate("xpack.infra.missingEmebeddableFactoryCallout",{defaultMessage:"{embeddableType} embeddable is unavailable. This can happen if the embeddable plugin isn't enabled.",values:{embeddableType:e}})}),Oi={pause:!0,value:0},ji=e=>{const{embeddable:t}=Object(_e.b)().services;return t?i.a.createElement(wi,e):null},wi=({timeRange:e,jobIds:t,selectedDatasets:n})=>{const{embeddable:r}=Object(_e.b)().services,o=null==r?void 0:r.getEmbeddableFactory(Ln.ANOMALY_SWIMLANE_EMBEDDABLE_TYPE),s=Object(a.useMemo)((()=>({id:"LOG_ENTRY_ANOMALIES_EMBEDDABLE_INSTANCE",jobIds:t,swimlaneType:"viewBy",timeRange:{from:kt()(e.startTime).format("YYYY-MM-DDTHH:mm:ss.SSSZ"),to:kt()(e.endTime).format("YYYY-MM-DDTHH:mm:ss.SSSZ")},refreshConfig:Oi,viewBy:Ti.i,filters:[],query:{language:"kuery",query:n.map((e=>`${Ti.i} : ${""!==e?e:'""'}`)).join(" or ")}})),[t,e.startTime,e.endTime,n]);return o?i.a.createElement(Si.EmbeddableRenderer,{input:s,factory:o}):i.a.createElement(Ci,{embeddableType:Ln.ANOMALY_SWIMLANE_EMBEDDABLE_TYPE})};var ki=n(78);const Fi=({dataset:e,endTime:t,exampleCount:n,sourceId:i,startTime:r,categoryId:o})=>{const{services:s}=Object(_e.b)(),[l,u]=Object(a.useState)([]),[c,d]=Object(Me.c)({cancelPreviousOn:"creation",createPromise:async()=>await(async(e,t)=>{const{sourceId:n,startTime:a,endTime:i,dataset:r,exampleCount:o,categoryId:s}=e,l=await t(un.g,{method:"POST",body:JSON.stringify(un.v.encode({data:{dataset:r,exampleCount:o,sourceId:n,timeRange:{startTime:a,endTime:i},categoryId:s}}))});return Object(I.b)(un.w)(l)})({sourceId:i,startTime:r,endTime:t,dataset:e,exampleCount:n,categoryId:o},s.http.fetch),onResolve:({data:{examples:e}})=>{u(e)}},[e,t,n,i,r]),m=Object(a.useMemo)((()=>"pending"===c.state),[c.state]);return{getLogEntryExamples:d,hasFailedLoadingLogEntryExamples:Object(a.useMemo)((()=>"rejected"===c.state),[c.state]),isLoadingLogEntryExamples:m,logEntryExamples:l}};var Ii=n(206);const Li=e=>null!=e&&"messageColumn"in e,Pi=e=>null!=e&&"timestampColumn"in e;var Di=n(169);const Ri=h.i18n.translate("xpack.infra.logAnomalies.logEntryExamplesMenuLabel",{defaultMessage:"View actions for log entry"}),Ni=h.i18n.translate("xpack.infra.logs.analysis.logEntryExamplesViewDetailsLabel",{defaultMessage:"View details"}),Ai=h.i18n.translate("xpack.infra.logs.analysis.logEntryExamplesViewInStreamLabel",{defaultMessage:"View in stream"}),Hi=h.i18n.translate("xpack.infra.logs.analysis.logEntryExamplesViewAnomalyInMlLabel",{defaultMessage:"View anomaly in machine learning"}),Ui=({id:e,dataset:t,message:n,timestamp:r,tiebreaker:o,timeRange:s,anomaly:l})=>{const{services:{ml:u,http:c,application:d}}=Object(_e.b)(),[m,h]=Object(a.useState)(!1),[p,f]=Object(a.useState)(!1),y=Object(a.useCallback)((()=>f(!0)),[]),b=Object(a.useCallback)((()=>f(!1)),[]),E=Object(a.useCallback)((()=>h(!0)),[]),v=Object(a.useCallback)((()=>h(!1)),[]),{openFlyout:x}=bi(),_=Object(O.j)(t),M=Object(Ht.b)({app:"logs",pathname:"stream",search:{logPosition:Object(fn.encode)({end:kt()(s.endTime).format("YYYY-MM-DDTHH:mm:ss.SSSZ"),position:{tiebreaker:o,time:r},start:kt()(s.startTime).format("YYYY-MM-DDTHH:mm:ss.SSSZ"),streamLive:!1}),flyoutOptions:Object(fn.encode)({surroundingLogsId:e}),...t?{logFilter:Object(fn.encode)({expression:`${Pn.i}: ${t}`,kind:"kuery"})}:{}}}),S=Object(Ln.useMlHref)(u,c.basePath.get(),{page:Ln.ML_PAGES.SINGLE_METRIC_VIEWER,pageState:{jobIds:[l.jobId],timeRange:{from:kt()(s.startTime).format("YYYY-MM-DDTHH:mm:ss.SSSZ"),to:kt()(s.endTime).format("YYYY-MM-DDTHH:mm:ss.SSSZ"),mode:"absolute"},entities:{[Pn.i]:t,...Object(O.n)(l)?{mlcategory:l.categoryId}:{}}}}),T=Object(a.useCallback)((e=>{S&&Object(Ht.a)(e)&&d.navigateToUrl(S)}),[S,d]),C=Object(a.useMemo)((()=>{if(M.onClick&&S)return[{label:Ni,onClick:()=>{x(e)}},{label:Ai,onClick:M.onClick,href:M.href},{label:Hi,onClick:T,href:S}]}),[e,x,M,S,T]);return i.a.createElement(yn.e,{scale:"medium",onMouseEnter:E,onMouseLeave:v},i.a.createElement(yn.a,Vi[Ji],i.a.createElement(yn.f,{format:"time",time:r})),i.a.createElement(yn.a,Vi[Bi],i.a.createElement(yn.d,{columnValue:{columnId:Bi,message:[{field:"message",value:[n],highlights:[]}]},highlights:zi,isActiveHighlight:!1,wrapMode:"none"})),i.a.createElement(yn.a,Vi[Yi],i.a.createElement(yn.c,{columnValue:{columnId:Yi,field:"event.dataset",value:[_],highlights:[]},highlights:zi,isActiveHighlight:!1,wrapMode:"none"})),i.a.createElement(yn.a,g()({key:"logColumn iconLogColumn iconLogColumn:details"},Vi[yn.h]),(m||p)&&C?i.a.createElement(yn.b,{"aria-label":Ri,isOpen:p,onOpen:y,onClose:b,items:C}):null))},zi=[],Ji="log-entry-example-timestamp-column",Bi="log-entry-examples-message-column",Yi="log-entry-examples-dataset-column",Vi={[Ji]:{growWeight:0,shrinkWeight:0,baseWidth:"122px"},[Bi]:{growWeight:1,shrinkWeight:0,baseWidth:"0%"},[Yi]:{growWeight:0,shrinkWeight:0,baseWidth:"250px"},[yn.h]:{growWeight:0,shrinkWeight:0,baseWidth:"48px"}},qi=[{timestampColumn:{id:Ji}},{messageColumn:{id:Bi}},{fieldColumn:{field:"event.dataset",id:Yi}}],Wi=({dateTime:e})=>i.a.createElement($i,null,i.a.createElement(i.a.Fragment,null,qi.map((t=>{return Pi(t)?i.a.createElement(Ii.a,{key:t.timestampColumn.id,columnWidth:Vi[t.timestampColumn.id],"data-test-subj":"logColumnHeader timestampLogColumnHeader"},Object(Di.a)(e)):Li(t)?i.a.createElement(Ii.a,{columnWidth:Vi[t.messageColumn.id],"data-test-subj":"logColumnHeader messageLogColumnHeader",key:t.messageColumn.id},"Message"):null!=(n=t)&&"fieldColumn"in n?i.a.createElement(Ii.a,{columnWidth:Vi[t.fieldColumn.id],"data-test-subj":"logColumnHeader fieldLogColumnHeader",key:t.fieldColumn.id},t.fieldColumn.field):void 0;var n})),i.a.createElement(Ii.a,{columnWidth:Vi[yn.h],"data-test-subj":"logColumnHeader contextMenuLogColumnHeader",key:"icon-column-header"},null))),$i=Object(Lt.euiStyled)(Ii.c)`
  border-bottom: none;
  box-shadow: none;
  padding-right: 0;
`,Gi=h.i18n.translate("xpack.infra.logs.analysis.anomaliesTableExamplesTitle",{defaultMessage:"Example log entries"}),Qi=({anomaly:e,timeRange:t})=>{const{sourceId:n}=Object(x.c)(),{getLogEntryExamples:a,hasFailedLoadingLogEntryExamples:r,isLoadingLogEntryExamples:o,logEntryExamples:s}=Fi({dataset:e.dataset,endTime:e.startTime+e.duration,exampleCount:5,sourceId:n,startTime:e.startTime,categoryId:Object(O.n)(e)?e.categoryId:void 0});return f()((()=>{a()})),i.a.createElement(i.a.Fragment,null,i.a.createElement(Zi,{direction:"column"},i.a.createElement(d.EuiFlexItem,null,i.a.createElement(d.EuiTitle,{size:"xs"},i.a.createElement("h3",null,Gi))),i.a.createElement(d.EuiFlexItem,null,i.a.createElement(hn,{isLoading:o,hasFailedLoading:r,hasResults:s.length>0,exampleCount:5,onReload:a},s.length>0?i.a.createElement(i.a.Fragment,null,i.a.createElement(Wi,{dateTime:s[0].timestamp}),s.map(((n,a)=>i.a.createElement(Ui,{key:a,id:n.id,dataset:n.dataset,message:n.message,timestamp:n.timestamp,tiebreaker:n.tiebreaker,timeRange:t,anomaly:e})))):null)),i.a.createElement(d.EuiFlexItem,null,i.a.createElement(d.EuiFlexGroup,null,i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(d.EuiStat,{titleSize:"xs",title:`${en()(e.typical).format("0.[00]a")} ${h.i18n.translate("xpack.infra.logs.analysis.anomaliesExpandedRowTypicalRateTitle",{defaultMessage:"{typicalCount, plural, one {message} other {messages}}",values:{typicalCount:e.typical}})}`,description:h.i18n.translate("xpack.infra.logs.analysis.anomaliesExpandedRowTypicalRateDescription",{defaultMessage:"Typical"})})),i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(d.EuiStat,{titleSize:"xs",title:`${en()(e.actual).format("0.[00]a")} ${h.i18n.translate("xpack.infra.logs.analysis.anomaliesExpandedRowActualRateTitle",{defaultMessage:"{actualCount, plural, one {message} other {messages}}",values:{actualCount:e.actual}})}`,description:h.i18n.translate("xpack.infra.logs.analysis.anomaliesExpandedRowActualRateDescription",{defaultMessage:"Actual"})}))))))},Zi=Object(Lt.euiStyled)(d.EuiFlexGroup)`
  overflow: hidden;
`,Ki=h.i18n.translate("xpack.infra.logs.analysis.anomaliesTableAnomalyScoreColumnName",{defaultMessage:"Anomaly score"}),Xi=h.i18n.translate("xpack.infra.logs.analysis.anomaliesTableAnomalyMessageName",{defaultMessage:"Anomaly"}),er=h.i18n.translate("xpack.infra.logs.analysis.anomaliesTableAnomalyStartTime",{defaultMessage:"Start time"}),tr=h.i18n.translate("xpack.infra.logs.analysis.anomaliesTableAnomalyDatasetName",{defaultMessage:"Dataset"}),nr=({results:e,timeRange:t,changeSortOptions:n,sortOptions:r,changePaginationOptions:o,paginationOptions:s,fetchNextPage:l,fetchPreviousPage:u,page:c,isLoading:m})=>{const[g]=Object(Wn.a)("dateFormat","Y-MM-DD HH:mm:ss"),h=Object(a.useMemo)((()=>({sort:r})),[r]),p=Object(a.useMemo)((()=>e.map((e=>({id:e.id,dataset:e.dataset,anomalyScore:e.anomalyScore,startTime:e.startTime,type:e.type,typical:e.typical,actual:e.actual,categoryRegex:Object(O.n)(e)?e.categoryRegex:void 0})))),[e]),[f,{add:y,remove:b}]=nn()(new Set),E=Object(a.useMemo)((()=>[...f].reduce(((n,a)=>{const r=e.find((e=>e.id===a));return{...n,[a]:r?i.a.createElement(Qi,{anomaly:r,timeRange:t}):null}}),{})),[f,e,t]),v=Object(a.useCallback)((({sort:e={}})=>{n(e)}),[n]),x=Object(a.useMemo)((()=>[{field:"anomalyScore",name:Ki,sortable:!0,truncateText:!0,dataType:"number",width:"130px",render:e=>i.a.createElement(sn.a,{anomalyScore:e})},{name:Xi,truncateText:!0,render:e=>i.a.createElement(ar,{anomaly:e})},{field:"startTime",name:er,sortable:!0,truncateText:!0,width:"230px",render:e=>kt()(e).format(g)},{field:"dataset",name:tr,sortable:!0,truncateText:!0,width:"200px",render:e=>Object(O.j)(e)},{align:ki.RIGHT_ALIGNMENT,width:"40px",isExpander:!0,render:e=>i.a.createElement(an,{isExpanded:f.has(e.id),item:e.id,onExpand:y,onCollapse:b})}]),[b,y,f,g]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(Kt.a,{isLoading:m},i.a.createElement(d.EuiBasicTable,{items:p,itemId:"id",itemIdToExpandedRowMap:E,isExpandable:!0,hasActions:!0,columns:x,sorting:h,onChange:v}),i.a.createElement(d.EuiSpacer,{size:"l"}),i.a.createElement(or,{fetchNextPage:l,fetchPreviousPage:u,page:c,isLoading:m})))},ar=({anomaly:e})=>{const{type:t,actual:n,typical:a}=e,r=h.i18n.translate("xpack.infra.logs.analysis.anomaliesTableMoreThanExpectedAnomalyMessage",{defaultMessage:"more log messages in this {type, select, logRate {dataset} logCategory {category}} than expected",values:{type:t}}),o=h.i18n.translate("xpack.infra.logs.analysis.anomaliesTableFewerThanExpectedAnomalyMessage",{defaultMessage:"fewer log messages in this {type, select, logRate {dataset} logCategory {category}} than expected",values:{type:t}}),s=n>a,l=s?r:o,u=s?n/a:a/n,c=s?"sortUp":"sortDown",m=u!==1/0?`${Object(O.h)(u)}x`:"";return i.a.createElement(d.EuiFlexGroup,{gutterSize:"s",responsive:!1,alignItems:"center"},i.a.createElement(d.EuiFlexItem,{grow:!1,component:"span"},i.a.createElement(d.EuiIcon,{type:c})),i.a.createElement(d.EuiFlexItem,{component:"span"},`${m} ${l}`,e.categoryRegex&&i.a.createElement(i.a.Fragment,null,": ",i.a.createElement(On,{regularExpression:e.categoryRegex}))))},ir=h.i18n.translate("xpack.infra.logs.analysis.anomaliesTablePreviousPageLabel",{defaultMessage:"Previous page"}),rr=h.i18n.translate("xpack.infra.logs.analysis.anomaliesTableNextPageLabel",{defaultMessage:"Next page"}),or=({fetchPreviousPage:e,fetchNextPage:t,page:n,isLoading:a})=>i.a.createElement(d.EuiFlexGroup,{justifyContent:"center"},i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(d.EuiFlexGroup,null,i.a.createElement(d.EuiButtonIcon,{iconType:"arrowLeft",isDisabled:!e||a,onClick:e,"aria-label":ir}),i.a.createElement("span",null,i.a.createElement("strong",null,n)),i.a.createElement(d.EuiButtonIcon,{iconType:"arrowRight",isDisabled:!t||a,onClick:t,"aria-label":rr})))),sr=({isLoadingAnomaliesResults:e,timeRange:t,anomalies:n,changeSortOptions:a,sortOptions:r,changePaginationOptions:o,paginationOptions:s,fetchNextPage:l,fetchPreviousPage:u,page:c,selectedDatasets:m,jobIds:g,autoRefresh:p})=>i.a.createElement(i.a.Fragment,null,i.a.createElement(d.EuiFlexGroup,null,i.a.createElement(d.EuiFlexItem,null,i.a.createElement(ji,{jobIds:g,timeRange:t,selectedDatasets:m,autoRefresh:p}))),i.a.createElement(d.EuiSpacer,{size:"l"}),i.a.createElement(i.a.Fragment,null,n&&0!==n.length?i.a.createElement(nr,{results:n,timeRange:t,changeSortOptions:a,changePaginationOptions:o,sortOptions:r,paginationOptions:s,fetchNextPage:l,fetchPreviousPage:u,page:c,isLoading:e}):i.a.createElement(Kt.a,{isLoading:e,loadingChildren:i.a.createElement(ur,null)},i.a.createElement(d.EuiEmptyPrompt,{title:i.a.createElement("h2",null,h.i18n.translate("xpack.infra.logs.analysis.anomalySectionNoDataTitle",{defaultMessage:"There is no data to display."})),titleSize:"m",body:i.a.createElement("p",null,h.i18n.translate("xpack.infra.logs.analysis.anomalySectionNoDataBody",{defaultMessage:"You may want to adjust your time range."}))})))),lr=h.i18n.translate("xpack.infra.logs.analysis.anomaliesSectionLoadingAriaLabel",{defaultMessage:"Loading anomalies"}),ur=()=>i.a.createElement(d.EuiLoadingSpinner,{size:"xl","aria-label":lr}),cr={selectedDatasets:[],selectedDatasetsFilters:[]};function dr(e,t){switch(t.type){case"changeSelectedDatasets":return{...e,selectedDatasets:t.payload.datasets};case"updateDatasetsFilters":const n=t.payload.filters.filter((t=>!e.selectedDatasets.includes(t.meta.params.query))).map((e=>e.meta.params.query));return{...e,selectedDatasets:[...e.selectedDatasets,...n],selectedDatasetsFilters:t.payload.filters};default:throw new Error("Unknown action")}}const mr=(e,t)=>{const n={page:1,paginationCursor:void 0};switch(t.type){case"changePaginationOptions":case"changeSortOptions":case"changeTimeRange":case"changeFilteredDatasets":return{...e,...n,...t.payload};case"changeHasNextPage":case"changeLastReceivedCursors":return{...e,...t.payload};case"fetchNextPage":return e.lastReceivedCursors?{...e,page:e.page+1,paginationCursor:{searchAfter:e.lastReceivedCursors.nextPageCursor}}:e;case"fetchPreviousPage":return e.lastReceivedCursors?{...e,page:e.page-1,paginationCursor:{searchBefore:e.lastReceivedCursors.previousPageCursor}}:e;default:return e}},gr={page:1,lastReceivedCursors:void 0,paginationCursor:void 0,hasNextPage:!1},hr=({endTime:e,startTime:t,sourceId:n,defaultSortOptions:i,defaultPaginationOptions:r,onGetLogEntryAnomaliesDatasetsError:o,filteredDatasets:s})=>{const{services:l}=Object(_e.b)(),[u,c]=Object(a.useReducer)(mr,gr,(n=>({...n,paginationOptions:r,sortOptions:i,filteredDatasets:s,timeRange:{start:t,end:e}}))),[d,m]=Object(a.useState)([]),[g,h]=Object(Me.c)({cancelPreviousOn:"creation",createPromise:async()=>{const{timeRange:{start:e,end:t},sortOptions:a,paginationOptions:i,paginationCursor:r,filteredDatasets:o}=u;return await(async(e,t)=>{const{sourceId:n,startTime:a,endTime:i,sort:r,pagination:o,datasets:s}=e,l=await t(un.c,{method:"POST",body:JSON.stringify(un.n.encode({data:{sourceId:n,timeRange:{startTime:a,endTime:i},sort:r,pagination:o,datasets:s}}))});return Object(I.b)(un.o)(l)})({sourceId:n,startTime:e,endTime:t,sort:a,pagination:{...i,cursor:r},datasets:o},l.http.fetch)},onResolve:({data:{anomalies:e,paginationCursors:t,hasMoreEntries:n}})=>{const{paginationCursor:a}=u;t&&c({type:"changeLastReceivedCursors",payload:{lastReceivedCursors:t}}),!a||a&&"searchAfter"in a?c({type:"changeHasNextPage",payload:{hasNextPage:n}}):a&&"searchBefore"in a&&c({type:"changeHasNextPage",payload:{hasNextPage:!0}}),m(e)}},[n,c,u.timeRange,u.sortOptions,u.paginationOptions,u.paginationCursor,u.filteredDatasets]),p=Object(a.useCallback)((e=>{c({type:"changeSortOptions",payload:{sortOptions:e}})}),[c]),y=Object(a.useCallback)((e=>{c({type:"changePaginationOptions",payload:{paginationOptions:e}})}),[c]);Object(a.useEffect)((()=>{c({type:"changeTimeRange",payload:{timeRange:{start:t,end:e}}})}),[t,e]),Object(a.useEffect)((()=>{c({type:"changeFilteredDatasets",payload:{filteredDatasets:s}})}),[s]),Object(a.useEffect)((()=>{h()}),[h]);const b=Object(a.useCallback)((()=>{u.lastReceivedCursors&&c({type:"fetchNextPage"})}),[c,u]),E=Object(a.useCallback)((()=>{u.lastReceivedCursors&&c({type:"fetchPreviousPage"})}),[c,u]),v=Object(a.useMemo)((()=>"pending"===g.state),[g.state]),x=Object(a.useMemo)((()=>"rejected"===g.state),[g.state]),[_,M]=Object(a.useState)([]),[S,T]=Object(Me.c)({cancelPreviousOn:"creation",createPromise:async()=>await(async(e,t)=>{const{sourceId:n,startTime:a,endTime:i}=e,r=await t(un.b,{method:"POST",body:JSON.stringify(un.l.encode({data:{sourceId:n,timeRange:{startTime:a,endTime:i}}}))});return Object(I.b)(un.m)(r)})({sourceId:n,startTime:t,endTime:e},l.http.fetch),onResolve:({data:{datasets:e}})=>{M(e)},onReject:e=>{e instanceof Error&&!(e instanceof Me.a)&&o&&o(e)}},[e,n,t]),C=Object(a.useMemo)((()=>"pending"===S.state),[S.state]),O=Object(a.useMemo)((()=>"rejected"===S.state),[S.state]);return f()((()=>{T()})),{logEntryAnomalies:d,getLogEntryAnomalies:h,isLoadingLogEntryAnomalies:v,isLoadingDatasets:C,hasFailedLoadingDatasets:O,datasets:_,hasFailedLoadingLogEntryAnomalies:x,changeSortOptions:p,sortOptions:u.sortOptions,changePaginationOptions:y,paginationOptions:u.paginationOptions,fetchPreviousPage:u.page>1?E:void 0,fetchNextPage:u.hasNextPage?b:void 0,page:u.page}},pr=F.type({interval:F.number,isPaused:F.boolean}),fr=F.union([pr,F[void 0]]),yr=Object(I.b)(fr),br={isPaused:!1,interval:3e4},Er=F.type({startTime:F.string,endTime:F.string}),vr=F.union([Er,F[void 0]]),xr=Object(I.b)(vr),_r={from:"now-2w",to:"now"},Mr=e=>({startTime:kt()(jt.a.parse(e.start,{momentInstance:kt.a})).valueOf(),endTime:kt()(jt.a.parse(e.end,{momentInstance:kt.a,roundUp:!0})).valueOf()}),Sr=e=>i.a.createElement(d.EuiButton,e,i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logs.analysis.manageMlJobsButtonLabel",defaultMessage:"Manage ML jobs"})),Tr={direction:"desc",field:"anomalyScore"},Cr={pageSize:25},Or=({pageTitle:e})=>{var t;Object(Fe.useTrackPageview)({app:"infra_logs",path:"log_entry_rate_results"}),Object(Fe.useTrackPageview)({app:"infra_logs",path:"log_entry_rate_results",delay:15e3});const n=null===(t=Object(b.useKibana)().services.application)||void 0===t?void 0:t.navigateToApp,{sourceId:r,sourceStatus:o}=Object(x.c)(),{hasLogAnalysisSetupCapabilities:s}=gt(),{hasOutdatedJobConfigurations:l,hasOutdatedJobDefinitions:u,hasStoppedJobs:c,moduleDescriptor:m,setupStatus:g,jobStatus:h,jobIds:p}=ot(),{categoryQualityWarnings:f,hasOutdatedJobConfigurations:y,hasOutdatedJobDefinitions:E,hasStoppedJobs:v,moduleDescriptor:_,setupStatus:M,jobStatus:S,jobIds:T}=qe(),C=Object(a.useMemo)((()=>[...Object(O.p)(h["log-entry-rate"])?[p["log-entry-rate"]]:[],...Object(O.p)(S["log-entry-categories-count"])?[T["log-entry-categories-count"]]:[]]),[p,T,h,S]),{timeRange:j,friendlyTimeRange:w,setTimeRange:k,autoRefresh:F,setAutoRefresh:I}=(()=>{const[e]=Object(ua.a)(_r),{from:t,to:n}=e(),i=Object(a.useMemo)((()=>({startTime:t,endTime:n})),[t,n]),[r,o]=Object(la.b)({defaultState:i,decodeUrlState:xr,encodeUrlState:vr.encode,urlStateKey:"timeRange",writeDefaultState:!0}),[s,l]=Object(a.useState)((()=>({value:Mr({start:r.startTime,end:r.endTime}),lastChangedTime:Date.now()}))),u=Object(a.useCallback)((({start:e,end:t})=>{l({value:Mr({start:e,end:t}),lastChangedTime:Date.now()})}),[l]),c=Object(a.useCallback)((e=>{o({startTime:e.start,endTime:e.end}),u(e)}),[o,u]),d=Object(a.useCallback)((e=>{const{from:t,to:n}=e;c({start:t,end:n})}),[c]);Object(ua.b)(_r,{from:r.startTime,to:r.endTime},d);const[m,g]=Object(la.b)({defaultState:br,decodeUrlState:yr,encodeUrlState:fr.encode,urlStateKey:"autoRefresh",writeDefaultState:!0});return It()((()=>{u({start:r.startTime,end:r.endTime})}),m.isPaused?null:m.interval),{timeRange:s,friendlyTimeRange:r,setTimeRange:c,autoRefresh:m,setAutoRefresh:g}})(),{closeFlyout:L,isFlyoutOpen:P,logEntryId:D}=bi(),R=Object(a.useCallback)(((e,t,a)=>{const i={logPosition:Object(fn.encode)({end:kt()(j.value.endTime).format("YYYY-MM-DDTHH:mm:ss.SSSZ"),position:a,start:kt()(j.value.startTime).format("YYYY-MM-DDTHH:mm:ss.SSSZ"),streamLive:!1}),flyoutOptions:Object(fn.encode)({surroundingLogsId:t}),logFilter:Object(fn.encode)(e)};null==n||n("logs",{path:`/stream?${Object(Da.stringify)(i)}`})}),[j,n]),{selectedDatasets:N,setSelectedDatasets:A}=(()=>{const{services:e}=Object(_e.b)(),[t,n]=Object(a.useReducer)(dr,cr),i=Object(a.useCallback)((e=>{n({type:"changeSelectedDatasets",payload:{datasets:e}})}),[n]);return Object(a.useEffect)((()=>{const t=e.data.query.filterManager.getUpdates$().subscribe((()=>{const t=e.data.query.filterManager.getFilters().filter((e=>e.meta.controlledBy&&e.meta.controlledBy===Ln.CONTROLLED_BY_SWIM_LANE_FILTER));n({type:"updateDatasetsFilters",payload:{filters:t}})}));return()=>t.unsubscribe()}),[e.data.query.filterManager,n]),Object(a.useEffect)((()=>{const n=t.selectedDatasetsFilters.filter((e=>!t.selectedDatasets.includes(e.meta.params.query)));n.length>0&&n.forEach((t=>{e.data.query.filterManager.removeFilter(t)}))}),[t.selectedDatasets,t.selectedDatasetsFilters,e.data.query.filterManager]),{selectedDatasets:t.selectedDatasets,setSelectedDatasets:i,selectedDatasetsFilters:t.selectedDatasetsFilters}})(),{isLoadingLogEntryAnomalies:H,logEntryAnomalies:U,page:z,fetchNextPage:J,fetchPreviousPage:B,changeSortOptions:Y,changePaginationOptions:V,sortOptions:q,paginationOptions:W,datasets:$,isLoadingDatasets:G}=hr({sourceId:r,startTime:j.value.startTime,endTime:j.value.endTime,defaultSortOptions:Tr,defaultPaginationOptions:Cr,filteredDatasets:N}),Q=Object(a.useCallback)((({isPaused:e,refreshInterval:t})=>{I({isPaused:e,interval:t})}),[I]),{showModuleList:Z,showModuleSetup:K}=xt(),X=Object(a.useCallback)((()=>K("logs_ui_analysis")),[K]),ee=Object(a.useCallback)((()=>K("logs_ui_categories")),[K]),te=U.length>0,ne=Object(a.useMemo)((()=>("skipped"===M.type&&!!M.newlyCreated||"succeeded"===M.type||"skipped"===g.type&&!!g.newlyCreated||"succeeded"===g.type)&&!te),[te,M,g]),ae=Object(a.useCallback)((e=>{e.isInvalid||k(e)}),[k]);return i.a.createElement(ha,{hasData:"missing"!==(null==o?void 0:o.logIndexStatus),pageHeader:{pageTitle:e,rightSideItems:[i.a.createElement(Sr,{onClick:Z,size:"s"})]}},i.a.createElement(d.EuiFlexGroup,{direction:"column"},i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(d.EuiFlexGroup,{justifyContent:"spaceBetween"},i.a.createElement(d.EuiFlexItem,null,i.a.createElement(pa,{availableDatasets:$,isLoading:G,selectedDatasets:N,onChangeDatasetSelection:A})),i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(d.EuiSuperDatePicker,{start:w.startTime,end:w.endTime,onTimeChange:ae,isPaused:F.isPaused,refreshInterval:F.interval,onRefreshChange:Q})))),i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(Jt,{hasOutdatedJobConfigurations:l,hasOutdatedJobDefinitions:u,hasSetupCapabilities:s,hasStoppedJobs:c,isFirstUse:!1,moduleName:m.moduleName,onRecreateMlJobForReconfiguration:X,onRecreateMlJobForUpdate:X}),i.a.createElement(Ln.MLJobsAwaitingNodeWarning,{jobIds:C}),i.a.createElement(Yt,{hasOutdatedJobConfigurations:y,hasOutdatedJobDefinitions:E,hasSetupCapabilities:s,hasStoppedJobs:v,isFirstUse:ne,moduleName:_.moduleName,onRecreateMlJobForReconfiguration:ee,onRecreateMlJobForUpdate:ee,qualityWarnings:f})),i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(sr,{isLoadingAnomaliesResults:H,anomalies:U,timeRange:j.value,page:z,fetchNextPage:J,fetchPreviousPage:B,changeSortOptions:Y,changePaginationOptions:V,sortOptions:q,paginationOptions:W,selectedDatasets:N,jobIds:C,autoRefresh:F}))),P?i.a.createElement(di,{logEntryId:D,onCloseFlyout:L,onSetFieldFilter:R,sourceId:r}):null)},jr=({onOpenSetup:e})=>(Object(Fe.useTrackPageview)({app:"infra_logs",path:"log_entry_rate_setup"}),Object(Fe.useTrackPageview)({app:"infra_logs",path:"log_entry_rate_setup",delay:15e3}),i.a.createElement(d.EuiEmptyPrompt,{"data-test-subj":"logEntryRateSetupPage",title:i.a.createElement("h2",null,i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logs.logEntryRate.setupTitle",defaultMessage:"Set up log anomaly analysis"})),body:i.a.createElement(d.EuiText,{size:"s"},i.a.createElement("p",null,i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logs.logEntryRate.setupDescription",defaultMessage:"To enable log anomalies, set up a machine learning job"}))),actions:i.a.createElement(d.EuiButton,{fill:!0,onClick:e},i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logs.logEntryRate.showAnalysisSetupButtonLabel",defaultMessage:"ML Setup"}))})),wr=h.i18n.translate("xpack.infra.logs.anomaliesPageTitle",{defaultMessage:"Anomalies"}),kr=Object(a.memo)((()=>{const{hasLogAnalysisCapabilites:e,hasLogAnalysisReadCapabilities:t,hasLogAnalysisSetupCapabilities:n}=gt(),{fetchJobStatus:r,fetchModuleDefinition:o,jobStatus:s,setupStatus:l}=qe(),{fetchJobStatus:u,fetchModuleDefinition:c,jobStatus:d,setupStatus:m}=ot(),{showModuleList:g}=xt(),p=Object(a.useCallback)((()=>Promise.all([r(),u()])),[r,u]);return Object(a.useEffect)((()=>{t&&p()}),[p,t]),Object(a.useEffect)((()=>{t&&o()}),[o,t]),Object(a.useEffect)((()=>{t&&c()}),[c,t]),It()((()=>{"pending"!==l.type&&t&&r(),"pending"!==m.type&&t&&u()}),3e4),e?t?"initializing"===l.type||"initializing"===m.type?i.a.createElement(j.a,{message:h.i18n.translate("xpack.infra.logs.analysisPage.loadingMessage",{defaultMessage:"Checking status of analysis jobs..."})}):"unknown"===l.type||"unknown"===m.type?i.a.createElement(Fr,{isEmptyState:!0},i.a.createElement(w.a,{retry:p})):Object(O.p)(s["log-entry-categories-count"])||Object(O.p)(d["log-entry-rate"])?i.a.createElement(i.a.Fragment,null,i.a.createElement(Or,{pageTitle:wr}),i.a.createElement(Mt,null)):n?i.a.createElement(i.a.Fragment,null,i.a.createElement(Fr,{isEmptyState:!0},i.a.createElement(jr,{onOpenSetup:g})),i.a.createElement(Mt,null)):i.a.createElement(Fr,{isEmptyState:!0},i.a.createElement(w.c,null),";"):i.a.createElement(Fr,{isEmptyState:!0},i.a.createElement(w.b,null)):i.a.createElement(Ct.a,{"data-test-subj":"logsLogEntryRatePage",pageHeader:{pageTitle:wr}})})),Fr=({children:e,...t})=>{const{sourceStatus:n}=Object(x.c)();return i.a.createElement(ha,g()({hasData:"missing"!==(null==n?void 0:n.logIndexStatus),"data-test-subj":"logsLogEntryRatePage",pageHeader:t.isEmptyState?void 0:{pageTitle:wr}},t),e)},Ir=({children:e})=>{const{hasFailedLoading:t,isLoading:n,isUninitialized:a,latestLoadSourceFailures:r,loadSource:o,resolvedSourceConfiguration:s,sourceId:l}=Object(x.c)(),{space:u}=Object(Ia.a)();return null==u?null:n||a?i.a.createElement(Fa.a,null):t?i.a.createElement(ja,{errors:r,onRetry:o}):null!=s?i.a.createElement(fi.Provider,null,i.a.createElement(rt,{indexPattern:s.indices,sourceId:l,spaceId:u.id,timestampField:s.timestampField,runtimeMappings:s.runtimeMappings},i.a.createElement(Ve,{indexPattern:s.indices,sourceId:l,spaceId:u.id,timestampField:s.timestampField,runtimeMappings:s.runtimeMappings},i.a.createElement(vt,null,e)))):null},Lr=()=>(C([{text:T.a}]),i.a.createElement(d.EuiErrorBoundary,null,i.a.createElement(Ir,null,i.a.createElement(kr,null))));var Pr=n(27);const Dr=({errors:e})=>i.a.createElement(d.EuiCallOut,{color:"danger",iconType:"alert",title:Nr},i.a.createElement("ul",null,e.map(((e,t)=>i.a.createElement("li",{key:t},i.a.createElement(Rr,{error:e})))))),Rr=({error:e})=>"generic"===e.type?i.a.createElement(i.a.Fragment,null,e.message):"empty_field"===e.type?i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logSourceConfiguration.emptyFieldErrorMessage",defaultMessage:"The field '{fieldName}' must not be empty.",values:{fieldName:e.fieldName}}):"empty_column_list"===e.type?i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logSourceConfiguration.emptyColumnListErrorMessage",defaultMessage:"The column list must not be empty."}):"child"===e.type?i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logSourceConfiguration.childFormElementErrorMessage",defaultMessage:"At least one form field is in an invalid state."}):"missing_timestamp_field"===e.type?i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logSourceConfiguration.missingTimestampFieldErrorMessage",defaultMessage:"The index pattern must be time-based."}):"missing_message_field"===e.type?i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logSourceConfiguration.missingMessageFieldErrorMessage",defaultMessage:"The index pattern must contain a {messageField} field.",values:{messageField:i.a.createElement(d.EuiCode,null,"message")}}):"invalid_message_field_type"===e.type?i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logSourceConfiguration.invalidMessageFieldTypeErrorMessage",defaultMessage:"The {messageField} field must be a text field.",values:{messageField:i.a.createElement(d.EuiCode,null,"message")}}):"rollup_index_pattern"===e.type?i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logSourceConfiguration.rollupIndexPatternErrorMessage",defaultMessage:"The index pattern must not be a rollup index pattern."}):"missing_index_pattern"===e.type?i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logSourceConfiguration.missingIndexPatternErrorMessage",defaultMessage:"The index pattern {indexPatternId} must exist.",values:{indexPatternId:i.a.createElement(d.EuiCode,null,e.indexPatternId)}}):null,Nr=h.i18n.translate("xpack.infra.logSourceConfiguration.logSourceConfigurationFormErrorsCalloutTitle",{defaultMessage:"Inconsistent source configuration"}),Ar=e=>({error:"invalid"===e.validity.validity?e.validity.reasons.map((e=>i.a.createElement(Rr,{error:e}))):[],isInvalid:"invalid"===e.validity.validity}),Hr=(e,t)=>n=>({isInvalid:"invalid"===n.validity.validity,onChange:t=>{const a=t.currentTarget.value;n.updateValue((()=>e(a)))},value:t(n.value)}),Ur=Hr((e=>`${e}`),(e=>e)),zr=({isLoading:e,isReadOnly:t,tiebreakerFieldFormElement:n,timestampFieldFormElement:r})=>{const o="@timestamp"===r.value,s="_doc"===n.value;return i.a.createElement(i.a.Fragment,null,i.a.createElement(d.EuiTitle,{size:"s"},i.a.createElement("h3",null,i.a.createElement(k.FormattedMessage,{id:"xpack.infra.sourceConfiguration.fieldsSectionTitle",defaultMessage:"Fields"}))),i.a.createElement(d.EuiSpacer,{size:"m"}),i.a.createElement(d.EuiCallOut,{title:h.i18n.translate("xpack.infra.sourceConfiguration.deprecationNotice",{defaultMessage:"Deprecation Notice"}),color:"warning",iconType:"help"},i.a.createElement("p",null,i.a.createElement(k.FormattedMessage,{id:"xpack.infra.sourceConfiguration.deprecationMessage",defaultMessage:"Configuring these fields have been deprecated and will be removed in 8.0.0. This application is designed to work with {ecsLink}, you should adjust your indexing to use the {documentationLink}.",values:{documentationLink:i.a.createElement(d.EuiLink,{href:"https://www.elastic.co/guide/en/infrastructure/guide/7.4/infrastructure-metrics.html",target:"BLANK"},i.a.createElement(k.FormattedMessage,{id:"xpack.infra.sourceConfiguration.documentedFields",defaultMessage:"documented fields"})),ecsLink:i.a.createElement(d.EuiLink,{href:"https://www.elastic.co/guide/en/ecs/current/index.html",target:"BLANK"},"ECS")}}))),i.a.createElement(d.EuiSpacer,{size:"m"}),i.a.createElement(d.EuiDescribedFormGroup,{title:i.a.createElement("h4",null,i.a.createElement(k.FormattedMessage,{id:"xpack.infra.sourceConfiguration.timestampFieldLabel",defaultMessage:"Timestamp"})),description:i.a.createElement(k.FormattedMessage,{id:"xpack.infra.sourceConfiguration.timestampFieldDescription",defaultMessage:"Timestamp used to sort log entries"})},i.a.createElement(d.EuiFormRow,g()({fullWidth:!0,helpText:i.a.createElement(k.FormattedMessage,{id:"xpack.infra.sourceConfiguration.timestampFieldRecommendedValue",defaultMessage:"The recommended value is {defaultValue}",values:{defaultValue:i.a.createElement(d.EuiCode,null,"@timestamp")}}),label:i.a.createElement(k.FormattedMessage,{id:"xpack.infra.sourceConfiguration.timestampFieldLabel",defaultMessage:"Timestamp"})},Object(a.useMemo)((()=>Ar(r)),[r])),i.a.createElement(d.EuiFieldText,g()({fullWidth:!0,disabled:e||o,readOnly:t,isLoading:e},Object(a.useMemo)((()=>Ur(r)),[r]))))),i.a.createElement(d.EuiDescribedFormGroup,{title:i.a.createElement("h4",null,i.a.createElement(k.FormattedMessage,{id:"xpack.infra.sourceConfiguration.tiebreakerFieldLabel",defaultMessage:"Tiebreaker"})),description:i.a.createElement(k.FormattedMessage,{id:"xpack.infra.sourceConfiguration.tiebreakerFieldDescription",defaultMessage:"Field used to break ties between two entries with the same timestamp"})},i.a.createElement(d.EuiFormRow,g()({fullWidth:!0,helpText:i.a.createElement(k.FormattedMessage,{id:"xpack.infra.sourceConfiguration.tiebreakerFieldRecommendedValue",defaultMessage:"The recommended value is {defaultValue}",values:{defaultValue:i.a.createElement(d.EuiCode,null,"_doc")}}),label:i.a.createElement(k.FormattedMessage,{id:"xpack.infra.sourceConfiguration.tiebreakerFieldLabel",defaultMessage:"Tiebreaker"})},Object(a.useMemo)((()=>Ar(n)),[n])),i.a.createElement(d.EuiFieldText,g()({fullWidth:!0,disabled:e||s,readOnly:t,isLoading:e},Object(a.useMemo)((()=>Ur(n)),[n]))))))};var Jr=n(209),Br=n.n(Jr);const Yr=Symbol("unset form value"),Vr=({initialValue:e,validate:t})=>{const[n,i]=Object(a.useState)(Yr),r=n!==Yr?n:e,o=Object(a.useCallback)((t=>i((n=>t(n===Yr?e:n)))),[e]),s=Object(a.useCallback)((()=>i(Yr)),[]),l=Object(a.useMemo)((()=>!Pe()(r,e)),[r,e]),u=Wr(r,t);return Object(a.useMemo)((()=>({initialValue:e,isDirty:l,resetValue:s,updateValue:o,validity:u,value:r})),[e,l,s,o,u,r])},qr=({childFormElements:e,validate:t})=>{const n=Object(a.useMemo)((()=>Object.entries(e)),Object.entries(e).flat()),i=Object(a.useMemo)((()=>n.reduce(((e,[t,n])=>({...e,[t]:n.value})),{})),[n]),r=Object(a.useCallback)((e=>{const t=e(i);n.forEach((([e,n])=>n.updateValue((()=>t[e]))))}),[n,i]),o=Object(a.useMemo)((()=>n.some((([,e])=>e.isDirty))),[n]),s=Wr(i,t),l=Object(a.useMemo)((()=>n.some((([,e])=>"invalid"===e.validity.validity))?{validity:"invalid",reasons:[{type:"child"}]}:n.some((([,e])=>"pending"===e.validity.validity))?{validity:"pending"}:{validity:"valid"}),[n]),u=Object(a.useMemo)((()=>$r(s,l)),[s,l]),c=Object(a.useCallback)((()=>{n.forEach((([,e])=>e.resetValue()))}),[n]),d=Object(a.useMemo)((()=>n.reduce(((e,[t,n])=>({...e,[t]:n.initialValue})),{})),[n]);return Object(a.useMemo)((()=>({childFormElements:e,initialValue:d,isDirty:o,resetValue:c,updateValue:r,validity:u,value:i})),[e,d,o,c,r,u,i])},Wr=(e,t)=>{const n=Br()((()=>{var n;return null!==(n=null==t?void 0:t(e))&&void 0!==n?n:Promise.resolve([])}),[t,e]);return Object(a.useMemo)((()=>n.loading?{validity:"pending"}:null!=n.error?{validity:"invalid",reasons:[{type:"generic",message:`${n.error}`}]}:n.value&&n.value.length>0?{validity:"invalid",reasons:n.value}:{validity:"valid"}),[n.error,n.loading,n.value])},$r=(e,t)=>"invalid"===e.validity||"invalid"===t.validity?{validity:"invalid",reasons:[..."invalid"===e.validity?e.reasons:[],..."invalid"===t.validity?t.reasons:[]]}:"pending"===e.validity||"pending"===t.validity?{validity:"pending"}:{validity:"valid"},Gr=e=>t=>e(t.value),Qr=({isLoading:e,isReadOnly:t,indexNamesFormElement:n,onSwitchToIndexPatternReference:a})=>(Object(Fe.useTrackPageview)({app:"infra_logs",path:"log_source_configuration_index_name"}),Object(Fe.useTrackPageview)({app:"infra_logs",path:"log_source_configuration_index_name",delay:15e3}),i.a.createElement(i.a.Fragment,null,i.a.createElement(d.EuiTitle,{size:"s"},i.a.createElement("h3",null,i.a.createElement(k.FormattedMessage,{id:"xpack.infra.sourceConfiguration.indicesSectionTitle",defaultMessage:"Indices"}))),i.a.createElement(d.EuiSpacer,{size:"m"}),i.a.createElement(d.EuiCallOut,{title:Kr,iconType:"wrench"},i.a.createElement(k.FormattedMessage,{tagName:"p",id:"xpack.infra.logSourceConfiguration.indexPatternInformationCalloutDescription",defaultMessage:"The Logs UI can now integrate with Kibana index patterns to configure the used indices."}),i.a.createElement(d.EuiButton,{onClick:a},i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logSourceConfiguration.switchToIndexPatternReferenceButtonLabel",defaultMessage:"Use Kibana index patterns"}))),i.a.createElement(d.EuiSpacer,{size:"m"}),i.a.createElement(d.EuiDescribedFormGroup,{title:i.a.createElement("h4",null,i.a.createElement(k.FormattedMessage,{id:"xpack.infra.sourceConfiguration.logIndicesTitle",defaultMessage:"Log indices"})),description:i.a.createElement(k.FormattedMessage,{id:"xpack.infra.sourceConfiguration.logIndicesDescription",defaultMessage:"Index pattern for matching indices that contain log data"})},i.a.createElement(d.EuiFormRow,g()({fullWidth:!0,helpText:i.a.createElement(k.FormattedMessage,{id:"xpack.infra.sourceConfiguration.logIndicesRecommendedValue",defaultMessage:"The recommended value is {defaultValue}",values:{defaultValue:i.a.createElement(d.EuiCode,null,"logs-*,filebeat-*")}}),label:i.a.createElement(k.FormattedMessage,{id:"xpack.infra.sourceConfiguration.logIndicesLabel",defaultMessage:"Log indices"})},Ar(n)),i.a.createElement(d.EuiFieldText,g()({"data-test-subj":"logIndicesInput",fullWidth:!0,disabled:e,isLoading:e,readOnly:t},Zr(n))))))),Zr=Hr((e=>({type:"index_name",indexName:e})),(({indexName:e})=>e)),Kr=h.i18n.translate("xpack.infra.logSourceConfiguration.indexPatternInformationCalloutTitle",{defaultMessage:"New configuration option"}),Xr=()=>{const{services:{data:{indexPatterns:e}}}=Object(_e.b)();return e},eo=({indexPatternId:e,isLoading:t,isReadOnly:n,onChangeIndexPatternId:r})=>{const{indexPatternTitles:o,latestIndexPatternTitlesRequest:s,fetchIndexPatternTitles:l}=(()=>{const e=Xr(),[t,n]=Object(a.useState)([]),[i,r]=Object(Me.c)({createPromise:()=>e.getIdsWithTitle(!0),onResolve:n},[e]);return{fetchIndexPatternTitles:r,indexPatternTitles:t,latestIndexPatternTitlesRequest:i}})();Object(a.useEffect)((()=>{l()}),[l]);const u=Object(a.useMemo)((()=>[...o.map((({id:e,title:t})=>({key:e,label:t,value:e}))),...null==e||o.some((({id:t})=>t===e))?[]:[{key:e,label:h.i18n.translate("xpack.infra.logSourceConfiguration.missingIndexPatternLabel",{defaultMessage:"Missing index pattern {indexPatternId}",values:{indexPatternId:e}}),value:e}]]),[o,e]),c=Object(a.useMemo)((()=>u.filter((({key:t})=>t===e))),[u,e]),m=Object(a.useCallback)((([e])=>"string"==typeof(null==e?void 0:e.key)?r(e.key):r(void 0)),[r]);return i.a.createElement(d.EuiComboBox,{isLoading:t||"pending"===s.state,isDisabled:n,options:u,placeholder:to,selectedOptions:c,singleSelection:!0,onChange:m})},to=h.i18n.translate("xpack.infra.logSourceConfiguration.indexPatternSelectorPlaceholder",{defaultMessage:"Choose an index pattern"}),no=({isLoading:e,isReadOnly:t,indexPatternFormElement:n})=>{var r;Object(Fe.useTrackPageview)({app:"infra_logs",path:"log_source_configuration_index_pattern"}),Object(Fe.useTrackPageview)({app:"infra_logs",path:"log_source_configuration_index_pattern",delay:15e3});const o=Object(a.useCallback)((e=>{null!=e?n.updateValue((()=>({type:"index_pattern",indexPatternId:e}))):n.updateValue((()=>{}))}),[n]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(d.EuiTitle,{size:"s"},i.a.createElement("h3",null,i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logSourceConfiguration.indexPatternSectionTitle",defaultMessage:"Index pattern"}))),i.a.createElement(d.EuiSpacer,{size:"m"}),i.a.createElement(ao,null),i.a.createElement(d.EuiSpacer,{size:"m"}),i.a.createElement(d.EuiDescribedFormGroup,{title:i.a.createElement("h4",null,i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logSourceConfiguration.logIndexPatternTitle",defaultMessage:"Log index pattern"})),description:i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logSourceConfiguration.logIndexPatternDescription",defaultMessage:"Index pattern that contains log data"})},i.a.createElement(d.EuiFormRow,g()({fullWidth:!0,label:i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logSourceConfiguration.logIndexPatternLabel",defaultMessage:"Log index pattern"})},Object(a.useMemo)((()=>e?{}:Ar(n)),[e,n])),i.a.createElement(eo,{isLoading:e||"pending"===n.validity.validity,isReadOnly:t,indexPatternId:null===(r=n.value)||void 0===r?void 0:r.indexPatternId,onChangeIndexPatternId:o}))))},ao=i.a.memo((()=>{const e=Object(Ht.b)({app:"management",pathname:"/kibana/indexPatterns"});return i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logSourceConfiguration.logIndexPatternHelpText",defaultMessage:"Kibana index patterns are shared among apps in the Kibana space and can be managed via the {indexPatternsManagementLink}.",values:{indexPatternsManagementLink:i.a.createElement(d.EuiLink,e,i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logSourceConfiguration.indexPatternManagementLinkText",defaultMessage:"index patterns management screen"}))}})})),io=i.a.memo((({isLoading:e,isReadOnly:t,indicesFormElement:n,tiebreakerFieldFormElement:r,timestampFieldFormElement:o})=>{const s=Object(Fe.useUiTracker)({app:"infra_logs"}),l=Object(a.useCallback)((()=>{n.updateValue((()=>{})),s({metric:"configuration_switch_to_index_pattern_reference"})}),[n,s]);return ro(n)?i.a.createElement(no,{isLoading:e,isReadOnly:t,indexPatternFormElement:n}):oo(n)?i.a.createElement(i.a.Fragment,null,i.a.createElement(Qr,{isLoading:e,isReadOnly:t,indexNamesFormElement:n,onSwitchToIndexPatternReference:l}),i.a.createElement(zr,{isLoading:e,isReadOnly:t,tiebreakerFieldFormElement:r,timestampFieldFormElement:o})):null})),ro=Gr((e=>null==e||Oa.f.is(e))),oo=Gr(Oa.e.is);var so=n(43);const lo=({addLogColumn:e,availableFields:t,isDisabled:n})=>{const{isVisible:r,show:o,hide:s}=Object(Za.a)(!1),l=Object(a.useMemo)((()=>[{optionProps:{append:i.a.createElement(mo,null),"data-test-subj":"addTimestampLogColumn",key:"timestamp",label:"Timestamp"},columnConfiguration:{timestampColumn:{id:Object(so.v4)()}}},{optionProps:{"data-test-subj":"addMessageLogColumn",append:i.a.createElement(mo,null),key:"message",label:"Message"},columnConfiguration:{messageColumn:{id:Object(so.v4)()}}},...t.map((e=>({optionProps:{"data-test-subj":`addFieldLogColumn addFieldLogColumn:${e}`,key:`field-${e}`,label:e},columnConfiguration:{fieldColumn:{id:Object(so.v4)(),field:e}}})))]),[t]),u=Object(a.useMemo)((()=>l.map((e=>e.optionProps))),[l]),c=Object(a.useCallback)((t=>{s();const n=t.findIndex((e=>"on"===e.checked)),a=l[n];e(a.columnConfiguration)}),[e,l,s]);return i.a.createElement(d.EuiPopover,{anchorPosition:"downRight",button:i.a.createElement(d.EuiButton,{"data-test-subj":"addLogColumnButton",isDisabled:n,iconType:"plusInCircle",onClick:o},i.a.createElement(k.FormattedMessage,{id:"xpack.infra.sourceConfiguration.addLogColumnButtonLabel",defaultMessage:"Add column"})),closePopover:s,id:"addLogColumn",isOpen:r,ownFocus:!0,panelPaddingSize:"none"},i.a.createElement(d.EuiSelectable,{height:600,listProps:co,onChange:c,options:u,searchable:!0,searchProps:uo,singleSelection:!0},((e,t)=>i.a.createElement(go,{"data-test-subj":"addLogColumnPopover"},i.a.createElement(d.EuiPopoverTitle,null,t),e))))},uo={"data-test-subj":"fieldSearchInput"},co={showIcons:!1},mo=()=>i.a.createElement(d.EuiBadge,null,i.a.createElement(k.FormattedMessage,{id:"xpack.infra.sourceConfiguration.systemColumnBadgeLabel",defaultMessage:"System"})),go=Lt.euiStyled.div`
  width: 400px;
`,ho=i.a.memo((({availableFields:e,isLoading:t,logColumnsFormElement:n})=>{const r=Object(a.useCallback)((e=>n.updateValue((t=>[...t,e]))),[n]),o=Object(a.useCallback)((e=>n.updateValue((t=>t.filter((t=>t!==e))))),[n]),s=Object(a.useCallback)(((e,t)=>{n.updateValue((a=>{if(t>=0&&e<=n.value.length-1){const a=[...n.value];return a.splice(t,0,a.splice(e,1)[0]),a}return a}))}),[n]),l=Object(a.useCallback)((({source:e,destination:t})=>t&&s(e.index,t.index)),[s]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(d.EuiFlexGroup,null,i.a.createElement(d.EuiFlexItem,null,i.a.createElement(d.EuiTitle,{size:"s","data-test-subj":"sourceConfigurationLogColumnsSectionTitle"},i.a.createElement("h3",null,i.a.createElement(k.FormattedMessage,{id:"xpack.infra.sourceConfiguration.logColumnsSectionTitle",defaultMessage:"Log columns"})))),i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(lo,{addLogColumn:r,availableFields:e,isDisabled:t}))),n.value.length>0?i.a.createElement(d.EuiDragDropContext,{onDragEnd:l},i.a.createElement(d.EuiDroppable,{droppableId:"COLUMN_CONFIG_DROPPABLE_AREA"},n.value.map(((e,t)=>{const n=(e=>Pi(e)?e.timestampColumn.id:Li(e)?e.messageColumn.id:e.fieldColumn.id)(e);return i.a.createElement(d.EuiDraggable,{key:`logColumnConfigurationPanel-${n}`,index:t,draggableId:n,customDragHandle:!0},(t=>i.a.createElement(po,{dragHandleProps:t.dragHandleProps,logColumnConfiguration:e,onRemove:o})))})))):i.a.createElement(xo,null),"invalid"===n.validity.validity?n.validity.reasons.map((e=>i.a.createElement(d.EuiText,{key:e.type,textAlign:"center",color:"danger"},i.a.createElement(Rr,{error:e})))):null)})),po=({logColumnConfiguration:e,dragHandleProps:t,onRemove:n})=>{const r=Object(a.useCallback)((()=>n(e)),[e,n]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(d.EuiSpacer,{size:"m"}),Pi(e)?i.a.createElement(fo,{dragHandleProps:t,logColumnConfiguration:e,onRemove:r}):Li(e)?i.a.createElement(yo,{dragHandleProps:t,logColumnConfiguration:e,onRemove:r}):i.a.createElement(bo,{dragHandleProps:t,logColumnConfiguration:e,onRemove:r}))},fo=({dragHandleProps:e,onRemove:t})=>i.a.createElement(Eo,{fieldName:"Timestamp",helpText:i.a.createElement(k.FormattedMessage,{tagName:"span",id:"xpack.infra.sourceConfiguration.timestampLogColumnDescription",defaultMessage:"This system field shows the log entry's time as determined by the {timestampSetting} field setting.",values:{timestampSetting:i.a.createElement("code",null,"timestamp")}}),onRemove:t,dragHandleProps:e}),yo=({dragHandleProps:e,onRemove:t})=>i.a.createElement(Eo,{fieldName:"Message",helpText:i.a.createElement(k.FormattedMessage,{tagName:"span",id:"xpack.infra.sourceConfiguration.messageLogColumnDescription",defaultMessage:"This system field shows the log entry message as derived from the document fields."}),onRemove:t,dragHandleProps:e}),bo=({dragHandleProps:e,logColumnConfiguration:{fieldColumn:{field:t}},onRemove:n})=>i.a.createElement(d.EuiPanel,{color:"subdued","data-test-subj":`logColumnPanel fieldLogColumnPanel fieldLogColumnPanel:${t}`,hasShadow:!1},i.a.createElement(d.EuiFlexGroup,{alignItems:"center"},i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement("div",g()({"data-test-subj":"moveLogColumnHandle"},e),i.a.createElement(d.EuiIcon,{type:"grab"}))),i.a.createElement(d.EuiFlexItem,{grow:1},_o),i.a.createElement(d.EuiFlexItem,{grow:3},i.a.createElement("code",null,t)),i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(vo,{onClick:n,columnDescription:`${_o} - ${t}`})))),Eo=({fieldName:e,helpText:t,onRemove:n,dragHandleProps:a})=>i.a.createElement(d.EuiPanel,{color:"subdued","data-test-subj":`logColumnPanel systemLogColumnPanel systemLogColumnPanel:${e}`,hasShadow:!1},i.a.createElement(d.EuiFlexGroup,{alignItems:"center"},i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement("div",g()({"data-test-subj":"moveLogColumnHandle"},a),i.a.createElement(d.EuiIcon,{type:"grab"}))),i.a.createElement(d.EuiFlexItem,{grow:1},e),i.a.createElement(d.EuiFlexItem,{grow:3},i.a.createElement(d.EuiText,{size:"s",color:"subdued"},t)),i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(vo,{onClick:n,columnDescription:String(e)})))),vo=({onClick:e,columnDescription:t})=>{const n=h.i18n.translate("xpack.infra.sourceConfiguration.removeLogColumnButtonLabel",{defaultMessage:"Remove {columnDescription} column",values:{columnDescription:t}});return i.a.createElement(d.EuiButtonIcon,{color:"danger","data-test-subj":"removeLogColumnButton",iconType:"trash",onClick:e,title:n,"aria-label":n})},xo=()=>i.a.createElement(d.EuiEmptyPrompt,{iconType:"list",title:i.a.createElement("h2",null,i.a.createElement(k.FormattedMessage,{id:"xpack.infra.sourceConfiguration.noLogColumnsTitle",defaultMessage:"No columns"})),body:i.a.createElement("p",null,i.a.createElement(k.FormattedMessage,{id:"xpack.infra.sourceConfiguration.noLogColumnsDescription",defaultMessage:"Add a column to this list using the button above."}))}),_o=h.i18n.translate("xpack.infra.sourceConfiguration.fieldLogColumnTitle",{defaultMessage:"Field"}),Mo=i.a.memo((({isLoading:e,isReadOnly:t,nameFormElement:n})=>i.a.createElement(d.EuiForm,null,i.a.createElement(d.EuiTitle,{size:"s","data-test-subj":"sourceConfigurationNameSectionTitle"},i.a.createElement("h3",null,i.a.createElement(k.FormattedMessage,{id:"xpack.infra.sourceConfiguration.nameSectionTitle",defaultMessage:"Name"}))),i.a.createElement(d.EuiSpacer,{size:"m"}),i.a.createElement(d.EuiDescribedFormGroup,{title:i.a.createElement("h4",null,i.a.createElement(k.FormattedMessage,{id:"xpack.infra.sourceConfiguration.nameLabel",defaultMessage:"Name"})),description:i.a.createElement(k.FormattedMessage,{id:"xpack.infra.sourceConfiguration.nameDescription",defaultMessage:"A descriptive name for the source configuration"})},i.a.createElement(d.EuiFormRow,g()({fullWidth:!0,label:i.a.createElement(k.FormattedMessage,{id:"xpack.infra.sourceConfiguration.nameLabel",defaultMessage:"Name"})},Object(a.useMemo)((()=>Ar(n)),[n])),i.a.createElement(d.EuiFieldText,g()({"data-test-subj":"nameInput",fullWidth:!0,disabled:e,readOnly:t,isLoading:e,name:"name"},Object(a.useMemo)((()=>Ur(n)),[n]))))))));var So=n(67);const To=(e,t)=>""===t?[{type:"empty_field",fieldName:e}]:[],Co=e=>[...Oo(e),...jo(e),...wo(e)],Oo=e=>e.isTimeBased()?[]:[{type:"missing_timestamp_field",indexPatternTitle:e.title}],jo=e=>{const t=e.getFieldByName("message");return null==t?[{type:"missing_message_field",indexPatternTitle:e.title}]:t.type!==So.KBN_FIELD_TYPES.STRING?[{type:"invalid_message_field_type",indexPatternTitle:e.title}]:[]},wo=e=>null!=e.type?[{type:"rollup_index_pattern",indexPatternTitle:e.title}]:[],ko=e=>{var t;const n=(i=null!==(t=null==e?void 0:e.name)&&void 0!==t?t:"",Vr({initialValue:i,validate:Object(a.useMemo)((()=>async e=>To("name",e)),[])}));var i;const r=(e=>{const t=Xr(),n=Object(Fe.useUiTracker)({app:"infra_logs"});return Vr({initialValue:e,validate:Object(a.useMemo)((()=>async e=>{if(null==e)return To("log index pattern","");if(Oa.e.is(e))return To("log indices",e.indexName);{const a=To("log index pattern",e.indexPatternId);if(a.length>0)return a;const i=await t.get(e.indexPatternId).then(Co,(t=>{if(Object(Ca.isSavedObjectNotFoundError)(t))return[{type:"missing_index_pattern",indexPatternId:e.indexPatternId}];throw t}));return i.length>0?n({metric:"configuration_index_pattern_validation_failed"}):n({metric:"configuration_index_pattern_validation_succeeded"}),i}}),[t,n])})})(Object(a.useMemo)((()=>{var t;return null!==(t=null==e?void 0:e.logIndices)&&void 0!==t?t:{type:"index_name",indexName:""}}),[e])),{fieldsFormElement:o,tiebreakerFieldFormElement:s,timestampFieldFormElement:l}=(e=>{const t=Vr({initialValue:e.tiebreakerField,validate:Object(a.useMemo)((()=>async e=>To("tiebreaker",e)),[])}),n=Vr({initialValue:e.timestampField,validate:Object(a.useMemo)((()=>async e=>To("timestamp",e)),[])});return{fieldsFormElement:qr(Object(a.useMemo)((()=>({childFormElements:{tiebreaker:t,timestamp:n}})),[t,n])),tiebreakerFieldFormElement:t,timestampFieldFormElement:n}})(Object(a.useMemo)((()=>{var t,n,a,i;return{tiebreakerField:null!==(t=null==e||null===(n=e.fields)||void 0===n?void 0:n.tiebreaker)&&void 0!==t?t:"_doc",timestampField:null!==(a=null==e||null===(i=e.fields)||void 0===i?void 0:i.timestamp)&&void 0!==a?a:"@timestamp"}}),[e])),u=(e=>Vr({initialValue:e,validate:Object(a.useMemo)((()=>async e=>e.length<=0?[{type:"empty_column_list"}]:[]),[])}))(Object(a.useMemo)((()=>{var t;return null!==(t=null==e?void 0:e.logColumns)&&void 0!==t?t:[]}),[e])),c=qr(Object(a.useMemo)((()=>({childFormElements:{name:n,logIndices:r,fields:o,logColumns:u},validate:async()=>[]})),[n,r,o,u]));return{formState:c.value,logIndicesFormElement:r,logColumnsFormElement:u,nameFormElement:n,sourceConfigurationFormElement:c,tiebreakerFieldFormElement:s,timestampFieldFormElement:l}},Fo=()=>{var e,t;const n=null===(e=Object(b.useKibana)().services.application)||void 0===e?void 0:e.capabilities,r=!0===(null==n||null===(t=n.logs)||void 0===t?void 0:t.configureSource);Object(Fe.useTrackPageview)({app:"infra_logs",path:"log_source_configuration"}),Object(Fe.useTrackPageview)({app:"infra_logs",path:"log_source_configuration",delay:15e3}),C([{text:T.h}]);const{sourceConfiguration:o,hasFailedLoadingSource:s,isLoading:l,isUninitialized:u,updateSource:c,resolvedSourceConfiguration:m}=Object(x.c)(),g=Object(a.useMemo)((()=>{var e;return null!==(e=null==m?void 0:m.fields.map((e=>e.name)))&&void 0!==e?e:[]}),[m]),{sourceConfigurationFormElement:h,formState:p,logIndicesFormElement:f,logColumnsFormElement:y,nameFormElement:E,tiebreakerFieldFormElement:v,timestampFieldFormElement:_}=ko(null==o?void 0:o.configuration),M=Object(a.useCallback)((async()=>{await c(p),h.resetValue()}),[c,h,p]),S=Object(a.useMemo)((()=>r&&o&&"internal"!==o.origin),[r,o]);return!l&&!u||m?s?null:i.a.createElement(d.EuiErrorBoundary,null,i.a.createElement(ha,{pageHeader:{pageTitle:T.h},"data-test-subj":"sourceConfigurationContent",restrictWidth:!0},i.a.createElement(Pr.b,{prompt:h.isDirty?Io:void 0}),i.a.createElement(d.EuiPanel,{paddingSize:"l",hasShadow:!1,hasBorder:!0},i.a.createElement(Mo,{isLoading:l,isReadOnly:!S,nameFormElement:E})),i.a.createElement(d.EuiSpacer,null),i.a.createElement(d.EuiPanel,{paddingSize:"l",hasShadow:!1,hasBorder:!0},i.a.createElement(io,{isLoading:l,isReadOnly:!S,indicesFormElement:f,tiebreakerFieldFormElement:v,timestampFieldFormElement:_})),i.a.createElement(d.EuiSpacer,null),i.a.createElement(d.EuiPanel,{paddingSize:"l",hasShadow:!1,hasBorder:!0},i.a.createElement(ho,{availableFields:g,isLoading:l,logColumnsFormElement:y})),i.a.createElement(d.EuiSpacer,null),"invalid"===h.validity.validity?i.a.createElement(i.a.Fragment,null,i.a.createElement(Dr,{errors:h.validity.reasons}),i.a.createElement(d.EuiSpacer,null)):null,i.a.createElement(d.EuiFlexGroup,null,S&&i.a.createElement(d.EuiFlexItem,null,l?i.a.createElement(d.EuiFlexGroup,{justifyContent:"flexEnd"},i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(d.EuiButton,{color:"primary",isLoading:!0,fill:!0},"Loading"))):i.a.createElement(i.a.Fragment,null,i.a.createElement(d.EuiFlexGroup,{justifyContent:"flexEnd"},i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(d.EuiButton,{"data-test-subj":"discardSettingsButton",color:"danger",iconType:"cross",isDisabled:l||!h.isDirty,onClick:()=>{h.resetValue()}},i.a.createElement(k.FormattedMessage,{id:"xpack.infra.sourceConfiguration.discardSettingsButtonLabel",defaultMessage:"Discard"}))),i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(d.EuiButton,{"data-test-subj":"applySettingsButton",color:"primary",isDisabled:!h.isDirty||"valid"!==h.validity.validity,fill:!0,onClick:M},i.a.createElement(k.FormattedMessage,{id:"xpack.infra.sourceConfiguration.applySettingsButtonLabel",defaultMessage:"Apply"}))))))))):i.a.createElement(Fa.a,null)},Io=h.i18n.translate("xpack.infra.logSourceConfiguration.unsavedFormPromptMessage",{defaultMessage:"Are you sure you want to leave? Changes will be lost"});var Lo=n(116),Po=n(13),Do=n.n(Po),Ro=n(147),No=n(267);const Ao=({buckets:e,start:t,end:n,width:i,height:r})=>{var o;if(t>=n||r<=0||i<=0||e.length<=0)return null;const s=Object(Ro.scaleTime)().domain([t,n]).range([0,r]),l=Object(We.max)(e.map((e=>e.entriesCount)))||0,u=Object(Ro.scaleLinear)().domain([0,l]).range([0,i]),c=Object(No.area)().x0(null!==(o=u(0))&&void 0!==o?o:0).x1((e=>{var t;return null!==(t=u(e.entriesCount))&&void 0!==t?t:0})).y0((e=>{var t;return null!==(t=s(e.start))&&void 0!==t?t:0})).y1((e=>{var t;return null!==(t=s(e.end))&&void 0!==t?t:0})).curve(No.curveMonotoneY),d=e[0],m=e[e.length-1],g=c([{start:t,end:t,entriesCount:d.entriesCount},...e,{start:m.end,end:m.end,entriesCount:m.entriesCount},{start:n,end:n,entriesCount:0}]);return a.createElement("g",null,a.createElement(Ho,{width:i,height:r}),a.createElement(Uo,{d:g||""}))},Ho=Lt.euiStyled.rect`
  fill: ${e=>e.theme.darkMode?e.theme.eui.euiColorLightShade:e.theme.eui.euiColorLightestShade};
`,Uo=Lt.euiStyled.path`
  fill: ${e=>e.theme.darkMode?e.theme.eui.euiColorMediumShade:e.theme.eui.euiColorLightShade};
`,zo=({className:e,end:t,getPositionOfTime:n,start:i,targetWidth:r,width:o,target:s})=>{const l=n(i),u=n(t),c=s&&n(s);return a.createElement(a.Fragment,null,c&&a.createElement(Jo,{className:e,x1:0,x2:r,y1:c,y2:c}),a.createElement(Bo,{className:e,points:` ${r},${l} ${o},${l} ${o},${u}  ${r},${u}`}))};zo.displayName="HighlightedInterval";const Jo=Lt.euiStyled.line`
  stroke: ${e=>e.theme.eui.euiColorPrimary};
  stroke-width: 1;
`,Bo=Lt.euiStyled.polygon`
  fill: ${e=>e.theme.eui.euiColorPrimary};
  fill-opacity: 0.3;
  stroke: ${e=>e.theme.eui.euiColorPrimary};
  stroke-width: 1;
`;var Yo=n(79),Vo=n.n(Yo);class search_marker_tooltip_SearchMarkerTooltip extends a.PureComponent{render(){const{children:e,markerPosition:t}=this.props;return a.createElement(d.EuiPortal,null,a.createElement("div",null,a.createElement(Lo.a,{content:!1,bounds:!0},(({measureRef:n,bounds:{width:i,height:r}})=>{const{top:o,left:s}=i&&r?Object(d.calculatePopoverPosition)(t,{width:i,height:r},"left",16,["left"]):{left:-9999,top:0};return a.createElement("div",{className:"euiToolTip euiToolTip--left euiToolTipPopover",style:{left:s,top:o},ref:n},a.createElement("div",{className:"euiToolTip__arrow",style:{left:i||0,top:(r||0)/2-6}}),a.createElement("div",null,e))}))))}}class search_marker_SearchMarker extends a.PureComponent{constructor(...e){super(...e),Do()(this,"state",{hoveredPosition:null}),Do()(this,"handleClick",(e=>{e.stopPropagation(),this.props.jumpToTarget(this.props.bucket.representativeKey)})),Do()(this,"handleMouseEnter",(e=>{this.setState({hoveredPosition:e.currentTarget.getBoundingClientRect()})})),Do()(this,"handleMouseLeave",(()=>{this.setState({hoveredPosition:null})}))}render(){const{bucket:e,height:t,width:n}=this.props,{hoveredPosition:i}=this.state,r=e.entriesCount>1?a.createElement(Go,{x:"-2",y:"-2",width:"4",height:t+2,rx:"2",ry:"2"}):a.createElement(a.Fragment,null,a.createElement(Go,{x:"-1",y:"0",width:"2",height:t}),a.createElement(Go,{x:"-2",y:t/2-2,width:"4",height:"4",rx:"2",ry:"2"}));return a.createElement(a.Fragment,null,i?a.createElement(search_marker_tooltip_SearchMarkerTooltip,{markerPosition:i},a.createElement(k.FormattedMessage,{id:"xpack.infra.logs.searchResultTooltip",defaultMessage:"{bucketCount, plural, one {# highlighted entry} other {# highlighted entries}}",values:{bucketCount:e.entriesCount}})):null,a.createElement(Wo,{onClick:this.handleClick,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave},a.createElement($o,{x:"0",y:"0",width:n,height:t}),r))}}const qo=Lt.keyframes`
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
`,Wo=Lt.euiStyled.g`
  animation: ${qo} ${e=>e.theme.eui.euiAnimSpeedExtraSlow} ease-in both;
`,$o=Lt.euiStyled.rect`
  fill: ${e=>e.theme.eui.euiColorAccent};
  opacity: 0;
  transition: opacity ${e=>e.theme.eui.euiAnimSpeedNormal} ease-in;
  cursor: pointer;

  ${Wo}:hover & {
    opacity: 0.3;
  }
`,Go=Lt.euiStyled.rect`
  fill: ${e=>e.theme.eui.euiColorAccent};
`;class search_markers_SearchMarkers extends a.PureComponent{render(){const{buckets:e,start:t,end:n,width:i,height:r,jumpToTarget:o,className:s}=this.props,l=Vo()("minimapSearchMarkers",s);if(t>=n||r<=0||Object.keys(e).length<=0)return null;const u=Object(Ro.scaleTime)().domain([t,n]).range([0,r]);return a.createElement("g",{transform:`translate(${i/2}, 0)`,className:l},e.map((e=>{var t,n;return a.createElement("g",{key:`${e.representativeKey.time}:${e.representativeKey.tiebreaker}`,transform:`translate(0, ${u(e.start)})`},a.createElement(search_marker_SearchMarker,{bucket:e,height:(null!==(t=u(e.end))&&void 0!==t?t:0)-(null!==(n=u(e.start))&&void 0!==n?n:0),width:i,jumpToTarget:o}))})))}}const Qo=({end:e,height:t,start:n,tickCount:i,width:r})=>{const o=Object(Ro.scaleTime)().domain([n,e]).range([0,t]),s=o.ticks(i),l=o.tickFormat(i,function(e,t){const n=Math.abs(t-e);return n<15e3?":%S.%L":n<96e4?"%I:%M:%S":void 0}(n,e));return a.createElement("g",null,s.map(((e,t)=>{var n;const i=null!==(n=o(e))&&void 0!==n?n:0;return a.createElement("g",{key:`tick${t}`},a.createElement(Zo,{x:0,y:i-4},l(e)),a.createElement(Ko,{x1:0,y1:i,x2:r,y2:i}))})))};Qo.displayName="TimeRuler";const Zo=Lt.euiStyled.text`
  font-size: 9px;
  line-height: ${e=>e.theme.eui.euiLineHeight};
  fill: ${e=>e.theme.eui.euiTextSubduedColor};
  user-select: none;
  pointer-events: none;
`,Ko=Lt.euiStyled.line`
  stroke: ${e=>e.theme.darkMode?e.theme.eui.euiColorDarkestShade:e.theme.eui.euiColorDarkShade};
  stroke-opacity: 0.5;
  stroke-width: 1px;
`,Xo=50;function es(e,t,n){return Object(Ro.scaleLinear)().domain([e||0,t||0]).range([0,n])}class log_minimap_LogMinimap extends a.Component{constructor(e){super(e),Do()(this,"handleClick",(e=>{const t=e.currentTarget.getBoundingClientRect().top,n=e.clientY-t,a=Math.floor(this.getYScale().invert(n));this.props.jumpToTarget({tiebreaker:0,time:a})})),Do()(this,"getYScale",(()=>{const{start:e,end:t,height:n}=this.props;return es(e,t,n)})),Do()(this,"getPositionOfTime",(e=>{var t;return null!==(t=this.getYScale()(e))&&void 0!==t?t:0})),Do()(this,"updateTimeCursor",(e=>{const t=e.currentTarget.getBoundingClientRect(),n=e.clientY-t.top;this.setState({timeCursorY:n})})),this.state={timeCursorY:0,target:e.target}}render(){const{start:e,end:t,className:n,height:i,highlightedInterval:r,jumpToTarget:o,summaryBuckets:s,summaryHighlightBuckets:l,width:u}=this.props,{timeCursorY:c,target:d}=this.state,[m,g]=es(e,t,i).domain(),h=i?Math.floor(i/50):12;return a.createElement(as,{className:n,height:i,preserveAspectRatio:"none",viewBox:`0 0 ${u} ${i}`,width:u,onClick:this.handleClick,onMouseMove:this.updateTimeCursor},a.createElement(ts,{x1:Xo,x2:Xo,y1:0,y2:i}),a.createElement(Qo,{start:m,end:g,width:Xo,height:i,tickCount:h}),a.createElement("g",{transform:"translate(50, 0)"},a.createElement(Ao,{buckets:s,start:m,end:g,width:u-Xo,height:i}),a.createElement(search_markers_SearchMarkers,{buckets:l||[],start:m,end:g,width:u-Xo,height:i,jumpToTarget:o})),r?a.createElement(zo,{end:r.end,getPositionOfTime:this.getPositionOfTime,start:r.start,targetWidth:Xo,width:u,target:d}):null,a.createElement(ns,{x1:Xo,x2:u,y1:c,y2:c}))}}const ts=Lt.euiStyled.line`
  stroke: ${e=>e.theme.eui.euiColorMediumShade};
  stroke-width: 1px;
`,ns=Lt.euiStyled.line`
  pointer-events: none;
  stroke-width: 1px;
  stroke: ${e=>e.theme.darkMode?e.theme.eui.euiColorDarkestShade:e.theme.eui.euiColorDarkShade};
`,as=Lt.euiStyled.svg`
  cursor: pointer;
  fill: ${e=>e.theme.eui.euiColorEmptyShade};
  & ${ns} {
    visibility: hidden;
  }
  &:hover ${ns} {
    visibility: visible;
  }
`;var is=n(172),rs=n(123),os=n(173),ss=n.n(os);const ls=(e,t,n,i,r,o,s,l)=>{const{services:u}=Object(_e.b)(),[c,d]=Object(a.useState)([]),[m,g]=Object(Me.c)({cancelPreviousOn:"resolution",createPromise:async()=>{if(!(n&&i&&r&&l.length))throw new Error("Skipping request: Insufficient parameters");return await(async(e,t)=>{const n=await t(ne.e,{method:"POST",body:JSON.stringify(ne.n.encode(e))});return Object(I.b)(ne.o)(n)})({sourceId:e,startTimestamp:n,endTimestamp:i,center:r,size:o,query:s||void 0,highlightTerms:l},u.http.fetch)},onResolve:e=>{d(e.data)}},[e,n,i,r,o,s,l]);Object(a.useEffect)((()=>{d([])}),[l]),Object(a.useEffect)((()=>{l.filter((e=>e.length>0)).length&&n&&i?g():d([])}),[i,s,l,g,t,n]);const h=Object(a.useMemo)((()=>c.reduce(((e,t)=>t.entries.reduce(((e,t)=>{const n=e[t.id]||[];return{...e,[t.id]:[...n,t]}}),e)),{})),[c]);return{logEntryHighlights:c,logEntryHighlightsById:h,loadLogEntryHighlightsRequest:m}};function us(e,t){return Object(a.useMemo)((()=>e&&t?(t-e)/100:null),[e,t])}const cs=(e,t,n,i,r,o)=>{const{services:s}=Object(_e.b)(),[l,u]=Object(a.useState)([]),c=us(n,i),[d,m]=Object(Me.c)({cancelPreviousOn:"resolution",createPromise:async()=>{if(!(n&&i&&c&&o.length))throw new Error("Skipping request: Insufficient parameters");return await(async(e,t)=>{const n=await t(ne.f,{method:"POST",body:JSON.stringify(ne.p.encode(e))});return Object(I.b)(ne.q)(n)})({sourceId:e,startTimestamp:n,endTimestamp:i,bucketSize:c,query:r,highlightTerms:o},s.http.fetch)},onResolve:e=>{u(e.data)}},[e,n,i,c,r,o]),g=Object(a.useMemo)((()=>Object(We.debounce)(m,275)),[m]);return Object(a.useEffect)((()=>{u([])}),[o]),Object(a.useEffect)((()=>{o.filter((e=>e.length>0)).length&&n&&i?g():u([])}),[c,g,r,o,t,n,i]),{logSummaryHighlights:l,loadLogSummaryHighlightsRequest:d}};var ds=n(157);const ms=(e,t,n)=>Math.min(Math.max(e,t),n);var gs=n(104);const hs=xe()((({sourceId:e,sourceVersion:t,centerCursor:n,size:i,filterQuery:r})=>{const[o,s]=Object(a.useState)([]),{visibleMidpoint:l,jumpToTargetPosition:u,startTimestamp:c,endTimestamp:d}=Object(a.useContext)(gs.a.Context),m=ss()(c,3e3),g=ss()(d,3e3),{logEntryHighlights:h,logEntryHighlightsById:p,loadLogEntryHighlightsRequest:f}=ls(e,t,m,g,n,i,r,o),{logSummaryHighlights:y,loadLogSummaryHighlightsRequest:b}=cs(e,t,m,g,r,o),{currentHighlightKey:E,hasPreviousHighlight:v,hasNextHighlight:x,goToPreviousHighlight:_,goToNextHighlight:M}=(({highlightTerms:e,jumpToTargetPosition:t,logEntryHighlights:n,visibleMidpoint:i})=>{const[r,o]=Object(a.useState)(null),s=Object(a.useMemo)((()=>n&&n.length>0?n[0].entries:[]),[n]);Object(a.useEffect)((()=>{o(null)}),[e]),Object(a.useEffect)((()=>{r&&t(r)}),[r,t]),Object(a.useEffect)((()=>{if(null===r&&s.length>0){const e=i?ms(Object(ds.b)(s,i),0,s.length-1):0,t=Object(ds.c)(s[e]);o(t)}}),[r,s,o,i]);const l=Object(a.useMemo)((()=>r&&s.length>0?Object(ds.a)(s,r):null),[r,s]),u=Object(a.useMemo)((()=>Object(We.isNumber)(l)&&l>0),[l]),c=Object(a.useMemo)((()=>s.length>0&&Object(We.isNumber)(l)&&l<s.length-1),[l,s]),d=Object(a.useCallback)((()=>{if(s.length&&Object(We.isNumber)(l)){const e=l-1,t=Object(ds.c)(s[e]);o(t)}}),[l,s]),m=Object(a.useCallback)((()=>{if(s.length>0&&Object(We.isNumber)(l)){const e=l+1,t=Object(ds.c)(s[e]);o(t)}}),[l,s]);return{currentHighlightKey:r,hasPreviousHighlight:u,hasNextHighlight:c,goToPreviousHighlight:d,goToNextHighlight:m}})({visibleMidpoint:l,logEntryHighlights:h,highlightTerms:o,jumpToTargetPosition:u});return{highlightTerms:o,setHighlightTerms:s,logEntryHighlights:h,logEntryHighlightsById:p,logSummaryHighlights:y,loadLogEntryHighlightsRequest:f,loadLogSummaryHighlightsRequest:b,currentHighlightKey:E,hasPreviousHighlight:v,hasNextHighlight:x,goToPreviousHighlight:_,goToNextHighlight:M}}));var ps=n(181);const fs=(e,t,n,i)=>{const{services:r}=Object(_e.b)(),[o,s]=Object(a.useState)([]),l=us(t,n);var u,c;return u=a=>{null!==t&&null!==n&&null!==l&&(async(e,t)=>{const n=await t(ne.g,{method:"POST",body:JSON.stringify(ne.r.encode(e))});return Object(I.b)(ne.s)(n)})({sourceId:e,startTimestamp:t,endTimestamp:n,bucketSize:l,query:i},r.http.fetch).then((e=>{a()||s(e.data.buckets)}))},c=[e,i,t,n,l],Object(a.useEffect)((()=>{const e=(()=>{const e={isCancelled:!1,cancel:()=>{e.isCancelled=!0}};return e})();return u((()=>e.isCancelled)),e.cancel}),c),{buckets:o,start:t,end:n}},ys=({children:e})=>{var t;const{sourceId:n}=Object(x.c)(),{filterQuery:i}=Object(a.useContext)(rs.a.Context),{startTimestamp:r,endTimestamp:o}=Object(a.useContext)(gs.a.Context),s=ss()(r,3e3),l=ss()(o,3e3),{buckets:u,start:c,end:d}=fs(n,s,l,null!==(t=null==i?void 0:i.serializedQuery)&&void 0!==t?t:null);return e({buckets:u,start:c,end:d})},bs=xe()((()=>{const[e,t]=Object(a.useState)("medium"),[n,i]=Object(a.useState)(!0);return{availableTextScales:Es,setTextScale:t,setTextWrap:i,textScale:e,textWrap:n}})),Es=["large","medium","small"],vs=()=>{const{textScale:e,textWrap:t,setTextScale:n,setTextWrap:r}=Object(a.useContext)(bs.Context),o=Object(a.useMemo)((()=>({textScale:e,wrap:t})),[e,t]);return i.a.createElement(hi.a,{urlState:o,urlStateKey:"logTextview",mapToUrlState:xs,onChange:e=>{e&&e.textScale&&n(e.textScale),e&&void 0!==e.wrap&&r(e.wrap)},onInitialize:e=>{e&&e.textScale&&n(e.textScale),e&&void 0!==e.wrap&&r(e.wrap)}})},xs=e=>e?{textScale:_s(e.textScale),wrap:Ms(e.wrap)}:void 0,_s=e=>Es.includes(e)?e:void 0,Ms=e=>"boolean"==typeof e?e:void 0;var Ss=n(31);class log_customization_menu_LogCustomizationMenu extends a.Component{constructor(...e){super(...e),Do()(this,"state",{isShown:!1}),Do()(this,"show",(()=>{this.setState({isShown:!0})})),Do()(this,"hide",(()=>{this.setState({isShown:!1})})),Do()(this,"toggleVisibility",(()=>{this.setState((e=>({isShown:!e.isShown})))}))}render(){const{children:e}=this.props,{isShown:t}=this.state,n=a.createElement(d.EuiButtonEmpty,{color:"text",iconType:"eye",onClick:this.toggleVisibility,size:"xs"},a.createElement(k.FormattedMessage,{id:"xpack.infra.logs.customizeLogs.customizeButtonLabel",defaultMessage:"Customize"}));return a.createElement(d.EuiPopover,{id:"customizePopover",button:n,closePopover:this.hide,isOpen:t,anchorPosition:"downRight",ownFocus:!0},a.createElement(Ts,null,e))}}const Ts=Lt.euiStyled.div`
  min-width: 200px;
`,Cs=({startDateExpression:e,endDateExpression:t,isStreaming:n,onUpdateDateRange:r,onStartStreaming:o,onStopStreaming:s})=>{const l=Object(a.useCallback)((({start:e,end:t,isInvalid:n})=>{r&&!n&&r({startDateExpression:e,endDateExpression:t})}),[r]);return i.a.createElement(d.EuiFlexGroup,{gutterSize:"s"},i.a.createElement(d.EuiFlexItem,null,i.a.createElement(d.EuiSuperDatePicker,{start:e,end:t,onTimeChange:l,showUpdateButton:!1,isDisabled:n})),i.a.createElement(d.EuiFlexItem,{grow:!1},n?i.a.createElement(d.EuiButton,{color:"primary",iconType:"pause",iconSide:"left",onClick:s},i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logs.stopStreamingButtonLabel",defaultMessage:"Stop streaming"})):i.a.createElement(d.EuiButton,{color:"primary",iconType:"play",iconSide:"left",onClick:o},i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logs.startStreamingButtonLabel",defaultMessage:"Stream live"}))))},Os=({onChange:e,isLoading:t,activeHighlights:n,hasPreviousHighlight:r,goToPreviousHighlight:o,hasNextHighlight:s,goToNextHighlight:l})=>{const{isVisible:u,hide:c,toggle:m}=Object(Za.a)(!1),[g,h]=Object(a.useState)(""),p=Object(a.useMemo)((()=>Object(We.debounce)(e,275)),[e]),f=Object(a.useCallback)((e=>h((t=>{const n="function"==typeof e?e(t):e;return n!==t&&p([n]),n}))),[p]),y=Object(a.useCallback)((e=>{const t=e.target.value;f(t)}),[f]),b=Object(a.useCallback)((()=>f("")),[f]),E=i.a.createElement(d.EuiButtonEmpty,{color:"text",size:"xs",iconType:"brush",onClick:m},i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logs.highlights.highlightsPopoverButtonLabel",defaultMessage:"Highlights"}),n?i.a.createElement(Is,null):null);return i.a.createElement(d.EuiPopover,{id:"popover",button:E,isOpen:u,closePopover:c,ownFocus:!0},i.a.createElement(Ls,null,i.a.createElement(d.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},i.a.createElement(d.EuiFlexItem,null,i.a.createElement(d.EuiFieldText,{placeholder:js,fullWidth:!0,value:g,onChange:y,isLoading:t,"aria-label":js})),i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(d.EuiButtonIcon,{"aria-label":ks,iconType:"arrowUp",onClick:o,title:ks,isDisabled:!r})),i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(d.EuiButtonIcon,{"aria-label":Fs,iconType:"arrowDown",onClick:l,title:Fs,isDisabled:!s})),i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(d.EuiButtonIcon,{"aria-label":ws,color:"danger",isDisabled:""===g,iconType:"trash",onClick:b,title:ws})))))},js=h.i18n.translate("xpack.infra.logs.highlights.highlightTermsFieldLabel",{defaultMessage:"Terms to highlight"}),ws=h.i18n.translate("xpack.infra.logs.highlights.clearHighlightTermsButtonLabel",{defaultMessage:"Clear terms to highlight"}),ks=h.i18n.translate("xpack.infra.logs.highlights.goToPreviousHighlightButtonLabel",{defaultMessage:"Jump to previous highlight"}),Fs=h.i18n.translate("xpack.infra.logs.highlights.goToNextHighlightButtonLabel",{defaultMessage:"Jump to next highlight"}),Is=Object(Lt.euiStyled)(d.EuiIcon).attrs((({theme:e})=>({type:"checkInCircleFilled",size:"m",color:null==e?void 0:e.eui.euiColorAccent})))`
  padding-left: ${e=>e.theme.eui.paddingSizes.xs};
`,Ls=Lt.euiStyled.div`
  width: 300px;
`;class log_text_scale_controls_LogTextScaleControls extends a.PureComponent{constructor(...e){super(...e),Do()(this,"setTextScale",(e=>{["small","medium","large"].includes(e)&&this.props.setTextScale(e)}))}render(){const{availableTextScales:e,textScale:t}=this.props;return a.createElement(d.EuiFormRow,{label:a.createElement(k.FormattedMessage,{id:"xpack.infra.logs.customizeLogs.textSizeFormRowLabel",defaultMessage:"Text Size"})},a.createElement(d.EuiRadioGroup,{options:e.map((e=>({id:e.toString(),label:a.createElement(k.FormattedMessage,{id:"xpack.infra.logs.customizeLogs.textSizeRadioGroup",defaultMessage:"{textScale, select, small {Small} medium {Medium} large {Large} other {{textScale}} }",values:{textScale:e}})}))),idSelected:t,onChange:this.setTextScale}))}}class log_text_wrap_controls_LogTextWrapControls extends a.PureComponent{constructor(...e){super(...e),Do()(this,"toggleWrap",(()=>{this.props.setTextWrap(!this.props.wrap)}))}render(){const{wrap:e}=this.props;return a.createElement(d.EuiFormRow,{label:a.createElement(k.FormattedMessage,{id:"xpack.infra.logs.customizeLogs.lineWrappingFormRowLabel",defaultMessage:"Line Wrapping"})},a.createElement(d.EuiSwitch,{label:a.createElement(k.FormattedMessage,{id:"xpack.infra.logs.customizeLogs.wrapLongLinesSwitchLabel",defaultMessage:"Wrap long lines"}),checked:e,onChange:this.toggleWrap}))}}const Ps=()=>{const{derivedIndexPattern:e}=Object(x.c)(),{availableTextScales:t,setTextScale:n,setTextWrap:r,textScale:o,textWrap:s}=Object(a.useContext)(bs.Context),{filterQueryDraft:l,isFilterQueryDraftValid:u,applyLogFilterQuery:c,setLogFilterQueryDraft:m}=Object(a.useContext)(rs.a.Context),{setSurroundingLogsId:g}=Object(a.useContext)(fi.Context),{setHighlightTerms:p,loadLogEntryHighlightsRequest:f,highlightTerms:y,hasPreviousHighlight:b,hasNextHighlight:E,goToPreviousHighlight:v,goToNextHighlight:_}=Object(a.useContext)(hs.Context),{isStreaming:M,startLiveStreaming:S,stopLiveStreaming:T,startDateExpression:C,endDateExpression:O,updateDateRange:j}=Object(a.useContext)(gs.a.Context);return i.a.createElement("div",null,i.a.createElement(d.EuiFlexGroup,{alignItems:"center",justifyContent:"spaceBetween",gutterSize:"l",wrap:!0},i.a.createElement(Ds,null,i.a.createElement(So.QueryStringInput,{disableLanguageSwitcher:!0,iconType:"search",indexPatterns:[e],isInvalid:!u,onChange:e=>{g(null),m(e)},onSubmit:e=>{g(null),c(e)},placeholder:h.i18n.translate("xpack.infra.logsPage.toolbar.kqlSearchFieldPlaceholder",{defaultMessage:"Search for log entriesâ¦ (e.g. host.name:host-1)"}),query:l})),i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(d.EuiFlexGroup,null,i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(log_customization_menu_LogCustomizationMenu,null,i.a.createElement(log_text_wrap_controls_LogTextWrapControls,{wrap:s,setTextWrap:r}),i.a.createElement(log_text_scale_controls_LogTextScaleControls,{availableTextScales:t,textScale:o,setTextScale:n}))),i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(Os,{onChange:p,isLoading:"pending"===f.state,activeHighlights:y.filter((e=>e.length>0)).length>0,goToPreviousHighlight:v,goToNextHighlight:_,hasPreviousHighlight:b,hasNextHighlight:E})))),i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(Cs,{startDateExpression:C,endDateExpression:O,onStartStreaming:S,onStopStreaming:T,isStreaming:M,onUpdateDateRange:j}))))},Ds=Object(Lt.euiStyled)(d.EuiFlexItem)`
  @media (min-width: 1200px) {
    flex: 0 0 100% !important;
    margin-left: 0 !important;
    margin-right: 0 !important;
    padding-left: 12px;
    padding-right: 12px;
  }
`,Rs=()=>{const{resolvedSourceConfiguration:e,sourceConfiguration:t,sourceId:n}=Object(x.c)(),{textScale:r,textWrap:o}=Object(a.useContext)(bs.Context),{surroundingLogsId:s,setSurroundingLogsId:l,closeFlyout:u,openFlyout:c,isFlyoutOpen:m,logEntryId:g}=bi(),{startTimestamp:h,endTimestamp:p,isStreaming:f,targetPosition:y,visibleMidpointTime:b,visibleTimeInterval:E,reportVisiblePositions:v,jumpToTargetPosition:_,startLiveStreaming:M,stopLiveStreaming:S,startDateExpression:T,endDateExpression:C,updateDateRange:O,lastCompleteDateRangeExpressionUpdate:j}=Object(a.useContext)(gs.a.Context),{filterQuery:w,applyLogFilterQuery:k}=Object(a.useContext)(rs.a.Context),{isReloading:F,entries:I,topCursor:L,bottomCursor:P,hasMoreAfter:D,hasMoreBefore:R,isLoadingMore:N,lastLoadedTime:A,fetchEntries:H,fetchPreviousEntries:U,fetchNextEntries:z,fetchNewestEntries:J}=Object(ps.c)(),B=Ge()(h),Y=Ge()(p),V=Ge()(w),q=Ge()(j);Object(a.useEffect)((()=>{const e=!B||!Y,t=j!==q,n=null!=y&&(null!=L&&y.time<L.time||null!=P&&y.time>P.time);(e||t||n||w!==V)&&(f?J():H())}),[H,J,f,B,Y,h,p,y,L,P,w,V,j,q]);const{logSummaryHighlights:W,currentHighlightKey:$,logEntryHighlightsById:G}=Object(a.useContext)(hs.Context),Q=Object(a.useMemo)((()=>F?[]:I.map((e=>As(e,G[e.id]||[])))),[I,F,G]),[,{setContextEntry:Z}]=Object(a.useContext)(Vt.Context),K=Object(a.useCallback)((e=>{O(e),"startDateExpression"in e&&Object(Ss.c)(e.startDateExpression)&&U({force:!0,extendTo:Object(Ss.a)(e.startDateExpression)}),"endDateExpression"in e&&Object(Ss.c)(e.endDateExpression)&&z({force:!0,extendTo:Object(Ss.a)(e.endDateExpression)})}),[O,U,z]),X=Object(a.useCallback)((e=>{v(e),e.fromScroll&&(N||(e.pagesBeforeStart<2?U():e.pagesAfterEnd<2&&z()))}),[v,N,U,z]),ee=Object(a.useCallback)(((e,t,n)=>{k(e),n&&_(n),l(t),S()}),[k,_,l,S]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(vs,null),i.a.createElement(Ei,null),i.a.createElement(Ps,null),i.a.createElement(d.EuiSpacer,{size:"m"}),i.a.createElement(Gt,null),m?i.a.createElement(di,{logEntryId:g,onCloseFlyout:u,onSetFieldFilter:ee,sourceId:n}):null,i.a.createElement(is.b,{key:`${n}-${null==t?void 0:t.version}`},i.a.createElement(yn.g,{columnConfigurations:e&&e.columns||[],hasMoreAfterEnd:D,hasMoreBeforeStart:R,isLoadingMore:N,isReloading:F,isStreaming:f,items:Q,jumpToTarget:_,lastLoadedTime:A,reloadItems:H,reportVisibleInterval:X,scale:r,target:y,wrap:o,onOpenLogEntryFlyout:c,setContextEntry:Z,highlightedItem:s||null,currentHighlightKey:$,startDateExpression:T,endDateExpression:C,updateDateRange:K,startLiveStreaming:M}),i.a.createElement(Lo.a,{content:!0,bounds:!0,detectAnyWindowResize:"height"},(({measureRef:e,bounds:{height:t=0},content:{width:n=0}})=>i.a.createElement(Ns,{ref:e},i.a.createElement(ys,null,(({buckets:e,start:a,end:r})=>i.a.createElement(log_minimap_LogMinimap,{start:a,end:r,height:t,width:n,highlightedInterval:F?null:E,jumpToTarget:_,summaryBuckets:e,summaryHighlightBuckets:W.length>0?W[0].buckets:[],target:b}))))))))},Ns=Lt.euiStyled.div`
  flex: 1 0 0%;
  overflow: hidden;
  min-width: 100px;
  max-width: 100px;
  display: flex;
  flex-direction: column;
`,As=(e,t)=>({kind:"logEntry",logEntry:e,highlights:t});var Hs=n(32);const Us=h.i18n.translate("xpack.infra.logs.streamPageTitle",{defaultMessage:"Stream"}),zs=()=>{const{hasFailedLoading:e,isLoading:t,isUninitialized:n,loadSource:a,latestLoadSourceFailures:r,sourceStatus:o}=Object(x.c)();return t||n?i.a.createElement(Fa.a,null):e?i.a.createElement(ja,{errors:r,onRetry:a}):i.a.createElement(Js,{className:Hs.APP_WRAPPER_CLASS},i.a.createElement(ha,{hasData:"missing"!==(null==o?void 0:o.logIndexStatus),pageHeader:{pageTitle:Us}},i.a.createElement(Rs,null)))},Js=Lt.euiStyled.div`
  .euiPage .euiPageContentBody {
    display: flex;
    flex-direction: column;
    flex: 1 0 auto;
    width: 100%;
    height: 100%;
  }
`,Bs=()=>i.a.createElement(i.a.Fragment,null,i.a.createElement(E.a,{title:e=>h.i18n.translate("xpack.infra.logs.streamPage.documentTitle",{defaultMessage:"{previousTitle} | Stream",values:{previousTitle:e}})})),Ys=({children:e})=>{const{derivedIndexPattern:t}=Object(x.c)();return i.a.createElement(rs.a.Provider,{indexPattern:t},i.a.createElement(rs.b,null),e)},Vs=({children:e})=>{const{startTimestamp:t,endTimestamp:n}=Object(a.useContext)(gs.a.Context),{sourceId:r}=Object(x.c)();return t&&n?i.a.createElement(Vt.Provider,{startTimestamp:t,endTimestamp:n,sourceId:r},e):null},qs=({children:e})=>{const{sourceId:t}=Object(x.c)(),{startTimestamp:n,endTimestamp:r,targetPosition:o,isInitialized:s}=Object(a.useContext)(gs.a.Context),{filterQuery:l}=Object(a.useContext)(rs.a.Context);return n&&r&&s?i.a.createElement(ps.a,{sourceId:t,startTimestamp:n,endTimestamp:r,query:null==l?void 0:l.parsedQuery,center:null!=o?o:void 0},e):null},Ws=({children:e})=>{var t;const{sourceId:n,sourceConfiguration:r}=Object(x.c)(),{topCursor:o,bottomCursor:s,entries:l}=Object(ps.c)(),{filterQuery:u}=Object(a.useContext)(rs.a.Context),c={sourceId:n,sourceVersion:null==r?void 0:r.version,entriesStart:o,entriesEnd:s,centerCursor:l.length>0?l[Math.floor(l.length/2)].cursor:null,size:l.length,filterQuery:null!==(t=null==u?void 0:u.serializedQuery)&&void 0!==t?t:null};return i.a.createElement(hs.Provider,c,e)},$s=({children:e})=>{const{sourceStatus:t}=Object(x.c)();return"missing"===(null==t?void 0:t.logIndexStatus)?i.a.createElement(i.a.Fragment,null,e):i.a.createElement(bs.Provider,null,i.a.createElement(fi.Provider,null,i.a.createElement(gs.a.Provider,null,i.a.createElement(gs.b,null),i.a.createElement(Vs,null,i.a.createElement(Ys,null,i.a.createElement(qs,null,i.a.createElement(Ws,null,e)))))))},Gs=()=>(Object(Fe.useTrackPageview)({app:"infra_logs",path:"stream"}),Object(Fe.useTrackPageview)({app:"infra_logs",path:"stream",delay:15e3}),C([{text:T.i}]),i.a.createElement(d.EuiErrorBoundary,null,i.a.createElement($s,null,i.a.createElement(Bs,null),i.a.createElement(zs,null))));var Qs=n(45),Zs=n(211);const Ks=()=>{var e,t,n,r;const o=null===(e=Object(b.useKibana)().services.application)||void 0===e?void 0:e.capabilities,{setHeaderActionMenu:l}=Object(a.useContext)(Qs.a),{initialize:u}=Object(x.c)(),c=Object(b.useKibana)();Object(Zs.a)(!(null!=o&&null!==(t=o.logs)&&void 0!==t&&t.save)),f()((()=>{u()}));const m="/stream",h="/anomalies",p="/log-categories",M="/settings",S=Object(Ht.b)({app:"logs",pathname:"settings"});return i.a.createElement(i.a.Fragment,null,i.a.createElement(E.a,{title:Xs}),i.a.createElement(v.a,{feedbackLink:tl,appName:Xs}),l&&i.a.createElement(Fe.HeaderMenuPortal,{setHeaderActionMenu:l},i.a.createElement(d.EuiHeaderLinks,{gutterSize:"xs"},i.a.createElement(d.EuiHeaderLink,g()({color:"text"},S),el),i.a.createElement(y.a,null),i.a.createElement(d.EuiHeaderLink,{href:null===(n=c.services)||void 0===n||null===(r=n.application)||void 0===r?void 0:r.getUrlForApp("/integrations/browse"),color:"primary",iconType:"indexOpen"},nl))),i.a.createElement(s.Switch,null,i.a.createElement(s.Route,{path:m,component:Gs}),i.a.createElement(s.Route,{path:h,component:Lr}),i.a.createElement(s.Route,{path:p,component:Pa}),i.a.createElement(s.Route,{path:M,component:Fo}),i.a.createElement(_.a,{from:"/analysis",to:h,exact:!0}),i.a.createElement(_.a,{from:"/log-rate",to:h,exact:!0}),i.a.createElement(_.a,{from:"/",to:m,exact:!0})))},Xs=h.i18n.translate("xpack.infra.header.logsTitle",{defaultMessage:"Logs"}),el=(h.i18n.translate("xpack.infra.logs.index.streamTabTitle",{defaultMessage:"Stream"}),h.i18n.translate("xpack.infra.logs.index.anomaliesTabTitle",{defaultMessage:"Anomalies"}),h.i18n.translate("xpack.infra.logs.index.logCategoriesBetaBadgeTitle",{defaultMessage:"Categories"}),h.i18n.translate("xpack.infra.logs.index.settingsTabTitle",{defaultMessage:"Settings"})),tl="https://discuss.elastic.co/c/logs",nl=h.i18n.translate("xpack.infra.logsHeaderAddDataButtonLabel",{defaultMessage:"Add data"});var al=n(159);const il=({children:e})=>{const[t]=Object(al.b)(),{services:n}=Object(_e.b)();return i.a.createElement(x.a,{sourceId:t,fetch:n.http.fetch,indexPatternsService:n.data.indexPatterns},i.a.createElement(mt,null,e))},rl=()=>i.a.createElement(d.EuiErrorBoundary,null,i.a.createElement(il,null,i.a.createElement(Ks,null)));var ol=n(44),sl=n(174);const ll=(e,t,{element:n,history:a,setHeaderActionMenu:r})=>{const s=new l.Storage(window.localStorage);return Object(sl.b)(n,"infraLogsPage"),o.a.render(i.a.createElement(ul,{core:e,storage:s,history:a,plugins:t,setHeaderActionMenu:r}),n),()=>{o.a.unmountComponentAtNode(n)}},ul=({core:e,history:t,plugins:n,setHeaderActionMenu:a,storage:r})=>{var o;const l=e.application.capabilities;return i.a.createElement(ol.b,{core:e,plugins:n},i.a.createElement(ol.a,{appName:"Logs UI",setHeaderActionMenu:a,storage:r,triggersActionsUI:n.triggersActionsUi},i.a.createElement(s.Router,{history:t},i.a.createElement(s.Switch,null,i.a.createElement(s.Route,{path:"/link-to",component:c.a}),(null==l||null===(o=l.logs)||void 0===o?void 0:o.show)&&i.a.createElement(s.Route,{path:"/",component:rl}),i.a.createElement(s.Route,{component:u.a})))))}}}]);