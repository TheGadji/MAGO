/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.logstash_bundle_jsonpfunction=window.logstash_bundle_jsonpfunction||[]).push([[1],{21:function(e,t){ace.define("ace/mode/plain_text",["require","exports","module","ace/lib/oop","ace/mode/text","ace/mode/text_highlight_rules","ace/mode/behaviour"],(function(e,t,i){"use strict";var s=e("../lib/oop"),a=e("./text").Mode,n=e("./text_highlight_rules").TextHighlightRules,l=e("./behaviour").Behaviour,o=function(){this.HighlightRules=n,this.$behaviour=new l};s.inherits(o,a),function(){this.type="text",this.getNextLineIndent=function(e,t,i){return""},this.$id="ace/mode/plain_text"}.call(o.prototype),t.Mode=o}))},22:function(e,t){ace.define("ace/theme/github",["require","exports","module","ace/lib/dom"],(function(e,t,i){t.isDark=!1,t.cssClass="ace-github",t.cssText='.ace-github .ace_gutter {background: #e8e8e8;color: #AAA;}.ace-github  {background: #fff;color: #000;}.ace-github .ace_keyword {font-weight: bold;}.ace-github .ace_string {color: #D14;}.ace-github .ace_variable.ace_class {color: teal;}.ace-github .ace_constant.ace_numeric {color: #099;}.ace-github .ace_constant.ace_buildin {color: #0086B3;}.ace-github .ace_support.ace_function {color: #0086B3;}.ace-github .ace_comment {color: #998;font-style: italic;}.ace-github .ace_variable.ace_language  {color: #0086B3;}.ace-github .ace_paren {font-weight: bold;}.ace-github .ace_boolean {font-weight: bold;}.ace-github .ace_string.ace_regexp {color: #009926;font-weight: normal;}.ace-github .ace_variable.ace_instance {color: teal;}.ace-github .ace_constant.ace_language {font-weight: bold;}.ace-github .ace_cursor {color: black;}.ace-github.ace_focus .ace_marker-layer .ace_active-line {background: rgb(255, 255, 204);}.ace-github .ace_marker-layer .ace_active-line {background: rgb(245, 245, 245);}.ace-github .ace_marker-layer .ace_selection {background: rgb(181, 213, 255);}.ace-github.ace_multiselect .ace_selection.ace_start {box-shadow: 0 0 3px 0px white;}.ace-github.ace_nobold .ace_line > span {font-weight: normal !important;}.ace-github .ace_marker-layer .ace_step {background: rgb(252, 255, 0);}.ace-github .ace_marker-layer .ace_stack {background: rgb(164, 229, 101);}.ace-github .ace_marker-layer .ace_bracket {margin: -1px 0 0 -1px;border: 1px solid rgb(192, 192, 192);}.ace-github .ace_gutter-active-line {background-color : rgba(0, 0, 0, 0.07);}.ace-github .ace_marker-layer .ace_selected-word {background: rgb(250, 250, 255);border: 1px solid rgb(200, 200, 250);}.ace-github .ace_invisible {color: #BFBFBF}.ace-github .ace_print-margin {width: 1px;background: #e8e8e8;}.ace-github .ace_indent-guide {background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAE0lEQVQImWP4////f4bLly//BwAmVgd1/w11/gAAAABJRU5ErkJggg==") right repeat-y;}',e("../lib/dom").importCssString(t.cssText,t.cssClass)}))},23:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i(20),a=i(14),n=s.__importDefault(i(24));t.default=function(){var e=n.default();return a.useCallback((function(t){return new Promise((function(i,s){t.then((function(t){e()&&i(t)}),(function(t){e()&&s(t)}))}))}),[])}},24:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i(14);t.default=function(){var e=s.useRef(!1),t=s.useCallback((function(){return e.current}),[]);return s.useEffect((function(){return e.current=!0,function(){e.current=!1}})),t}},25:function(e,t,i){"use strict";i.r(t),i.d(t,"renderApp",(function(){return F}));var s=i(14),a=i.n(s),n=i(18),l=i.n(n),o=i(19),r=i(6),c=i(7),p=i(2),d=i.n(p),u=i(17),g=i(16),h=i(15);function b(){return Object(h.jsx)("p",null,Object(h.jsx)("strong",null,Object(h.jsx)(u.FormattedMessage,{id:"xpack.logstash.addRoleAlert.grantAdditionalPrivilegesTitle",defaultMessage:"Grant additional privileges."})),Object(h.jsx)(u.FormattedMessage,{id:"xpack.logstash.addRoleAlert.grantAdditionalPrivilegesDescription",defaultMessage:"In Kibana Management, assign the {role} role to your Kibana user.",values:{role:Object(h.jsx)(g.EuiCode,null,"monitoring_user")}}))}var m=i(1);const x={INITIAL_PAGE_SIZE:20,PAGE_SIZE_OPTIONS:[5,8,20,50],PIPELINE_NOT_CENTRALLY_MANAGED_TOOLTIP_TEXT:m.i18n.translate("xpack.logstash.pipelineNotCentrallyManagedTooltip",{defaultMessage:"This pipeline wasn't created using Centralized Configuration Management. It can't be managed or edited here."}),INFO_ALERTS:{CALL_OUT_TITLE:m.i18n.translate("xpack.logstash.kibanaManagementPipelinesTitle",{defaultMessage:"Only pipelines created in Kibana Management appear here"})}};function j(e){return Object(h.jsx)(g.EuiCallOut,{title:x.INFO_ALERTS.CALL_OUT_TITLE,color:"warning",iconType:"help"},Object(h.jsx)("p",null,Object(h.jsx)(u.FormattedMessage,{id:"xpack.logstash.alertCallOut.howToSeeAdditionalPipelinesDescription",defaultMessage:"How can I see additional pipelines?"})),e.children)}function f(){return Object(h.jsx)("p",null,Object(h.jsx)("strong",null,Object(h.jsx)(u.FormattedMessage,{id:"xpack.logstash.enableMonitoringAlert.enableMonitoringTitle",defaultMessage:"Enable monitoring."})),Object(h.jsx)(u.FormattedMessage,{id:"xpack.logstash.enableMonitoringAlert.enableMonitoringDescription",defaultMessage:"In the {configFileName} file, set {monitoringConfigParam} and {monitoringUiConfigParam} to {trueValue}.",values:{configFileName:Object(h.jsx)(g.EuiCode,null,"kibana.yml"),monitoringConfigParam:Object(h.jsx)(g.EuiCode,null,"xpack.monitoring.enabled"),monitoringUiConfigParam:Object(h.jsx)(g.EuiCode,null,"xpack.monitoring.ui.enabled"),trueValue:Object(h.jsx)(g.EuiCode,null,"true")}}))}function M({showAddRoleAlert:e,showEnableMonitoringAlert:t}){return e||t?Object(h.jsx)(j,null,e&&Object(h.jsx)(b,null),t&&Object(h.jsx)(f,null)):null}const O=Object(u.injectI18n)((function({clonePipeline:e,createPipeline:t,isReadOnly:i,isSelectable:s,message:a,onDeleteSelectedPipelines:n,onSelectionChange:l,openPipeline:o,pipelines:r,selection:c,pageIndex:p,intl:d}){const b={pageIndex:p,initialPageSize:x.INITIAL_PAGE_SIZE,totalItemCount:r.length,pageSizeOptions:x.PAGE_SIZE_OPTIONS},j=s?{selectable:({isCentrallyManaged:e})=>e,selectableMessage:(e,{id:t})=>e?d.formatMessage({id:"xpack.logstash.pipelinesTable.selectablePipelineMessage",defaultMessage:'Select pipeline "{id}"'},{id:t}):x.PIPELINE_NOT_CENTRALLY_MANAGED_TOOLTIP_TEXT,onSelectionChange:l}:null,f=c.length&&!i?Object(h.jsx)(g.EuiButton,{key:"btnDeletePipelines",color:"danger",onClick:n,"data-test-subj":"btnDeletePipeline"},Object(h.jsx)(u.FormattedMessage,{id:"xpack.logstash.pipelinesTable.deleteButtonLabel",defaultMessage:"Delete"})):null,M={box:{incremental:!0,"data-test-subj":"filter"},filters:[{type:"field_value_selection",field:"id",name:m.i18n.translate("xpack.logstash.pipelinesTable.filterByIdLabel",{defaultMessage:"Filter by ID"}),multiSelect:!1,options:r.map((({id:e})=>({value:e,name:e,view:e})))}],toolsLeft:f,toolsRight:Object(h.jsx)(g.EuiButton,{isDisabled:i,key:"btnAdd",fill:!0,onClick:t,"data-test-subj":"btnAdd"},Object(h.jsx)(u.FormattedMessage,{id:"xpack.logstash.pipelinesTable.createPipelineButtonLabel",defaultMessage:"Create pipeline"}))},O=function(e,t){return[{field:"id",name:m.i18n.translate("xpack.logstash.pipelinesTable.idColumnLabel",{defaultMessage:"Id"}),sortable:!0,render:(t,{isCentrallyManaged:i})=>i?Object(h.jsx)(g.EuiLink,{onClick:()=>e(t),"data-test-subj":"cellId"},t):Object(h.jsx)("span",null,t," Â ",Object(h.jsx)(g.EuiIconTip,{content:x.PIPELINE_NOT_CENTRALLY_MANAGED_TOOLTIP_TEXT,type:"questionInCircle"}))},{field:"description",name:m.i18n.translate("xpack.logstash.pipelinesTable.descriptionColumnLabel",{defaultMessage:"Description"}),render:e=>Object(h.jsx)("span",{"data-test-subj":"cellDescription"},e),sortable:!0,truncateText:!0},{field:"lastModifiedHumanized",name:m.i18n.translate("xpack.logstash.pipelinesTable.lastModifiedColumnLabel",{defaultMessage:"Last modified"}),render:e=>Object(h.jsx)("span",{"data-test-subj":"cellLastModified"},e),sortable:({lastModified:e})=>e.valueOf()},{field:"username",name:m.i18n.translate("xpack.logstash.pipelinesTable.modifiedByColumnLabel",{defaultMessage:"Modified by"}),render:e=>Object(h.jsx)("span",{"data-test-subj":"cellUsername"},e),sortable:!0},{field:"id",name:"",render:(e,{isCentrallyManaged:i})=>i?Object(h.jsx)(g.EuiButtonEmpty,{"data-test-subj":`lnkPipelineClone-${e}`,iconType:"copy",onClick:()=>{t(e)},size:"xs"},Object(h.jsx)(u.FormattedMessage,{id:"xpack.logstash.pipelinesTable.cloneButtonLabel",defaultMessage:"Clone"})):null,sortable:!1,width:"100px"}]}(o,e);return Object(h.jsx)(g.EuiInMemoryTable,{columns:O,"data-test-subj":"pipelineTable",isSelectable:s,itemId:"id",items:r,message:a,pagination:b,search:M,selection:j,sorting:!0,rowProps:{"data-test-subj":"row"}})}));function E({cancelDeletePipelines:e,deleteSelectedPipelines:t,selection:i,showConfirmDeleteModal:s}){if(!s)return null;const a=i.length,n=1===a?{message:Object(h.jsx)(u.FormattedMessage,{id:"xpack.logstash.confirmDeleteModal.deletedPipelineWarningMessage",defaultMessage:"You cannot recover a deleted pipeline"}),button:Object(h.jsx)(u.FormattedMessage,{id:"xpack.logstash.confirmDeleteModal.deletedPipelineConfirmButtonLabel",defaultMessage:"Delete pipeline"}),title:Object(h.jsx)(u.FormattedMessage,{id:"xpack.logstash.confirmDeleteModal.deletedPipelineTitle",defaultMessage:'Delete pipeline "{id}"',values:{id:i[0].id}})}:{message:Object(h.jsx)(u.FormattedMessage,{id:"xpack.logstash.confirmDeleteModal.deletedPipelinesWarningMessage",defaultMessage:"You cannot recover deleted pipelines."}),button:Object(h.jsx)(u.FormattedMessage,{id:"xpack.logstash.confirmDeleteModal.deletedPipelinesConfirmButtonLabel",defaultMessage:"Delete {numPipelinesSelected} pipelines",values:{numPipelinesSelected:a}}),title:Object(h.jsx)(u.FormattedMessage,{id:"xpack.logstash.confirmDeleteModal.deletedPipelinesTitle",defaultMessage:"Delete {numPipelinesSelected} pipelines",values:{numPipelinesSelected:a}})};return Object(h.jsx)(g.EuiConfirmModal,{buttonColor:"danger",cancelButtonText:Object(h.jsx)(u.FormattedMessage,{id:"xpack.logstash.confirmDeleteModal.cancelButtonLabel",defaultMessage:"Cancel"}),confirmButtonText:n.button,defaultFocusedButton:g.EUI_MODAL_CANCEL_BUTTON,onCancel:e,onConfirm:t,title:n.title},Object(h.jsx)("p",null,n.message))}class pipeline_list_PipelineListUi extends a.a.Component{constructor(e){super(e),d()(this,"componentDidMount",(()=>{const{isReadOnly:e,licenseService:t,toastNotifications:i}=this.props;this.loadPipelines().then((()=>{e&&i.addWarning(t.message)})),this.checkMonitoringAccess()})),d()(this,"getEmptyPrompt",(()=>Object(h.jsx)(g.EuiEmptyPrompt,{title:Object(h.jsx)("h2",null,Object(h.jsx)(u.FormattedMessage,{id:"xpack.logstash.pipelineList.noPipelinesTitle",defaultMessage:"No pipelines"})),titleSize:"xs",body:Object(h.jsx)(u.FormattedMessage,{id:"xpack.logstash.pipelineList.noPipelinesDescription",defaultMessage:"There are no pipelines defined."})}))),d()(this,"getErrorPrompt",(()=>Object(h.jsx)(g.EuiEmptyPrompt,{title:Object(h.jsx)("h2",null,Object(h.jsx)(u.FormattedMessage,{id:"xpack.logstash.pipelineList.pipelinesLoadingErrorTitle",defaultMessage:"Error"})),titleSize:"xs",body:Object(h.jsx)(u.FormattedMessage,{id:"xpack.logstash.pipelineList.pipelinesLoadingErrorDescription",defaultMessage:"Error encountered while loading pipelines."})}))),d()(this,"loadPipelines",(()=>{const{isReadOnly:e,licenseService:t,pipelinesService:i,toastNotifications:s,intl:a}=this.props;return this.setState({message:Object(h.jsx)("div",{"data-test-subj":"loadingPipelines"},Object(h.jsx)(g.EuiLoadingSpinner,{size:"m"}),"Â "," ",Object(h.jsx)(u.FormattedMessage,{id:"xpack.logstash.pipelineList.pipelinesLoadingMessage",defaultMessage:"Loading pipelinesâ¦"}))}),i.getPipelineList().then((e=>{this.setState({isLoading:!1,isForbidden:!1,isSelectable:!0,pipelines:e}),e.length||this.setState({columns:[],message:this.getEmptyPrompt(),isSelectable:!1})})).catch((i=>(this.setState({isLoading:!1,message:this.getErrorPrompt()}),t.checkValidity().then((()=>{403===i.status?(this.setState({isLoading:!1}),e?this.setState({isForbidden:!1}):this.setState({isForbidden:!0})):(this.setState({isForbidden:!1}),s.addDanger(a.formatMessage({id:"xpack.logstash.pipelineList.pipelineLoadingErrorNotification",defaultMessage:'Couldn\'t load pipeline. Error: "{errStatusText}".'},{errStatusText:i.statusText})))})))))})),d()(this,"checkMonitoringAccess",(()=>{const{clusterService:e,monitoringService:t}=this.props;e.isClusterInfoAvailable().then((e=>{this.setState({showAddRoleAlert:!e,showEnableMonitoringAlert:!t.isMonitoringEnabled()})}))})),d()(this,"renderNoPermissionCallOut",(()=>{const{isForbidden:e,isLoading:t}=this.state;return e&&!t?Object(h.jsx)(g.EuiCallOut,{color:"danger",iconType:"cross",title:Object(h.jsx)(u.FormattedMessage,{id:"xpack.logstash.pipelineList.noPermissionToManageTitle",defaultMessage:"You do not have permission to manage Logstash pipelines."})},Object(h.jsx)("p",null,Object(h.jsx)(u.FormattedMessage,{id:"xpack.logstash.pipelineList.noPermissionToManageDescription",defaultMessage:"Please contact your administrator."}))):null})),d()(this,"hideDeletePipelinesModal",(()=>{this.setState({showConfirmDeleteModal:!1})})),d()(this,"showDeletePipelinesModal",(()=>{this.setState({showConfirmDeleteModal:!0})})),d()(this,"cancelDeletePipelines",(()=>{this.hideDeletePipelinesModal()})),d()(this,"deleteSelectedPipelines",(()=>{this.hideDeletePipelinesModal();const{licenseService:e,pipelinesService:t,toastNotifications:i,intl:s}=this.props,{selection:a}=this.state,n=a.length,l=a.map((({id:e})=>e));return t.deletePipelines(l).then((e=>{const{numSuccesses:t,numErrors:l}=e;if(1===t&&0===l)i.addSuccess(s.formatMessage({id:"xpack.logstash.pipelineList.pipelinesSuccessfullyDeletedNotification",defaultMessage:'Deleted "{id}"'},{id:a[0].id}));else if(t){let e;l&&(e=s.formatMessage({id:"xpack.logstash.pipelineList.pipelinesCouldNotBeDeletedDescription",defaultMessage:"But {numErrors, plural, one {# Pipeline} other {# Pipelines}} couldn't be deleted."},{numErrors:l})),i.addSuccess({title:s.formatMessage({id:"xpack.logstash.pipelineList.successfullyDeletedPipelinesNotification",defaultMessage:"Deleted {numSuccesses} out of {numPipelinesSelected, plural, one {# Pipeline} other {# Pipelines}}"},{numSuccesses:t,numPipelinesSelected:n,numPipelinesSelected:n}),text:e})}else l&&i.addError(s.formatMessage({id:"xpack.logstash.pipelineList.couldNotDeletePipelinesNotification",defaultMessage:"Failed to delete {numErrors, plural, one {# Pipeline} other {# Pipelines}}"},{numErrors:l}));this.loadPipelines()})).catch((t=>e.checkValidity().then((()=>i.addDanger(t)))))})),d()(this,"onDeleteSelectedPipelines",(()=>{this.showDeletePipelinesModal()})),d()(this,"onSelectionChange",(e=>this.setState({selection:e}))),this.state={columns:[],isForbidden:!1,isLoading:!0,isSelectable:!1,pipelines:[],showAddRoleAlert:!1,showConfirmDeleteModal:!1,showEnableMonitoringAlert:!1,selection:[]}}render(){const{clonePipeline:e,createPipeline:t,isReadOnly:i,openPipeline:s}=this.props,{isSelectable:a,message:n,pipelines:l,selection:o,showConfirmDeleteModal:r}=this.state;return Object(h.jsx)(g.EuiPageContentBody,{"data-test-subj":"pipelineList"},Object(h.jsx)(g.EuiPageHeader,{pageTitle:Object(h.jsx)(u.FormattedMessage,{id:"xpack.logstash.pipelineList.head",defaultMessage:"Pipelines"}),description:Object(h.jsx)(u.FormattedMessage,{id:"xpack.logstash.pipelineList.subhead",defaultMessage:"Manage logstash event processing and see the result visually"}),bottomBorder:!0}),Object(h.jsx)(g.EuiSpacer,{size:"l"}),this.renderNoPermissionCallOut(),Object(h.jsx)(O,{clonePipeline:e,createPipeline:t,isReadOnly:i,isSelectable:a,message:n,pipelines:l,selection:o,onDeleteSelectedPipelines:this.onDeleteSelectedPipelines,onSelectionChange:this.onSelectionChange,openPipeline:s}),Object(h.jsx)(E,{cancelDeletePipelines:this.cancelDeletePipelines,deleteSelectedPipelines:this.deleteSelectedPipelines,selection:o,showConfirmDeleteModal:r}),Object(h.jsx)(M,{showAddRoleAlert:this.state.showAddRoleAlert,showEnableMonitoringAlert:this.state.showEnableMonitoringAlert}))}}const P=Object(u.injectI18n)(pipeline_list_PipelineListUi);var y=i(23),C=i.n(y),k=(i(21),i(22),i(0)),S=i(5);const _={DELETE_PIPELINE_MODAL_MESSAGE:m.i18n.translate("xpack.logstash.deletePipelineModalMessage",{defaultMessage:"You cannot recover a deleted pipeline."}),ID_REQUIRED_ERR_MSG:m.i18n.translate("xpack.logstash.pipelineIdRequiredMessage",{defaultMessage:"Pipeline ID is required"}),ID_FORMAT_ERR_MSG:m.i18n.translate("xpack.logstash.idFormatErrorMessage",{defaultMessage:"Pipeline ID must begin with a letter or underscore and contain only letters, underscores, dashes, and numbers"}),QUEUE_TYPES:[{"data-test-subj":"selectQueueType-memory",text:m.i18n.translate("xpack.logstash.queueTypes.memoryLabel",{defaultMessage:"memory"}),value:"memory"},{"data-test-subj":"selectQueueType-persisted",text:m.i18n.translate("xpack.logstash.queueTypes.persistedLabel",{defaultMessage:"persisted"}),value:"persisted"}],UNITS:[{"data-test-subj":"selectQueueMaxBytesUnits-b",text:m.i18n.translate("xpack.logstash.units.bytesLabel",{defaultMessage:"bytes"}),value:"b"},{"data-test-subj":"selectQueueMaxBytesUnits-kb",text:m.i18n.translate("xpack.logstash.units.kilobytesLabel",{defaultMessage:"kilobytes"}),value:"kb"},{"data-test-subj":"selectQueueMaxBytesUnits-mb",text:m.i18n.translate("xpack.logstash.units.megabytesLabel",{defaultMessage:"megabytes"}),value:"mb"},{"data-test-subj":"selectQueueMaxBytesUnits-gb",text:m.i18n.translate("xpack.logstash.units.gigabytesLabel",{defaultMessage:"gigabytes"}),value:"gb"},{"data-test-subj":"selectQueueMaxBytesUnits-tb",text:m.i18n.translate("xpack.logstash.units.terabytesLabel",{defaultMessage:"terabytes"}),value:"tb"},{"data-test-subj":"selectQueueMaxBytesUnits-pb",text:m.i18n.translate("xpack.logstash.units.petabytesLabel",{defaultMessage:"petabytes"}),value:"pb"}]};function T({id:e,cancelDeleteModal:t,confirmDeletePipeline:i}){return Object(h.jsx)(g.EuiConfirmModal,{buttonColor:"danger",cancelButtonText:Object(h.jsx)(u.FormattedMessage,{id:"xpack.logstash.confirmDeletePipelineModal.cancelButtonText",defaultMessage:"Cancel"}),confirmButtonText:Object(h.jsx)(u.FormattedMessage,{id:"xpack.logstash.confirmDeletePipelineModal.confirmButtonText",defaultMessage:"Delete pipeline"}),defaultFocusedButton:g.EUI_MODAL_CANCEL_BUTTON,onCancel:t,onConfirm:i,title:Object(h.jsx)(u.FormattedMessage,{id:"xpack.logstash.confirmDeletePipelineModal.deletePipelineTitle",defaultMessage:"Delete pipeline {id}",values:{id:e}})},Object(h.jsx)("p",null,_.DELETE_PIPELINE_MODAL_MESSAGE))}function w({formRowLabelText:e,formRowTooltipText:t}){return Object(h.jsx)("div",null,Object(h.jsx)("span",null,e),"Â ",Object(h.jsx)(g.EuiIconTip,{content:t,size:"s",type:"questionInCircle"}))}function L(e){const{formRowLabelText:t,formRowTooltipText:i}=e,s=t&&i?Object(h.jsx)(w,{formRowLabelText:t,formRowTooltipText:i}):null;return Object(h.jsx)(g.EuiFlexItem,{grow:!1},Object(h.jsx)(g.EuiFormRow,{label:s,hasEmptyLabelSpace:!s},e.children))}class pipeline_editor_PipelineEditorUi extends a.a.Component{constructor(e){super(e),d()(this,"componentDidMount",(()=>{const{licenseService:{isReadOnly:e,message:t},toastNotifications:i}=this.props;e&&i.addWarning(t)})),d()(this,"hideConfirmDeleteModal",(()=>{this.setState({showConfirmDeleteModal:!1})})),d()(this,"showConfirmDeleteModal",(()=>{this.setState({showConfirmDeleteModal:!0})})),d()(this,"onPipelineIdChange",(({target:{value:e}})=>{const t=[];e||t.push(_.ID_REQUIRED_ERR_MSG),this.state.pipelineIdPattern.test(e)||t.push(_.ID_FORMAT_ERR_MSG),this.setState({pipelineIdErrors:t,showPipelineIdError:!!t.length,pipeline:{...this.state.pipeline,id:e}})})),d()(this,"isSaveDisabled",(()=>this.state.showPipelineIdError||Object(k.isEmpty)(this.state.pipeline.id))),d()(this,"onClose",(async()=>{await this.props.close()})),d()(this,"open",(async()=>{const{id:e}=this.state.pipeline;e&&await this.props.open(e)})),d()(this,"onPipelineSave",(()=>{const{pipelineService:e,toastNotifications:t,intl:i}=this.props,{id:s,...a}=this.state.pipeline;return e.savePipeline({id:s,upstreamJSON:a}).then((()=>{t.addSuccess(i.formatMessage({id:"xpack.logstash.pipelineEditor.pipelineSuccessfullySavedMessage",defaultMessage:'Saved "{id}"'},{id:s})),this.onClose()})).catch(this.notifyOnError)})),d()(this,"onPipelineDescriptionChange",(({target:{value:e}})=>{this.setState({pipeline:{...this.state.pipeline,description:e}})})),d()(this,"onPipelineChange",(e=>{this.setState({pipeline:{...this.state.pipeline,pipeline:e}})})),d()(this,"handleNumberChange",((e,t)=>{const i=parseInt(t,10);this.handleSettingChange(e,isNaN(i)?t:i)})),d()(this,"handleMaxByteNumberChange",(e=>{this.setState({maxBytesNumber:parseInt(e,10)}),this.handleSettingChange("queue.max_bytes",e+this.state.maxBytesUnit)})),d()(this,"handleMaxByteUnitChange",(e=>{this.setState({maxBytesUnit:e}),this.handleSettingChange("queue.max_bytes",this.state.maxBytesNumber+e)})),d()(this,"handleSettingChange",((e,t)=>{const i={...this.state.pipeline.settings};i[e]=t,this.setState({pipeline:{...this.state.pipeline,settings:i}})})),d()(this,"notifyOnError",(e=>{const{licenseService:t,toastNotifications:i}=this.props;return t.checkValidity().then((()=>{i.addError(e,{title:m.i18n.translate("xpack.logstash.pipelineEditor.errorHandlerToastTitle",{defaultMessage:"Pipeline error"})})}))})),d()(this,"deletePipeline",(()=>{const{pipeline:{id:e},pipelineService:t,toastNotifications:i,intl:s}=this.props;return this.hideConfirmDeleteModal(),t.deletePipeline(e).then((()=>{i.addSuccess(s.formatMessage({id:"xpack.logstash.pipelineEditor.pipelineSuccessfullyDeletedMessage",defaultMessage:'Deleted "{id}"'},{id:e})),this.onClose()})).catch(this.notifyOnError)})),d()(this,"getPipelineHeadingText",(()=>{const{clone:e,id:t,isNewPipeline:i,intl:s}=this.props;return e&&t?s.formatMessage({id:"xpack.logstash.pipelineEditor.clonePipelineTitle",defaultMessage:'Clone Pipeline "{id}"'},{id:t}):i?s.formatMessage({id:"xpack.logstash.pipelineEditor.createPipelineTitle",defaultMessage:"Create Pipeline"}):s.formatMessage({id:"xpack.logstash.pipelineEditor.editPipelineTitle",defaultMessage:'Edit Pipeline "{id}"'},{id:this.state.pipeline.id})}));const{pipeline:{id:t,description:i,pipeline:s,settings:a}}=this.props,n="number"==typeof a["pipeline.workers"]?a["pipeline.workers"]:1;this.state={maxBytesNumber:a["queue.max_bytes.number"],maxBytesUnit:a["queue.max_bytes.units"],pipeline:{id:t,description:i,pipeline:s,settings:{"pipeline.batch.delay":a["pipeline.batch.delay"],"pipeline.batch.size":a["pipeline.batch.size"],"pipeline.workers":n,"queue.checkpoint.writes":a["queue.checkpoint.writes"],"queue.max_bytes":a["queue.max_bytes.number"]+a["queue.max_bytes.units"],"queue.type":a["queue.type"]}},pipelineIdErrors:[],pipelineIdPattern:/^[A-Za-z\_][A-Za-z0-9\-\_]*$/,showConfirmDeleteModal:!1,showPipelineIdError:!1}}render(){const{intl:e}=this.props;return Object(h.jsx)(g.EuiPageContentBody,{style:{width:"100%"},restrictWidth:!0,"data-test-subj":`pipelineEdit pipelineEdit-${this.state.pipeline.id}`},Object(h.jsx)(g.EuiPageHeader,{pageTitle:this.getPipelineHeadingText(),bottomBorder:!0}),Object(h.jsx)(g.EuiSpacer,{size:"l"}),Object(h.jsx)(g.EuiForm,{isInvalid:this.state.showPipelineIdError,error:this.state.pipelineIdErrors},this.props.isNewPipeline&&Object(h.jsx)(g.EuiFormRow,{fullWidth:!0,label:Object(h.jsx)(u.FormattedMessage,{id:"xpack.logstash.pipelineEditor.pipelineIdFormRowLabel",defaultMessage:"Pipeline ID"})},Object(h.jsx)(g.EuiFieldText,{fullWidth:!0,"data-test-subj":"inputId",isInvalid:this.state.showPipelineIdError,name:"pipelineId",onBlur:this.onPipelineIdChange,onChange:this.onPipelineIdChange,value:this.state.pipeline.id||""})),Object(h.jsx)(g.EuiFormRow,{fullWidth:!0,label:Object(h.jsx)(u.FormattedMessage,{id:"xpack.logstash.pipelineEditor.descriptionFormRowLabel",defaultMessage:"Description"})},Object(h.jsx)(g.EuiFieldText,{"data-test-subj":"inputDescription",fullWidth:!0,name:"pipelineDescription",onChange:this.onPipelineDescriptionChange,value:this.state.pipeline.description||""})),Object(h.jsx)(g.EuiFormRow,{fullWidth:!0,label:Object(h.jsx)(u.FormattedMessage,{id:"xpack.logstash.pipelineEditor.pipelineFormRowLabel",defaultMessage:"Pipeline"})},Object(h.jsx)("div",{"data-test-subj":"acePipeline"},Object(h.jsx)(g.EuiCodeEditor,{mode:"plain_text",onChange:this.onPipelineChange,setOptions:{minLines:25,maxLines:1/0,readOnly:this.props.licenseService.isReadOnly},theme:"github",value:this.state.pipeline.pipeline,width:"1017"}))),Object(h.jsx)(g.EuiFormRow,{label:Object(h.jsx)(w,{formRowLabelText:e.formatMessage({id:"xpack.logstash.pipelineEditor.pipelineWorkersFormRowLabel",defaultMessage:"Pipeline workers"}),formRowTooltipText:S.a.settings["pipeline.workers"]})},Object(h.jsx)(g.EuiFieldNumber,{"data-test-subj":"inputWorkers",onChange:e=>this.handleNumberChange("pipeline.workers",e.target.value),value:this.state.pipeline.settings["pipeline.workers"]})),Object(h.jsx)(g.EuiSpacer,null),Object(h.jsx)(g.EuiFlexGroup,null,Object(h.jsx)(L,{formRowLabelText:e.formatMessage({id:"xpack.logstash.pipelineEditor.pipelineBatchSizeFormRowLabel",defaultMessage:"Pipeline batch size"}),formRowTooltipText:S.a.settings["pipeline.batch.size"]},Object(h.jsx)(g.EuiFieldNumber,{"data-test-subj":"inputBatchSize",onChange:e=>this.handleNumberChange("pipeline.batch.size",e.target.value),value:this.state.pipeline.settings["pipeline.batch.size"]})),Object(h.jsx)(L,{formRowLabelText:e.formatMessage({id:"xpack.logstash.pipelineEditor.pipelineBatchDelayFormRowLabel",defaultMessage:"Pipeline batch delay"}),formRowTooltipText:S.a.settings["pipeline.batch.delay"]},Object(h.jsx)(g.EuiFieldNumber,{"data-test-subj":"inputBatchDelay",onChange:e=>this.handleNumberChange("pipeline.batch.delay",e.target.value),value:this.state.pipeline.settings["pipeline.batch.delay"]}))),Object(h.jsx)(g.EuiFlexGroup,null,Object(h.jsx)(L,{formRowLabelText:e.formatMessage({id:"xpack.logstash.pipelineEditor.queueTypeFormRowLabel",defaultMessage:"Queue type"}),formRowTooltipText:S.a.settings["queue.type"]},Object(h.jsx)(g.EuiSelect,{"data-test-subj":"selectQueueType",onChange:e=>this.handleSettingChange("queue.type",e.target.value),options:_.QUEUE_TYPES,value:this.state.pipeline.settings["queue.type"]})),Object(h.jsx)(L,{formRowLabelText:e.formatMessage({id:"xpack.logstash.pipelineEditor.queueMaxBytesFormRowLabel",defaultMessage:"Queue max bytes"}),formRowTooltipText:S.a.settings["queue.max_bytes"]},Object(h.jsx)(g.EuiFieldNumber,{"data-test-subj":"inputQueueMaxBytesNumber",onChange:e=>this.handleMaxByteNumberChange(e.target.value),value:this.state.maxBytesNumber})),Object(h.jsx)(L,null,Object(h.jsx)(g.EuiSelect,{"data-test-subj":"selectQueueMaxBytesUnits",onChange:e=>this.handleMaxByteUnitChange(e.target.value),options:_.UNITS,value:this.state.maxBytesUnit})),Object(h.jsx)(L,{formRowLabelText:e.formatMessage({id:"xpack.logstash.pipelineEditor.queueCheckpointWritesFormRowLabel",defaultMessage:"Queue checkpoint writes"}),formRowTooltipText:S.a.settings["queue.checkpoint.writes"]},Object(h.jsx)(g.EuiFieldNumber,{"data-test-subj":"inputQueueCheckpointWrites",onChange:e=>this.handleNumberChange("queue.checkpoint.writes",e.target.value),value:this.state.pipeline.settings["queue.checkpoint.writes"]})))),Object(h.jsx)(g.EuiSpacer,{size:"l"}),Object(h.jsx)(g.EuiFlexGroup,{justifyContent:"flexStart"},Object(h.jsx)(g.EuiFlexItem,{grow:!1},Object(h.jsx)(g.EuiButton,{"data-test-subj":"btnSavePipeline",fill:!0,isDisabled:this.isSaveDisabled(),onClick:this.onPipelineSave},Object(h.jsx)(u.FormattedMessage,{id:"xpack.logstash.pipelineEditor.createAndDeployButtonLabel",defaultMessage:"Create and deploy"}))),Object(h.jsx)(g.EuiFlexItem,{grow:!1},Object(h.jsx)(g.EuiButton,{"data-test-subj":"btnCancel",onClick:this.onClose},Object(h.jsx)(u.FormattedMessage,{id:"xpack.logstash.pipelineEditor.cancelButtonLabel",defaultMessage:"Cancel"}))),!this.props.isNewPipeline&&Object(h.jsx)(g.EuiFlexItem,{grow:!1},Object(h.jsx)(g.EuiButtonEmpty,{color:"danger","data-test-subj":"btnDeletePipeline",onClick:this.showConfirmDeleteModal},Object(h.jsx)(u.FormattedMessage,{id:"xpack.logstash.pipelineEditor.deletePipelineButtonLabel",defaultMessage:"Delete pipeline"})))),this.state.showConfirmDeleteModal&&Object(h.jsx)(T,{id:this.props.pipeline.id,cancelDeleteModal:this.hideConfirmDeleteModal,confirmDeletePipeline:this.deletePipeline}))}}const D=Object(u.injectI18n)(pipeline_editor_PipelineEditorUi);var v=i(8);function I(){return[{text:m.i18n.translate("xpack.logstash.pipelines.listBreadcrumb",{defaultMessage:"Pipelines"}),href:"#/management/ingest/pipelines"}]}const A=({pipelineService:e,logstashLicenseService:t,toasts:i,history:a,setBreadcrumbs:n,id:l})=>{const o=""===new URLSearchParams(a.location.search).get("clone"),r=((e,t,i,a,n)=>{const l=C()(),[o,r]=Object(s.useState)(null);return Object(s.useLayoutEffect)((()=>{(async()=>{if(!n)return r(new v.a);try{const t=await l(e.loadPipeline(n));r(a?t.clone:t)}catch(e){await t.checkValidity(),403!==e.status&&i.addDanger(m.i18n.translate("xpack.logstash.couldNotLoadPipelineErrorNotification",{defaultMessage:"Couldn't load pipeline. Error: '{errStatusText}'.",values:{errStatusText:e.statusText}}))}})()}),[e,n,l,a,t,i]),o})(e,t,i,o,l),c=Object(s.useCallback)((()=>{a.push("/")}),[a]),p=Object(s.useCallback)((e=>{a.push(`/pipeline/${e}/edit`)}),[a]);if(!r)return null;const d=!r.id;var u;return n(d?[...I(),{text:m.i18n.translate("xpack.logstash.pipelines.createBreadcrumb",{defaultMessage:"Create"})}]:(u=r.id,[...I(),{text:u}])),Object(h.jsx)(D,{id:l,clone:o,close:c,open:p,isNewPipeline:d,pipeline:r,pipelineService:e,toastNotifications:i,licenseService:t})},F=async(e,{history:t,element:i,setBreadcrumbs:s},a,n)=>{const p=await n.pipe(Object(r.first)()).toPromise(),d=new c.a(e.http),u=new c.c(e.http,a,d),g=new c.e(e.http,u),b=new c.d(e.http,g);return l.a.render(Object(h.jsx)(e.i18n.Context,null,Object(h.jsx)(o.Router,{history:t},Object(h.jsx)(o.Switch,null,Object(h.jsx)(o.Route,{path:["/",""],exact:!0,render:()=>(s(I()),Object(h.jsx)(P,{clusterService:d,isReadOnly:p.isReadOnly,isForbidden:!0,isLoading:!1,licenseService:p,monitoringService:u,openPipeline:e=>t.push(`/pipeline/${e}/edit`),clonePipeline:e=>t.push(`/pipeline/${e}/edit?clone`),createPipeline:()=>t.push("pipeline/new-pipeline"),pipelinesService:g,toastNotifications:e.notifications.toasts}))}),Object(h.jsx)(o.Route,{path:"/pipeline/new-pipeline",exact:!0,render:()=>Object(h.jsx)(A,{history:t,setBreadcrumbs:s,logstashLicenseService:p,pipelineService:b,toasts:e.notifications.toasts})}),Object(h.jsx)(o.Route,{path:"/pipeline/:id",exact:!0,render:({match:e})=>Object(h.jsx)(o.Redirect,{to:`/pipeline/${e.params.id}/edit`})}),Object(h.jsx)(o.Route,{path:"/pipeline/:id/edit",exact:!0,render:({match:i})=>Object(h.jsx)(A,{history:t,setBreadcrumbs:s,logstashLicenseService:p,pipelineService:b,toasts:e.notifications.toasts,id:i.params.id})})))),i),()=>{l.a.unmountComponentAtNode(i)}}}}]);