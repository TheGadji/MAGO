/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.triggersActionsUi_bundle_jsonpfunction=window.triggersActionsUi_bundle_jsonpfunction||[]).push([[62],{265:function(e,t,i){"use strict";i.r(t),i.d(t,"default",(function(){return g}));var s=i(1),n=i.n(s),c=i(13),o=i(36),a=i(59),l=i(74),r=i(77),u=i(102),b=i(78),d=i(73),j=i(5);const m=["urgency","severity","impact","category","subcategory"],O={category:[],subcategory:[],urgency:[],severity:[],impact:[],priority:[]},g=({actionConnector:e,actionParams:t,editAction:i,index:g,errors:p,messageVariables:x})=>{var E,v,h,y,A,f,S,_,I,L;const{docLinks:F,http:P,notifications:{toasts:C}}=Object(a.b)().services,R=Object(s.useRef)(null!==(E=null==e?void 0:e.id)&&void 0!==E?E:""),{incident:T,comments:N}=Object(s.useMemo)((()=>{var e;return null!==(e=t.subActionParams)&&void 0!==e?e:{incident:{},comments:[]}}),[t.subActionParams]),[w,W]=Object(s.useState)(O),V=Object(s.useCallback)(((e,t)=>{const s="comments"!==e?{incident:{...T,[e]:t},comments:N}:{incident:T,[e]:t};i("subActionParams",s,g)}),[N,i,T,g]),M=Object(s.useCallback)(((e,t)=>{t.length>0&&V(e,[{commentId:"1",comment:t}])}),[V]),B=Object(s.useCallback)((e=>{W(e.reduce(((e,t)=>({...e,[t.element]:[...null!=e[t.element]?e[t.element]:[],t]})),O))}),[]),k=Object(s.useMemo)((()=>Object(b.b)(w.category)),[w.category]),z=Object(s.useMemo)((()=>Object(b.b)(w.urgency)),[w.urgency]),G=Object(s.useMemo)((()=>Object(b.b)(w.severity)),[w.severity]),D=Object(s.useMemo)((()=>Object(b.b)(w.impact)),[w.impact]),U=Object(s.useMemo)((()=>Object(b.b)(w.subcategory.filter((e=>e.dependent_value===T.category)))),[w.subcategory,T.category]),{isLoading:Y}=Object(u.a)({http:P,toastNotifications:C,actionConnector:e,fields:m,onSuccess:B});return Object(s.useEffect)((()=>{null!=e&&R.current!==e.id&&(R.current=e.id,i("subActionParams",{incident:{correlation_id:b.a},comments:[]},g))}),[e]),Object(s.useEffect)((()=>{t.subAction||i("subAction","pushToService",g),t.subActionParams||i("subActionParams",{incident:{correlation_id:b.a},comments:[]},g)}),[t]),Object(j.jsx)(n.a.Fragment,null,Object(j.jsx)(c.EuiTitle,{size:"s"},Object(j.jsx)("h3",null,d.INCIDENT)),Object(j.jsx)(c.EuiSpacer,{size:"m"}),Object(j.jsx)(c.EuiFormRow,{fullWidth:!0,label:d.URGENCY_LABEL},Object(j.jsx)(c.EuiSelect,{fullWidth:!0,"data-test-subj":"urgencySelect",hasNoInitialSelection:!0,isLoading:Y,disabled:Y,options:z,value:null!==(v=T.urgency)&&void 0!==v?v:"",onChange:e=>V("urgency",e.target.value)})),Object(j.jsx)(c.EuiSpacer,{size:"m"}),Object(j.jsx)(c.EuiFlexGroup,null,Object(j.jsx)(c.EuiFlexItem,null,Object(j.jsx)(c.EuiFormRow,{fullWidth:!0,label:d.SEVERITY_LABEL},Object(j.jsx)(c.EuiSelect,{fullWidth:!0,"data-test-subj":"severitySelect",hasNoInitialSelection:!0,isLoading:Y,disabled:Y,options:G,value:null!==(h=T.severity)&&void 0!==h?h:"",onChange:e=>V("severity",e.target.value)}))),Object(j.jsx)(c.EuiFlexItem,null,Object(j.jsx)(c.EuiFormRow,{fullWidth:!0,label:d.IMPACT_LABEL},Object(j.jsx)(c.EuiSelect,{fullWidth:!0,"data-test-subj":"impactSelect",hasNoInitialSelection:!0,isLoading:Y,disabled:Y,options:D,value:null!==(y=T.impact)&&void 0!==y?y:"",onChange:e=>V("impact",e.target.value)})))),Object(j.jsx)(c.EuiSpacer,{size:"m"}),Object(j.jsx)(c.EuiFlexGroup,null,Object(j.jsx)(c.EuiFlexItem,null,Object(j.jsx)(c.EuiFormRow,{fullWidth:!0,label:d.CATEGORY_LABEL},Object(j.jsx)(c.EuiSelect,{fullWidth:!0,"data-test-subj":"categorySelect",hasNoInitialSelection:!0,isLoading:Y,disabled:Y,options:k,value:null!==(A=T.category)&&void 0!==A?A:void 0,onChange:e=>{i("subActionParams",{incident:{...T,category:e.target.value,subcategory:null},comments:N},g)}}))),Object(j.jsx)(c.EuiFlexItem,null,Object(j.jsx)(c.EuiFormRow,{fullWidth:!0,label:d.SUBCATEGORY_LABEL},Object(j.jsx)(c.EuiSelect,{fullWidth:!0,"data-test-subj":"subcategorySelect",hasNoInitialSelection:!0,isLoading:Y,disabled:Y,options:U,value:null!==(f=T.subcategory)&&void 0!==f?f:"",onChange:e=>V("subcategory",e.target.value)})))),Object(j.jsx)(c.EuiSpacer,{size:"m"}),!Object(b.c)(e)&&Object(j.jsx)(n.a.Fragment,null,Object(j.jsx)(c.EuiFlexGroup,null,Object(j.jsx)(c.EuiFlexItem,null,Object(j.jsx)(c.EuiFormRow,{fullWidth:!0,label:d.CORRELATION_ID,helpText:Object(j.jsx)(c.EuiLink,{href:F.links.alerting.serviceNowAction,target:"_blank"},Object(j.jsx)(o.FormattedMessage,{id:"xpack.triggersActionsUI.components.builtinActionTypes.serviceNowAction.correlationIDHelpLabel",defaultMessage:"Identifier for updating incidents"}))},Object(j.jsx)(r.a,{index:g,editAction:V,messageVariables:x,paramsProperty:"correlation_id",inputTargetValue:null!==(S=null==T?void 0:T.correlation_id)&&void 0!==S?S:void 0}))),Object(j.jsx)(c.EuiFlexItem,null,Object(j.jsx)(c.EuiFormRow,{fullWidth:!0,label:d.CORRELATION_DISPLAY},Object(j.jsx)(r.a,{index:g,editAction:V,messageVariables:x,paramsProperty:"correlation_display",inputTargetValue:null!==(_=null==T?void 0:T.correlation_display)&&void 0!==_?_:void 0})))),Object(j.jsx)(c.EuiSpacer,{size:"m"})),Object(j.jsx)(c.EuiFlexGroup,null,Object(j.jsx)(c.EuiFlexItem,null,Object(j.jsx)(c.EuiFormRow,{fullWidth:!0,error:p["subActionParams.incident.short_description"],isInvalid:void 0!==p["subActionParams.incident.short_description"]&&p["subActionParams.incident.short_description"].length>0&&void 0!==T.short_description,label:d.SHORT_DESCRIPTION_LABEL},Object(j.jsx)(r.a,{index:g,editAction:V,messageVariables:x,paramsProperty:"short_description",inputTargetValue:null!==(I=null==T?void 0:T.short_description)&&void 0!==I?I:void 0,errors:p["subActionParams.incident.short_description"]})))),Object(j.jsx)(c.EuiSpacer,{size:"m"}),Object(j.jsx)(l.a,{index:g,editAction:V,messageVariables:x,paramsProperty:"description",inputTargetValue:null!==(L=T.description)&&void 0!==L?L:void 0,label:d.DESCRIPTION_LABEL}),Object(j.jsx)(l.a,{index:g,editAction:M,messageVariables:x,paramsProperty:"comments",inputTargetValue:N&&N.length>0?N[0].comment:void 0,label:d.COMMENTS_LABEL}))}}}]);