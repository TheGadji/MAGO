/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.cases_bundle_jsonpfunction=window.cases_bundle_jsonpfunction||[]).push([[8],{176:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return v}));var a=n(2),l=n.n(a),i=n(6),c=n(15),r=n(3),o=n(20),s=n(55),u=n(93),d=n(81),m=n(49),g=n(63);const f=["urgency","severity","impact","category","subcategory"],p={urgency:[],severity:[],impact:[],category:[],subcategory:[]},v=({isEdit:e=!0,fields:t,connector:n,onChange:v})=>{const b=Object(a.useRef)(!0),{severity:E=null,urgency:y=null,impact:j=null,category:h=null,subcategory:O=null}=null!=t?t:{},{http:S,notifications:I}=Object(o.d)().services,[w,x]=Object(a.useState)(p),C=Object(a.useMemo)((()=>null!=Object(m.a)(n)),[n]),F=Object(a.useMemo)((()=>Object(d.a)(w.category)),[w.category]),T=Object(a.useMemo)((()=>Object(d.a)(w.urgency)),[w.urgency]),M=Object(a.useMemo)((()=>Object(d.a)(w.severity)),[w.severity]),N=Object(a.useMemo)((()=>Object(d.a)(w.impact)),[w.impact]),W=Object(a.useMemo)((()=>Object(d.a)(w.subcategory.filter((e=>e.dependent_value===h)))),[w.subcategory,h]),R=Object(a.useMemo)((()=>{var e,t,n,a,l;return[...null!=y&&y.length>0?[{title:c.m,description:null===(e=T.find((e=>`${e.value}`===y)))||void 0===e?void 0:e.text}]:[],...null!=E&&E.length>0?[{title:c.j,description:null===(t=M.find((e=>`${e.value}`===E)))||void 0===t?void 0:t.text}]:[],...null!=j&&j.length>0?[{title:c.f,description:null===(n=N.find((e=>`${e.value}`===j)))||void 0===n?void 0:n.text}]:[],...null!=h&&h.length>0?[{title:c.c,description:null===(a=F.find((e=>`${e.value}`===h)))||void 0===a?void 0:a.text}]:[],...null!=O&&O.length>0?[{title:c.l,description:null===(l=W.find((e=>`${e.value}`===O)))||void 0===l?void 0:l.text}]:[]]}),[h,F,j,N,E,M,O,W,y,T]),{isLoading:L}=Object(u.a)({http:S,toastNotifications:I.toasts,connector:n,fields:f,onSuccess:e=>{x(e.reduce(((e,t)=>({...e,[t.element]:[...null!=e[t.element]?e[t.element]:[],t]})),p))}}),A=Object(a.useCallback)(((e,n)=>{v({...t,[e]:n})}),[t,v]);return Object(a.useEffect)((()=>{b.current&&(b.current=!1,v({urgency:y,severity:E,impact:j,category:h,subcategory:O}))}),[h,j,v,E,O,y]),l.a.createElement(l.a.Fragment,null,C&&l.a.createElement(i.EuiFlexGroup,null,l.a.createElement(i.EuiFlexItem,null,l.a.createElement(g.a,null))),e?l.a.createElement("div",{"data-test-subj":"connector-fields-sn-itsm"},l.a.createElement(i.EuiFlexGroup,null,l.a.createElement(i.EuiFlexItem,null,l.a.createElement(i.EuiFormRow,{fullWidth:!0,label:c.m},l.a.createElement(i.EuiSelect,{fullWidth:!0,"data-test-subj":"urgencySelect",options:T,value:null!=y?y:void 0,isLoading:L,disabled:L,hasNoInitialSelection:!0,onChange:e=>A("urgency",e.target.value)})))),l.a.createElement(i.EuiSpacer,{size:"m"}),l.a.createElement(i.EuiFlexGroup,null,l.a.createElement(i.EuiFlexItem,null,l.a.createElement(i.EuiFormRow,{fullWidth:!0,label:c.j},l.a.createElement(i.EuiSelect,{fullWidth:!0,"data-test-subj":"severitySelect",options:M,value:null!=E?E:void 0,isLoading:L,disabled:L,hasNoInitialSelection:!0,onChange:e=>A("severity",e.target.value)}))),l.a.createElement(i.EuiFlexItem,null,l.a.createElement(i.EuiFormRow,{fullWidth:!0,label:c.f},l.a.createElement(i.EuiSelect,{fullWidth:!0,"data-test-subj":"impactSelect",options:N,value:null!=j?j:void 0,isLoading:L,disabled:L,hasNoInitialSelection:!0,onChange:e=>A("impact",e.target.value)})))),l.a.createElement(i.EuiFlexGroup,null,l.a.createElement(i.EuiFlexItem,null,l.a.createElement(i.EuiFormRow,{fullWidth:!0,label:c.c},l.a.createElement(i.EuiSelect,{fullWidth:!0,"data-test-subj":"categorySelect",options:F,value:null!=h?h:void 0,isLoading:L,disabled:L,hasNoInitialSelection:!0,onChange:e=>v({...t,category:e.target.value,subcategory:null})}))),l.a.createElement(i.EuiFlexItem,null,l.a.createElement(i.EuiFormRow,{fullWidth:!0,label:c.l},l.a.createElement(i.EuiSelect,{fullWidth:!0,"data-test-subj":"subcategorySelect",options:W,value:null!=O?O:"",isLoading:L,disabled:L,hasNoInitialSelection:!0,onChange:e=>A("subcategory",e.target.value)}))))):l.a.createElement(i.EuiFlexGroup,null,l.a.createElement(i.EuiFlexItem,null,l.a.createElement(s.a,{connectorType:r.ConnectorTypes.serviceNowITSM,title:n.name,listItems:R,isLoading:!1}))))}},48:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"d",(function(){return u}));var a=n(3),l=n(51),i=n(49);const c=(e,t)=>{var n;return null!==(n=t.find((t=>t.id===e)))&&void 0!==n?n:null},r={[a.ConnectorTypes.swimlane]:l.a,[a.ConnectorTypes.serviceNowITSM]:i.a,[a.ConnectorTypes.serviceNowSIR]:i.a},o=({connectors:e=[],config:t={}})=>({...t,validations:[{validator:({value:t})=>{const n=c(t,e);var a;if(null!=n)return null===(a=r[n.actionTypeId])||void 0===a?void 0:a.call(r,n)}}]}),s=(e,t)=>{if(null==t)return"";try{if(e.actionTypeRegistry.has(t))return e.actionTypeRegistry.get(t).iconClass}catch{return""}return""},u=e=>null!=e&&null!=e.config&&!e.isPreconfigured&&((".servicenow"===e.actionTypeId||".servicenow-sir"===e.actionTypeId)&&!!e.config.usesTableApi)},49:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=e=>{var t;if(!e.isPreconfigured&&null!=e.config)return null!==(t=e.config)&&void 0!==t&&t.usesTableApi?{message:"Deprecated connector"}:void 0}},51:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(3);const l=["caseIdConfig","caseNameConfig","descriptionConfig","commentsConfig"],i=e=>{const{config:{mappings:t,connectorType:n}}=e;if(n===a.SwimlaneConnectorType.Alerts||(i=t,l.some((e=>null==(null==i?void 0:i[e])))))return{message:"Invalid connector"};var i}},55:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var a=n(2),l=n.n(a),i=n(6),c=n(33),r=n.n(c),o=n(20),s=n(48);const u=r.a.span.withConfig({displayName:"StyledText",componentId:"sc-10fyrf5-0"})(["span{display:block;}"]),d=({connectorType:e,title:t,listItems:n,isLoading:c})=>{const{triggersActionsUi:r}=Object(o.d)().services,d=Object(a.useMemo)((()=>l.a.createElement(u,null,n.length>0&&n.map(((e,t)=>l.a.createElement("span",{"data-test-subj":"card-list-item",key:`${e.title}-${t}`},l.a.createElement("strong",null,`${e.title}: `),e.description))))),[n]),m=Object(a.useMemo)((()=>l.a.createElement(i.EuiIcon,{size:"xl",type:Object(s.b)(r,e)})),[e]);return l.a.createElement(l.a.Fragment,null,c&&l.a.createElement(i.EuiLoadingSpinner,{"data-test-subj":"connector-card-loading"}),!c&&l.a.createElement(i.EuiFlexGroup,{direction:"row"},l.a.createElement(i.EuiFlexItem,null,l.a.createElement(i.EuiCard,{"data-test-subj":"connector-card",description:d,display:"plain",layout:"horizontal",paddingSize:"none",title:t,titleSize:"xs"})),l.a.createElement(i.EuiFlexItem,{grow:!1},m)))},m=Object(a.memo)(d)},60:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=({connector_id:e,service_message:t,...n})=>({...n,actionId:e,...t&&{serviceMessage:t}})},63:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(2),l=n.n(a),i=n(6),c=n(1);const r=c.i18n.translate("xpack.cases.connectors.serviceNow.deprecatedConnectorWarningTitle",{defaultMessage:"This connector type is deprecated"}),o=c.i18n.translate("xpack.cases.connectors.serviceNow.deprecatedConnectorWarningDesc",{defaultMessage:"Update this connector, or create a new one."}),s=({type:e="warning"})=>l.a.createElement(i.EuiCallOut,{title:r,color:e,iconType:"alert","data-test-subj":"deprecated-connector-warning-callout"},o),u=l.a.memo(s)},81:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=e=>e.map((e=>({value:e.value,text:e.label})))},93:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(2),l=n(22),i=n(60);var c=n(15);const r=({http:e,connector:t,toastNotifications:n,fields:r,onSuccess:o})=>{const[s,u]=Object(a.useState)(!1),[d,m]=Object(a.useState)([]),g=Object(a.useRef)(!1),f=Object(a.useRef)(new AbortController);return Object(a.useEffect)((()=>(g.current=!1,f.current.abort(),(async()=>{if(t)try{f.current=new AbortController,u(!0);const p=await async function({http:e,signal:t,connectorId:n,fields:a}){const c=await e.post(Object(l.d)(n),{body:JSON.stringify({params:{subAction:"getChoices",subActionParams:{fields:a}}}),signal:t});return Object(i.a)(c)}({http:e,signal:f.current.signal,connectorId:t.id,fields:r});var a,s;if(!g.current)if(u(!1),m(null!==(a=p.data)&&void 0!==a?a:[]),p.status&&"error"===p.status)n.addDanger({title:c.d,text:`${null!==(s=p.serviceMessage)&&void 0!==s?s:p.message}`});else if(o){var d;o(null!==(d=p.data)&&void 0!==d?d:[])}}catch(e){g.current||(u(!1),"AbortError"!==e.name&&n.addDanger({title:c.d,text:e.message}))}else u(!1)})(),()=>{g.current=!0,f.current.abort()})),[e,t,n,r]),{choices:d,isLoading:s}}}}]);