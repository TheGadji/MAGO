/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.cases_bundle_jsonpfunction=window.cases_bundle_jsonpfunction||[]).push([[2],{102:function(e,n,t){"use strict";t.d(n,"a",(function(){return d}));var r=t(2),a=t(66),s=t(76),o=t(3),c=t(20),i=t(50);const u=(e,n)=>{switch(n.type){case"setLoading":return{...e,loading:n.payload};case"setFirstLoad":return{...e,firstLoad:n.payload};case"setPersistLoading":return{...e,persistLoading:n.payload};case"setVersion":return{...e,version:n.payload};case"setID":return{...e,id:n.payload};case"setCurrentConfiguration":return{...e,currentConfiguration:{...n.currentConfiguration}};case"setConnector":return{...e,connector:n.connector};case"setClosureType":return{...e,closureType:n.closureType};case"setMappings":return{...e,mappings:n.mappings};default:return e}},l={closureType:"close-by-user",connector:{fields:null,id:"none",name:"none",type:o.ConnectorTypes.none},currentConfiguration:{closureType:"close-by-user",connector:{fields:null,id:"none",name:"none",type:o.ConnectorTypes.none}},firstLoad:!1,loading:!0,mappings:[],persistLoading:!1,version:"",id:""},d=()=>{const e=Object(i.a)(),[n,t]=Object(r.useReducer)(u,l),o=Object(c.f)(),d=Object(r.useCallback)((e=>{t({currentConfiguration:e,type:"setCurrentConfiguration"})}),[]),p=Object(r.useCallback)((e=>{t({connector:e,type:"setConnector"})}),[]),f=Object(r.useCallback)((e=>{t({closureType:e,type:"setClosureType"})}),[]),g=Object(r.useCallback)((e=>{t({mappings:e,type:"setMappings"})}),[]),m=Object(r.useCallback)((e=>{t({payload:e,type:"setLoading"})}),[]),y=Object(r.useCallback)((e=>{t({payload:e,type:"setFirstLoad"})}),[]),b=Object(r.useCallback)((e=>{t({payload:e,type:"setPersistLoading"})}),[]),C=Object(r.useCallback)((e=>{t({payload:e,type:"setVersion"})}),[]),v=Object(r.useCallback)((e=>{t({payload:e,type:"setID"})}),[]),h=Object(r.useRef)(!1),w=Object(r.useRef)(new AbortController),E=Object(r.useRef)(!1),O=Object(r.useRef)(new AbortController),j=Object(r.useCallback)((async()=>{try{h.current=!1,w.current.abort(),w.current=new AbortController,m(!0);const t=await Object(a.c)({signal:w.current.signal,owner:e});h.current||(null!=t&&(p(t.connector),null!=f&&f(t.closureType),C(t.version),v(t.id),g(t.mappings),n.firstLoad||(y(!0),null!=d&&d({closureType:t.closureType,connector:{...t.connector}})),null!=t.error&&o.addError(new Error(t.error),{title:s.a})),m(!1))}catch(e){h.current||("AbortError"!==e.name&&o.addError(e.body&&e.body.message?new Error(e.body.message):e,{title:s.a}),m(!1))}}),[n.firstLoad]),T=Object(r.useCallback)((async({connector:t,closureType:r})=>{try{E.current=!1,O.current.abort(),O.current=new AbortController,b(!0);const c={connector:t,closure_type:r},i=0===n.version.length?await Object(a.e)({...c,owner:e[0]},O.current.signal):await Object(a.d)(n.id,{...c,version:n.version},O.current.signal);E.current||(p(i.connector),f&&f(i.closureType),C(i.version),v(i.id),g(i.mappings),null!=d&&d({closureType:i.closureType,connector:{...i.connector}}),null!=i.error&&o.addError(new Error(i.error),{title:s.a}),o.addSuccess(s.c),b(!1))}catch(e){E.current||("AbortError"!==e.name&&o.addError(e.body&&e.body.message?new Error(e.body.message):e,{title:s.a}),p(n.currentConfiguration.connector),b(!1))}}),[b,n.version,n.id,n.currentConfiguration.connector,e,p,f,C,v,g,d,o]);return Object(r.useEffect)((()=>(j(),()=>{h.current=!0,w.current.abort(),E.current=!0,O.current.abort()})),[]),{...n,refetchCaseConfigure:j,persistCaseConfigure:T,setCurrentConfiguration:d,setConnector:p,setClosureType:f,setMappings:g}}},48:function(e,n,t){"use strict";t.d(n,"a",(function(){return o})),t.d(n,"c",(function(){return i})),t.d(n,"b",(function(){return u})),t.d(n,"d",(function(){return l}));var r=t(3),a=t(51),s=t(49);const o=(e,n)=>{var t;return null!==(t=n.find((n=>n.id===e)))&&void 0!==t?t:null},c={[r.ConnectorTypes.swimlane]:a.a,[r.ConnectorTypes.serviceNowITSM]:s.a,[r.ConnectorTypes.serviceNowSIR]:s.a},i=({connectors:e=[],config:n={}})=>({...n,validations:[{validator:({value:n})=>{const t=o(n,e);var r;if(null!=t)return null===(r=c[t.actionTypeId])||void 0===r?void 0:r.call(c,t)}}]}),u=(e,n)=>{if(null==n)return"";try{if(e.actionTypeRegistry.has(n))return e.actionTypeRegistry.get(n).iconClass}catch{return""}return""},l=e=>null!=e&&null!=e.config&&!e.isPreconfigured&&((".servicenow"===e.actionTypeId||".servicenow-sir"===e.actionTypeId)&&!!e.config.usesTableApi)},49:function(e,n,t){"use strict";t.d(n,"a",(function(){return r}));const r=e=>{var n;if(!e.isPreconfigured&&null!=e.config)return null!==(n=e.config)&&void 0!==n&&n.usesTableApi?{message:"Deprecated connector"}:void 0}},50:function(e,n,t){"use strict";t.d(n,"a",(function(){return s}));var r=t(2),a=t(23);const s=()=>{const e=Object(r.useContext)(a.a);if(0===e.length)throw new Error("useOwnerContext must be used within an OwnerProvider and not be an empty array");return e}},51:function(e,n,t){"use strict";t.d(n,"a",(function(){return s}));var r=t(3);const a=["caseIdConfig","caseNameConfig","descriptionConfig","commentsConfig"],s=e=>{const{config:{mappings:n,connectorType:t}}=e;if(t===r.SwimlaneConnectorType.Alerts||(s=n,a.some((e=>null==(null==s?void 0:s[e])))))return{message:"Invalid connector"};var s}},56:function(e,n,t){"use strict";t.d(n,"r",(function(){return s})),t.d(n,"p",(function(){return o})),t.d(n,"q",(function(){return c})),t.d(n,"a",(function(){return i})),t.d(n,"g",(function(){return u})),t.d(n,"b",(function(){return l})),t.d(n,"f",(function(){return d})),t.d(n,"c",(function(){return p})),t.d(n,"d",(function(){return f})),t.d(n,"e",(function(){return g})),t.d(n,"o",(function(){return m})),t.d(n,"j",(function(){return y})),t.d(n,"k",(function(){return b})),t.d(n,"l",(function(){return C})),t.d(n,"m",(function(){return v})),t.d(n,"n",(function(){return h})),t.d(n,"v",(function(){return w})),t.d(n,"u",(function(){return E})),t.d(n,"i",(function(){return O})),t.d(n,"h",(function(){return j}));var r=t(1),a=t(12);t.d(n,"s",(function(){return a.u})),t.d(n,"t",(function(){return a.z}));const s=r.i18n.translate("xpack.cases.configureCases.incidentManagementSystemTitle",{defaultMessage:"External incident management system"}),o=r.i18n.translate("xpack.cases.configureCases.incidentManagementSystemDesc",{defaultMessage:"Connect your cases to an external incident management system. You can then push case data as an incident in a third-party system."}),c=r.i18n.translate("xpack.cases.configureCases.incidentManagementSystemLabel",{defaultMessage:"Incident management system"}),i=r.i18n.translate("xpack.cases.configureCases.addNewConnector",{defaultMessage:"Add new connector"}),u=r.i18n.translate("xpack.cases.configureCases.caseClosureOptionsTitle",{defaultMessage:"Case closures"}),l=r.i18n.translate("xpack.cases.configureCases.caseClosureOptionsDesc",{defaultMessage:"Define how to close your cases. Automatic closures require an established connection to an external incident management system."}),d=r.i18n.translate("xpack.cases.configureCases.caseClosureOptionsSubCases",{defaultMessage:"Automatic closure of sub-cases is not supported."}),p=r.i18n.translate("xpack.cases.configureCases.caseClosureOptionsLabel",{defaultMessage:"Case closure options"}),f=r.i18n.translate("xpack.cases.configureCases.caseClosureOptionsManual",{defaultMessage:"Manually close cases"}),g=r.i18n.translate("xpack.cases.configureCases.caseClosureOptionsNewIncident",{defaultMessage:"Automatically close cases when pushing new incident to external system"}),m=e=>r.i18n.translate("xpack.cases.configureCases.fieldMappingTitle",{values:{thirdPartyName:e},defaultMessage:"{ thirdPartyName } field mappings"}),y=e=>r.i18n.translate("xpack.cases.configureCases.fieldMappingDesc",{values:{thirdPartyName:e},defaultMessage:"Map Case fields to { thirdPartyName } fields when pushing data to { thirdPartyName }. Field mappings require an established connection to { thirdPartyName }."}),b=e=>r.i18n.translate("xpack.cases.configureCases.fieldMappingDescErr",{values:{thirdPartyName:e},defaultMessage:"Failed to retrieve mappings for { thirdPartyName }."}),C=r.i18n.translate("xpack.cases.configureCases.fieldMappingFirstCol",{defaultMessage:"Kibana case field"}),v=e=>r.i18n.translate("xpack.cases.configureCases.fieldMappingSecondCol",{values:{thirdPartyName:e},defaultMessage:"{ thirdPartyName } field"}),h=r.i18n.translate("xpack.cases.configureCases.fieldMappingThirdCol",{defaultMessage:"On edit and update"}),w=(r.i18n.translate("xpack.cases.configureCases.fieldMappingEditAppend",{defaultMessage:"Append"}),r.i18n.translate("xpack.cases.configureCases.cancelButton",{defaultMessage:"Cancel"}),r.i18n.translate("xpack.cases.configureCases.saveButton",{defaultMessage:"Save"}),r.i18n.translate("xpack.cases.configureCases.saveAndCloseButton",{defaultMessage:"Save & close"}),r.i18n.translate("xpack.cases.configureCases.warningTitle",{defaultMessage:"Warning"})),E=(r.i18n.translate("xpack.cases.configureCases.commentMapping",{defaultMessage:"Comments"}),r.i18n.translate("xpack.cases.configureCases.updateConnector",{defaultMessage:"Update field mappings"}),e=>r.i18n.translate("xpack.cases.configureCases.updateSelectedConnector",{values:{connectorName:e},defaultMessage:"Update { connectorName }"})),O=r.i18n.translate("xpack.cases.configureCases.deprecatedTooltipText",{defaultMessage:"deprecated"}),j=r.i18n.translate("xpack.cases.configureCases.deprecatedTooltipContent",{defaultMessage:"This connector is deprecated. Update it, or create a new one."})},65:function(e,n,t){"use strict";t.d(n,"a",(function(){return c}));var r=t(2),a=t(66),s=t(20),o=t(76);const c=({toastPermissionsErrors:e=!0}={})=>{const n=Object(s.f)(),[t,c]=Object(r.useState)({loading:!0,connectors:[]}),i=Object(r.useRef)(!1),u=Object(r.useRef)(new AbortController),l=Object(r.useCallback)((async()=>{try{i.current=!1,u.current.abort(),u.current=new AbortController,c({...t,loading:!0});const e=await Object(a.b)({signal:u.current.signal});i.current||c({loading:!1,connectors:e})}catch(t){if(!i.current){let a;var r,s;if("AbortError"!==t.name)403!==(null===(r=t.body)||void 0===r?void 0:r.statusCode)&&401!==(null===(s=t.body)||void 0===s?void 0:s.statusCode)||(a=o.b),(void 0===a||e)&&n.addError(t.body&&t.body.message?new Error(t.body.message):t,{title:o.a});c({loading:!1,connectors:[],permissionsError:a})}}}),[]);return Object(r.useEffect)((()=>(l(),()=>{i.current=!0,u.current.abort()})),[]),{loading:t.loading,connectors:t.connectors,refetchConnectors:l,permissionsError:t.permissionsError}}},66:function(e,n,t){"use strict";t.d(n,"b",(function(){return i})),t.d(n,"c",(function(){return u})),t.d(n,"e",(function(){return l})),t.d(n,"d",(function(){return d})),t.d(n,"a",(function(){return p}));var r=t(21),a=t(22),s=t(3),o=t(20),c=t(25);const i=async({signal:e})=>await o.a.get().http.fetch(`${s.CASE_CONFIGURE_CONNECTORS_URL}/_find`,{method:"GET",signal:e}),u=async({signal:e,owner:n})=>{const t=await o.a.get().http.fetch(s.CASE_CONFIGURE_URL,{method:"GET",signal:e,query:{...n.length>0?{owner:n}:{}}});if(!Object(r.isEmpty)(t)){const e=Object(c.e)(t);if(Array.isArray(e)&&e.length>0)return Object(c.c)(e[0])}return null},l=async(e,n)=>{const t=await o.a.get().http.fetch(s.CASE_CONFIGURE_URL,{method:"POST",body:JSON.stringify(e),signal:n});return Object(c.c)(Object(c.f)(t))},d=async(e,n,t)=>{const r=await o.a.get().http.fetch(Object(s.getCaseConfigurationDetailsUrl)(e),{method:"PATCH",body:JSON.stringify(n),signal:t});return Object(c.c)(Object(c.f)(r))},p=async({signal:e})=>{const n=await o.a.get().http.fetch(Object(a.a)(),{method:"GET",signal:e});return Object(c.b)(n)}},76:function(e,n,t){"use strict";t.d(n,"c",(function(){return s})),t.d(n,"b",(function(){return o}));var r=t(1),a=t(13);t.d(n,"a",(function(){return a.d}));const s=r.i18n.translate("xpack.cases.configure.successSaveToast",{defaultMessage:"Saved external connection settings"}),o=r.i18n.translate("xpack.cases.configure.readPermissionsErrorDescription",{defaultMessage:"You do not have permissions to view connectors. If you would like to view the connectors associated with this case, contact your Kibana administrator."})},78:function(e,n,t){"use strict";t.d(n,"a",(function(){return C}));var r=t(2),a=t.n(r),s=t(6),o=t(33),c=t.n(o),i=t(3),u=t(56),l=t(20),d=t(48),p=t(38);const f=c()(s.EuiIcon).withConfig({displayName:"EuiIconExtended",componentId:"sc-12z1pzb-0"})(["margin-right:13px;margin-bottom:0 !important;"]),g={value:"none",inputDisplay:a.a.createElement(s.EuiFlexGroup,{gutterSize:"none",alignItems:"center",responsive:!1},a.a.createElement(s.EuiFlexItem,{grow:!1},a.a.createElement(f,{type:"minusInCircle",size:"m"})),a.a.createElement(s.EuiFlexItem,null,a.a.createElement("span",{"data-test-subj":"dropdown-connector-no-connector"},u.t))),"data-test-subj":"dropdown-connector-no-connector"},m={value:"add-connector",inputDisplay:a.a.createElement("span",{className:"euiButtonEmpty euiButtonEmpty--primary euiButtonEmpty--xSmall euiButtonEmpty--flushLeft"},u.a),"data-test-subj":"dropdown-connector-add-connector"},y=Object(p.euiStyled)(s.EuiIconTip)`
  margin-left: ${({theme:e})=>e.eui.euiSizeS}
  margin-bottom: 0 !important;
`,b=({connectors:e,disabled:n,isLoading:t,onChange:o,selectedConnector:c,appendAddConnectorButton:p=!1,hideConnectorServiceNowSir:b=!1})=>{const{triggersActionsUi:C}=Object(l.d)().services,v=Object(r.useMemo)((()=>{const n=e.reduce(((e,n)=>b&&n.actionTypeId===i.ConnectorTypes.serviceNowSIR?e:[...e,{value:n.id,inputDisplay:a.a.createElement(s.EuiFlexGroup,{gutterSize:"s",alignItems:"center",responsive:!1},a.a.createElement(s.EuiFlexItem,{grow:!1},a.a.createElement(f,{type:Object(d.b)(C,n.actionTypeId),size:"m"})),a.a.createElement(s.EuiFlexItem,{grow:!1},a.a.createElement("span",null,n.name,Object(d.d)(n)&&` (${u.i})`)),Object(d.d)(n)&&a.a.createElement(s.EuiFlexItem,{grow:!1},a.a.createElement(y,{"aria-label":u.h,size:"m",type:"alert",color:"warning",content:u.h}))),"data-test-subj":`dropdown-connector-${n.id}`}]),[g]);return p?[...n,m]:n}),[e]);return a.a.createElement(s.EuiSuperSelect,{"aria-label":u.q,"data-test-subj":"dropdown-connectors",disabled:n,fullWidth:!0,isLoading:t,onChange:o,options:v,valueOfSelected:c})},C=a.a.memo(b)},79:function(e,n,t){"use strict";t.d(n,"a",(function(){return a})),t.d(n,"b",(function(){return s})),t.d(n,"c",(function(){return o}));var r=t(3);const a=()=>({id:"none",name:"none",type:r.ConnectorTypes.none,fields:null}),s=(e,n=null)=>{const t={type:e.actionTypeId,fields:n};return{id:e.id,name:e.name,...t}},o=(e,n)=>{var t;return null!==(t=e.find((e=>e.id===n.id)))&&void 0!==t?t:null}}}]);