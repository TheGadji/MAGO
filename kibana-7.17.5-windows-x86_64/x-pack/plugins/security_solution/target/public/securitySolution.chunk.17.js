/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.securitySolution_bundle_jsonpfunction=window.securitySolution_bundle_jsonpfunction||[]).push([[17],{1362:function(e,t,a){"use strict";a.r(t),a.d(t,"QueryTabContentComponent",(function(){return we})),a.d(t,"default",(function(){return je}));var i,n=a(55),r=a(19),l=a(9),s=a.n(l),o=a(56),u=a.n(o),c=a(91),d=a(95),m=a.n(d),p=a(217),f=a(179),h=a(94),y=a(537),g=a(90),b=a(178),v=a(526),E=a(547),S=a(764),O=a(110),k=a(105),x=a(262),w=a(479),j=a(96),I=a.n(j),P=a(7),C=a.n(P),F=a(72),M=a.n(F);!function(e){e.BACK="back",e.FORWARD="forward"}(i||(i={}));class super_select_EuiSuperSelect extends l.Component{constructor(...e){super(...e),C()(this,"itemNodes",[]),C()(this,"_isMounted",!1),C()(this,"state",{isPopoverOpen:this.props.isOpen||!1}),C()(this,"setItemNode",((e,t)=>{this.itemNodes[t]=e})),C()(this,"openPopover",(()=>{this.setState({isPopoverOpen:!0});const e=()=>{const t=this.props.options.reduce(((e,t,a)=>null!=e?e:null==t?null:t.value===this.props.valueOfSelected?a:null),null);requestAnimationFrame((()=>{this._isMounted&&null!=this.props.valueOfSelected&&(null!=t?this.focusItemAt(t):e())}))};requestAnimationFrame(e)})),C()(this,"closePopover",(()=>{this.setState({isPopoverOpen:!1})})),C()(this,"itemClicked",(e=>{this.setState({isPopoverOpen:!1}),this.props.onChange&&this.props.onChange(e)})),C()(this,"onSelectKeyDown",(e=>{e.key!==n.keys.ARROW_UP&&e.key!==n.keys.ARROW_DOWN||(e.preventDefault(),e.stopPropagation(),this.openPopover())})),C()(this,"onItemKeyDown",(e=>{switch(e.key){case n.keys.ESCAPE:e.preventDefault(),e.stopPropagation(),this.closePopover();break;case n.keys.TAB:e.preventDefault(),e.stopPropagation();break;case n.keys.ARROW_UP:e.preventDefault(),e.stopPropagation(),this.shiftFocus(i.BACK);break;case n.keys.ARROW_DOWN:e.preventDefault(),e.stopPropagation(),this.shiftFocus(i.FORWARD)}}))}componentDidMount(){this._isMounted=!0,this.props.isOpen&&this.openPopover()}componentWillUnmount(){this._isMounted=!1}focusItemAt(e){const t=this.itemNodes[e];null!=t&&t.focus()}shiftFocus(e){const t=this.itemNodes.indexOf(document.activeElement);let a;a=-1===t?0:e===i.BACK?0===t?this.itemNodes.length-1:t-1:t===this.itemNodes.length-1?0:t+1,this.focusItemAt(a)}render(){const{className:e,options:t,valueOfSelected:a,onChange:i,isOpen:r,isInvalid:l,hasDividers:o,itemClassName:u,itemLayoutAlign:c,fullWidth:d,popoverClassName:m,compressed:p,...f}=this.props,h=M()("euiSuperSelect",m),y=M()({"euiSuperSelect--isOpen__button":this.state.isPopoverOpen},e),g=M()("euiSuperSelect__item",{"euiSuperSelect__item--hasDividers":o},u),b=s.a.createElement(n.EuiSuperSelectControl,I()({options:t,value:a,onClick:this.state.isPopoverOpen?this.closePopover:this.openPopover,onKeyDown:this.onSelectKeyDown,className:y,fullWidth:d,isInvalid:l,compressed:p},f)),v=t.map(((e,t)=>{const{value:i,dropdownDisplay:r,inputDisplay:l,...o}=e;return s.a.createElement(n.EuiContextMenuItem,I()({key:t,className:g,icon:a===i?"check":"empty",onClick:()=>this.itemClicked(i),onKeyDown:this.onItemKeyDown,layoutAlign:c,buttonRef:e=>this.setItemNode(e,t),role:"option",id:i,"aria-selected":a===i},o),r||l)}));return s.a.createElement(n.EuiInputPopover,{className:h,input:b,isOpen:r||this.state.isPopoverOpen,closePopover:this.closePopover,panelPaddingSize:"none",panelClassName:h,fullWidth:d,repositionOnScroll:!0,anchorPosition:"downCenter"},s.a.createElement(n.EuiScreenReaderOnly,null,s.a.createElement("p",{role:"alert"},s.a.createElement(n.EuiI18n,{token:"euiSuperSelect.screenReaderAnnouncement",default:"You are in a form selector of {optionsCount} items and must select a single option. Use the up and down keys to navigate or escape to close.",values:{optionsCount:t.length}}))),s.a.createElement("div",{className:"euiSuperSelect__listbox",role:"listbox","aria-activedescendant":a,tabIndex:0},v))}}C()(super_select_EuiSuperSelect,"defaultProps",{compressed:!1,fullWidth:!1,hasDividers:!1,isInvalid:!1,isLoading:!1});var T=a(256),Q=a(350);const q=u.a.div.withConfig({displayName:"AndOrContainer",componentId:"sc-1mndpti-0"})(["position:relative;top:-1px;"]);q.displayName="AndOrContainer";const N={filter:{mode:"filter",description:Q.f,kqlBarTooltip:Q.i,placeholder:Q.g,selectText:Q.h},search:{mode:"search",description:Q.o,kqlBarTooltip:Q.r,placeholder:Q.p,selectText:Q.q}},D=[{value:N.filter.mode,inputDisplay:s.a.createElement(q,null,s.a.createElement(T.a,{type:"and"}),N.filter.selectText),dropdownDisplay:s.a.createElement(s.a.Fragment,null,s.a.createElement(T.a,{type:"and"}),s.a.createElement("strong",null,N.filter.selectText),s.a.createElement(n.EuiSpacer,{size:"xs"}),s.a.createElement(n.EuiText,{size:"s",color:"subdued"},s.a.createElement("p",{className:"euiTextColor--subdued"},N.filter.description))),"data-test-subj":"kqlModePopoverFilter"},{value:N.search.mode,inputDisplay:s.a.createElement(q,null,s.a.createElement(T.a,{type:"or"}),N.search.selectText),dropdownDisplay:s.a.createElement(s.a.Fragment,null,s.a.createElement(T.a,{type:"or"}),s.a.createElement("strong",null,N.search.selectText),s.a.createElement(n.EuiSpacer,{size:"xs"}),s.a.createElement(n.EuiText,{size:"s",color:"subdued"},s.a.createElement("p",{className:"euiTextColor--subdued"},N.search.description))),"data-test-subj":"kqlModePopoverSearch"}],R="timelineSelectModeItemsClassName",A="searchOrFilterPopover",_="352px",z=Object(o.createGlobalStyle)([".","{width:350px !important;}.",".euiPopover__panel{width:"," !important;.euiSuperSelect__listbox{width:"," !important;}}"],R,A,_,_),K=u.a.div.withConfig({displayName:"SearchOrFilterContainer",componentId:"sc-izkbfu-0"})([""," user-select:none;.globalQueryBar{padding:0px;.kbnQueryBar{div:first-child{margin-right:0px;}}.globalFilterGroup__wrapper.globalFilterGroup__wrapper-isVisible{height:auto !important;}}"],(({theme:e})=>`margin-top: ${e.eui.euiSizeXS};`));K.displayName="SearchOrFilterContainer";const B=u()(n.EuiFlexItem).withConfig({displayName:"ModeFlexItem",componentId:"sc-izkbfu-1"})(["user-select:none;"]);B.displayName="ModeFlexItem";const L=s.a.memo((({dataProviders:e,isRefreshPaused:t,filters:a,filterManager:i,filterQuery:r,from:o,fromStr:u,kqlMode:c,timelineId:d,refreshInterval:m,savedQueryId:p,setFilters:f,setSavedQueryId:h,to:y,toStr:g,updateKqlMode:b,updateReduxTime:v})=>{const E=Object(l.useCallback)((e=>b({id:d,kqlMode:e})),[d,b]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(K,null,s.a.createElement(n.EuiFlexGroup,{"data-test-subj":"timeline-search-or-filter",gutterSize:"xs"},s.a.createElement(B,{grow:!1},s.a.createElement(n.EuiToolTip,{content:Q.j},s.a.createElement(super_select_EuiSuperSelect,{"data-test-subj":"timeline-select-search-or-filter",hasDividers:!0,itemLayoutAlign:"top",itemClassName:R,onChange:E,options:D,popoverClassName:A,valueOfSelected:c}))),s.a.createElement(n.EuiFlexItem,{"data-test-subj":"timeline-search-or-filter-search-container"},s.a.createElement(w.a,{dataProviders:e,filters:a,filterManager:i,filterQuery:r,from:o,fromStr:u,kqlMode:c,isRefreshPaused:t,refreshInterval:m,savedQueryId:p,setFilters:f,setSavedQueryId:h,timelineId:d,to:y,toStr:g,updateReduxTime:v})))),s.a.createElement(z,null))}));L.displayName="SearchOrFilter";const W=s.a.memo((({dataProviders:e,filters:t,filterManager:a,filterQuery:i,from:n,fromStr:r,isRefreshPaused:o,kqlMode:u,refreshInterval:c,savedQueryId:d,setFilters:m,setSavedQueryId:p,timelineId:f,to:h,toStr:y,updateKqlMode:g,updateReduxTime:b})=>{const v=Object(l.useCallback)((e=>m({id:f,filters:e})),[f,m]),E=Object(l.useCallback)((e=>p({id:f,savedQueryId:e})),[f,p]);return s.a.createElement(L,{dataProviders:e,filters:t,filterManager:a,filterQuery:i,from:n,fromStr:r,isRefreshPaused:o,kqlMode:u,refreshInterval:c,savedQueryId:d,setFilters:v,setSavedQueryId:E,timelineId:f,to:h,toStr:y,updateKqlMode:g,updateReduxTime:b})}),((e,t)=>e.filterManager===t.filterManager&&e.from===t.from&&e.fromStr===t.fromStr&&e.to===t.to&&e.toStr===t.toStr&&e.isRefreshPaused===t.isRefreshPaused&&e.refreshInterval===t.refreshInterval&&e.timelineId===t.timelineId&&m()(e.dataProviders,t.dataProviders)&&m()(e.filters,t.filters)&&m()(e.filterQuery,t.filterQuery)&&m()(e.kqlMode,t.kqlMode)&&m()(e.savedQueryId,t.savedQueryId)&&m()(e.timelineId,t.timelineId)));W.displayName="StatefulSearchOrFilterComponent";const H=Object(c.connect)((()=>{const e=h.b.getTimelineByIdSelector(),t=h.b.getKqlFilterKuerySelector(),a=O.e.getTimelineSelector(),i=O.e.getTimelinePolicySelector();return(n,{timelineId:l})=>{var s;const o=null!==(s=e(n,l))&&void 0!==s?s:k.a,u=a(n),c=i(n);return{dataProviders:o.dataProviders,filterQuery:t(n,l),filters:o.filters,from:u.timerange.from,fromStr:u.timerange.fromStr,isRefreshPaused:"manual"===c.kind,kqlMode:Object(r.getOr)("filter","kqlMode",o),refreshInterval:c.duration,savedQueryId:Object(r.getOr)(null,"savedQueryId",o),to:u.timerange.to,toStr:u.timerange.toStr}}}),(e=>({applyKqlFilterQuery:({id:t,filterQuery:a})=>e(h.a.applyKqlFilterQuery({id:t,filterQuery:a})),updateKqlMode:({id:t,kqlMode:a})=>e(h.a.updateKqlMode({id:t,kqlMode:a})),setSavedQueryId:({id:t,savedQueryId:a})=>e(h.a.setSavedQueryId({id:t,savedQueryId:a})),setFilters:({id:t,filters:a})=>e(h.a.setFilters({id:t,filters:a})),updateReduxTime:Object(x.b)(e)})))(W);var U=a(455),$=a(20);const G=({filterManager:e,show:t,showCallOutUnauthorizedMsg:a,status:i,timelineId:r})=>s.a.createElement(s.a.Fragment,null,a&&s.a.createElement(n.EuiCallOut,{"data-test-subj":"timelineCallOutUnauthorized",title:U.b,color:"warning",iconType:"alert",size:"s"}),i===$.u.immutable&&s.a.createElement(n.EuiCallOut,{"data-test-subj":"timelineImmutableCallOut",title:U.a,color:"primary",iconType:"alert",size:"s"}),t&&s.a.createElement(S.a,{timelineId:r}),s.a.createElement(H,{filterManager:e,timelineId:r})),V=s.a.memo(G);var J=a(117),X=a(523),Y=a(59),Z=a(245),ee=a(349),te=a(548),ae=a(135),ie=a(104),ne=a(109),re=a(387),le=a(549),se=a(128),oe=a(243),ue=a(309),ce=a(388),de=a(524),me=a(311),pe=a(93);const fe=u.a.div.withConfig({displayName:"TimelineHeaderContainer",componentId:"sc-fm1ksw-0"})(["margin-top:6px;width:100%;"]);fe.displayName="TimelineHeaderContainer";const he=u()(n.EuiFlyoutHeader).withConfig({displayName:"StyledEuiFlyoutHeader",componentId:"sc-fm1ksw-1"})(["align-items:stretch;box-shadow:none;display:flex;flex-direction:column;&.euiFlyoutHeader{","}"],(({theme:e})=>`padding: ${e.eui.euiSizeM} ${e.eui.euiSizeS} 0 ${e.eui.euiSizeS};`)),ye=u()(n.EuiFlyoutBody).withConfig({displayName:"StyledEuiFlyoutBody",componentId:"sc-fm1ksw-2"})(["overflow-y:hidden;flex:1;.euiFlyoutBody__overflow{overflow:hidden;mask-image:none;}.euiFlyoutBody__overflowContent{padding:0;height:100%;display:flex;}"]),ge=u()(n.EuiFlyoutFooter).withConfig({displayName:"StyledEuiFlyoutFooter",componentId:"sc-fm1ksw-3"})(["background:none;&.euiFlyoutFooter{","}"],(({theme:e})=>`padding: ${e.eui.euiSizeS} 0;`)),be=u()(n.EuiFlexGroup).withConfig({displayName:"FullWidthFlexGroup",componentId:"sc-fm1ksw-4"})(["margin:0;width:100%;overflow:hidden;"]),ve=u()(n.EuiFlexItem).withConfig({displayName:"ScrollableFlexItem",componentId:"sc-fm1ksw-5"})([""," overflow:hidden;"],(({theme:e})=>`margin: 0 ${e.eui.euiSizeM};`)),Ee=u()(n.EuiFlexItem).withConfig({displayName:"DatePicker",componentId:"sc-fm1ksw-6"})([".euiSuperDatePicker__flexWrapper{max-width:none;width:auto;}"]);Ee.displayName="DatePicker";const Se=u.a.div.withConfig({displayName:"VerticalRule",componentId:"sc-fm1ksw-7"})(["width:2px;height:100%;background:",";"],(({theme:e})=>e.eui.euiColorLightShade));Se.displayName="VerticalRule";const Oe=u()(n.EuiBadge).withConfig({displayName:"EventsCountBadge",componentId:"sc-fm1ksw-8"})(["margin-left:",";"],(({theme:e})=>e.eui.paddingSizes.s)),ke=[],xe=[],we=({activeTab:e,columns:t,dataProviders:a,end:i,eventType:o,expandedDetail:u,filters:d,timelineId:m,isLive:S,itemsPerPage:O,itemsPerPageOptions:k,kqlMode:w,kqlQueryExpression:j,onEventClosed:I,renderCellValue:P,rowRenderers:C,show:F,showCallOutUnauthorizedMsg:M,showExpandedDetails:T,start:Q,status:q,sort:N,timerangeKind:D,updateEventTypeAndIndexesName:R})=>{var A;const _=Object(c.useDispatch)(),{portalNode:z}=Object(re.d)(),{setTimelineFullScreen:K,timelineFullScreen:B}=Object(se.b)(),{browserFields:L,docValueFields:W,loading:H,indexPattern:U,selectedPatterns:G}=Object(ne.c)(ie.SourcererScopeName.timeline),{uiSettings:ae}=Object(g.j)().services,we=Object(l.useMemo)((()=>h.b.getManageTimelineById()),[]),{filterManager:je}=Object(pe.a)((e=>we(e,null!=m?m:""))),Ie=Object(l.useMemo)((()=>null!=je?je:new Y.FilterManager(ae)),[je,ae]),Pe=Object(l.useMemo)((()=>Y.esQuery.getEsQueryConfig(ae)),[ae]),Ce=Object(l.useMemo)((()=>({query:j.trim(),language:"kuery"})),[j]),Fe=Object(J.i)({config:Pe,dataProviders:a,indexPattern:U,browserFields:L,filters:d,kqlQuery:Ce,kqlMode:w});Object(f.a)({id:m,filterQuery:null==Fe?void 0:Fe.filterQuery,kqlError:null==Fe?void 0:Fe.kqlError,query:Ce,startDate:Q,endDate:i});const Me=Object(r.isEmpty)(a)&&Object(r.isEmpty)(d)&&Object(r.isEmpty)(Ce.query)&&void 0===(null==Fe?void 0:Fe.filterQuery),Te=Object(l.useMemo)((()=>null!=Fe&&null!=H&&!H&&!Object(r.isEmpty)(Q)&&!Object(r.isEmpty)(i)&&void 0!==(null==Fe?void 0:Fe.filterQuery)),[Fe,i,H,Q]),Qe=N.map((({columnId:e,columnType:t,esTypes:a,sortDirection:i})=>({field:e,direction:i,esTypes:null!=a?a:[],type:t})));Object(l.useEffect)((()=>{_(h.a.initializeTGridSettings({filterManager:Ie,id:m}))}),[je,_,Ie,m,ae]);const[qe,{events:Ne,inspect:De,totalCount:Re,pageInfo:Ae,loadPage:_e,updatedAt:ze,refetch:Ke}]=Object(y.a)({docValueFields:W,endDate:i,id:m,indexNames:G,fields:[...(Object(r.isEmpty)(t)?b.b:t).map((e=>e.id)),...Z.k],language:Ce.language,limit:O,filterQuery:null==Fe?void 0:Fe.filterQuery,startDate:Q,skip:!Te,sort:Qe,timerangeKind:D}),Be=Object(l.useCallback)((()=>{var e;I({tabType:$.w.query,timelineId:m}),null!==(e=u[$.w.query])&&void 0!==e&&e.panelView&&m===$.q.active&&T&&oe.a.toggleExpandedDetail({})}),[I,m,u,T]);Object(l.useEffect)((()=>{_(h.a.updateIsLoading({id:m,isLoading:qe||H}))}),[H,m,qe,_]);const Le=Object(l.useMemo)((()=>Fe&&null!=Fe.kqlError||!1),[Fe]),We=Object(l.useMemo)((()=>Object(me.a)(5).map((e=>({...e,headerCellRender:de.a})))),[]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(p.a,{node:z},Re>=0?s.a.createElement(Oe,null,Re):null),s.a.createElement(X.a,{id:`${m}-${$.w.query}`,inputId:"timeline",inspect:De,loading:qe,refetch:Ke,skip:!Te}),s.a.createElement(be,{gutterSize:"none"},s.a.createElement(ve,{grow:2},s.a.createElement(he,{"data-test-subj":`${e}-tab-flyout-header`,hasBorder:!1},s.a.createElement(n.EuiFlexGroup,{alignItems:"center",gutterSize:"s","data-test-subj":"timeline-date-picker-container"},B&&null!=K&&s.a.createElement(ce.b,{fullScreen:B,setFullScreen:K}),s.a.createElement(Ee,{grow:1},s.a.createElement(x.a,{id:"timeline",timelineId:m,disabled:Le})),s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(le.a,null)),s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(te.a,{eventType:o,onChangeEventTypeAndIndexesName:R}))),s.a.createElement(fe,{"data-test-subj":"timelineHeader"},s.a.createElement(V,{filterManager:Ie,show:F&&e===$.w.query,showCallOutUnauthorizedMsg:M,status:q,timelineId:m}))),s.a.createElement(ee.a,null,s.a.createElement(ye,{"data-test-subj":`${$.w.query}-tab-flyout-body`,className:"timeline-flyout-body"},s.a.createElement(v.a,{activePage:Ae.activePage,browserFields:L,data:Me?ke:Ne,id:m,refetch:Ke,renderCellValue:P,rowRenderers:C,sort:N,tabType:$.w.query,totalPages:Object(J.h)({itemsCount:Re,itemsPerPage:O}),leadingControlColumns:We,trailingControlColumns:xe})),s.a.createElement(ge,{"data-test-subj":`${$.w.query}-tab-flyout-footer`,className:"timeline-flyout-footer"},!Me&&s.a.createElement(E.a,{activePage:null!==(A=null==Ae?void 0:Ae.activePage)&&void 0!==A?A:0,"data-test-subj":"timeline-footer",updatedAt:ze,height:E.b,id:m,isLive:S,isLoading:qe||H,itemsCount:Me?0:Ne.length,itemsPerPage:O,itemsPerPageOptions:k,onChangePage:_e,totalCount:Me?0:Re})))),T&&s.a.createElement(s.a.Fragment,null,s.a.createElement(Se,null),s.a.createElement(ve,{grow:1},s.a.createElement(ue.a,{browserFields:L,docValueFields:W,handleOnPanelClosed:Be,tabType:$.w.query,timelineId:m})))))},je=Object(c.connect)((()=>{const e=h.b.getShowCallOutUnauthorizedMsg(),t=h.b.getTimelineByIdSelector(),a=h.b.getKqlFilterKuerySelector(),i=O.e.getTimelineSelector();return(n,{timelineId:l})=>{var s,o,u,c;const d=null!==(s=t(n,l))&&void 0!==s?s:k.a,m=i(n),{activeTab:p,columns:f,dataProviders:h,eventType:y,expandedDetail:g,filters:b,itemsPerPage:v,itemsPerPageOptions:E,kqlMode:S,show:O,sort:x,status:w,timelineType:j}=d,I=a(n,l),P="filter"===S&&b||[],C=Object(r.isEmpty)(h)&&Object(r.isEmpty)(null!==(o=null==I?void 0:I.expression)&&void 0!==o?o:"")&&"template"===j?" ":null!==(u=null==I?void 0:I.expression)&&void 0!==u?u:"";return{activeTab:p,columns:f,dataProviders:h,eventType:null!=y?y:"raw",end:m.timerange.to,expandedDetail:g,filters:P,timelineId:l,isLive:"interval"===m.policy.kind,itemsPerPage:v,itemsPerPageOptions:E,kqlMode:S,kqlQueryExpression:C,showCallOutUnauthorizedMsg:e(n),show:O,showExpandedDetails:!!g[$.w.query]&&!(null===(c=g[$.w.query])||void 0===c||!c.panelView),sort:x,start:m.timerange.from,status:w,timerangeKind:m.timerange.kind}}}),((e,{timelineId:t})=>({updateEventTypeAndIndexesName:(a,i)=>{e(h.a.updateEventType({id:t,eventType:a})),e(h.a.updateIndexNames({id:t,indexNames:i})),e(ae.a.setSelectedIndexPatterns({id:ie.SourcererScopeName.timeline,selectedPatterns:i}))},onEventClosed:t=>{e(h.a.toggleDetailPanel(t))}})))(s.a.memo(we,((e,t)=>((e,t)=>e.kqlMode===t.kqlMode&&e.kqlQueryExpression===t.kqlQueryExpression&&m()(e.filters,t.filters))(e,t)&&e.activeTab===t.activeTab&&((e,t)=>e.end===t.end&&e.start===t.start&&e.timerangeKind===t.timerangeKind)(e,t)&&e.eventType===t.eventType&&e.isLive===t.isLive&&e.itemsPerPage===t.itemsPerPage&&e.onEventClosed===t.onEventClosed&&e.show===t.show&&e.showCallOutUnauthorizedMsg===t.showCallOutUnauthorizedMsg&&e.showExpandedDetails===t.showExpandedDetails&&e.status===t.status&&e.timelineId===t.timelineId&&e.updateEventTypeAndIndexesName===t.updateEventTypeAndIndexesName&&m()(e.columns,t.columns)&&m()(e.dataProviders,t.dataProviders)&&m()(e.itemsPerPageOptions,t.itemsPerPageOptions)&&m()(e.sort,t.sort))))},350:function(e,t,a){"use strict";a.d(t,"f",(function(){return n})),a.d(t,"i",(function(){return r})),a.d(t,"g",(function(){return l})),a.d(t,"h",(function(){return s})),a.d(t,"o",(function(){return o})),a.d(t,"r",(function(){return u})),a.d(t,"p",(function(){return c})),a.d(t,"q",(function(){return d})),a.d(t,"j",(function(){return m})),a.d(t,"a",(function(){return p})),a.d(t,"m",(function(){return f})),a.d(t,"e",(function(){return h})),a.d(t,"c",(function(){return y})),a.d(t,"s",(function(){return g})),a.d(t,"b",(function(){return b})),a.d(t,"n",(function(){return v})),a.d(t,"t",(function(){return E})),a.d(t,"k",(function(){return S})),a.d(t,"d",(function(){return O})),a.d(t,"l",(function(){return k}));var i=a(2);const n=i.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.filterDescription",{defaultMessage:"Events from the data providers above are filtered by the adjacent KQL"}),r=i.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.filterKqlTooltip",{defaultMessage:"Events from the data providers above are filtered by this KQL"}),l=i.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.filterKqlPlaceholder",{defaultMessage:"Filter events"}),s=i.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.filterKqlSelectedText",{defaultMessage:"Filter"}),o=i.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.searchDescription",{defaultMessage:"Events from the data providers above are combined with results from the adjacent KQL"}),u=i.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.searchKqlTooltip",{defaultMessage:"Events from the data providers above are combined with results from this KQL"}),c=i.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.searchKqlPlaceholder",{defaultMessage:"Search events"}),d=i.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.searchKqlSelectedText",{defaultMessage:"Search"}),m=i.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.filterOrSearchWithKql",{defaultMessage:"Filter or Search with KQL"}),p=i.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.eventTypeAllEvent",{defaultMessage:"All data sources"}),f=i.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.eventTypeRawEvent",{defaultMessage:"Events"}),h=i.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.eventTypeDetectionAlertsEvent",{defaultMessage:"Detection Alerts"}),y=i.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.customeIndexNames",{defaultMessage:"Custom"}),g=i.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.indexPatterns.help",{defaultMessage:"Data sources selection"}),b=i.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.indexPatterns.configure",{defaultMessage:"View data sources associated with each of the above selections"}),v=i.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.indexPatterns.save",{defaultMessage:"Save"}),E=i.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.indexPatterns.showAdvancedSettings",{defaultMessage:"Show Advanced"}),S=i.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.indexPatterns.hideAdvancedSettings",{defaultMessage:"Hide Advanced"}),O=i.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.indexPatterns.resetSettings",{defaultMessage:"Reset"}),k=i.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.indexPatterns.pickIndexPatternsCombo",{defaultMessage:"Pick index patterns"})},389:function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var i=a(9),n=a.n(i),r=a(95),l=a.n(r),s=a(59),o=a(30);const u=Object(i.memo)((({dateRangeFrom:e,dateRangeTo:t,hideSavedQuery:a=!1,indexPattern:r,isLoading:u=!1,isRefreshPaused:c,filterQuery:d,filterManager:m,filters:p,onChangedQuery:f,onSubmitQuery:h,refreshInterval:y,savedQuery:g,onSavedQuery:b,dataTestSubj:v})=>{const E=Object(i.useCallback)((e=>{null==e.query||l()(e.query,d)||h(e.query)}),[d,h]),S=Object(i.useCallback)((e=>{f&&null!=e.query&&!l()(e.query,d)&&f(e.query)}),[d,f]),O=Object(i.useCallback)((e=>{const{query:t,filters:a,timefilter:i}=e.attributes;h(t,i),m.setFilters(a||[]),b(e)}),[m,h,b]),k=Object(i.useCallback)((()=>{null!=g&&(h({query:"",language:g.attributes.query.language}),m.setFilters([]),b(void 0))}),[m,h,b,g]),x=Object(i.useCallback)((e=>{m.setFilters(e)}),[m]),w=n.a.createElement(n.a.Fragment,null,null),j=Object(i.useMemo)((()=>[r]),[r]);return n.a.createElement(s.SearchBar,{customSubmitButton:w,dateRangeFrom:e,dateRangeTo:t,filters:p,indexPatterns:j,isLoading:u,isRefreshPaused:c,query:d,onClearSavedQuery:k,onFiltersUpdated:x,onQueryChange:S,onQuerySubmit:E,onSaved:b,onSavedQueryUpdated:O,refreshInterval:y,showAutoRefreshOnly:!1,showFilterBar:!a,showDatePicker:!1,showQueryBar:!0,showQueryInput:!0,showSaveQuery:!0,timeHistory:new s.TimeHistory(new o.Storage(localStorage)),dataTestSubj:v,savedQuery:g})}));u.displayName="QueryBar"},390:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var i=a(9),n=a(59),r=a(90);const l=()=>{const e=Object(r.j)(),{http:t}=e.services,[a,l]=Object(i.useState)(Object(n.createSavedQueryService)(t));return Object(i.useEffect)((()=>{l(Object(n.createSavedQueryService)(t))}),[t]),a}},479:function(e,t,a){"use strict";a.d(t,"a",(function(){return E})),a.d(t,"b",(function(){return S}));var i=a(19),n=a(9),r=a.n(n),l=a(91),s=a(15),o=a(95),u=a.n(o),c=a(109),d=a(104),m=a(59),p=a(139),f=a(390),h=a(389),y=a(117),g=a(94);const b="timeline-filter-drop-area",v=(e=[])=>e.filter((e=>e.meta.controlledBy!==b)),E=Object(n.memo)((({dataProviders:e,filters:t,filterManager:a,filterQuery:i,from:o,fromStr:m,kqlMode:E,isRefreshPaused:O,savedQueryId:k,setFilters:x,setSavedQueryId:w,refreshInterval:j,timelineId:I,to:P,toStr:C,updateReduxTime:F})=>{const M=Object(l.useDispatch)(),[T,Q]=Object(n.useState)(null!=m?m:new Date(o).toISOString()),[q,N]=Object(n.useState)(null!=C?C:new Date(P).toISOString()),{browserFields:D,indexPattern:R}=Object(c.c)(d.SourcererScopeName.timeline),[A,_]=Object(n.useState)(void 0),[z,K]=Object(n.useState)({query:null!=i?i.expression:"",language:null!=i?i.kind:"kuery"}),[B,L]=Object(n.useState)(v(t)),[W,H]=Object(n.useState)(Object(p.a)(Object(y.g)(e,D),R)),U=Object(f.a)(),$=Object(n.useCallback)(((e,t)=>M(g.a.applyKqlFilterQuery({id:I,filterQuery:{kuery:{kind:t,expression:e},serializedQuery:Object(p.a)(e,R)}}))),[M,R,I]);Object(n.useEffect)((()=>{let e=!0;const i=new s.Subscription;return a.setFilters(t),i.add(a.getUpdates$().subscribe({next:()=>{if(e){const e=v(a.getFilters());x(e),L(e)}}})),()=>{e=!1,i.unsubscribe()}}),[]),Object(n.useEffect)((()=>{const e=v(a.getFilters());u()(t,e)||a.setFilters(t)}),[t]),Object(n.useEffect)((()=>{K({query:null!=i?i.expression:"",language:null!=i?i.kind:"kuery"})}),[i]),Object(n.useEffect)((()=>{H(Object(p.a)(Object(y.g)(e,D),R))}),[e,D,R]),Object(n.useEffect)((()=>{null!=m&&null!=C?(Q(m),N(C)):null!=o&&null!=P&&(Q(new Date(o).toISOString()),N(new Date(P).toISOString()))}),[o,m,P,C]),Object(n.useEffect)((()=>{let e=!0;return async function(){if(null!=k&&null!=U)try{const a=await U.getSavedQuery(k);e&&null!=a&&_({...a,attributes:{...a.attributes,filters:v(t)}})}catch(e){_(void 0)}else e&&_(void 0)}(),()=>{e=!1}}),[k]);const G=Object(n.useCallback)(((e,t)=>{if((null==i||null!=i&&i.expression!==e.query||i.kind!==e.language)&&$(e.query,e.language),null!=t){const e=t.from.includes("now")||t.to.includes("now");F({id:"timeline",end:t.to,start:t.from,isInvalid:!1,isQuickSelection:e,timelineId:I})}}),[i,I]),V=Object(n.useCallback)((e=>{if(null!=e){if(e.id!==k&&w(e.id),null!=U&&""!==W){const t=null!=e.attributes.filters?e.attributes.filters.findIndex((e=>e.meta.controlledBy===b)):-1;U.updateQuery(e.id,{...e.attributes,filters:null!=e.attributes.filters?t>-1?[...e.attributes.filters.slice(0,t),S(W),...e.attributes.filters.slice(t+1)]:[...e.attributes.filters,S(W)]:[]})}}else w(null)}),[W,k,U]);return r.a.createElement(h.a,{dateRangeFrom:T,dateRangeTo:q,hideSavedQuery:"search"===E,indexPattern:R,isRefreshPaused:O,filterQuery:z,filterManager:a,filters:B,onSubmitQuery:G,refreshInterval:j,savedQuery:A,onSavedQuery:V,dataTestSubj:"timelineQueryInput"})})),S=e=>{const t=JSON.parse(e),a=Object.keys(t);return{...t,meta:{alias:b,controlledBy:b,negate:!1,disabled:!1,type:"custom",key:Object(i.isEmpty)(a)?"bool":a[0],value:e},$state:{store:m.esFilters.FilterStateStore.APP_STATE}}}},523:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var i=a(9),n=a.n(i),r=a(91),l=a(201);const s=({id:e,inputId:t,inspect:a,loading:n,refetch:s,skip:o})=>{const u=Object(r.useDispatch)();return Object(i.useEffect)((()=>{o||u(l.b.setQuery({id:e,inputId:t,inspect:a,loading:n,refetch:s}))}),[u,e,t,n,s,a,o]),null},o=n.a.memo(s)},548:function(e,t,a){"use strict";a.d(t,"a",(function(){return j}));var i=a(55),n=a(95),r=a.n(n),l=a(9),s=a.n(l),o=a(91),u=a(56),c=a.n(u),d=a(104),m=a(314);const p=()=>{const e=m.d.kibanaIndexPatternsSelector(),t=m.d.scopeIdSelector(),a=m.d.configIndexPatternsSelector(),i=m.d.signalIndexNameSelector();return(n,r)=>{const l=e(n),s=t(n,r);return{kibanaIndexPatterns:l,configIndexPatterns:a(n),signalIndexName:i(n),sourcererScope:s}}};var f=a(350);const h=c.a.div.withConfig({displayName:"PopoverContent",componentId:"sc-13xuah3-0"})(["width:600px;"]),y=c()(i.EuiButtonEmpty).withConfig({displayName:"ResetButton",componentId:"sc-13xuah3-1"})(["width:fit-content;"]),g=c()(i.EuiButton).withConfig({displayName:"MyEuiButton",componentId:"sc-13xuah3-2"})([".euiHealth{vertical-align:middle;}"]),b=c()(i.EuiHealth).withConfig({displayName:"AllEuiHealth",componentId:"sc-13xuah3-3"})(["margin-left:-2px;svg{stroke:#fff;stroke-width:1px;stroke-linejoin:round;width:19px;height:19px;margin-top:1px;z-index:1;}"]),v=c()(i.EuiHealth).withConfig({displayName:"WarningEuiHealth",componentId:"sc-13xuah3-4"})(["margin-left:-17px;svg{z-index:0;}"]),E=c()(i.EuiText).withConfig({displayName:"AdvancedSettings",componentId:"sc-13xuah3-5"})(["color:",";"],(({theme:e})=>e.eui.euiColorPrimary)),S=c()(i.EuiText).withConfig({displayName:"ConfigHelper",componentId:"sc-13xuah3-6"})(["margin-left:4px;"]),O=c()(i.EuiRadioGroup).withConfig({displayName:"Filter",componentId:"sc-13xuah3-7"})(["margin-left:4px;"]),k=c.a.div.withConfig({displayName:"PickEventContainer",componentId:"sc-13xuah3-8"})([".euiSuperSelect{width:170px;max-width:170px;button.euiSuperSelectControl{padding-top:3px;}}"]),x=(e=!0)=>[{id:"all",label:s.a.createElement(b,{color:"subdued"},s.a.createElement(v,{color:"warning"},f.a))},{id:"raw",label:s.a.createElement(i.EuiHealth,{color:"subdued"}," ",f.m)},{id:"alert",label:s.a.createElement(i.EuiHealth,{color:"warning"}," ",f.e)},{id:"custom",label:s.a.createElement(s.a.Fragment,null,f.c),disabled:e}],w=({eventType:e="all",onChangeEventTypeAndIndexesName:t})=>{const[a,n]=Object(l.useState)(!1),[u,c]=Object(l.useState)("custom"===e),[m,b]=Object(l.useState)(e),v=Object(l.useMemo)(p,[]),{configIndexPatterns:w,kibanaIndexPatterns:j,signalIndexName:I,sourcererScope:P}=Object(o.useSelector)((e=>v(e,d.SourcererScopeName.timeline)),r.a),[C,F]=Object(l.useState)(P.selectedPatterns.map((e=>({label:e,value:e})))),M=Object(l.useMemo)((()=>[...w,...j.map((e=>e.title)),I].reduce(((e,t)=>null==t||e.some((e=>e.label===t))?e:[...e,{label:t,value:t}]),[])),[w,j,I]),T=Object(l.useCallback)((({value:e})=>j.some((t=>t.title===e))?s.a.createElement("span",{"data-test-subj":"sourcerer-option"},s.a.createElement(i.EuiIcon,{type:"logoKibana",size:"s"})," ",e):s.a.createElement("span",{"data-test-subj":"sourcerer-option"},e)),[j]),Q=Object(l.useCallback)((e=>{const t=e.map((e=>e.label));t.sort().join()===[...w,I].sort().join()?b("all"):t.sort().join()===w.sort().join()?b("raw"):t.sort().join()===I?b("alert"):b("custom"),F(e)}),[w,I]),q=Object(l.useCallback)((e=>{b(e),"all"===e?F([...w.sort(),null!=I?I:""].map((e=>({label:e,value:e})))):"raw"===e?F(w.sort().map((e=>({label:e,value:e})))):"alert"===e?F([{label:null!=I?I:"",value:null!=I?I:""}]):"kibana"===e&&F(j.map((e=>({label:e.title,value:e.title}))))}),[w,j,I]),N=Object(l.useCallback)((()=>n((e=>!e))),[]),D=Object(l.useCallback)((()=>n(!1)),[]),R=Object(l.useCallback)((()=>{t(m,C.map((e=>e.label))),n(!1)}),[m,t,C]),A=Object(l.useCallback)((()=>{q("all")}),[q]),_=Object(l.useMemo)((()=>s.a.createElement(i.EuiComboBox,{"data-test-subj":"timeline-sourcerer",fullWidth:!0,onChange:Q,options:M,placeholder:f.l,renderOption:T,selectedOptions:C})),[Q,M,T,C]),z=Object(l.useMemo)((()=>x("custom"!==m)),[m]),K=Object(l.useMemo)((()=>s.a.createElement(O,{"data-test-subj":"timeline-sourcerer-radio",options:z,idSelected:m,onChange:q,name:f.s})),[m,z,q]),B=Object(l.useMemo)((()=>{var t;const a=x();return s.a.createElement(g,{"data-test-subj":"sourcerer-timeline-trigger",iconType:"arrowDown",iconSide:"right",isLoading:P.loading,onClick:N},null===(t=a.find((t=>t.id===e)))||void 0===t?void 0:t.label)}),[e,P.loading,N]),L=Object(l.useMemo)((()=>a?null:P.selectedPatterns.sort().join(", ")),[a,P.selectedPatterns]),W=Object(l.useMemo)((()=>L?s.a.createElement(i.EuiToolTip,{position:"top",content:L,"data-test-subj":"timeline-sourcerer-tooltip"},B):B),[B,L]),H=Object(l.useMemo)((()=>s.a.createElement(E,{"data-test-subj":"advanced-settings"},u?f.k:f.t)),[u]);return Object(l.useEffect)((()=>{const e=P.selectedPatterns.map((e=>({label:e,value:e})));F((t=>r()(e,t)?t:e))}),[P.selectedPatterns]),Object(l.useEffect)((()=>{b((t=>t!==e?e:t)),c("custom"===e)}),[e]),s.a.createElement(k,null,s.a.createElement(i.EuiPopover,{button:W,closePopover:D,id:"popover",isOpen:a,repositionOnScroll:!0},s.a.createElement(h,null,s.a.createElement(i.EuiPopoverTitle,null,s.a.createElement(s.a.Fragment,null,f.s)),s.a.createElement(i.EuiSpacer,{size:"s"}),K,s.a.createElement(i.EuiSpacer,{size:"m"}),s.a.createElement(i.EuiAccordion,{id:"accordion1",forceState:u?"open":"closed",buttonContent:H,onToggle:c},s.a.createElement(s.a.Fragment,null,s.a.createElement(i.EuiSpacer,{size:"s"}),_)),!u&&s.a.createElement(s.a.Fragment,null,s.a.createElement(i.EuiSpacer,{size:"s"}),s.a.createElement(S,{size:"s",color:"subdued"},f.b)),s.a.createElement(i.EuiSpacer,{size:"m"}),s.a.createElement(i.EuiFlexGroup,{alignItems:"center",justifyContent:"spaceBetween"},s.a.createElement(i.EuiFlexItem,null,s.a.createElement(y,{"aria-label":f.d,"data-test-subj":"sourcerer-reset",flush:"left",onClick:A,title:f.d},f.d)),s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(i.EuiButton,{onClick:R,"data-test-subj":"add-index",fill:!0,fullWidth:!0,size:"s"},f.n))))))},j=Object(l.memo)(w)},549:function(e,t,a){"use strict";a.d(t,"a",(function(){return h}));var i=a(55),n=a(9),r=a.n(n),l=a(91),s=a(156),o=a(93),u=a(2);const c=u.i18n.translate("xpack.securitySolution.timeline.properties.lockDatePickerTooltip",{defaultMessage:"Disable syncing of date/time range bteween the currently viewed page and your timeline"}),d=u.i18n.translate("xpack.securitySolution.timeline.properties.unlockDatePickerTooltip",{defaultMessage:"Enable syncing of date/time range between the currently viewed page and your timeline"}),m=(u.i18n.translate("xpack.securitySolution.timeline.properties.lockedDatePickerLabel",{defaultMessage:"Global date picker is locked to timeline date picker"}),u.i18n.translate("xpack.securitySolution.timeline.properties.unlockedDatePickerLabel",{defaultMessage:"Global date picker NOT locked to timeline date picker"}),u.i18n.translate("xpack.securitySolution.timeline.properties.lockDatePickerDescription",{defaultMessage:"Lock global date picker to timeline date picker"})),p=u.i18n.translate("xpack.securitySolution.timeline.properties.unlockDatePickerDescription",{defaultMessage:"Unlock global date picker from timeline date picker"}),f=()=>{const e=Object(l.useDispatch)(),t=Object(n.useMemo)((()=>s.d.globalSelector()),[]),a=Object(o.b)((e=>t(e).linkTo.includes("timeline"))),u=Object(n.useCallback)((()=>e(s.b.toggleTimelineLinkTo({linkToId:"timeline"}))),[e]);return r.a.createElement(i.EuiToolTip,{"data-test-subj":"timeline-date-picker-lock-tooltip",position:"top",content:a?c:d},r.a.createElement(i.EuiButtonIcon,{"data-test-subj":`timeline-date-picker-${a?"lock":"unlock"}-button`,color:"primary",onClick:u,iconType:a?"lock":"lockOpen","aria-label":a?p:m}))};f.displayName="TimelineDatePickerLockComponent";const h=r.a.memo(f)}}]);