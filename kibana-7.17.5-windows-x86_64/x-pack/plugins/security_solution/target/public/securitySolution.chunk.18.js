/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.securitySolution_bundle_jsonpfunction=window.securitySolution_bundle_jsonpfunction||[]).push([[18],{1365:function(e,t,n){"use strict";n.r(t),n.d(t,"EqlTabContentComponent",(function(){return se})),n.d(t,"default",(function(){return ce}));var a=n(55),i=n(19),l=n(9),r=n.n(l),o=n(56),s=n.n(o),c=n(91),u=n(95),d=n.n(u),m=n(217),p=n(94),g=n(537),b=n(178),f=n(526),E=n(547),y=n(117),h=n(523),v=n(20),x=n(245),O=n(388),k=n(262),S=n(349),j=n(548),w=n(110),F=n(135),C=n(104),q=n(105),I=n(109),T=n(387),P=n(549),M=n(128),N=n(243),L=n(309),D=n(58),B=n(93),Q=n(528),z=n(353),A=n(124);const V=n(2).i18n.translate("xpack.securitySolution.timeline.EqlQueryBarLabel",{defaultMessage:"EQL query"});var R=n(112),_=n(315);const H={index:[],eqlQueryBar:{query:{query:"",language:"eql"},filters:[],saved_id:void 0}},K={index:{fieldsToValidateOnChange:["index","eqlQueryBar"],validations:[]},eqlQueryBar:{validations:[{validator:Object(z.a)(z.b,300)}]}},G=s()(A.f).withConfig({displayName:"HiddenUseField",componentId:"sc-fj97qw-0"})(["display:none;"]),$=Object(l.memo)((({timelineId:e})=>{var t;const n=Object(c.useDispatch)(),a=Object(l.useRef)(!0),[i,o]=Object(l.useState)(!1),[s,u]=Object(l.useState)(!1),d=Object(l.useMemo)((()=>Object(R.createSelector)(_.selectTimeline,(e=>{var t;return null!==(t=null==e?void 0:e.eqlOptions)&&void 0!==t?t:{eventCategoryField:[{label:"event.category"}],tiebreakerField:[{label:""}],timestampField:[{label:"@timestamp"}],size:100,query:""}}))),[]),m=Object(B.a)((t=>d(t,e))),{loading:g,indexPattern:b,selectedPatterns:f}=Object(I.c)(C.SourcererScopeName.timeline),E={...H,index:f.sort(),eqlQueryBar:{...H.eqlQueryBar,query:{query:null!==(t=m.query)&&void 0!==t?t:"",language:"eql"}}},{form:y}=Object(A.l)({defaultValue:E,options:{stripEmptyFields:!1},schema:K}),{getFields:h}=y,v=Object(l.useCallback)(((t,a)=>n(p.a.updateEqlOptions({id:e,field:t,value:a}))),[n,e]),[{eqlQueryBar:x}]=Object(A.n)({form:y,watch:["eqlQueryBar"]}),O=Object(l.useMemo)((()=>Object(D.isEmpty)(b.fields)?{keywordFields:[],dateFields:[],nonDateFields:[]}:{keywordFields:b.fields.filter((e=>{var t;return null===(t=e.esTypes)||void 0===t?void 0:t.includes("keyword")})).map((e=>({label:e.name}))),dateFields:b.fields.filter((e=>"date"===e.type)).map((e=>({label:e.name}))),nonDateFields:b.fields.filter((e=>"date"!==e.type)).map((e=>({label:e.name})))}),[b]);return Object(l.useEffect)((()=>{const{index:e}=h(),t=f.sort(),n=e.value.sort();Object(D.isEqual)(n,t)||e.setValue(t)}),[h,f]),Object(l.useEffect)((()=>{const{eqlQueryBar:e}=h();var t;a.current&&(a.current=!1,u(!0),e.setValue({...H.eqlQueryBar,query:{query:null!==(t=m.query)&&void 0!==t?t:"",language:"eql"}}));return()=>{a.current=!0}}),[h,m.query]),Object(l.useEffect)((()=>{null==x||Object(D.isEmpty)(x.query.query)||!i||s||(n(p.a.updateEqlOptions({id:e,field:"query",value:`${x.query.query}`})),o(!1),u(!1))}),[n,x,i,s,e]),r.a.createElement(A.d,{form:y,"data-test-subj":"EqlQueryBarTimeline"},r.a.createElement(G,{key:"Index",path:"index"}),r.a.createElement(A.f,{key:"EqlQueryBar",path:"eqlQueryBar",component:Q.a,componentProps:{optionsData:O,optionsSelected:m,onOptionsChange:v,onValidityChange:o,onValiditingChange:u,idAria:"timelineEqlQueryBar",isDisabled:g,isLoading:g,dataTestSubj:"timelineEqlQueryBar"},config:{...K.eqlQueryBar,label:V}}))}));var W=n(524),U=n(311);const X=s.a.div.withConfig({displayName:"TimelineHeaderContainer",componentId:"sc-1f3fsnr-0"})(["margin-top:6px;width:100%;"]);X.displayName="TimelineHeaderContainer";const J=s()(a.EuiFlyoutHeader).withConfig({displayName:"StyledEuiFlyoutHeader",componentId:"sc-1f3fsnr-1"})(["align-items:stretch;box-shadow:none;display:flex;flex-direction:column;padding:0;&.euiFlyoutHeader{","}"],(({theme:e})=>`padding: 0 ${e.eui.euiSizeS} ${e.eui.euiSizeS} ${e.eui.euiSizeS};`)),Y=s()(a.EuiFlyoutBody).withConfig({displayName:"StyledEuiFlyoutBody",componentId:"sc-1f3fsnr-2"})(["overflow-y:hidden;flex:1;.euiFlyoutBody__overflow{overflow:hidden;mask-image:none;}.euiFlyoutBody__overflowContent{padding:0;height:100%;display:flex;}"]),Z=s()(a.EuiFlyoutFooter).withConfig({displayName:"StyledEuiFlyoutFooter",componentId:"sc-1f3fsnr-3"})(["background:none;padding:0;&.euiFlyoutFooter{","}"],(({theme:e})=>`padding: ${e.eui.euiSizeS} 0 0 0;`)),ee=s()(a.EuiFlexGroup).withConfig({displayName:"FullWidthFlexGroup",componentId:"sc-1f3fsnr-4"})(["margin:0;width:100%;overflow:hidden;"]),te=s()(a.EuiFlexItem).withConfig({displayName:"ScrollableFlexItem",componentId:"sc-1f3fsnr-5"})(["overflow:hidden;"]),ne=s()(a.EuiFlexItem).withConfig({displayName:"DatePicker",componentId:"sc-1f3fsnr-6"})([".euiSuperDatePicker__flexWrapper{max-width:none;width:auto;}"]);ne.displayName="DatePicker";const ae=s.a.div.withConfig({displayName:"VerticalRule",componentId:"sc-1f3fsnr-7"})(["width:2px;height:100%;background:",";"],(({theme:e})=>e.eui.euiColorLightShade));ae.displayName="VerticalRule";const ie=s()(a.EuiBadge).withConfig({displayName:"EventsCountBadge",componentId:"sc-1f3fsnr-8"})(["margin-left:",";"],(({theme:e})=>e.eui.paddingSizes.s)),le=[],re=[],oe=[],se=({activeTab:e,columns:t,end:n,eqlOptions:o,eventType:s,expandedDetail:u,timelineId:d,isLive:w,itemsPerPage:F,itemsPerPageOptions:q,onEventClosed:D,renderCellValue:B,rowRenderers:Q,showExpandedDetails:z,start:A,timerangeKind:V,updateEventTypeAndIndexesName:R})=>{var _;const H=Object(c.useDispatch)(),{query:K="",...G}=o,{portalNode:se}=Object(T.c)(),{setTimelineFullScreen:ce,timelineFullScreen:ue}=Object(M.b)(),{browserFields:de,docValueFields:me,loading:pe,selectedPatterns:ge}=Object(I.c)(C.SourcererScopeName.timeline),be=Object(i.isEmpty)(K);Object(l.useEffect)((()=>{H(p.a.initializeTGridSettings({id:d}))}),[H,d]);const[fe,{events:Ee,inspect:ye,totalCount:he,pageInfo:ve,loadPage:xe,updatedAt:Oe,refetch:ke}]=Object(g.a)({docValueFields:me,endDate:n,eqlOptions:G,id:d,indexNames:ge,fields:[...(Object(i.isEmpty)(t)?b.b:t).map((e=>e.id)),...x.k],language:"eql",limit:F,filterQuery:null!=K?K:"",startDate:A,skip:!!(null==pe||pe||Object(i.isEmpty)(A)||Object(i.isEmpty)(n)||be),timerangeKind:V}),Se=Object(l.useCallback)((()=>{var e;D({tabType:v.w.eql,timelineId:d}),null!==(e=u[v.w.eql])&&void 0!==e&&e.panelView&&d===v.q.active&&z&&N.a.toggleExpandedDetail({})}),[D,d,u,z]);Object(l.useEffect)((()=>{H(p.a.updateIsLoading({id:d,isLoading:fe||pe}))}),[pe,d,fe,H]);const je=Object(l.useMemo)((()=>Object(U.a)(5).map((e=>({...e,headerCellRender:W.a})))),[]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(m.a,{node:se},he>=0?r.a.createElement(ie,null,he):null),r.a.createElement(h.a,{id:`${d}-${v.w.eql}`,inputId:"timeline",inspect:ye,loading:fe,refetch:ke}),r.a.createElement(ee,null,r.a.createElement(te,{grow:2},r.a.createElement(J,{"data-test-subj":`${e}-tab-flyout-header`,hasBorder:!1},r.a.createElement(a.EuiFlexGroup,{alignItems:"center",gutterSize:"s","data-test-subj":"timeline-date-picker-container"},ue&&null!=ce&&r.a.createElement(O.b,{fullScreen:ue,setFullScreen:ce}),r.a.createElement(ne,{grow:1},r.a.createElement(k.a,{id:"timeline",timelineId:d})),r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(P.a,null)),r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(j.a,{eventType:s,onChangeEventTypeAndIndexesName:R}))),r.a.createElement(X,{"data-test-subj":"timelineHeader"},r.a.createElement($,{timelineId:d}))),r.a.createElement(S.a,null,r.a.createElement(Y,{"data-test-subj":`${v.w.eql}-tab-flyout-body`,className:"timeline-flyout-body"},r.a.createElement(f.a,{activePage:ve.activePage,browserFields:de,data:be?le:Ee,id:d,refetch:ke,renderCellValue:B,rowRenderers:Q,sort:re,tabType:v.w.eql,totalPages:Object(y.h)({itemsCount:he,itemsPerPage:F}),leadingControlColumns:je,trailingControlColumns:oe})),r.a.createElement(Z,{"data-test-subj":`${v.w.eql}-tab-flyout-footer`,className:"timeline-flyout-footer"},!be&&r.a.createElement(E.a,{activePage:null!==(_=null==ve?void 0:ve.activePage)&&void 0!==_?_:0,"data-test-subj":"timeline-footer",updatedAt:Oe,height:E.b,id:d,isLive:w,isLoading:fe||pe,itemsCount:be?0:Ee.length,itemsPerPage:F,itemsPerPageOptions:q,onChangePage:xe,totalCount:be?0:he})))),z&&r.a.createElement(r.a.Fragment,null,r.a.createElement(ae,null),r.a.createElement(te,{grow:1},r.a.createElement(L.a,{browserFields:de,docValueFields:me,tabType:v.w.eql,timelineId:d,handleOnPanelClosed:Se})))))},ce=Object(c.connect)((()=>{const e=p.b.getTimelineByIdSelector(),t=w.e.getTimelineSelector();return(n,{timelineId:a})=>{var i,l;const r=null!==(i=e(n,a))&&void 0!==i?i:q.a,o=t(n),{activeTab:s,columns:c,eqlOptions:u,eventType:d,expandedDetail:m,itemsPerPage:p,itemsPerPageOptions:g}=r;return{activeTab:s,columns:c,eqlOptions:u,eventType:null!=d?d:"raw",end:o.timerange.to,expandedDetail:m,timelineId:a,isLive:"interval"===o.policy.kind,itemsPerPage:p,itemsPerPageOptions:g,showExpandedDetails:!!m[v.w.eql]&&!(null===(l=m[v.w.eql])||void 0===l||!l.panelView),start:o.timerange.from,timerangeKind:o.timerange.kind}}}),((e,{timelineId:t})=>({updateEventTypeAndIndexesName:(n,a)=>{e(p.a.updateEventType({id:t,eventType:n})),e(p.a.updateIndexNames({id:t,indexNames:a})),e(F.a.setSelectedIndexPatterns({id:C.SourcererScopeName.timeline,selectedPatterns:a}))},onEventClosed:t=>{e(p.a.toggleDetailPanel(t))}})))(r.a.memo(se,((e,t)=>e.activeTab===t.activeTab&&((e,t)=>e.end===t.end&&e.start===t.start&&e.timerangeKind===t.timerangeKind)(e,t)&&d()(e.eqlOptions,t.eqlOptions)&&e.eventType===t.eventType&&e.isLive===t.isLive&&e.itemsPerPage===t.itemsPerPage&&e.onEventClosed===t.onEventClosed&&e.showExpandedDetails===t.showExpandedDetails&&e.timelineId===t.timelineId&&e.updateEventTypeAndIndexesName===t.updateEventTypeAndIndexesName&&d()(e.columns,t.columns)&&d()(e.itemsPerPageOptions,t.itemsPerPageOptions))))},195:function(e,t,n){"use strict";n.d(t,"m",(function(){return i})),n.d(t,"k",(function(){return l})),n.d(t,"l",(function(){return r})),n.d(t,"i",(function(){return o})),n.d(t,"j",(function(){return s})),n.d(t,"h",(function(){return c})),n.d(t,"g",(function(){return u})),n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return m})),n.d(t,"d",(function(){return p})),n.d(t,"c",(function(){return g})),n.d(t,"f",(function(){return b})),n.d(t,"e",(function(){return f}));var a=n(2);const i=a.i18n.translate("xpack.securitySolution.detectionEngine.eqlValidation.requestError",{defaultMessage:"An error occurred while validating your EQL query"}),l=a.i18n.translate("xpack.securitySolution.detectionEngine.eqlValidation.title",{defaultMessage:"EQL Validation Errors"}),r=a.i18n.translate("xpack.securitySolution.detectionEngine.eqlValidation.showErrorsLabel",{defaultMessage:"Show EQL Validation Errors"}),o=(a.i18n.translate("xpack.securitySolution.detectionEngine.eqlQueryBar.label",{defaultMessage:"Enter an EQL Query"}),a.i18n.translate("xpack.securitySolution.detectionEngine.eqlOverViewLink.text",{defaultMessage:"Event Query Language (EQL) Overview"})),s=a.i18n.translate("xpack.securitySolution.detectionEngine.eqlSettings.title",{defaultMessage:"EQL settings"}),c=a.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsSize.label",{defaultMessage:"Size"}),u=a.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsSize.text",{defaultMessage:"For basic queries, the maximum number of matching events to return. For sequence queries, the maximum number of matching sequences to return."}),d=a.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsEventCategoryField.label",{defaultMessage:"Event category field"}),m=a.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsEventCategoryField.text",{defaultMessage:"Field containing the event classification, such as process, file, or network. This field is typically mapped as a field type in the keyword family"}),p=a.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsEventTiebreakerField.label",{defaultMessage:"Tiebreaker field"}),g=a.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsEventTiebreakerField.text",{defaultMessage:"Field used to sort hits with the same timestamp in ascending, lexicographic order"}),b=a.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsEventTimestampField.label",{defaultMessage:"Timestamp field"}),f=a.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsEventTimestampField.text",{defaultMessage:"Field containing event timestamp"})},350:function(e,t,n){"use strict";n.d(t,"f",(function(){return i})),n.d(t,"i",(function(){return l})),n.d(t,"g",(function(){return r})),n.d(t,"h",(function(){return o})),n.d(t,"o",(function(){return s})),n.d(t,"r",(function(){return c})),n.d(t,"p",(function(){return u})),n.d(t,"q",(function(){return d})),n.d(t,"j",(function(){return m})),n.d(t,"a",(function(){return p})),n.d(t,"m",(function(){return g})),n.d(t,"e",(function(){return b})),n.d(t,"c",(function(){return f})),n.d(t,"s",(function(){return E})),n.d(t,"b",(function(){return y})),n.d(t,"n",(function(){return h})),n.d(t,"t",(function(){return v})),n.d(t,"k",(function(){return x})),n.d(t,"d",(function(){return O})),n.d(t,"l",(function(){return k}));var a=n(2);const i=a.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.filterDescription",{defaultMessage:"Events from the data providers above are filtered by the adjacent KQL"}),l=a.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.filterKqlTooltip",{defaultMessage:"Events from the data providers above are filtered by this KQL"}),r=a.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.filterKqlPlaceholder",{defaultMessage:"Filter events"}),o=a.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.filterKqlSelectedText",{defaultMessage:"Filter"}),s=a.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.searchDescription",{defaultMessage:"Events from the data providers above are combined with results from the adjacent KQL"}),c=a.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.searchKqlTooltip",{defaultMessage:"Events from the data providers above are combined with results from this KQL"}),u=a.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.searchKqlPlaceholder",{defaultMessage:"Search events"}),d=a.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.searchKqlSelectedText",{defaultMessage:"Search"}),m=a.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.filterOrSearchWithKql",{defaultMessage:"Filter or Search with KQL"}),p=a.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.eventTypeAllEvent",{defaultMessage:"All data sources"}),g=a.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.eventTypeRawEvent",{defaultMessage:"Events"}),b=a.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.eventTypeDetectionAlertsEvent",{defaultMessage:"Detection Alerts"}),f=a.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.customeIndexNames",{defaultMessage:"Custom"}),E=a.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.indexPatterns.help",{defaultMessage:"Data sources selection"}),y=a.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.indexPatterns.configure",{defaultMessage:"View data sources associated with each of the above selections"}),h=a.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.indexPatterns.save",{defaultMessage:"Save"}),v=a.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.indexPatterns.showAdvancedSettings",{defaultMessage:"Show Advanced"}),x=a.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.indexPatterns.hideAdvancedSettings",{defaultMessage:"Hide Advanced"}),O=a.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.indexPatterns.resetSettings",{defaultMessage:"Reset"}),k=a.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.indexPatterns.pickIndexPatternsCombo",{defaultMessage:"Pick index patterns"})},353:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return g})),n.d(t,"c",(function(){return b}));var a=n(58),i=n(175),l=n(90),r=n(60);const o=e=>"parsing_exception"===e||"verification_exception"===e||"mapping_exception"===e,s=e=>Object(a.has)(e,"error.type"),c=e=>e.error.root_cause.filter((e=>o(e.type))).map((e=>e.reason)),u=async({data:e,index:t,query:n,signal:i})=>{const{rawResponse:l}=await e.search.search({params:{index:t.join(),body:{query:n,size:0}},options:{ignore:[400]}},{strategy:r.EQL_SEARCH_STRATEGY,abortSignal:i}).toPromise();if((e=>s(e)&&o(Object(a.get)(e,"error.type")))(l.body))return{valid:!1,errors:c(l.body)};if(s(l.body))throw new Error(JSON.stringify(l.body));return{valid:!0,errors:[]}};var d=n(195);let m;!function(e){e.FAILED_REQUEST="ERR_FAILED_REQUEST",e.INVALID_EQL="ERR_INVALID_EQL"}(m||(m={}));const p=(e,t)=>{let n,a=[];return(...i)=>(n&&clearTimeout(n),n=setTimeout((()=>{const t=e(...i);a.forEach((e=>e(t))),a=[]}),t),new Promise((e=>a.push(e))))},g=async(...e)=>{const[{value:t,formData:n}]=e,{query:r}=t,o=r.query,{index:s,ruleType:c}=n;if(void 0===c&&!Object(a.isEmpty)(o)||Object(i.c)(c)&&!Object(a.isEmpty)(o))try{const{data:e}=l.b.get(),t=(new AbortController).signal,n=await u({data:e,query:o,signal:t,index:s});if(!1===(null==n?void 0:n.valid))return{code:m.INVALID_EQL,message:"",messages:n.errors}}catch(e){return{code:m.FAILED_REQUEST,message:d.m,error:e}}},b=e=>{const t=e.errors.length>0,n=!e.isChangingValue&&!t;if(t){const[t]=e.errors,a=t.message;return t.code===m.INVALID_EQL?{isValid:n,message:a,messages:t.messages}:{isValid:n,message:a,error:t.error}}return{isValid:n,message:""}}},523:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(9),i=n.n(a),l=n(91),r=n(201);const o=({id:e,inputId:t,inspect:n,loading:i,refetch:o,skip:s})=>{const c=Object(l.useDispatch)();return Object(a.useEffect)((()=>{s||c(r.b.setQuery({id:e,inputId:t,inspect:n,loading:i,refetch:o}))}),[c,e,t,i,o,n,s]),null},s=i.a.memo(o)},528:function(e,t,n){"use strict";n.d(t,"a",(function(){return S}));var a=n(9),i=n.n(a),l=n(56),r=n.n(l),o=n(55),s=n(97),c=n(195),u=n(58);const d=({ariaLabel:e,errors:t})=>{const[n,l]=Object(a.useState)(!1),r=Object(a.useCallback)((()=>{l(!n)}),[n]),s=Object(a.useCallback)((()=>{l(!1)}),[]);return i.a.createElement(o.EuiPopover,{"data-test-subj":"eql-validation-errors-popover",button:i.a.createElement(o.EuiButtonEmpty,{"data-test-subj":"eql-validation-errors-popover-button",iconType:"crossInACircleFilled",size:"s",color:"danger","aria-label":e,onClick:r},t.length),isOpen:n,closePopover:s,anchorPosition:"downCenter"},i.a.createElement("div",{"data-test-subj":"eql-validation-errors-popover-content"},i.a.createElement(o.EuiPopoverTitle,null,c.k),t.map(((e,t)=>i.a.createElement(o.EuiText,{key:t},e)))))};var m=n(90);const p=r()(o.EuiText).withConfig({displayName:"InlineText",componentId:"sc-i91hzt-0"})(["display:inline-block;"]),g=()=>{const e=Object(m.j)().services.docLinks.links.query.eql;return i.a.createElement(o.EuiLink,{external:!0,href:e,target:"_blank"},i.a.createElement(p,{size:"xs"},c.i))},b=r()(o.EuiPanel).withConfig({displayName:"Container",componentId:"sc-10yczbx-0"})(["border-radius:0;background:",";padding:"," ",";"],(({theme:e})=>e.eui.euiPageBackgroundColor),(({theme:e})=>e.eui.euiSizeXS),(({theme:e})=>e.eui.euiSizeS)),f=r()(o.EuiFlexGroup).withConfig({displayName:"FlexGroup",componentId:"sc-10yczbx-1"})(["min-height:",";"],(({theme:e})=>e.eui.euiSizeXL)),E=r()(o.EuiFlexItem).withConfig({displayName:"FlexItemLeftBorder",componentId:"sc-10yczbx-2"})(["border-left:1px solid ",";"],(({theme:e})=>e.eui.euiColorLightShade)),y=r()(o.EuiFlexItem).withConfig({displayName:"FlexItemWithMarginRight",componentId:"sc-10yczbx-3"})(["margin-right:",";"],(({theme:e})=>e.eui.euiSizeS)),h=r()(o.EuiLoadingSpinner).withConfig({displayName:"Spinner",componentId:"sc-10yczbx-4"})(["margin:0 ",";"],(({theme:e})=>e.eui.euiSizeS)),v={asPlainText:!0},x=({errors:e,isLoading:t,optionsData:n,optionsSelected:l,onOptionsChange:r})=>{var s;const[m,p]=Object(a.useState)(!1),[x,O]=Object(a.useState)(null!==(s=null==l?void 0:l.size)&&void 0!==s?s:100),k=Object(a.useRef)(),S=Object(a.useCallback)((()=>{p(!0)}),[]),j=Object(a.useCallback)((()=>{p(!1)}),[]),w=Object(a.useCallback)((e=>{r&&(e.length>0?r("eventCategoryField",e[0].label):r("eventCategoryField",null))}),[r]),F=Object(a.useCallback)((e=>{r&&(e.length>0?r("tiebreakerField",e[0].label):r("tiebreakerField",null))}),[r]),C=Object(a.useCallback)((e=>{r&&(e.length>0?r("timestampField",e[0].label):r("timestampField",null))}),[r]),q=Object(a.useCallback)((e=>{if(r){var t,n,a,i;if(O(null==e||null===(t=e.target)||void 0===t?void 0:t.value),null!==(n=k.current)&&void 0!==n&&n.cancel)null===(i=k.current)||void 0===i||i.cancel();k.current=Object(u.debounce)((e=>r("size",e)),800),k.current(null==e||null===(a=e.target)||void 0===a?void 0:a.value)}}),[r]),I=Object(a.useMemo)((()=>null!=(null==l?void 0:l.eventCategoryField)?[{label:null==l?void 0:l.eventCategoryField}]:void 0),[null==l?void 0:l.eventCategoryField]),T=Object(a.useMemo)((()=>null!=(null==l?void 0:l.tiebreakerField)?[{label:null==l?void 0:l.tiebreakerField}]:void 0),[null==l?void 0:l.tiebreakerField]),P=Object(a.useMemo)((()=>null!=(null==l?void 0:l.timestampField)?[{label:null==l?void 0:l.timestampField}]:void 0),[null==l?void 0:l.timestampField]);return i.a.createElement(b,null,i.a.createElement(f,{alignItems:"center",justifyContent:"spaceBetween",gutterSize:"none"},i.a.createElement(o.EuiFlexItem,null,e.length>0&&i.a.createElement(d,{ariaLabel:c.l,errors:e}),t&&i.a.createElement(h,{"data-test-subj":"eql-validation-loading",size:"m"})),!r&&i.a.createElement(o.EuiFlexItem,{grow:!1},i.a.createElement(g,null)),r&&i.a.createElement(i.a.Fragment,null,i.a.createElement(y,{grow:!1},i.a.createElement(g,null)),i.a.createElement(E,{grow:!1},i.a.createElement(o.EuiPopover,{button:i.a.createElement(o.EuiButtonIcon,{onClick:S,iconType:"controlsVertical",isDisabled:m,"aria-label":"eql settings","data-test-subj":"eql-settings-trigger"}),isOpen:m,closePopover:j,anchorPosition:"downCenter",ownFocus:!1},i.a.createElement(o.EuiPopoverTitle,null,c.j),i.a.createElement("div",{style:{width:"300px"}},i.a.createElement(o.EuiFormRow,{label:c.h,helpText:c.g},i.a.createElement(o.EuiFieldNumber,{value:x,onChange:q,min:1,max:1e4})),i.a.createElement(o.EuiFormRow,{label:c.b,helpText:c.a},i.a.createElement(o.EuiComboBox,{options:null==n?void 0:n.keywordFields,selectedOptions:I,singleSelection:v,onChange:w})),i.a.createElement(o.EuiFormRow,{label:c.d,helpText:c.c},i.a.createElement(o.EuiComboBox,{options:null==n?void 0:n.nonDateFields,selectedOptions:T,singleSelection:v,onChange:F})),i.a.createElement(o.EuiFormRow,{label:c.f,helpText:c.e},i.a.createElement(o.EuiComboBox,{options:null==n?void 0:n.dateFields,selectedOptions:P,singleSelection:v,onChange:C}))))))))};var O=n(353);const k=r()(o.EuiTextArea).withConfig({displayName:"TextArea",componentId:"sc-4u43ce-0"})(["display:block;border:",";border-bottom:0;box-shadow:none;min-height:",";"],(({theme:e})=>e.eui.euiBorderThin),(({theme:e})=>e.eui.euiFormControlHeight)),S=({dataTestSubj:e,field:t,idAria:n,optionsData:l,optionsSelected:r,onOptionsChange:u,onValidityChange:d,onValiditingChange:m})=>{const{addError:p}=Object(s.a)(),[g,b]=Object(a.useState)([]),{isValidating:f,setValue:E}=t,{isValid:y,message:h,messages:v,error:S}=Object(O.c)(t),j=t.value.query.query;Object(a.useEffect)((()=>{null!=d&&d(y)}),[y,d]),Object(a.useEffect)((()=>{b(null!=v?v:[])}),[v]),Object(a.useEffect)((()=>{S&&p(S,{title:c.m})}),[S,p]),Object(a.useEffect)((()=>{m&&m(f)}),[f,m]);const w=Object(a.useCallback)((e=>{const t=e.target.value;m&&m(!0),b([]),E({filters:[],query:{query:t,language:"eql"}})}),[E,m]);return i.a.createElement(o.EuiFormRow,{label:t.label,labelAppend:t.labelAppend,helpText:t.helpText,error:h,isInvalid:!y&&!f,fullWidth:!0,"data-test-subj":e,describedByIds:n?[n]:void 0},i.a.createElement(i.a.Fragment,null,i.a.createElement(k,{"data-test-subj":"eqlQueryBarTextInput",fullWidth:!0,isInvalid:!y&&!f,value:j,onChange:w}),i.a.createElement(x,{errors:g,isLoading:f,optionsData:l,optionsSelected:r,onOptionsChange:u})))}},548:function(e,t,n){"use strict";n.d(t,"a",(function(){return w}));var a=n(55),i=n(95),l=n.n(i),r=n(9),o=n.n(r),s=n(91),c=n(56),u=n.n(c),d=n(104),m=n(314);const p=()=>{const e=m.d.kibanaIndexPatternsSelector(),t=m.d.scopeIdSelector(),n=m.d.configIndexPatternsSelector(),a=m.d.signalIndexNameSelector();return(i,l)=>{const r=e(i),o=t(i,l);return{kibanaIndexPatterns:r,configIndexPatterns:n(i),signalIndexName:a(i),sourcererScope:o}}};var g=n(350);const b=u.a.div.withConfig({displayName:"PopoverContent",componentId:"sc-13xuah3-0"})(["width:600px;"]),f=u()(a.EuiButtonEmpty).withConfig({displayName:"ResetButton",componentId:"sc-13xuah3-1"})(["width:fit-content;"]),E=u()(a.EuiButton).withConfig({displayName:"MyEuiButton",componentId:"sc-13xuah3-2"})([".euiHealth{vertical-align:middle;}"]),y=u()(a.EuiHealth).withConfig({displayName:"AllEuiHealth",componentId:"sc-13xuah3-3"})(["margin-left:-2px;svg{stroke:#fff;stroke-width:1px;stroke-linejoin:round;width:19px;height:19px;margin-top:1px;z-index:1;}"]),h=u()(a.EuiHealth).withConfig({displayName:"WarningEuiHealth",componentId:"sc-13xuah3-4"})(["margin-left:-17px;svg{z-index:0;}"]),v=u()(a.EuiText).withConfig({displayName:"AdvancedSettings",componentId:"sc-13xuah3-5"})(["color:",";"],(({theme:e})=>e.eui.euiColorPrimary)),x=u()(a.EuiText).withConfig({displayName:"ConfigHelper",componentId:"sc-13xuah3-6"})(["margin-left:4px;"]),O=u()(a.EuiRadioGroup).withConfig({displayName:"Filter",componentId:"sc-13xuah3-7"})(["margin-left:4px;"]),k=u.a.div.withConfig({displayName:"PickEventContainer",componentId:"sc-13xuah3-8"})([".euiSuperSelect{width:170px;max-width:170px;button.euiSuperSelectControl{padding-top:3px;}}"]),S=(e=!0)=>[{id:"all",label:o.a.createElement(y,{color:"subdued"},o.a.createElement(h,{color:"warning"},g.a))},{id:"raw",label:o.a.createElement(a.EuiHealth,{color:"subdued"}," ",g.m)},{id:"alert",label:o.a.createElement(a.EuiHealth,{color:"warning"}," ",g.e)},{id:"custom",label:o.a.createElement(o.a.Fragment,null,g.c),disabled:e}],j=({eventType:e="all",onChangeEventTypeAndIndexesName:t})=>{const[n,i]=Object(r.useState)(!1),[c,u]=Object(r.useState)("custom"===e),[m,y]=Object(r.useState)(e),h=Object(r.useMemo)(p,[]),{configIndexPatterns:j,kibanaIndexPatterns:w,signalIndexName:F,sourcererScope:C}=Object(s.useSelector)((e=>h(e,d.SourcererScopeName.timeline)),l.a),[q,I]=Object(r.useState)(C.selectedPatterns.map((e=>({label:e,value:e})))),T=Object(r.useMemo)((()=>[...j,...w.map((e=>e.title)),F].reduce(((e,t)=>null==t||e.some((e=>e.label===t))?e:[...e,{label:t,value:t}]),[])),[j,w,F]),P=Object(r.useCallback)((({value:e})=>w.some((t=>t.title===e))?o.a.createElement("span",{"data-test-subj":"sourcerer-option"},o.a.createElement(a.EuiIcon,{type:"logoKibana",size:"s"})," ",e):o.a.createElement("span",{"data-test-subj":"sourcerer-option"},e)),[w]),M=Object(r.useCallback)((e=>{const t=e.map((e=>e.label));t.sort().join()===[...j,F].sort().join()?y("all"):t.sort().join()===j.sort().join()?y("raw"):t.sort().join()===F?y("alert"):y("custom"),I(e)}),[j,F]),N=Object(r.useCallback)((e=>{y(e),"all"===e?I([...j.sort(),null!=F?F:""].map((e=>({label:e,value:e})))):"raw"===e?I(j.sort().map((e=>({label:e,value:e})))):"alert"===e?I([{label:null!=F?F:"",value:null!=F?F:""}]):"kibana"===e&&I(w.map((e=>({label:e.title,value:e.title}))))}),[j,w,F]),L=Object(r.useCallback)((()=>i((e=>!e))),[]),D=Object(r.useCallback)((()=>i(!1)),[]),B=Object(r.useCallback)((()=>{t(m,q.map((e=>e.label))),i(!1)}),[m,t,q]),Q=Object(r.useCallback)((()=>{N("all")}),[N]),z=Object(r.useMemo)((()=>o.a.createElement(a.EuiComboBox,{"data-test-subj":"timeline-sourcerer",fullWidth:!0,onChange:M,options:T,placeholder:g.l,renderOption:P,selectedOptions:q})),[M,T,P,q]),A=Object(r.useMemo)((()=>S("custom"!==m)),[m]),V=Object(r.useMemo)((()=>o.a.createElement(O,{"data-test-subj":"timeline-sourcerer-radio",options:A,idSelected:m,onChange:N,name:g.s})),[m,A,N]),R=Object(r.useMemo)((()=>{var t;const n=S();return o.a.createElement(E,{"data-test-subj":"sourcerer-timeline-trigger",iconType:"arrowDown",iconSide:"right",isLoading:C.loading,onClick:L},null===(t=n.find((t=>t.id===e)))||void 0===t?void 0:t.label)}),[e,C.loading,L]),_=Object(r.useMemo)((()=>n?null:C.selectedPatterns.sort().join(", ")),[n,C.selectedPatterns]),H=Object(r.useMemo)((()=>_?o.a.createElement(a.EuiToolTip,{position:"top",content:_,"data-test-subj":"timeline-sourcerer-tooltip"},R):R),[R,_]),K=Object(r.useMemo)((()=>o.a.createElement(v,{"data-test-subj":"advanced-settings"},c?g.k:g.t)),[c]);return Object(r.useEffect)((()=>{const e=C.selectedPatterns.map((e=>({label:e,value:e})));I((t=>l()(e,t)?t:e))}),[C.selectedPatterns]),Object(r.useEffect)((()=>{y((t=>t!==e?e:t)),u("custom"===e)}),[e]),o.a.createElement(k,null,o.a.createElement(a.EuiPopover,{button:H,closePopover:D,id:"popover",isOpen:n,repositionOnScroll:!0},o.a.createElement(b,null,o.a.createElement(a.EuiPopoverTitle,null,o.a.createElement(o.a.Fragment,null,g.s)),o.a.createElement(a.EuiSpacer,{size:"s"}),V,o.a.createElement(a.EuiSpacer,{size:"m"}),o.a.createElement(a.EuiAccordion,{id:"accordion1",forceState:c?"open":"closed",buttonContent:K,onToggle:u},o.a.createElement(o.a.Fragment,null,o.a.createElement(a.EuiSpacer,{size:"s"}),z)),!c&&o.a.createElement(o.a.Fragment,null,o.a.createElement(a.EuiSpacer,{size:"s"}),o.a.createElement(x,{size:"s",color:"subdued"},g.b)),o.a.createElement(a.EuiSpacer,{size:"m"}),o.a.createElement(a.EuiFlexGroup,{alignItems:"center",justifyContent:"spaceBetween"},o.a.createElement(a.EuiFlexItem,null,o.a.createElement(f,{"aria-label":g.d,"data-test-subj":"sourcerer-reset",flush:"left",onClick:Q,title:g.d},g.d)),o.a.createElement(a.EuiFlexItem,{grow:!1},o.a.createElement(a.EuiButton,{onClick:B,"data-test-subj":"add-index",fill:!0,fullWidth:!0,size:"s"},g.n))))))},w=Object(r.memo)(j)},549:function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var a=n(55),i=n(9),l=n.n(i),r=n(91),o=n(156),s=n(93),c=n(2);const u=c.i18n.translate("xpack.securitySolution.timeline.properties.lockDatePickerTooltip",{defaultMessage:"Disable syncing of date/time range bteween the currently viewed page and your timeline"}),d=c.i18n.translate("xpack.securitySolution.timeline.properties.unlockDatePickerTooltip",{defaultMessage:"Enable syncing of date/time range between the currently viewed page and your timeline"}),m=(c.i18n.translate("xpack.securitySolution.timeline.properties.lockedDatePickerLabel",{defaultMessage:"Global date picker is locked to timeline date picker"}),c.i18n.translate("xpack.securitySolution.timeline.properties.unlockedDatePickerLabel",{defaultMessage:"Global date picker NOT locked to timeline date picker"}),c.i18n.translate("xpack.securitySolution.timeline.properties.lockDatePickerDescription",{defaultMessage:"Lock global date picker to timeline date picker"})),p=c.i18n.translate("xpack.securitySolution.timeline.properties.unlockDatePickerDescription",{defaultMessage:"Unlock global date picker from timeline date picker"}),g=()=>{const e=Object(r.useDispatch)(),t=Object(i.useMemo)((()=>o.d.globalSelector()),[]),n=Object(s.b)((e=>t(e).linkTo.includes("timeline"))),c=Object(i.useCallback)((()=>e(o.b.toggleTimelineLinkTo({linkToId:"timeline"}))),[e]);return l.a.createElement(a.EuiToolTip,{"data-test-subj":"timeline-date-picker-lock-tooltip",position:"top",content:n?u:d},l.a.createElement(a.EuiButtonIcon,{"data-test-subj":`timeline-date-picker-${n?"lock":"unlock"}-button`,color:"primary",onClick:c,iconType:n?"lock":"lockOpen","aria-label":n?p:m}))};g.displayName="TimelineDatePickerLockComponent";const b=l.a.memo(g)}}]);