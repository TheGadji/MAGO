/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.securitySolution_bundle_jsonpfunction=window.securitySolution_bundle_jsonpfunction||[]).push([[15],{1364:function(e,t,n){"use strict";n.r(t),n.d(t,"EndpointPackageCustomExtension",(function(){return k}));var a=n(55),r=n(9),i=n.n(r),s=n(2),o=n(57),c=n(70),l=n(101),u=n(65),p=n(90),d=n(148),m=n(348),g=n(346),f=n(521),y=n(347);const E=Object(r.memo)((({pkgkey:e})=>{const{getAppUrl:t}=Object(d.b)(),{services:{http:n}}=Object(p.j)(),E=Object(p.m)(),[h,b]=Object(r.useState)(),x=Object(l.h)(),S=Object(r.useMemo)((()=>new f.a(n)),[n]),k=Object(r.useRef)();Object(r.useEffect)((()=>{k.current=!0;return(async()=>{try{const e=await S.getSummary();k.current&&b(e)}catch(e){k.current&&E.addDanger(s.i18n.translate("xpack.securitySolution.endpoint.fleetCustomExtension.eventFiltersSummaryError",{defaultMessage:'There was an error trying to fetch event filters stats: "{error}"',values:{error:e}}))}})(),()=>{k.current=!1}}),[S,E]);const I=Object(r.useMemo)((()=>{const n=`#${c.pagePathGetters.integration_details_custom({pkgkey:e})[1]}`;return{backButtonLabel:s.i18n.translate("xpack.securitySolution.endpoint.fleetCustomExtension.backButtonLabel",{defaultMessage:"Back to Endpoint Integration"}),onBackButtonNavigateTo:[u.INTEGRATIONS_PLUGIN_ID,{path:n}],backButtonUrl:t({appId:u.INTEGRATIONS_PLUGIN_ID,path:n})}}),[t,e]);return i.a.createElement(a.EuiPanel,{hasShadow:!1,paddingSize:"l",hasBorder:!0,"data-test-subj":"fleedEventFiltersCard"},i.a.createElement(y.a,{alignItems:"baseline",justifyContent:"center"},i.a.createElement(y.b,{gridarea:"title",alignitems:"flex-start"},i.a.createElement(a.EuiText,null,i.a.createElement("h4",null,i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.fleetCustomExtension.eventFiltersLabel",defaultMessage:"Event filters"})))),i.a.createElement(y.b,{gridarea:"summary"},i.a.createElement(g.a,{stats:h})),i.a.createElement(y.b,{gridarea:"link",alignitems:"flex-end"},i.a.createElement(i.a.Fragment,null,i.a.createElement(m.a,{href:t({path:x}),appPath:x,appState:I,"data-test-subj":"linkToEventFilters"},i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.fleetCustomExtension.manageEventFiltersLinkLabel",defaultMessage:"Manage"}))))))}));E.displayName="FleetEventFiltersCard";var h=n(538);const b=Object(r.memo)((({pkgkey:e})=>{const{getAppUrl:t}=Object(d.b)(),{services:{http:n}}=Object(p.j)(),f=Object(p.m)(),[E,b]=Object(r.useState)(),x=Object(l.i)(),S=Object(r.useRef)();Object(r.useEffect)((()=>{S.current=!0;return(async()=>{try{const e=await Object(h.d)(n);S.current&&b(e)}catch(e){S.current&&f.addDanger(s.i18n.translate("xpack.securitySolution.endpoint.fleetCustomExtension.hostIsolationExceptionsSummary.error",{defaultMessage:'There was an error trying to fetch host isolation exceptions stats: "{error}"',values:{error:e}}))}})(),()=>{S.current=!1}}),[n,f]);const k=Object(r.useMemo)((()=>{const n=`#${c.pagePathGetters.integration_details_custom({pkgkey:e})[1]}`;return{backButtonLabel:s.i18n.translate("xpack.securitySolution.endpoint.fleetCustomExtension.hostIsolationExceptionsSummary.backButtonLabel",{defaultMessage:"Back to Endpoint Integration"}),onBackButtonNavigateTo:[u.INTEGRATIONS_PLUGIN_ID,{path:n}],backButtonUrl:t({appId:u.INTEGRATIONS_PLUGIN_ID,path:n})}}),[t,e]);return i.a.createElement(a.EuiPanel,{hasShadow:!1,paddingSize:"l",hasBorder:!0,"data-test-subj":"fleedEventFiltersCard"},i.a.createElement(y.a,{alignItems:"baseline",justifyContent:"center"},i.a.createElement(y.b,{gridarea:"title",alignitems:"flex-start"},i.a.createElement(a.EuiText,null,i.a.createElement("h4",null,i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.fleetCustomExtension.hostIsolationExceptionsSummary.label",defaultMessage:"Host isolation exceptions"})))),i.a.createElement(y.b,{gridarea:"summary"},i.a.createElement(g.a,{stats:E})),i.a.createElement(y.b,{gridarea:"link",alignitems:"flex-end"},i.a.createElement(i.a.Fragment,null,i.a.createElement(m.a,{href:t({path:x}),appPath:x,appState:k,"data-test-subj":"linkToHostIsolationExceptions"},i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.fleetCustomExtension.hostIsolationExceptionsSummary.manageLabel",defaultMessage:"Manage"}))))))}));b.displayName="FleetHostIsolationExceptionsCard";var x=n(522);const S=Object(r.memo)((({pkgkey:e})=>{const{getAppUrl:t}=Object(d.b)(),n=Object(l.m)(),a=Object(r.useMemo)((()=>{const n=`#${c.pagePathGetters.integration_details_custom({pkgkey:e})[1]}`;return{backButtonLabel:s.i18n.translate("xpack.securitySolution.endpoint.fleetCustomExtension.backButtonLabel",{defaultMessage:"Back to Endpoint Integration"}),onBackButtonNavigateTo:[u.INTEGRATIONS_PLUGIN_ID,{path:n}],backButtonUrl:t({appId:u.INTEGRATIONS_PLUGIN_ID,path:n})}}),[t,e]),p=Object(r.useMemo)((()=>i.a.createElement(m.a,{href:t({path:n}),appPath:n,appState:a,"data-test-subj":"linkToTrustedApps"},i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.fleetCustomExtension.manageTrustedAppshortLinkLabel",defaultMessage:"Manage"}))),[t,a,n]);return i.a.createElement(x.a,{customLink:p})}));S.displayName="FleetTrustedAppsCardWrapper";const k=Object(r.memo)((e=>i.a.createElement("div",{"data-test-subj":"fleetEndpointPackageCustomContent"},i.a.createElement(S,e),i.a.createElement(a.EuiSpacer,null),i.a.createElement(E,e),i.a.createElement(a.EuiSpacer,null),i.a.createElement(b,e))));k.displayName="EndpointPackageCustomExtension"},224:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(9),r=n(90);const i=(e,t)=>{const{services:n}=Object(r.j)(),{path:i,state:s,onClick:o,deepLinkId:c,openInNewTab:l}=t||{};return Object(a.useCallback)((t=>{try{o&&o(t)}catch(e){throw t.preventDefault(),e}t.defaultPrevented||0===t.button&&(t.currentTarget instanceof HTMLAnchorElement&&""!==t.currentTarget.target&&"_self"!==t.currentTarget.target||t.metaKey||t.altKey||t.ctrlKey||t.shiftKey||(t.preventDefault(),n.application.navigateToApp(e,{deepLinkId:c,path:i,state:s,openInNewTab:l})))}),[e,c,o,i,n.application,s,l])}},225:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(96),r=n.n(a),i=n(9),s=n.n(i),o=n(55),c=n(224),l=n(3);const u=Object(i.memo)((({appId:e=l.l,deepLinkId:t,appPath:n,appState:a,onClick:i,asButton:u,children:p,...d})=>{const m=Object(c.a)(e,{deepLinkId:t,path:n,state:a,onClick:i});return s.a.createElement(s.a.Fragment,null,u&&!0===u?s.a.createElement(o.EuiButton,r()({},d,{onClick:m}),p):s.a.createElement(o.EuiLink,r()({},d,{onClick:m}),p))}))},308:function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return o}));var a=n(107);const r=e=>e.field===a.b.SIGNER||!0,i=e=>e.field!==a.b.SIGNER,s=e=>"global"===e.type,o=e=>"policy"===e.type},344:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"f",(function(){return s})),n.d(t,"a",(function(){return o})),n.d(t,"g",(function(){return c})),n.d(t,"d",(function(){return l})),n.d(t,"e",(function(){return u})),n.d(t,"b",(function(){return p}));var a=n(65);const r="/api/fleet/package_policies",i=(e,t={})=>{var n;return e.get(r,{...t,query:{...t.query,kuery:`${null!=t&&null!==(n=t.query)&&void 0!==n&&n.kuery?`${t.query.kuery} and `:""}${a.PACKAGE_POLICY_SAVED_OBJECT_TYPE}.package.name: endpoint`}})},s=(e,t,n)=>e.get(`/api/fleet/package_policies/${t}`,n),o=(e,t)=>e.get("/api/fleet/agent_policies",t),c=(e,t,n,a={})=>e.put(`/api/fleet/package_policies/${t}`,{...a,body:JSON.stringify(n)}),l=(e,t,n={})=>e.get("/api/fleet/agent-status",{...n,query:{policyId:t}}),u=(e,t={})=>e.get("/api/fleet/agents",{...t,query:{page:1,perPage:1,kuery:'packages : "endpoint"'}}),p=async e=>{const t=(await e.get("/api/fleet/epm/packages",{query:{category:"security"}})).response.find((e=>"endpoint"===e.name));if(!t)throw new Error("Endpoint package was not found.");return t}},345:function(e,t,n){"use strict";n.d(t,"a",(function(){return TrustedAppsHttpService}));var a=n(516),r=n.n(a),i=n(26),s=n(317),o=n(344),c=n(410),l=n(308);const u=Object.freeze({concurrency:5,stopOnError:!1});class TrustedAppsHttpService{constructor(e){this.http=e}async getTrustedApp(e){return this.http.get(Object(s.a)(i.k,e))}async getTrustedAppsList(e){return this.http.get(i.l,{query:e})}async deleteTrustedApp(e){return this.http.delete(Object(s.a)(i.j,e))}async createTrustedApp(e){return this.http.post(i.i,{body:JSON.stringify(e)})}async updateTrustedApp(e,t){return this.http.put(Object(s.a)(i.n,e),{body:JSON.stringify(t)})}async getTrustedAppsSummary(e){return this.http.get(i.m,{query:e})}getPolicyList(e){return Object(o.c)(this.http,e)}assignPolicyToTrustedApps(e,t){return this._handleAssignOrRemovePolicyId("assign",e,t)}removePolicyFromTrustedApps(e,t){return this._handleAssignOrRemovePolicyId("remove",e,t)}_handleAssignOrRemovePolicyId(e,t,n){if(""===t.trim())throw new Error("policy ID is required");if(0===n.length)throw new Error("at least one trusted app is required");return r()(n,(async n=>{if(Object(l.a)(n.effectScope))throw new Error(`Unable to update trusted app [${n.id}] policy assignment. It's effectScope is 'global'`);const a=Object(l.a)(n.effectScope)?[]:[...n.effectScope.policies],r=a.indexOf(t);return"assign"===e&&-1===r?a.push(t):"remove"===e&&-1!==r&&a.splice(r,1),this.updateTrustedApp({id:n.id},{...Object(c.a)(n),effectScope:{type:"policy",policies:a}})}),u)}}},346:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var a=n(9),r=n.n(a),i=n(55),s=n(2),o=n(56),c=n.n(o);const l=["windows","macos","linux","total"],u={windows:s.i18n.translate("xpack.securitySolution.endpoint.fleetCustomExtension.exceptionItemsSummary.windows",{defaultMessage:"Windows"}),linux:s.i18n.translate("xpack.securitySolution.endpoint.fleetCustomExtension.exceptionItemsSummary.linux",{defaultMessage:"Linux"}),macos:s.i18n.translate("xpack.securitySolution.endpoint.fleetCustomExtension.exceptionItemsSummary.macos",{defaultMessage:"Mac"}),total:s.i18n.translate("xpack.securitySolution.endpoint.fleetCustomExtension.exceptionItemsSummary.total",{defaultMessage:"Total"})},p=(c()(i.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGridGroup",componentId:"sc-1pq2evz-0"})(["display:grid;min-width:240px;grid-template-columns:50% 50%;"]),c()(i.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-1pq2evz-1"})(["font-size:",";font-weight:",";"],(({isSmall:e,theme:t})=>e?t.eui.euiFontSizeXS:"innherit"),(({isSmall:e})=>e?"1px":"innherit"))),d={fontWeight:"bold"},m=Object(a.memo)((({stats:e,isSmall:t=!1})=>{const n=Object(a.useCallback)((n=>{var a;return"total"!==n&&t?null:r.a.createElement(i.EuiFlexItem,{key:n},r.a.createElement(g,{value:null!==(a=null==e?void 0:e[n])&&void 0!==a?a:0,color:"total"!==n||t?"default":"primary",key:n,isSmall:t},u[n]))}),[e,t]);return r.a.createElement(i.EuiFlexGroup,{alignItems:"center",justifyContent:t?"flexStart":"spaceAround",gutterSize:t?"s":"l"},l.map((e=>n(e))))}));m.displayName="ExceptionItemsSummary";const g=Object(a.memo)((({children:e,value:t,color:n,isSmall:a=!1,...s})=>r.a.createElement(i.EuiText,{className:"eui-displayInlineBlock",size:a?"xs":"s"},r.a.createElement(p,{justifyContent:a?"flexStart":"center",direction:a?"rowReverse":"row",alignItems:"center",gutterSize:a?"xs":"l",isSmall:a},a?null:r.a.createElement(i.EuiFlexItem,{grow:!1,style:"primary"===n?d:void 0},e),r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiBadge,{color:n},t))))));g.displayName="SummaryState"},347:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return c}));var a=n(56),r=n.n(a),i=n(55);const s=r()(i.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGridGroup",componentId:"sc-iti06b-0"})(["display:grid;grid-template-columns:33% 45% 22%;grid-template-areas:'title summary link';"]),o=r()(i.EuiFlexItem).withConfig({displayName:"StyledEuiFlexGridItem",componentId:"sc-iti06b-1"})(["grid-area:",";align-items:",";margin:0px;padding:12px;"],(({gridarea:e})=>e),(({alignitems:e})=>null!=e?e:"center")),c=r()(i.EuiFlexItem).withConfig({displayName:"StyledEuiFlexItem",componentId:"sc-iti06b-2"})(["flex-direction:row-reverse;"])},348:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(56),r=n.n(a),i=n(9),s=n.n(i),o=n(55),c=n(225);const l=r.a.span.withConfig({displayName:"LinkLabel",componentId:"sc-1ril6c5-0"})(["display:inline-block;padding-right:",";font-size:",";"],(e=>e.theme.eui.paddingSizes.s),(({size:e,theme:t})=>"m"===e?t.eui.euiFontSizeXS:"innherit")),u=Object(i.memo)((({children:e,size:t="l",...n})=>s.a.createElement(c.a,n,s.a.createElement(l,{size:t},e),s.a.createElement(o.EuiIcon,{type:"m"===t?"arrowRight":"popout"}))));u.displayName="LinkWithIcon"},410:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const a=["name","effectScope","entries","description","os","version"],r=e=>{const t={};for(const n of a)t[n]=e[n];return t}},516:function(e,t,n){"use strict";const a=n(517);e.exports=async(e,t,{concurrency:n=1/0,stopOnError:r=!0}={})=>new Promise(((i,s)=>{if("function"!=typeof t)throw new TypeError("Mapper function is required");if(!Number.isSafeInteger(n)&&n!==1/0||!(n>=1))throw new TypeError(`Expected \`concurrency\` to be an integer from 1 and up or \`Infinity\`, got \`${n}\` (${typeof n})`);const o=[],c=[],l=e[Symbol.iterator]();let u=!1,p=!1,d=0,m=0;const g=()=>{if(u)return;const e=l.next(),n=m;if(m++,e.done)return p=!0,void(0===d&&(r||0===c.length?i(o):s(new a(c))));d++,(async()=>{try{const a=await e.value;o[n]=await t(a,n),d--,g()}catch(e){r?(u=!0,s(e)):(c.push(e),d--,g())}})()};for(let e=0;e<n&&(g(),!p);e++);}))},517:function(e,t,n){"use strict";const a=n(518),r=n(519);class AggregateError extends Error{constructor(e){if(!Array.isArray(e))throw new TypeError("Expected input to be an Array, got "+typeof e);let t=(e=[...e].map((e=>e instanceof Error?e:null!==e&&"object"==typeof e?Object.assign(new Error(e.message),e):new Error(e)))).map((e=>"string"==typeof e.stack?r(e.stack).replace(/\s+at .*aggregate-error\/index.js:\d+:\d+\)?/g,""):String(e))).join("\n");t="\n"+a(t,4),super(t),this.name="AggregateError",Object.defineProperty(this,"_errors",{value:e})}*[Symbol.iterator](){for(const e of this._errors)yield e}}e.exports=AggregateError},518:function(e,t,n){"use strict";e.exports=(e,t=1,n)=>{if(n={indent:" ",includeEmptyLines:!1,...n},"string"!=typeof e)throw new TypeError(`Expected \`input\` to be a \`string\`, got \`${typeof e}\``);if("number"!=typeof t)throw new TypeError(`Expected \`count\` to be a \`number\`, got \`${typeof t}\``);if("string"!=typeof n.indent)throw new TypeError(`Expected \`options.indent\` to be a \`string\`, got \`${typeof n.indent}\``);if(0===t)return e;const a=n.includeEmptyLines?/^/gm:/^(?!\s*$)/gm;return e.replace(a,n.indent.repeat(t))}},519:function(e,t,n){"use strict";const a=n(520),r=/\s+at.*(?:\(|\s)(.*)\)?/,i=/^(?:(?:(?:node|(?:internal\/[\w/]*|.*node_modules\/(?:babel-polyfill|pirates)\/.*)?\w+)\.js:\d+:\d+)|native)/,s=void 0===a.homedir?"":a.homedir();e.exports=(e,t)=>(t=Object.assign({pretty:!1},t),e.replace(/\\/g,"/").split("\n").filter((e=>{const t=e.match(r);if(null===t||!t[1])return!0;const n=t[1];return!n.includes(".app/Contents/Resources/electron.asar")&&!n.includes(".app/Contents/Resources/default_app.asar")&&!i.test(n)})).filter((e=>""!==e.trim())).map((e=>t.pretty?e.replace(r,((e,t)=>e.replace(t,t.replace(s,"~")))):e)).join("\n"))},520:function(e,t){},521:function(e,t,n){"use strict";n.d(t,"a",(function(){return EventFiltersHttpService}));var a=n(7),r=n.n(a),i=n(137),s=n(286);class EventFiltersHttpService{constructor(e){r()(this,"listHasBeenCreated",void 0),this.http=e,this.listHasBeenCreated=!1}async createEndpointEventList(){try{await this.http.post(s.e,{body:JSON.stringify(s.b)}),this.listHasBeenCreated=!0}catch(e){if(409!==e.response.status)throw e;this.listHasBeenCreated=!0}}async httpWrapper(){return this.listHasBeenCreated||await this.createEndpointEventList(),this.http}async getList({perPage:e,page:t,sortField:n,sortOrder:a,filter:r}={}){return(await this.httpWrapper()).get(`${s.d}/_find`,{query:{page:t,per_page:e,sort_field:n,sort_order:a,list_id:[i.b],namespace_type:["agnostic"],filter:r}})}async addEventFilters(e){return(await this.httpWrapper()).post(s.d,{body:JSON.stringify(e)})}async getOne(e){return(await this.httpWrapper()).get(s.d,{query:{id:e,namespace_type:"agnostic"}})}async updateOne(e){return(await this.httpWrapper()).put(s.d,{body:JSON.stringify(e)})}async deleteOne(e){return(await this.httpWrapper()).delete(s.d,{query:{id:e,namespace_type:"agnostic"}})}async getSummary(){return(await this.httpWrapper()).get(`${s.e}/summary`,{query:{list_id:i.b,namespace_type:"agnostic"}})}}},522:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(9),r=n.n(a),i=n(55),s=n(2),o=n(57),c=n(90),l=n(346),u=n(345),p=n(347);const d=Object(a.memo)((({customLink:e,policyId:t,cardSize:n="l"})=>{const{services:{http:d}}=Object(c.j)(),m=Object(c.m)(),[g,f]=Object(a.useState)(),y=Object(a.useMemo)((()=>new u.a(d)),[d]),E=Object(a.useRef)();Object(a.useEffect)((()=>{E.current=!0;return(async()=>{try{const e=await y.getTrustedAppsSummary({kuery:t?`(exception-list-agnostic.attributes.tags:"policy:${t}" OR exception-list-agnostic.attributes.tags:"policy:all")`:void 0});E&&f(e)}catch(e){E.current&&m.addDanger(s.i18n.translate("xpack.securitySolution.endpoint.fleetCustomExtension.trustedAppsSummaryError",{defaultMessage:'There was an error trying to fetch trusted apps stats: "{error}"',values:{error:e}}))}})(),()=>{E.current=!1}}),[m,y,t]);const h=()=>r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.fleetCustomExtension.trustedAppsLabel",defaultMessage:"Trusted applications"}),b=Object(a.useMemo)((()=>"m"===n?r.a.createElement(i.EuiFlexGroup,{alignItems:"baseline",justifyContent:"flexStart",gutterSize:"s",direction:"row",responsive:!1},r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiText,null,r.a.createElement("h5",null,h()))),r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(l.a,{stats:g,isSmall:!0})),r.a.createElement(p.c,{grow:1},e)):r.a.createElement(p.a,{alignItems:"baseline",justifyContent:"center"},r.a.createElement(p.b,{gridarea:"title",alignitems:"flex-start"},r.a.createElement(i.EuiText,null,r.a.createElement("h4",null,h()))),r.a.createElement(p.b,{gridarea:"summary",alignitems:"center"},r.a.createElement(l.a,{stats:g,isSmall:!1})),r.a.createElement(p.b,{gridarea:"link",alignitems:"flex-end"},e))),[n,e,g]);return r.a.createElement(i.EuiPanel,{hasShadow:!1,paddingSize:"l",hasBorder:!0,"data-test-subj":"fleetTrustedAppsCard"},b)}));d.displayName="FleetTrustedAppsCard"},96:function(e,t,n){e.exports=n(46)(1075)}}]);