/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.securitySolution_bundle_jsonpfunction=window.securitySolution_bundle_jsonpfunction||[]).push([[12],Array(92).concat([function(e,t,a){e.exports=a(707)},,,,,,,,,,function(e,t,a){(function(t){var a=function(e){return e&&e.Math==Math&&e};e.exports=a("object"==typeof globalThis&&globalThis)||a("object"==typeof window&&window)||a("object"==typeof self&&self)||a("object"==typeof t&&t)||function(){return this}()||Function("return this")()}).call(this,a(239))},,,,,,,,,,,,,,,,,,,,,,,,function(e,t,a){var n=a(176),i=a(162),r=a(733),s=a(196).f;e.exports=function(e){var t=n.Symbol||(n.Symbol={});i(t,e)||s(t,e,{value:r.f(e)})}},,,,,,,function(e,t){var a=Function.prototype,n=a.bind,i=a.call,r=n&&n.bind(i);e.exports=n?function(e){return e&&r(i,e)}:function(e){return e&&function(){return i.apply(e,arguments)}}},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},,,,,,function(e,t,a){var n=a(102),i=a(502),r=a(162),s=a(399),o=a(497),l=a(709),c=i("wks"),u=n.Symbol,d=u&&u.for,p=l?u:u&&u.withoutSetter||s;e.exports=function(e){if(!r(c,e)||!o&&"string"!=typeof c[e]){var t="Symbol."+e;o&&r(u,e)?c[e]=u[e]:c[e]=l&&d?d(t):p(t)}return c[e]}},,,,,function(e,t){e.exports=function(e){return"function"==typeof e}},,,,,,,,,,,,,,,,function(e,t,a){"use strict";(function(e,a,n){Object.defineProperty(t,"__esModule",{value:!0}),t.getWindowFromNode=function(e){if(e.defaultView)return e.defaultView;if(e.ownerDocument&&e.ownerDocument.defaultView)return e.ownerDocument.defaultView;if(e.window)return e.window;throw e.then instanceof Function?new Error("It looks like you passed a Promise object instead of a DOM node. Did you do something like `fireEvent.click(screen.findBy...` when you meant to use a `getBy` query `fireEvent.click(screen.getBy...`, or await the findBy query `fireEvent.click(await screen.findBy...`?"):Array.isArray(e)?new Error("It looks like you passed an Array instead of a DOM node. Did you do something like `fireEvent.click(screen.getAllBy...` when you meant to use a `getBy` query `fireEvent.click(screen.getBy...`?"):new Error('Unable to find the "window" object for the given node. Please file an issue with the code that\'s causing you to see this error: https://github.com/testing-library/dom-testing-library/issues/new')},t.getDocument=function(){if("undefined"==typeof window)throw new Error("Could not find default container");return window.document},t.runWithRealTimers=r,t.checkContainerType=function(e){if(!e||"function"!=typeof e.querySelector||"function"!=typeof e.querySelectorAll)throw new TypeError(`Expected container to be an Element, a Document or a DocumentFragment but got ${function(e){if("object"==typeof e)return null===e?"null":e.constructor.name;return typeof e}(e)}.`)},t.jestFakeTimersAreEnabled=function(){if("undefined"!=typeof jest)return s((()=>{})).usedFakeTimers;return!1},t.TEXT_NODE=t.setTimeout=t.setImmediate=t.clearTimeout=void 0;const i="undefined"==typeof window?e:window;function r(e){return"undefined"!=typeof jest?s(e).callbackReturnValue:e()}function s(e){const t={clearInterval:clearInterval,clearTimeout:clearTimeout,setInterval:setInterval,setTimeout:setTimeout};"function"==typeof a&&(t.setImmediate=a),"function"==typeof n&&(t.clearImmediate=n),jest.useRealTimers();const r=e(),s=Object.entries(t).some((([e,t])=>t!==i[e]));var o;s&&jest.useFakeTimers(null!=(o=t.setTimeout)&&o.clock?"modern":"legacy");return{callbackReturnValue:r,usedFakeTimers:s}}function o(e){return i.setTimeout(e,0)}t.TEXT_NODE=3;const{clearTimeoutFn:l,setImmediateFn:c,setTimeoutFn:u}=r((function(){return{clearTimeoutFn:i.clearTimeout,setImmediateFn:i.setImmediate||o,setTimeoutFn:i.setTimeout}}));t.setTimeout=u,t.setImmediate=c,t.clearTimeout=l}).call(this,a(239),a(701).setImmediate,a(701).clearImmediate)},function(e,t,a){var n=a(133),i=a(251),r=n({}.hasOwnProperty);e.exports=Object.hasOwn||function(e,t){return r(i(e),t)}},,,,,function(e,t,a){"use strict";var n=a(102),i=a(396),r=a(133),s=a(145),o=a(708).f,l=a(1057),c=a(176),u=a(337),d=a(276),p=a(162),m=function(e){var t=function(a,n,r){if(this instanceof t){switch(arguments.length){case 0:return new e;case 1:return new e(a);case 2:return new e(a,n)}return new e(a,n,r)}return i(e,this,arguments)};return t.prototype=e.prototype,t};e.exports=function(e,t){var a,i,f,g,b,h,y,v,E=e.target,T=e.global,k=e.stat,x=e.proto,S=T?n:k?n[E]:(n[E]||{}).prototype,w=T?c:c[E]||d(c,E,{})[E],O=w.prototype;for(f in t)a=!l(T?f:E+(k?".":"#")+f,e.forced)&&S&&p(S,f),b=w[f],a&&(h=e.noTargetGet?(v=o(S,f))&&v.value:S[f]),g=a&&h?h:t[f],a&&typeof b==typeof g||(y=e.bind&&a?u(g,n):e.wrap&&a?m(g):x&&s(g)?r(g):g,(e.sham||g&&g.sham||b&&b.sham)&&d(y,"sham",!0),d(w,f,y),x&&(p(c,i=E+"Prototype")||d(c,i,{}),d(c[i],f,g),e.real&&O&&!O[f]&&d(O,f,g)))}},,,,,,,,,function(e,t){e.exports={}},,,,function(e,t,a){e.exports=a(46)(269)},,function(e,t,a){var n=a(134);e.exports=!n((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},function(e,t,a){var n=a(145);e.exports=function(e){return"object"==typeof e?null!==e:n(e)}},function(e,t,a){e.exports=a(46)(1271)},,,,,,,,,,,function(e,t,a){"use strict";a.d(t,"m",(function(){return i})),a.d(t,"k",(function(){return r})),a.d(t,"l",(function(){return s})),a.d(t,"i",(function(){return o})),a.d(t,"j",(function(){return l})),a.d(t,"h",(function(){return c})),a.d(t,"g",(function(){return u})),a.d(t,"b",(function(){return d})),a.d(t,"a",(function(){return p})),a.d(t,"d",(function(){return m})),a.d(t,"c",(function(){return f})),a.d(t,"f",(function(){return g})),a.d(t,"e",(function(){return b}));var n=a(2);const i=n.i18n.translate("xpack.securitySolution.detectionEngine.eqlValidation.requestError",{defaultMessage:"An error occurred while validating your EQL query"}),r=n.i18n.translate("xpack.securitySolution.detectionEngine.eqlValidation.title",{defaultMessage:"EQL Validation Errors"}),s=n.i18n.translate("xpack.securitySolution.detectionEngine.eqlValidation.showErrorsLabel",{defaultMessage:"Show EQL Validation Errors"}),o=(n.i18n.translate("xpack.securitySolution.detectionEngine.eqlQueryBar.label",{defaultMessage:"Enter an EQL Query"}),n.i18n.translate("xpack.securitySolution.detectionEngine.eqlOverViewLink.text",{defaultMessage:"Event Query Language (EQL) Overview"})),l=n.i18n.translate("xpack.securitySolution.detectionEngine.eqlSettings.title",{defaultMessage:"EQL settings"}),c=n.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsSize.label",{defaultMessage:"Size"}),u=n.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsSize.text",{defaultMessage:"For basic queries, the maximum number of matching events to return. For sequence queries, the maximum number of matching sequences to return."}),d=n.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsEventCategoryField.label",{defaultMessage:"Event category field"}),p=n.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsEventCategoryField.text",{defaultMessage:"Field containing the event classification, such as process, file, or network. This field is typically mapped as a field type in the keyword family"}),m=n.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsEventTiebreakerField.label",{defaultMessage:"Tiebreaker field"}),f=n.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsEventTiebreakerField.text",{defaultMessage:"Field used to sort hits with the same timestamp in ascending, lexicographic order"}),g=n.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsEventTimestampField.label",{defaultMessage:"Timestamp field"}),b=n.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsEventTimestampField.text",{defaultMessage:"Field containing event timestamp"})},function(e,t,a){var n=a(102),i=a(182),r=a(710),s=a(229),o=a(397),l=n.TypeError,c=Object.defineProperty;t.f=i?c:function(e,t,a){if(s(e),t=o(t),s(a),r)try{return c(e,t,a)}catch(e){}if("get"in a||"set"in a)throw l("Accessors not supported");return"value"in a&&(e[t]=a.value),e}},,,,,,,,function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.runWithExpensiveErrorDiagnosticsDisabled=function(e){try{return i._disableExpensiveErrorDiagnostics=!0,e()}finally{i._disableExpensiveErrorDiagnostics=!1}},t.configure=function(e){"function"==typeof e&&(e=e(i));i={...i,...e}},t.getConfig=function(){return i},t.DEFAULT_IGNORE_TAGS=void 0;var n=a(392);let i={testIdAttribute:"data-testid",asyncUtilTimeout:1e3,asyncWrapper:e=>e(),eventWrapper:e=>e(),defaultHidden:!1,showOriginalStackTrace:!1,throwSuggestions:!1,getElementError(e,t){const a=new Error([e,(0,n.prettyDOM)(t)].filter(Boolean).join("\n\n"));return a.name="TestingLibraryElementError",a},_disableExpensiveErrorDiagnostics:!1,computedStyleSupportsPseudoElements:!1};t.DEFAULT_IGNORE_TAGS="script, style"},function(e,t){var a=Function.prototype.call;e.exports=a.bind?a.bind(a):function(){return a.apply(a,arguments)}},function(e,t,a){var n=a(133);e.exports=n({}.isPrototypeOf)},,,,,,,,,,,,,,,,,,,,function(e,t,a){e.exports=a(46)(404)},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getElementError=o,t.getMultipleElementsFoundError=l,t.queryAllByAttribute=c,t.queryByAttribute=function(e,t,a,...n){const i=c(e,t,a,...n);if(i.length>1)throw l(`Found multiple elements by [${e}=${a}]`,t);return i[0]||null},t.makeSingleQuery=u,t.makeGetAllQuery=p,t.makeFindQuery=m,t.buildQueries=function(e,t,a){const n=f(u(e,t),e.name,"query"),i=p(e,a),r=u(i,t),s=f(r,e.name,"get"),o=g(i,e.name.replace("query","get"),"getAll"),l=m(g(i,e.name,"findAll")),c=m(f(r,e.name,"find"));return[n,o,s,l,c]},t.wrapSingleQueryWithSuggestion=t.wrapAllByQueryWithSuggestion=void 0;var n=a(703),i=a(394),r=a(406),s=a(204);function o(e,t){return(0,s.getConfig)().getElementError(e,t)}function l(e,t){return o(`${e}\n\n(If this is intentional, then use the \`*AllBy*\` variant of the query (like \`queryAllByText\`, \`getAllByText\`, or \`findAllByText\`)).`,t)}function c(e,t,a,{exact:n=!0,collapseWhitespace:r,trim:s,normalizer:o}={}){const l=n?i.matches:i.fuzzyMatches,c=(0,i.makeNormalizer)({collapseWhitespace:r,trim:s,normalizer:o});return Array.from(t.querySelectorAll(`[${e}]`)).filter((t=>l(t.getAttribute(e),t,a,c)))}function u(e,t){return(a,...n)=>{const i=e(a,...n);if(i.length>1){const e=i.map((e=>o(null,e).message)).join("\n\n");throw l(`${t(a,...n)}\n\nHere are the matching elements:\n\n${e}`,a)}return i[0]||null}}function d(e,t){return(0,s.getConfig)().getElementError(`A better query is available, try this:\n${e.toString()}\n`,t)}function p(e,t){return(a,...n)=>{const i=e(a,...n);if(!i.length)throw(0,s.getConfig)().getElementError(t(a,...n),a);return i}}function m(e){return(t,a,n,i)=>(0,r.waitFor)((()=>e(t,a,n)),{container:t,...i})}const f=(e,t,a)=>(i,...r)=>{const o=e(i,...r),[{suggest:l=(0,s.getConfig)().throwSuggestions}={}]=r.slice(-1);if(o&&l){const e=(0,n.getSuggestedQuery)(o,a);if(e&&!t.endsWith(e.queryName))throw d(e.toString(),i)}return o};t.wrapSingleQueryWithSuggestion=f;const g=(e,t,a)=>(i,...r)=>{const o=e(i,...r),[{suggest:l=(0,s.getConfig)().throwSuggestions}={}]=r.slice(-1);if(o.length&&l){const e=[...new Set(o.map((e=>{var t;return null==(t=(0,n.getSuggestedQuery)(e,a))?void 0:t.toString()})))];if(1===e.length&&!t.endsWith((0,n.getSuggestedQuery)(o[0],a).queryName))throw d(e[0],i)}return o};t.wrapAllByQueryWithSuggestion=g},function(e,t){e.exports=function(e){return e&&e.__esModule?e:{default:e}}},function(e,t,a){var n=a(102),i=a(183),r=n.String,s=n.TypeError;e.exports=function(e){if(i(e))return e;throw s(r(e)+" is not an object")}},function(e,t,a){var n=a(102),i=a(507),r=a(145),s=a(336),o=a(140)("toStringTag"),l=n.Object,c="Arguments"==s(function(){return arguments}());e.exports=i?s:function(e){var t,a,n;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(a=function(e,t){try{return e[t]}catch(e){}}(t=l(e),o))?a:c?s(t):"Object"==(n=s(t))&&r(t.callee)?"Arguments":n}},function(e,t,a){a(253);var n=a(1080),i=a(102),r=a(230),s=a(276),o=a(277),l=a(140)("toStringTag");for(var c in n){var u=i[c],d=u&&u.prototype;d&&r(d)!==l&&s(d,l,c),o[c]=o.Array}},,,,,,,,,,,,,,,,,function(e,t,a){e.exports=a(46)(345)},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(394);Object.keys(n).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===n[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return n[e]}}))}));var i=a(490);Object.keys(i).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===i[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}}))}));var r=a(227);Object.keys(r).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===r[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return r[e]}}))}));var s=a(204);Object.keys(s).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===s[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return s[e]}}))}))},function(e,t,a){var n=a(494),i=a(495);e.exports=function(e){return n(i(e))}},function(e,t,a){var n=a(102),i=a(495),r=n.Object;e.exports=function(e){return r(i(e))}},function(e,t,a){e.exports=a(1059)},function(e,t,a){"use strict";var n=a(250),i=a(712),r=a(277),s=a(338),o=a(504),l="Array Iterator",c=s.set,u=s.getterFor(l);e.exports=o(Array,"Array",(function(e,t){c(this,{type:l,target:n(e),index:0,kind:t})}),(function(){var e=u(this),t=e.target,a=e.kind,n=e.index++;return!t||n>=t.length?(e.target=void 0,{value:void 0,done:!0}):"keys"==a?{value:n,done:!1}:"values"==a?{value:t[n],done:!1}:{value:[n,t[n]],done:!1}}),"values"),r.Arguments=r.Array,i("keys"),i("values"),i("entries")},,,,,,,,,,,,,,,,,,,,,,function(e,t,a){var n=a(176),i=a(102),r=a(145),s=function(e){return r(e)?e:void 0};e.exports=function(e,t){return arguments.length<2?s(n[e])||s(i[e]):n[e]&&n[e][t]||i[e]&&i[e][t]}},function(e,t,a){var n=a(182),i=a(196),r=a(335);e.exports=n?function(e,t,a){return i.f(e,t,r(1,a))}:function(e,t,a){return e[t]=a,e}},function(e,t){e.exports={}},,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,a){e.exports=a(46)(406)},function(e,t,a){var n=a(1066);e.exports=function(e){return n(e.length)}},function(e,t,a){"use strict";var n=a(1079).charAt,i=a(512),r=a(338),s=a(504),o="String Iterator",l=r.set,c=r.getterFor(o);s(String,"String",(function(e){l(this,{type:o,string:i(e),index:0})}),(function(){var e,t=c(this),a=t.string,i=t.index;return i>=a.length?{value:void 0,done:!0}:(e=n(a,i),t.index+=e.length,{value:e,done:!1})}))},function(e,t,a){var n=a(176);e.exports=function(e){return n[e+"Prototype"]}},function(e,t){(function(t){e.exports=t}).call(this,{})},,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,a){var n=a(133),i=n({}.toString),r=n("".slice);e.exports=function(e){return r(i(e),8,-1)}},function(e,t,a){var n=a(133),i=a(500),r=n(n.bind);e.exports=function(e,t){return i(e),void 0===t?e:r?r(e,t):function(){return e.apply(t,arguments)}}},function(e,t,a){var n,i,r,s=a(1061),o=a(102),l=a(133),c=a(183),u=a(276),d=a(162),p=a(503),m=a(400),f=a(339),g="Object already initialized",b=o.TypeError,h=o.WeakMap;if(s||p.state){var y=p.state||(p.state=new h),v=l(y.get),E=l(y.has),T=l(y.set);n=function(e,t){if(E(y,e))throw new b(g);return t.facade=e,T(y,e,t),t},i=function(e){return v(y,e)||{}},r=function(e){return E(y,e)}}else{var k=m("state");f[k]=!0,n=function(e,t){if(d(e,k))throw new b(g);return t.facade=e,u(e,k,t),t},i=function(e){return d(e,k)?e[k]:{}},r=function(e){return d(e,k)}}e.exports={set:n,get:i,has:r,enforce:function(e){return r(e)?i(e):n(e,{})},getterFor:function(e){return function(t){var a;if(!c(t)||(a=i(t)).type!==e)throw b("Incompatible receiver, "+e+" required");return a}}}},function(e,t){e.exports={}},function(e,t,a){var n=a(507),i=a(196).f,r=a(276),s=a(162),o=a(1069),l=a(140)("toStringTag");e.exports=function(e,t,a,c){if(e){var u=a?e:e.prototype;s(u,l)||i(u,l,{configurable:!0,value:t}),c&&!n&&r(u,"toString",o)}}},function(e,t,a){var n=a(336);e.exports=Array.isArray||function(e){return"Array"==n(e)}},function(e,t){},,,,,,,,,,,function(e,t,a){"use strict";a.d(t,"a",(function(){return m})),a.d(t,"b",(function(){return f})),a.d(t,"c",(function(){return g}));var n=a(58),i=a(175),r=a(90),s=a(60);const o=e=>"parsing_exception"===e||"verification_exception"===e||"mapping_exception"===e,l=e=>Object(n.has)(e,"error.type"),c=e=>e.error.root_cause.filter((e=>o(e.type))).map((e=>e.reason)),u=async({data:e,index:t,query:a,signal:i})=>{const{rawResponse:r}=await e.search.search({params:{index:t.join(),body:{query:a,size:0}},options:{ignore:[400]}},{strategy:s.EQL_SEARCH_STRATEGY,abortSignal:i}).toPromise();if((e=>l(e)&&o(Object(n.get)(e,"error.type")))(r.body))return{valid:!1,errors:c(r.body)};if(l(r.body))throw new Error(JSON.stringify(r.body));return{valid:!0,errors:[]}};var d=a(195);let p;!function(e){e.FAILED_REQUEST="ERR_FAILED_REQUEST",e.INVALID_EQL="ERR_INVALID_EQL"}(p||(p={}));const m=(e,t)=>{let a,n=[];return(...i)=>(a&&clearTimeout(a),a=setTimeout((()=>{const t=e(...i);n.forEach((e=>e(t))),n=[]}),t),new Promise((e=>n.push(e))))},f=async(...e)=>{const[{value:t,formData:a}]=e,{query:s}=t,o=s.query,{index:l,ruleType:c}=a;if(void 0===c&&!Object(n.isEmpty)(o)||Object(i.c)(c)&&!Object(n.isEmpty)(o))try{const{data:e}=r.b.get(),t=(new AbortController).signal,a=await u({data:e,query:o,signal:t,index:l});if(!1===(null==a?void 0:a.valid))return{code:p.INVALID_EQL,message:"",messages:a.errors}}catch(e){return{code:p.FAILED_REQUEST,message:d.m,error:e}}},g=e=>{const t=e.errors.length>0,a=!e.isChangingValue&&!t;if(t){const[t]=e.errors,n=t.message;return t.code===p.INVALID_EQL?{isValid:a,message:n,messages:t.messages}:{isValid:a,message:n,error:t.error}}return{isValid:a,message:""}}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(9),i=a.n(n),r=a(95),s=a.n(r),o=a(59),l=a(30);const c=Object(n.memo)((({dateRangeFrom:e,dateRangeTo:t,hideSavedQuery:a=!1,indexPattern:r,isLoading:c=!1,isRefreshPaused:u,filterQuery:d,filterManager:p,filters:m,onChangedQuery:f,onSubmitQuery:g,refreshInterval:b,savedQuery:h,onSavedQuery:y,dataTestSubj:v})=>{const E=Object(n.useCallback)((e=>{null==e.query||s()(e.query,d)||g(e.query)}),[d,g]),T=Object(n.useCallback)((e=>{f&&null!=e.query&&!s()(e.query,d)&&f(e.query)}),[d,f]),k=Object(n.useCallback)((e=>{const{query:t,filters:a,timefilter:n}=e.attributes;g(t,n),p.setFilters(a||[]),y(e)}),[p,g,y]),x=Object(n.useCallback)((()=>{null!=h&&(g({query:"",language:h.attributes.query.language}),p.setFilters([]),y(void 0))}),[p,g,y,h]),S=Object(n.useCallback)((e=>{p.setFilters(e)}),[p]),w=i.a.createElement(i.a.Fragment,null,null),O=Object(n.useMemo)((()=>[r]),[r]);return i.a.createElement(o.SearchBar,{customSubmitButton:w,dateRangeFrom:e,dateRangeTo:t,filters:m,indexPatterns:O,isLoading:c,isRefreshPaused:u,query:d,onClearSavedQuery:x,onFiltersUpdated:S,onQueryChange:T,onQuerySubmit:E,onSaved:y,onSavedQueryUpdated:k,refreshInterval:b,showAutoRefreshOnly:!1,showFilterBar:!a,showDatePicker:!1,showQueryBar:!0,showQueryInput:!0,showSaveQuery:!0,timeHistory:new o.TimeHistory(new l.Storage(localStorage)),dataTestSubj:v,savedQuery:h})}));c.displayName="QueryBar"},function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(9),i=a(59),r=a(90);const s=()=>{const e=Object(r.j)(),{http:t}=e.services,[a,s]=Object(n.useState)(Object(i.createSavedQueryService)(t));return Object(n.useEffect)((()=>{s(Object(i.createSavedQueryService)(t))}),[t]),a}},function(e,t,a){"use strict";e.exports=o;var n=a(977),i=n.CONTINUE,r=n.SKIP,s=n.EXIT;function o(e,t,a,i){"function"==typeof t&&"function"!=typeof a&&(i=a,a=t,t=null),n(e,t,(function(e,t){var n=t[t.length-1],i=n?n.children.indexOf(e):null;return a(e,i,n)}),i)}o.CONTINUE=i,o.SKIP=r,o.EXIT=s},function(e,t,a){"use strict";(function(e,n){var i=a(157);Object.defineProperty(t,"__esModule",{value:!0}),t.prettyDOM=d,Object.defineProperty(t,"prettyFormat",{enumerable:!0,get:function(){return r.default}}),t.logDOM=void 0;var r=i(a(1030)),s=a(1045),o=a(161);const l=t=>function(t){const a=t.ownerDocument&&t.ownerDocument.defaultView||void 0;return void 0!==e&&e.Cypress||void 0!==a&&a.Cypress}(t)?0:void 0!==n&&Object({IS_KIBANA_DISTRIBUTABLE:"true"}).DEBUG_PRINT_LIMIT||7e3,{DOMElement:c,DOMCollection:u}=r.default.plugins;function d(e,t,a){if(e||(e=(0,o.getDocument)().body),"number"!=typeof t&&(t=l(e)),0===t)return"";e.documentElement&&(e=e.documentElement);let i=typeof e;if("object"===i?i=e.constructor.name:e={},!("outerHTML"in e))throw new TypeError(`Expected an element or document but got ${i}`);const s=(0,r.default)(e,{plugins:[c,u],printFunctionName:!1,highlight:void 0!==n&&void 0!==n.versions&&void 0!==n.versions.node,...a});return void 0!==t&&e.outerHTML.length>t?`${s.slice(0,t)}...`:s}t.logDOM=(...e)=>{const t=(0,s.getUserCodeFrame)();t?console.log(`${d(...e)}\n\n${t}`):console.log(d(...e))}}).call(this,a(239),a(378))},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.printIteratorEntries=function(e,t,a,n,i,r,s=": "){let o="",l=e.next();if(!l.done){o+=t.spacingOuter;const c=a+t.indent;for(;!l.done;){const a=r(l.value[0],t,c,n,i),u=r(l.value[1],t,c,n,i);o+=c+a+s+u,l=e.next(),l.done?t.min||(o+=","):o+=","+t.spacingInner}o+=t.spacingOuter+a}return o},t.printIteratorValues=function(e,t,a,n,i,r){let s="",o=e.next();if(!o.done){s+=t.spacingOuter;const l=a+t.indent;for(;!o.done;)s+=l+r(o.value,t,l,n,i),o=e.next(),o.done?t.min||(s+=","):s+=","+t.spacingInner;s+=t.spacingOuter+a}return s},t.printListItems=function(e,t,a,n,i,r){let s="";if(e.length){s+=t.spacingOuter;const o=a+t.indent;for(let a=0;a<e.length;a++)s+=o+r(e[a],t,o,n,i),a<e.length-1?s+=","+t.spacingInner:t.min||(s+=",");s+=t.spacingOuter+a}return s},t.printObjectProperties=function(e,t,a,n,i,r){let s="";const o=(e=>{const t=Object.keys(e).sort();Object.getOwnPropertySymbols&&Object.getOwnPropertySymbols(e).forEach((a=>{Object.getOwnPropertyDescriptor(e,a).enumerable&&t.push(a)}));return t})(e);if(o.length){s+=t.spacingOuter;const l=a+t.indent;for(let a=0;a<o.length;a++){const c=o[a],u=r(c,t,l,n,i),d=r(e[c],t,l,n,i);s+=l+u+": "+d,a<o.length-1?s+=","+t.spacingInner:t.min||(s+=",")}s+=t.spacingOuter+a}return s}},function(e,t,a){"use strict";function n(e){if(null==e)throw new Error(`It looks like ${e} was passed instead of a matcher. Did you do something like getByText(${e})?`)}function i({trim:e=!0,collapseWhitespace:t=!0}={}){return a=>{let n=a;return n=e?n.trim():n,n=t?n.replace(/\s+/g," "):n,n}}Object.defineProperty(t,"__esModule",{value:!0}),t.fuzzyMatches=function(e,t,a,i){if("string"!=typeof e)return!1;n(a);const r=i(e);return"string"==typeof a||"number"==typeof a?r.toLowerCase().includes(a.toString().toLowerCase()):"function"==typeof a?a(r,t):a.test(r)},t.matches=function(e,t,a,i){if("string"!=typeof e)return!1;n(a);const r=i(e);return a instanceof Function?a(r,t):a instanceof RegExp?a.test(r):r===String(a)},t.getDefaultNormalizer=i,t.makeNormalizer=function({trim:e,collapseWhitespace:t,normalizer:a}){if(a){if(void 0!==e||void 0!==t)throw new Error('trim and collapseWhitespace are not supported with a normalizer. If you want to use the default trim and collapseWhitespace logic in your normalizer, use "getDefaultNormalizer({trim, collapseWhitespace})" and compose that into your normalizer');return a}return i({trim:e,collapseWhitespace:t})}},function(e,t,a){"use strict";t.__esModule=!0,t.getLocalName=r,t.isElement=s,t.isHTMLTableCaptionElement=function(e){return s(e)&&"caption"===r(e)},t.isHTMLInputElement=function(e){return s(e)&&"input"===r(e)},t.isHTMLSelectElement=function(e){return s(e)&&"select"===r(e)},t.isHTMLTableElement=function(e){return s(e)&&"table"===r(e)},t.isHTMLTextAreaElement=function(e){return s(e)&&"textarea"===r(e)},t.safeWindow=function(e){var t=(null===e.ownerDocument?e:e.ownerDocument).defaultView;if(null===t)throw new TypeError("no window available");return t},t.isHTMLFieldSetElement=function(e){return s(e)&&"fieldset"===r(e)},t.isHTMLLegendElement=function(e){return s(e)&&"legend"===r(e)},t.isHTMLSlotElement=function(e){return s(e)&&"slot"===r(e)},t.isSVGElement=o,t.isSVGSVGElement=function(e){return s(e)&&"svg"===r(e)},t.isSVGTitleElement=function(e){return o(e)&&"title"===r(e)},t.queryIdRefs=function(e,t){if(s(e)&&e.hasAttribute(t)){return e.getAttribute(t).split(" ").map((function(t){return e.ownerDocument.getElementById(t)})).filter((function(e){return null!==e}))}return[]},t.hasAnyConcreteRoles=function(e,t){if(s(e))return-1!==t.indexOf((0,i.default)(e));return!1};var n,i=(n=a(705))&&n.__esModule?n:{default:n};function r(e){var t;return null!==(t=e.localName)&&void 0!==t?t:e.tagName.toLowerCase()}function s(e){return null!==e&&e.nodeType===e.ELEMENT_NODE}function o(e){return s(e)&&void 0!==e.ownerSVGElement}},function(e,t){var a=Function.prototype,n=a.apply,i=a.bind,r=a.call;e.exports="object"==typeof Reflect&&Reflect.apply||(i?r.bind(n):function(){return r.apply(n,arguments)})},function(e,t,a){var n=a(1053),i=a(496);e.exports=function(e){var t=n(e,"string");return i(t)?t:t+""}},function(e,t){e.exports=!0},function(e,t,a){var n=a(133),i=0,r=Math.random(),s=n(1..toString);e.exports=function(e){return"Symbol("+(void 0===e?"":e)+")_"+s(++i+r,36)}},function(e,t,a){var n=a(502),i=a(399),r=n("keys");e.exports=function(e){return r[e]||(r[e]=i(e))}},function(e,t,a){var n,i=a(229),r=a(1064),s=a(506),o=a(339),l=a(1067),c=a(711),u=a(400),d=u("IE_PROTO"),p=function(){},m=function(e){return"<script>"+e+"</"+"script>"},f=function(e){e.write(m("")),e.close();var t=e.parentWindow.Object;return e=null,t},g=function(){try{n=new ActiveXObject("htmlfile")}catch(e){}var e,t;g="undefined"!=typeof document?document.domain&&n?f(n):((t=c("iframe")).style.display="none",l.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write(m("document.F=Object")),e.close(),e.F):f(n);for(var a=s.length;a--;)delete g.prototype[s[a]];return g()};o[d]=!0,e.exports=Object.create||function(e,t){var a;return null!==e?(p.prototype=i(e),a=new p,p.prototype=null,a[d]=e):a=g(),void 0===t?a:r(a,t)}},function(e,t,a){var n=a(715),i=a(506);e.exports=Object.keys||function(e){return n(e,i)}},function(e,t,a){var n=a(276);e.exports=function(e,t,a,i){i&&i.enumerable?e[t]=a:n(e,t,a)}},function(e,t,a){var n=a(230),i=a(499),r=a(277),s=a(140)("iterator");e.exports=function(e){if(null!=e)return i(e,s)||i(e,"@@iterator")||r[n(e)]}},function(e,t,a){var n=a(337),i=a(133),r=a(494),s=a(251),o=a(304),l=a(725),c=i([].push),u=function(e){var t=1==e,a=2==e,i=3==e,u=4==e,d=6==e,p=7==e,m=5==e||d;return function(f,g,b,h){for(var y,v,E=s(f),T=r(E),k=n(g,b),x=o(T),S=0,w=h||l,O=t?w(f,x):a||p?w(f,0):void 0;x>S;S++)if((m||S in T)&&(v=k(y=T[S],S,E),e))if(t)O[S]=v;else if(v)switch(e){case 3:return!0;case 5:return y;case 6:return S;case 2:c(O,y)}else switch(e){case 4:return!1;case 7:c(O,y)}return d?-1:i||u?u:O}};e.exports={forEach:u(0),map:u(1),filter:u(2),some:u(3),every:u(4),find:u(5),findIndex:u(6),filterReject:u(7)}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.waitFor=s,t.wait=function(...e){const[t=(()=>{}),...a]=e;o||(o=!0,console.warn("`wait` has been deprecated and replaced by `waitFor` instead. In most cases you should be able to find/replace `wait` with `waitFor`. Learn more: https://testing-library.com/docs/dom-testing-library/api-async#waitfor."));return s(t,...a)};var n=a(161),i=a(204);function r(e,t){e.stack=t.stack.replace(t.message,e.message)}function s(e,t){const a=new Error("STACK_TRACE_MESSAGE");return(0,i.getConfig)().asyncWrapper((()=>function(e,{container:t=(0,n.getDocument)(),timeout:a=(0,i.getConfig)().asyncUtilTimeout,showOriginalStackTrace:s=(0,i.getConfig)().showOriginalStackTrace,stackTraceError:o,interval:l=50,onTimeout:c=(e=>(e.message=(0,i.getConfig)().getElementError(e.message,t).message,e)),mutationObserverOptions:u={subtree:!0,childList:!0,attributes:!0,characterData:!0}}){if("function"!=typeof e)throw new TypeError("Received `callback` arg must be a function");return new Promise((async(d,p)=>{let m,f,g,b=!1,h="idle";const y=(0,n.setTimeout)((function(){let e;m?(e=m,s||"TestingLibraryElementError"!==e.name||r(e,o)):(e=new Error("Timed out in waitFor."),s||r(e,o)),E(c(e),null)}),a),v=(0,n.jestFakeTimersAreEnabled)();if(v)for(k();!b;){if(!(0,n.jestFakeTimersAreEnabled)()){const e=new Error("Changed from using fake timers to real timers while using waitFor. This is not allowed and will result in very strange behavior. Please ensure you're awaiting all async things your test is doing before changing to real timers. For more info, please go to https://github.com/testing-library/dom-testing-library/issues/830");return s||r(e,o),void p(e)}jest.advanceTimersByTime(l),k(),await new Promise((e=>(0,n.setImmediate)(e)))}else{try{(0,n.checkContainerType)(t)}catch(e){return void p(e)}f=setInterval(T,l);const{MutationObserver:e}=(0,n.getWindowFromNode)(t);g=new e(T),g.observe(t,u),k()}function E(e,t){b=!0,(0,n.clearTimeout)(y),v||(clearInterval(f),g.disconnect()),e?p(e):d(t)}function T(){if((0,n.jestFakeTimersAreEnabled)()){const e=new Error("Changed from using real timers to fake timers while using waitFor. This is not allowed and will result in very strange behavior. Please ensure you're awaiting all async things your test is doing before changing to fake timers. For more info, please go to https://github.com/testing-library/dom-testing-library/issues/830");return s||r(e,o),p(e)}return k()}function k(){if("pending"!==h)try{const t=(0,i.runWithExpensiveErrorDiagnosticsDisabled)(e);"function"==typeof(null==t?void 0:t.then)?(h="pending",t.then((e=>{h="resolved",E(null,e)}),(e=>{h="rejected",m=e}))):E(null,t)}catch(e){m=e}}}))}(e,{stackTraceError:a,...t})))}let o=!1},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,a){"use strict";a.d(t,"a",(function(){return E})),a.d(t,"b",(function(){return T}));var n=a(19),i=a(9),r=a.n(i),s=a(91),o=a(15),l=a(95),c=a.n(l),u=a(109),d=a(104),p=a(59),m=a(139),f=a(390),g=a(389),b=a(117),h=a(94);const y="timeline-filter-drop-area",v=(e=[])=>e.filter((e=>e.meta.controlledBy!==y)),E=Object(i.memo)((({dataProviders:e,filters:t,filterManager:a,filterQuery:n,from:l,fromStr:p,kqlMode:E,isRefreshPaused:k,savedQueryId:x,setFilters:S,setSavedQueryId:w,refreshInterval:O,timelineId:j,to:C,toStr:I,updateReduxTime:M})=>{const A=Object(s.useDispatch)(),[q,D]=Object(i.useState)(null!=p?p:new Date(l).toISOString()),[P,R]=Object(i.useState)(null!=I?I:new Date(C).toISOString()),{browserFields:F,indexPattern:_}=Object(u.c)(d.SourcererScopeName.timeline),[N,L]=Object(i.useState)(void 0),[B,z]=Object(i.useState)({query:null!=n?n.expression:"",language:null!=n?n.kind:"kuery"}),[H,U]=Object(i.useState)(v(t)),[$,Q]=Object(i.useState)(Object(m.a)(Object(b.g)(e,F),_)),V=Object(f.a)(),W=Object(i.useCallback)(((e,t)=>A(h.a.applyKqlFilterQuery({id:j,filterQuery:{kuery:{kind:t,expression:e},serializedQuery:Object(m.a)(e,_)}}))),[A,_,j]);Object(i.useEffect)((()=>{let e=!0;const n=new o.Subscription;return a.setFilters(t),n.add(a.getUpdates$().subscribe({next:()=>{if(e){const e=v(a.getFilters());S(e),U(e)}}})),()=>{e=!1,n.unsubscribe()}}),[]),Object(i.useEffect)((()=>{const e=v(a.getFilters());c()(t,e)||a.setFilters(t)}),[t]),Object(i.useEffect)((()=>{z({query:null!=n?n.expression:"",language:null!=n?n.kind:"kuery"})}),[n]),Object(i.useEffect)((()=>{Q(Object(m.a)(Object(b.g)(e,F),_))}),[e,F,_]),Object(i.useEffect)((()=>{null!=p&&null!=I?(D(p),R(I)):null!=l&&null!=C&&(D(new Date(l).toISOString()),R(new Date(C).toISOString()))}),[l,p,C,I]),Object(i.useEffect)((()=>{let e=!0;return async function(){if(null!=x&&null!=V)try{const a=await V.getSavedQuery(x);e&&null!=a&&L({...a,attributes:{...a.attributes,filters:v(t)}})}catch(e){L(void 0)}else e&&L(void 0)}(),()=>{e=!1}}),[x]);const G=Object(i.useCallback)(((e,t)=>{if((null==n||null!=n&&n.expression!==e.query||n.kind!==e.language)&&W(e.query,e.language),null!=t){const e=t.from.includes("now")||t.to.includes("now");M({id:"timeline",end:t.to,start:t.from,isInvalid:!1,isQuickSelection:e,timelineId:j})}}),[n,j]),K=Object(i.useCallback)((e=>{if(null!=e){if(e.id!==x&&w(e.id),null!=V&&""!==$){const t=null!=e.attributes.filters?e.attributes.filters.findIndex((e=>e.meta.controlledBy===y)):-1;V.updateQuery(e.id,{...e.attributes,filters:null!=e.attributes.filters?t>-1?[...e.attributes.filters.slice(0,t),T($),...e.attributes.filters.slice(t+1)]:[...e.attributes.filters,T($)]:[]})}}else w(null)}),[$,x,V]);return r.a.createElement(g.a,{dateRangeFrom:q,dateRangeTo:P,hideSavedQuery:"search"===E,indexPattern:_,isRefreshPaused:k,filterQuery:B,filterManager:a,filters:H,onSubmitQuery:G,refreshInterval:O,savedQuery:N,onSavedQuery:K,dataTestSubj:"timelineQueryInput"})})),T=e=>{const t=JSON.parse(e),a=Object.keys(t);return{...t,meta:{alias:y,controlledBy:y,negate:!1,disabled:!1,type:"custom",key:Object(n.isEmpty)(a)?"bool":a[0],value:e},$state:{store:p.esFilters.FilterStateStore.APP_STATE}}}},function(e,t,a){"use strict";var n=a(966),i=a(967),r=a(481),s=a(968),o=a(969),l=a(970);e.exports=function(e,t){var a,r,s={};t||(t={});for(r in p)a=t[r],s[r]=null==a?p[r]:a;(s.position.indent||s.position.start)&&(s.indent=s.position.indent||[],s.position=s.position.start);return function(e,t){var a,r,s,p,T,k,x,S,w,O,j,C,I,M,A,q,D,P,R,F=t.additional,_=t.nonTerminated,N=t.text,L=t.reference,B=t.warning,z=t.textContext,H=t.referenceContext,U=t.warningContext,$=t.position,Q=t.indent||[],V=e.length,W=0,G=-1,K=$.column||1,Y=$.line||1,J="",X=[];q=Z(),S=B?ee:d,W--,V++;for(;++W<V;)if("\n"===T&&(K=Q[G]||1),"&"!==(T=te(W)))"\n"===T&&(Y++,G++,K=0),T?(J+=T,K++):ae();else{if("\t"===(x=te(W+1))||"\n"===x||"\f"===x||" "===x||"<"===x||"&"===x||""===x||F&&x===F){J+=T,K++;continue}for(C=I=W+1,R=I,"#"!==x?M=m:"x"===(x=te(R=++C))||"X"===x?(M=f,R=++C):M=g,a="",j="",p="",A=h[M],R--;++R<V&&A(x=te(R));)p+=x,M===m&&c.call(n,p)&&(a=p,j=n[p]);(s=";"===te(R))&&(R++,(r=M===m&&l(p))&&(a=p,j=r)),P=1+R-I,(s||_)&&(p?M===m?(s&&!j?S(5,1):(a!==p&&(P=1+(R=C+a.length)-C,s=!1),s||(w=a?1:3,t.attribute?"="===(x=te(R))?(S(w,P),j=null):o(x)?j=null:S(w,P):S(w,P))),k=j):(s||S(2,P),v(k=parseInt(p,b[M]))?(S(7,P),k="�"):k in i?(S(6,P),k=i[k]):(O="",E(k)&&S(6,P),k>65535&&(O+=u((k-=65536)>>>10|55296),k=56320|1023&k),k=O+u(k))):M!==m&&S(4,P)),k?(ae(),q=Z(),W=R-1,K+=R-I+1,X.push(k),(D=Z()).offset++,L&&L.call(H,k,{start:q,end:D},e.slice(I-1,R)),q=D):(p=e.slice(I-1,R),J+=p,K+=p.length,W=R-1)}return X.join("");function Z(){return{line:Y,column:K,offset:W+($.offset||0)}}function ee(e,t){var a=Z();a.column+=t,a.offset+=t,B.call(U,y[e],a,e)}function te(t){return e.charAt(t)}function ae(){J&&(X.push(J),N&&N.call(z,J,{start:q,end:Z()}),J="")}}(e,s)};var c={}.hasOwnProperty,u=String.fromCharCode,d=Function.prototype,p={warning:null,reference:null,text:null,warningContext:null,referenceContext:null,textContext:null,position:{},additional:null,attribute:!1,nonTerminated:!0},m="named",f="hexadecimal",g="decimal",b={hexadecimal:16,decimal:10},h={};h.named=o,h.decimal=r,h.hexadecimal=s;var y={};function v(e){return e>=55296&&e<=57343||e>1114111}function E(e){return e>=1&&e<=8||11===e||e>=13&&e<=31||e>=127&&e<=159||e>=64976&&e<=65007||65535==(65535&e)||65534==(65535&e)}y[1]="Named character references must be terminated by a semicolon",y[2]="Numeric character references must be terminated by a semicolon",y[3]="Named character references cannot be empty",y[4]="Numeric character references cannot be empty",y[5]="Named character references must be known",y[6]="Numeric character references cannot be disallowed",y[7]="Numeric character references cannot be outside the permissible Unicode range"},function(e,t,a){e.exports=a(46)(403)},function(e,t,a){e.exports=a(46)(916)},function(e,t,a){e.exports=a(46)(1348)},function(e,t,a){"use strict";e.exports=function(e,t,a,n){var i,r,s,o,l,c,u=["pedantic","commonmark"],d=u.length,p=e.length,m=-1;for(;++m<p;){for(i=e[m],r=i[1]||{},s=i[0],o=-1,c=!1;++o<d;)if(void 0!==r[l=u[o]]&&r[l]!==a.options[l]){c=!0;break}if(!c&&t[s].apply(a,n))return!0}return!1}},function(e,t,a){"use strict";var n=a(990);e.exports=function(e){return n(e).toLowerCase()}},,,function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(1029);Object.keys(n).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===n[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return n[e]}}))}));var i=a(1323);Object.keys(i).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===i[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}}))}));var r=a(1324);Object.keys(r).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===r[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return r[e]}}))}));var s=a(1325);Object.keys(s).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===s[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return s[e]}}))}));var o=a(1326);Object.keys(o).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===o[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}}))}));var l=a(1327);Object.keys(l).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===l[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return l[e]}}))}));var c=a(1328);Object.keys(c).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===c[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return c[e]}}))}));var u=a(1329);Object.keys(u).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===u[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return u[e]}}))}))},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.printElementAsLeaf=t.printElement=t.printComment=t.printText=t.printChildren=t.printProps=void 0;var n,i=(n=a(1039))&&n.__esModule?n:{default:n};t.printProps=(e,t,a,n,i,r,s)=>{const o=n+a.indent,l=a.colors;return e.map((e=>{const c=t[e];let u=s(c,a,o,i,r);return"string"!=typeof c&&(-1!==u.indexOf("\n")&&(u=a.spacingOuter+o+u+a.spacingOuter+n),u="{"+u+"}"),a.spacingInner+n+l.prop.open+e+l.prop.close+"="+l.value.open+u+l.value.close})).join("")};t.printChildren=(e,t,a,n,i,s)=>e.map((e=>t.spacingOuter+a+("string"==typeof e?r(e,t):s(e,t,a,n,i)))).join("");const r=(e,t)=>{const a=t.colors.content;return a.open+(0,i.default)(e)+a.close};t.printText=r;t.printComment=(e,t)=>{const a=t.colors.comment;return a.open+"\x3c!--"+(0,i.default)(e)+"--\x3e"+a.close};t.printElement=(e,t,a,n,i)=>{const r=n.colors.tag;return r.open+"<"+e+(t&&r.close+t+n.spacingOuter+i+r.open)+(a?">"+r.close+a+n.spacingOuter+i+r.open+"</"+e:(t&&!n.min?"":" ")+"/")+">"+r.close};t.printElementAsLeaf=(e,t)=>{const a=t.colors.tag;return a.open+"<"+e+a.close+" …"+a.open+" />"+a.close}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getNodeText=function(e){if(e.matches("input[type=submit], input[type=button]"))return e.value;return Array.from(e.childNodes).filter((e=>e.nodeType===n.TEXT_NODE&&Boolean(e.textContent))).map((e=>e.textContent)).join("")};var n=a(161)},function(e,t,a){"use strict";t.__esModule=!0,t.getRole=t.computeAccessibleName=t.computeAccessibleDescription=void 0;var n=a(1047);t.computeAccessibleDescription=n.computeAccessibleDescription;var i=a(1050);t.computeAccessibleName=i.computeAccessibleName;var r,s=(r=a(705))&&r.__esModule?r:{default:r};t.getRole=s.default},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getRoles=d,t.getImplicitAriaRoles=u,t.isSubtreeInaccessible=l,t.prettyRoles=p,t.isInaccessible=c,t.computeAriaSelected=function(e){if("OPTION"===e.tagName)return e.selected;return m(e,"aria-selected")},t.computeAriaChecked=function(e){if("indeterminate"in e&&e.indeterminate)return;if("checked"in e)return e.checked;return m(e,"aria-checked")},t.computeAriaPressed=function(e){return m(e,"aria-pressed")},t.computeAriaExpanded=function(e){return m(e,"aria-expanded")},t.computeHeadingLevel=function(e){return e.getAttribute("aria-level")&&Number(e.getAttribute("aria-level"))||{H1:1,H2:2,H3:3,H4:4,H5:5,H6:6}[e.tagName]},t.logRoles=void 0;var n=a(706),i=a(491),r=a(392),s=a(204);const o=function(e){function t({attributes:e=[]}){return e.length}function a(e){return t=>{let{attributes:a=[]}=e;const n=a.findIndex((e=>e.value&&"type"===e.name&&"text"===e.value));return!(n>=0&&(a=[...a.slice(0,n),...a.slice(n+1)],"text"!==t.type))&&t.matches(function({name:e,attributes:t}){return`${e}${t.map((({name:e,value:t,constraints:a=[]})=>-1!==a.indexOf("undefined")?`:not([${e}])`:t?`[${e}="${t}"]`:`[${e}]`)).join("")}`}({...e,attributes:a}))}}let n=[];for(const[i,r]of e.entries())n=[...n,{match:a(i),roles:Array.from(r),specificity:t(i)}];return n.sort((function({specificity:e},{specificity:t}){return t-e}))}(n.elementRoles);function l(e){if(!0===e.hidden)return!0;if("true"===e.getAttribute("aria-hidden"))return!0;return"none"===e.ownerDocument.defaultView.getComputedStyle(e).display}function c(e,t={}){const{isSubtreeInaccessible:a=l}=t;if("hidden"===e.ownerDocument.defaultView.getComputedStyle(e).visibility)return!0;let n=e;for(;n;){if(a(n))return!0;n=n.parentElement}return!1}function u(e){for(const{match:t,roles:a}of o)if(t(e))return[...a];return[]}function d(e,{hidden:t=!1}={}){return function e(t){return[t,...Array.from(t.children).reduce(((t,a)=>[...t,...e(a)]),[])]}(e).filter((e=>!1!==t||!1===c(e))).reduce(((e,t)=>{let a=[];return a=t.hasAttribute("role")?t.getAttribute("role").split(" ").slice(0,1):u(t),a.reduce(((e,a)=>Array.isArray(e[a])?{...e,[a]:[...e[a],t]}:{...e,[a]:[t]}),e)}),{})}function p(e,{hidden:t}){const a=d(e,{hidden:t});return Object.entries(a).filter((([e])=>"generic"!==e)).map((([e,t])=>{const a="-".repeat(50);return`${e}:\n\n${t.map((e=>`${`Name "${(0,i.computeAccessibleName)(e,{computedStyleSupportsPseudoElements:(0,s.getConfig)().computedStyleSupportsPseudoElements})}":\n`}${(0,r.prettyDOM)(e.cloneNode(!1))}`)).join("\n\n")}\n\n${a}`})).join("\n")}function m(e,t){const a=e.getAttribute(t);return"true"===a||"false"!==a&&void 0}t.logRoles=(e,{hidden:t=!1}={})=>console.log(p(e,{hidden:t}))},function(e,t,a){"use strict";var n={}.propertyIsEnumerable,i=Object.getOwnPropertyDescriptor,r=i&&!n.call({1:2},1);t.f=r?function(e){var t=i(this,e);return!!t&&t.enumerable}:n},function(e,t,a){var n=a(102),i=a(133),r=a(134),s=a(336),o=n.Object,l=i("".split);e.exports=r((function(){return!o("z").propertyIsEnumerable(0)}))?function(e){return"String"==s(e)?l(e,""):o(e)}:o},function(e,t,a){var n=a(102).TypeError;e.exports=function(e){if(null==e)throw n("Can't call method on "+e);return e}},function(e,t,a){var n=a(102),i=a(275),r=a(145),s=a(206),o=a(709),l=n.Object;e.exports=o?function(e){return"symbol"==typeof e}:function(e){var t=i("Symbol");return r(t)&&s(t.prototype,l(e))}},function(e,t,a){var n=a(498),i=a(134);e.exports=!!Object.getOwnPropertySymbols&&!i((function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&n&&n<41}))},function(e,t,a){var n,i,r=a(102),s=a(1054),o=r.process,l=r.Deno,c=o&&o.versions||l&&l.version,u=c&&c.v8;u&&(i=(n=u.split("."))[0]>0&&n[0]<4?1:+(n[0]+n[1])),!i&&s&&(!(n=s.match(/Edge\/(\d+)/))||n[1]>=74)&&(n=s.match(/Chrome\/(\d+)/))&&(i=+n[1]),e.exports=i},function(e,t,a){var n=a(500);e.exports=function(e,t){var a=e[t];return null==a?void 0:n(a)}},function(e,t,a){var n=a(102),i=a(145),r=a(501),s=n.TypeError;e.exports=function(e){if(i(e))return e;throw s(r(e)+" is not a function")}},function(e,t,a){var n=a(102).String;e.exports=function(e){try{return n(e)}catch(e){return"Object"}}},function(e,t,a){var n=a(398),i=a(503);(e.exports=function(e,t){return i[e]||(i[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.19.1",mode:n?"pure":"global",copyright:"© 2021 Denis Pushkarev (zloirock.ru)"})},function(e,t,a){var n=a(102),i=a(1056),r="__core-js_shared__",s=n[r]||i(r,{});e.exports=s},function(e,t,a){"use strict";var n=a(167),i=a(205),r=a(398),s=a(1062),o=a(145),l=a(1063),c=a(717),u=a(1070),d=a(340),p=a(276),m=a(403),f=a(140),g=a(277),b=a(714),h=s.PROPER,y=s.CONFIGURABLE,v=b.IteratorPrototype,E=b.BUGGY_SAFARI_ITERATORS,T=f("iterator"),k="keys",x="values",S="entries",w=function(){return this};e.exports=function(e,t,a,s,f,b,O){l(a,t,s);var j,C,I,M=function(e){if(e===f&&R)return R;if(!E&&e in D)return D[e];switch(e){case k:case x:case S:return function(){return new a(this,e)}}return function(){return new a(this)}},A=t+" Iterator",q=!1,D=e.prototype,P=D[T]||D["@@iterator"]||f&&D[f],R=!E&&P||M(f),F="Array"==t&&D.entries||P;if(F&&(j=c(F.call(new e)))!==Object.prototype&&j.next&&(r||c(j)===v||(u?u(j,v):o(j[T])||m(j,T,w)),d(j,A,!0,!0),r&&(g[A]=w)),h&&f==x&&P&&P.name!==x&&(!r&&y?p(D,"name",x):(q=!0,R=function(){return i(P,this)})),f)if(C={values:M(x),keys:b?R:M(k),entries:M(S)},O)for(I in C)(E||q||!(I in D))&&m(D,I,C[I]);else n({target:t,proto:!0,forced:E||q},C);return r&&!O||D[T]===R||m(D,T,R,{name:f}),g[t]=R,C}},function(e,t){var a=Math.ceil,n=Math.floor;e.exports=function(e){var t=+e;return t!=t||0===t?0:(t>0?n:a)(t)}},function(e,t){e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},function(e,t,a){var n={};n[a(140)("toStringTag")]="z",e.exports="[object z]"===String(n)},function(e,t,a){var n=a(715),i=a(506).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return n(e,i)}},function(e,t,a){var n=a(133);e.exports=n([].slice)},function(e,t,a){var n=a(102),i=a(205),r=a(500),s=a(229),o=a(501),l=a(404),c=n.TypeError;e.exports=function(e,t){var a=arguments.length<2?l(e):t;if(r(a))return s(i(a,e));throw c(o(e)+" is not iterable")}},function(e,t,a){var n=a(133),i=a(134),r=a(145),s=a(230),o=a(275),l=a(713),c=function(){},u=[],d=o("Reflect","construct"),p=/^\s*(?:class|function)\b/,m=n(p.exec),f=!p.exec(c),g=function(e){if(!r(e))return!1;try{return d(c,u,e),!0}catch(e){return!1}};e.exports=!d||i((function(){var e;return g(g.call)||!g(Object)||!g((function(){e=!0}))||e}))?function(e){if(!r(e))return!1;switch(s(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}return f||!!m(p,l(e))}:g},function(e,t,a){var n=a(102),i=a(230),r=n.String;e.exports=function(e){if("Symbol"===i(e))throw TypeError("Cannot convert a Symbol value to a string");return r(e)}},function(e,t,a){"use strict";var n=a(228);a(92)(t,"__esModule",{value:!0}),t.default=void 0;var i,r=n(a(727)),s=n(a(1085)),o=n(a(1088)),l=n(a(1092)),c=n(a(1112)),u=n(a(1118)),d=n(a(1122)),p=n(a(1125)),m=n(a(1130)),f=n(a(515)),g=n(a(252)),b=n(a(1140)),h=n(a(1153)),y=n(a(1236));function v(e,t){var a;if(void 0===l.default||null==(0,o.default)(e)){if((0,s.default)(e)||(a=function(e,t){var a;if(!e)return;if("string"==typeof e)return E(e,t);var n=(0,u.default)(a=Object.prototype.toString.call(e)).call(a,8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return(0,c.default)(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return E(e,t)}(e))||t&&e&&"number"==typeof e.length){a&&(e=a);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var d,p=!0,m=!1;return{s:function(){a=(0,r.default)(e)},n:function(){var e=a.next();return p=e.done,e},e:function(e){m=!0,d=e},f:function(){try{p||null==a.return||a.return()}finally{if(m)throw d}}}}function E(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var T=new g.default([]);(0,f.default)(i=[b.default,h.default,y.default]).call(i,(function(e){(0,f.default)(e).call(e,(function(e,t){return T.set(t,e)}))})),(0,f.default)(T).call(T,(function(e,t){var a,n=v(e.superClass);try{for(n.s();!(a=n.n()).done;){var i,r=v(a.value);try{for(r.s();!(i=r.n()).done;){var s=i.value,o=T.get(s);if(o)for(var l=0,c=(0,m.default)(o.props);l<c.length;l++){var u=c[l];Object.prototype.hasOwnProperty.call(e.props,u)||(0,p.default)(e.props,(0,d.default)({},u,o.props[u]))}}}catch(e){r.e(e)}finally{r.f()}}}catch(e){n.e(e)}finally{n.f()}}));var k=T;t.default=k},function(e,t,a){"use strict";var n=a(397),i=a(196),r=a(335);e.exports=function(e,t,a){var s=n(t);s in e?i.f(e,s,r(0,a)):e[s]=a}},function(e,t,a){e.exports=a(1134)},,,,,,,,,,,,,function(e,t,a){"use strict";a.d(t,"a",(function(){return S}));var n=a(9),i=a.n(n),r=a(56),s=a.n(r),o=a(55),l=a(97),c=a(195),u=a(58);const d=({ariaLabel:e,errors:t})=>{const[a,r]=Object(n.useState)(!1),s=Object(n.useCallback)((()=>{r(!a)}),[a]),l=Object(n.useCallback)((()=>{r(!1)}),[]);return i.a.createElement(o.EuiPopover,{"data-test-subj":"eql-validation-errors-popover",button:i.a.createElement(o.EuiButtonEmpty,{"data-test-subj":"eql-validation-errors-popover-button",iconType:"crossInACircleFilled",size:"s",color:"danger","aria-label":e,onClick:s},t.length),isOpen:a,closePopover:l,anchorPosition:"downCenter"},i.a.createElement("div",{"data-test-subj":"eql-validation-errors-popover-content"},i.a.createElement(o.EuiPopoverTitle,null,c.k),t.map(((e,t)=>i.a.createElement(o.EuiText,{key:t},e)))))};var p=a(90);const m=s()(o.EuiText).withConfig({displayName:"InlineText",componentId:"sc-i91hzt-0"})(["display:inline-block;"]),f=()=>{const e=Object(p.j)().services.docLinks.links.query.eql;return i.a.createElement(o.EuiLink,{external:!0,href:e,target:"_blank"},i.a.createElement(m,{size:"xs"},c.i))},g=s()(o.EuiPanel).withConfig({displayName:"Container",componentId:"sc-10yczbx-0"})(["border-radius:0;background:",";padding:"," ",";"],(({theme:e})=>e.eui.euiPageBackgroundColor),(({theme:e})=>e.eui.euiSizeXS),(({theme:e})=>e.eui.euiSizeS)),b=s()(o.EuiFlexGroup).withConfig({displayName:"FlexGroup",componentId:"sc-10yczbx-1"})(["min-height:",";"],(({theme:e})=>e.eui.euiSizeXL)),h=s()(o.EuiFlexItem).withConfig({displayName:"FlexItemLeftBorder",componentId:"sc-10yczbx-2"})(["border-left:1px solid ",";"],(({theme:e})=>e.eui.euiColorLightShade)),y=s()(o.EuiFlexItem).withConfig({displayName:"FlexItemWithMarginRight",componentId:"sc-10yczbx-3"})(["margin-right:",";"],(({theme:e})=>e.eui.euiSizeS)),v=s()(o.EuiLoadingSpinner).withConfig({displayName:"Spinner",componentId:"sc-10yczbx-4"})(["margin:0 ",";"],(({theme:e})=>e.eui.euiSizeS)),E={asPlainText:!0},T=({errors:e,isLoading:t,optionsData:a,optionsSelected:r,onOptionsChange:s})=>{var l;const[p,m]=Object(n.useState)(!1),[T,k]=Object(n.useState)(null!==(l=null==r?void 0:r.size)&&void 0!==l?l:100),x=Object(n.useRef)(),S=Object(n.useCallback)((()=>{m(!0)}),[]),w=Object(n.useCallback)((()=>{m(!1)}),[]),O=Object(n.useCallback)((e=>{s&&(e.length>0?s("eventCategoryField",e[0].label):s("eventCategoryField",null))}),[s]),j=Object(n.useCallback)((e=>{s&&(e.length>0?s("tiebreakerField",e[0].label):s("tiebreakerField",null))}),[s]),C=Object(n.useCallback)((e=>{s&&(e.length>0?s("timestampField",e[0].label):s("timestampField",null))}),[s]),I=Object(n.useCallback)((e=>{if(s){var t,a,n,i;if(k(null==e||null===(t=e.target)||void 0===t?void 0:t.value),null!==(a=x.current)&&void 0!==a&&a.cancel)null===(i=x.current)||void 0===i||i.cancel();x.current=Object(u.debounce)((e=>s("size",e)),800),x.current(null==e||null===(n=e.target)||void 0===n?void 0:n.value)}}),[s]),M=Object(n.useMemo)((()=>null!=(null==r?void 0:r.eventCategoryField)?[{label:null==r?void 0:r.eventCategoryField}]:void 0),[null==r?void 0:r.eventCategoryField]),A=Object(n.useMemo)((()=>null!=(null==r?void 0:r.tiebreakerField)?[{label:null==r?void 0:r.tiebreakerField}]:void 0),[null==r?void 0:r.tiebreakerField]),q=Object(n.useMemo)((()=>null!=(null==r?void 0:r.timestampField)?[{label:null==r?void 0:r.timestampField}]:void 0),[null==r?void 0:r.timestampField]);return i.a.createElement(g,null,i.a.createElement(b,{alignItems:"center",justifyContent:"spaceBetween",gutterSize:"none"},i.a.createElement(o.EuiFlexItem,null,e.length>0&&i.a.createElement(d,{ariaLabel:c.l,errors:e}),t&&i.a.createElement(v,{"data-test-subj":"eql-validation-loading",size:"m"})),!s&&i.a.createElement(o.EuiFlexItem,{grow:!1},i.a.createElement(f,null)),s&&i.a.createElement(i.a.Fragment,null,i.a.createElement(y,{grow:!1},i.a.createElement(f,null)),i.a.createElement(h,{grow:!1},i.a.createElement(o.EuiPopover,{button:i.a.createElement(o.EuiButtonIcon,{onClick:S,iconType:"controlsVertical",isDisabled:p,"aria-label":"eql settings","data-test-subj":"eql-settings-trigger"}),isOpen:p,closePopover:w,anchorPosition:"downCenter",ownFocus:!1},i.a.createElement(o.EuiPopoverTitle,null,c.j),i.a.createElement("div",{style:{width:"300px"}},i.a.createElement(o.EuiFormRow,{label:c.h,helpText:c.g},i.a.createElement(o.EuiFieldNumber,{value:T,onChange:I,min:1,max:1e4})),i.a.createElement(o.EuiFormRow,{label:c.b,helpText:c.a},i.a.createElement(o.EuiComboBox,{options:null==a?void 0:a.keywordFields,selectedOptions:M,singleSelection:E,onChange:O})),i.a.createElement(o.EuiFormRow,{label:c.d,helpText:c.c},i.a.createElement(o.EuiComboBox,{options:null==a?void 0:a.nonDateFields,selectedOptions:A,singleSelection:E,onChange:j})),i.a.createElement(o.EuiFormRow,{label:c.f,helpText:c.e},i.a.createElement(o.EuiComboBox,{options:null==a?void 0:a.dateFields,selectedOptions:q,singleSelection:E,onChange:C}))))))))};var k=a(353);const x=s()(o.EuiTextArea).withConfig({displayName:"TextArea",componentId:"sc-4u43ce-0"})(["display:block;border:",";border-bottom:0;box-shadow:none;min-height:",";"],(({theme:e})=>e.eui.euiBorderThin),(({theme:e})=>e.eui.euiFormControlHeight)),S=({dataTestSubj:e,field:t,idAria:a,optionsData:r,optionsSelected:s,onOptionsChange:u,onValidityChange:d,onValiditingChange:p})=>{const{addError:m}=Object(l.a)(),[f,g]=Object(n.useState)([]),{isValidating:b,setValue:h}=t,{isValid:y,message:v,messages:E,error:S}=Object(k.c)(t),w=t.value.query.query;Object(n.useEffect)((()=>{null!=d&&d(y)}),[y,d]),Object(n.useEffect)((()=>{g(null!=E?E:[])}),[E]),Object(n.useEffect)((()=>{S&&m(S,{title:c.m})}),[S,m]),Object(n.useEffect)((()=>{p&&p(b)}),[b,p]);const O=Object(n.useCallback)((e=>{const t=e.target.value;p&&p(!0),g([]),h({filters:[],query:{query:t,language:"eql"}})}),[h,p]);return i.a.createElement(o.EuiFormRow,{label:t.label,labelAppend:t.labelAppend,helpText:t.helpText,error:v,isInvalid:!y&&!b,fullWidth:!0,"data-test-subj":e,describedByIds:a?[a]:void 0},i.a.createElement(i.a.Fragment,null,i.a.createElement(x,{"data-test-subj":"eqlQueryBarTextInput",fullWidth:!0,isInvalid:!y&&!b,value:w,onChange:O}),i.a.createElement(T,{errors:f,isLoading:b,optionsData:r,optionsSelected:s,onOptionsChange:u})))}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,a){e.exports=a(46)(1345)},function(e,t,a){"use strict";e.exports={position:!0,gfm:!0,commonmark:!1,footnotes:!1,pedantic:!1,blocks:a(974)}},function(e,t,a){"use strict";e.exports=function(e){var t,a=0,i=0,r=e.charAt(a),s={};for(;r in n;)i+=t=n[r],t>1&&(i=Math.floor(i/t)*t),s[i]=a,r=e.charAt(++a);return{indent:i,stops:s}};var n={" ":1,"\t":4}},function(e,t,a){"use strict";var n="<[A-Za-z][A-Za-z0-9\\-]*(?:\\s+[a-zA-Z_:][a-zA-Z0-9:._-]*(?:\\s*=\\s*(?:[^\"'=<>`\\u0000-\\u0020]+|'[^']*'|\"[^\"]*\"))?)*\\s*\\/?>",i="<\\/[A-Za-z][A-Za-z0-9\\-]*\\s*>";t.openCloseTag=new RegExp("^(?:"+n+"|"+i+")"),t.tag=new RegExp("^(?:"+n+"|"+i+"|\x3c!----\x3e|\x3c!--(?:-?[^>-])(?:-?[^-])*--\x3e|<[?].*?[?]>|<![A-Za-z]+\\s+[^>]*>|<!\\[CDATA\\[[\\s\\S]*?\\]\\]>)")},function(e,t,a){"use strict";e.exports=function(e,t){return e.indexOf("<",t)}},function(e,t,a){"use strict";e.exports=function(e,t){var a=e.indexOf("[",t),n=e.indexOf("![",t);if(-1===n)return a;return a<n?a:n}},,,function(e,t,a){"use strict";var n=a(258);Object.defineProperty(t,"__esModule",{value:!0});var i={within:!0,queries:!0,queryHelpers:!0,getDefaultNormalizer:!0,getRoles:!0,logRoles:!0,isInaccessible:!0,configure:!0,getConfig:!0};Object.defineProperty(t,"within",{enumerable:!0,get:function(){return r.getQueriesForElement}}),Object.defineProperty(t,"getDefaultNormalizer",{enumerable:!0,get:function(){return p.getDefaultNormalizer}}),Object.defineProperty(t,"getRoles",{enumerable:!0,get:function(){return b.getRoles}}),Object.defineProperty(t,"logRoles",{enumerable:!0,get:function(){return b.logRoles}}),Object.defineProperty(t,"isInaccessible",{enumerable:!0,get:function(){return b.isInaccessible}}),Object.defineProperty(t,"configure",{enumerable:!0,get:function(){return y.configure}}),Object.defineProperty(t,"getConfig",{enumerable:!0,get:function(){return y.getConfig}}),t.queryHelpers=t.queries=void 0;var r=a(698);Object.keys(r).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(i,e)||e in t&&t[e]===r[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return r[e]}}))}));var s=n(a(488));t.queries=s,Object.keys(s).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(i,e)||e in t&&t[e]===s[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return s[e]}}))}));var o=n(a(227));t.queryHelpers=o,Object.keys(o).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(i,e)||e in t&&t[e]===o[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}}))}));var l=a(406);Object.keys(l).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(i,e)||e in t&&t[e]===l[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return l[e]}}))}));var c=a(1330);Object.keys(c).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(i,e)||e in t&&t[e]===c[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return c[e]}}))}));var u=a(1331);Object.keys(u).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(i,e)||e in t&&t[e]===u[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return u[e]}}))}));var d=a(1332);Object.keys(d).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(i,e)||e in t&&t[e]===d[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return d[e]}}))}));var p=a(394),m=a(490);Object.keys(m).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(i,e)||e in t&&t[e]===m[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return m[e]}}))}));var f=a(1333);Object.keys(f).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(i,e)||e in t&&t[e]===f[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return f[e]}}))}));var g=a(1335);Object.keys(g).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(i,e)||e in t&&t[e]===g[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return g[e]}}))}));var b=a(492),h=a(392);Object.keys(h).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(i,e)||e in t&&t[e]===h[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return h[e]}}))}));var y=a(204),v=a(703);Object.keys(v).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(i,e)||e in t&&t[e]===v[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return v[e]}}))}))},function(e,t,a){"use strict";var n=a(258);Object.defineProperty(t,"__esModule",{value:!0}),t.getQueriesForElement=function(e,t=i,a={}){return Object.keys(t).reduce(((a,n)=>{const i=t[n];return a[n]=i.bind(null,e),a}),a)};var i=n(a(488))},function(e,t,a){"use strict";(function(e){const t=(e,t)=>(...a)=>`[${e(...a)+t}m`,n=(e,t)=>(...a)=>{const n=e(...a);return`[${38+t};5;${n}m`},i=(e,t)=>(...a)=>{const n=e(...a);return`[${38+t};2;${n[0]};${n[1]};${n[2]}m`},r=e=>e,s=(e,t,a)=>[e,t,a],o=(e,t,a)=>{Object.defineProperty(e,t,{get:()=>{const n=a();return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0}),n},enumerable:!0,configurable:!0})};let l;const c=(e,t,n,i)=>{void 0===l&&(l=a(1031));const r=i?10:0,s={};for(const[a,i]of Object.entries(l)){const o="ansi16"===a?"ansi":a;a===t?s[o]=e(n,r):"object"==typeof i&&(s[o]=e(i[t],r))}return s};Object.defineProperty(e,"exports",{enumerable:!0,get:function(){const e=new Map,a={modifier:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},color:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],blackBright:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39]},bgColor:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]}};a.color.gray=a.color.blackBright,a.bgColor.bgGray=a.bgColor.bgBlackBright,a.color.grey=a.color.blackBright,a.bgColor.bgGrey=a.bgColor.bgBlackBright;for(const[t,n]of Object.entries(a)){for(const[t,i]of Object.entries(n))a[t]={open:`[${i[0]}m`,close:`[${i[1]}m`},n[t]=a[t],e.set(i[0],i[1]);Object.defineProperty(a,t,{value:n,enumerable:!1})}return Object.defineProperty(a,"codes",{value:e,enumerable:!1}),a.color.close="[39m",a.bgColor.close="[49m",o(a.color,"ansi",(()=>c(t,"ansi16",r,!1))),o(a.color,"ansi256",(()=>c(n,"ansi256",r,!1))),o(a.color,"ansi16m",(()=>c(i,"rgb",s,!1))),o(a.bgColor,"ansi",(()=>c(t,"ansi16",r,!0))),o(a.bgColor,"ansi256",(()=>c(n,"ansi256",r,!0))),o(a.bgColor,"ansi16m",(()=>c(i,"rgb",s,!0))),a}})}).call(this,a(226)(e))},function(e,t,a){const n=a(1032),i={};for(const e of Object.keys(n))i[n[e]]=e;const r={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};e.exports=r;for(const e of Object.keys(r)){if(!("channels"in r[e]))throw new Error("missing channels property: "+e);if(!("labels"in r[e]))throw new Error("missing channel labels property: "+e);if(r[e].labels.length!==r[e].channels)throw new Error("channel and label counts mismatch: "+e);const{channels:t,labels:a}=r[e];delete r[e].channels,delete r[e].labels,Object.defineProperty(r[e],"channels",{value:t}),Object.defineProperty(r[e],"labels",{value:a})}r.rgb.hsl=function(e){const t=e[0]/255,a=e[1]/255,n=e[2]/255,i=Math.min(t,a,n),r=Math.max(t,a,n),s=r-i;let o,l;r===i?o=0:t===r?o=(a-n)/s:a===r?o=2+(n-t)/s:n===r&&(o=4+(t-a)/s),o=Math.min(60*o,360),o<0&&(o+=360);const c=(i+r)/2;return l=r===i?0:c<=.5?s/(r+i):s/(2-r-i),[o,100*l,100*c]},r.rgb.hsv=function(e){let t,a,n,i,r;const s=e[0]/255,o=e[1]/255,l=e[2]/255,c=Math.max(s,o,l),u=c-Math.min(s,o,l),d=function(e){return(c-e)/6/u+.5};return 0===u?(i=0,r=0):(r=u/c,t=d(s),a=d(o),n=d(l),s===c?i=n-a:o===c?i=1/3+t-n:l===c&&(i=2/3+a-t),i<0?i+=1:i>1&&(i-=1)),[360*i,100*r,100*c]},r.rgb.hwb=function(e){const t=e[0],a=e[1];let n=e[2];const i=r.rgb.hsl(e)[0],s=1/255*Math.min(t,Math.min(a,n));return n=1-1/255*Math.max(t,Math.max(a,n)),[i,100*s,100*n]},r.rgb.cmyk=function(e){const t=e[0]/255,a=e[1]/255,n=e[2]/255,i=Math.min(1-t,1-a,1-n);return[100*((1-t-i)/(1-i)||0),100*((1-a-i)/(1-i)||0),100*((1-n-i)/(1-i)||0),100*i]},r.rgb.keyword=function(e){const t=i[e];if(t)return t;let a,r=1/0;for(const t of Object.keys(n)){const i=n[t],l=(o=i,((s=e)[0]-o[0])**2+(s[1]-o[1])**2+(s[2]-o[2])**2);l<r&&(r=l,a=t)}var s,o;return a},r.keyword.rgb=function(e){return n[e]},r.rgb.xyz=function(e){let t=e[0]/255,a=e[1]/255,n=e[2]/255;t=t>.04045?((t+.055)/1.055)**2.4:t/12.92,a=a>.04045?((a+.055)/1.055)**2.4:a/12.92,n=n>.04045?((n+.055)/1.055)**2.4:n/12.92;return[100*(.4124*t+.3576*a+.1805*n),100*(.2126*t+.7152*a+.0722*n),100*(.0193*t+.1192*a+.9505*n)]},r.rgb.lab=function(e){const t=r.rgb.xyz(e);let a=t[0],n=t[1],i=t[2];a/=95.047,n/=100,i/=108.883,a=a>.008856?a**(1/3):7.787*a+16/116,n=n>.008856?n**(1/3):7.787*n+16/116,i=i>.008856?i**(1/3):7.787*i+16/116;return[116*n-16,500*(a-n),200*(n-i)]},r.hsl.rgb=function(e){const t=e[0]/360,a=e[1]/100,n=e[2]/100;let i,r,s;if(0===a)return s=255*n,[s,s,s];i=n<.5?n*(1+a):n+a-n*a;const o=2*n-i,l=[0,0,0];for(let e=0;e<3;e++)r=t+1/3*-(e-1),r<0&&r++,r>1&&r--,s=6*r<1?o+6*(i-o)*r:2*r<1?i:3*r<2?o+(i-o)*(2/3-r)*6:o,l[e]=255*s;return l},r.hsl.hsv=function(e){const t=e[0];let a=e[1]/100,n=e[2]/100,i=a;const r=Math.max(n,.01);n*=2,a*=n<=1?n:2-n,i*=r<=1?r:2-r;return[t,100*(0===n?2*i/(r+i):2*a/(n+a)),100*((n+a)/2)]},r.hsv.rgb=function(e){const t=e[0]/60,a=e[1]/100;let n=e[2]/100;const i=Math.floor(t)%6,r=t-Math.floor(t),s=255*n*(1-a),o=255*n*(1-a*r),l=255*n*(1-a*(1-r));switch(n*=255,i){case 0:return[n,l,s];case 1:return[o,n,s];case 2:return[s,n,l];case 3:return[s,o,n];case 4:return[l,s,n];case 5:return[n,s,o]}},r.hsv.hsl=function(e){const t=e[0],a=e[1]/100,n=e[2]/100,i=Math.max(n,.01);let r,s;s=(2-a)*n;const o=(2-a)*i;return r=a*i,r/=o<=1?o:2-o,r=r||0,s/=2,[t,100*r,100*s]},r.hwb.rgb=function(e){const t=e[0]/360;let a=e[1]/100,n=e[2]/100;const i=a+n;let r;i>1&&(a/=i,n/=i);const s=Math.floor(6*t),o=1-n;r=6*t-s,0!=(1&s)&&(r=1-r);const l=a+r*(o-a);let c,u,d;switch(s){default:case 6:case 0:c=o,u=l,d=a;break;case 1:c=l,u=o,d=a;break;case 2:c=a,u=o,d=l;break;case 3:c=a,u=l,d=o;break;case 4:c=l,u=a,d=o;break;case 5:c=o,u=a,d=l}return[255*c,255*u,255*d]},r.cmyk.rgb=function(e){const t=e[0]/100,a=e[1]/100,n=e[2]/100,i=e[3]/100;return[255*(1-Math.min(1,t*(1-i)+i)),255*(1-Math.min(1,a*(1-i)+i)),255*(1-Math.min(1,n*(1-i)+i))]},r.xyz.rgb=function(e){const t=e[0]/100,a=e[1]/100,n=e[2]/100;let i,r,s;return i=3.2406*t+-1.5372*a+-.4986*n,r=-.9689*t+1.8758*a+.0415*n,s=.0557*t+-.204*a+1.057*n,i=i>.0031308?1.055*i**(1/2.4)-.055:12.92*i,r=r>.0031308?1.055*r**(1/2.4)-.055:12.92*r,s=s>.0031308?1.055*s**(1/2.4)-.055:12.92*s,i=Math.min(Math.max(0,i),1),r=Math.min(Math.max(0,r),1),s=Math.min(Math.max(0,s),1),[255*i,255*r,255*s]},r.xyz.lab=function(e){let t=e[0],a=e[1],n=e[2];t/=95.047,a/=100,n/=108.883,t=t>.008856?t**(1/3):7.787*t+16/116,a=a>.008856?a**(1/3):7.787*a+16/116,n=n>.008856?n**(1/3):7.787*n+16/116;return[116*a-16,500*(t-a),200*(a-n)]},r.lab.xyz=function(e){let t,a,n;a=(e[0]+16)/116,t=e[1]/500+a,n=a-e[2]/200;const i=a**3,r=t**3,s=n**3;return a=i>.008856?i:(a-16/116)/7.787,t=r>.008856?r:(t-16/116)/7.787,n=s>.008856?s:(n-16/116)/7.787,t*=95.047,a*=100,n*=108.883,[t,a,n]},r.lab.lch=function(e){const t=e[0],a=e[1],n=e[2];let i;i=360*Math.atan2(n,a)/2/Math.PI,i<0&&(i+=360);return[t,Math.sqrt(a*a+n*n),i]},r.lch.lab=function(e){const t=e[0],a=e[1],n=e[2]/360*2*Math.PI;return[t,a*Math.cos(n),a*Math.sin(n)]},r.rgb.ansi16=function(e,t=null){const[a,n,i]=e;let s=null===t?r.rgb.hsv(e)[2]:t;if(s=Math.round(s/50),0===s)return 30;let o=30+(Math.round(i/255)<<2|Math.round(n/255)<<1|Math.round(a/255));return 2===s&&(o+=60),o},r.hsv.ansi16=function(e){return r.rgb.ansi16(r.hsv.rgb(e),e[2])},r.rgb.ansi256=function(e){const t=e[0],a=e[1],n=e[2];if(t===a&&a===n)return t<8?16:t>248?231:Math.round((t-8)/247*24)+232;return 16+36*Math.round(t/255*5)+6*Math.round(a/255*5)+Math.round(n/255*5)},r.ansi16.rgb=function(e){let t=e%10;if(0===t||7===t)return e>50&&(t+=3.5),t=t/10.5*255,[t,t,t];const a=.5*(1+~~(e>50));return[(1&t)*a*255,(t>>1&1)*a*255,(t>>2&1)*a*255]},r.ansi256.rgb=function(e){if(e>=232){const t=10*(e-232)+8;return[t,t,t]}let t;e-=16;return[Math.floor(e/36)/5*255,Math.floor((t=e%36)/6)/5*255,t%6/5*255]},r.rgb.hex=function(e){const t=(((255&Math.round(e[0]))<<16)+((255&Math.round(e[1]))<<8)+(255&Math.round(e[2]))).toString(16).toUpperCase();return"000000".substring(t.length)+t},r.hex.rgb=function(e){const t=e.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!t)return[0,0,0];let a=t[0];3===t[0].length&&(a=a.split("").map((e=>e+e)).join(""));const n=parseInt(a,16);return[n>>16&255,n>>8&255,255&n]},r.rgb.hcg=function(e){const t=e[0]/255,a=e[1]/255,n=e[2]/255,i=Math.max(Math.max(t,a),n),r=Math.min(Math.min(t,a),n),s=i-r;let o,l;return o=s<1?r/(1-s):0,l=s<=0?0:i===t?(a-n)/s%6:i===a?2+(n-t)/s:4+(t-a)/s,l/=6,l%=1,[360*l,100*s,100*o]},r.hsl.hcg=function(e){const t=e[1]/100,a=e[2]/100,n=a<.5?2*t*a:2*t*(1-a);let i=0;return n<1&&(i=(a-.5*n)/(1-n)),[e[0],100*n,100*i]},r.hsv.hcg=function(e){const t=e[1]/100,a=e[2]/100,n=t*a;let i=0;return n<1&&(i=(a-n)/(1-n)),[e[0],100*n,100*i]},r.hcg.rgb=function(e){const t=e[0]/360,a=e[1]/100,n=e[2]/100;if(0===a)return[255*n,255*n,255*n];const i=[0,0,0],r=t%1*6,s=r%1,o=1-s;let l=0;switch(Math.floor(r)){case 0:i[0]=1,i[1]=s,i[2]=0;break;case 1:i[0]=o,i[1]=1,i[2]=0;break;case 2:i[0]=0,i[1]=1,i[2]=s;break;case 3:i[0]=0,i[1]=o,i[2]=1;break;case 4:i[0]=s,i[1]=0,i[2]=1;break;default:i[0]=1,i[1]=0,i[2]=o}return l=(1-a)*n,[255*(a*i[0]+l),255*(a*i[1]+l),255*(a*i[2]+l)]},r.hcg.hsv=function(e){const t=e[1]/100,a=t+e[2]/100*(1-t);let n=0;return a>0&&(n=t/a),[e[0],100*n,100*a]},r.hcg.hsl=function(e){const t=e[1]/100,a=e[2]/100*(1-t)+.5*t;let n=0;return a>0&&a<.5?n=t/(2*a):a>=.5&&a<1&&(n=t/(2*(1-a))),[e[0],100*n,100*a]},r.hcg.hwb=function(e){const t=e[1]/100,a=t+e[2]/100*(1-t);return[e[0],100*(a-t),100*(1-a)]},r.hwb.hcg=function(e){const t=e[1]/100,a=1-e[2]/100,n=a-t;let i=0;return n<1&&(i=(a-n)/(1-n)),[e[0],100*n,100*i]},r.apple.rgb=function(e){return[e[0]/65535*255,e[1]/65535*255,e[2]/65535*255]},r.rgb.apple=function(e){return[e[0]/255*65535,e[1]/255*65535,e[2]/255*65535]},r.gray.rgb=function(e){return[e[0]/100*255,e[0]/100*255,e[0]/100*255]},r.gray.hsl=function(e){return[0,0,e[0]]},r.gray.hsv=r.gray.hsl,r.gray.hwb=function(e){return[0,100,e[0]]},r.gray.cmyk=function(e){return[0,0,0,e[0]]},r.gray.lab=function(e){return[e[0],0,0]},r.gray.hex=function(e){const t=255&Math.round(e[0]/100*255),a=((t<<16)+(t<<8)+t).toString(16).toUpperCase();return"000000".substring(a.length)+a},r.rgb.gray=function(e){return[(e[0]+e[1]+e[2])/3/255*100]}},function(e,t,a){(function(e){var n=Function.prototype.apply;function i(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new i(n.call(setTimeout,window,arguments),clearTimeout)},t.setInterval=function(){return new i(n.call(setInterval,window,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},i.prototype.unref=i.prototype.ref=function(){},i.prototype.close=function(){this._clearFn.call(window,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout((function(){e._onTimeout&&e._onTimeout()}),t))},a(1046),t.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||this&&this.clearImmediate}).call(this,a(239))},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getLabels=function(e,t,{selector:a="*"}={}){const n=t.getAttribute("aria-labelledby"),i=n?n.split(" "):[];return i.length?i.map((t=>{const a=e.querySelector(`[id="${t}"]`);return a?{content:s(a),formControl:null}:{content:"",formControl:null}})):Array.from(o(t)).map((e=>({content:s(e),formControl:Array.from(e.querySelectorAll("button, input, meter, output, progress, select, textarea")).filter((e=>e.matches(a)))[0]})))},t.getRealLabels=o,t.getLabelContent=s;var n=a(161);const i=["button","meter","output","progress","select","textarea","input"];function r(e){return i.includes(e.nodeName.toLowerCase())?"":e.nodeType===n.TEXT_NODE?e.textContent:Array.from(e.childNodes).map((e=>r(e))).join("")}function s(e){let t;return t="label"===e.tagName.toLowerCase()?r(e):e.value||e.textContent,t}function o(e){var t;if(void 0!==e.labels)return null!=(t=e.labels)?t:[];if(!function(e){return/BUTTON|METER|OUTPUT|PROGRESS|SELECT|TEXTAREA/.test(e.tagName)||"INPUT"===e.tagName&&"hidden"!==e.getAttribute("type")}(e))return[];const a=e.ownerDocument.querySelectorAll("label");return Array.from(a).filter((t=>t.control===e))}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSuggestedQuery=function(e,t="get",a){var i,u;if(e.matches(s.DEFAULT_IGNORE_TAGS))return;const m=null!=(i=e.getAttribute("role"))?i:null==(u=(0,o.getImplicitAriaRoles)(e))?void 0:u[0];if("generic"!==m&&p("Role",a,m))return d("Role",e,m,{variant:t,name:(0,n.computeAccessibleName)(e,{computedStyleSupportsPseudoElements:(0,s.getConfig)().computedStyleSupportsPseudoElements})});const f=(0,l.getLabels)(document,e).map((e=>e.content)).join(" ");if(p("LabelText",a,f))return d("LabelText",e,f,{variant:t});const g=e.getAttribute("placeholder");if(p("PlaceholderText",a,g))return d("PlaceholderText",e,g,{variant:t});const b=c((0,r.getNodeText)(e));if(p("Text",a,b))return d("Text",e,b,{variant:t});if(p("DisplayValue",a,e.value))return d("DisplayValue",e,c(e.value),{variant:t});const h=e.getAttribute("alt");if(p("AltText",a,h))return d("AltText",e,h,{variant:t});const y=e.getAttribute("title");if(p("Title",a,y))return d("Title",e,y,{variant:t});const v=e.getAttribute((0,s.getConfig)().testIdAttribute);if(p("TestId",a,v))return d("TestId",e,v,{variant:t});return};var n=a(491),i=a(394),r=a(490),s=a(204),o=a(492),l=a(702);const c=(0,i.getDefaultNormalizer)();function u(e){return new RegExp(function(e){return e.replace(/[.*+\-?^${}()|[\]\\]/g,"\\$&")}(e.toLowerCase()),"i")}function d(e,t,a,{variant:n,name:i}){let r="";const s={},l=[["Role","TestId"].includes(e)?a:u(a)];i&&(s.name=u(i)),"Role"===e&&(0,o.isInaccessible)(t)&&(s.hidden=!0,r="Element is inaccessible. This means that the element and all its children are invisible to screen readers.\n    If you are using the aria-hidden prop, make sure this is the right choice for your case.\n    "),Object.keys(s).length>0&&l.push(s);const c=`${n}By${e}`;return{queryName:e,queryMethod:c,queryArgs:l,variant:n,warning:r,toString(){r&&console.warn(r);let[e,t]=l;return e="string"==typeof e?`'${e}'`:e,t=t?`, { ${Object.entries(t).map((([e,t])=>`${e}: ${t}`)).join(", ")} }`:"",`${c}(${e}${t})`}}}function p(e,t,a){return a&&(!t||t.toLowerCase()===e.toLowerCase())}},function(e,t,a){"use strict";t.__esModule=!0,t.computeTextAlternative=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=new i.default,s=(0,r.safeWindow)(e),d=t.compute,y=void 0===d?"name":d,v=t.computedStyleSupportsPseudoElements,E=void 0===v?void 0!==t.getComputedStyle:v,x=t.getComputedStyle,S=void 0===x?s.getComputedStyle.bind(s):x;function w(e,t){var a="";if((0,r.isElement)(e)&&E){var i=h(S(e,"::before"));a="".concat(i," ").concat(a)}if(((0,r.isHTMLSlotElement)(e)?k(e):(0,n.default)(e.childNodes).concat((0,r.queryIdRefs)(e,"aria-owns"))).forEach((function(e){var n=j(e,{isEmbeddedInLabel:t.isEmbeddedInLabel,isReferenced:!1,recursion:!0}),i="inline"!==((0,r.isElement)(e)?S(e).getPropertyValue("display"):"inline")?" ":"";a+="".concat(i).concat(n).concat(i)})),(0,r.isElement)(e)&&E){var s=h(S(e,"::after"));a="".concat(a," ").concat(s)}return a}function O(e){if(!(0,r.isElement)(e))return null;function t(e,t){var n=e.getAttributeNode(t);return null===n||a.has(n)||""===n.value.trim()?null:(a.add(n),n.value)}if((0,r.isHTMLFieldSetElement)(e)){a.add(e);for(var i=(0,n.default)(e.childNodes),s=0;s<i.length;s+=1){var o=i[s];if((0,r.isHTMLLegendElement)(o))return j(o,{isEmbeddedInLabel:!1,isReferenced:!1,recursion:!1})}}else if((0,r.isHTMLTableElement)(e)){a.add(e);for(var l=(0,n.default)(e.childNodes),c=0;c<l.length;c+=1){var u=l[c];if((0,r.isHTMLTableCaptionElement)(u))return j(u,{isEmbeddedInLabel:!1,isReferenced:!1,recursion:!1})}}else{if((0,r.isSVGSVGElement)(e)){a.add(e);for(var d=(0,n.default)(e.childNodes),p=0;p<d.length;p+=1){var m=d[p];if((0,r.isSVGTitleElement)(m))return m.textContent}return null}if("img"===(0,r.getLocalName)(e)||"area"===(0,r.getLocalName)(e)){var f=t(e,"alt");if(null!==f)return f}}if((0,r.isHTMLInputElement)(e)&&("button"===e.type||"submit"===e.type||"reset"===e.type)){var g=t(e,"value");if(null!==g)return g;if("submit"===e.type)return"Submit";if("reset"===e.type)return"Reset"}if((0,r.isHTMLInputElement)(e)||(0,r.isHTMLSelectElement)(e)||(0,r.isHTMLTextAreaElement)(e)){var b=e,h=T(b);if(null!==h&&0!==h.length)return a.add(b),(0,n.default)(h).map((function(e){return j(e,{isEmbeddedInLabel:!0,isReferenced:!1,recursion:!0})})).filter((function(e){return e.length>0})).join(" ")}if((0,r.isHTMLInputElement)(e)&&"image"===e.type){var y=t(e,"alt");if(null!==y)return y;var v=t(e,"title");return null!==v?v:"Submit Query"}return t(e,"title")}function j(e,t){if(a.has(e))return"";if((0,r.hasAnyConcreteRoles)(e,["menu"]))return a.add(e),"";if(l(e,S)&&!t.isReferenced)return a.add(e),"";var i=(0,r.queryIdRefs)(e,"aria-labelledby");if("name"===y&&!t.isReferenced&&i.length>0)return i.map((function(e){return j(e,{isEmbeddedInLabel:t.isEmbeddedInLabel,isReferenced:!0,recursion:!1})})).join(" ");var s=t.recursion&&c(e)&&"name"===y;if(!s){var o=((0,r.isElement)(e)&&e.getAttribute("aria-label")||"").trim();if(""!==o&&"name"===y)return a.add(e),o;if(!m(e)){var d=O(e);if(null!==d)return a.add(e),d}}if(s||t.isEmbeddedInLabel||t.isReferenced){if((0,r.hasAnyConcreteRoles)(e,["combobox","listbox"])){a.add(e);var h=p(e);return 0===h.length?(0,r.isHTMLInputElement)(e)?e.value:"":(0,n.default)(h).map((function(e){return j(e,{isEmbeddedInLabel:t.isEmbeddedInLabel,isReferenced:!1,recursion:!0})})).join(" ")}if(u(e,"range"))return a.add(e),e.hasAttribute("aria-valuetext")?e.getAttribute("aria-valuetext"):e.hasAttribute("aria-valuenow")?e.getAttribute("aria-valuenow"):e.getAttribute("value")||"";if((0,r.hasAnyConcreteRoles)(e,["textbox"]))return a.add(e),b(e)}if(g(e)||(0,r.isElement)(e)&&t.isReferenced||f(e))return a.add(e),w(e,{isEmbeddedInLabel:t.isEmbeddedInLabel,isReferenced:!1});if(e.nodeType===e.TEXT_NODE)return a.add(e),e.textContent||"";if(t.recursion)return a.add(e),w(e,{isEmbeddedInLabel:t.isEmbeddedInLabel,isReferenced:!1});return a.add(e),""}return o(j(e,{isEmbeddedInLabel:!1,isReferenced:"description"===y,recursion:!1}))};var n=s(a(1048)),i=s(a(1049)),r=a(395);function s(e){return e&&e.__esModule?e:{default:e}}function o(e){return e.trim().replace(/\s\s+/g," ")}function l(e,t){if(!(0,r.isElement)(e))return!1;if(e.hasAttribute("hidden")||"true"===e.getAttribute("aria-hidden"))return!0;var a=t(e);return"none"===a.getPropertyValue("display")||"hidden"===a.getPropertyValue("visibility")}function c(e){return(0,r.hasAnyConcreteRoles)(e,["button","combobox","listbox","textbox"])||u(e,"range")}function u(e,t){if(!(0,r.isElement)(e))return!1;if("range"===t)return(0,r.hasAnyConcreteRoles)(e,["meter","progressbar","scrollbar","slider","spinbutton"]);throw new TypeError("No knowledge about abstract role '".concat(t,"'. This is likely a bug :("))}function d(e,t){var a=(0,n.default)(e.querySelectorAll(t));return(0,r.queryIdRefs)(e,"aria-owns").forEach((function(e){a.push.apply(a,(0,n.default)(e.querySelectorAll(t)))})),a}function p(e){return(0,r.isHTMLSelectElement)(e)?e.selectedOptions||d(e,"[selected]"):d(e,'[aria-selected="true"]')}function m(e){return(0,r.hasAnyConcreteRoles)(e,["none","presentation"])}function f(e){return(0,r.isHTMLTableCaptionElement)(e)}function g(e){return(0,r.hasAnyConcreteRoles)(e,["button","cell","checkbox","columnheader","gridcell","heading","label","legend","link","menuitem","menuitemcheckbox","menuitemradio","option","radio","row","rowheader","switch","tab","tooltip","treeitem"])}function b(e){return(0,r.isHTMLInputElement)(e)||(0,r.isHTMLTextAreaElement)(e)?e.value:e.textContent||""}function h(e){var t=e.getPropertyValue("content");return/^["'].*["']$/.test(t)?t.slice(1,-1):""}function y(e){var t=(0,r.getLocalName)(e);return"button"===t||"input"===t&&"hidden"!==e.getAttribute("type")||"meter"===t||"output"===t||"progress"===t||"select"===t||"textarea"===t}function v(e){if(y(e))return e;var t=null;return e.childNodes.forEach((function(e){if(null===t&&(0,r.isElement)(e)){var a=v(e);null!==a&&(t=a)}})),t}function E(e){if(void 0!==e.control)return e.control;var t=e.getAttribute("for");return null!==t?e.ownerDocument.getElementById(t):v(e)}function T(e){var t=e.labels;if(null===t)return t;if(void 0!==t)return(0,n.default)(t);if(!y(e))return null;var a=e.ownerDocument;return(0,n.default)(a.querySelectorAll("label")).filter((function(t){return E(t)===e}))}function k(e){var t=e.assignedNodes();return 0===t.length?(0,n.default)(e.childNodes):t}},function(e,t,a){"use strict";t.__esModule=!0,t.default=function(e){var t=function(e){if(e.hasAttribute("role")){var t=e.getAttribute("role").trim().split(" "),a=(r=1,function(e){if(Array.isArray(e))return e}(n=t)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var a=[],n=!0,i=!1,r=void 0;try{for(var s,o=e[Symbol.iterator]();!(n=(s=o.next()).done)&&(a.push(s.value),!t||a.length!==t);n=!0);}catch(e){i=!0,r=e}finally{try{n||null==o.return||o.return()}finally{if(i)throw r}}return a}}(n,r)||function(e,t){if(e){if("string"==typeof e)return i(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?i(e,t):void 0}}(n,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0];if(void 0!==a&&a.length>0)return a}var n,r;return null}(e);if(null===t||"presentation"===t){var a=function(e){var t=r[(0,n.getLocalName)(e)];if(void 0!==t)return t;switch((0,n.getLocalName)(e)){case"a":case"area":case"link":if(e.hasAttribute("href"))return"link";break;case"img":return""!==e.getAttribute("alt")||o(e,"img")?"img":"presentation";case"input":var a=e.type;switch(a){case"button":case"image":case"reset":case"submit":return"button";case"checkbox":case"radio":return a;case"range":return"slider";case"email":case"tel":case"text":case"url":return e.hasAttribute("list")?"combobox":"textbox";case"search":return e.hasAttribute("list")?"combobox":"searchbox";default:return null}case"select":return e.hasAttribute("multiple")||e.size>1?"listbox":"combobox"}return null}(e);if("presentation"!==t||o(e,a||""))return a}return t};var n=a(395);function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var r={article:"article",aside:"complementary",body:"document",button:"button",datalist:"listbox",dd:"definition",details:"group",dialog:"dialog",dt:"term",fieldset:"group",figure:"figure",form:"form",footer:"contentinfo",h1:"heading",h2:"heading",h3:"heading",h4:"heading",h5:"heading",h6:"heading",header:"banner",hr:"separator",legend:"legend",li:"listitem",math:"math",main:"main",menu:"list",nav:"navigation",ol:"list",optgroup:"group",option:"option",output:"status",progress:"progressbar",section:"region",summary:"button",table:"table",tbody:"rowgroup",textarea:"textbox",tfoot:"rowgroup",td:"cell",th:"columnheader",thead:"rowgroup",tr:"row",ul:"list"},s={caption:new Set(["aria-label","aria-labelledby"]),code:new Set(["aria-label","aria-labelledby"]),deletion:new Set(["aria-label","aria-labelledby"]),emphasis:new Set(["aria-label","aria-labelledby"]),generic:new Set(["aria-label","aria-labelledby","aria-roledescription"]),insertion:new Set(["aria-label","aria-labelledby"]),paragraph:new Set(["aria-label","aria-labelledby"]),presentation:new Set(["aria-label","aria-labelledby"]),strong:new Set(["aria-label","aria-labelledby"]),subscript:new Set(["aria-label","aria-labelledby"]),superscript:new Set(["aria-label","aria-labelledby"])};function o(e,t){return function(e,t){return["aria-atomic","aria-busy","aria-controls","aria-current","aria-describedby","aria-details","aria-dropeffect","aria-flowto","aria-grabbed","aria-hidden","aria-keyshortcuts","aria-label","aria-labelledby","aria-live","aria-owns","aria-relevant","aria-roledescription"].some((function(a){var n;return e.hasAttribute(a)&&!(null===(n=s[t])||void 0===n?void 0:n.has(a))}))}(e,t)}},function(e,t,a){"use strict";var n=a(228);a(92)(t,"__esModule",{value:!0}),t.roleElements=t.elementRoles=t.roles=t.dom=t.aria=void 0;var i=n(a(1058)),r=n(a(1081)),s=n(a(513)),o=n(a(1276)),l=n(a(1322)),c=i.default;t.aria=c;var u=r.default;t.dom=u;var d=s.default;t.roles=d;var p=o.default;t.elementRoles=p;var m=l.default;t.roleElements=m},function(e,t,a){var n=a(1051);e.exports=n},function(e,t,a){var n=a(182),i=a(205),r=a(493),s=a(335),o=a(250),l=a(397),c=a(162),u=a(710),d=Object.getOwnPropertyDescriptor;t.f=n?d:function(e,t){if(e=o(e),t=l(t),u)try{return d(e,t)}catch(e){}if(c(e,t))return s(!i(r.f,e,t),e[t])}},function(e,t,a){var n=a(497);e.exports=n&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},function(e,t,a){var n=a(182),i=a(134),r=a(711);e.exports=!n&&!i((function(){return 7!=Object.defineProperty(r("div"),"a",{get:function(){return 7}}).a}))},function(e,t,a){var n=a(102),i=a(183),r=n.document,s=i(r)&&i(r.createElement);e.exports=function(e){return s?r.createElement(e):{}}},function(e,t){e.exports=function(){}},function(e,t,a){var n=a(133),i=a(145),r=a(503),s=n(Function.toString);i(r.inspectSource)||(r.inspectSource=function(e){return s(e)}),e.exports=r.inspectSource},function(e,t,a){"use strict";var n,i,r,s=a(134),o=a(145),l=a(401),c=a(717),u=a(403),d=a(140),p=a(398),m=d("iterator"),f=!1;[].keys&&("next"in(r=[].keys())?(i=c(c(r)))!==Object.prototype&&(n=i):f=!0),null==n||s((function(){var e={};return n[m].call(e)!==e}))?n={}:p&&(n=l(n)),o(n[m])||u(n,m,(function(){return this})),e.exports={IteratorPrototype:n,BUGGY_SAFARI_ITERATORS:f}},function(e,t,a){var n=a(133),i=a(162),r=a(250),s=a(1065).indexOf,o=a(339),l=n([].push);e.exports=function(e,t){var a,n=r(e),c=0,u=[];for(a in n)!i(o,a)&&i(n,a)&&l(u,a);for(;t.length>c;)i(n,a=t[c++])&&(~s(u,a)||l(u,a));return u}},function(e,t,a){var n=a(505),i=Math.max,r=Math.min;e.exports=function(e,t){var a=n(e);return a<0?i(a+t,0):r(a,t)}},function(e,t,a){var n=a(102),i=a(162),r=a(145),s=a(251),o=a(400),l=a(1068),c=o("IE_PROTO"),u=n.Object,d=u.prototype;e.exports=l?u.getPrototypeOf:function(e){var t=s(e);if(i(t,c))return t[c];var a=t.constructor;return r(a)&&t instanceof a?a.prototype:t instanceof u?d:null}},function(e,t,a){"use strict";var n=a(167),i=a(102),r=a(719),s=a(134),o=a(276),l=a(721),c=a(724),u=a(145),d=a(183),p=a(340),m=a(196).f,f=a(405).forEach,g=a(182),b=a(338),h=b.set,y=b.getterFor;e.exports=function(e,t,a){var b,v=-1!==e.indexOf("Map"),E=-1!==e.indexOf("Weak"),T=v?"set":"add",k=i[e],x=k&&k.prototype,S={};if(g&&u(k)&&(E||x.forEach&&!s((function(){(new k).entries().next()})))){var w=(b=t((function(t,a){h(c(t,w),{type:e,collection:new k}),null!=a&&l(a,t[T],{that:t,AS_ENTRIES:v})}))).prototype,O=y(e);f(["add","clear","delete","forEach","get","has","set","keys","values","entries"],(function(e){var t="add"==e||"set"==e;!(e in x)||E&&"clear"==e||o(w,e,(function(a,n){var i=O(this).collection;if(!t&&E&&!d(a))return"get"==e&&void 0;var r=i[e](0===a?0:a,n);return t?this:r}))})),E||m(w,"size",{configurable:!0,get:function(){return O(this).collection.size}})}else b=a.getConstructor(t,e,v,T),r.enable();return p(b,e,!1,!0),S[e]=b,n({global:!0,forced:!0},S),E||a.setStrong(b,e,v),b}},function(e,t,a){var n=a(167),i=a(133),r=a(339),s=a(183),o=a(162),l=a(196).f,c=a(508),u=a(720),d=a(1073),p=a(399),m=a(1075),f=!1,g=p("meta"),b=0,h=function(e){l(e,g,{value:{objectID:"O"+b++,weakData:{}}})},y=e.exports={enable:function(){y.enable=function(){},f=!0;var e=c.f,t=i([].splice),a={};a[g]=1,e(a).length&&(c.f=function(a){for(var n=e(a),i=0,r=n.length;i<r;i++)if(n[i]===g){t(n,i,1);break}return n},n({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:u.f}))},fastKey:function(e,t){if(!s(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!o(e,g)){if(!d(e))return"F";if(!t)return"E";h(e)}return e[g].objectID},getWeakData:function(e,t){if(!o(e,g)){if(!d(e))return!0;if(!t)return!1;h(e)}return e[g].weakData},onFreeze:function(e){return m&&f&&d(e)&&!o(e,g)&&h(e),e}};r[g]=!0},function(e,t,a){var n=a(336),i=a(250),r=a(508).f,s=a(509),o="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];e.exports.f=function(e){return o&&"Window"==n(e)?function(e){try{return r(e)}catch(e){return s(o)}}(e):r(i(e))}},function(e,t,a){var n=a(102),i=a(337),r=a(205),s=a(229),o=a(501),l=a(722),c=a(304),u=a(206),d=a(510),p=a(404),m=a(723),f=n.TypeError,g=function(e,t){this.stopped=e,this.result=t},b=g.prototype;e.exports=function(e,t,a){var n,h,y,v,E,T,k,x=a&&a.that,S=!(!a||!a.AS_ENTRIES),w=!(!a||!a.IS_ITERATOR),O=!(!a||!a.INTERRUPTED),j=i(t,x),C=function(e){return n&&m(n,"normal",e),new g(!0,e)},I=function(e){return S?(s(e),O?j(e[0],e[1],C):j(e[0],e[1])):O?j(e,C):j(e)};if(w)n=e;else{if(!(h=p(e)))throw f(o(e)+" is not iterable");if(l(h)){for(y=0,v=c(e);v>y;y++)if((E=I(e[y]))&&u(b,E))return E;return new g(!1)}n=d(e,h)}for(T=n.next;!(k=r(T,n)).done;){try{E=I(k.value)}catch(e){m(n,"throw",e)}if("object"==typeof E&&E&&u(b,E))return E}return new g(!1)}},function(e,t,a){var n=a(140),i=a(277),r=n("iterator"),s=Array.prototype;e.exports=function(e){return void 0!==e&&(i.Array===e||s[r]===e)}},function(e,t,a){var n=a(205),i=a(229),r=a(499);e.exports=function(e,t,a){var s,o;i(e);try{if(!(s=r(e,"return"))){if("throw"===t)throw a;return a}s=n(s,e)}catch(e){o=!0,s=e}if("throw"===t)throw a;if(o)throw s;return i(s),a}},function(e,t,a){var n=a(102),i=a(206),r=n.TypeError;e.exports=function(e,t){if(i(t,e))return e;throw r("Incorrect invocation")}},function(e,t,a){var n=a(1076);e.exports=function(e,t){return new(n(e))(0===t?0:t)}},function(e,t,a){"use strict";var n=a(196).f,i=a(401),r=a(1077),s=a(337),o=a(724),l=a(721),c=a(504),u=a(1078),d=a(182),p=a(719).fastKey,m=a(338),f=m.set,g=m.getterFor;e.exports={getConstructor:function(e,t,a,c){var u=e((function(e,n){o(e,m),f(e,{type:t,index:i(null),first:void 0,last:void 0,size:0}),d||(e.size=0),null!=n&&l(n,e[c],{that:e,AS_ENTRIES:a})})),m=u.prototype,b=g(t),h=function(e,t,a){var n,i,r=b(e),s=y(e,t);return s?s.value=a:(r.last=s={index:i=p(t,!0),key:t,value:a,previous:n=r.last,next:void 0,removed:!1},r.first||(r.first=s),n&&(n.next=s),d?r.size++:e.size++,"F"!==i&&(r.index[i]=s)),e},y=function(e,t){var a,n=b(e),i=p(t);if("F"!==i)return n.index[i];for(a=n.first;a;a=a.next)if(a.key==t)return a};return r(m,{clear:function(){for(var e=b(this),t=e.index,a=e.first;a;)a.removed=!0,a.previous&&(a.previous=a.previous.next=void 0),delete t[a.index],a=a.next;e.first=e.last=void 0,d?e.size=0:this.size=0},delete:function(e){var t=this,a=b(t),n=y(t,e);if(n){var i=n.next,r=n.previous;delete a.index[n.index],n.removed=!0,r&&(r.next=i),i&&(i.previous=r),a.first==n&&(a.first=i),a.last==n&&(a.last=r),d?a.size--:t.size--}return!!n},forEach:function(e){for(var t,a=b(this),n=s(e,arguments.length>1?arguments[1]:void 0);t=t?t.next:a.first;)for(n(t.value,t.key,this);t&&t.removed;)t=t.previous},has:function(e){return!!y(this,e)}}),r(m,a?{get:function(e){var t=y(this,e);return t&&t.value},set:function(e,t){return h(this,0===e?0:e,t)}}:{add:function(e){return h(this,e=0===e?0:e,e)}}),d&&n(m,"size",{get:function(){return b(this).size}}),u},setStrong:function(e,t,a){var n=t+" Iterator",i=g(t),r=g(n);c(e,t,(function(e,t){f(this,{type:n,target:e,state:i(e),kind:t,last:void 0})}),(function(){for(var e=r(this),t=e.kind,a=e.last;a&&a.removed;)a=a.previous;return e.target&&(e.last=a=a?a.next:e.state.first)?"keys"==t?{value:a.key,done:!1}:"values"==t?{value:a.value,done:!1}:{value:[a.key,a.value],done:!1}:(e.target=void 0,{value:void 0,done:!0})}),a?"entries":"values",!a,!0),u(t)}}},function(e,t,a){e.exports=a(1082)},function(e,t,a){var n=a(1086);e.exports=n},function(e,t,a){var n=a(1093);a(231),e.exports=n},function(e,t,a){"use strict";var n=a(167),i=a(102),r=a(134),s=a(341),o=a(183),l=a(251),c=a(304),u=a(514),d=a(725),p=a(731),m=a(140),f=a(498),g=m("isConcatSpreadable"),b=9007199254740991,h="Maximum allowed index exceeded",y=i.TypeError,v=f>=51||!r((function(){var e=[];return e[g]=!1,e.concat()[0]!==e})),E=p("concat"),T=function(e){if(!o(e))return!1;var t=e[g];return void 0!==t?!!t:s(e)};n({target:"Array",proto:!0,forced:!v||!E},{concat:function(e){var t,a,n,i,r,s=l(this),o=d(s,0),p=0;for(t=-1,n=arguments.length;t<n;t++)if(T(r=-1===t?s:arguments[t])){if(p+(i=c(r))>b)throw y(h);for(a=0;a<i;a++,p++)a in r&&u(o,p,r[a])}else{if(p>=b)throw y(h);u(o,p++,r)}return o.length=p,o}})},function(e,t,a){var n=a(134),i=a(140),r=a(498),s=i("species");e.exports=function(e){return r>=51||!n((function(){var t=[];return(t.constructor={})[s]=function(){return{foo:1}},1!==t[e](Boolean).foo}))}},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t,a){var n=a(140);t.f=n},function(e,t,a){var n=a(1113);e.exports=n},function(e,t,a){var n=a(1119);e.exports=n},function(e,t,a){e.exports=a(1277)},function(e,t,a){e.exports=a(1282)},function(e,t,a){e.exports=a(1284)},function(e,t,a){e.exports=a(1288)},function(e,t,a){var n=a(741),i=a(1297),r=a(742);e.exports=function(e,t){var a;if(e){if("string"==typeof e)return r(e,t);var s=i(a=Object.prototype.toString.call(e)).call(a,8,-1);return"Object"===s&&e.constructor&&(s=e.constructor.name),"Map"===s||"Set"===s?n(e):"Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?r(e,t):void 0}}},function(e,t,a){e.exports=a(1296)},function(e,t){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}},function(e,t,a){e.exports=a(1313)},function(e,t,a){e.exports=a(1316)},function(e,t,a){var n=a(1319),i=a(1320),r=a(740),s=a(1321);e.exports=function(e){return n(e)||i(e)||r(e)||s()}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(83),i=a(9);t.default=function(e){void 0===e&&(e={});var t=i.useState(e),a=t[0],r=t[1],s=i.useMemo((function(){return{set:function(e,t){r((function(a){var i;return n.__assign(n.__assign({},a),((i={})[e]=t,i))}))},setAll:function(e){r(e)},remove:function(e){r((function(t){var a=t,i=e;a[i];return n.__rest(a,["symbol"==typeof i?i:i+""])}))},reset:function(){return r(e)}}}),[r]),o=n.__assign({get:i.useCallback((function(e){return a[e]}),[a])},s);return[a,o]}},function(e,t,a){e.exports=function e(t,a,n){function i(s,o){if(!a[s]){if(!t[s]){if(r)return r(s,!0);throw new Error("Cannot find module '"+s+"'")}var l=a[s]={exports:{}};t[s][0].call(l.exports,(function(e){var a=t[s][1][e];return i(a||e)}),l,l.exports,e,t,a,n)}return a[s].exports}for(var r=!1,s=0;s<n.length;s++)i(n[s]);return i}({1:[function(e,t,a){(function(n,i,r,s,o,l,c,u,d){"use strict";function p(e,t){return g(e,t=m(e,t))}function m(e,t){if((t=t||{}).algorithm=t.algorithm||"sha1",t.encoding=t.encoding||"hex",t.excludeValues=!!t.excludeValues,t.algorithm=t.algorithm.toLowerCase(),t.encoding=t.encoding.toLowerCase(),t.ignoreUnknown=!0===t.ignoreUnknown,t.respectType=!1!==t.respectType,t.respectFunctionNames=!1!==t.respectFunctionNames,t.respectFunctionProperties=!1!==t.respectFunctionProperties,t.unorderedArrays=!0===t.unorderedArrays,t.unorderedSets=!1!==t.unorderedSets,t.unorderedObjects=!1!==t.unorderedObjects,t.replacer=t.replacer||void 0,t.excludeKeys=t.excludeKeys||void 0,void 0===e)throw new Error("Object argument required.");for(var a=0;a<v.length;++a)v[a].toLowerCase()===t.algorithm.toLowerCase()&&(t.algorithm=v[a]);if(-1===v.indexOf(t.algorithm))throw new Error('Algorithm "'+t.algorithm+'"  not supported. supported values: '+v.join(", "));if(-1===E.indexOf(t.encoding)&&"passthrough"!==t.algorithm)throw new Error('Encoding "'+t.encoding+'"  not supported. supported values: '+E.join(", "));return t}function f(e){return"function"==typeof e&&null!=/^function\s+\w*\s*\(\s*\)\s*{\s+\[native code\]\s+}$/i.exec(Function.prototype.toString.call(e))}function g(e,t){var a;if(void 0===(a="passthrough"!==t.algorithm?y.createHash(t.algorithm):new h).write&&(a.write=a.update,a.end=a.update),b(t,a).dispatch(e),a.update||a.end(""),a.digest)return a.digest("buffer"===t.encoding?void 0:t.encoding);var n=a.read();return"buffer"===t.encoding?n:n.toString(t.encoding)}function b(e,t,a){a=a||[];var n=function(e){return t.update?t.update(e,"utf8"):t.write(e,"utf8")};return{dispatch:function(t){e.replacer&&(t=e.replacer(t));var a=typeof t;return null===t&&(a="null"),this["_"+a](t)},_object:function(t){var i=/\[object (.*)\]/i,s=Object.prototype.toString.call(t),o=i.exec(s);o=(o=o?o[1]:"unknown:["+s+"]").toLowerCase();var l=null;if((l=a.indexOf(t))>=0)return this.dispatch("[CIRCULAR:"+l+"]");if(a.push(t),void 0!==r&&r.isBuffer&&r.isBuffer(t))return n("buffer:"),n(t);if("object"===o||"function"===o){var c=Object.keys(t);e.unorderedObjects&&(c=c.sort()),!1===e.respectType||f(t)||c.splice(0,0,"prototype","__proto__","constructor"),e.excludeKeys&&(c=c.filter((function(t){return!e.excludeKeys(t)}))),n("object:"+c.length+":");var u=this;return c.forEach((function(a){u.dispatch(a),n(":"),e.excludeValues||u.dispatch(t[a]),n(",")}))}if(!this["_"+o]){if(e.ignoreUnknown)return n("["+o+"]");throw new Error('Unknown object type "'+o+'"')}this["_"+o](t)},_array:function(t,i){i=void 0!==i?i:!1!==e.unorderedArrays;var r=this;if(n("array:"+t.length+":"),!i||t.length<=1)return t.forEach((function(e){return r.dispatch(e)}));var s=[],o=t.map((function(t){var n=new h,i=a.slice();return b(e,n,i).dispatch(t),s=s.concat(i.slice(a.length)),n.read().toString()}));return a=a.concat(s),o.sort(),this._array(o,!1)},_date:function(e){return n("date:"+e.toJSON())},_symbol:function(e){return n("symbol:"+e.toString())},_error:function(e){return n("error:"+e.toString())},_boolean:function(e){return n("bool:"+e.toString())},_string:function(e){n("string:"+e.length+":"),n(e.toString())},_function:function(t){n("fn:"),f(t)?this.dispatch("[native]"):this.dispatch(t.toString()),!1!==e.respectFunctionNames&&this.dispatch("function-name:"+String(t.name)),e.respectFunctionProperties&&this._object(t)},_number:function(e){return n("number:"+e.toString())},_xml:function(e){return n("xml:"+e.toString())},_null:function(){return n("Null")},_undefined:function(){return n("Undefined")},_regexp:function(e){return n("regex:"+e.toString())},_uint8array:function(e){return n("uint8array:"),this.dispatch(Array.prototype.slice.call(e))},_uint8clampedarray:function(e){return n("uint8clampedarray:"),this.dispatch(Array.prototype.slice.call(e))},_int8array:function(e){return n("uint8array:"),this.dispatch(Array.prototype.slice.call(e))},_uint16array:function(e){return n("uint16array:"),this.dispatch(Array.prototype.slice.call(e))},_int16array:function(e){return n("uint16array:"),this.dispatch(Array.prototype.slice.call(e))},_uint32array:function(e){return n("uint32array:"),this.dispatch(Array.prototype.slice.call(e))},_int32array:function(e){return n("uint32array:"),this.dispatch(Array.prototype.slice.call(e))},_float32array:function(e){return n("float32array:"),this.dispatch(Array.prototype.slice.call(e))},_float64array:function(e){return n("float64array:"),this.dispatch(Array.prototype.slice.call(e))},_arraybuffer:function(e){return n("arraybuffer:"),this.dispatch(new Uint8Array(e))},_url:function(e){return n("url:"+e.toString(),"utf8")},_map:function(t){n("map:");var a=Array.from(t);return this._array(a,!1!==e.unorderedSets)},_set:function(t){n("set:");var a=Array.from(t);return this._array(a,!1!==e.unorderedSets)},_blob:function(){if(e.ignoreUnknown)return n("[blob]");throw Error('Hashing Blob objects is currently not supported\n(see https://github.com/puleos/object-hash/issues/26)\nUse "options.replacer" or "options.ignoreUnknown"\n')},_domwindow:function(){return n("domwindow")},_process:function(){return n("process")},_timer:function(){return n("timer")},_pipe:function(){return n("pipe")},_tcp:function(){return n("tcp")},_udp:function(){return n("udp")},_tty:function(){return n("tty")},_statwatcher:function(){return n("statwatcher")},_securecontext:function(){return n("securecontext")},_connection:function(){return n("connection")},_zlib:function(){return n("zlib")},_context:function(){return n("context")},_nodescript:function(){return n("nodescript")},_httpparser:function(){return n("httpparser")},_dataview:function(){return n("dataview")},_signal:function(){return n("signal")},_fsevent:function(){return n("fsevent")},_tlswrap:function(){return n("tlswrap")}}}function h(){return{buf:"",write:function(e){this.buf+=e},end:function(e){this.buf+=e},read:function(){return this.buf}}}var y=e("crypto");(a=t.exports=p).sha1=function(e){return p(e)},a.keys=function(e){return p(e,{excludeValues:!0,algorithm:"sha1",encoding:"hex"})},a.MD5=function(e){return p(e,{algorithm:"md5",encoding:"hex"})},a.keysMD5=function(e){return p(e,{algorithm:"md5",encoding:"hex",excludeValues:!0})};var v=y.getHashes?y.getHashes().slice():["sha1","md5"];v.push("passthrough");var E=["buffer","hex","binary","base64"];a.writeToStream=function(e,t,a){return void 0===a&&(a=t,t={}),b(t=m(e,t),a).dispatch(e)}}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/fake_e8180ef5.js","/")},{buffer:3,crypto:5,lYpoI2:10}],2:[function(e,t,a){(function(e,t,n,i,r,s,o,l,c){var u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";!function(e){"use strict";function t(e){var t=e.charCodeAt(0);return t===r||t===d?62:t===s||t===p?63:t<o?-1:t<o+10?t-o+26+26:t<c+26?t-c:t<l+26?t-l+26:void 0}function a(e){function a(e){c[d++]=e}var n,r,s,o,l,c;if(e.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var u=e.length;l="="===e.charAt(u-2)?2:"="===e.charAt(u-1)?1:0,c=new i(3*e.length/4-l),s=l>0?e.length-4:e.length;var d=0;for(n=0,r=0;n<s;n+=4,r+=3)a((16711680&(o=t(e.charAt(n))<<18|t(e.charAt(n+1))<<12|t(e.charAt(n+2))<<6|t(e.charAt(n+3))))>>16),a((65280&o)>>8),a(255&o);return 2===l?a(255&(o=t(e.charAt(n))<<2|t(e.charAt(n+1))>>4)):1===l&&(a((o=t(e.charAt(n))<<10|t(e.charAt(n+1))<<4|t(e.charAt(n+2))>>2)>>8&255),a(255&o)),c}function n(e){function t(e){return u.charAt(e)}function a(e){return t(e>>18&63)+t(e>>12&63)+t(e>>6&63)+t(63&e)}var n,i,r,s=e.length%3,o="";for(n=0,r=e.length-s;n<r;n+=3)o+=a(i=(e[n]<<16)+(e[n+1]<<8)+e[n+2]);switch(s){case 1:o+=t((i=e[e.length-1])>>2),o+=t(i<<4&63),o+="==";break;case 2:o+=t((i=(e[e.length-2]<<8)+e[e.length-1])>>10),o+=t(i>>4&63),o+=t(i<<2&63),o+="="}return o}var i="undefined"!=typeof Uint8Array?Uint8Array:Array,r="+".charCodeAt(0),s="/".charCodeAt(0),o="0".charCodeAt(0),l="a".charCodeAt(0),c="A".charCodeAt(0),d="-".charCodeAt(0),p="_".charCodeAt(0);e.toByteArray=a,e.fromByteArray=n}(void 0===a?this.base64js={}:a)}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/base64-js/lib/b64.js","/node_modules/gulp-browserify/node_modules/base64-js/lib")},{buffer:3,lYpoI2:10}],3:[function(e,t,a){(function(t,n,i,r,s,o,l,c,u){function i(e,t,a){if(!(this instanceof i))return new i(e,t,a);var n,r,s,o=typeof e;if("base64"===t&&"string"===o)for(e=R(e);e.length%4!=0;)e+="=";if("number"===o)n=_(e);else if("string"===o)n=i.byteLength(e,t);else{if("object"!==o)throw new Error("First argument needs to be a number, array or string.");n=_(e.length)}if(i._useTypedArrays?r=i._augment(new Uint8Array(n)):((r=this).length=n,r._isBuffer=!0),i._useTypedArrays&&"number"==typeof e.byteLength)r._set(e);else if(L(e))for(s=0;s<n;s++)i.isBuffer(e)?r[s]=e.readUInt8(s):r[s]=e[s];else if("string"===o)r.write(e,0,t);else if("number"===o&&!i._useTypedArrays&&!a)for(s=0;s<n;s++)r[s]=0;return r}function d(e,t,a,n){a=Number(a)||0;var r=e.length-a;n?(n=Number(n))>r&&(n=r):n=r;var s=t.length;Y(s%2==0,"Invalid hex string"),n>s/2&&(n=s/2);for(var o=0;o<n;o++){var l=parseInt(t.substr(2*o,2),16);Y(!isNaN(l),"Invalid hex string"),e[a+o]=l}return i._charsWritten=2*o,o}function p(e,t,a,n){return i._charsWritten=Q(z(t),e,a,n)}function m(e,t,a,n){return i._charsWritten=Q(H(t),e,a,n)}function f(e,t,a,n){return m(e,t,a,n)}function g(e,t,a,n){return i._charsWritten=Q($(t),e,a,n)}function b(e,t,a,n){return i._charsWritten=Q(U(t),e,a,n)}function h(e,t,a){return 0===t&&a===e.length?J.fromByteArray(e):J.fromByteArray(e.slice(t,a))}function y(e,t,a){var n="",i="";a=Math.min(e.length,a);for(var r=t;r<a;r++)e[r]<=127?(n+=V(i)+String.fromCharCode(e[r]),i=""):i+="%"+e[r].toString(16);return n+V(i)}function v(e,t,a){var n="";a=Math.min(e.length,a);for(var i=t;i<a;i++)n+=String.fromCharCode(e[i]);return n}function E(e,t,a){return v(e,t,a)}function T(e,t,a){var n=e.length;(!t||t<0)&&(t=0),(!a||a<0||a>n)&&(a=n);for(var i="",r=t;r<a;r++)i+=B(e[r]);return i}function k(e,t,a){for(var n=e.slice(t,a),i="",r=0;r<n.length;r+=2)i+=String.fromCharCode(n[r]+256*n[r+1]);return i}function x(e,t,a,n){n||(Y("boolean"==typeof a,"missing or invalid endian"),Y(null!=t,"missing offset"),Y(t+1<e.length,"Trying to read beyond buffer length"));var i,r=e.length;if(!(t>=r))return a?(i=e[t],t+1<r&&(i|=e[t+1]<<8)):(i=e[t]<<8,t+1<r&&(i|=e[t+1])),i}function S(e,t,a,n){n||(Y("boolean"==typeof a,"missing or invalid endian"),Y(null!=t,"missing offset"),Y(t+3<e.length,"Trying to read beyond buffer length"));var i,r=e.length;if(!(t>=r))return a?(t+2<r&&(i=e[t+2]<<16),t+1<r&&(i|=e[t+1]<<8),i|=e[t],t+3<r&&(i+=e[t+3]<<24>>>0)):(t+1<r&&(i=e[t+1]<<16),t+2<r&&(i|=e[t+2]<<8),t+3<r&&(i|=e[t+3]),i+=e[t]<<24>>>0),i}function w(e,t,a,n){if(n||(Y("boolean"==typeof a,"missing or invalid endian"),Y(null!=t,"missing offset"),Y(t+1<e.length,"Trying to read beyond buffer length")),!(t>=e.length)){var i=x(e,t,a,!0);return 32768&i?-1*(65535-i+1):i}}function O(e,t,a,n){if(n||(Y("boolean"==typeof a,"missing or invalid endian"),Y(null!=t,"missing offset"),Y(t+3<e.length,"Trying to read beyond buffer length")),!(t>=e.length)){var i=S(e,t,a,!0);return 2147483648&i?-1*(4294967295-i+1):i}}function j(e,t,a,n){return n||(Y("boolean"==typeof a,"missing or invalid endian"),Y(t+3<e.length,"Trying to read beyond buffer length")),X.read(e,t,a,23,4)}function C(e,t,a,n){return n||(Y("boolean"==typeof a,"missing or invalid endian"),Y(t+7<e.length,"Trying to read beyond buffer length")),X.read(e,t,a,52,8)}function I(e,t,a,n,i){i||(Y(null!=t,"missing value"),Y("boolean"==typeof n,"missing or invalid endian"),Y(null!=a,"missing offset"),Y(a+1<e.length,"trying to write beyond buffer length"),W(t,65535));var r=e.length;if(!(a>=r))for(var s=0,o=Math.min(r-a,2);s<o;s++)e[a+s]=(t&255<<8*(n?s:1-s))>>>8*(n?s:1-s)}function M(e,t,a,n,i){i||(Y(null!=t,"missing value"),Y("boolean"==typeof n,"missing or invalid endian"),Y(null!=a,"missing offset"),Y(a+3<e.length,"trying to write beyond buffer length"),W(t,4294967295));var r=e.length;if(!(a>=r))for(var s=0,o=Math.min(r-a,4);s<o;s++)e[a+s]=t>>>8*(n?s:3-s)&255}function A(e,t,a,n,i){i||(Y(null!=t,"missing value"),Y("boolean"==typeof n,"missing or invalid endian"),Y(null!=a,"missing offset"),Y(a+1<e.length,"Trying to write beyond buffer length"),G(t,32767,-32768)),a>=e.length||I(e,t>=0?t:65535+t+1,a,n,i)}function q(e,t,a,n,i){i||(Y(null!=t,"missing value"),Y("boolean"==typeof n,"missing or invalid endian"),Y(null!=a,"missing offset"),Y(a+3<e.length,"Trying to write beyond buffer length"),G(t,2147483647,-2147483648)),a>=e.length||M(e,t>=0?t:4294967295+t+1,a,n,i)}function D(e,t,a,n,i){i||(Y(null!=t,"missing value"),Y("boolean"==typeof n,"missing or invalid endian"),Y(null!=a,"missing offset"),Y(a+3<e.length,"Trying to write beyond buffer length"),K(t,34028234663852886e22,-34028234663852886e22)),a>=e.length||X.write(e,t,a,n,23,4)}function P(e,t,a,n,i){i||(Y(null!=t,"missing value"),Y("boolean"==typeof n,"missing or invalid endian"),Y(null!=a,"missing offset"),Y(a+7<e.length,"Trying to write beyond buffer length"),K(t,17976931348623157e292,-17976931348623157e292)),a>=e.length||X.write(e,t,a,n,52,8)}function R(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function F(e,t,a){return"number"!=typeof e?a:(e=~~e)>=t?t:e>=0||(e+=t)>=0?e:0}function _(e){return(e=~~Math.ceil(+e))<0?0:e}function N(e){return(Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)})(e)}function L(e){return N(e)||i.isBuffer(e)||e&&"object"==typeof e&&"number"==typeof e.length}function B(e){return e<16?"0"+e.toString(16):e.toString(16)}function z(e){for(var t=[],a=0;a<e.length;a++){var n=e.charCodeAt(a);if(n<=127)t.push(e.charCodeAt(a));else{var i=a;n>=55296&&n<=57343&&a++;for(var r=encodeURIComponent(e.slice(i,a+1)).substr(1).split("%"),s=0;s<r.length;s++)t.push(parseInt(r[s],16))}}return t}function H(e){for(var t=[],a=0;a<e.length;a++)t.push(255&e.charCodeAt(a));return t}function U(e){for(var t,a,n,i=[],r=0;r<e.length;r++)a=(t=e.charCodeAt(r))>>8,n=t%256,i.push(n),i.push(a);return i}function $(e){return J.toByteArray(e)}function Q(e,t,a,n){for(var i=0;i<n&&!(i+a>=t.length||i>=e.length);i++)t[i+a]=e[i];return i}function V(e){try{return decodeURIComponent(e)}catch(e){return String.fromCharCode(65533)}}function W(e,t){Y("number"==typeof e,"cannot write a non-number as a number"),Y(e>=0,"specified a negative value for writing an unsigned value"),Y(e<=t,"value is larger than maximum value for type"),Y(Math.floor(e)===e,"value has a fractional component")}function G(e,t,a){Y("number"==typeof e,"cannot write a non-number as a number"),Y(e<=t,"value larger than maximum allowed value"),Y(e>=a,"value smaller than minimum allowed value"),Y(Math.floor(e)===e,"value has a fractional component")}function K(e,t,a){Y("number"==typeof e,"cannot write a non-number as a number"),Y(e<=t,"value larger than maximum allowed value"),Y(e>=a,"value smaller than minimum allowed value")}function Y(e,t){if(!e)throw new Error(t||"Failed assertion")}var J=e("base64-js"),X=e("ieee754");a.Buffer=i,a.SlowBuffer=i,a.INSPECT_MAX_BYTES=50,i.poolSize=8192,i._useTypedArrays=function(){try{var e=new ArrayBuffer(0),t=new Uint8Array(e);return t.foo=function(){return 42},42===t.foo()&&"function"==typeof t.subarray}catch(e){return!1}}(),i.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},i.isBuffer=function(e){return!(null==e||!e._isBuffer)},i.byteLength=function(e,t){var a;switch(e+="",t||"utf8"){case"hex":a=e.length/2;break;case"utf8":case"utf-8":a=z(e).length;break;case"ascii":case"binary":case"raw":a=e.length;break;case"base64":a=$(e).length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":a=2*e.length;break;default:throw new Error("Unknown encoding")}return a},i.concat=function(e,t){if(Y(N(e),"Usage: Buffer.concat(list, [totalLength])\nlist should be an Array."),0===e.length)return new i(0);if(1===e.length)return e[0];var a;if("number"!=typeof t)for(t=0,a=0;a<e.length;a++)t+=e[a].length;var n=new i(t),r=0;for(a=0;a<e.length;a++){var s=e[a];s.copy(n,r),r+=s.length}return n},i.prototype.write=function(e,t,a,n){if(isFinite(t))isFinite(a)||(n=a,a=void 0);else{var i=n;n=t,t=a,a=i}t=Number(t)||0;var r,s=this.length-t;switch(a?(a=Number(a))>s&&(a=s):a=s,n=String(n||"utf8").toLowerCase()){case"hex":r=d(this,e,t,a);break;case"utf8":case"utf-8":r=p(this,e,t,a);break;case"ascii":r=m(this,e,t,a);break;case"binary":r=f(this,e,t,a);break;case"base64":r=g(this,e,t,a);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":r=b(this,e,t,a);break;default:throw new Error("Unknown encoding")}return r},i.prototype.toString=function(e,t,a){var n,i=this;if(e=String(e||"utf8").toLowerCase(),t=Number(t)||0,(a=void 0!==a?Number(a):a=i.length)===t)return"";switch(e){case"hex":n=T(i,t,a);break;case"utf8":case"utf-8":n=y(i,t,a);break;case"ascii":n=v(i,t,a);break;case"binary":n=E(i,t,a);break;case"base64":n=h(i,t,a);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":n=k(i,t,a);break;default:throw new Error("Unknown encoding")}return n},i.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},i.prototype.copy=function(e,t,a,n){var r=this;if(a||(a=0),n||0===n||(n=this.length),t||(t=0),n!==a&&0!==e.length&&0!==r.length){Y(n>=a,"sourceEnd < sourceStart"),Y(t>=0&&t<e.length,"targetStart out of bounds"),Y(a>=0&&a<r.length,"sourceStart out of bounds"),Y(n>=0&&n<=r.length,"sourceEnd out of bounds"),n>this.length&&(n=this.length),e.length-t<n-a&&(n=e.length-t+a);var s=n-a;if(s<100||!i._useTypedArrays)for(var o=0;o<s;o++)e[o+t]=this[o+a];else e._set(this.subarray(a,a+s),t)}},i.prototype.slice=function(e,t){var a=this.length;if(e=F(e,a,0),t=F(t,a,a),i._useTypedArrays)return i._augment(this.subarray(e,t));for(var n=t-e,r=new i(n,void 0,!0),s=0;s<n;s++)r[s]=this[s+e];return r},i.prototype.get=function(e){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(e)},i.prototype.set=function(e,t){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(e,t)},i.prototype.readUInt8=function(e,t){if(t||(Y(null!=e,"missing offset"),Y(e<this.length,"Trying to read beyond buffer length")),!(e>=this.length))return this[e]},i.prototype.readUInt16LE=function(e,t){return x(this,e,!0,t)},i.prototype.readUInt16BE=function(e,t){return x(this,e,!1,t)},i.prototype.readUInt32LE=function(e,t){return S(this,e,!0,t)},i.prototype.readUInt32BE=function(e,t){return S(this,e,!1,t)},i.prototype.readInt8=function(e,t){if(t||(Y(null!=e,"missing offset"),Y(e<this.length,"Trying to read beyond buffer length")),!(e>=this.length))return 128&this[e]?-1*(255-this[e]+1):this[e]},i.prototype.readInt16LE=function(e,t){return w(this,e,!0,t)},i.prototype.readInt16BE=function(e,t){return w(this,e,!1,t)},i.prototype.readInt32LE=function(e,t){return O(this,e,!0,t)},i.prototype.readInt32BE=function(e,t){return O(this,e,!1,t)},i.prototype.readFloatLE=function(e,t){return j(this,e,!0,t)},i.prototype.readFloatBE=function(e,t){return j(this,e,!1,t)},i.prototype.readDoubleLE=function(e,t){return C(this,e,!0,t)},i.prototype.readDoubleBE=function(e,t){return C(this,e,!1,t)},i.prototype.writeUInt8=function(e,t,a){a||(Y(null!=e,"missing value"),Y(null!=t,"missing offset"),Y(t<this.length,"trying to write beyond buffer length"),W(e,255)),t>=this.length||(this[t]=e)},i.prototype.writeUInt16LE=function(e,t,a){I(this,e,t,!0,a)},i.prototype.writeUInt16BE=function(e,t,a){I(this,e,t,!1,a)},i.prototype.writeUInt32LE=function(e,t,a){M(this,e,t,!0,a)},i.prototype.writeUInt32BE=function(e,t,a){M(this,e,t,!1,a)},i.prototype.writeInt8=function(e,t,a){a||(Y(null!=e,"missing value"),Y(null!=t,"missing offset"),Y(t<this.length,"Trying to write beyond buffer length"),G(e,127,-128)),t>=this.length||(e>=0?this.writeUInt8(e,t,a):this.writeUInt8(255+e+1,t,a))},i.prototype.writeInt16LE=function(e,t,a){A(this,e,t,!0,a)},i.prototype.writeInt16BE=function(e,t,a){A(this,e,t,!1,a)},i.prototype.writeInt32LE=function(e,t,a){q(this,e,t,!0,a)},i.prototype.writeInt32BE=function(e,t,a){q(this,e,t,!1,a)},i.prototype.writeFloatLE=function(e,t,a){D(this,e,t,!0,a)},i.prototype.writeFloatBE=function(e,t,a){D(this,e,t,!1,a)},i.prototype.writeDoubleLE=function(e,t,a){P(this,e,t,!0,a)},i.prototype.writeDoubleBE=function(e,t,a){P(this,e,t,!1,a)},i.prototype.fill=function(e,t,a){if(e||(e=0),t||(t=0),a||(a=this.length),"string"==typeof e&&(e=e.charCodeAt(0)),Y("number"==typeof e&&!isNaN(e),"value is not a number"),Y(a>=t,"end < start"),a!==t&&0!==this.length){Y(t>=0&&t<this.length,"start out of bounds"),Y(a>=0&&a<=this.length,"end out of bounds");for(var n=t;n<a;n++)this[n]=e}},i.prototype.inspect=function(){for(var e=[],t=this.length,n=0;n<t;n++)if(e[n]=B(this[n]),n===a.INSPECT_MAX_BYTES){e[n+1]="...";break}return"<Buffer "+e.join(" ")+">"},i.prototype.toArrayBuffer=function(){if("undefined"!=typeof Uint8Array){if(i._useTypedArrays)return new i(this).buffer;for(var e=new Uint8Array(this.length),t=0,a=e.length;t<a;t+=1)e[t]=this[t];return e.buffer}throw new Error("Buffer.toArrayBuffer not supported in this browser")};var Z=i.prototype;i._augment=function(e){return e._isBuffer=!0,e._get=e.get,e._set=e.set,e.get=Z.get,e.set=Z.set,e.write=Z.write,e.toString=Z.toString,e.toLocaleString=Z.toString,e.toJSON=Z.toJSON,e.copy=Z.copy,e.slice=Z.slice,e.readUInt8=Z.readUInt8,e.readUInt16LE=Z.readUInt16LE,e.readUInt16BE=Z.readUInt16BE,e.readUInt32LE=Z.readUInt32LE,e.readUInt32BE=Z.readUInt32BE,e.readInt8=Z.readInt8,e.readInt16LE=Z.readInt16LE,e.readInt16BE=Z.readInt16BE,e.readInt32LE=Z.readInt32LE,e.readInt32BE=Z.readInt32BE,e.readFloatLE=Z.readFloatLE,e.readFloatBE=Z.readFloatBE,e.readDoubleLE=Z.readDoubleLE,e.readDoubleBE=Z.readDoubleBE,e.writeUInt8=Z.writeUInt8,e.writeUInt16LE=Z.writeUInt16LE,e.writeUInt16BE=Z.writeUInt16BE,e.writeUInt32LE=Z.writeUInt32LE,e.writeUInt32BE=Z.writeUInt32BE,e.writeInt8=Z.writeInt8,e.writeInt16LE=Z.writeInt16LE,e.writeInt16BE=Z.writeInt16BE,e.writeInt32LE=Z.writeInt32LE,e.writeInt32BE=Z.writeInt32BE,e.writeFloatLE=Z.writeFloatLE,e.writeFloatBE=Z.writeFloatBE,e.writeDoubleLE=Z.writeDoubleLE,e.writeDoubleBE=Z.writeDoubleBE,e.fill=Z.fill,e.inspect=Z.inspect,e.toArrayBuffer=Z.toArrayBuffer,e}}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/buffer/index.js","/node_modules/gulp-browserify/node_modules/buffer")},{"base64-js":2,buffer:3,ieee754:11,lYpoI2:10}],4:[function(e,t,a){(function(a,n,i,r,s,o,l,c,u){function d(e,t){if(e.length%f!=0){var a=e.length+(f-e.length%f);e=i.concat([e,g],a)}for(var n=[],r=t?e.readInt32BE:e.readInt32LE,s=0;s<e.length;s+=f)n.push(r.call(e,s));return n}function p(e,t,a){for(var n=new i(t),r=a?n.writeInt32BE:n.writeInt32LE,s=0;s<e.length;s++)r.call(n,e[s],4*s,!0);return n}function m(e,t,a,n){return i.isBuffer(e)||(e=new i(e)),p(t(d(e,n),e.length*b),a,n)}i=e("buffer").Buffer;var f=4,g=new i(f);g.fill(0);var b=8;t.exports={hash:m}}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/helpers.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:10}],5:[function(e,t,a){(function(t,n,i,r,s,o,l,c,u){function d(e,t,a){i.isBuffer(t)||(t=new i(t)),i.isBuffer(a)||(a=new i(a)),t.length>v?t=e(t):t.length<v&&(t=i.concat([t,E],v));for(var n=new i(v),r=new i(v),s=0;s<v;s++)n[s]=54^t[s],r[s]=92^t[s];var o=e(i.concat([n,a]));return e(i.concat([r,o]))}function p(e,t){var a=y[e=e||"sha1"],n=[];return a||m("algorithm:",e,"is not yet supported"),{update:function(e){return i.isBuffer(e)||(e=new i(e)),n.push(e),e.length,this},digest:function(e){var r=i.concat(n),s=t?d(a,t,r):a(r);return n=null,e?s.toString(e):s}}}function m(){var e=[].slice.call(arguments).join(" ");throw new Error([e,"we accept pull requests","http://github.com/dominictarr/crypto-browserify"].join("\n"))}function f(e,t){for(var a in e)t(e[a],a)}i=e("buffer").Buffer;var g=e("./sha"),b=e("./sha256"),h=e("./rng"),y={sha1:g,sha256:b,md5:e("./md5")},v=64,E=new i(v);E.fill(0),a.createHash=function(e){return p(e)},a.createHmac=function(e,t){return p(e,t)},a.randomBytes=function(e,t){if(!t||!t.call)return new i(h(e));try{t.call(this,void 0,new i(h(e)))}catch(e){t(e)}},f(["createCredentials","createCipher","createCipheriv","createDecipher","createDecipheriv","createSign","createVerify","createDiffieHellman","pbkdf2"],(function(e){a[e]=function(){m("sorry,",e,"is not implemented yet")}}))}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/index.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./md5":6,"./rng":7,"./sha":8,"./sha256":9,buffer:3,lYpoI2:10}],6:[function(e,t,a){(function(a,n,i,r,s,o,l,c,u){function d(e,t){e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;for(var a=1732584193,n=-271733879,i=-1732584194,r=271733878,s=0;s<e.length;s+=16){var o=a,l=n,c=i,u=r;a=m(a,n,i,r,e[s+0],7,-680876936),r=m(r,a,n,i,e[s+1],12,-389564586),i=m(i,r,a,n,e[s+2],17,606105819),n=m(n,i,r,a,e[s+3],22,-1044525330),a=m(a,n,i,r,e[s+4],7,-176418897),r=m(r,a,n,i,e[s+5],12,1200080426),i=m(i,r,a,n,e[s+6],17,-1473231341),n=m(n,i,r,a,e[s+7],22,-45705983),a=m(a,n,i,r,e[s+8],7,1770035416),r=m(r,a,n,i,e[s+9],12,-1958414417),i=m(i,r,a,n,e[s+10],17,-42063),n=m(n,i,r,a,e[s+11],22,-1990404162),a=m(a,n,i,r,e[s+12],7,1804603682),r=m(r,a,n,i,e[s+13],12,-40341101),i=m(i,r,a,n,e[s+14],17,-1502002290),a=f(a,n=m(n,i,r,a,e[s+15],22,1236535329),i,r,e[s+1],5,-165796510),r=f(r,a,n,i,e[s+6],9,-1069501632),i=f(i,r,a,n,e[s+11],14,643717713),n=f(n,i,r,a,e[s+0],20,-373897302),a=f(a,n,i,r,e[s+5],5,-701558691),r=f(r,a,n,i,e[s+10],9,38016083),i=f(i,r,a,n,e[s+15],14,-660478335),n=f(n,i,r,a,e[s+4],20,-405537848),a=f(a,n,i,r,e[s+9],5,568446438),r=f(r,a,n,i,e[s+14],9,-1019803690),i=f(i,r,a,n,e[s+3],14,-187363961),n=f(n,i,r,a,e[s+8],20,1163531501),a=f(a,n,i,r,e[s+13],5,-1444681467),r=f(r,a,n,i,e[s+2],9,-51403784),i=f(i,r,a,n,e[s+7],14,1735328473),a=g(a,n=f(n,i,r,a,e[s+12],20,-1926607734),i,r,e[s+5],4,-378558),r=g(r,a,n,i,e[s+8],11,-2022574463),i=g(i,r,a,n,e[s+11],16,1839030562),n=g(n,i,r,a,e[s+14],23,-35309556),a=g(a,n,i,r,e[s+1],4,-1530992060),r=g(r,a,n,i,e[s+4],11,1272893353),i=g(i,r,a,n,e[s+7],16,-155497632),n=g(n,i,r,a,e[s+10],23,-1094730640),a=g(a,n,i,r,e[s+13],4,681279174),r=g(r,a,n,i,e[s+0],11,-358537222),i=g(i,r,a,n,e[s+3],16,-722521979),n=g(n,i,r,a,e[s+6],23,76029189),a=g(a,n,i,r,e[s+9],4,-640364487),r=g(r,a,n,i,e[s+12],11,-421815835),i=g(i,r,a,n,e[s+15],16,530742520),a=b(a,n=g(n,i,r,a,e[s+2],23,-995338651),i,r,e[s+0],6,-198630844),r=b(r,a,n,i,e[s+7],10,1126891415),i=b(i,r,a,n,e[s+14],15,-1416354905),n=b(n,i,r,a,e[s+5],21,-57434055),a=b(a,n,i,r,e[s+12],6,1700485571),r=b(r,a,n,i,e[s+3],10,-1894986606),i=b(i,r,a,n,e[s+10],15,-1051523),n=b(n,i,r,a,e[s+1],21,-2054922799),a=b(a,n,i,r,e[s+8],6,1873313359),r=b(r,a,n,i,e[s+15],10,-30611744),i=b(i,r,a,n,e[s+6],15,-1560198380),n=b(n,i,r,a,e[s+13],21,1309151649),a=b(a,n,i,r,e[s+4],6,-145523070),r=b(r,a,n,i,e[s+11],10,-1120210379),i=b(i,r,a,n,e[s+2],15,718787259),n=b(n,i,r,a,e[s+9],21,-343485551),a=h(a,o),n=h(n,l),i=h(i,c),r=h(r,u)}return Array(a,n,i,r)}function p(e,t,a,n,i,r){return h(y(h(h(t,e),h(n,r)),i),a)}function m(e,t,a,n,i,r,s){return p(t&a|~t&n,e,t,i,r,s)}function f(e,t,a,n,i,r,s){return p(t&n|a&~n,e,t,i,r,s)}function g(e,t,a,n,i,r,s){return p(t^a^n,e,t,i,r,s)}function b(e,t,a,n,i,r,s){return p(a^(t|~n),e,t,i,r,s)}function h(e,t){var a=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(a>>16)<<16|65535&a}function y(e,t){return e<<t|e>>>32-t}var v=e("./helpers");t.exports=function(e){return v.hash(e,d,16)}}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/md5.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:10}],7:[function(e,t,a){(function(e,a,n,i,r,s,o,l,c){!function(){var e,a;e=function(e){for(var t,a=new Array(e),n=0;n<e;n++)0==(3&n)&&(t=4294967296*Math.random()),a[n]=t>>>((3&n)<<3)&255;return a},this.crypto&&crypto.getRandomValues&&(a=function(e){var t=new Uint8Array(e);return crypto.getRandomValues(t),t}),t.exports=a||e}()}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/rng.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:10}],8:[function(e,t,a){(function(a,n,i,r,s,o,l,c,u){function d(e,t){e[t>>5]|=128<<24-t%32,e[15+(t+64>>9<<4)]=t;for(var a=Array(80),n=1732584193,i=-271733879,r=-1732584194,s=271733878,o=-1009589776,l=0;l<e.length;l+=16){for(var c=n,u=i,d=r,b=s,h=o,y=0;y<80;y++){a[y]=y<16?e[l+y]:g(a[y-3]^a[y-8]^a[y-14]^a[y-16],1);var v=f(f(g(n,5),p(y,i,r,s)),f(f(o,a[y]),m(y)));o=s,s=r,r=g(i,30),i=n,n=v}n=f(n,c),i=f(i,u),r=f(r,d),s=f(s,b),o=f(o,h)}return Array(n,i,r,s,o)}function p(e,t,a,n){return e<20?t&a|~t&n:e<40?t^a^n:e<60?t&a|t&n|a&n:t^a^n}function m(e){return e<20?1518500249:e<40?1859775393:e<60?-1894007588:-899497514}function f(e,t){var a=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(a>>16)<<16|65535&a}function g(e,t){return e<<t|e>>>32-t}var b=e("./helpers");t.exports=function(e){return b.hash(e,d,20,!0)}}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:10}],9:[function(e,t,a){(function(a,n,i,r,s,o,l,c,u){var d=e("./helpers"),p=function(e,t){var a=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(a>>16)<<16|65535&a},m=function(e,t){return e>>>t|e<<32-t},f=function(e,t){return e>>>t},g=function(e,t,a){return e&t^~e&a},b=function(e,t,a){return e&t^e&a^t&a},h=function(e){return m(e,2)^m(e,13)^m(e,22)},y=function(e){return m(e,6)^m(e,11)^m(e,25)},v=function(e){return m(e,7)^m(e,18)^f(e,3)},E=function(e){return m(e,17)^m(e,19)^f(e,10)},T=function(e,t){var a,n,i,r,s,o,l,c,u,d,m=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298),f=new Array(1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225),T=new Array(64);e[t>>5]|=128<<24-t%32,e[15+(t+64>>9<<4)]=t;for(var k=0;k<e.length;k+=16){a=f[0],n=f[1],i=f[2],r=f[3],s=f[4],o=f[5],l=f[6],c=f[7];for(var x=0;x<64;x++)T[x]=x<16?e[x+k]:p(p(p(E(T[x-2]),T[x-7]),v(T[x-15])),T[x-16]),u=p(p(p(p(c,y(s)),g(s,o,l)),m[x]),T[x]),d=p(h(a),b(a,n,i)),c=l,l=o,o=s,s=p(r,u),r=i,i=n,n=a,a=p(u,d);f[0]=p(a,f[0]),f[1]=p(n,f[1]),f[2]=p(i,f[2]),f[3]=p(r,f[3]),f[4]=p(s,f[4]),f[5]=p(o,f[5]),f[6]=p(l,f[6]),f[7]=p(c,f[7])}return f};t.exports=function(e){return d.hash(e,T,32,!0)}}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha256.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:10}],10:[function(e,t,a){(function(e,a,n,i,r,s,o,l,c){function u(){}(e=t.exports={}).nextTick=function(){var e="undefined"!=typeof window&&window.setImmediate,t="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(e)return function(e){return window.setImmediate(e)};if(t){var a=[];return window.addEventListener("message",(function(e){var t=e.source;(t===window||null===t)&&"process-tick"===e.data&&(e.stopPropagation(),a.length>0)&&a.shift()()}),!0),function(e){a.push(e),window.postMessage("process-tick","*")}}return function(e){setTimeout(e,0)}}(),e.title="browser",e.browser=!0,e.env={},e.argv=[],e.on=u,e.addListener=u,e.once=u,e.off=u,e.removeListener=u,e.removeAllListeners=u,e.emit=u,e.binding=function(e){throw new Error("process.binding is not supported")},e.cwd=function(){return"/"},e.chdir=function(e){throw new Error("process.chdir is not supported")}}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/process/browser.js","/node_modules/gulp-browserify/node_modules/process")},{buffer:3,lYpoI2:10}],11:[function(e,t,a){(function(e,t,n,i,r,s,o,l,c){a.read=function(e,t,a,n,i){var r,s,o=8*i-n-1,l=(1<<o)-1,c=l>>1,u=-7,d=a?i-1:0,p=a?-1:1,m=e[t+d];for(d+=p,r=m&(1<<-u)-1,m>>=-u,u+=o;u>0;r=256*r+e[t+d],d+=p,u-=8);for(s=r&(1<<-u)-1,r>>=-u,u+=n;u>0;s=256*s+e[t+d],d+=p,u-=8);if(0===r)r=1-c;else{if(r===l)return s?NaN:1/0*(m?-1:1);s+=Math.pow(2,n),r-=c}return(m?-1:1)*s*Math.pow(2,r-n)},a.write=function(e,t,a,n,i,r){var s,o,l,c=8*r-i-1,u=(1<<c)-1,d=u>>1,p=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,m=n?0:r-1,f=n?1:-1,g=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(o=isNaN(t)?1:0,s=u):(s=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-s))<1&&(s--,l*=2),(t+=s+d>=1?p/l:p*Math.pow(2,1-d))*l>=2&&(s++,l/=2),s+d>=u?(o=0,s=u):s+d>=1?(o=(t*l-1)*Math.pow(2,i),s+=d):(o=t*Math.pow(2,d-1)*Math.pow(2,i),s=0));i>=8;e[a+m]=255&o,m+=f,o/=256,i-=8);for(s=s<<i|o,c+=i;c>0;e[a+m]=255&s,m+=f,s/=256,c-=8);e[a+m-f]|=128*g}}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/ieee754/index.js","/node_modules/ieee754")},{buffer:3,lYpoI2:10}]},{},[1])(1)},function(e,t,a){e.exports=p,p.Minimatch=m;var n=function(){try{return a(689)}catch(e){}}()||{sep:"/"};p.sep=n.sep;var i=p.GLOBSTAR=m.GLOBSTAR={},r=a(941),s={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},o="[^/]",l="[^/]*?",c="().*{}+?[]^$\\!".split("").reduce((function(e,t){return e[t]=!0,e}),{});var u=/\/+/;function d(e,t){t=t||{};var a={};return Object.keys(e).forEach((function(t){a[t]=e[t]})),Object.keys(t).forEach((function(e){a[e]=t[e]})),a}function p(e,t,a){return g(t),a||(a={}),!(!a.nocomment&&"#"===t.charAt(0))&&new m(t,a).match(e)}function m(e,t){if(!(this instanceof m))return new m(e,t);g(e),t||(t={}),e=e.trim(),t.allowWindowsEscape||"/"===n.sep||(e=e.split(n.sep).join("/")),this.options=t,this.set=[],this.pattern=e,this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.partial=!!t.partial,this.make()}function f(e,t){return t||(t=this instanceof m?this.options:{}),e=void 0===e?this.pattern:e,g(e),t.nobrace||!/\{(?:(?!\{).)*\}/.test(e)?[e]:r(e)}p.filter=function(e,t){return t=t||{},function(a,n,i){return p(a,e,t)}},p.defaults=function(e){if(!e||"object"!=typeof e||!Object.keys(e).length)return p;var t=p,a=function(a,n,i){return t(a,n,d(e,i))};return(a.Minimatch=function(a,n){return new t.Minimatch(a,d(e,n))}).defaults=function(a){return t.defaults(d(e,a)).Minimatch},a.filter=function(a,n){return t.filter(a,d(e,n))},a.defaults=function(a){return t.defaults(d(e,a))},a.makeRe=function(a,n){return t.makeRe(a,d(e,n))},a.braceExpand=function(a,n){return t.braceExpand(a,d(e,n))},a.match=function(a,n,i){return t.match(a,n,d(e,i))},a},m.defaults=function(e){return p.defaults(e).Minimatch},m.prototype.debug=function(){},m.prototype.make=function(){var e=this.pattern,t=this.options;if(!t.nocomment&&"#"===e.charAt(0))return void(this.comment=!0);if(!e)return void(this.empty=!0);this.parseNegate();var a=this.globSet=this.braceExpand();t.debug&&(this.debug=function(){console.error.apply(console,arguments)});this.debug(this.pattern,a),a=this.globParts=a.map((function(e){return e.split(u)})),this.debug(this.pattern,a),a=a.map((function(e,t,a){return e.map(this.parse,this)}),this),this.debug(this.pattern,a),a=a.filter((function(e){return-1===e.indexOf(!1)})),this.debug(this.pattern,a),this.set=a},m.prototype.parseNegate=function(){var e=this.pattern,t=!1,a=this.options,n=0;if(a.nonegate)return;for(var i=0,r=e.length;i<r&&"!"===e.charAt(i);i++)t=!t,n++;n&&(this.pattern=e.substr(n));this.negate=t},p.braceExpand=function(e,t){return f(e,t)},m.prototype.braceExpand=f;var g=function(e){if("string"!=typeof e)throw new TypeError("invalid pattern");if(e.length>65536)throw new TypeError("pattern is too long")};m.prototype.parse=function(e,t){g(e);var a=this.options;if("**"===e){if(!a.noglobstar)return i;e="*"}if(""===e)return"";var n,r="",u=!!a.nocase,d=!1,p=[],m=[],f=!1,h=-1,y=-1,v="."===e.charAt(0)?"":a.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",E=this;function T(){if(n){switch(n){case"*":r+=l,u=!0;break;case"?":r+=o,u=!0;break;default:r+="\\"+n}E.debug("clearStateChar %j %j",n,r),n=!1}}for(var k,x=0,S=e.length;x<S&&(k=e.charAt(x));x++)if(this.debug("%s\t%s %s %j",e,x,r,k),d&&c[k])r+="\\"+k,d=!1;else switch(k){case"/":return!1;case"\\":T(),d=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s\t%s %s %j <-- stateChar",e,x,r,k),f){this.debug("  in class"),"!"===k&&x===y+1&&(k="^"),r+=k;continue}E.debug("call clearStateChar %j",n),T(),n=k,a.noext&&T();continue;case"(":if(f){r+="(";continue}if(!n){r+="\\(";continue}p.push({type:n,start:x-1,reStart:r.length,open:s[n].open,close:s[n].close}),r+="!"===n?"(?:(?!(?:":"(?:",this.debug("plType %j %j",n,r),n=!1;continue;case")":if(f||!p.length){r+="\\)";continue}T(),u=!0;var w=p.pop();r+=w.close,"!"===w.type&&m.push(w),w.reEnd=r.length;continue;case"|":if(f||!p.length||d){r+="\\|",d=!1;continue}T(),r+="|";continue;case"[":if(T(),f){r+="\\"+k;continue}f=!0,y=x,h=r.length,r+=k;continue;case"]":if(x===y+1||!f){r+="\\"+k,d=!1;continue}var O=e.substring(y+1,x);try{RegExp("["+O+"]")}catch(e){var j=this.parse(O,b);r=r.substr(0,h)+"\\["+j[0]+"\\]",u=u||j[1],f=!1;continue}u=!0,f=!1,r+=k;continue;default:T(),d?d=!1:!c[k]||"^"===k&&f||(r+="\\"),r+=k}f&&(O=e.substr(y+1),j=this.parse(O,b),r=r.substr(0,h)+"\\["+j[0],u=u||j[1]);for(w=p.pop();w;w=p.pop()){var C=r.slice(w.reStart+w.open.length);this.debug("setting tail",r,w),C=C.replace(/((?:\\{2}){0,64})(\\?)\|/g,(function(e,t,a){return a||(a="\\"),t+t+a+"|"})),this.debug("tail=%j\n   %s",C,C,w,r);var I="*"===w.type?l:"?"===w.type?o:"\\"+w.type;u=!0,r=r.slice(0,w.reStart)+I+"\\("+C}T(),d&&(r+="\\\\");var M=!1;switch(r.charAt(0)){case"[":case".":case"(":M=!0}for(var A=m.length-1;A>-1;A--){var q=m[A],D=r.slice(0,q.reStart),P=r.slice(q.reStart,q.reEnd-8),R=r.slice(q.reEnd-8,q.reEnd),F=r.slice(q.reEnd);R+=F;var _=D.split("(").length-1,N=F;for(x=0;x<_;x++)N=N.replace(/\)[+*?]?/,"");var L="";""===(F=N)&&t!==b&&(L="$"),r=D+P+F+L+R}""!==r&&u&&(r="(?=.)"+r);M&&(r=v+r);if(t===b)return[r,u];if(!u)return function(e){return e.replace(/\\(.)/g,"$1")}(e);var B=a.nocase?"i":"";try{var z=new RegExp("^"+r+"$",B)}catch(e){return new RegExp("$.")}return z._glob=e,z._src=r,z};var b={};p.makeRe=function(e,t){return new m(e,t||{}).makeRe()},m.prototype.makeRe=function(){if(this.regexp||!1===this.regexp)return this.regexp;var e=this.set;if(!e.length)return this.regexp=!1,this.regexp;var t=this.options,a=t.noglobstar?l:t.dot?"(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?":"(?:(?!(?:\\/|^)\\.).)*?",n=t.nocase?"i":"",r=e.map((function(e){return e.map((function(e){return e===i?a:"string"==typeof e?function(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}(e):e._src})).join("\\/")})).join("|");r="^(?:"+r+")$",this.negate&&(r="^(?!"+r+").*$");try{this.regexp=new RegExp(r,n)}catch(e){this.regexp=!1}return this.regexp},p.match=function(e,t,a){var n=new m(t,a=a||{});return e=e.filter((function(e){return n.match(e)})),n.options.nonull&&!e.length&&e.push(t),e},m.prototype.match=function(e,t){if(void 0===t&&(t=this.partial),this.debug("match",e,this.pattern),this.comment)return!1;if(this.empty)return""===e;if("/"===e&&t)return!0;var a=this.options;"/"!==n.sep&&(e=e.split(n.sep).join("/")),e=e.split(u),this.debug(this.pattern,"split",e);var i,r,s=this.set;for(this.debug(this.pattern,"set",s),r=e.length-1;r>=0&&!(i=e[r]);r--);for(r=0;r<s.length;r++){var o=s[r],l=e;if(a.matchBase&&1===o.length&&(l=[i]),this.matchOne(l,o,t))return!!a.flipNegate||!this.negate}return!a.flipNegate&&this.negate},m.prototype.matchOne=function(e,t,a){var n=this.options;this.debug("matchOne",{this:this,file:e,pattern:t}),this.debug("matchOne",e.length,t.length);for(var r=0,s=0,o=e.length,l=t.length;r<o&&s<l;r++,s++){this.debug("matchOne loop");var c,u=t[s],d=e[r];if(this.debug(t,u,d),!1===u)return!1;if(u===i){this.debug("GLOBSTAR",[t,u,d]);var p=r,m=s+1;if(m===l){for(this.debug("** at the end");r<o;r++)if("."===e[r]||".."===e[r]||!n.dot&&"."===e[r].charAt(0))return!1;return!0}for(;p<o;){var f=e[p];if(this.debug("\nglobstar while",e,p,t,m,f),this.matchOne(e.slice(p),t.slice(m),a))return this.debug("globstar found match!",p,o,f),!0;if("."===f||".."===f||!n.dot&&"."===f.charAt(0)){this.debug("dot detected!",e,p,t,m);break}this.debug("globstar swallow a segment, and continue"),p++}return!(!a||(this.debug("\n>>> no match, partial?",e,p,t,m),p!==o))}if("string"==typeof u?(c=d===u,this.debug("string match",u,d,c)):(c=d.match(u),this.debug("pattern match",u,d,c)),!c)return!1}if(r===o&&s===l)return!0;if(r===o)return a;if(s===l)return r===o-1&&""===e[r];throw new Error("wtf?")}},function(e,t,a){var n=a(942),i=a(943);e.exports=function(e){if(!e)return[];"{}"===e.substr(0,2)&&(e="\\{\\}"+e.substr(2));return h(function(e){return e.split("\\\\").join(r).split("\\{").join(s).split("\\}").join(o).split("\\,").join(l).split("\\.").join(c)}(e),!0).map(d)};var r="\0SLASH"+Math.random()+"\0",s="\0OPEN"+Math.random()+"\0",o="\0CLOSE"+Math.random()+"\0",l="\0COMMA"+Math.random()+"\0",c="\0PERIOD"+Math.random()+"\0";function u(e){return parseInt(e,10)==e?parseInt(e,10):e.charCodeAt(0)}function d(e){return e.split(r).join("\\").split(s).join("{").split(o).join("}").split(l).join(",").split(c).join(".")}function p(e){if(!e)return[""];var t=[],a=i("{","}",e);if(!a)return e.split(",");var n=a.pre,r=a.body,s=a.post,o=n.split(",");o[o.length-1]+="{"+r+"}";var l=p(s);return s.length&&(o[o.length-1]+=l.shift(),o.push.apply(o,l)),t.push.apply(t,o),t}function m(e){return"{"+e+"}"}function f(e){return/^-?0\d/.test(e)}function g(e,t){return e<=t}function b(e,t){return e>=t}function h(e,t){var a=[],r=i("{","}",e);if(!r||/\$$/.test(r.pre))return[e];var s,l=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(r.body),c=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(r.body),d=l||c,y=r.body.indexOf(",")>=0;if(!d&&!y)return r.post.match(/,.*\}/)?h(e=r.pre+"{"+r.body+o+r.post):[e];if(d)s=r.body.split(/\.\./);else if(1===(s=p(r.body)).length&&1===(s=h(s[0],!1).map(m)).length)return(T=r.post.length?h(r.post,!1):[""]).map((function(e){return r.pre+s[0]+e}));var v,E=r.pre,T=r.post.length?h(r.post,!1):[""];if(d){var k=u(s[0]),x=u(s[1]),S=Math.max(s[0].length,s[1].length),w=3==s.length?Math.abs(u(s[2])):1,O=g;x<k&&(w*=-1,O=b);var j=s.some(f);v=[];for(var C=k;O(C,x);C+=w){var I;if(c)"\\"===(I=String.fromCharCode(C))&&(I="");else if(I=String(C),j){var M=S-I.length;if(M>0){var A=new Array(M+1).join("0");I=C<0?"-"+A+I.slice(1):A+I}}v.push(I)}}else v=n(s,(function(e){return h(e,!1)}));for(var q=0;q<v.length;q++)for(var D=0;D<T.length;D++){var P=E+v[q]+T[D];(!t||d||P)&&a.push(P)}return a}},function(e,t){e.exports=function(e,t){for(var n=[],i=0;i<e.length;i++){var r=t(e[i],i);a(r)?n.push.apply(n,r):n.push(r)}return n};var a=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},function(e,t,a){"use strict";function n(e,t,a){e instanceof RegExp&&(e=i(e,a)),t instanceof RegExp&&(t=i(t,a));var n=r(e,t,a);return n&&{start:n[0],end:n[1],pre:a.slice(0,n[0]),body:a.slice(n[0]+e.length,n[1]),post:a.slice(n[1]+t.length)}}function i(e,t){var a=t.match(e);return a?a[0]:null}function r(e,t,a){var n,i,r,s,o,l=a.indexOf(e),c=a.indexOf(t,l+1),u=l;if(l>=0&&c>0){for(n=[],r=a.length;u>=0&&!o;)u==l?(n.push(u),l=a.indexOf(e,u+1)):1==n.length?o=[n.pop(),c]:((i=n.pop())<r&&(r=i,s=c),c=a.indexOf(t,u+1)),u=l<c&&l>=0?l:c;n.length&&(o=[r,s])}return o}e.exports=n,n.range=r},function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iOCIgaGVpZ2h0PSI4IiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMSAwSDB2OGg4VjdIMVYweiIgZmlsbD0iI0QzREFFNiIvPjwvc3ZnPg=="},function(e,t,a){"use strict";function n(e){return function(e){if(Array.isArray(e)){for(var t=0,a=new Array(e.length);t<e.length;t++)a[t]=e[t];return a}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var i=a(248),r=a(946),s=a(959),o=a(550),l=a(1015),c=a(1017),u=a(1018),d=a(1019),p=a(1020),m=a(1021),f=a(1022),g=a(1023),b=a(1024),h=Object.keys(g),y=function(e){var t=e.source||e.children||"",a=e.parserOptions;if(e.allowedTypes&&e.disallowedTypes)throw new Error("Only one of `allowedTypes` and `disallowedTypes` should be defined");var n=i(g,e.renderers),o=[[s,a]].concat(e.plugins||[]).reduce(v,r()),f=o.parse(t),y=i(e,{renderers:n,definitions:m(f)}),E=function(e){var t=[p,l()],a=e.disallowedTypes;e.allowedTypes&&(a=h.filter((function(t){return"root"!==t&&-1===e.allowedTypes.indexOf(t)})));var n=e.unwrapDisallowed?"unwrap":"remove";a&&a.length>0&&t.push(u.ofType(a,n));e.allowNode&&t.push(u.ifNotMatch(e.allowNode,n));var i=!e.escapeHtml&&!e.skipHtml,r=(e.astPlugins||[]).some((function(e){return(Array.isArray(e)?e[0]:e).identity===b.HtmlParser}));i&&!r&&t.push(c);return e.astPlugins?t.concat(e.astPlugins):t}(e),T=o.runSync(f),k=E.reduce((function(e,t){return t(e,y)}),T);return d(k,y)};function v(e,t){return Array.isArray(t)?e.use.apply(e,n(t)):e.use(t)}y.defaultProps={renderers:{},escapeHtml:!0,skipHtml:!1,sourcePos:!1,rawSourcePos:!1,transformLinkUri:f,astPlugins:[],plugins:[],parserOptions:{}},y.propTypes={className:o.string,source:o.string,children:o.string,sourcePos:o.bool,rawSourcePos:o.bool,escapeHtml:o.bool,skipHtml:o.bool,allowNode:o.func,allowedTypes:o.arrayOf(o.oneOf(h)),disallowedTypes:o.arrayOf(o.oneOf(h)),transformLinkUri:o.oneOfType([o.func,o.bool]),linkTarget:o.oneOfType([o.func,o.string]),transformImageUri:o.func,astPlugins:o.arrayOf(o.func),unwrapDisallowed:o.bool,renderers:o.object,plugins:o.array,parserOptions:o.object},y.types=h,y.renderers=g,y.uriTransformer=f,e.exports=y},function(e,t,a){"use strict";var n=a(947),i=a(948),r=a(949),s=a(955),o=a(956),l=a(957),c=a(958);e.exports=function e(){var t=[],a=s(),v={},E=!1,T=-1;return k.data=function(e,t){if(o(e))return 2===arguments.length?(b("data",E),v[e]=t,k):d.call(v,e)&&v[e]||null;if(e)return b("data",E),v=e,k;return v},k.freeze=x,k.attachers=t,k.use=function(e){var a;if(b("use",E),null==e);else if(l(e))o.apply(null,arguments);else{if("object"!=typeof e)throw new Error("Expected usable value, not `"+e+"`");"length"in e?s(e):i(e)}a&&(v.settings=n(v.settings||{},a));return k;function i(e){s(e.plugins),e.settings&&(a=n(a||{},e.settings))}function r(e){if(l(e))o(e);else{if("object"!=typeof e)throw new Error("Expected usable value, not `"+e+"`");"length"in e?o.apply(null,e):i(e)}}function s(e){var t,a;if(null==e);else{if("object"!=typeof e||!("length"in e))throw new Error("Expected a list of plugins, not `"+e+"`");for(t=e.length,a=-1;++a<t;)r(e[a])}}function o(e,a){var i=S(e);i?(c(i[1])&&c(a)&&(a=n(i[1],a)),i[1]=a):t.push(u.call(arguments))}},k.parse=function(e){var t,a=r(e);if(x(),f("parse",t=k.Parser),m(t))return new t(String(a),a).parse();return t(String(a),a)},k.stringify=function(e,t){var a,n=r(t);if(x(),g("stringify",a=k.Compiler),h(e),m(a))return new a(e,n).compile();return a(e,n)},k.run=w,k.runSync=function(e,t){var a,n=!1;return w(e,t,r),y("runSync","run",n),a;function r(e,t){n=!0,i(e),a=t}},k.process=O,k.processSync=function(e){var t,a=!1;return x(),f("processSync",k.Parser),g("processSync",k.Compiler),O(t=r(e),n),y("processSync","process",a),t;function n(e){a=!0,i(e)}},k;function k(){for(var a=e(),i=t.length,r=-1;++r<i;)a.use.apply(null,t[r]);return a.data(n(!0,{},v)),a}function x(){var e,n,i,r;if(E)return k;for(;++T<t.length;)n=(e=t[T])[0],null,!1!==(i=e[1])&&(!0===i&&(e[1]=void 0),r=n.apply(k,e.slice(1)),l(r)&&a.use(r));return E=!0,T=1/0,k}function S(e){for(var a,n=t.length,i=-1;++i<n;)if((a=t[i])[0]===e)return a}function w(e,t,n){if(h(e),x(),!n&&l(t)&&(n=t,t=null),!n)return new Promise(i);function i(i,s){a.run(e,r(t),(function(t,a,r){a=a||e,t?s(t):i?i(a):n(null,a,r)}))}i(null,n)}function O(e,t){if(x(),f("process",k.Parser),g("process",k.Compiler),!t)return new Promise(a);function a(a,n){var i=r(e);p.run(k,{file:i},(function(e){e?n(e):a?a(i):t(null,i)}))}a(null,t)}}().freeze();var u=[].slice,d={}.hasOwnProperty,p=s().use((function(e,t){t.tree=e.parse(t.file)})).use((function(e,t,a){e.run(t.tree,t.file,(function(e,n,i){e?a(e):(t.tree=n,t.file=i,a())}))})).use((function(e,t){t.file.contents=e.stringify(t.tree,t.file)}));function m(e){return l(e)&&function(e){var t;for(t in e)return!0;return!1}(e.prototype)}function f(e,t){if(!l(t))throw new Error("Cannot `"+e+"` without `Parser`")}function g(e,t){if(!l(t))throw new Error("Cannot `"+e+"` without `Compiler`")}function b(e,t){if(t)throw new Error("Cannot invoke `"+e+"` on a frozen processor.\nCreate a new processor first, by invoking it: use `processor()` instead of `processor`.")}function h(e){if(!e||!o(e.type))throw new Error("Expected node, got `"+e+"`")}function y(e,t,a){if(!a)throw new Error("`"+e+"` finished async. Use `"+t+"` instead")}},function(e,t,a){e.exports=a(46)(3053)},function(e,t,a){e.exports=a(46)(3051)},function(e,t,a){"use strict";var n=a(950),i=a(952);e.exports=i;var r=i.prototype;function s(e,t,a){var i=this.path,r=new n(e,t,a);return i&&(r.name=i+":"+r.name,r.file=i),r.fatal=!1,this.messages.push(r),r}r.message=s,r.info=function(){var e=this.message.apply(this,arguments);return e.fatal=null,e},r.fail=function(){var e=this.message.apply(this,arguments);throw e.fatal=!0,e},r.warn=s},function(e,t,a){"use strict";var n=a(951);function i(){}e.exports=s,i.prototype=Error.prototype,s.prototype=new i;var r=s.prototype;function s(e,t,a){var i,r,s;"string"==typeof t&&(a=t,t=null),i=function(e){var t,a=[null,null];"string"==typeof e&&(-1===(t=e.indexOf(":"))?a[1]=e:(a[0]=e.slice(0,t),a[1]=e.slice(t+1)));return a}(a),r=n(t)||"1:1",s={start:{line:null,column:null},end:{line:null,column:null}},t&&t.position&&(t=t.position),t&&(t.start?(s=t,t=t.start):s.start=t),e.stack&&(this.stack=e.stack,e=e.message),this.message=e,this.name=r,this.reason=e,this.line=t?t.line:null,this.column=t?t.column:null,this.location=s,this.source=i[0],this.ruleId=i[1]}r.file="",r.name="",r.reason="",r.message="",r.stack="",r.fatal=null,r.column=null,r.line=null},function(e,t,a){"use strict";var n={}.hasOwnProperty;function i(e){return e&&"object"==typeof e||(e={}),s(e.line)+":"+s(e.column)}function r(e){return e&&"object"==typeof e||(e={}),i(e.start)+"-"+i(e.end)}function s(e){return e&&"number"==typeof e?e:1}e.exports=function(e){if(!e||"object"!=typeof e)return null;if(n.call(e,"position")||n.call(e,"type"))return r(e.position);if(n.call(e,"start")||n.call(e,"end"))return r(e);if(n.call(e,"line")||n.call(e,"column"))return i(e);return null}},function(e,t,a){"use strict";(function(t){var n=a(689),i=a(953),r=a(954);e.exports=c;var s={}.hasOwnProperty,o=c.prototype;o.toString=function(e){var t=this.contents||"";return r(t)?t.toString(e):String(t)};var l=["history","path","basename","stem","extname","dirname"];function c(e){var a,n,i;if(e){if("string"==typeof e||r(e))e={contents:e};else if("message"in e&&"messages"in e)return e}else e={};if(!(this instanceof c))return new c(e);for(this.data={},this.messages=[],this.history=[],this.cwd=t.cwd(),n=-1,i=l.length;++n<i;)a=l[n],s.call(e,a)&&(this[a]=e[a]);for(a in e)-1===l.indexOf(a)&&(this[a]=e[a])}function u(e,t){if(-1!==e.indexOf(n.sep))throw new Error("`"+t+"` cannot be a path: did not expect `"+n.sep+"`")}function d(e,t){if(!e)throw new Error("`"+t+"` cannot be empty")}function p(e,t){if(!e)throw new Error("Setting `"+t+"` requires `path` to be set too")}Object.defineProperty(o,"path",{get:function(){return this.history[this.history.length-1]},set:function(e){d(e,"path"),e!==this.path&&this.history.push(e)}}),Object.defineProperty(o,"dirname",{get:function(){return"string"==typeof this.path?n.dirname(this.path):void 0},set:function(e){p(this.path,"dirname"),this.path=n.join(e||"",this.basename)}}),Object.defineProperty(o,"basename",{get:function(){return"string"==typeof this.path?n.basename(this.path):void 0},set:function(e){d(e,"basename"),u(e,"basename"),this.path=n.join(this.dirname||"",e)}}),Object.defineProperty(o,"extname",{get:function(){return"string"==typeof this.path?n.extname(this.path):void 0},set:function(e){var t=e||"";if(u(t,"extname"),p(this.path,"extname"),t){if("."!==t.charAt(0))throw new Error("`extname` must start with `.`");if(-1!==t.indexOf(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=i(this.path,t)}}),Object.defineProperty(o,"stem",{get:function(){return"string"==typeof this.path?n.basename(this.path,this.extname):void 0},set:function(e){d(e,"stem"),u(e,"stem"),this.path=n.join(this.dirname||"",e+(this.extname||""))}})}).call(this,a(378))},function(e,t,a){e.exports=a(46)(3060)},function(e,t){function a(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
e.exports=function(e){return null!=e&&(a(e)||function(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&a(e.slice(0,0))}(e)||!!e._isBuffer)}},function(e,t,a){e.exports=a(46)(3055)},function(e,t){var a=Object.prototype.toString;e.exports=function(e){return"[object String]"===a.call(e)}},function(e,t){e.exports=function(e){return"[object Function]"===Object.prototype.toString.call(e)}},function(e,t,a){"use strict";var n=Object.prototype.toString;e.exports=function(e){var t;return"[object Object]"===n.call(e)&&(null===(t=Object.getPrototypeOf(e))||t===Object.getPrototypeOf({}))}},function(e,t,a){"use strict";var n=a(960),i=a(248),r=a(961);function s(e){var t=n(r);t.prototype.options=i(t.prototype.options,this.data("settings"),e),this.Parser=t}e.exports=s,s.Parser=r},function(e,t,a){e.exports=a(46)(3062)},function(e,t,a){"use strict";var n=a(248),i=a(962),r=a(963),s=a(964),o=a(965),l=a(971);function c(e,t){this.file=t,this.offset={},this.options=n(this.options),this.setOptions({}),this.inList=!1,this.inBlock=!1,this.inLink=!1,this.atStart=!0,this.toOffset=r(t).toOffset,this.unescape=s(this,"escape"),this.decode=o(this)}e.exports=c;var u=c.prototype;function d(e){var t,a=[];for(t in e)a.push(t);return a}u.setOptions=a(972),u.parse=a(975),u.options=a(690),u.exitStart=i("atStart",!0),u.enterList=i("inList",!1),u.enterLink=i("inLink",!1),u.enterBlock=i("inBlock",!1),u.interruptParagraph=[["thematicBreak"],["atxHeading"],["fencedCode"],["blockquote"],["html"],["setextHeading",{commonmark:!1}],["definition",{commonmark:!1}],["footnote",{commonmark:!1}]],u.interruptList=[["atxHeading",{pedantic:!1}],["fencedCode",{pedantic:!1}],["thematicBreak",{pedantic:!1}],["definition",{commonmark:!1}],["footnote",{commonmark:!1}]],u.interruptBlockquote=[["indentedCode",{commonmark:!0}],["fencedCode",{commonmark:!0}],["atxHeading",{commonmark:!0}],["setextHeading",{commonmark:!0}],["thematicBreak",{commonmark:!0}],["html",{commonmark:!0}],["list",{commonmark:!0}],["definition",{commonmark:!1}],["footnote",{commonmark:!1}]],u.blockTokenizers={newline:a(979),indentedCode:a(980),fencedCode:a(981),blockquote:a(982),atxHeading:a(983),thematicBreak:a(984),list:a(985),setextHeading:a(987),html:a(988),footnote:a(989),definition:a(991),table:a(992),paragraph:a(993)},u.inlineTokenizers={escape:a(994),autoLink:a(996),url:a(997),html:a(999),link:a(1001),reference:a(1002),strong:a(1003),emphasis:a(1005),deletion:a(1008),code:a(1010),break:a(1012),text:a(1014)},u.blockMethods=d(u.blockTokenizers),u.inlineMethods=d(u.inlineTokenizers),u.tokenizeBlock=l("block"),u.tokenizeInline=l("inline"),u.tokenizeFactory=l},function(e,t,a){e.exports=a(46)(3065)},function(e,t,a){"use strict";function n(e){return function(t){var a=-1,n=e.length;if(t<0)return{};for(;++a<n;)if(e[a]>t)return{line:a+1,column:t-(e[a-1]||0)+1,offset:t};return{}}}function i(e){return function(t){var a=t&&t.line,n=t&&t.column;if(!isNaN(a)&&!isNaN(n)&&a-1 in e)return(e[a-2]||0)+n-1||0;return-1}}e.exports=function(e){var t=function(e){var t=[],a=e.indexOf("\n");for(;-1!==a;)t.push(a+1),a=e.indexOf("\n",a+1);return t.push(e.length+1),t}(String(e));return{toPosition:n(t),toOffset:i(t)}}},function(e,t,a){"use strict";e.exports=function(e,t){return function(a){var n,i=0,r=a.indexOf("\\"),s=e[t],o=[];for(;-1!==r;)o.push(a.slice(i,r)),i=r+1,(n=a.charAt(i))&&-1!==s.indexOf(n)||o.push("\\"),r=a.indexOf("\\",i);return o.push(a.slice(i)),o.join("")}}},function(e,t,a){"use strict";var n=a(248),i=a(480);e.exports=function(e){return r.raw=function(e,r,s){return i(e,n(s,{position:t(r),warning:a}))},r;function t(t){for(var a=e.offset,n=t.line,i=[];++n&&n in a;)i.push((a[n]||0)+1);return{start:t,indent:i}}function a(t,a,n){3!==n&&e.file.message(t,a)}function r(n,r,s){i(n,{position:t(r),warning:a,text:s,reference:s,textContext:e,referenceContext:e})}}},function(e,t,a){e.exports=a(46)(2677)},function(e,t,a){e.exports=a(46)(2678)},function(e,t,a){e.exports=a(46)(2679)},function(e,t,a){e.exports=a(46)(2680)},function(e,t,a){"use strict";var n;e.exports=function(e){var t,a="&"+e+";";if((n=n||document.createElement("i")).innerHTML=a,";"===(t=n.textContent).slice(-1)&&"semi"!==e)return!1;return t!==a&&t}},function(e,t,a){"use strict";e.exports=function(e){return function(t,a){var r,s,o,l,c,u=this,d=u.offset,p=[],m=u[e+"Methods"],f=u[e+"Tokenizers"],g=a.line,b=a.column;if(!t)return p;S.now=v,S.file=u.file,h("");for(;t;){for(r=-1,s=m.length,l=!1;++r<s&&(!(o=f[m[r]])||o.onlyAtStart&&!u.atStart||o.notInList&&u.inList||o.notInBlock&&u.inBlock||o.notInLink&&u.inLink||(c=t.length,o.apply(u,[S,t]),!(l=c!==t.length))););l||u.file.fail(new Error("Infinite loop"),S.now())}return u.eof=v(),p;function h(e){for(var t=-1,a=e.indexOf("\n");-1!==a;)g++,t=a,a=e.indexOf("\n",a+1);-1===t?b+=e.length:b=e.length-t,g in d&&(-1!==t?b+=d[g]:b<=d[g]&&(b=d[g]+1))}function y(){var e=[],t=g+1;return function(){for(var a=g+1;t<a;)e.push((d[t]||0)+1),t++;return e}}function v(){var e={line:g,column:b};return e.offset=u.toOffset(e),e}function E(e){this.start=e,this.end=v()}function T(e){t.substring(0,e.length)!==e&&u.file.fail(new Error("Incorrectly eaten value: please report this warning on http://git.io/vg5Ft"),v())}function k(){var e=v();return t;function t(t,a){var n=t.position,i=n?n.start:e,r=[],s=n&&n.end.line,o=e.line;if(t.position=new E(i),n&&a&&n.indent){if(r=n.indent,s<o){for(;++s<o;)r.push((d[s]||0)+1);r.push(e.column)}a=r.concat(a)}return t.position.indent=a||[],t}}function x(e,t){var a=t?t.children:p,r=a[a.length-1];return r&&e.type===r.type&&e.type in n&&i(r)&&i(e)&&(e=n[e.type].call(u,r,e)),e!==r&&a.push(e),u.atStart&&0!==p.length&&u.exitStart(),e}function S(e){var a=y(),n=k(),i=v();return T(e),r.reset=s,s.test=o,r.test=o,t=t.substring(e.length),h(e),a=a(),r;function r(e,t){return n(x(n(e),t),a)}function s(){var a=r.apply(null,arguments);return g=i.line,b=i.column,t=e+t,a}function o(){var a=n({});return g=i.line,b=i.column,t=e+t,a.position}}}};var n={text:function(e,t){return e.value+=t.value,e},blockquote:function(e,t){if(this.options.commonmark)return t;return e.children=e.children.concat(t.children),e}};function i(e){var t,a;return"text"!==e.type||!e.position||(t=e.position.start,a=e.position.end,t.line!==a.line||a.column-t.column===e.value.length)}},function(e,t,a){"use strict";var n=a(248),i=a(973),r=a(690);e.exports=function(e){var t,a,s=this,o=s.options;if(null==e)e={};else{if("object"!=typeof e)throw new Error("Invalid value `"+e+"` for setting `options`");e=n(e)}for(t in r){if(null==(a=e[t])&&(a=o[t]),"blocks"!==t&&"boolean"!=typeof a||"blocks"===t&&"object"!=typeof a)throw new Error("Invalid value `"+a+"` for setting `options."+t+"`");e[t]=a}return s.options=e,s.escape=i(e),s}},function(e,t,a){e.exports=a(46)(3071)},function(e){e.exports=JSON.parse('["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","iframe","legend","li","link","main","menu","menuitem","meta","nav","noframes","ol","optgroup","option","p","param","pre","section","source","title","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"]')},function(e,t,a){"use strict";var n=a(248),i=a(976);e.exports=function(){var e,t=this,a=String(t.file),s={line:1,column:1,offset:0},o=n(s);65279===(a=a.replace(r,"\n")).charCodeAt(0)&&(a=a.slice(1),o.column++,o.offset++);e={type:"root",children:t.tokenizeBlock(a,o),position:{start:s,end:t.eof||n(s)}},t.options.position||i(e,!0);return e};var r=/\r\n|\r/g},function(e,t,a){"use strict";var n=a(391);function i(e){delete e.position}function r(e){e.position=void 0}e.exports=function(e,t){return n(e,t?i:r),e}},function(e,t,a){"use strict";e.exports=s;var n=a(978),i="skip",r=!1;function s(e,t,a,s){var l;function c(e,n,u){var d,p=[];return(t&&!l(e,n,u[u.length-1]||null)||(p=o(a(e,u)))[0]!==r)&&e.children&&p[0]!==i?(d=o(function(e,t){var a,n=-1,i=s?-1:1,o=(s?e.length:n)+i;for(;o>n&&o<e.length;){if((a=c(e[o],o,t))[0]===r)return a;o="number"==typeof a[1]?a[1]:o+i}}(e.children,u.concat(e))),d[0]===r?d:p):p}"function"==typeof t&&"function"!=typeof a&&(s=a,a=t,t=null),l=n(t),c(e,null,[])}function o(e){return null!==e&&"object"==typeof e&&"length"in e?e:"number"==typeof e?[true,e]:[e]}s.CONTINUE=true,s.SKIP=i,s.EXIT=r},function(e,t,a){"use strict";function n(e){if("string"==typeof e)return function(e){return t;function t(t){return Boolean(t&&t.type===e)}}(e);if(null==e)return s;if("object"==typeof e)return("length"in e?r:i)(e);if("function"==typeof e)return e;throw new Error("Expected function, string, or object as test")}function i(e){return function(t){var a;for(a in e)if(t[a]!==e[a])return!1;return!0}}function r(e){var t=function(e){for(var t=[],a=e.length,i=-1;++i<a;)t[i]=n(e[i]);return t}(e),a=t.length;return function(){var e=-1;for(;++e<a;)if(t[e].apply(this,arguments))return!0;return!1}}function s(){return!0}e.exports=n},function(e,t,a){"use strict";var n=a(180);e.exports=function(e,t,a){var i,r,s,o,l=t.charAt(0);if("\n"!==l)return;if(a)return!0;o=1,i=t.length,r=l,s="";for(;o<i&&(l=t.charAt(o),n(l));)s+=l,"\n"===l&&(r+=s,s=""),o++;e(r)}},function(e,t,a){"use strict";var n=a(482),i=a(483);e.exports=function(e,t,a){var n,s,o,l=-1,c=t.length,u="",d="",p="",m="";for(;++l<c;)if(n=t.charAt(l),o)if(o=!1,u+=p,d+=m,p="",m="","\n"===n)p=n,m=n;else for(u+=n,d+=n;++l<c;){if(!(n=t.charAt(l))||"\n"===n){m=n,p=n;break}u+=n,d+=n}else if(" "===n&&t.charAt(l+1)===n&&t.charAt(l+2)===n&&t.charAt(l+3)===n)p+=r,l+=3,o=!0;else if("\t"===n)p+=n,o=!0;else{for(s="";"\t"===n||" "===n;)s+=n,n=t.charAt(++l);if("\n"!==n)break;p+=s+n,m+=n}if(d)return!!a||e(u)({type:"code",lang:null,value:i(d)})};var r=n(" ",4)},function(e,t,a){"use strict";var n=a(483);e.exports=function(e,t,a){var o,l,c,u,d,p,m,f,g,b,h,y=this,v=y.options,E=t.length+1,T=0,k="";if(!v.gfm)return;for(;T<E&&((c=t.charAt(T))===s||c===r);)k+=c,T++;if(b=T,"~"!==(c=t.charAt(T))&&"`"!==c)return;T++,l=c,o=1,k+=c;for(;T<E&&(c=t.charAt(T))===l;)k+=c,o++,T++;if(o<3)return;for(;T<E&&((c=t.charAt(T))===s||c===r);)k+=c,T++;u="",d="";for(;T<E&&(c=t.charAt(T))!==i&&"~"!==c&&"`"!==c;)c===s||c===r?d+=c:(u+=d+c,d=""),T++;if((c=t.charAt(T))&&c!==i)return;if(a)return!0;(h=e.now()).column+=k.length,h.offset+=k.length,k+=u,u=y.decode.raw(y.unescape(u),h),d&&(k+=d);d="",f="",g="",p="",m="";for(;T<E;)if(c=t.charAt(T),p+=f,m+=g,f="",g="",c===i){for(p?(f+=c,g+=c):k+=c,d="",T++;T<E&&(c=t.charAt(T))===s;)d+=c,T++;if(f+=d,g+=d.slice(b),!(d.length>=4)){for(d="";T<E&&(c=t.charAt(T))===l;)d+=c,T++;if(f+=d,g+=d,!(d.length<o)){for(d="";T<E&&((c=t.charAt(T))===s||c===r);)f+=c,g+=c,T++;if(!c||c===i)break}}}else p+=c,g+=c,T++;return e(k+=p+f)({type:"code",lang:u||null,value:n(m)})};var i="\n",r="\t",s=" "},function(e,t,a){"use strict";var n=a(303),i=a(484);e.exports=function(e,t,a){var r,s,o,l,c,u,d,p,m,f=this,g=f.offset,b=f.blockTokenizers,h=f.interruptBlockquote,y=e.now(),v=y.line,E=t.length,T=[],k=[],x=[],S=0;for(;S<E&&(" "===(s=t.charAt(S))||"\t"===s);)S++;if(">"!==t.charAt(S))return;if(a)return!0;S=0;for(;S<E;){for(l=t.indexOf("\n",S),d=S,p=!1,-1===l&&(l=E);S<E&&(" "===(s=t.charAt(S))||"\t"===s);)S++;if(">"===t.charAt(S)?(S++,p=!0," "===t.charAt(S)&&S++):S=d,c=t.slice(S,l),!p&&!n(c)){S=d;break}if(!p&&(o=t.slice(S),i(h,b,f,[e,o,!0])))break;u=d===S?c:t.slice(d,l),x.push(S-d),T.push(u),k.push(c),S=l+1}S=-1,E=x.length,r=e(T.join("\n"));for(;++S<E;)g[v]=(g[v]||0)+x[S],v++;return m=f.enterBlock(),k=f.tokenizeBlock(k.join("\n"),y),m(),r({type:"blockquote",children:k})}},function(e,t,a){"use strict";e.exports=function(e,t,a){var s,o,l,c=this.options,u=t.length+1,d=-1,p=e.now(),m="",f="";for(;++d<u;){if((s=t.charAt(d))!==i&&s!==n){d--;break}m+=s}l=0;for(;++d<=u;){if((s=t.charAt(d))!==r){d--;break}m+=s,l++}if(l>6)return;if(!l||!c.pedantic&&t.charAt(d+1)===r)return;u=t.length+1,o="";for(;++d<u;){if((s=t.charAt(d))!==i&&s!==n){d--;break}o+=s}if(!c.pedantic&&0===o.length&&s&&"\n"!==s)return;if(a)return!0;m+=o,o="",f="";for(;++d<u&&(s=t.charAt(d))&&"\n"!==s;)if(s===i||s===n||s===r){for(;s===i||s===n;)o+=s,s=t.charAt(++d);for(;s===r;)o+=s,s=t.charAt(++d);for(;s===i||s===n;)o+=s,s=t.charAt(++d);d--}else f+=o+s,o="";return p.column+=m.length,p.offset+=m.length,e(m+=f+o)({type:"heading",depth:l,children:this.tokenizeInline(f,p)})};var n="\t",i=" ",r="#"},function(e,t,a){"use strict";e.exports=function(e,t,a){var n,i,r,s,o=-1,l=t.length+1,c="";for(;++o<l&&("\t"===(n=t.charAt(o))||" "===n);)c+=n;if("*"!==n&&"-"!==n&&"_"!==n)return;i=n,c+=n,r=1,s="";for(;++o<l;)if((n=t.charAt(o))===i)r++,c+=s+i,s="";else{if(" "!==n)return r>=3&&(!n||"\n"===n)?(c+=s,!!a||e(c)({type:"thematicBreak"})):void 0;s+=n}}},function(e,t,a){"use strict";var n=a(303),i=a(482),r=a(481),s=a(691),o=a(986),l=a(484);e.exports=function(e,t,a){var i,s,o,p,m,f,g,b,T,k,x,S,w,O,j,C,I,M,A,q,D,P,R,F,_=this,N=_.options.commonmark,L=_.options.pedantic,B=_.blockTokenizers,z=_.interruptList,H=0,U=t.length,$=null,Q=0;for(;H<U;){if((p=t.charAt(H))===d)Q+=4-Q%4;else{if(p!==c)break;Q++}H++}if(Q>=4)return;if(p=t.charAt(H),i=N?v:y,!0===h[p])m=p,o=!1;else{for(o=!0,s="";H<U&&(p=t.charAt(H),r(p));)s+=p,H++;if(p=t.charAt(H),!s||!0!==i[p])return;$=parseInt(s,10),m=p}if((p=t.charAt(++H))!==c&&p!==d)return;if(a)return!0;H=0,O=[],j=[],C=[];for(;H<U;){for(f=t.indexOf(u,H),g=H,b=!1,F=!1,-1===f&&(f=U),R=H+4,Q=0;H<U;){if((p=t.charAt(H))===d)Q+=4-Q%4;else{if(p!==c)break;Q++}H++}if(Q>=4&&(F=!0),I&&Q>=I.indent&&(F=!0),p=t.charAt(H),T=null,!F){if(!0===h[p])T=p,H++,Q++;else{for(s="";H<U&&(p=t.charAt(H),r(p));)s+=p,H++;p=t.charAt(H),H++,s&&!0===i[p]&&(T=p,Q+=s.length+1)}if(T)if((p=t.charAt(H))===d)Q+=4-Q%4,H++;else if(p===c){for(R=H+4;H<R&&t.charAt(H)===c;)H++,Q++;H===R&&t.charAt(H)===c&&(H-=3,Q-=3)}else p!==u&&""!==p&&(T=null)}if(T){if(!L&&m!==T)break;b=!0}else N||F||t.charAt(g)!==c?N&&I&&(F=Q>=I.indent||Q>4):F=!0,b=!1,H=g;if(x=t.slice(g,f),k=g===H?x:t.slice(H,f),("*"===T||"_"===T||"-"===T)&&B.thematicBreak.call(_,e,x,!0))break;if(S=w,w=!n(k).length,F&&I)I.value=I.value.concat(C,x),j=j.concat(C,x),C=[];else if(b)0!==C.length&&(I.value.push(""),I.trail=C.concat()),I={value:[x],indent:Q,trail:[]},O.push(I),j=j.concat(C,x),C=[];else if(w){if(S)break;C.push(x)}else{if(S)break;if(l(z,B,_,[e,x,!0]))break;I.value=I.value.concat(C,x),j=j.concat(C,x),C=[]}H=f+1}D=e(j.join(u)).reset({type:"list",ordered:o,start:$,loose:null,children:[]}),M=_.enterList(),A=_.enterBlock(),q=!1,H=-1,U=O.length;for(;++H<U;)I=O[H].value.join(u),P=e.now(),(I=e(I)(E(_,I,P),D)).loose&&(q=!0),I=O[H].trail.join(u),H!==U-1&&(I+=u),e(I);return M(),A(),D.loose=q,D};var c=" ",u="\n",d="\t",p=/\n\n(?!\s*$)/,m=/^\[([ \t]|x|X)][ \t]/,f=/^([ \t]*)([*+-]|\d+[.)])( {1,4}(?! )| |\t|$|(?=\n))([^\n]*)/,g=/^([ \t]*)([*+-]|\d+[.)])([ \t]+)/,b=/^( {1,4}|\t)?/gm,h={"*":!0,"+":!0,"-":!0},y={".":!0},v={};function E(e,t,a){var n,i,r=e.offset,s=e.options.pedantic?T:k,o=null;return t=s.apply(null,arguments),e.options.gfm&&(n=t.match(m))&&(i=n[0].length,o="x"===n[1].toLowerCase(),r[a.line]+=i,t=t.slice(i)),{type:"listItem",loose:p.test(t)||t.charAt(t.length-1)===u,checked:o,children:e.tokenizeBlock(t,a)}}function T(e,t,a){var n=e.offset,i=a.line;return t=t.replace(g,r),i=a.line,t.replace(b,r);function r(e){return n[i]=(n[i]||0)+e.length,i++,""}}function k(e,t,a){var n,r,l,d,p,m,g,b=e.offset,h=a.line;for(d=(t=t.replace(f,(function(e,t,a,s,o){r=t+a+s,l=o,Number(a)<10&&r.length%2==1&&(a=c+a);return(n=t+i(c,a.length)+s)+l}))).split(u),(p=o(t,s(n).indent).split(u))[0]=l,b[h]=(b[h]||0)+r.length,h++,m=0,g=d.length;++m<g;)b[h]=(b[h]||0)+d[m].length-p[m].length,h++;return p.join(u)}v["."]=!0,v[")"]=!0},function(e,t,a){"use strict";var n=a(303),i=a(482),r=a(691);e.exports=function(e,t){var a,s,o,l,c=e.split("\n"),u=c.length+1,d=1/0,p=[];c.unshift(i(" ",t)+"!");for(;u--;)if(s=r(c[u]),p[u]=s.stops,0!==n(c[u]).length){if(!s.indent){d=1/0;break}s.indent>0&&s.indent<d&&(d=s.indent)}if(d!==1/0)for(u=c.length;u--;){for(o=p[u],a=d;a&&!(a in o);)a--;l=0!==n(c[u]).length&&d&&a!==d?"\t":"",c[u]=l+c[u].slice(a in o?o[a]+1:0)}return c.shift(),c.join("\n")}},function(e,t,a){"use strict";e.exports=function(e,t,a){var i,r,s,o,l,c=e.now(),u=t.length,d=-1,p="";for(;++d<u;){if(" "!==(s=t.charAt(d))||d>=3){d--;break}p+=s}i="",r="";for(;++d<u;){if("\n"===(s=t.charAt(d))){d--;break}" "===s||"\t"===s?r+=s:(i+=r+s,r="")}if(c.column+=p.length,c.offset+=p.length,p+=i+r,s=t.charAt(++d),o=t.charAt(++d),"\n"!==s||!n[o])return;p+=s,r=o,l=n[o];for(;++d<u;){if((s=t.charAt(d))!==o){if("\n"!==s)return;d--;break}r+=s}if(a)return!0;return e(p+r)({type:"heading",depth:l,children:this.tokenizeInline(i,c)})};var n={};n["="]=1,n["-"]=2},function(e,t,a){"use strict";var n=a(692).openCloseTag;e.exports=function(e,t,a){var i,r,s,o,l,c,u,d=this.options.blocks,p=t.length,m=0,f=[[/^<(script|pre|style)(?=(\s|>|$))/i,/<\/(script|pre|style)>/i,!0],[/^<!--/,/-->/,!0],[/^<\?/,/\?>/,!0],[/^<![A-Za-z]/,/>/,!0],[/^<!\[CDATA\[/,/\]\]>/,!0],[new RegExp("^</?("+d.join("|")+")(?=(\\s|/?>|$))","i"),/^$/,!0],[new RegExp(n.source+"\\s*$"),/^$/,!1]];for(;m<p&&("\t"===(o=t.charAt(m))||" "===o);)m++;if("<"!==t.charAt(m))return;i=-1===(i=t.indexOf("\n",m+1))?p:i,r=t.slice(m,i),s=-1,l=f.length;for(;++s<l;)if(f[s][0].test(r)){c=f[s];break}if(!c)return;if(a)return c[2];if(m=i,!c[1].test(r))for(;m<p;){if(i=-1===(i=t.indexOf("\n",m+1))?p:i,r=t.slice(m+1,i),c[1].test(r)){r&&(m=i);break}m=i}return u=t.slice(0,m),e(u)({type:"html",value:u})}},function(e,t,a){"use strict";var n=a(180),i=a(485);e.exports=s,s.notInList=!0,s.notInBlock=!0;var r=/^( {4}|\t)?/gm;function s(e,t,a){var s,o,l,c,u,d,p,m,f,g,b,h,y=this,v=y.offset;if(y.options.footnotes){for(s=0,o=t.length,l="",c=e.now(),u=c.line;s<o&&(f=t.charAt(s),n(f));)l+=f,s++;if("["===t.charAt(s)&&"^"===t.charAt(s+1)){for(s=(l+="[^").length,p="";s<o&&"]"!==(f=t.charAt(s));)"\\"===f&&(p+=f,s++,f=t.charAt(s)),p+=f,s++;if(p&&"]"===t.charAt(s)&&":"===t.charAt(s+1)){if(a)return!0;for(g=i(p),s=(l+=p+"]:").length;s<o&&("\t"===(f=t.charAt(s))||" "===f);)l+=f,s++;for(c.column+=l.length,c.offset+=l.length,p="",d="",m="";s<o;){if("\n"===(f=t.charAt(s))){for(m=f,s++;s<o&&"\n"===(f=t.charAt(s));)m+=f,s++;for(p+=m,m="";s<o&&" "===(f=t.charAt(s));)m+=f,s++;if(0===m.length)break;p+=m}p&&(d+=p,p=""),d+=f,s++}return l+=d,d=d.replace(r,(function(e){return v[u]=(v[u]||0)+e.length,u++,""})),b=e(l),h=y.enterBlock(),d=y.tokenizeBlock(d,c),h(),b({type:"footnoteDefinition",identifier:g,children:d})}}}}},function(e,t,a){e.exports=a(46)(3088)},function(e,t,a){"use strict";var n=a(180),i=a(485);e.exports=c,c.notInList=!0,c.notInBlock=!0;var r="\n",s="\t",o=" ",l="]";function c(e,t,a){for(var n,c,p,m,f,g,b,h,y=this,v=y.options.commonmark,E=0,T=t.length,k="";E<T&&((m=t.charAt(E))===o||m===s);)k+=m,E++;if("["===(m=t.charAt(E))){for(E++,k+=m,p="";E<T&&(m=t.charAt(E))!==l;)"\\"===m&&(p+=m,E++,m=t.charAt(E)),p+=m,E++;if(p&&t.charAt(E)===l&&":"===t.charAt(E+1)){for(g=p,E=(k+=p+l+":").length,p="";E<T&&((m=t.charAt(E))===s||m===o||m===r);)k+=m,E++;if(p="",n=k,"<"===(m=t.charAt(E))){for(E++;E<T&&u(m=t.charAt(E));)p+=m,E++;if((m=t.charAt(E))===u.delimiter)k+="<"+p+m,E++;else{if(v)return;E-=p.length+1,p=""}}if(!p){for(;E<T&&d(m=t.charAt(E));)p+=m,E++;k+=p}if(p){for(b=p,p="";E<T&&((m=t.charAt(E))===s||m===o||m===r);)p+=m,E++;if(f=null,'"'===(m=t.charAt(E))?f='"':"'"===m?f="'":"("===m&&(f=")"),f){if(!p)return;for(E=(k+=p+m).length,p="";E<T&&(m=t.charAt(E))!==f;){if(m===r){if(E++,(m=t.charAt(E))===r||m===f)return;p+=r}p+=m,E++}if((m=t.charAt(E))!==f)return;c=k,k+=p+m,E++,h=p,p=""}else p="",E=k.length;for(;E<T&&((m=t.charAt(E))===s||m===o);)k+=m,E++;return(m=t.charAt(E))&&m!==r?void 0:!!a||(n=e(n).test().end,b=y.decode.raw(y.unescape(b),n,{nonTerminated:!1}),h&&(c=e(c).test().end,h=y.decode.raw(y.unescape(h),c)),e(k)({type:"definition",identifier:i(g),title:h||null,url:b}))}}}}function u(e){return">"!==e&&"["!==e&&e!==l}function d(e){return"["!==e&&e!==l&&!n(e)}u.delimiter=">"},function(e,t,a){"use strict";var n=a(180);e.exports=function(e,t,a){var s,o,l,c,u,d,p,m,f,g,b,h,y,v,E,T,k,x,S,w,O,j,C,I;if(!this.options.gfm)return;s=0,x=0,d=t.length+1,p=[];for(;s<d;){if(j=t.indexOf(i,s),C=t.indexOf("|",s+1),-1===j&&(j=t.length),-1===C||C>j){if(x<2)return;break}p.push(t.slice(s,j)),x++,s=j+1}c=p.join(i),o=p.splice(1,1)[0]||[],s=0,d=o.length,x--,l=!1,b=[];for(;s<d;){if("|"===(f=o.charAt(s))){if(g=null,!1===l){if(!1===I)return}else b.push(l),l=!1;I=!1}else if("-"===f)g=!0,l=l||null;else if(":"===f)l=l===r?"center":g&&null===l?"right":r;else if(!n(f))return;s++}!1!==l&&b.push(l);if(b.length<1)return;if(a)return!0;k=-1,w=[],O=e(c).reset({type:"table",align:b,children:w});for(;++k<x;){for(S=p[k],u={type:"tableRow",children:[]},k&&e(i),e(S).reset(u,O),d=S.length+1,s=0,m="",h="",y=!0,v=null,E=null;s<d;)if("\t"!==(f=S.charAt(s))&&" "!==f){if(""===f||"|"===f)if(y)e(f);else{if(f&&E){m+=f,s++;continue}!h&&!f||y||(c=h,m.length>1&&(f?(c+=m.slice(0,m.length-1),m=m.charAt(m.length-1)):(c+=m,m="")),T=e.now(),e(c)({type:"tableCell",children:this.tokenizeInline(h,T)},u)),e(m+f),m="",h=""}else if(m&&(h+=m,m=""),h+=f,"\\"===f&&s!==d-2&&(h+=S.charAt(s+1),s++),"`"===f){for(v=1;S.charAt(s+1)===f;)h+=f,s++,v++;E?v>=E&&(E=0):E=v}y=!1,s++}else h?m+=f:e(f),s++;k||e(i+o)}return O};var i="\n",r="left"},function(e,t,a){"use strict";var n=a(303),i=a(481),r=a(483),s=a(484);e.exports=function(e,t,a){var l,c,u,d,p,m=this,f=m.options,g=f.commonmark,b=f.gfm,h=m.blockTokenizers,y=m.interruptParagraph,v=t.indexOf(o),E=t.length;for(;v<E;){if(-1===v){v=E;break}if(t.charAt(v+1)===o)break;if(g){for(d=0,l=v+1;l<E;){if("\t"===(u=t.charAt(l))){d=4;break}if(" "!==u)break;d++,l++}if(d>=4){v=t.indexOf(o,v+1);continue}}if(c=t.slice(v+1),s(y,h,m,[e,c,!0]))break;if(h.list.call(m,e,c,!0)&&(m.inList||g||b&&!i(n.left(c).charAt(0))))break;if(l=v,-1!==(v=t.indexOf(o,v+1))&&""===n(t.slice(l,v))){v=l;break}}if(c=t.slice(0,v),""===n(c))return e(c),null;if(a)return!0;return p=e.now(),c=r(c),e(c)({type:"paragraph",children:m.tokenizeInline(c,p)})};var o="\n"},function(e,t,a){"use strict";var n=a(995);function i(e,t,a){var n,i;if("\\"===t.charAt(0)&&(n=t.charAt(1),-1!==this.escape.indexOf(n)))return!!a||(i="\n"===n?{type:"break"}:{type:"text",value:n},e("\\"+n)(i))}e.exports=i,i.locator=n},function(e,t,a){"use strict";e.exports=function(e,t){return e.indexOf("\\",t)}},function(e,t,a){"use strict";var n=a(180),i=a(480),r=a(693);e.exports=l,l.locator=r,l.notInLink=!0;var s="mailto:",o=s.length;function l(e,t,a){var r,l,c,u,d,p,m,f,g,b,h,y;if("<"===t.charAt(0)){for(r=this,l="",c=t.length,u=0,d="",m=!1,f="",u++,l="<";u<c&&(p=t.charAt(u),!(n(p)||">"===p||"@"===p||":"===p&&"/"===t.charAt(u+1)));)d+=p,u++;if(d){if(f+=d,d="",f+=p=t.charAt(u),u++,"@"===p)m=!0;else{if(":"!==p||"/"!==t.charAt(u+1))return;f+="/",u++}for(;u<c&&(p=t.charAt(u),!n(p)&&">"!==p);)d+=p,u++;if(p=t.charAt(u),d&&">"===p)return!!a||(b=f+=d,l+=f+p,(g=e.now()).column++,g.offset++,m&&(f.slice(0,o).toLowerCase()===s?(b=b.substr(o),g.column+=o,g.offset+=o):f=s+f),h=r.inlineTokenizers,r.inlineTokenizers={text:h.text},y=r.enterLink(),b=r.tokenizeInline(b,g),r.inlineTokenizers=h,y(),e(l)({type:"link",title:null,url:i(f,{nonTerminated:!1}),children:b}))}}}},function(e,t,a){"use strict";var n=a(480),i=a(180),r=a(998);e.exports=c,c.locator=r,c.notInLink=!0;var s="mailto:",o=["http://","https://",s],l=o.length;function c(e,t,a){var r,c,u,d,p,m,f,g,b,h,y,v,E=this;if(E.options.gfm){for(r="",d=-1,g=l;++d<g;)if(m=o[d],(f=t.slice(0,m.length)).toLowerCase()===m){r=f;break}if(r){for(d=r.length,g=t.length,b="",h=0;d<g&&(u=t.charAt(d),!i(u)&&"<"!==u)&&("."!==u&&","!==u&&":"!==u&&";"!==u&&'"'!==u&&"'"!==u&&")"!==u&&"]"!==u||(y=t.charAt(d+1))&&!i(y))&&("("!==u&&"["!==u||h++,")"!==u&&"]"!==u||!(--h<0));)b+=u,d++;if(b){if(c=r+=b,m===s){if(-1===(p=b.indexOf("@"))||p===g-1)return;c=c.substr(s.length)}return!!a||(v=E.enterLink(),c=E.tokenizeInline(c,e.now()),v(),e(r)({type:"link",title:null,url:n(r,{nonTerminated:!1}),children:c}))}}}}},function(e,t,a){"use strict";e.exports=function(e,t){var a,i=n.length,r=-1,s=-1;if(!this.options.gfm)return-1;for(;++r<i;)-1!==(a=e.indexOf(n[r],t))&&(a<s||-1===s)&&(s=a);return s};var n=["https://","http://","mailto:"]},function(e,t,a){"use strict";var n=a(1e3),i=a(693),r=a(692).tag;e.exports=l,l.locator=i;var s=/^<a /i,o=/^<\/a>/i;function l(e,t,a){var i,l,c=this,u=t.length;if(!("<"!==t.charAt(0)||u<3)&&(i=t.charAt(1),(n(i)||"?"===i||"!"===i||"/"===i)&&(l=t.match(r))))return!!a||(l=l[0],!c.inLink&&s.test(l)?c.inLink=!0:c.inLink&&o.test(l)&&(c.inLink=!1),e(l)({type:"html",value:l}))}},function(e,t,a){e.exports=a(46)(515)},function(e,t,a){"use strict";var n=a(180),i=a(694);e.exports=m,m.locator=i;var r={}.hasOwnProperty,s="\\",o="(",l=")",c='"',u="'",d={};d['"']=c,d["'"]=u;var p={};function m(e,t,a){var i,c,u,m,f,g,b,h,y,v,E,T,k,x,S,w,O,j,C,I=this,M="",A=0,q=t.charAt(0),D=I.options.pedantic,P=I.options.commonmark,R=I.options.gfm;if("!"===q&&(y=!0,M=q,q=t.charAt(++A)),"["===q&&(y||!I.inLink)){for(M+=q,S="",A++,T=t.length,x=0,(O=e.now()).column+=A,O.offset+=A;A<T;){if(g=q=t.charAt(A),"`"===q){for(c=1;"`"===t.charAt(A+1);)g+=q,A++,c++;u?c>=u&&(u=0):u=c}else if(q===s)A++,g+=t.charAt(A);else if(u&&!R||"["!==q){if((!u||R)&&"]"===q){if(!x){if(!D)for(;A<T&&(q=t.charAt(A+1),n(q));)g+=q,A++;if(t.charAt(A+1)!==o)return;g+=o,i=!0,A++;break}x--}}else x++;S+=g,g="",A++}if(i){for(v=S,M+=S+g,A++;A<T&&(q=t.charAt(A),n(q));)M+=q,A++;if(q=t.charAt(A),h=P?p:d,S="",m=M,"<"===q){for(A++,m+="<";A<T&&">"!==(q=t.charAt(A));){if(P&&"\n"===q)return;S+=q,A++}if(">"!==t.charAt(A))return;M+="<"+S+">",w=S,A++}else{for(q=null,g="";A<T&&(q=t.charAt(A),!g||!r.call(h,q));){if(n(q)){if(!D)break;g+=q}else{if(q===o)x++;else if(q===l){if(0===x)break;x--}S+=g,g="",q===s&&(S+=s,q=t.charAt(++A)),S+=q}A++}w=S,A=(M+=S).length}for(S="";A<T&&(q=t.charAt(A),n(q));)S+=q,A++;if(q=t.charAt(A),M+=S,S&&r.call(h,q))if(A++,M+=q,S="",E=h[q],f=M,P){for(;A<T&&(q=t.charAt(A))!==E;)q===s&&(S+=s,q=t.charAt(++A)),A++,S+=q;if((q=t.charAt(A))!==E)return;for(k=S,M+=S+q,A++;A<T&&(q=t.charAt(A),n(q));)M+=q,A++}else for(g="";A<T;){if((q=t.charAt(A))===E)b&&(S+=E+g,g=""),b=!0;else if(b){if(q===l){M+=S+E+g,k=S;break}n(q)?g+=q:(S+=E+g+q,g="",b=!1)}else S+=q;A++}if(t.charAt(A)===l)return!!a||(M+=l,w=I.decode.raw(I.unescape(w),e(m).test().end,{nonTerminated:!1}),k&&(f=e(f).test().end,k=I.decode.raw(I.unescape(k),f)),C={type:y?"image":"link",title:k||null,url:w},y?C.alt=I.decode.raw(I.unescape(v),O)||null:(j=I.enterLink(),C.children=I.tokenizeInline(v,O),j()),e(M)(C))}}}p['"']=c,p["'"]=u,p["("]=l},function(e,t,a){"use strict";var n=a(180),i=a(694),r=a(485);e.exports=m,m.locator=i;var s="link",o="image",l="footnote",c="full",u="\\",d="[",p="]";function m(e,t,a){var i,m,f,g,b,h,y,v,E=this,T=t.charAt(0),k=0,x=t.length,S="",w="",O=s,j="shortcut";if("!"===T&&(O=o,w=T,T=t.charAt(++k)),T===d){if(k++,w+=T,h="",E.options.footnotes&&"^"===t.charAt(k)){if(O===o)return;w+="^",k++,O=l}for(v=0;k<x;){if((T=t.charAt(k))===d)y=!0,v++;else if(T===p){if(!v)break;v--}T===u&&(h+=u,T=t.charAt(++k)),h+=T,k++}if(S=h,i=h,(T=t.charAt(k))===p){for(k++,S+=T,h="";k<x&&(T=t.charAt(k),n(T));)h+=T,k++;if(T=t.charAt(k),O!==l&&T===d){for(m="",h+=T,k++;k<x&&(T=t.charAt(k))!==d&&T!==p;)T===u&&(m+=u,T=t.charAt(++k)),m+=T,k++;(T=t.charAt(k))===p?(j=m?c:"collapsed",h+=m+T,k++):m="",S+=h,h=""}else{if(!i)return;m=i}if(j===c||!y)return S=w+S,O===s&&E.inLink?null:!!a||(O===l&&-1!==i.indexOf(" ")?e(S)({type:"footnote",children:this.tokenizeInline(i,e.now())}):((f=e.now()).column+=w.length,f.offset+=w.length,g={type:O+"Reference",identifier:r(m=j===c?m:i)},O!==s&&O!==o||(g.referenceType=j),O===s?(b=E.enterLink(),g.children=E.tokenizeInline(i,f),b()):O===o&&(g.alt=E.decode.raw(E.unescape(i),f)||null),e(S)(g)))}}}},function(e,t,a){"use strict";var n=a(303),i=a(180),r=a(1004);e.exports=s,s.locator=r;function s(e,t,a){var r,s,o,l,c,u,d,p=0,m=t.charAt(p);if(!("*"!==m&&"_"!==m||t.charAt(++p)!==m||(s=this.options.pedantic,c=(o=m)+o,u=t.length,p++,l="",m="",s&&i(t.charAt(p)))))for(;p<u;){if(d=m,!((m=t.charAt(p))!==o||t.charAt(p+1)!==o||s&&i(d))&&(m=t.charAt(p+2))!==o){if(!n(l))return;return!!a||((r=e.now()).column+=2,r.offset+=2,e(c+l+c)({type:"strong",children:this.tokenizeInline(l,r)}))}s||"\\"!==m||(l+=m,m=t.charAt(++p)),l+=m,p++}}},function(e,t,a){"use strict";e.exports=function(e,t){var a=e.indexOf("**",t),n=e.indexOf("__",t);if(-1===n)return a;if(-1===a)return n;return n<a?n:a}},function(e,t,a){"use strict";var n=a(303),i=a(1006),r=a(180),s=a(1007);e.exports=o,o.locator=s;function o(e,t,a){var s,o,l,c,u,d,p,m=0,f=t.charAt(m);if(!("*"!==f&&"_"!==f||(o=this.options.pedantic,u=f,l=f,d=t.length,m++,c="",f="",o&&r(t.charAt(m)))))for(;m<d;){if(p=f,!((f=t.charAt(m))!==l||o&&r(p))){if((f=t.charAt(++m))!==l){if(!n(c)||p===l)return;if(!o&&"_"===l&&i(f)){c+=l;continue}return!!a||((s=e.now()).column++,s.offset++,e(u+c+l)({type:"emphasis",children:this.tokenizeInline(c,s)}))}c+=l}o||"\\"!==f||(c+=f,f=t.charAt(++m)),c+=f,m++}}},function(e,t,a){e.exports=a(46)(3105)},function(e,t,a){"use strict";e.exports=function(e,t){var a=e.indexOf("*",t),n=e.indexOf("_",t);if(-1===n)return a;if(-1===a)return n;return n<a?n:a}},function(e,t,a){"use strict";var n=a(180),i=a(1009);e.exports=s,s.locator=i;var r="~";function s(e,t,a){var i,s,o,l="",c="",u="",d="";if(this.options.gfm&&t.charAt(0)===r&&t.charAt(1)===r&&!n(t.charAt(2)))for(i=1,s=t.length,(o=e.now()).column+=2,o.offset+=2;++i<s;){if(!((l=t.charAt(i))!==r||c!==r||u&&n(u)))return!!a||e("~~"+d+"~~")({type:"delete",children:this.tokenizeInline(d,o)});d+=c,u=c,c=l}}},function(e,t,a){"use strict";e.exports=function(e,t){return e.indexOf("~~",t)}},function(e,t,a){"use strict";var n=a(180),i=a(1011);e.exports=s,s.locator=i;var r="`";function s(e,t,a){for(var i,s,o,l,c,u,d,p,m=t.length,f=0,g="",b="";f<m&&t.charAt(f)===r;)g+=r,f++;if(g){for(c=g,l=f,g="",p=t.charAt(f),o=0;f<m;){if(u=p,p=t.charAt(f+1),u===r?(o++,b+=u):(o=0,g+=u),o&&p!==r){if(o===l){c+=g+b,d=!0;break}g+=b,b=""}f++}if(!d){if(l%2!=0)return;g=""}if(a)return!0;for(i="",s="",m=g.length,f=-1;++f<m;)u=g.charAt(f),n(u)?s+=u:(s&&(i&&(i+=s),s=""),i+=u);return e(c)({type:"inlineCode",value:i})}}},function(e,t,a){"use strict";e.exports=function(e,t){return e.indexOf("`",t)}},function(e,t,a){"use strict";var n=a(1013);e.exports=i,i.locator=n;function i(e,t,a){for(var n,i=t.length,r=-1,s="";++r<i;){if("\n"===(n=t.charAt(r))){if(r<2)return;return!!a||e(s+=n)({type:"break"})}if(" "!==n)return;s+=n}}},function(e,t,a){"use strict";e.exports=function(e,t){var a=e.indexOf("\n",t);for(;a>t&&" "===e.charAt(a-1);)a--;return a}},function(e,t,a){"use strict";e.exports=function(e,t,a){var n,i,r,s,o,l,c,u,d,p,m=this;if(a)return!0;n=m.inlineMethods,s=n.length,i=m.inlineTokenizers,r=-1,d=t.length;for(;++r<s;)"text"!==(u=n[r])&&i[u]&&((c=i[u].locator)||e.file.fail("Missing locator: `"+u+"`"),-1!==(l=c.call(m,t,1))&&l<d&&(d=l));o=t.slice(0,d),p=e.now(),m.decode(o,p,(function(t,a,n){e(n||t)({type:"text",value:t})}))}},function(e,t,a){var n=a(1016);e.exports=function(){return function(e){return n(e,"list",(function(e,t){var a,n,i=0;for(a=0,n=t.length;a<n;a++)"list"===t[a].type&&(i+=1);for(a=0,n=e.children.length;a<n;a++){var r=e.children[a];r.index=a,r.ordered=e.ordered}e.depth=i})),e}}},function(e,t,a){"use strict";e.exports=function(e,t,a){var n=[];"function"==typeof t&&(a=t,t=null);function i(e){var r;return t&&e.type!==t||(r=a(e,n.concat())),e.children&&!1!==r?function(e,t){var a,r=e.length,s=-1;n.push(t);for(;++s<r;)if((a=e[s])&&!1===i(a))return!1;return n.pop(),!0}(e.children,e):r}i(e)}},function(e,t,a){"use strict";var n=a(391),i="virtualHtml",r=/^<(area|base|br|col|embed|hr|img|input|keygen|link|meta|param|source|track|wbr)\s*\/?>$/i,s=/^<(\/?)([a-z]+)\s*>$/;e.exports=function(e){var t,a;return n(e,"html",(function(e,n,o){a!==o&&(t=[],a=o);var l=function(e){var t=e.value.match(r);return!!t&&t[1]}(e);if(l)return o.children.splice(n,1,{type:i,tag:l,position:e.position}),!0;var c=function(e,t){var a=e.value.match(s);return!!a&&{tag:a[2],opening:!a[1],node:e}}(e);if(!c)return!0;var u=function(e,t){var a=e.length;for(;a--;)if(e[a].tag===t)return e.splice(a,1)[0];return!1}(t,c.tag);return u?o.children.splice(n,0,function(e,t,a){var n=a.children.indexOf(e.node),r=a.children.indexOf(t.node),s=a.children.splice(n,r-n+1).slice(1,-1);return{type:i,children:s,tag:e.tag,position:{start:e.node.position.start,end:t.node.position.end,indent:[]}}}(c,u,o)):c.opening||t.push(c),!0}),!0),e}},function(e,t,a){"use strict";var n=a(391);function i(e,t,a,n){if("remove"===n)a.children.splice(t,1);else if("unwrap"===n){var i=[t,1];e.children&&(i=i.concat(e.children)),Array.prototype.splice.apply(a.children,i)}}t.ofType=function(e,t){return function(t){return e.forEach((function(e){return n(t,e,a,!0)})),t};function a(e,a,n){n&&i(e,a,n,t)}},t.ifNotMatch=function(e,t){return function(e){return n(e,a,!0),e};function a(a,n,r){r&&!e(a,n,r)&&i(a,n,r,t)}}},function(e,t,a){"use strict";var n=a(9),i=a(248),r=a(553),s={start:{line:1,column:1,offset:0},end:{line:1,column:1,offset:0}};function o(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,c=t.renderers[e.type];void 0===e.position&&(e.position=a.node&&a.node.position||s);var u=e.position.start,d=[e.type,u.line,u.column,i].join("-");if(!r.isValidElementType(c))throw new Error("Renderer for type `".concat(e.type,"` not defined or is not renderable"));var p=l(e,d,t,c,a,i);return n.createElement(c,p,p.children||m()||void 0);function m(){return e.children&&e.children.map((function(a,n){return o(a,t,{node:e,props:p},n)}))}}function l(e,t,a,r,s,l){var u,d={key:t},p="string"==typeof r;a.sourcePos&&e.position&&(d["data-sourcepos"]=[(u=e.position).start.line,":",u.start.column,"-",u.end.line,":",u.end.column].map(String).join("")),a.rawSourcePos&&!p&&(d.sourcePosition=e.position),a.includeNodeIndex&&s.node&&s.node.children&&!p&&(d.index=s.node.children.indexOf(e),d.parentChildCount=s.node.children.length);var m=null!==e.identifier&&void 0!==e.identifier?a.definitions[e.identifier]||{}:null;switch(e.type){case"root":c(d,{className:a.className});break;case"text":d.nodeKey=t,d.children=e.value;break;case"heading":d.level=e.depth;break;case"list":d.start=e.start,d.ordered=e.ordered,d.tight=!e.loose,d.depth=e.depth;break;case"listItem":d.checked=e.checked,d.tight=!e.loose,d.ordered=e.ordered,d.index=e.index,d.children=function(e,t){if(e.loose)return e.children;if(t.node&&e.index>0&&t.node.children[e.index-1].loose)return e.children;return function(e){return e.children.reduce((function(e,t){return e.concat("paragraph"===t.type?t.children||[]:[t])}),[])}(e)}(e,s).map((function(t,n){return o(t,a,{node:e,props:d},n)}));break;case"definition":c(d,{identifier:e.identifier,title:e.title,url:e.url});break;case"code":c(d,{language:e.lang&&e.lang.split(/\s/,1)[0]});break;case"inlineCode":d.children=e.value,d.inline=!0;break;case"link":c(d,{title:e.title||void 0,target:"function"==typeof a.linkTarget?a.linkTarget(e.url,e.children,e.title):a.linkTarget,href:a.transformLinkUri?a.transformLinkUri(e.url,e.children,e.title):e.url});break;case"image":c(d,{alt:e.alt||void 0,title:e.title||void 0,src:a.transformImageUri?a.transformImageUri(e.url,e.children,e.title,e.alt):e.url});break;case"linkReference":c(d,i(m,{href:a.transformLinkUri?a.transformLinkUri(m.href):m.href}));break;case"imageReference":c(d,{src:a.transformImageUri&&m.href?a.transformImageUri(m.href,e.children,m.title,e.alt):m.href,title:m.title||void 0,alt:e.alt||void 0});break;case"table":case"tableHead":case"tableBody":d.columnAlignment=e.align;break;case"tableRow":d.isHeader="tableHead"===s.node.type,d.columnAlignment=s.props.columnAlignment;break;case"tableCell":c(d,{isHeader:s.props.isHeader,align:s.props.columnAlignment[l]});break;case"virtualHtml":d.tag=e.tag;break;case"html":d.isBlock=e.position.start.line!==e.position.end.line,d.escapeHtml=a.escapeHtml,d.skipHtml=a.skipHtml;break;case"parsedHtml":var f;e.children&&(f=e.children.map((function(t,n){return o(t,a,{node:e,props:d},n)}))),d.escapeHtml=a.escapeHtml,d.skipHtml=a.skipHtml,d.element=function(e,t){var a=e.element;if(Array.isArray(a)){var i=n.Fragment||"div";return n.createElement(i,null,a)}if(a.props.children||t){var r=n.Children.toArray(a.props.children).concat(t);return n.cloneElement(a,null,r)}return n.cloneElement(a,null)}(e,f);break;default:c(d,i(e,{type:void 0,position:void 0,children:void 0}))}return!p&&e.value&&(d.value=e.value),d}function c(e,t){for(var a in t)void 0!==t[a]&&(e[a]=t[a])}e.exports=o},function(e,t,a){"use strict";var n=a(391);function i(e){var t=e.children;e.children=[{type:"tableHead",align:e.align,children:[t[0]],position:t[0].position}],t.length>1&&e.children.push({type:"tableBody",align:e.align,children:t.slice(1),position:{start:t[1].position.start,end:t[t.length-1].position.end}})}e.exports=function(e){return n(e,"table",i),e}},function(e,t,a){"use strict";e.exports=function e(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(t.children||[]).reduce((function(t,a){return"definition"===a.type&&(t[a.identifier]={href:a.url,title:a.title}),e(a,t)}),a)}},function(e,t,a){"use strict";var n=["http","https","mailto","tel"];e.exports=function(e){var t=(e||"").trim(),a=t.charAt(0);if("#"===a||"/"===a)return t;var i=t.indexOf(":");if(-1===i)return t;for(var r=n.length,s=-1;++s<r;){var o=n[s];if(i===o.length&&t.slice(0,o.length).toLowerCase()===o)return t}return-1!==(s=t.indexOf("?"))&&i>s||-1!==(s=t.indexOf("#"))&&i>s?t:"javascript:void(0)"}},function(e,t,a){"use strict";var n=a(248),i=a(9),r=parseInt((i.version||"16").slice(0,2),10)>=16,s=i.createElement;function o(e,t){return s(e,l(t),t.children)}function l(e){return e["data-sourcepos"]?{"data-sourcepos":e["data-sourcepos"]}:{}}e.exports={break:"br",paragraph:"p",emphasis:"em",strong:"strong",thematicBreak:"hr",blockquote:"blockquote",delete:"del",link:"a",image:"img",linkReference:"a",imageReference:"img",table:o.bind(null,"table"),tableHead:o.bind(null,"thead"),tableBody:o.bind(null,"tbody"),tableRow:o.bind(null,"tr"),tableCell:function(e){var t=e.align?{textAlign:e.align}:void 0,a=l(e);return s(e.isHeader?"th":"td",t?n({style:t},a):a,e.children)},root:function(e){var t=!e.className,a=t&&i.Fragment||"div";return s(a,t?null:e,e.children)},text:function(e){return r?e.children:s("span",null,e.children)},list:function(e){var t=l(e);null!==e.start&&1!==e.start&&void 0!==e.start&&(t.start=e.start.toString());return s(e.ordered?"ol":"ul",t,e.children)},listItem:function(e){var t=null;if(null!==e.checked&&void 0!==e.checked){var a=e.checked;t=s("input",{type:"checkbox",checked:a,readOnly:!0})}return s("li",l(e),t,e.children)},definition:function(){return null},heading:function(e){return s("h".concat(e.level),l(e),e.children)},inlineCode:function(e){return s("code",l(e),e.children)},code:function(e){var t=e.language&&"language-".concat(e.language),a=s("code",t?{className:t}:null,e.value);return s("pre",l(e),a)},html:function(e){if(e.skipHtml)return null;var t=e.isBlock?"div":"span";if(e.escapeHtml){var a=i.Fragment||t;return s(a,null,e.value)}var n={dangerouslySetInnerHTML:{__html:e.value}};return s(t,n)},virtualHtml:function(e){return s(e.tag,l(e),e.children)},parsedHtml:function(e){return e["data-sourcepos"]?i.cloneElement(e.element,{"data-sourcepos":e["data-sourcepos"]}):e.element}}},function(e,t,a){"use strict";var n="__RMD_HTML_PARSER__";t.HtmlParser="undefined"==typeof Symbol?n:Symbol(n)},function(e,t,a){var n,i,r,s;
/*!
 * mustache.js - Logic-less {{mustache}} templates with JavaScript
 * http://github.com/janl/mustache.js
 */s=function(e){var t=Object.prototype.toString,a=Array.isArray||function(e){return"[object Array]"===t.call(e)};function n(e){return"function"==typeof e}function i(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function r(e,t){return null!=e&&"object"==typeof e&&t in e}var s=RegExp.prototype.test,o=/\S/;function l(e){return!function(e,t){return s.call(e,t)}(o,e)}var c={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"},u=/\s*/,d=/\s+/,p=/\s*=/,m=/\s*\}/,f=/#|\^|\/|>|\{|&|=|!/;function g(e){this.string=e,this.tail=e,this.pos=0}function b(e,t){this.view=e,this.cache={".":this.view},this.parent=t}function h(){this.cache={}}g.prototype.eos=function(){return""===this.tail},g.prototype.scan=function(e){var t=this.tail.match(e);if(!t||0!==t.index)return"";var a=t[0];return this.tail=this.tail.substring(a.length),this.pos+=a.length,a},g.prototype.scanUntil=function(e){var t,a=this.tail.search(e);switch(a){case-1:t=this.tail,this.tail="";break;case 0:t="";break;default:t=this.tail.substring(0,a),this.tail=this.tail.substring(a)}return this.pos+=t.length,t},b.prototype.push=function(e){return new b(e,this)},b.prototype.lookup=function(e){var t,a=this.cache;if(a.hasOwnProperty(e))t=a[e];else{for(var i,s,o=this,l=!1;o;){if(e.indexOf(".")>0)for(t=o.view,i=e.split("."),s=0;null!=t&&s<i.length;)s===i.length-1&&(l=r(t,i[s])),t=t[i[s++]];else t=o.view[e],l=r(o.view,e);if(l)break;o=o.parent}a[e]=t}return n(t)&&(t=t.call(this.view)),t},h.prototype.clearCache=function(){this.cache={}},h.prototype.parse=function(t,n){var r=this.cache,s=r[t];return null==s&&(s=r[t]=function(t,n){if(!t)return[];var r,s,o,c=[],b=[],h=[],y=!1,v=!1;function E(){if(y&&!v)for(;h.length;)delete b[h.pop()];else h=[];y=!1,v=!1}function T(e){if("string"==typeof e&&(e=e.split(d,2)),!a(e)||2!==e.length)throw new Error("Invalid tags: "+e);r=new RegExp(i(e[0])+"\\s*"),s=new RegExp("\\s*"+i(e[1])),o=new RegExp("\\s*"+i("}"+e[1]))}T(n||e.tags);for(var k,x,S,w,O,j,C=new g(t);!C.eos();){if(k=C.pos,S=C.scanUntil(r))for(var I=0,M=S.length;I<M;++I)l(w=S.charAt(I))?h.push(b.length):v=!0,b.push(["text",w,k,k+1]),k+=1,"\n"===w&&E();if(!C.scan(r))break;if(y=!0,x=C.scan(f)||"name",C.scan(u),"="===x?(S=C.scanUntil(p),C.scan(p),C.scanUntil(s)):"{"===x?(S=C.scanUntil(o),C.scan(m),C.scanUntil(s),x="&"):S=C.scanUntil(s),!C.scan(s))throw new Error("Unclosed tag at "+C.pos);if(O=[x,S,k,C.pos],b.push(O),"#"===x||"^"===x)c.push(O);else if("/"===x){if(!(j=c.pop()))throw new Error('Unopened section "'+S+'" at '+k);if(j[1]!==S)throw new Error('Unclosed section "'+j[1]+'" at '+k)}else"name"===x||"{"===x||"&"===x?v=!0:"="===x&&T(S)}if(j=c.pop())throw new Error('Unclosed section "'+j[1]+'" at '+C.pos);return function(e){for(var t,a=[],n=a,i=[],r=0,s=e.length;r<s;++r)switch((t=e[r])[0]){case"#":case"^":n.push(t),i.push(t),n=t[4]=[];break;case"/":i.pop()[5]=t[2],n=i.length>0?i[i.length-1][4]:a;break;default:n.push(t)}return a}(function(e){for(var t,a,n=[],i=0,r=e.length;i<r;++i)(t=e[i])&&("text"===t[0]&&a&&"text"===a[0]?(a[1]+=t[1],a[3]=t[3]):(n.push(t),a=t));return n}(b))}(t,n)),s},h.prototype.render=function(e,t,a){var n=this.parse(e),i=t instanceof b?t:new b(t);return this.renderTokens(n,i,a,e)},h.prototype.renderTokens=function(e,t,a,n){for(var i,r,s,o="",l=0,c=e.length;l<c;++l)s=void 0,"#"===(r=(i=e[l])[0])?s=this.renderSection(i,t,a,n):"^"===r?s=this.renderInverted(i,t,a,n):">"===r?s=this.renderPartial(i,t,a,n):"&"===r?s=this.unescapedValue(i,t):"name"===r?s=this.escapedValue(i,t):"text"===r&&(s=this.rawValue(i)),void 0!==s&&(o+=s);return o},h.prototype.renderSection=function(e,t,i,r){var s=this,o="",l=t.lookup(e[1]);if(l){if(a(l))for(var c=0,u=l.length;c<u;++c)o+=this.renderTokens(e[4],t.push(l[c]),i,r);else if("object"==typeof l||"string"==typeof l||"number"==typeof l)o+=this.renderTokens(e[4],t.push(l),i,r);else if(n(l)){if("string"!=typeof r)throw new Error("Cannot use higher-order sections without the original template");null!=(l=l.call(t.view,r.slice(e[3],e[5]),(function(e){return s.render(e,t,i)})))&&(o+=l)}else o+=this.renderTokens(e[4],t,i,r);return o}},h.prototype.renderInverted=function(e,t,n,i){var r=t.lookup(e[1]);if(!r||a(r)&&0===r.length)return this.renderTokens(e[4],t,n,i)},h.prototype.renderPartial=function(e,t,a){if(a){var i=n(a)?a(e[1]):a[e[1]];return null!=i?this.renderTokens(this.parse(i),t,a,i):void 0}},h.prototype.unescapedValue=function(e,t){var a=t.lookup(e[1]);if(null!=a)return a},h.prototype.escapedValue=function(t,a){var n=a.lookup(t[1]);if(null!=n)return e.escape(n)},h.prototype.rawValue=function(e){return e[1]},e.name="mustache.js",e.version="2.3.2",e.tags=["{{","}}"];var y=new h;return e.clearCache=function(){return y.clearCache()},e.parse=function(e,t){return y.parse(e,t)},e.render=function(e,t,n){if("string"!=typeof e)throw new TypeError('Invalid template! Template should be a "string" but "'+(a(i=e)?"array":typeof i)+'" was given as the first argument for mustache#render(template, view, partials)');var i;return y.render(e,t,n)},e.to_html=function(t,a,i,r){var s=e.render(t,a,i);if(!n(r))return s;r(s)},e.escape=function(e){return String(e).replace(/[&<>"'`=\/]/g,(function(e){return c[e]}))},e.Scanner=g,e.Context=b,e.Writer=h,e},t&&"string"!=typeof t.nodeName?s(t):(i=[t],void 0===(r="function"==typeof(n=s)?n.apply(t,i):n)||(e.exports=r))},function(e,t,a){e.exports=a.p+"ae37f7e28b2ba3954b127510d84d3ac5.svg"},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(1028);Object.keys(n).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===n[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return n[e]}}))})),Object({IS_KIBANA_DISTRIBUTABLE:"true"}).RTL_SKIP_AUTO_CLEANUP||("function"==typeof afterEach?afterEach((()=>{(0,n.cleanup)()})):"function"==typeof teardown&&teardown((()=>{(0,n.cleanup)()})))},function(e,t,a){"use strict";var n=a(157),i=a(258);Object.defineProperty(t,"__esModule",{value:!0});var r={render:!0,cleanup:!0,act:!0,fireEvent:!0};t.render=function e(t,{container:a,baseElement:n=a,queries:i,hydrate:r=!1,wrapper:u}={}){n||(n=document.body);a||(a=n.appendChild(document.createElement("div")));d.add(a);const p=e=>u?s.createElement(u,null,e):e;return(0,c.default)((()=>{r?o.default.hydrate(p(t),a):o.default.render(p(t),a)})),{container:a,baseElement:n,debug:(e=n,t,a)=>Array.isArray(e)?e.forEach((e=>console.log((0,l.prettyDOM)(e,t,a)))):console.log((0,l.prettyDOM)(e,t,a)),unmount:()=>{(0,c.default)((()=>{o.default.unmountComponentAtNode(a)}))},rerender:t=>{e(p(t),{container:a,baseElement:n})},asFragment:()=>{if("function"==typeof document.createRange)return document.createRange().createContextualFragment(a.innerHTML);{const e=document.createElement("template");return e.innerHTML=a.innerHTML,e.content}},...(0,l.getQueriesForElement)(n,i)}},t.cleanup=function(){d.forEach(p)},Object.defineProperty(t,"act",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(t,"fireEvent",{enumerable:!0,get:function(){return u.fireEvent}});var s=i(a(9)),o=n(a(71)),l=a(697);Object.keys(l).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(r,e)||e in t&&t[e]===l[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return l[e]}}))}));var c=i(a(1337)),u=a(1342);(0,l.configure)({asyncWrapper:async e=>{let t;return await(0,c.asyncAct)((async()=>{t=await e()})),t},eventWrapper:e=>{let t;return(0,c.default)((()=>{t=e()})),t}});const d=new Set;function p(e){(0,c.default)((()=>{o.default.unmountComponentAtNode(e)})),e.parentNode===document.body&&document.body.removeChild(e),d.delete(e)}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.findByLabelText=t.findAllByLabelText=t.getByLabelText=t.getAllByLabelText=t.queryByLabelText=t.queryAllByLabelText=void 0;var n=a(204),i=a(161),r=a(702),s=a(249);function o(e,t,{exact:a=!0,trim:n,collapseWhitespace:i,normalizer:o}={}){const l=a?s.matches:s.fuzzyMatches,c=(0,s.makeNormalizer)({collapseWhitespace:i,trim:n,normalizer:o}),u=function(e){return Array.from(e.querySelectorAll("label,input")).map((e=>({node:e,textToMatch:(0,r.getLabelContent)(e)}))).filter((({textToMatch:e})=>null!==e))}(e);return u.filter((({node:e,textToMatch:a})=>l(a,e,t,c))).map((({node:e})=>e))}function l(e,t,{selector:a="*",exact:n=!0,collapseWhitespace:o,trim:l,normalizer:c}={}){(0,i.checkContainerType)(e);const u=n?s.matches:s.fuzzyMatches,d=(0,s.makeNormalizer)({collapseWhitespace:o,trim:l,normalizer:c}),p=Array.from(e.querySelectorAll("*")).filter((e=>(0,r.getRealLabels)(e).length||e.hasAttribute("aria-labelledby"))).reduce(((n,i)=>{const s=(0,r.getLabels)(e,i,{selector:a});s.filter((e=>Boolean(e.formControl))).forEach((e=>{u(e.content,e.formControl,t,d)&&n.push(e.formControl)}));const o=s.filter((e=>Boolean(e.content))).map((e=>e.content));return u(o.join(" "),i,t,d)&&n.push(i),o.length>1&&o.forEach(((e,a)=>{u(e,i,t,d)&&n.push(i);const r=[...o];r.splice(a,1),r.length>1&&u(r.join(" "),i,t,d)&&n.push(i)})),n}),[]).concat((0,s.queryAllByAttribute)("aria-label",e,t,{exact:n,normalizer:d}));return Array.from(new Set(p)).filter((e=>e.matches(a)))}const c=(e,t,...a)=>{const i=l(e,t,...a);if(!i.length){const i=o(e,t,...a);if(i.length){const a=i.map((t=>function(e,t){const a=t.getAttribute("for");if(!a)return null;const n=e.querySelector(`[id="${a}"]`);return n?n.tagName.toLowerCase():null}(e,t))).filter((e=>!!e));throw a.length?(0,n.getConfig)().getElementError(a.map((e=>`Found a label with the text of: ${t}, however the element associated with this label (<${e} />) is non-labellable [https://html.spec.whatwg.org/multipage/forms.html#category-label]. If you really need to label a <${e} />, you can use aria-label or aria-labelledby instead.`)).join("\n\n"),e):(0,n.getConfig)().getElementError(`Found a label with the text of: ${t}, however no form control was found associated to that label. Make sure you're using the "for" attribute or "aria-labelledby" attribute correctly.`,e)}throw(0,n.getConfig)().getElementError(`Unable to find a label with the text of: ${t}`,e)}return i};const u=(e,t)=>`Found multiple elements with the text of: ${t}`,d=(0,s.wrapSingleQueryWithSuggestion)((0,s.makeSingleQuery)(l,u),l.name,"query");t.queryByLabelText=d;const p=(0,s.makeSingleQuery)(c,u),m=(0,s.makeFindQuery)((0,s.wrapAllByQueryWithSuggestion)(c,c.name,"findAll"));t.findAllByLabelText=m;const f=(0,s.makeFindQuery)((0,s.wrapSingleQueryWithSuggestion)(p,c.name,"find"));t.findByLabelText=f;const g=(0,s.wrapAllByQueryWithSuggestion)(c,c.name,"getAll");t.getAllByLabelText=g;const b=(0,s.wrapSingleQueryWithSuggestion)(p,c.name,"get");t.getByLabelText=b;const h=(0,s.wrapAllByQueryWithSuggestion)(l,l.name,"queryAll");t.queryAllByLabelText=h},function(e,t,a){"use strict";var n=p(a(699)),i=a(393),r=p(a(1034)),s=p(a(1035)),o=p(a(1037)),l=p(a(1038)),c=p(a(1040)),u=p(a(1041)),d=p(a(1044));function p(e){return e&&e.__esModule?e:{default:e}}const m=Object.prototype.toString,f=Date.prototype.toISOString,g=Error.prototype.toString,b=RegExp.prototype.toString,h=e=>"function"==typeof e.constructor&&e.constructor.name||"Object",y=/^Symbol\((.*)\)(.*)$/,v=/\n/gi;class PrettyFormatPluginError extends Error{constructor(e,t){super(e),this.stack=t,this.name=this.constructor.name}}function E(e,t){return t?"[Function "+(e.name||"anonymous")+"]":"[Function]"}function T(e){return String(e).replace(y,"Symbol($1)")}function k(e){return"["+g.call(e)+"]"}function x(e,t,a,n){if(!0===e||!1===e)return""+e;if(void 0===e)return"undefined";if(null===e)return"null";const i=typeof e;if("number"===i)return function(e){return Object.is(e,-0)?"-0":String(e)}(e);if("bigint"===i)return function(e){return String(`${e}n`)}(e);if("string"===i)return n?'"'+e.replace(/"|\\/g,"\\$&")+'"':'"'+e+'"';if("function"===i)return E(e,t);if("symbol"===i)return T(e);const r=m.call(e);return"[object WeakMap]"===r?"WeakMap {}":"[object WeakSet]"===r?"WeakSet {}":"[object Function]"===r||"[object GeneratorFunction]"===r?E(e,t):"[object Symbol]"===r?T(e):"[object Date]"===r?isNaN(+e)?"Date { NaN }":f.call(e):"[object Error]"===r?k(e):"[object RegExp]"===r?a?b.call(e).replace(/[\\^$*+?.()|[\]{}]/g,"\\$&"):b.call(e):e instanceof Error?k(e):null}function S(e,t,a,n,r,s){if(-1!==r.indexOf(e))return"[Circular]";(r=r.slice()).push(e);const o=++n>t.maxDepth,l=t.min;if(t.callToJSON&&!o&&e.toJSON&&"function"==typeof e.toJSON&&!s)return j(e.toJSON(),t,a,n,r,!0);const c=m.call(e);return"[object Arguments]"===c?o?"[Arguments]":(l?"":"Arguments ")+"["+(0,i.printListItems)(e,t,a,n,r,j)+"]":function(e){return"[object Array]"===e||"[object ArrayBuffer]"===e||"[object DataView]"===e||"[object Float32Array]"===e||"[object Float64Array]"===e||"[object Int8Array]"===e||"[object Int16Array]"===e||"[object Int32Array]"===e||"[object Uint8Array]"===e||"[object Uint8ClampedArray]"===e||"[object Uint16Array]"===e||"[object Uint32Array]"===e}(c)?o?"["+e.constructor.name+"]":(l?"":e.constructor.name+" ")+"["+(0,i.printListItems)(e,t,a,n,r,j)+"]":"[object Map]"===c?o?"[Map]":"Map {"+(0,i.printIteratorEntries)(e.entries(),t,a,n,r,j," => ")+"}":"[object Set]"===c?o?"[Set]":"Set {"+(0,i.printIteratorValues)(e.values(),t,a,n,r,j)+"}":o||(e=>"undefined"!=typeof window&&e===window)(e)?"["+h(e)+"]":(l?"":h(e)+" ")+"{"+(0,i.printObjectProperties)(e,t,a,n,r,j)+"}"}function w(e,t,a,n,i,r){let s;try{s=function(e){return null!=e.serialize}(e)?e.serialize(t,a,n,i,r,j):e.print(t,(e=>j(e,a,n,i,r)),(e=>{const t=n+a.indent;return t+e.replace(v,"\n"+t)}),{edgeSpacing:a.spacingOuter,min:a.min,spacing:a.spacingInner},a.colors)}catch(e){throw new PrettyFormatPluginError(e.message,e.stack)}if("string"!=typeof s)throw new Error(`pretty-format: Plugin must return type "string" but instead returned "${typeof s}".`);return s}function O(e,t){for(let a=0;a<e.length;a++)try{if(e[a].test(t))return e[a]}catch(e){throw new PrettyFormatPluginError(e.message,e.stack)}return null}function j(e,t,a,n,i,r){const s=O(t.plugins,e);if(null!==s)return w(s,e,t,a,n,i);const o=x(e,t.printFunctionName,t.escapeRegex,t.escapeString);return null!==o?o:S(e,t,a,n,i,r)}const C={comment:"gray",content:"reset",prop:"yellow",tag:"cyan",value:"green"},I=Object.keys(C),M={callToJSON:!0,escapeRegex:!1,escapeString:!0,highlight:!1,indent:2,maxDepth:1/0,min:!1,plugins:[],printFunctionName:!0,theme:C};const A=e=>I.reduce(((t,a)=>{const i=e.theme&&void 0!==e.theme[a]?e.theme[a]:C[a],r=i&&n.default[i];if(!r||"string"!=typeof r.close||"string"!=typeof r.open)throw new Error(`pretty-format: Option "theme" has a key "${a}" whose value "${i}" is undefined in ansi-styles.`);return t[a]=r,t}),Object.create(null)),q=e=>e&&void 0!==e.printFunctionName?e.printFunctionName:M.printFunctionName,D=e=>e&&void 0!==e.escapeRegex?e.escapeRegex:M.escapeRegex,P=e=>e&&void 0!==e.escapeString?e.escapeString:M.escapeString,R=e=>{return{callToJSON:e&&void 0!==e.callToJSON?e.callToJSON:M.callToJSON,colors:e&&e.highlight?A(e):I.reduce(((e,t)=>(e[t]={close:"",open:""},e)),Object.create(null)),escapeRegex:D(e),escapeString:P(e),indent:e&&e.min?"":(t=e&&void 0!==e.indent?e.indent:M.indent,new Array(t+1).join(" ")),maxDepth:e&&void 0!==e.maxDepth?e.maxDepth:M.maxDepth,min:e&&void 0!==e.min?e.min:M.min,plugins:e&&void 0!==e.plugins?e.plugins:M.plugins,printFunctionName:q(e),spacingInner:e&&e.min?" ":"\n",spacingOuter:e&&e.min?"":"\n"};var t};function F(e,t){if(t&&(function(e){if(Object.keys(e).forEach((e=>{if(!M.hasOwnProperty(e))throw new Error(`pretty-format: Unknown option "${e}".`)})),e.min&&void 0!==e.indent&&0!==e.indent)throw new Error('pretty-format: Options "min" and "indent" cannot be used together.');if(void 0!==e.theme){if(null===e.theme)throw new Error('pretty-format: Option "theme" must not be null.');if("object"!=typeof e.theme)throw new Error(`pretty-format: Option "theme" must be of type "object" but instead received "${typeof e.theme}".`)}}(t),t.plugins)){const a=O(t.plugins,e);if(null!==a)return w(a,e,R(t),"",0,[])}const a=x(e,q(t),D(t),P(t));return null!==a?a:S(e,R(t),"",0,[])}F.plugins={AsymmetricMatcher:r.default,ConvertAnsi:s.default,DOMCollection:o.default,DOMElement:l.default,Immutable:c.default,ReactElement:u.default,ReactTestComponent:d.default},e.exports=F},function(e,t,a){const n=a(700),i=a(1033),r={};Object.keys(n).forEach((e=>{r[e]={},Object.defineProperty(r[e],"channels",{value:n[e].channels}),Object.defineProperty(r[e],"labels",{value:n[e].labels});const t=i(e);Object.keys(t).forEach((a=>{const n=t[a];r[e][a]=function(e){const t=function(...t){const a=t[0];if(null==a)return a;a.length>1&&(t=a);const n=e(t);if("object"==typeof n)for(let e=n.length,t=0;t<e;t++)n[t]=Math.round(n[t]);return n};return"conversion"in e&&(t.conversion=e.conversion),t}(n),r[e][a].raw=function(e){const t=function(...t){const a=t[0];return null==a?a:(a.length>1&&(t=a),e(t))};return"conversion"in e&&(t.conversion=e.conversion),t}(n)}))})),e.exports=r},function(e,t,a){"use strict";e.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},function(e,t,a){const n=a(700);function i(e){const t=function(){const e={},t=Object.keys(n);for(let a=t.length,n=0;n<a;n++)e[t[n]]={distance:-1,parent:null};return e}(),a=[e];for(t[e].distance=0;a.length;){const e=a.pop(),i=Object.keys(n[e]);for(let n=i.length,r=0;r<n;r++){const n=i[r],s=t[n];-1===s.distance&&(s.distance=t[e].distance+1,s.parent=e,a.unshift(n))}}return t}function r(e,t){return function(a){return t(e(a))}}function s(e,t){const a=[t[e].parent,e];let i=n[t[e].parent][e],s=t[e].parent;for(;t[s].parent;)a.unshift(t[s].parent),i=r(n[t[s].parent][s],i),s=t[s].parent;return i.conversion=a,i}e.exports=function(e){const t=i(e),a={},n=Object.keys(t);for(let e=n.length,i=0;i<e;i++){const e=n[i];null!==t[e].parent&&(a[e]=s(e,t))}return a}},function(e,t,a){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.test=t.serialize=void 0;var n=a(393),i=e["jest-symbol-do-not-touch"]||e.Symbol;const r="function"==typeof i&&i.for?i.for("jest.asymmetricMatcher"):1267621,s=" ",o=(e,t,a,i,r,o)=>{const l=e.toString();return"ArrayContaining"===l||"ArrayNotContaining"===l?++i>t.maxDepth?"["+l+"]":l+s+"["+(0,n.printListItems)(e.sample,t,a,i,r,o)+"]":"ObjectContaining"===l||"ObjectNotContaining"===l?++i>t.maxDepth?"["+l+"]":l+s+"{"+(0,n.printObjectProperties)(e.sample,t,a,i,r,o)+"}":"StringMatching"===l||"StringNotMatching"===l||"StringContaining"===l||"StringNotContaining"===l?l+s+o(e.sample,t,a,i,r):e.toAsymmetricMatcher()};t.serialize=o;const l=e=>e&&e.$$typeof===r;t.test=l;var c={serialize:o,test:l};t.default=c}).call(this,a(239))},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.serialize=t.test=void 0;var n=r(a(1036)),i=r(a(699));function r(e){return e&&e.__esModule?e:{default:e}}const s=e=>"string"==typeof e&&!!e.match((0,n.default)());t.test=s;const o=(e,t,a,r,s,o)=>o(e.replace((0,n.default)(),(e=>{switch(e){case i.default.red.close:case i.default.green.close:case i.default.cyan.close:case i.default.gray.close:case i.default.white.close:case i.default.yellow.close:case i.default.bgRed.close:case i.default.bgGreen.close:case i.default.bgYellow.close:case i.default.inverse.close:case i.default.dim.close:case i.default.bold.close:case i.default.reset.open:case i.default.reset.close:return"</>";case i.default.red.open:return"<red>";case i.default.green.open:return"<green>";case i.default.cyan.open:return"<cyan>";case i.default.gray.open:return"<gray>";case i.default.white.open:return"<white>";case i.default.yellow.open:return"<yellow>";case i.default.bgRed.open:return"<bgRed>";case i.default.bgGreen.open:return"<bgGreen>";case i.default.bgYellow.open:return"<bgYellow>";case i.default.inverse.open:return"<inverse>";case i.default.dim.open:return"<dim>";case i.default.bold.open:return"<bold>";default:return""}})),t,a,r,s);t.serialize=o;var l={serialize:o,test:s};t.default=l},function(e,t,a){"use strict";e.exports=({onlyFirst:e=!1}={})=>{const t=["[\\u001B\\u009B][[\\]()#;?]*(?:(?:(?:(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]+)*|[a-zA-Z\\d]+(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]*)*)?\\u0007)","(?:(?:\\d{1,4}(?:;\\d{0,4})*)?[\\dA-PR-TZcf-ntqry=><~]))"].join("|");return new RegExp(t,e?void 0:"g")}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.serialize=t.test=void 0;var n=a(393);const i=["DOMStringMap","NamedNodeMap"],r=/^(HTML\w*Collection|NodeList)$/,s=e=>{return e&&e.constructor&&!!e.constructor.name&&(t=e.constructor.name,-1!==i.indexOf(t)||r.test(t));var t};t.test=s;const o=(e,t,a,r,s,o)=>{const l=e.constructor.name;return++r>t.maxDepth?"["+l+"]":(t.min?"":l+" ")+(-1!==i.indexOf(l)?"{"+(0,n.printObjectProperties)((e=>"NamedNodeMap"===e.constructor.name)(e)?Array.from(e).reduce(((e,t)=>(e[t.name]=t.value,e)),{}):{...e},t,a,r,s,o)+"}":"["+(0,n.printListItems)(Array.from(e),t,a,r,s,o)+"]")};t.serialize=o;var l={serialize:o,test:s};t.default=l},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.serialize=t.test=void 0;var n=a(489);const i=/^((HTML|SVG)\w*)?Element$/,r=e=>{var t;return(null==e||null===(t=e.constructor)||void 0===t?void 0:t.name)&&(e=>{var t;const a=e.constructor.name,{nodeType:n,tagName:r}=e,s="string"==typeof r&&r.includes("-")||(null===(t=e.hasAttribute)||void 0===t?void 0:t.call(e,"is"));return 1===n&&(i.test(a)||s)||3===n&&"Text"===a||8===n&&"Comment"===a||11===n&&"DocumentFragment"===a})(e)};function s(e){return 11===e.nodeType}t.test=r;const o=(e,t,a,i,r,o)=>{if(function(e){return 3===e.nodeType}(e))return(0,n.printText)(e.data,t);if(function(e){return 8===e.nodeType}(e))return(0,n.printComment)(e.data,t);const l=s(e)?"DocumentFragment":e.tagName.toLowerCase();return++i>t.maxDepth?(0,n.printElementAsLeaf)(l,t):(0,n.printElement)(l,(0,n.printProps)(s(e)?[]:Array.from(e.attributes).map((e=>e.name)).sort(),s(e)?{}:Array.from(e.attributes).reduce(((e,t)=>(e[t.name]=t.value,e)),{}),t,a+t.indent,i,r,o),(0,n.printChildren)(Array.prototype.slice.call(e.childNodes||e.children),t,a+t.indent,i,r,o),t,a)};t.serialize=o;var l={serialize:o,test:r};t.default=l},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e.replace(/</g,"&lt;").replace(/>/g,"&gt;")}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.test=t.serialize=void 0;var n=a(393);const i="@@__IMMUTABLE_ORDERED__@@",r=e=>"Immutable."+e,s=e=>"["+e+"]",o=" ";const l=(e,t,a,i,l,c,u)=>++i>t.maxDepth?s(r(u)):r(u)+o+"["+(0,n.printIteratorValues)(e.values(),t,a,i,l,c)+"]",c=(e,t,a,c,u,d)=>e["@@__IMMUTABLE_MAP__@@"]?((e,t,a,i,l,c,u)=>++i>t.maxDepth?s(r(u)):r(u)+o+"{"+(0,n.printIteratorEntries)(e.entries(),t,a,i,l,c)+"}")(e,t,a,c,u,d,e[i]?"OrderedMap":"Map"):e["@@__IMMUTABLE_LIST__@@"]?l(e,t,a,c,u,d,"List"):e["@@__IMMUTABLE_SET__@@"]?l(e,t,a,c,u,d,e[i]?"OrderedSet":"Set"):e["@@__IMMUTABLE_STACK__@@"]?l(e,t,a,c,u,d,"Stack"):e["@@__IMMUTABLE_SEQ__@@"]?((e,t,a,i,l,c)=>{const u=r("Seq");return++i>t.maxDepth?s(u):e["@@__IMMUTABLE_KEYED__@@"]?u+o+"{"+(e._iter||e._object?(0,n.printIteratorEntries)(e.entries(),t,a,i,l,c):"…")+"}":u+o+"["+(e._iter||e._array||e._collection||e._iterable?(0,n.printIteratorValues)(e.values(),t,a,i,l,c):"…")+"]"})(e,t,a,c,u,d):((e,t,a,i,l,c)=>{const u=r(e._name||"Record");return++i>t.maxDepth?s(u):u+o+"{"+(0,n.printIteratorEntries)(function(e){let t=0;return{next(){if(t<e._keys.length){const a=e._keys[t++];return{done:!1,value:[a,e.get(a)]}}return{done:!0,value:void 0}}}}(e),t,a,i,l,c)+"}"})(e,t,a,c,u,d);t.serialize=c;const u=e=>e&&(!0===e["@@__IMMUTABLE_ITERABLE__@@"]||!0===e["@@__IMMUTABLE_RECORD__@@"]);t.test=u;var d={serialize:c,test:u};t.default=d},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.test=t.serialize=void 0;var n=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=r();if(t&&t.has(e))return t.get(e);var a={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var s=n?Object.getOwnPropertyDescriptor(e,i):null;s&&(s.get||s.set)?Object.defineProperty(a,i,s):a[i]=e[i]}a.default=e,t&&t.set(e,a);return a}(a(1042)),i=a(489);function r(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return r=function(){return e},e}const s=(e,t=[])=>(Array.isArray(e)?e.forEach((e=>{s(e,t)})):null!=e&&!1!==e&&t.push(e),t),o=e=>{const t=e.type;if("string"==typeof t)return t;if("function"==typeof t)return t.displayName||t.name||"Unknown";if(n.isFragment(e))return"React.Fragment";if(n.isSuspense(e))return"React.Suspense";if("object"==typeof t&&null!==t){if(n.isContextProvider(e))return"Context.Provider";if(n.isContextConsumer(e))return"Context.Consumer";if(n.isForwardRef(e)){if(t.displayName)return t.displayName;const e=t.render.displayName||t.render.name||"";return""!==e?"ForwardRef("+e+")":"ForwardRef"}if(n.isMemo(e)){const e=t.displayName||t.type.displayName||t.type.name||"";return""!==e?"Memo("+e+")":"Memo"}}return"UNDEFINED"},l=(e,t,a,n,r,l)=>++n>t.maxDepth?(0,i.printElementAsLeaf)(o(e),t):(0,i.printElement)(o(e),(0,i.printProps)((e=>{const{props:t}=e;return Object.keys(t).filter((e=>"children"!==e&&void 0!==t[e])).sort()})(e),e.props,t,a+t.indent,n,r,l),(0,i.printChildren)(s(e.props.children),t,a+t.indent,n,r,l),t,a);t.serialize=l;const c=e=>e&&n.isElement(e);t.test=c;var u={serialize:l,test:c};t.default=u},function(e,t,a){"use strict";e.exports=a(1043)},function(e,t,a){"use strict";
/** @license React v17.0.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var n=60103,i=60106,r=60107,s=60108,o=60114,l=60109,c=60110,u=60112,d=60113,p=60120,m=60115,f=60116,g=60121,b=60122,h=60117,y=60129,v=60131;if("function"==typeof Symbol&&Symbol.for){var E=Symbol.for;n=E("react.element"),i=E("react.portal"),r=E("react.fragment"),s=E("react.strict_mode"),o=E("react.profiler"),l=E("react.provider"),c=E("react.context"),u=E("react.forward_ref"),d=E("react.suspense"),p=E("react.suspense_list"),m=E("react.memo"),f=E("react.lazy"),g=E("react.block"),b=E("react.server.block"),h=E("react.fundamental"),y=E("react.debug_trace_mode"),v=E("react.legacy_hidden")}function T(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case n:switch(e=e.type){case r:case o:case s:case d:case p:return e;default:switch(e=e&&e.$$typeof){case c:case u:case f:case m:case l:return e;default:return t}}case i:return t}}}var k=l,x=n,S=u,w=r,O=f,j=m,C=i,I=o,M=s,A=d;t.ContextConsumer=c,t.ContextProvider=k,t.Element=x,t.ForwardRef=S,t.Fragment=w,t.Lazy=O,t.Memo=j,t.Portal=C,t.Profiler=I,t.StrictMode=M,t.Suspense=A,t.isAsyncMode=function(){return!1},t.isConcurrentMode=function(){return!1},t.isContextConsumer=function(e){return T(e)===c},t.isContextProvider=function(e){return T(e)===l},t.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===n},t.isForwardRef=function(e){return T(e)===u},t.isFragment=function(e){return T(e)===r},t.isLazy=function(e){return T(e)===f},t.isMemo=function(e){return T(e)===m},t.isPortal=function(e){return T(e)===i},t.isProfiler=function(e){return T(e)===o},t.isStrictMode=function(e){return T(e)===s},t.isSuspense=function(e){return T(e)===d},t.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===r||e===o||e===y||e===s||e===d||e===p||e===v||"object"==typeof e&&null!==e&&(e.$$typeof===f||e.$$typeof===m||e.$$typeof===l||e.$$typeof===c||e.$$typeof===u||e.$$typeof===h||e.$$typeof===g||e[0]===b)},t.typeOf=T},function(e,t,a){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.test=t.serialize=void 0;var n=a(489),i=e["jest-symbol-do-not-touch"]||e.Symbol;const r="function"==typeof i&&i.for?i.for("react.test.json"):245830487,s=(e,t,a,i,r,s)=>++i>t.maxDepth?(0,n.printElementAsLeaf)(e.type,t):(0,n.printElement)(e.type,e.props?(0,n.printProps)((e=>{const{props:t}=e;return t?Object.keys(t).filter((e=>void 0!==t[e])).sort():[]})(e),e.props,t,a+t.indent,i,r,s):"",e.children?(0,n.printChildren)(e.children,t,a+t.indent,i,r,s):"",t,a);t.serialize=s;const o=e=>e&&e.$$typeof===r;t.test=o;var l={serialize:s,test:o};t.default=l}).call(this,a(239))},function(e,t,a){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.getUserCodeFrame=function(){if(!n||!i)return"";const e=new Error;return function(e){const t=e.indexOf("(")+1,r=e.indexOf(")"),s=e.slice(t,r),o=s.split(":"),[l,c,u]=[o[0],parseInt(o[1],10),parseInt(o[2],10)];let d="";try{d=n(l,"utf-8")}catch{return""}const p=i(d,{start:{line:c,column:u}},{highlightCode:!0,linesBelow:0});return`${a.dim(s)}\n${p}\n`}(e.stack.split("\n").slice(1).find((e=>!e.includes("node_modules/"))))};let a=null,n=null,i=null;try{const t=e&&e.require;n=t.call(e,"fs").readFileSync,i=t.call(e,"@babel/code-frame").codeFrameColumns,a=t.call(e,"chalk")}catch{}}).call(this,a(226)(e))},function(e,t,a){(function(e,t){!function(e,a){"use strict";if(!e.setImmediate){var n,i,r,s,o,l=1,c={},u=!1,d=e.document,p=Object.getPrototypeOf&&Object.getPrototypeOf(e);p=p&&p.setTimeout?p:e,"[object process]"==={}.toString.call(e.process)?n=function(e){t.nextTick((function(){f(e)}))}:!function(){if(e.postMessage&&!e.importScripts){var t=!0,a=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=a,t}}()?e.MessageChannel?((r=new MessageChannel).port1.onmessage=function(e){f(e.data)},n=function(e){r.port2.postMessage(e)}):d&&"onreadystatechange"in d.createElement("script")?(i=d.documentElement,n=function(e){var t=d.createElement("script");t.onreadystatechange=function(){f(e),t.onreadystatechange=null,i.removeChild(t),t=null},i.appendChild(t)}):n=function(e){setTimeout(f,0,e)}:(s="setImmediate$"+Math.random()+"$",o=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(s)&&f(+t.data.slice(s.length))},e.addEventListener?e.addEventListener("message",o,!1):e.attachEvent("onmessage",o),n=function(t){e.postMessage(s+t,"*")}),p.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),a=0;a<t.length;a++)t[a]=arguments[a+1];var i={callback:e,args:t};return c[l]=i,n(l),l++},p.clearImmediate=m}function m(e){delete c[e]}function f(e){if(u)setTimeout(f,0,e);else{var t=c[e];if(t){u=!0;try{!function(e){var t=e.callback,a=e.args;switch(a.length){case 0:t();break;case 1:t(a[0]);break;case 2:t(a[0],a[1]);break;case 3:t(a[0],a[1],a[2]);break;default:t.apply(void 0,a)}}(t)}finally{m(e),u=!1}}}}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,a(239),a(378))},function(e,t,a){"use strict";t.__esModule=!0,t.computeAccessibleDescription=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=(0,i.queryIdRefs)(e,"aria-describedby").map((function(e){return(0,n.computeTextAlternative)(e,s(s({},t),{},{compute:"description"}))})).join(" ");if(""===a){var r=e.getAttribute("title");a=null===r?"":r}return a};var n=a(704),i=a(395);function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function s(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){o(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}},function(e,t,a){"use strict";t.__esModule=!0,t.default=function(e,t){var a=Array,n=Object(e);if(null==e)throw new TypeError("Array.from requires an array-like object - not null or undefined");if(void 0!==t&&!i(t))throw new TypeError("Array.from: when provided, the second argument must be a function");var s,o=function(e){var t=function(e){var t=Number(e);if(isNaN(t))return 0;if(0===t||!isFinite(t))return t;return(t>0?1:-1)*Math.floor(Math.abs(t))}(e);return Math.min(Math.max(t,0),r)}(n.length),l=i(a)?Object(new a(o)):new Array(o),c=0;for(;c<o;)s=n[c],l[c]=t?t(s,c):s,c+=1;return l.length=o,l};var n=Object.prototype.toString;function i(e){return"function"==typeof e||"[object Function]"===n.call(e)}var r=Math.pow(2,53)-1},function(e,t,a){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}t.__esModule=!0,t.default=void 0;var s=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];n(this,e),r(this,"items",void 0),this.items=t}var t,a,s;return t=e,(a=[{key:"add",value:function(e){return!1===this.has(e)&&this.items.push(e),this}},{key:"clear",value:function(){this.items=[]}},{key:"delete",value:function(e){var t=this.items.length;return this.items=this.items.filter((function(t){return t!==e})),t!==this.items.length}},{key:"forEach",value:function(e){var t=this;this.items.forEach((function(a){e(a,a,t)}))}},{key:"has",value:function(e){return-1!==this.items.indexOf(e)}},{key:"size",get:function(){return this.items.length}}])&&i(t.prototype,a),s&&i(t,s),e}(),o="undefined"==typeof Set?Set:s;t.default=o},function(e,t,a){"use strict";t.__esModule=!0,t.computeAccessibleName=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(r(e))return"";return(0,n.computeTextAlternative)(e,t)};var n=a(704),i=a(395);function r(e){return(0,i.hasAnyConcreteRoles)(e,["caption","code","deletion","emphasis","generic","insertion","paragraph","presentation","strong","subscript","superscript"])}},function(e,t,a){a(1052);var n=a(176).Object,i=e.exports=function(e,t,a){return n.defineProperty(e,t,a)};n.defineProperty.sham&&(i.sham=!0)},function(e,t,a){var n=a(167),i=a(182);n({target:"Object",stat:!0,forced:!i,sham:!i},{defineProperty:a(196).f})},function(e,t,a){var n=a(102),i=a(205),r=a(183),s=a(496),o=a(499),l=a(1055),c=a(140),u=n.TypeError,d=c("toPrimitive");e.exports=function(e,t){if(!r(e)||s(e))return e;var a,n=o(e,d);if(n){if(void 0===t&&(t="default"),a=i(n,e,t),!r(a)||s(a))return a;throw u("Can't convert object to primitive value")}return void 0===t&&(t="number"),l(e,t)}},function(e,t,a){var n=a(275);e.exports=n("navigator","userAgent")||""},function(e,t,a){var n=a(102),i=a(205),r=a(145),s=a(183),o=n.TypeError;e.exports=function(e,t){var a,n;if("string"===t&&r(a=e.toString)&&!s(n=i(a,e)))return n;if(r(a=e.valueOf)&&!s(n=i(a,e)))return n;if("string"!==t&&r(a=e.toString)&&!s(n=i(a,e)))return n;throw o("Can't convert object to primitive value")}},function(e,t,a){var n=a(102),i=Object.defineProperty;e.exports=function(e,t){try{i(n,e,{value:t,configurable:!0,writable:!0})}catch(a){n[e]=t}return t}},function(e,t,a){var n=a(134),i=a(145),r=/#|\.prototype\./,s=function(e,t){var a=l[o(e)];return a==u||a!=c&&(i(t)?n(t):!!t)},o=s.normalize=function(e){return String(e).replace(r,".").toLowerCase()},l=s.data={},c=s.NATIVE="N",u=s.POLYFILL="P";e.exports=s},function(e,t,a){"use strict";var n=a(228);a(92)(t,"__esModule",{value:!0}),t.default=void 0;var i=new(n(a(252)).default)([["aria-activedescendant",{type:"id"}],["aria-atomic",{type:"boolean"}],["aria-autocomplete",{type:"token",values:["inline","list","both","none"]}],["aria-busy",{type:"boolean"}],["aria-checked",{type:"tristate"}],["aria-colcount",{type:"integer"}],["aria-colindex",{type:"integer"}],["aria-colspan",{type:"integer"}],["aria-controls",{type:"idlist"}],["aria-current",{type:"token",values:["page","step","location","date","time",!0,!1]}],["aria-describedby",{type:"idlist"}],["aria-details",{type:"id"}],["aria-disabled",{type:"boolean"}],["aria-dropeffect",{type:"tokenlist",values:["copy","execute","link","move","none","popup"]}],["aria-errormessage",{type:"id"}],["aria-expanded",{type:"boolean",allowundefined:!0}],["aria-flowto",{type:"idlist"}],["aria-grabbed",{type:"boolean",allowundefined:!0}],["aria-haspopup",{type:"token",values:[!1,!0,"menu","listbox","tree","grid","dialog"]}],["aria-hidden",{type:"boolean",allowundefined:!0}],["aria-invalid",{type:"token",values:["grammar",!1,"spelling",!0]}],["aria-keyshortcuts",{type:"string"}],["aria-label",{type:"string"}],["aria-labelledby",{type:"idlist"}],["aria-level",{type:"integer"}],["aria-live",{type:"token",values:["assertive","off","polite"]}],["aria-modal",{type:"boolean"}],["aria-multiline",{type:"boolean"}],["aria-multiselectable",{type:"boolean"}],["aria-orientation",{type:"token",values:["vertical","undefined","horizontal"]}],["aria-owns",{type:"idlist"}],["aria-placeholder",{type:"string"}],["aria-posinset",{type:"integer"}],["aria-pressed",{type:"tristate"}],["aria-readonly",{type:"boolean"}],["aria-relevant",{type:"tokenlist",values:["additions","all","removals","text"]}],["aria-required",{type:"boolean"}],["aria-roledescription",{type:"string"}],["aria-rowcount",{type:"integer"}],["aria-rowindex",{type:"integer"}],["aria-rowspan",{type:"integer"}],["aria-selected",{type:"boolean",allowundefined:!0}],["aria-setsize",{type:"integer"}],["aria-sort",{type:"token",values:["ascending","descending","none","other"]}],["aria-valuemax",{type:"number"}],["aria-valuemin",{type:"number"}],["aria-valuenow",{type:"number"}],["aria-valuetext",{type:"string"}]]);t.default=i},function(e,t,a){var n=a(1060);a(231),e.exports=n},function(e,t,a){a(253),a(1072),a(342),a(305);var n=a(176);e.exports=n.Map},function(e,t,a){var n=a(102),i=a(145),r=a(713),s=n.WeakMap;e.exports=i(s)&&/native code/.test(r(s))},function(e,t,a){var n=a(182),i=a(162),r=Function.prototype,s=n&&Object.getOwnPropertyDescriptor,o=i(r,"name"),l=o&&"something"===function(){}.name,c=o&&(!n||n&&s(r,"name").configurable);e.exports={EXISTS:o,PROPER:l,CONFIGURABLE:c}},function(e,t,a){"use strict";var n=a(714).IteratorPrototype,i=a(401),r=a(335),s=a(340),o=a(277),l=function(){return this};e.exports=function(e,t,a){var c=t+" Iterator";return e.prototype=i(n,{next:r(1,a)}),s(e,c,!1,!0),o[c]=l,e}},function(e,t,a){var n=a(182),i=a(196),r=a(229),s=a(250),o=a(402);e.exports=n?Object.defineProperties:function(e,t){r(e);for(var a,n=s(t),l=o(t),c=l.length,u=0;c>u;)i.f(e,a=l[u++],n[a]);return e}},function(e,t,a){var n=a(250),i=a(716),r=a(304),s=function(e){return function(t,a,s){var o,l=n(t),c=r(l),u=i(s,c);if(e&&a!=a){for(;c>u;)if((o=l[u++])!=o)return!0}else for(;c>u;u++)if((e||u in l)&&l[u]===a)return e||u||0;return!e&&-1}};e.exports={includes:s(!0),indexOf:s(!1)}},function(e,t,a){var n=a(505),i=Math.min;e.exports=function(e){return e>0?i(n(e),9007199254740991):0}},function(e,t,a){var n=a(275);e.exports=n("document","documentElement")},function(e,t,a){var n=a(134);e.exports=!n((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}))},function(e,t,a){"use strict";var n=a(507),i=a(230);e.exports=n?{}.toString:function(){return"[object "+i(this)+"]"}},function(e,t,a){var n=a(133),i=a(229),r=a(1071);e.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,a={};try{(e=n(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(a,[]),t=a instanceof Array}catch(e){}return function(a,n){return i(a),r(n),t?e(a,n):a.__proto__=n,a}}():void 0)},function(e,t,a){var n=a(102),i=a(145),r=n.String,s=n.TypeError;e.exports=function(e){if("object"==typeof e||i(e))return e;throw s("Can't set "+r(e)+" as a prototype")}},function(e,t,a){"use strict";a(718)("Map",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),a(726))},function(e,t,a){var n=a(134),i=a(183),r=a(336),s=a(1074),o=Object.isExtensible,l=n((function(){o(1)}));e.exports=l||s?function(e){return!!i(e)&&((!s||"ArrayBuffer"!=r(e))&&(!o||o(e)))}:o},function(e,t,a){var n=a(134);e.exports=n((function(){if("function"==typeof ArrayBuffer){var e=new ArrayBuffer(8);Object.isExtensible(e)&&Object.defineProperty(e,"a",{value:8})}}))},function(e,t,a){var n=a(134);e.exports=!n((function(){return Object.isExtensible(Object.preventExtensions({}))}))},function(e,t,a){var n=a(102),i=a(341),r=a(511),s=a(183),o=a(140)("species"),l=n.Array;e.exports=function(e){var t;return i(e)&&(t=e.constructor,(r(t)&&(t===l||i(t.prototype))||s(t)&&null===(t=t[o]))&&(t=void 0)),void 0===t?l:t}},function(e,t,a){var n=a(403);e.exports=function(e,t,a){for(var i in t)a&&a.unsafe&&e[i]?e[i]=t[i]:n(e,i,t[i],a);return e}},function(e,t,a){"use strict";var n=a(275),i=a(196),r=a(140),s=a(182),o=r("species");e.exports=function(e){var t=n(e),a=i.f;s&&t&&!t[o]&&a(t,o,{configurable:!0,get:function(){return this}})}},function(e,t,a){var n=a(133),i=a(505),r=a(512),s=a(495),o=n("".charAt),l=n("".charCodeAt),c=n("".slice),u=function(e){return function(t,a){var n,u,d=r(s(t)),p=i(a),m=d.length;return p<0||p>=m?e?"":void 0:(n=l(d,p))<55296||n>56319||p+1===m||(u=l(d,p+1))<56320||u>57343?e?o(d,p):n:e?c(d,p,p+2):u-56320+(n-55296<<10)+65536}};e.exports={codeAt:u(!1),charAt:u(!0)}},function(e,t){e.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},function(e,t,a){"use strict";var n=a(228);a(92)(t,"__esModule",{value:!0}),t.default=void 0;var i=new(n(a(252)).default)([["a",{reserved:!1}],["abbr",{reserved:!1}],["acronym",{reserved:!1}],["address",{reserved:!1}],["applet",{reserved:!1}],["area",{reserved:!1}],["article",{reserved:!1}],["aside",{reserved:!1}],["audio",{reserved:!1}],["b",{reserved:!1}],["base",{reserved:!0}],["bdi",{reserved:!1}],["bdo",{reserved:!1}],["big",{reserved:!1}],["blink",{reserved:!1}],["blockquote",{reserved:!1}],["body",{reserved:!1}],["br",{reserved:!1}],["button",{reserved:!1}],["canvas",{reserved:!1}],["caption",{reserved:!1}],["center",{reserved:!1}],["cite",{reserved:!1}],["code",{reserved:!1}],["col",{reserved:!0}],["colgroup",{reserved:!0}],["content",{reserved:!1}],["data",{reserved:!1}],["datalist",{reserved:!1}],["dd",{reserved:!1}],["del",{reserved:!1}],["details",{reserved:!1}],["dfn",{reserved:!1}],["dialog",{reserved:!1}],["dir",{reserved:!1}],["div",{reserved:!1}],["dl",{reserved:!1}],["dt",{reserved:!1}],["em",{reserved:!1}],["embed",{reserved:!1}],["fieldset",{reserved:!1}],["figcaption",{reserved:!1}],["figure",{reserved:!1}],["font",{reserved:!1}],["footer",{reserved:!1}],["form",{reserved:!1}],["frame",{reserved:!1}],["frameset",{reserved:!1}],["h1",{reserved:!1}],["h2",{reserved:!1}],["h3",{reserved:!1}],["h4",{reserved:!1}],["h5",{reserved:!1}],["h6",{reserved:!1}],["head",{reserved:!0}],["header",{reserved:!1}],["hgroup",{reserved:!1}],["hr",{reserved:!1}],["html",{reserved:!0}],["i",{reserved:!1}],["iframe",{reserved:!1}],["img",{reserved:!1}],["input",{reserved:!1}],["ins",{reserved:!1}],["kbd",{reserved:!1}],["keygen",{reserved:!1}],["label",{reserved:!1}],["legend",{reserved:!1}],["li",{reserved:!1}],["link",{reserved:!0}],["main",{reserved:!1}],["map",{reserved:!1}],["mark",{reserved:!1}],["marquee",{reserved:!1}],["menu",{reserved:!1}],["menuitem",{reserved:!1}],["meta",{reserved:!0}],["meter",{reserved:!1}],["nav",{reserved:!1}],["noembed",{reserved:!0}],["noscript",{reserved:!0}],["object",{reserved:!1}],["ol",{reserved:!1}],["optgroup",{reserved:!1}],["option",{reserved:!1}],["output",{reserved:!1}],["p",{reserved:!1}],["param",{reserved:!0}],["picture",{reserved:!0}],["pre",{reserved:!1}],["progress",{reserved:!1}],["q",{reserved:!1}],["rp",{reserved:!1}],["rt",{reserved:!1}],["rtc",{reserved:!1}],["ruby",{reserved:!1}],["s",{reserved:!1}],["samp",{reserved:!1}],["script",{reserved:!0}],["section",{reserved:!1}],["select",{reserved:!1}],["small",{reserved:!1}],["source",{reserved:!0}],["spacer",{reserved:!1}],["span",{reserved:!1}],["strike",{reserved:!1}],["strong",{reserved:!1}],["style",{reserved:!0}],["sub",{reserved:!1}],["summary",{reserved:!1}],["sup",{reserved:!1}],["table",{reserved:!1}],["tbody",{reserved:!1}],["td",{reserved:!1}],["textarea",{reserved:!1}],["tfoot",{reserved:!1}],["th",{reserved:!1}],["thead",{reserved:!1}],["time",{reserved:!1}],["title",{reserved:!0}],["tr",{reserved:!1}],["track",{reserved:!0}],["tt",{reserved:!1}],["u",{reserved:!1}],["ul",{reserved:!1}],["var",{reserved:!1}],["video",{reserved:!1}],["wbr",{reserved:!1}],["xmp",{reserved:!1}]]);t.default=i},function(e,t,a){var n=a(1083);e.exports=n},function(e,t,a){var n=a(1084);a(231),e.exports=n},function(e,t,a){a(253),a(305);var n=a(510);e.exports=n},function(e,t,a){e.exports=a(728)},function(e,t,a){a(1087);var n=a(176);e.exports=n.Array.isArray},function(e,t,a){a(167)({target:"Array",stat:!0},{isArray:a(341)})},function(e,t,a){e.exports=a(1089)},function(e,t,a){var n=a(1090);e.exports=n},function(e,t,a){var n=a(1091);a(231),e.exports=n},function(e,t,a){a(253),a(305);var n=a(404);e.exports=n},function(e,t,a){e.exports=a(729)},function(e,t,a){a(730),a(342),a(1094),a(1095),a(1096),a(1097),a(1098),a(1099),a(1100),a(1101),a(1102),a(1103),a(1104),a(1105),a(1106),a(1107),a(1108),a(1109),a(1110),a(1111);var n=a(176);e.exports=n.Symbol},function(e,t,a){"use strict";var n=a(167),i=a(102),r=a(275),s=a(396),o=a(205),l=a(133),c=a(398),u=a(182),d=a(497),p=a(134),m=a(162),f=a(341),g=a(145),b=a(183),h=a(206),y=a(496),v=a(229),E=a(251),T=a(250),k=a(397),x=a(512),S=a(335),w=a(401),O=a(402),j=a(508),C=a(720),I=a(732),M=a(708),A=a(196),q=a(493),D=a(509),P=a(403),R=a(502),F=a(400),_=a(339),N=a(399),L=a(140),B=a(733),z=a(126),H=a(340),U=a(338),$=a(405).forEach,Q=F("hidden"),V="Symbol",W=L("toPrimitive"),G=U.set,K=U.getterFor(V),Y=Object.prototype,J=i.Symbol,X=J&&J.prototype,Z=i.TypeError,ee=i.QObject,te=r("JSON","stringify"),ae=M.f,ne=A.f,ie=C.f,re=q.f,se=l([].push),oe=R("symbols"),le=R("op-symbols"),ce=R("string-to-symbol-registry"),ue=R("symbol-to-string-registry"),de=R("wks"),pe=!ee||!ee.prototype||!ee.prototype.findChild,me=u&&p((function(){return 7!=w(ne({},"a",{get:function(){return ne(this,"a",{value:7}).a}})).a}))?function(e,t,a){var n=ae(Y,t);n&&delete Y[t],ne(e,t,a),n&&e!==Y&&ne(Y,t,n)}:ne,fe=function(e,t){var a=oe[e]=w(X);return G(a,{type:V,tag:e,description:t}),u||(a.description=t),a},ge=function(e,t,a){e===Y&&ge(le,t,a),v(e);var n=k(t);return v(a),m(oe,n)?(a.enumerable?(m(e,Q)&&e[Q][n]&&(e[Q][n]=!1),a=w(a,{enumerable:S(0,!1)})):(m(e,Q)||ne(e,Q,S(1,{})),e[Q][n]=!0),me(e,n,a)):ne(e,n,a)},be=function(e,t){v(e);var a=T(t),n=O(a).concat(Ee(a));return $(n,(function(t){u&&!o(he,a,t)||ge(e,t,a[t])})),e},he=function(e){var t=k(e),a=o(re,this,t);return!(this===Y&&m(oe,t)&&!m(le,t))&&(!(a||!m(this,t)||!m(oe,t)||m(this,Q)&&this[Q][t])||a)},ye=function(e,t){var a=T(e),n=k(t);if(a!==Y||!m(oe,n)||m(le,n)){var i=ae(a,n);return!i||!m(oe,n)||m(a,Q)&&a[Q][n]||(i.enumerable=!0),i}},ve=function(e){var t=ie(T(e)),a=[];return $(t,(function(e){m(oe,e)||m(_,e)||se(a,e)})),a},Ee=function(e){var t=e===Y,a=ie(t?le:T(e)),n=[];return $(a,(function(e){!m(oe,e)||t&&!m(Y,e)||se(n,oe[e])})),n};(d||(J=function(){if(h(X,this))throw Z("Symbol is not a constructor");var e=arguments.length&&void 0!==arguments[0]?x(arguments[0]):void 0,t=N(e),a=function(e){this===Y&&o(a,le,e),m(this,Q)&&m(this[Q],t)&&(this[Q][t]=!1),me(this,t,S(1,e))};return u&&pe&&me(Y,t,{configurable:!0,set:a}),fe(t,e)},P(X=J.prototype,"toString",(function(){return K(this).tag})),P(J,"withoutSetter",(function(e){return fe(N(e),e)})),q.f=he,A.f=ge,M.f=ye,j.f=C.f=ve,I.f=Ee,B.f=function(e){return fe(L(e),e)},u&&(ne(X,"description",{configurable:!0,get:function(){return K(this).description}}),c||P(Y,"propertyIsEnumerable",he,{unsafe:!0}))),n({global:!0,wrap:!0,forced:!d,sham:!d},{Symbol:J}),$(O(de),(function(e){z(e)})),n({target:V,stat:!0,forced:!d},{for:function(e){var t=x(e);if(m(ce,t))return ce[t];var a=J(t);return ce[t]=a,ue[a]=t,a},keyFor:function(e){if(!y(e))throw Z(e+" is not a symbol");if(m(ue,e))return ue[e]},useSetter:function(){pe=!0},useSimple:function(){pe=!1}}),n({target:"Object",stat:!0,forced:!d,sham:!u},{create:function(e,t){return void 0===t?w(e):be(w(e),t)},defineProperty:ge,defineProperties:be,getOwnPropertyDescriptor:ye}),n({target:"Object",stat:!0,forced:!d},{getOwnPropertyNames:ve,getOwnPropertySymbols:Ee}),n({target:"Object",stat:!0,forced:p((function(){I.f(1)}))},{getOwnPropertySymbols:function(e){return I.f(E(e))}}),te)&&n({target:"JSON",stat:!0,forced:!d||p((function(){var e=J();return"[null]"!=te([e])||"{}"!=te({a:e})||"{}"!=te(Object(e))}))},{stringify:function(e,t,a){var n=D(arguments),i=t;if((b(t)||void 0!==e)&&!y(e))return f(t)||(t=function(e,t){if(g(i)&&(t=o(i,this,e,t)),!y(t))return t}),n[1]=t,s(te,null,n)}});if(!X[W]){var Te=X.valueOf;P(X,W,(function(e){return o(Te,this)}))}H(J,V),_[Q]=!0},function(e,t,a){a(126)("asyncIterator")},function(e,t){},function(e,t,a){a(126)("hasInstance")},function(e,t,a){a(126)("isConcatSpreadable")},function(e,t,a){a(126)("iterator")},function(e,t,a){a(126)("match")},function(e,t,a){a(126)("matchAll")},function(e,t,a){a(126)("replace")},function(e,t,a){a(126)("search")},function(e,t,a){a(126)("species")},function(e,t,a){a(126)("split")},function(e,t,a){a(126)("toPrimitive")},function(e,t,a){a(126)("toStringTag")},function(e,t,a){a(126)("unscopables")},function(e,t,a){var n=a(102);a(340)(n.JSON,"JSON",!0)},function(e,t){},function(e,t){},function(e,t,a){e.exports=a(734)},function(e,t,a){a(305),a(1114);var n=a(176);e.exports=n.Array.from},function(e,t,a){var n=a(167),i=a(1115);n({target:"Array",stat:!0,forced:!a(1117)((function(e){Array.from(e)}))},{from:i})},function(e,t,a){"use strict";var n=a(102),i=a(337),r=a(205),s=a(251),o=a(1116),l=a(722),c=a(511),u=a(304),d=a(514),p=a(510),m=a(404),f=n.Array;e.exports=function(e){var t=s(e),a=c(this),n=arguments.length,g=n>1?arguments[1]:void 0,b=void 0!==g;b&&(g=i(g,n>2?arguments[2]:void 0));var h,y,v,E,T,k,x=m(t),S=0;if(!x||this==f&&l(x))for(h=u(t),y=a?new this(h):f(h);h>S;S++)k=b?g(t[S],S):t[S],d(y,S,k);else for(T=(E=p(t,x)).next,y=a?new this:[];!(v=r(T,E)).done;S++)k=b?o(E,g,[v.value,S],!0):v.value,d(y,S,k);return y.length=S,y}},function(e,t,a){var n=a(229),i=a(723);e.exports=function(e,t,a,r){try{return r?t(n(a)[0],a[1]):t(a)}catch(t){i(e,"throw",t)}}},function(e,t,a){var n=a(140)("iterator"),i=!1;try{var r=0,s={next:function(){return{done:!!r++}},return:function(){i=!0}};s[n]=function(){return this},Array.from(s,(function(){throw 2}))}catch(e){}e.exports=function(e,t){if(!t&&!i)return!1;var a=!1;try{var r={};r[n]=function(){return{next:function(){return{done:a=!0}}}},e(r)}catch(e){}return a}},function(e,t,a){e.exports=a(735)},function(e,t,a){var n=a(206),i=a(1120),r=Array.prototype;e.exports=function(e){var t=e.slice;return e===r||n(r,e)&&t===r.slice?i:t}},function(e,t,a){a(1121);var n=a(306);e.exports=n("Array").slice},function(e,t,a){"use strict";var n=a(167),i=a(102),r=a(341),s=a(511),o=a(183),l=a(716),c=a(304),u=a(250),d=a(514),p=a(140),m=a(731),f=a(509),g=m("slice"),b=p("species"),h=i.Array,y=Math.max;n({target:"Array",proto:!0,forced:!g},{slice:function(e,t){var a,n,i,p=u(this),m=c(p),g=l(e,m),v=l(void 0===t?m:t,m);if(r(p)&&(a=p.constructor,(s(a)&&(a===h||r(a.prototype))||o(a)&&null===(a=a[b]))&&(a=void 0),a===h||void 0===a))return f(p,g,v);for(n=new(void 0===a?h:a)(y(v-g,0)),i=0;g<v;g++,i++)g in p&&d(n,i,p[g]);return n.length=i,n}})},function(e,t,a){var n=a(1123);e.exports=function(e,t,a){return t in e?n(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}},function(e,t,a){e.exports=a(1124)},function(e,t,a){var n=a(707);e.exports=n},function(e,t,a){e.exports=a(1126)},function(e,t,a){var n=a(1127);e.exports=n},function(e,t,a){a(1128);var n=a(176);e.exports=n.Object.assign},function(e,t,a){var n=a(167),i=a(1129);n({target:"Object",stat:!0,forced:Object.assign!==i},{assign:i})},function(e,t,a){"use strict";var n=a(182),i=a(133),r=a(205),s=a(134),o=a(402),l=a(732),c=a(493),u=a(251),d=a(494),p=Object.assign,m=Object.defineProperty,f=i([].concat);e.exports=!p||s((function(){if(n&&1!==p({b:1},p(m({},"a",{enumerable:!0,get:function(){m(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},t={},a=Symbol(),i="abcdefghijklmnopqrst";return e[a]=7,i.split("").forEach((function(e){t[e]=e})),7!=p({},e)[a]||o(p({},t)).join("")!=i}))?function(e,t){for(var a=u(e),i=arguments.length,s=1,p=l.f,m=c.f;i>s;)for(var g,b=d(arguments[s++]),h=p?f(o(b),p(b)):o(b),y=h.length,v=0;y>v;)g=h[v++],n&&!r(m,b,g)||(a[g]=b[g]);return a}:p},function(e,t,a){e.exports=a(1131)},function(e,t,a){var n=a(1132);e.exports=n},function(e,t,a){a(1133);var n=a(176);e.exports=n.Object.keys},function(e,t,a){var n=a(167),i=a(251),r=a(402);n({target:"Object",stat:!0,forced:a(134)((function(){r(1)}))},{keys:function(e){return r(i(e))}})},function(e,t,a){a(231);var n=a(230),i=a(162),r=a(206),s=a(1135),o=Array.prototype,l={DOMTokenList:!0,NodeList:!0};e.exports=function(e){var t=e.forEach;return e===o||r(o,e)&&t===o.forEach||i(l,n(e))?s:t}},function(e,t,a){var n=a(1136);e.exports=n},function(e,t,a){a(1137);var n=a(306);e.exports=n("Array").forEach},function(e,t,a){"use strict";var n=a(167),i=a(1138);n({target:"Array",proto:!0,forced:[].forEach!=i},{forEach:i})},function(e,t,a){"use strict";var n=a(405).forEach,i=a(1139)("forEach");e.exports=i?[].forEach:function(e){return n(this,e,arguments.length>1?arguments[1]:void 0)}},function(e,t,a){"use strict";var n=a(134);e.exports=function(e,t){var a=[][e];return!!a&&n((function(){a.call(null,t||function(){throw 1},1)}))}},function(e,t,a){"use strict";var n=a(228);a(92)(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a(252)),r=n(a(1141)),s=n(a(1142)),o=n(a(1143)),l=n(a(1144)),c=n(a(1145)),u=n(a(1146)),d=n(a(1147)),p=n(a(1148)),m=n(a(1149)),f=n(a(1150)),g=n(a(1151)),b=n(a(1152)),h=new i.default([["command",r.default],["composite",s.default],["input",o.default],["landmark",l.default],["range",c.default],["roletype",u.default],["section",d.default],["sectionhead",p.default],["select",m.default],["structure",f.default],["widget",g.default],["window",b.default]]);t.default=h},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"menuitem"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-activedescendant":null,"aria-disabled":null},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null},relatedConcepts:[{concept:{name:"input"},module:"XForms"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-valuemax":null,"aria-valuemin":null,"aria-valuenow":null,"aria-valuetext":null},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:[],prohibitedProps:[],props:{"aria-atomic":null,"aria-busy":null,"aria-controls":null,"aria-current":null,"aria-describedby":null,"aria-details":null,"aria-dropeffect":null,"aria-flowto":null,"aria-grabbed":null,"aria-hidden":null,"aria-keyshortcuts":null,"aria-label":null,"aria-labelledby":null,"aria-live":null,"aria-owns":null,"aria-relevant":null,"aria-roledescription":null},relatedConcepts:[{concept:{name:"rel"},module:"HTML"},{concept:{name:"role"},module:"XHTML"},{concept:{name:"type"},module:"Dublin Core"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:[],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"frontmatter"},module:"DTB"},{concept:{name:"level"},module:"DTB"},{concept:{name:"level"},module:"SMIL"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-orientation":null},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","composite"],["roletype","structure","section","group"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:[],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:[],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-modal":null},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype"]]};t.default=n},function(e,t,a){"use strict";var n=a(228);a(92)(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a(252)),r=n(a(1154)),s=n(a(1155)),o=n(a(1156)),l=n(a(1157)),c=n(a(1158)),u=n(a(1159)),d=n(a(1160)),p=n(a(1161)),m=n(a(1162)),f=n(a(1163)),g=n(a(1164)),b=n(a(1165)),h=n(a(1166)),y=n(a(1167)),v=n(a(1168)),E=n(a(1169)),T=n(a(1170)),k=n(a(1171)),x=n(a(1172)),S=n(a(1173)),w=n(a(1174)),O=n(a(1175)),j=n(a(1176)),C=n(a(1177)),I=n(a(1178)),M=n(a(1179)),A=n(a(1180)),q=n(a(1181)),D=n(a(1182)),P=n(a(1183)),R=n(a(1184)),F=n(a(1185)),_=n(a(1186)),N=n(a(1187)),L=n(a(1188)),B=n(a(1189)),z=n(a(1190)),H=n(a(1191)),U=n(a(1192)),$=n(a(1193)),Q=n(a(1194)),V=n(a(1195)),W=n(a(1196)),G=n(a(1197)),K=n(a(1198)),Y=n(a(1199)),J=n(a(1200)),X=n(a(1201)),Z=n(a(1202)),ee=n(a(1203)),te=n(a(1204)),ae=n(a(1205)),ne=n(a(1206)),ie=n(a(1207)),re=n(a(1208)),se=n(a(1209)),oe=n(a(1210)),le=n(a(1211)),ce=n(a(1212)),ue=n(a(1213)),de=n(a(1214)),pe=n(a(1215)),me=n(a(1216)),fe=n(a(1217)),ge=n(a(1218)),be=n(a(1219)),he=n(a(1220)),ye=n(a(1221)),ve=n(a(1222)),Ee=n(a(1223)),Te=n(a(1224)),ke=n(a(1225)),xe=n(a(1226)),Se=n(a(1227)),we=n(a(1228)),Oe=n(a(1229)),je=n(a(1230)),Ce=n(a(1231)),Ie=n(a(1232)),Me=n(a(1233)),Ae=n(a(1234)),qe=n(a(1235)),De=new i.default([["alert",r.default],["alertdialog",s.default],["application",o.default],["article",l.default],["banner",c.default],["blockquote",u.default],["button",d.default],["caption",p.default],["cell",m.default],["checkbox",f.default],["code",g.default],["columnheader",b.default],["combobox",h.default],["complementary",y.default],["contentinfo",v.default],["definition",E.default],["deletion",T.default],["dialog",k.default],["directory",x.default],["document",S.default],["emphasis",w.default],["feed",O.default],["figure",j.default],["form",C.default],["generic",I.default],["grid",M.default],["gridcell",A.default],["group",q.default],["heading",D.default],["img",P.default],["insertion",R.default],["link",F.default],["list",_.default],["listbox",N.default],["listitem",L.default],["log",B.default],["main",z.default],["marquee",H.default],["math",U.default],["menu",$.default],["menubar",Q.default],["menuitem",V.default],["menuitemcheckbox",W.default],["menuitemradio",G.default],["meter",K.default],["navigation",Y.default],["none",J.default],["note",X.default],["option",Z.default],["paragraph",ee.default],["presentation",te.default],["progressbar",ae.default],["radio",ne.default],["radiogroup",ie.default],["region",re.default],["row",se.default],["rowgroup",oe.default],["rowheader",le.default],["scrollbar",ce.default],["search",ue.default],["searchbox",de.default],["separator",pe.default],["slider",me.default],["spinbutton",fe.default],["status",ge.default],["strong",be.default],["subscript",he.default],["superscript",ye.default],["switch",ve.default],["tab",Ee.default],["table",Te.default],["tablist",ke.default],["tabpanel",xe.default],["term",Se.default],["textbox",we.default],["time",Oe.default],["timer",je.default],["toolbar",Ce.default],["tooltip",Ie.default],["tree",Me.default],["treegrid",Ae.default],["treeitem",qe.default]]);t.default=De},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-atomic":"true","aria-live":"assertive"},relatedConcepts:[{concept:{name:"alert"},module:"XForms"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"alert"},module:"XForms"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","alert"],["roletype","window","dialog"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-activedescendant":null,"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"Device Independence Delivery Unit"}}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-posinset":null,"aria-setsize":null},relatedConcepts:[{concept:{name:"article"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","document"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{constraints:["direct descendant of document"],name:"header"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-disabled":null,"aria-expanded":null,"aria-haspopup":null,"aria-pressed":null},relatedConcepts:[{concept:{attributes:[{constraints:["set"],name:"aria-pressed"},{name:"type",value:"checkbox"}],name:"input"},module:"HTML"},{concept:{attributes:[{name:"aria-expanded",value:"false"}],name:"summary"},module:"HTML"},{concept:{attributes:[{name:"aria-expanded",value:"true"}],constraints:["direct descendant of details element with the open attribute defined"],name:"summary"},module:"HTML"},{concept:{attributes:[{name:"type",value:"button"}],name:"input"},module:"HTML"},{concept:{attributes:[{name:"type",value:"image"}],name:"input"},module:"HTML"},{concept:{attributes:[{name:"type",value:"reset"}],name:"input"},module:"HTML"},{concept:{attributes:[{name:"type",value:"submit"}],name:"input"},module:"HTML"},{concept:{name:"button"},module:"HTML"},{concept:{name:"trigger"},module:"XForms"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","command"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[],requireContextRole:["figure","grid","table"],requiredContextRole:["figure","grid","table"],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-colindex":null,"aria-colspan":null,"aria-rowindex":null,"aria-rowspan":null},relatedConcepts:[{concept:{constraints:["descendant of table"],name:"td"},module:"HTML"}],requireContextRole:["row"],requiredContextRole:["row"],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-checked":null,"aria-errormessage":null,"aria-expanded":null,"aria-invalid":null,"aria-readonly":null,"aria-required":null},relatedConcepts:[{concept:{attributes:[{name:"type",value:"checkbox"}],name:"input"},module:"HTML"},{concept:{name:"option"},module:"ARIA"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{"aria-checked":null},superClass:[["roletype","widget","input"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-sort":null},relatedConcepts:[{attributes:[{name:"scope",value:"col"}],concept:{name:"th"},module:"HTML"}],requireContextRole:["row"],requiredContextRole:["row"],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","cell"],["roletype","structure","section","cell","gridcell"],["roletype","widget","gridcell"],["roletype","structure","sectionhead"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-activedescendant":null,"aria-autocomplete":null,"aria-errormessage":null,"aria-invalid":null,"aria-readonly":null,"aria-required":null,"aria-expanded":"false","aria-haspopup":"listbox"},relatedConcepts:[{concept:{attributes:[{constraints:["set"],name:"list"},{name:"type",value:"email"}],name:"input"},module:"HTML"},{concept:{attributes:[{constraints:["set"],name:"list"},{name:"type",value:"search"}],name:"input"},module:"HTML"},{concept:{attributes:[{constraints:["set"],name:"list"},{name:"type",value:"tel"}],name:"input"},module:"HTML"},{concept:{attributes:[{constraints:["set"],name:"list"},{name:"type",value:"text"}],name:"input"},module:"HTML"},{concept:{attributes:[{constraints:["set"],name:"list"},{name:"type",value:"url"}],name:"input"},module:"HTML"},{concept:{attributes:[{constraints:["set"],name:"list"},{name:"type",value:"url"}],name:"input"},module:"HTML"},{concept:{attributes:[{constraints:["undefined"],name:"multiple"},{constraints:["undefined"],name:"size"}],name:"select"},module:"HTML"},{concept:{attributes:[{constraints:["undefined"],name:"multiple"},{name:"size",value:1}],name:"select"},module:"HTML"},{concept:{name:"select"},module:"XForms"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{"aria-controls":null,"aria-expanded":"false"},superClass:[["roletype","widget","input"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"aside"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{constraints:["direct descendant of document"],name:"footer"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"dd"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"dialog"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","window"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{module:"DAISY Guide"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","list"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"Device Independence Delivery Unit"}},{concept:{name:"body"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["article"]],requiredProps:{},superClass:[["roletype","structure","section","list"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"figure"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{attributes:[{constraints:["set"],name:"aria-label"}],name:"form"},module:"HTML"},{concept:{attributes:[{constraints:["set"],name:"aria-labelledby"}],name:"form"},module:"HTML"},{concept:{attributes:[{constraints:["set"],name:"name"}],name:"form"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[{concept:{name:"span"},module:"HTML"},{concept:{name:"div"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-multiselectable":null,"aria-readonly":null},relatedConcepts:[{concept:{attributes:[{name:"role",value:"grid"}],name:"table"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["row"],["row","rowgroup"]],requiredProps:{},superClass:[["roletype","widget","composite"],["roletype","structure","section","table"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null,"aria-readonly":null,"aria-required":null,"aria-selected":null},relatedConcepts:[{concept:{attributes:[{name:"role",value:"gridcell"}],name:"td"},module:"HTML"}],requireContextRole:["row"],requiredContextRole:["row"],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","cell"],["roletype","widget"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-activedescendant":null,"aria-disabled":null},relatedConcepts:[{concept:{name:"details"},module:"HTML"},{concept:{name:"fieldset"},module:"HTML"},{concept:{name:"optgroup"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-level":null},relatedConcepts:[{concept:{name:"h1"},module:"HTML"},{concept:{name:"h2"},module:"HTML"},{concept:{name:"h3"},module:"HTML"},{concept:{name:"h4"},module:"HTML"},{concept:{name:"h5"},module:"HTML"},{concept:{name:"h6"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{"aria-level":2},superClass:[["roletype","structure","sectionhead"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{attributes:[{constraints:["set"],name:"alt"}],name:"img"},module:"HTML"},{concept:{attributes:[{constraints:["undefined"],name:"alt"}],name:"img"},module:"HTML"},{concept:{name:"imggroup"},module:"DTB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-disabled":null,"aria-expanded":null},relatedConcepts:[{concept:{attributes:[{name:"href"}],name:"a"},module:"HTML"},{concept:{attributes:[{name:"href"}],name:"area"},module:"HTML"},{concept:{attributes:[{name:"href"}],name:"link"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","command"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"menu"},module:"HTML"},{concept:{name:"ol"},module:"HTML"},{concept:{name:"ul"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["listitem"]],requiredProps:{},superClass:[["roletype","structure","section"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-expanded":null,"aria-invalid":null,"aria-multiselectable":null,"aria-readonly":null,"aria-required":null,"aria-orientation":"vertical"},relatedConcepts:[{concept:{attributes:[{constraints:[">1"],name:"size"},{name:"multiple"}],name:"select"},module:"HTML"},{concept:{attributes:[{constraints:[">1"],name:"size"}],name:"select"},module:"HTML"},{concept:{attributes:[{name:"multiple"}],name:"select"},module:"HTML"},{concept:{name:"datalist"},module:"HTML"},{concept:{name:"list"},module:"ARIA"},{concept:{name:"select"},module:"XForms"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["option","group"],["option"]],requiredProps:{},superClass:[["roletype","widget","composite","select"],["roletype","structure","section","group","select"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-level":null,"aria-posinset":null,"aria-setsize":null},relatedConcepts:[{concept:{constraints:["direct descendant of ol, ul or menu"],name:"li"},module:"HTML"},{concept:{name:"item"},module:"XForms"}],requireContextRole:["directory","list"],requiredContextRole:["directory","list"],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-live":"polite"},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"main"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"math"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-orientation":"vertical"},relatedConcepts:[{concept:{name:"MENU"},module:"JAPI"},{concept:{name:"list"},module:"ARIA"},{concept:{name:"select"},module:"XForms"},{concept:{name:"sidebar"},module:"DTB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["menuitem","group"],["menuitemradio","group"],["menuitemcheckbox","group"],["menuitem"],["menuitemcheckbox"],["menuitemradio"]],requiredProps:{},superClass:[["roletype","widget","composite","select"],["roletype","structure","section","group","select"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-orientation":"horizontal"},relatedConcepts:[{concept:{name:"toolbar"},module:"ARIA"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["menuitem","group"],["menuitemradio","group"],["menuitemcheckbox","group"],["menuitem"],["menuitemcheckbox"],["menuitemradio"]],requiredProps:{},superClass:[["roletype","widget","composite","select","menu"],["roletype","structure","section","group","select","menu"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-disabled":null,"aria-expanded":null,"aria-haspopup":null,"aria-posinset":null,"aria-setsize":null},relatedConcepts:[{concept:{name:"MENU_ITEM"},module:"JAPI"},{concept:{name:"listitem"},module:"ARIA"},{concept:{name:"menuitem"},module:"HTML"},{concept:{name:"option"},module:"ARIA"}],requireContextRole:["group","menu","menubar"],requiredContextRole:["group","menu","menubar"],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","command"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author","contents"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"menuitem"},module:"ARIA"}],requireContextRole:["group","menu","menubar"],requiredContextRole:["group","menu","menubar"],requiredOwnedElements:[],requiredProps:{"aria-checked":null},superClass:[["roletype","widget","input","checkbox"],["roletype","widget","command","menuitem"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author","contents"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"menuitem"},module:"ARIA"}],requireContextRole:["group","menu","menubar"],requiredContextRole:["group","menu","menubar"],requiredOwnedElements:[],requiredProps:{"aria-checked":null},superClass:[["roletype","widget","input","checkbox","menuitemcheckbox"],["roletype","widget","command","menuitem","menuitemcheckbox"],["roletype","widget","input","radio"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{"aria-valuemax":null,"aria-valuemin":null,"aria-valuenow":null},superClass:[["roletype","structure","range"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"nav"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:[],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-checked":null,"aria-posinset":null,"aria-setsize":null,"aria-selected":"false"},relatedConcepts:[{concept:{name:"item"},module:"XForms"},{concept:{name:"listitem"},module:"ARIA"},{concept:{name:"option"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{"aria-selected":"false"},superClass:[["roletype","widget","input"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"progress"},module:"HTML"},{concept:{name:"status"},module:"ARIA"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","range"],["roletype","widget"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-checked":null,"aria-posinset":null,"aria-setsize":null},relatedConcepts:[{concept:{attributes:[{name:"type",value:"radio"}],name:"input"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{"aria-checked":null},superClass:[["roletype","widget","input"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-invalid":null,"aria-readonly":null,"aria-required":null},relatedConcepts:[{concept:{name:"list"},module:"ARIA"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["radio"]],requiredProps:{},superClass:[["roletype","widget","composite","select"],["roletype","structure","section","group","select"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{attributes:[{constraints:["set"],name:"aria-label"}],name:"section"},module:"HTML"},{concept:{attributes:[{constraints:["set"],name:"aria-labelledby"}],name:"section"},module:"HTML"},{concept:{name:"Device Independence Glossart perceivable unit"}},{concept:{name:"frame"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-colindex":null,"aria-expanded":null,"aria-level":null,"aria-posinset":null,"aria-rowindex":null,"aria-selected":null,"aria-setsize":null},relatedConcepts:[{concept:{name:"tr"},module:"HTML"}],requireContextRole:["grid","rowgroup","table","treegrid"],requiredContextRole:["grid","rowgroup","table","treegrid"],requiredOwnedElements:[["cell"],["columnheader"],["gridcell"],["rowheader"]],requiredProps:{},superClass:[["roletype","structure","section","group"],["roletype","widget"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"tbody"},module:"HTML"},{concept:{name:"tfoot"},module:"HTML"},{concept:{name:"thead"},module:"HTML"}],requireContextRole:["grid","table","treegrid"],requiredContextRole:["grid","table","treegrid"],requiredOwnedElements:[["row"]],requiredProps:{},superClass:[["roletype","structure"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-sort":null},relatedConcepts:[{concept:{attributes:[{name:"scope",value:"row"}],name:"th"},module:"HTML"}],requireContextRole:["row"],requiredContextRole:["row"],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","cell"],["roletype","structure","section","cell","gridcell"],["roletype","widget","gridcell"],["roletype","structure","sectionhead"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!0,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-orientation":"vertical","aria-valuemax":"100","aria-valuemin":"0"},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{"aria-controls":null,"aria-valuenow":null},superClass:[["roletype","structure","range"],["roletype","widget"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{attributes:[{constraints:["undefined"],name:"list"},{name:"type",value:"search"}],name:"input"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","input","textbox"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!0,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-valuetext":null,"aria-orientation":"horizontal","aria-valuemax":"100","aria-valuemin":"0"},relatedConcepts:[{concept:{name:"hr"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-haspopup":null,"aria-invalid":null,"aria-readonly":null,"aria-orientation":"horizontal","aria-valuemax":"100","aria-valuemin":"0"},relatedConcepts:[{concept:{attributes:[{name:"type",value:"range"}],name:"input"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{"aria-valuenow":null},superClass:[["roletype","widget","input"],["roletype","structure","range"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-invalid":null,"aria-readonly":null,"aria-required":null,"aria-valuenow":"0"},relatedConcepts:[{concept:{attributes:[{name:"type",value:"number"}],name:"input"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","composite"],["roletype","widget","input"],["roletype","structure","range"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-atomic":"true","aria-live":"polite"},relatedConcepts:[{concept:{name:"output"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author","contents"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"button"},module:"ARIA"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{"aria-checked":null},superClass:[["roletype","widget","input","checkbox"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!0,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-disabled":null,"aria-expanded":null,"aria-haspopup":null,"aria-posinset":null,"aria-setsize":null,"aria-selected":"false"},relatedConcepts:[],requireContextRole:["tablist"],requiredContextRole:["tablist"],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","sectionhead"],["roletype","widget"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-colcount":null,"aria-rowcount":null},relatedConcepts:[{concept:{name:"table"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["row"],["row","rowgroup"]],requiredProps:{},superClass:[["roletype","structure","section"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-level":null,"aria-multiselectable":null,"aria-orientation":"horizontal"},relatedConcepts:[{module:"DAISY",concept:{name:"guide"}}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["tab"]],requiredProps:{},superClass:[["roletype","widget","composite"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"dfn"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-activedescendant":null,"aria-autocomplete":null,"aria-errormessage":null,"aria-haspopup":null,"aria-invalid":null,"aria-multiline":null,"aria-placeholder":null,"aria-readonly":null,"aria-required":null},relatedConcepts:[{concept:{attributes:[{constraints:["undefined"],name:"type"},{constraints:["undefined"],name:"list"}],name:"input"},module:"HTML"},{concept:{attributes:[{constraints:["undefined"],name:"list"},{name:"type",value:"email"}],name:"input"},module:"HTML"},{concept:{attributes:[{constraints:["undefined"],name:"list"},{name:"type",value:"tel"}],name:"input"},module:"HTML"},{concept:{attributes:[{constraints:["undefined"],name:"list"},{name:"type",value:"text"}],name:"input"},module:"HTML"},{concept:{attributes:[{constraints:["undefined"],name:"list"},{name:"type",value:"url"}],name:"input"},module:"HTML"},{concept:{name:"input"},module:"XForms"},{concept:{name:"textarea"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","input"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","status"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-orientation":"horizontal"},relatedConcepts:[{concept:{name:"menubar"},module:"ARIA"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","group"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-invalid":null,"aria-multiselectable":null,"aria-required":null,"aria-orientation":"vertical"},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["treeitem","group"],["treeitem"]],requiredProps:{},superClass:[["roletype","widget","composite","select"],["roletype","structure","section","group","select"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["row"],["row","rowgroup"]],requiredProps:{},superClass:[["roletype","widget","composite","grid"],["roletype","structure","section","table","grid"],["roletype","widget","composite","select","tree"],["roletype","structure","section","group","select","tree"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-expanded":null,"aria-haspopup":null},relatedConcepts:[],requireContextRole:["group","tree"],requiredContextRole:["group","tree"],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","listitem"],["roletype","widget","input","option"]]};t.default=n},function(e,t,a){"use strict";var n=a(228);a(92)(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a(252)),r=n(a(1237)),s=n(a(1238)),o=n(a(1239)),l=n(a(1240)),c=n(a(1241)),u=n(a(1242)),d=n(a(1243)),p=n(a(1244)),m=n(a(1245)),f=n(a(1246)),g=n(a(1247)),b=n(a(1248)),h=n(a(1249)),y=n(a(1250)),v=n(a(1251)),E=n(a(1252)),T=n(a(1253)),k=n(a(1254)),x=n(a(1255)),S=n(a(1256)),w=n(a(1257)),O=n(a(1258)),j=n(a(1259)),C=n(a(1260)),I=n(a(1261)),M=n(a(1262)),A=n(a(1263)),q=n(a(1264)),D=n(a(1265)),P=n(a(1266)),R=n(a(1267)),F=n(a(1268)),_=n(a(1269)),N=n(a(1270)),L=n(a(1271)),B=n(a(1272)),z=n(a(1273)),H=n(a(1274)),U=n(a(1275)),$=new i.default([["doc-abstract",r.default],["doc-acknowledgments",s.default],["doc-afterword",o.default],["doc-appendix",l.default],["doc-backlink",c.default],["doc-biblioentry",u.default],["doc-bibliography",d.default],["doc-biblioref",p.default],["doc-chapter",m.default],["doc-colophon",f.default],["doc-conclusion",g.default],["doc-cover",b.default],["doc-credit",h.default],["doc-credits",y.default],["doc-dedication",v.default],["doc-endnote",E.default],["doc-endnotes",T.default],["doc-epigraph",k.default],["doc-epilogue",x.default],["doc-errata",S.default],["doc-example",w.default],["doc-footnote",O.default],["doc-foreword",j.default],["doc-glossary",C.default],["doc-glossref",I.default],["doc-index",M.default],["doc-introduction",A.default],["doc-noteref",q.default],["doc-notice",D.default],["doc-pagebreak",P.default],["doc-pagelist",R.default],["doc-part",F.default],["doc-preface",_.default],["doc-prologue",N.default],["doc-pullquote",L.default],["doc-qna",B.default],["doc-subtitle",z.default],["doc-tip",H.default],["doc-toc",U.default]]);t.default=$},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"abstract [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"acknowledgments [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"afterword [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"appendix [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","content"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"referrer [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","command","link"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"EPUB biblioentry [EPUB-SSV]"},module:"EPUB"}],requireContextRole:["doc-bibliography"],requiredContextRole:["doc-bibliography"],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","listitem"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"bibliography [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["doc-biblioentry"]],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"biblioref [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","command","link"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"chapter [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"colophon [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"conclusion [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"cover [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","img"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"credit [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"credits [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"dedication [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"rearnote [EPUB-SSV]"},module:"EPUB"}],requireContextRole:["doc-endnotes"],requiredContextRole:["doc-endnotes"],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","listitem"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"rearnotes [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["doc-endnote"]],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"epigraph [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"epilogue [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"errata [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"footnote [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"foreword [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"glossary [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["definition"],["term"]],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"glossref [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","command","link"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"index [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark","navigation"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"introduction [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"noteref [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","command","link"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"notice [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","note"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"pagebreak [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","separator"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"page-list [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark","navigation"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"part [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"preface [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"prologue [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"pullquote [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["none"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"qna [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"subtitle [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","sectionhead"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"help [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","note"]]};t.default=n},function(e,t,a){"use strict";a(92)(t,"__esModule",{value:!0}),t.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"toc [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark","navigation"]]};t.default=n},function(e,t,a){"use strict";var n=a(228);a(92)(t,"__esModule",{value:!0}),t.default=void 0;var i,r=n(a(736)),s=n(a(1280)),o=n(a(1300)),l=n(a(1304)),c=n(a(1309)),u=n(a(743)),d=n(a(744)),p=n(a(745)),m=n(a(515)),f=n(a(252)),g=n(a(513)),b=new f.default([]);(0,m.default)(i=(0,p.default)((0,d.default)(g.default).call(g.default))).call(i,(function(e){var t,a,n=g.default.get(e);n&&(0,m.default)(t=(0,u.default)(a=[]).call(a,(0,p.default)(n.baseConcepts),(0,p.default)(n.relatedConcepts))).call(t,(function(t){if("HTML"===t.module){var a=t.concept;if(a){var n,i=(0,c.default)(a),u=((0,l.default)(n=(0,p.default)((0,o.default)(b).call(b))).call(n,(function(e){var t=(0,s.default)(e,2),a=t[0];t[1];return(0,c.default)(a)===i}))||[])[1];u||(u=new r.default([])),u.add(e),b.set(a,u)}}}))}));var h=b;t.default=h},function(e,t,a){var n=a(1278);a(231),e.exports=n},function(e,t,a){a(253),a(342),a(1279),a(305);var n=a(176);e.exports=n.Set},function(e,t,a){"use strict";a(718)("Set",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),a(726))},function(e,t,a){var n=a(1281),i=a(1283),r=a(740),s=a(1299);e.exports=function(e,t){return n(e)||i(e,t)||r(e,t)||s()}},function(e,t,a){var n=a(737);e.exports=function(e){if(n(e))return e}},function(e,t,a){var n=a(728);e.exports=n},function(e,t,a){var n=a(727),i=a(738),r=a(739);e.exports=function(e,t){if(void 0!==r&&i(Object(e))){var a=[],s=!0,o=!1,l=void 0;try{for(var c,u=n(e);!(s=(c=u.next()).done)&&(a.push(c.value),!t||a.length!==t);s=!0);}catch(e){o=!0,l=e}finally{try{s||null==u.return||u.return()}finally{if(o)throw l}}return a}}},function(e,t,a){var n=a(1285);e.exports=n},function(e,t,a){var n=a(1286);a(231),e.exports=n},function(e,t,a){a(253),a(305);var n=a(1287);e.exports=n},function(e,t,a){var n=a(102),i=a(230),r=a(162),s=a(140),o=a(277),l=s("iterator"),c=n.Object;e.exports=function(e){var t=c(e);return void 0!==t[l]||"@@iterator"in t||r(o,i(t))}},function(e,t,a){var n=a(729);a(1289),a(1290),a(1291),a(1292),a(1293),a(1294),a(1295),e.exports=n},function(e,t,a){a(126)("asyncDispose")},function(e,t,a){a(126)("dispose")},function(e,t,a){a(126)("matcher")},function(e,t,a){a(126)("metadata")},function(e,t,a){a(126)("observable")},function(e,t,a){a(126)("patternMatch")},function(e,t,a){a(126)("replaceAll")},function(e,t,a){var n=a(734);e.exports=n},function(e,t,a){e.exports=a(1298)},function(e,t,a){var n=a(735);e.exports=n},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},function(e,t,a){e.exports=a(1301)},function(e,t,a){a(231);var n=a(230),i=a(162),r=a(206),s=a(1302),o=Array.prototype,l={DOMTokenList:!0,NodeList:!0};e.exports=function(e){var t=e.entries;return e===o||r(o,e)&&t===o.entries||i(l,n(e))?s:t}},function(e,t,a){var n=a(1303);e.exports=n},function(e,t,a){a(253),a(342);var n=a(306);e.exports=n("Array").entries},function(e,t,a){e.exports=a(1305)},function(e,t,a){var n=a(1306);e.exports=n},function(e,t,a){var n=a(206),i=a(1307),r=Array.prototype;e.exports=function(e){var t=e.find;return e===r||n(r,e)&&t===r.find?i:t}},function(e,t,a){a(1308);var n=a(306);e.exports=n("Array").find},function(e,t,a){"use strict";var n=a(167),i=a(405).find,r=a(712),s="find",o=!0;s in[]&&Array(1).find((function(){o=!1})),n({target:"Array",proto:!0,forced:o},{find:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),r(s)},function(e,t,a){e.exports=a(1310)},function(e,t,a){var n=a(1311);e.exports=n},function(e,t,a){a(1312);var n=a(176),i=a(396);n.JSON||(n.JSON={stringify:JSON.stringify}),e.exports=function(e,t,a){return i(n.JSON.stringify,null,arguments)}},function(e,t,a){var n=a(167),i=a(102),r=a(275),s=a(396),o=a(133),l=a(134),c=i.Array,u=r("JSON","stringify"),d=o(/./.exec),p=o("".charAt),m=o("".charCodeAt),f=o("".replace),g=o(1..toString),b=/[\uD800-\uDFFF]/g,h=/^[\uD800-\uDBFF]$/,y=/^[\uDC00-\uDFFF]$/,v=function(e,t,a){var n=p(a,t-1),i=p(a,t+1);return d(h,e)&&!d(y,i)||d(y,e)&&!d(h,n)?"\\u"+g(m(e,0),16):e},E=l((function(){return'"\\udf06\\ud834"'!==u("\udf06\ud834")||'"\\udead"'!==u("\udead")}));u&&n({target:"JSON",stat:!0,forced:E},{stringify:function(e,t,a){for(var n=0,i=arguments.length,r=c(i);n<i;n++)r[n]=arguments[n];var o=s(u,null,r);return"string"==typeof o?f(o,b,v):o}})},function(e,t,a){var n=a(1314);e.exports=n},function(e,t,a){var n=a(206),i=a(1315),r=Array.prototype;e.exports=function(e){var t=e.concat;return e===r||n(r,e)&&t===r.concat?i:t}},function(e,t,a){a(730);var n=a(306);e.exports=n("Array").concat},function(e,t,a){a(231);var n=a(230),i=a(162),r=a(206),s=a(1317),o=Array.prototype,l={DOMTokenList:!0,NodeList:!0};e.exports=function(e){var t=e.keys;return e===o||r(o,e)&&t===o.keys||i(l,n(e))?s:t}},function(e,t,a){var n=a(1318);e.exports=n},function(e,t,a){a(253),a(342);var n=a(306);e.exports=n("Array").keys},function(e,t,a){var n=a(737),i=a(742);e.exports=function(e){if(n(e))return i(e)}},function(e,t,a){var n=a(741),i=a(738),r=a(739);e.exports=function(e){if(void 0!==r&&i(Object(e)))return n(e)}},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},function(e,t,a){"use strict";var n=a(228);a(92)(t,"__esModule",{value:!0}),t.default=void 0;var i,r=n(a(736)),s=n(a(743)),o=n(a(744)),l=n(a(745)),c=n(a(515)),u=n(a(252)),d=n(a(513)),p=new u.default([]);(0,c.default)(i=(0,l.default)((0,o.default)(d.default).call(d.default))).call(i,(function(e){var t,a,n=d.default.get(e);n&&(0,c.default)(t=(0,s.default)(a=[]).call(a,(0,l.default)(n.baseConcepts),(0,l.default)(n.relatedConcepts))).call(t,(function(t){if("HTML"===t.module){var a=t.concept;if(a){var n=p.get(e)||new r.default([]);n.add(a),p.set(e,n)}}}))}));var m=p;t.default=m},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.findByPlaceholderText=t.findAllByPlaceholderText=t.getAllByPlaceholderText=t.getByPlaceholderText=t.queryAllByPlaceholderText=t.queryByPlaceholderText=void 0;var n=a(227),i=a(161),r=a(249);function s(...e){return(0,i.checkContainerType)(...e),(0,r.queryAllByAttribute)("placeholder",...e)}const o=(0,n.wrapAllByQueryWithSuggestion)(s,s.name,"queryAll");t.queryAllByPlaceholderText=o;const[l,c,u,d,p]=(0,r.buildQueries)(s,((e,t)=>`Found multiple elements with the placeholder text of: ${t}`),((e,t)=>`Unable to find an element with the placeholder text of: ${t}`));t.findByPlaceholderText=p,t.findAllByPlaceholderText=d,t.getByPlaceholderText=u,t.getAllByPlaceholderText=c,t.queryByPlaceholderText=l},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.findByText=t.findAllByText=t.getAllByText=t.getByText=t.queryAllByText=t.queryByText=void 0;var n=a(227),i=a(161),r=a(204),s=a(249);function o(e,t,{selector:a="*",exact:n=!0,collapseWhitespace:o,trim:l,ignore:c=r.DEFAULT_IGNORE_TAGS,normalizer:u}={}){(0,i.checkContainerType)(e);const d=n?s.matches:s.fuzzyMatches,p=(0,s.makeNormalizer)({collapseWhitespace:o,trim:l,normalizer:u});let m=[];return"function"==typeof e.matches&&e.matches(a)&&(m=[e]),[...m,...Array.from(e.querySelectorAll(a))].filter((e=>!c||!e.matches(c))).filter((e=>d((0,s.getNodeText)(e),e,t,p)))}const l=(0,n.wrapAllByQueryWithSuggestion)(o,o.name,"queryAll");t.queryAllByText=l;const[c,u,d,p,m]=(0,s.buildQueries)(o,((e,t)=>`Found multiple elements with the text: ${t}`),((e,t)=>`Unable to find an element with the text: ${t}. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.`));t.findByText=m,t.findAllByText=p,t.getByText=d,t.getAllByText=u,t.queryByText=c},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.findByDisplayValue=t.findAllByDisplayValue=t.getAllByDisplayValue=t.getByDisplayValue=t.queryAllByDisplayValue=t.queryByDisplayValue=void 0;var n=a(227),i=a(161),r=a(249);function s(e,t,{exact:a=!0,collapseWhitespace:n,trim:s,normalizer:o}={}){(0,i.checkContainerType)(e);const l=a?r.matches:r.fuzzyMatches,c=(0,r.makeNormalizer)({collapseWhitespace:n,trim:s,normalizer:o});return Array.from(e.querySelectorAll("input,textarea,select")).filter((e=>{if("SELECT"===e.tagName){return Array.from(e.options).filter((e=>e.selected)).some((e=>l((0,r.getNodeText)(e),e,t,c)))}return l(e.value,e,t,c)}))}const o=(0,n.wrapAllByQueryWithSuggestion)(s,s.name,"queryAll");t.queryAllByDisplayValue=o;const[l,c,u,d,p]=(0,r.buildQueries)(s,((e,t)=>`Found multiple elements with the display value: ${t}.`),((e,t)=>`Unable to find an element with the display value: ${t}.`));t.findByDisplayValue=p,t.findAllByDisplayValue=d,t.getByDisplayValue=u,t.getAllByDisplayValue=c,t.queryByDisplayValue=l},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.findByAltText=t.findAllByAltText=t.getAllByAltText=t.getByAltText=t.queryAllByAltText=t.queryByAltText=void 0;var n=a(227),i=a(161),r=a(249);function s(e,t,{exact:a=!0,collapseWhitespace:n,trim:s,normalizer:o}={}){(0,i.checkContainerType)(e);const l=a?r.matches:r.fuzzyMatches,c=(0,r.makeNormalizer)({collapseWhitespace:n,trim:s,normalizer:o});return Array.from(e.querySelectorAll("img,input,area")).filter((e=>l(e.getAttribute("alt"),e,t,c)))}const o=(0,n.wrapAllByQueryWithSuggestion)(s,s.name,"queryAll");t.queryAllByAltText=o;const[l,c,u,d,p]=(0,r.buildQueries)(s,((e,t)=>`Found multiple elements with the alt text: ${t}`),((e,t)=>`Unable to find an element with the alt text: ${t}`));t.findByAltText=p,t.findAllByAltText=d,t.getByAltText=u,t.getAllByAltText=c,t.queryByAltText=l},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.findByTitle=t.findAllByTitle=t.getAllByTitle=t.getByTitle=t.queryAllByTitle=t.queryByTitle=void 0;var n=a(227),i=a(161),r=a(249);function s(e,t,{exact:a=!0,collapseWhitespace:n,trim:s,normalizer:o}={}){(0,i.checkContainerType)(e);const l=a?r.matches:r.fuzzyMatches,c=(0,r.makeNormalizer)({collapseWhitespace:n,trim:s,normalizer:o});return Array.from(e.querySelectorAll("[title], svg > title")).filter((e=>l(e.getAttribute("title"),e,t,c)||(e=>{var t;return"title"===e.tagName.toLowerCase()&&"svg"===(null==(t=e.parentElement)?void 0:t.tagName.toLowerCase())})(e)&&l((0,r.getNodeText)(e),e,t,c)))}const o=(0,n.wrapAllByQueryWithSuggestion)(s,s.name,"queryAll");t.queryAllByTitle=o;const[l,c,u,d,p]=(0,r.buildQueries)(s,((e,t)=>`Found multiple elements with the title: ${t}.`),((e,t)=>`Unable to find an element with the title: ${t}.`));t.findByTitle=p,t.findAllByTitle=d,t.getByTitle=u,t.getAllByTitle=c,t.queryByTitle=l},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.findByRole=t.findAllByRole=t.getByRole=t.getAllByRole=t.queryAllByRole=t.queryByRole=void 0;var n=a(491),i=a(706),r=a(492),s=a(227),o=a(161),l=a(249);function c(e,t,{exact:a=!0,collapseWhitespace:s,hidden:c=(0,l.getConfig)().defaultHidden,name:u,trim:d,normalizer:p,queryFallbacks:m=!1,selected:f,checked:g,pressed:b,level:h,expanded:y}={}){(0,o.checkContainerType)(e);const v=a?l.matches:l.fuzzyMatches,E=(0,l.makeNormalizer)({collapseWhitespace:s,trim:d,normalizer:p});var T,k,x,S;if(void 0!==f&&void 0===(null==(T=i.roles.get(t))?void 0:T.props["aria-selected"]))throw new Error(`"aria-selected" is not supported on role "${t}".`);if(void 0!==g&&void 0===(null==(k=i.roles.get(t))?void 0:k.props["aria-checked"]))throw new Error(`"aria-checked" is not supported on role "${t}".`);if(void 0!==b&&void 0===(null==(x=i.roles.get(t))?void 0:x.props["aria-pressed"]))throw new Error(`"aria-pressed" is not supported on role "${t}".`);if(void 0!==h&&"heading"!==t)throw new Error(`Role "${t}" cannot have "level" property.`);if(void 0!==y&&void 0===(null==(S=i.roles.get(t))?void 0:S.props["aria-expanded"]))throw new Error(`"aria-expanded" is not supported on role "${t}".`);const w=new WeakMap;function O(e){return w.has(e)||w.set(e,(0,r.isSubtreeInaccessible)(e)),w.get(e)}return Array.from(e.querySelectorAll("*")).filter((e=>{if(e.hasAttribute("role")){const a=e.getAttribute("role");if(m)return a.split(" ").filter(Boolean).some((a=>v(a,e,t,E)));if(p)return v(a,e,t,E);const[n]=a.split(" ");return v(n,e,t,E)}return(0,r.getImplicitAriaRoles)(e).some((a=>v(a,e,t,E)))})).filter((e=>void 0!==f?f===(0,r.computeAriaSelected)(e):void 0!==g?g===(0,r.computeAriaChecked)(e):void 0!==b?b===(0,r.computeAriaPressed)(e):void 0!==y?y===(0,r.computeAriaExpanded)(e):void 0===h||h===(0,r.computeHeadingLevel)(e))).filter((e=>!1!==c||!1===(0,r.isInaccessible)(e,{isSubtreeInaccessible:O}))).filter((e=>void 0===u||(0,l.matches)((0,n.computeAccessibleName)(e,{computedStyleSupportsPseudoElements:(0,l.getConfig)().computedStyleSupportsPseudoElements}),e,u,(e=>e))))}const u=(0,s.wrapAllByQueryWithSuggestion)(c,c.name,"queryAll");t.queryAllByRole=u;const[d,p,m,f,g]=(0,l.buildQueries)(c,((e,t,{name:a}={})=>{let n="";return n=void 0===a?"":"string"==typeof a?` and name "${a}"`:` and name \`${a}\``,`Found multiple elements with the role "${t}"${n}`}),((e,t,{hidden:a=(0,l.getConfig)().defaultHidden,name:n}={})=>{if((0,l.getConfig)()._disableExpensiveErrorDiagnostics)return`Unable to find role="${t}"`;let i,s="";Array.from(e.children).forEach((e=>{s+=(0,r.prettyRoles)(e,{hidden:a,includeName:void 0!==n})})),i=0===s.length?!1===a?"There are no accessible roles. But there might be some inaccessible roles. If you wish to access them, then set the `hidden` option to `true`. Learn more about this here: https://testing-library.com/docs/dom-testing-library/api-queries#byrole":"There are no available roles.":`\nHere are the ${!1===a?"accessible":"available"} roles:\n\n  ${s.replace(/\n/g,"\n  ").replace(/\n\s\s\n/g,"\n\n")}\n`.trim();let o="";return o=void 0===n?"":"string"==typeof n?` and name "${n}"`:` and name \`${n}\``,`\nUnable to find an ${!1===a?"accessible ":""}element with the role "${t}"${o}\n\n${i}`.trim()}));t.findByRole=g,t.findAllByRole=f,t.getByRole=m,t.getAllByRole=p,t.queryByRole=d},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.findByTestId=t.findAllByTestId=t.getAllByTestId=t.getByTestId=t.queryAllByTestId=t.queryByTestId=void 0;var n=a(161),i=a(227),r=a(249);const s=()=>(0,r.getConfig)().testIdAttribute;function o(...e){return(0,n.checkContainerType)(...e),(0,r.queryAllByAttribute)(s(),...e)}const l=(0,i.wrapAllByQueryWithSuggestion)(o,o.name,"queryAll");t.queryAllByTestId=l;const[c,u,d,p,m]=(0,r.buildQueries)(o,((e,t)=>`Found multiple elements by: [${s()}="${t}"]`),((e,t)=>`Unable to find an element by: [${s()}="${t}"]`));t.findByTestId=m,t.findAllByTestId=p,t.getByTestId=d,t.getAllByTestId=u,t.queryByTestId=c},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.waitForElement=async function(e,t){i||(i=!0,console.warn("`waitForElement` has been deprecated. Use a `find*` query (preferred: https://testing-library.com/docs/dom-testing-library/api-queries#findby) or use `waitFor` instead: https://testing-library.com/docs/dom-testing-library/api-async#waitfor"));if(!e)throw new Error("waitForElement requires a callback as the first parameter");return(0,n.waitFor)((()=>{const t=e();if(!t)throw new Error("Timed out in waitForElement.");return t}),t)};var n=a(406);let i=!1},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.waitForElementToBeRemoved=async function(e,t){const a=new Error("Timed out in waitForElementToBeRemoved.");if("function"!=typeof e){r(e);const t=(Array.isArray(e)?e:[e]).map((e=>{let t=e.parentElement;if(null===t)return()=>null;for(;t.parentElement;)t=t.parentElement;return()=>t.contains(e)?e:null}));e=()=>t.map((e=>e())).filter(Boolean)}return r(e()),(0,n.waitFor)((()=>{let t;try{t=e()}catch(e){if("TestingLibraryElementError"===e.name)return;throw e}if(!i(t))throw a}),t)};var n=a(406);const i=e=>!e||Array.isArray(e)&&!e.length;function r(e){if(i(e))throw new Error("The element(s) given to waitForElementToBeRemoved are already removed. waitForElementToBeRemoved requires that the element(s) exist(s) before waiting for removal.")}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.waitForDomChange=function(...e){return(0,i.getConfig)().asyncWrapper((()=>function({container:e=(0,n.getDocument)(),timeout:t=(0,i.getConfig)().asyncUtilTimeout,mutationObserverOptions:a={subtree:!0,childList:!0,attributes:!0,characterData:!0}}={}){r||(r=!0,console.warn("`waitForDomChange` has been deprecated. Use `waitFor` instead: https://testing-library.com/docs/dom-testing-library/api-async#waitfor."));return new Promise(((i,r)=>{const s=(0,n.setTimeout)(d,t),{MutationObserver:o}=(0,n.getWindowFromNode)(e),l=new o(u);function c(e,t){(0,n.clearTimeout)(s),(0,n.setImmediate)((()=>l.disconnect())),e?r(e):i(t)}function u(e){c(null,e)}function d(){c(new Error("Timed out in waitForDomChange."),null)}(0,n.runWithRealTimers)((()=>l.observe(e,a)))}))}(...e)))};var n=a(161),i=a(204);let r=!1},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fireEvent=s,t.createEvent=o;var n=a(204),i=a(161),r=a(1334);function s(e,t){return(0,n.getConfig)().eventWrapper((()=>{if(!t)throw new Error("Unable to fire an event - please provide an event object.");if(!e)throw new Error(`Unable to fire a "${t.type}" event - please provide a DOM element.`);return e.dispatchEvent(t)}))}function o(e,t,a,{EventType:n="Event",defaultInit:r={}}={}){if(!t)throw new Error(`Unable to fire a "${e}" event - please provide a DOM element.`);const s={...r,...a},{target:{value:o,files:l,...c}={}}=s;void 0!==o&&function(e,t){const{set:a}=Object.getOwnPropertyDescriptor(e,"value")||{},n=Object.getPrototypeOf(e),{set:i}=Object.getOwnPropertyDescriptor(n,"value")||{};if(i&&a!==i)i.call(e,t);else{if(!a)throw new Error("The given element does not have a value setter");a.call(e,t)}}(t,o),void 0!==l&&Object.defineProperty(t,"files",{configurable:!0,enumerable:!0,writable:!0,value:l}),Object.assign(t,c);const u=(0,i.getWindowFromNode)(t),d=u[n]||u.Event;let p;if("function"==typeof d)p=new d(e,s);else{p=u.document.createEvent(n);const{bubbles:t,cancelable:a,detail:i,...r}=s;p.initEvent(e,t,a,i),Object.keys(r).forEach((e=>{p[e]=r[e]}))}return["dataTransfer","clipboardData"].forEach((e=>{const t=s[e];"object"==typeof t&&("function"==typeof u.DataTransfer?Object.defineProperty(p,e,{value:Object.getOwnPropertyNames(t).reduce(((e,a)=>(Object.defineProperty(e,a,{value:t[a]}),e)),new u.DataTransfer)}):Object.defineProperty(p,e,{value:t}))})),p}Object.keys(r.eventMap).forEach((e=>{const{EventType:t,defaultInit:a}=r.eventMap[e],n=e.toLowerCase();o[e]=(e,i)=>o(n,e,i,{EventType:t,defaultInit:a}),s[e]=(t,a)=>s(t,o[e](t,a))})),Object.keys(r.eventAliasMap).forEach((e=>{const t=r.eventAliasMap[e];s[e]=(...e)=>s[t](...e)}))},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.eventAliasMap=t.eventMap=void 0;t.eventMap={copy:{EventType:"ClipboardEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},cut:{EventType:"ClipboardEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},paste:{EventType:"ClipboardEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},compositionEnd:{EventType:"CompositionEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},compositionStart:{EventType:"CompositionEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},compositionUpdate:{EventType:"CompositionEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},keyDown:{EventType:"KeyboardEvent",defaultInit:{bubbles:!0,cancelable:!0,charCode:0,composed:!0}},keyPress:{EventType:"KeyboardEvent",defaultInit:{bubbles:!0,cancelable:!0,charCode:0,composed:!0}},keyUp:{EventType:"KeyboardEvent",defaultInit:{bubbles:!0,cancelable:!0,charCode:0,composed:!0}},focus:{EventType:"FocusEvent",defaultInit:{bubbles:!1,cancelable:!1,composed:!0}},blur:{EventType:"FocusEvent",defaultInit:{bubbles:!1,cancelable:!1,composed:!0}},focusIn:{EventType:"FocusEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},focusOut:{EventType:"FocusEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},change:{EventType:"Event",defaultInit:{bubbles:!0,cancelable:!1}},input:{EventType:"InputEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},invalid:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!0}},submit:{EventType:"Event",defaultInit:{bubbles:!0,cancelable:!0}},reset:{EventType:"Event",defaultInit:{bubbles:!0,cancelable:!0}},click:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,button:0,composed:!0}},contextMenu:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},dblClick:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},drag:{EventType:"DragEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},dragEnd:{EventType:"DragEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},dragEnter:{EventType:"DragEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},dragExit:{EventType:"DragEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},dragLeave:{EventType:"DragEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},dragOver:{EventType:"DragEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},dragStart:{EventType:"DragEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},drop:{EventType:"DragEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},mouseDown:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},mouseEnter:{EventType:"MouseEvent",defaultInit:{bubbles:!1,cancelable:!1,composed:!0}},mouseLeave:{EventType:"MouseEvent",defaultInit:{bubbles:!1,cancelable:!1,composed:!0}},mouseMove:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},mouseOut:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},mouseOver:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},mouseUp:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},select:{EventType:"Event",defaultInit:{bubbles:!0,cancelable:!1}},touchCancel:{EventType:"TouchEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},touchEnd:{EventType:"TouchEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},touchMove:{EventType:"TouchEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},touchStart:{EventType:"TouchEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},scroll:{EventType:"UIEvent",defaultInit:{bubbles:!1,cancelable:!1}},wheel:{EventType:"WheelEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},abort:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},canPlay:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},canPlayThrough:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},durationChange:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},emptied:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},encrypted:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},ended:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},loadedData:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},loadedMetadata:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},loadStart:{EventType:"ProgressEvent",defaultInit:{bubbles:!1,cancelable:!1}},pause:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},play:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},playing:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},progress:{EventType:"ProgressEvent",defaultInit:{bubbles:!1,cancelable:!1}},rateChange:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},seeked:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},seeking:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},stalled:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},suspend:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},timeUpdate:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},volumeChange:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},waiting:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},load:{EventType:"UIEvent",defaultInit:{bubbles:!1,cancelable:!1}},error:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},animationStart:{EventType:"AnimationEvent",defaultInit:{bubbles:!0,cancelable:!1}},animationEnd:{EventType:"AnimationEvent",defaultInit:{bubbles:!0,cancelable:!1}},animationIteration:{EventType:"AnimationEvent",defaultInit:{bubbles:!0,cancelable:!1}},transitionEnd:{EventType:"TransitionEvent",defaultInit:{bubbles:!0,cancelable:!0}},pointerOver:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},pointerEnter:{EventType:"PointerEvent",defaultInit:{bubbles:!1,cancelable:!1}},pointerDown:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},pointerMove:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},pointerUp:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},pointerCancel:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},pointerOut:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},pointerLeave:{EventType:"PointerEvent",defaultInit:{bubbles:!1,cancelable:!1}},gotPointerCapture:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},lostPointerCapture:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},popState:{EventType:"PopStateEvent",defaultInit:{bubbles:!0,cancelable:!1}}};t.eventAliasMap={doubleClick:"dblClick"}},function(e,t,a){"use strict";var n=a(258);Object.defineProperty(t,"__esModule",{value:!0}),t.screen=void 0;var i=a(1336),r=n(a(488)),s=a(698),o=a(392),l=a(161);function c(e){return`https://testing-playground.com/#markup=${t=e,(0,i.compressToEncodedURIComponent)(t.replace(/[ \t]*[\n][ \t]*/g,"\n"))}`;var t}const u={debug:(e,t,a)=>Array.isArray(e)?e.forEach((e=>(0,o.logDOM)(e,t,a))):(0,o.logDOM)(e,t,a),logTestingPlaygroundURL:(e=(0,l.getDocument)().body)=>{e&&"innerHTML"in e?e.innerHTML?console.log(`Open this URL in your browser\n\n${c(e.innerHTML)}`):console.log("The provided element doesn't have any children."):console.log("The element you're providing isn't a valid DOM element.")}},d="undefined"!=typeof document&&document.body?(0,s.getQueriesForElement)(document.body,r,u):Object.keys(r).reduce(((e,t)=>(e[t]=()=>{throw new TypeError("For queries bound to document.body a global document has to be available... Learn more: https://testing-library.com/s/screen-global-error")},e)),u);t.screen=d},function(e,t,a){var n,i=function(){var e=String.fromCharCode,t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",n={};function i(e,t){if(!n[e]){n[e]={};for(var a=0;a<e.length;a++)n[e][e.charAt(a)]=a}return n[e][t]}var r={compressToBase64:function(e){if(null==e)return"";var a=r._compress(e,6,(function(e){return t.charAt(e)}));switch(a.length%4){default:case 0:return a;case 1:return a+"===";case 2:return a+"==";case 3:return a+"="}},decompressFromBase64:function(e){return null==e?"":""==e?null:r._decompress(e.length,32,(function(a){return i(t,e.charAt(a))}))},compressToUTF16:function(t){return null==t?"":r._compress(t,15,(function(t){return e(t+32)}))+" "},decompressFromUTF16:function(e){return null==e?"":""==e?null:r._decompress(e.length,16384,(function(t){return e.charCodeAt(t)-32}))},compressToUint8Array:function(e){for(var t=r.compress(e),a=new Uint8Array(2*t.length),n=0,i=t.length;n<i;n++){var s=t.charCodeAt(n);a[2*n]=s>>>8,a[2*n+1]=s%256}return a},decompressFromUint8Array:function(t){if(null==t)return r.decompress(t);for(var a=new Array(t.length/2),n=0,i=a.length;n<i;n++)a[n]=256*t[2*n]+t[2*n+1];var s=[];return a.forEach((function(t){s.push(e(t))})),r.decompress(s.join(""))},compressToEncodedURIComponent:function(e){return null==e?"":r._compress(e,6,(function(e){return a.charAt(e)}))},decompressFromEncodedURIComponent:function(e){return null==e?"":""==e?null:(e=e.replace(/ /g,"+"),r._decompress(e.length,32,(function(t){return i(a,e.charAt(t))})))},compress:function(t){return r._compress(t,16,(function(t){return e(t)}))},_compress:function(e,t,a){if(null==e)return"";var n,i,r,s={},o={},l="",c="",u="",d=2,p=3,m=2,f=[],g=0,b=0;for(r=0;r<e.length;r+=1)if(l=e.charAt(r),Object.prototype.hasOwnProperty.call(s,l)||(s[l]=p++,o[l]=!0),c=u+l,Object.prototype.hasOwnProperty.call(s,c))u=c;else{if(Object.prototype.hasOwnProperty.call(o,u)){if(u.charCodeAt(0)<256){for(n=0;n<m;n++)g<<=1,b==t-1?(b=0,f.push(a(g)),g=0):b++;for(i=u.charCodeAt(0),n=0;n<8;n++)g=g<<1|1&i,b==t-1?(b=0,f.push(a(g)),g=0):b++,i>>=1}else{for(i=1,n=0;n<m;n++)g=g<<1|i,b==t-1?(b=0,f.push(a(g)),g=0):b++,i=0;for(i=u.charCodeAt(0),n=0;n<16;n++)g=g<<1|1&i,b==t-1?(b=0,f.push(a(g)),g=0):b++,i>>=1}0==--d&&(d=Math.pow(2,m),m++),delete o[u]}else for(i=s[u],n=0;n<m;n++)g=g<<1|1&i,b==t-1?(b=0,f.push(a(g)),g=0):b++,i>>=1;0==--d&&(d=Math.pow(2,m),m++),s[c]=p++,u=String(l)}if(""!==u){if(Object.prototype.hasOwnProperty.call(o,u)){if(u.charCodeAt(0)<256){for(n=0;n<m;n++)g<<=1,b==t-1?(b=0,f.push(a(g)),g=0):b++;for(i=u.charCodeAt(0),n=0;n<8;n++)g=g<<1|1&i,b==t-1?(b=0,f.push(a(g)),g=0):b++,i>>=1}else{for(i=1,n=0;n<m;n++)g=g<<1|i,b==t-1?(b=0,f.push(a(g)),g=0):b++,i=0;for(i=u.charCodeAt(0),n=0;n<16;n++)g=g<<1|1&i,b==t-1?(b=0,f.push(a(g)),g=0):b++,i>>=1}0==--d&&(d=Math.pow(2,m),m++),delete o[u]}else for(i=s[u],n=0;n<m;n++)g=g<<1|1&i,b==t-1?(b=0,f.push(a(g)),g=0):b++,i>>=1;0==--d&&(d=Math.pow(2,m),m++)}for(i=2,n=0;n<m;n++)g=g<<1|1&i,b==t-1?(b=0,f.push(a(g)),g=0):b++,i>>=1;for(;;){if(g<<=1,b==t-1){f.push(a(g));break}b++}return f.join("")},decompress:function(e){return null==e?"":""==e?null:r._decompress(e.length,32768,(function(t){return e.charCodeAt(t)}))},_decompress:function(t,a,n){var i,r,s,o,l,c,u,d=[],p=4,m=4,f=3,g="",b=[],h={val:n(0),position:a,index:1};for(i=0;i<3;i+=1)d[i]=i;for(s=0,l=Math.pow(2,2),c=1;c!=l;)o=h.val&h.position,h.position>>=1,0==h.position&&(h.position=a,h.val=n(h.index++)),s|=(o>0?1:0)*c,c<<=1;switch(s){case 0:for(s=0,l=Math.pow(2,8),c=1;c!=l;)o=h.val&h.position,h.position>>=1,0==h.position&&(h.position=a,h.val=n(h.index++)),s|=(o>0?1:0)*c,c<<=1;u=e(s);break;case 1:for(s=0,l=Math.pow(2,16),c=1;c!=l;)o=h.val&h.position,h.position>>=1,0==h.position&&(h.position=a,h.val=n(h.index++)),s|=(o>0?1:0)*c,c<<=1;u=e(s);break;case 2:return""}for(d[3]=u,r=u,b.push(u);;){if(h.index>t)return"";for(s=0,l=Math.pow(2,f),c=1;c!=l;)o=h.val&h.position,h.position>>=1,0==h.position&&(h.position=a,h.val=n(h.index++)),s|=(o>0?1:0)*c,c<<=1;switch(u=s){case 0:for(s=0,l=Math.pow(2,8),c=1;c!=l;)o=h.val&h.position,h.position>>=1,0==h.position&&(h.position=a,h.val=n(h.index++)),s|=(o>0?1:0)*c,c<<=1;d[m++]=e(s),u=m-1,p--;break;case 1:for(s=0,l=Math.pow(2,16),c=1;c!=l;)o=h.val&h.position,h.position>>=1,0==h.position&&(h.position=a,h.val=n(h.index++)),s|=(o>0?1:0)*c,c<<=1;d[m++]=e(s),u=m-1,p--;break;case 2:return b.join("")}if(0==p&&(p=Math.pow(2,f),f++),d[u])g=d[u];else{if(u!==m)return null;g=r+r.charAt(0)}b.push(g),d[m++]=r+g.charAt(0),r=g,0==--p&&(p=Math.pow(2,f),f++)}}};return r}();void 0===(n=function(){return i}.call(t,a,t,e))||(e.exports=n)},function(e,t,a){"use strict";var n=a(157),i=a(258);Object.defineProperty(t,"__esModule",{value:!0}),t.asyncAct=function(e){if(!0===l){if(null===d)return new Promise(((t,a)=>{const n=console.error;let i,r;console.error=function(...e){const t="string"==typeof e[0];t&&0===e[0].indexOf("Warning: Do not await the result of calling ReactTestUtils.act")?d=!1:t&&0===e[0].indexOf("Warning: The callback passed to ReactTestUtils.act(...) function must not return anything")||n.apply(console,e)};try{r=o((()=>(i=e(),i)))}catch(e){return console.error=n,void a(e)}r.then((()=>{console.error=n,d=!0,t()}),(e=>{console.error=n,d=!0,a(e)})),!1===d&&(console.error=n,u||(console.error('It looks like you\'re using a version of react-dom that supports the "act" function, but not an awaitable version of "act" which you will need. Please upgrade to at least react-dom@16.9.0 to remove this warning.'),u=!0),i.then((()=>{Promise.resolve().then((()=>{c((()=>{})),t()}))}),a))}));if(!1===d){let t;return c((()=>{t=e()})),t.then((()=>Promise.resolve().then((()=>{c((()=>{}))}))))}return c(e)}let t;return c((()=>{t=e()})),t.then((()=>Promise.resolve().then((()=>{c((()=>{}))}))))},t.default=void 0;var r=i(a(9)),s=n(a(71));const o=i(a(1338)).act,l=void 0!==o;const c=o||function(e){s.default.unstable_batchedUpdates(e),s.default.render(r.createElement("div",null),document.createElement("div"))};let u=!1,d=null;var p=c;t.default=p},function(e,t,a){"use strict";e.exports=a(1339)},function(e,t,a){"use strict";(function(e){
/** @license React v16.12.0
 * react-dom-test-utils.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
var t=a(1340),n=a(9),i=a(71),r=a(1341);function s(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,a=1;a<arguments.length;a++)t+="&args[]="+encodeURIComponent(arguments[a]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function l(e){var t=e,a=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!=(1026&(t=e).effectTag)&&(a=t.return),e=t.return}while(e)}return 3===t.tag?a:null}function c(e){if(l(e)!==e)throw Error(s(188))}function u(){return!0}function d(){return!1}function p(e,t,a,n){for(var i in this.dispatchConfig=e,this._targetInst=t,this.nativeEvent=a,e=this.constructor.Interface)e.hasOwnProperty(i)&&((t=e[i])?this[i]=t(a):"target"===i?this.target=n:this[i]=a[i]);return this.isDefaultPrevented=(null!=a.defaultPrevented?a.defaultPrevented:!1===a.returnValue)?u:d,this.isPropagationStopped=d,this}function m(e,t,a,n){if(this.eventPool.length){var i=this.eventPool.pop();return this.call(i,e,t,a,n),i}return new this(e,t,a,n)}function f(e){if(!(e instanceof this))throw Error(s(279));e.destructor(),10>this.eventPool.length&&this.eventPool.push(e)}function g(e){e.eventPool=[],e.getPooled=m,e.release=f}o.hasOwnProperty("ReactCurrentDispatcher")||(o.ReactCurrentDispatcher={current:null}),o.hasOwnProperty("ReactCurrentBatchConfig")||(o.ReactCurrentBatchConfig={suspense:null}),t(p.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!=typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=u)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!=typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=u)},persist:function(){this.isPersistent=u},isPersistent:d,destructor:function(){var e,t=this.constructor.Interface;for(e in t)this[e]=null;this.nativeEvent=this._targetInst=this.dispatchConfig=null,this.isPropagationStopped=this.isDefaultPrevented=d,this._dispatchInstances=this._dispatchListeners=null}}),p.Interface={type:null,target:null,currentTarget:function(){return null},eventPhase:null,bubbles:null,cancelable:null,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:null,isTrusted:null},p.extend=function(e){function a(){}function n(){return i.apply(this,arguments)}var i=this;a.prototype=i.prototype;var r=new a;return t(r,n.prototype),n.prototype=r,n.prototype.constructor=n,n.Interface=t({},i.Interface,e),n.extend=i.extend,g(n),n},g(p);var b=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement);function h(e,t){var a={};return a[e.toLowerCase()]=t.toLowerCase(),a["Webkit"+e]="webkit"+t,a["Moz"+e]="moz"+t,a}var y={animationend:h("Animation","AnimationEnd"),animationiteration:h("Animation","AnimationIteration"),animationstart:h("Animation","AnimationStart"),transitionend:h("Transition","TransitionEnd")},v={},E={};function T(e){if(v[e])return v[e];if(!y[e])return e;var t,a=y[e];for(t in a)if(a.hasOwnProperty(t)&&t in E)return v[e]=a[t];return e}b&&(E=document.createElement("div").style,"AnimationEvent"in window||(delete y.animationend.animation,delete y.animationiteration.animation,delete y.animationstart.animation),"TransitionEvent"in window||delete y.transitionend.transition);var k,x=T("animationend"),S=T("animationiteration"),w=T("animationstart"),O=T("transitionend");try{var j=("require"+Math.random()).slice(0,7);k=(e&&e[j])("timers").setImmediate}catch(e){k=function(e){var t=new MessageChannel;t.port1.onmessage=e,t.port2.postMessage(void 0)}}var C=k,I=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.Events,M=I[11],A=I[12],q=i.unstable_batchedUpdates,D=o.IsSomeRendererActing,P="function"==typeof r.unstable_flushAllWithoutAsserting,R=r.unstable_flushAllWithoutAsserting||function(){for(var e=!1;M();)e=!0;return e};function F(e){try{R(),C((function(){R()?F(e):e()}))}catch(t){e(t)}}var _=0,N=!1,L=i.findDOMNode,B=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.Events,z=B[0],H=B[4],U=B[5],$=B[6],Q=B[7],V=B[8],W=B[9],G=B[10];function K(){}function Y(e,t){if(!e)return[];if(e=function(e){var t=e.alternate;if(!t){if(null===(t=l(e)))throw Error(s(188));return t!==e?null:e}for(var a=e,n=t;;){var i=a.return;if(null===i)break;var r=i.alternate;if(null===r){if(null!==(n=i.return)){a=n;continue}break}if(i.child===r.child){for(r=i.child;r;){if(r===a)return c(i),e;if(r===n)return c(i),t;r=r.sibling}throw Error(s(188))}if(a.return!==n.return)a=i,n=r;else{for(var o=!1,u=i.child;u;){if(u===a){o=!0,a=i,n=r;break}if(u===n){o=!0,n=i,a=r;break}u=u.sibling}if(!o){for(u=r.child;u;){if(u===a){o=!0,a=r,n=i;break}if(u===n){o=!0,n=r,a=i;break}u=u.sibling}if(!o)throw Error(s(189))}}if(a.alternate!==n)throw Error(s(190))}if(3!==a.tag)throw Error(s(188));return a.stateNode.current===a?e:t}(e),!e)return[];for(var a=e,n=[];;){if(5===a.tag||6===a.tag||1===a.tag||0===a.tag){var i=a.stateNode;t(i)&&n.push(i)}if(a.child)a.child.return=a,a=a.child;else{if(a===e)return n;for(;!a.sibling;){if(!a.return||a.return===e)return n;a=a.return}a.sibling.return=a.return,a=a.sibling}}}function J(e,t){if(e&&!e._reactInternalFiber){var a=""+e;throw e=Array.isArray(e)?"an array":e&&1===e.nodeType&&e.tagName?"a DOM node":"[object Object]"===a?"object with keys {"+Object.keys(e).join(", ")+"}":a,Error(s(286,t,e))}}var X={renderIntoDocument:function(e){var t=document.createElement("div");return i.render(e,t)},isElement:function(e){return n.isValidElement(e)},isElementOfType:function(e,t){return n.isValidElement(e)&&e.type===t},isDOMComponent:function(e){return!(!e||1!==e.nodeType||!e.tagName)},isDOMComponentElement:function(e){return!!(e&&n.isValidElement(e)&&e.tagName)},isCompositeComponent:function(e){return!X.isDOMComponent(e)&&(null!=e&&"function"==typeof e.render&&"function"==typeof e.setState)},isCompositeComponentWithType:function(e,t){return!!X.isCompositeComponent(e)&&e._reactInternalFiber.type===t},findAllInRenderedTree:function(e,t){return J(e,"findAllInRenderedTree"),e?Y(e._reactInternalFiber,t):[]},scryRenderedDOMComponentsWithClass:function(e,t){return J(e,"scryRenderedDOMComponentsWithClass"),X.findAllInRenderedTree(e,(function(e){if(X.isDOMComponent(e)){var a=e.className;"string"!=typeof a&&(a=e.getAttribute("class")||"");var n=a.split(/\s+/);if(!Array.isArray(t)){if(void 0===t)throw Error(s(11));t=t.split(/\s+/)}return t.every((function(e){return-1!==n.indexOf(e)}))}return!1}))},findRenderedDOMComponentWithClass:function(e,t){if(J(e,"findRenderedDOMComponentWithClass"),1!==(e=X.scryRenderedDOMComponentsWithClass(e,t)).length)throw Error("Did not find exactly one match (found: "+e.length+") for class:"+t);return e[0]},scryRenderedDOMComponentsWithTag:function(e,t){return J(e,"scryRenderedDOMComponentsWithTag"),X.findAllInRenderedTree(e,(function(e){return X.isDOMComponent(e)&&e.tagName.toUpperCase()===t.toUpperCase()}))},findRenderedDOMComponentWithTag:function(e,t){if(J(e,"findRenderedDOMComponentWithTag"),1!==(e=X.scryRenderedDOMComponentsWithTag(e,t)).length)throw Error("Did not find exactly one match (found: "+e.length+") for tag:"+t);return e[0]},scryRenderedComponentsWithType:function(e,t){return J(e,"scryRenderedComponentsWithType"),X.findAllInRenderedTree(e,(function(e){return X.isCompositeComponentWithType(e,t)}))},findRenderedComponentWithType:function(e,t){if(J(e,"findRenderedComponentWithType"),1!==(e=X.scryRenderedComponentsWithType(e,t)).length)throw Error("Did not find exactly one match (found: "+e.length+") for componentType:"+t);return e[0]},mockComponent:function(e,t){return t=t||e.mockTagName||"div",e.prototype.render.mockImplementation((function(){return n.createElement(t,null,this.props.children)})),this},nativeTouchData:function(e,t){return{touches:[{pageX:e,pageY:t}]}},Simulate:null,SimulateNative:{},act:function(e){function t(){_--,D.current=a,A.current=n}!1===N&&(N=!0,console.error("act(...) is not supported in production builds of React, and might not behave as expected.")),_++;var a=D.current,n=A.current;D.current=!0,A.current=!0;try{var i=q(e)}catch(e){throw t(),e}if(null!==i&&"object"==typeof i&&"function"==typeof i.then)return{then:function(e,n){i.then((function(){1<_||!0===P&&!0===a?(t(),e()):F((function(a){t(),a?n(a):e()}))}),(function(e){t(),n(e)}))}};try{1!==_||!1!==P&&!1!==a||R(),t()}catch(e){throw t(),e}return{then:function(e){e()}}}};function Z(e){return function(a,r){if(n.isValidElement(a))throw Error(s(228));if(X.isCompositeComponent(a))throw Error(s(229));var o=H[e],l=new K;l.target=a,l.type=e.toLowerCase();var c=new p(o,z(a),l,a);c.persist(),t(c,r),o.phasedRegistrationNames?U(c):$(c),i.unstable_batchedUpdates((function(){Q(a),G(c)})),V()}}for(var ee in X.Simulate={},H)X.Simulate[ee]=Z(ee);[["abort","abort"],[x,"animationEnd"],[S,"animationIteration"],[w,"animationStart"],["blur","blur"],["canplaythrough","canPlayThrough"],["canplay","canPlay"],["cancel","cancel"],["change","change"],["click","click"],["close","close"],["compositionend","compositionEnd"],["compositionstart","compositionStart"],["compositionupdate","compositionUpdate"],["contextmenu","contextMenu"],["copy","copy"],["cut","cut"],["dblclick","doubleClick"],["dragend","dragEnd"],["dragenter","dragEnter"],["dragexit","dragExit"],["dragleave","dragLeave"],["dragover","dragOver"],["dragstart","dragStart"],["drag","drag"],["drop","drop"],["durationchange","durationChange"],["emptied","emptied"],["encrypted","encrypted"],["ended","ended"],["error","error"],["focus","focus"],["input","input"],["keydown","keyDown"],["keypress","keyPress"],["keyup","keyUp"],["loadstart","loadStart"],["loadstart","loadStart"],["load","load"],["loadeddata","loadedData"],["loadedmetadata","loadedMetadata"],["mousedown","mouseDown"],["mousemove","mouseMove"],["mouseout","mouseOut"],["mouseover","mouseOver"],["mouseup","mouseUp"],["paste","paste"],["pause","pause"],["play","play"],["playing","playing"],["progress","progress"],["ratechange","rateChange"],["scroll","scroll"],["seeked","seeked"],["seeking","seeking"],["selectionchange","selectionChange"],["stalled","stalled"],["suspend","suspend"],["textInput","textInput"],["timeupdate","timeUpdate"],["toggle","toggle"],["touchcancel","touchCancel"],["touchend","touchEnd"],["touchmove","touchMove"],["touchstart","touchStart"],[O,"transitionEnd"],["volumechange","volumeChange"],["waiting","waiting"],["wheel","wheel"]].forEach((function(e){var a=e[1];X.SimulateNative[a]=function(e,a){return function(n,i){var r=new K(e);t(r,i),X.isDOMComponent(n)?(n=L(n),r.target=n,W(a,1,r)):n.tagName&&(r.target=n,W(a,1,r))}}(a,e[0])}));var te={default:X},ae=te&&X||te;e.exports=ae.default||ae}).call(this,a(226)(e))},function(e,t,a){e.exports=a(46)(836)},function(e,t,a){e.exports=a(46)(2413)},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fireEvent=void 0;var n=a(697);const i=(...e)=>(0,n.fireEvent)(...e);t.fireEvent=i,Object.keys(n.fireEvent).forEach((e=>{i[e]=(...t)=>n.fireEvent[e](...t)}));const r=i.mouseEnter,s=i.mouseLeave;i.mouseEnter=(...e)=>(r(...e),i.mouseOver(...e)),i.mouseLeave=(...e)=>(s(...e),i.mouseOut(...e));const o=i.pointerEnter,l=i.pointerLeave;i.pointerEnter=(...e)=>(o(...e),i.pointerOver(...e)),i.pointerLeave=(...e)=>(l(...e),i.pointerOut(...e));const c=i.select;i.select=(e,t)=>{c(e,t),e.focus(),i.keyUp(e,t)};const u=i.blur,d=i.focus;i.blur=(...e)=>(i.focusOut(...e),u(...e)),i.focus=(...e)=>(i.focusIn(...e),d(...e))},function(e,t,a){var n=a(1344),i=a(1345),r=a(1346),s=a(1347),o=a(1348),l=a(1349),c=a(1350);c.alea=n,c.xor128=i,c.xorwow=r,c.xorshift7=s,c.xor4096=o,c.tychei=l,e.exports=c},function(e,t,a){(function(e){var n;!function(e,i,r){function s(e){var t,a=this,n=(t=4022871197,function(e){e=String(e);for(var a=0;a<e.length;a++){var n=.02519603282416938*(t+=e.charCodeAt(a));n-=t=n>>>0,t=(n*=t)>>>0,t+=4294967296*(n-=t)}return 2.3283064365386963e-10*(t>>>0)});a.next=function(){var e=2091639*a.s0+2.3283064365386963e-10*a.c;return a.s0=a.s1,a.s1=a.s2,a.s2=e-(a.c=0|e)},a.c=1,a.s0=n(" "),a.s1=n(" "),a.s2=n(" "),a.s0-=n(e),a.s0<0&&(a.s0+=1),a.s1-=n(e),a.s1<0&&(a.s1+=1),a.s2-=n(e),a.s2<0&&(a.s2+=1),n=null}function o(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}function l(e,t){var a=new s(e),n=t&&t.state,i=a.next;return i.int32=function(){return 4294967296*a.next()|0},i.double=function(){return i()+11102230246251565e-32*(2097152*i()|0)},i.quick=i,n&&("object"==typeof n&&o(n,a),i.state=function(){return o(a,{})}),i}i&&i.exports?i.exports=l:a(184)&&a(307)?void 0===(n=function(){return l}.call(t,a,t,i))||(i.exports=n):this.alea=l}(0,e,a(184))}).call(this,a(226)(e))},function(e,t,a){(function(e){var n;!function(e,i,r){function s(e){var t=this,a="";t.x=0,t.y=0,t.z=0,t.w=0,t.next=function(){var e=t.x^t.x<<11;return t.x=t.y,t.y=t.z,t.z=t.w,t.w^=t.w>>>19^e^e>>>8},e===(0|e)?t.x=e:a+=e;for(var n=0;n<a.length+64;n++)t.x^=0|a.charCodeAt(n),t.next()}function o(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t}function l(e,t){var a=new s(e),n=t&&t.state,i=function(){return(a.next()>>>0)/4294967296};return i.double=function(){do{var e=((a.next()>>>11)+(a.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},i.int32=a.next,i.quick=i,n&&("object"==typeof n&&o(n,a),i.state=function(){return o(a,{})}),i}i&&i.exports?i.exports=l:a(184)&&a(307)?void 0===(n=function(){return l}.call(t,a,t,i))||(i.exports=n):this.xor128=l}(0,e,a(184))}).call(this,a(226)(e))},function(e,t,a){(function(e){var n;!function(e,i,r){function s(e){var t=this,a="";t.next=function(){var e=t.x^t.x>>>2;return t.x=t.y,t.y=t.z,t.z=t.w,t.w=t.v,(t.d=t.d+362437|0)+(t.v=t.v^t.v<<4^e^e<<1)|0},t.x=0,t.y=0,t.z=0,t.w=0,t.v=0,e===(0|e)?t.x=e:a+=e;for(var n=0;n<a.length+64;n++)t.x^=0|a.charCodeAt(n),n==a.length&&(t.d=t.x<<10^t.x>>>4),t.next()}function o(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t.v=e.v,t.d=e.d,t}function l(e,t){var a=new s(e),n=t&&t.state,i=function(){return(a.next()>>>0)/4294967296};return i.double=function(){do{var e=((a.next()>>>11)+(a.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},i.int32=a.next,i.quick=i,n&&("object"==typeof n&&o(n,a),i.state=function(){return o(a,{})}),i}i&&i.exports?i.exports=l:a(184)&&a(307)?void 0===(n=function(){return l}.call(t,a,t,i))||(i.exports=n):this.xorwow=l}(0,e,a(184))}).call(this,a(226)(e))},function(e,t,a){(function(e){var n;!function(e,i,r){function s(e){var t=this;t.next=function(){var e,a,n=t.x,i=t.i;return e=n[i],a=(e^=e>>>7)^e<<24,a^=(e=n[i+1&7])^e>>>10,a^=(e=n[i+3&7])^e>>>3,a^=(e=n[i+4&7])^e<<7,e=n[i+7&7],a^=(e^=e<<13)^e<<9,n[i]=a,t.i=i+1&7,a},function(e,t){var a,n=[];if(t===(0|t))n[0]=t;else for(t=""+t,a=0;a<t.length;++a)n[7&a]=n[7&a]<<15^t.charCodeAt(a)+n[a+1&7]<<13;for(;n.length<8;)n.push(0);for(a=0;a<8&&0===n[a];++a);for(8==a?n[7]=-1:n[a],e.x=n,e.i=0,a=256;a>0;--a)e.next()}(t,e)}function o(e,t){return t.x=e.x.slice(),t.i=e.i,t}function l(e,t){null==e&&(e=+new Date);var a=new s(e),n=t&&t.state,i=function(){return(a.next()>>>0)/4294967296};return i.double=function(){do{var e=((a.next()>>>11)+(a.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},i.int32=a.next,i.quick=i,n&&(n.x&&o(n,a),i.state=function(){return o(a,{})}),i}i&&i.exports?i.exports=l:a(184)&&a(307)?void 0===(n=function(){return l}.call(t,a,t,i))||(i.exports=n):this.xorshift7=l}(0,e,a(184))}).call(this,a(226)(e))},function(e,t,a){(function(e){var n;!function(e,i,r){function s(e){var t=this;t.next=function(){var e,a,n=t.w,i=t.X,r=t.i;return t.w=n=n+1640531527|0,a=i[r+34&127],e=i[r=r+1&127],a^=a<<13,e^=e<<17,a^=a>>>15,e^=e>>>12,a=i[r]=a^e,t.i=r,a+(n^n>>>16)|0},function(e,t){var a,n,i,r,s,o=[],l=128;for(t===(0|t)?(n=t,t=null):(t+="\0",n=0,l=Math.max(l,t.length)),i=0,r=-32;r<l;++r)t&&(n^=t.charCodeAt((r+32)%t.length)),0===r&&(s=n),n^=n<<10,n^=n>>>15,n^=n<<4,n^=n>>>13,r>=0&&(s=s+1640531527|0,i=0==(a=o[127&r]^=n+s)?i+1:0);for(i>=128&&(o[127&(t&&t.length||0)]=-1),i=127,r=512;r>0;--r)n=o[i+34&127],a=o[i=i+1&127],n^=n<<13,a^=a<<17,n^=n>>>15,a^=a>>>12,o[i]=n^a;e.w=s,e.X=o,e.i=i}(t,e)}function o(e,t){return t.i=e.i,t.w=e.w,t.X=e.X.slice(),t}function l(e,t){null==e&&(e=+new Date);var a=new s(e),n=t&&t.state,i=function(){return(a.next()>>>0)/4294967296};return i.double=function(){do{var e=((a.next()>>>11)+(a.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},i.int32=a.next,i.quick=i,n&&(n.X&&o(n,a),i.state=function(){return o(a,{})}),i}i&&i.exports?i.exports=l:a(184)&&a(307)?void 0===(n=function(){return l}.call(t,a,t,i))||(i.exports=n):this.xor4096=l}(0,e,a(184))}).call(this,a(226)(e))},function(e,t,a){(function(e){var n;!function(e,i,r){function s(e){var t=this,a="";t.next=function(){var e=t.b,a=t.c,n=t.d,i=t.a;return e=e<<25^e>>>7^a,a=a-n|0,n=n<<24^n>>>8^i,i=i-e|0,t.b=e=e<<20^e>>>12^a,t.c=a=a-n|0,t.d=n<<16^a>>>16^i,t.a=i-e|0},t.a=0,t.b=0,t.c=-1640531527,t.d=1367130551,e===Math.floor(e)?(t.a=e/4294967296|0,t.b=0|e):a+=e;for(var n=0;n<a.length+20;n++)t.b^=0|a.charCodeAt(n),t.next()}function o(e,t){return t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t}function l(e,t){var a=new s(e),n=t&&t.state,i=function(){return(a.next()>>>0)/4294967296};return i.double=function(){do{var e=((a.next()>>>11)+(a.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},i.int32=a.next,i.quick=i,n&&("object"==typeof n&&o(n,a),i.state=function(){return o(a,{})}),i}i&&i.exports?i.exports=l:a(184)&&a(307)?void 0===(n=function(){return l}.call(t,a,t,i))||(i.exports=n):this.tychei=l}(0,e,a(184))}).call(this,a(226)(e))},function(e,t,a){var n;!function(i,r,s){var o,l=256,c=s.pow(l,6),u=s.pow(2,52),d=2*u,p=255;function m(e,t,a){var n=[],p=h(b((t=1==t?{entropy:!0}:t||{}).entropy?[e,y(r)]:null==e?function(){try{var e;return o&&(e=o.randomBytes)?e=e(l):(e=new Uint8Array(l),(i.crypto||i.msCrypto).getRandomValues(e)),y(e)}catch(e){var t=i.navigator,a=t&&t.plugins;return[+new Date,i,a,i.screen,y(r)]}}():e,3),n),m=new f(n),v=function(){for(var e=m.g(6),t=c,a=0;e<u;)e=(e+a)*l,t*=l,a=m.g(1);for(;e>=d;)e/=2,t/=2,a>>>=1;return(e+a)/t};return v.int32=function(){return 0|m.g(4)},v.quick=function(){return m.g(4)/4294967296},v.double=v,h(y(m.S),r),(t.pass||a||function(e,t,a,n){return n&&(n.S&&g(n,m),e.state=function(){return g(m,{})}),a?(s.random=e,t):e})(v,p,"global"in t?t.global:this==s,t.state)}function f(e){var t,a=e.length,n=this,i=0,r=n.i=n.j=0,s=n.S=[];for(a||(e=[a++]);i<l;)s[i]=i++;for(i=0;i<l;i++)s[i]=s[r=p&r+e[i%a]+(t=s[i])],s[r]=t;(n.g=function(e){for(var t,a=0,i=n.i,r=n.j,s=n.S;e--;)t=s[i=p&i+1],a=a*l+s[p&(s[i]=s[r=p&r+t])+(s[r]=t)];return n.i=i,n.j=r,a})(l)}function g(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function b(e,t){var a,n=[],i=typeof e;if(t&&"object"==i)for(a in e)try{n.push(b(e[a],t-1))}catch(e){}return n.length?n:"string"==i?e:e+"\0"}function h(e,t){for(var a,n=e+"",i=0;i<n.length;)t[p&i]=p&(a^=19*t[p&i])+n.charCodeAt(i++);return y(t)}function y(e){return String.fromCharCode.apply(0,e)}if(h(s.random(),r),e.exports){e.exports=m;try{o=a(1351)}catch(e){}}else void 0===(n=function(){return m}.call(t,a,t,e))||(e.exports=n)}("undefined"!=typeof self?self:this,[],Math)},function(e,t){},function(e,t,a){!function(t){"use strict";const a="(0?\\d+|0x[a-f0-9]+)",n={fourOctet:new RegExp(`^${a}\\.${a}\\.${a}\\.${a}$`,"i"),threeOctet:new RegExp(`^${a}\\.${a}\\.${a}$`,"i"),twoOctet:new RegExp(`^${a}\\.${a}$`,"i"),longValue:new RegExp(`^${a}$`,"i")},i=new RegExp("^0[0-7]+$","i"),r=new RegExp("^0x[a-f0-9]+$","i"),s="%[0-9a-z]{1,}",o="(?:[0-9a-f]+::?)+",l={zoneIndex:new RegExp(s,"i"),native:new RegExp(`^(::)?(${o})?([0-9a-f]+)?(::)?(${s})?$`,"i"),deprecatedTransitional:new RegExp(`^(?:::)(${a}\\.${a}\\.${a}\\.${a}(${s})?)$`,"i"),transitional:new RegExp(`^((?:${o})|(?:::)(?:${o})?)${a}\\.${a}\\.${a}\\.${a}(${s})?$`,"i")};function c(e,t){if(e.indexOf("::")!==e.lastIndexOf("::"))return null;let a,n,i=0,r=-1,s=(e.match(l.zoneIndex)||[])[0];for(s&&(s=s.substring(1),e=e.replace(/%.+$/,""));(r=e.indexOf(":",r+1))>=0;)i++;if("::"===e.substr(0,2)&&i--,"::"===e.substr(-2,2)&&i--,i>t)return null;for(n=t-i,a=":";n--;)a+="0:";return":"===(e=e.replace("::",a))[0]&&(e=e.slice(1)),":"===e[e.length-1]&&(e=e.slice(0,-1)),{parts:t=function(){const t=e.split(":"),a=[];for(let e=0;e<t.length;e++)a.push(parseInt(t[e],16));return a}(),zoneId:s}}function u(e,t,a,n){if(e.length!==t.length)throw new Error("ipaddr: cannot match CIDR for objects with different lengths");let i,r=0;for(;n>0;){if(i=a-n,i<0&&(i=0),e[r]>>i!=t[r]>>i)return!1;n-=a,r+=1}return!0}function d(e){if(r.test(e))return parseInt(e,16);if("0"===e[0]&&!isNaN(parseInt(e[1],10))){if(i.test(e))return parseInt(e,8);throw new Error(`ipaddr: cannot parse ${e} as octal`)}return parseInt(e,10)}function p(e,t){for(;e.length<t;)e=`0${e}`;return e}const m={};m.IPv4=function(){function e(e){if(4!==e.length)throw new Error("ipaddr: ipv4 octet count should be 4");let t,a;for(t=0;t<e.length;t++)if(a=e[t],!(0<=a&&a<=255))throw new Error("ipaddr: ipv4 octet should fit in 8 bits");this.octets=e}return e.prototype.SpecialRanges={unspecified:[[new e([0,0,0,0]),8]],broadcast:[[new e([255,255,255,255]),32]],multicast:[[new e([224,0,0,0]),4]],linkLocal:[[new e([169,254,0,0]),16]],loopback:[[new e([127,0,0,0]),8]],carrierGradeNat:[[new e([100,64,0,0]),10]],private:[[new e([10,0,0,0]),8],[new e([172,16,0,0]),12],[new e([192,168,0,0]),16]],reserved:[[new e([192,0,0,0]),24],[new e([192,0,2,0]),24],[new e([192,88,99,0]),24],[new e([198,51,100,0]),24],[new e([203,0,113,0]),24],[new e([240,0,0,0]),4]]},e.prototype.kind=function(){return"ipv4"},e.prototype.match=function(e,t){let a;if(void 0===t&&(a=e,e=a[0],t=a[1]),"ipv4"!==e.kind())throw new Error("ipaddr: cannot match ipv4 address with non-ipv4 one");return u(this.octets,e.octets,8,t)},e.prototype.prefixLengthFromSubnetMask=function(){let e=0,t=!1;const a={0:8,128:7,192:6,224:5,240:4,248:3,252:2,254:1,255:0};let n,i,r;for(n=3;n>=0;n-=1){if(i=this.octets[n],!(i in a))return null;if(r=a[i],t&&0!==r)return null;8!==r&&(t=!0),e+=r}return 32-e},e.prototype.range=function(){return m.subnetMatch(this,this.SpecialRanges)},e.prototype.toByteArray=function(){return this.octets.slice(0)},e.prototype.toIPv4MappedAddress=function(){return m.IPv6.parse(`::ffff:${this.toString()}`)},e.prototype.toNormalizedString=function(){return this.toString()},e.prototype.toString=function(){return this.octets.join(".")},e}(),m.IPv4.broadcastAddressFromCIDR=function(e){try{const t=this.parseCIDR(e),a=t[0].toByteArray(),n=this.subnetMaskFromPrefixLength(t[1]).toByteArray(),i=[];let r=0;for(;r<4;)i.push(parseInt(a[r],10)|255^parseInt(n[r],10)),r++;return new this(i)}catch(e){throw new Error("ipaddr: the address does not have IPv4 CIDR format")}},m.IPv4.isIPv4=function(e){return null!==this.parser(e)},m.IPv4.isValid=function(e){try{return new this(this.parser(e)),!0}catch(e){return!1}},m.IPv4.isValidFourPartDecimal=function(e){return!(!m.IPv4.isValid(e)||!e.match(/^(0|[1-9]\d*)(\.(0|[1-9]\d*)){3}$/))},m.IPv4.networkAddressFromCIDR=function(e){let t,a,n,i,r;try{for(t=this.parseCIDR(e),n=t[0].toByteArray(),r=this.subnetMaskFromPrefixLength(t[1]).toByteArray(),i=[],a=0;a<4;)i.push(parseInt(n[a],10)&parseInt(r[a],10)),a++;return new this(i)}catch(e){throw new Error("ipaddr: the address does not have IPv4 CIDR format")}},m.IPv4.parse=function(e){const t=this.parser(e);if(null===t)throw new Error("ipaddr: string is not formatted like an IPv4 Address");return new this(t)},m.IPv4.parseCIDR=function(e){let t;if(t=e.match(/^(.+)\/(\d+)$/)){const e=parseInt(t[2]);if(e>=0&&e<=32){const a=[this.parse(t[1]),e];return Object.defineProperty(a,"toString",{value:function(){return this.join("/")}}),a}}throw new Error("ipaddr: string is not formatted like an IPv4 CIDR range")},m.IPv4.parser=function(e){let t,a,i;if(t=e.match(n.fourOctet))return function(){const e=t.slice(1,6),n=[];for(let t=0;t<e.length;t++)a=e[t],n.push(d(a));return n}();if(t=e.match(n.longValue)){if(i=d(t[1]),i>4294967295||i<0)throw new Error("ipaddr: address outside defined range");return function(){const e=[];let t;for(t=0;t<=24;t+=8)e.push(i>>t&255);return e}().reverse()}return(t=e.match(n.twoOctet))?function(){const e=t.slice(1,4),a=[];if(i=d(e[1]),i>16777215||i<0)throw new Error("ipaddr: address outside defined range");return a.push(d(e[0])),a.push(i>>16&255),a.push(i>>8&255),a.push(255&i),a}():(t=e.match(n.threeOctet))?function(){const e=t.slice(1,5),a=[];if(i=d(e[2]),i>65535||i<0)throw new Error("ipaddr: address outside defined range");return a.push(d(e[0])),a.push(d(e[1])),a.push(i>>8&255),a.push(255&i),a}():null},m.IPv4.subnetMaskFromPrefixLength=function(e){if((e=parseInt(e))<0||e>32)throw new Error("ipaddr: invalid IPv4 prefix length");const t=[0,0,0,0];let a=0;const n=Math.floor(e/8);for(;a<n;)t[a]=255,a++;return n<4&&(t[n]=Math.pow(2,e%8)-1<<8-e%8),new this(t)},m.IPv6=function(){function e(e,t){let a,n;if(16===e.length)for(this.parts=[],a=0;a<=14;a+=2)this.parts.push(e[a]<<8|e[a+1]);else{if(8!==e.length)throw new Error("ipaddr: ipv6 part count should be 8 or 16");this.parts=e}for(a=0;a<this.parts.length;a++)if(n=this.parts[a],!(0<=n&&n<=65535))throw new Error("ipaddr: ipv6 part should fit in 16 bits");t&&(this.zoneId=t)}return e.prototype.SpecialRanges={unspecified:[new e([0,0,0,0,0,0,0,0]),128],linkLocal:[new e([65152,0,0,0,0,0,0,0]),10],multicast:[new e([65280,0,0,0,0,0,0,0]),8],loopback:[new e([0,0,0,0,0,0,0,1]),128],uniqueLocal:[new e([64512,0,0,0,0,0,0,0]),7],ipv4Mapped:[new e([0,0,0,0,0,65535,0,0]),96],rfc6145:[new e([0,0,0,0,65535,0,0,0]),96],rfc6052:[new e([100,65435,0,0,0,0,0,0]),96],"6to4":[new e([8194,0,0,0,0,0,0,0]),16],teredo:[new e([8193,0,0,0,0,0,0,0]),32],reserved:[[new e([8193,3512,0,0,0,0,0,0]),32]]},e.prototype.isIPv4MappedAddress=function(){return"ipv4Mapped"===this.range()},e.prototype.kind=function(){return"ipv6"},e.prototype.match=function(e,t){let a;if(void 0===t&&(a=e,e=a[0],t=a[1]),"ipv6"!==e.kind())throw new Error("ipaddr: cannot match ipv6 address with non-ipv6 one");return u(this.parts,e.parts,16,t)},e.prototype.prefixLengthFromSubnetMask=function(){let e=0,t=!1;const a={0:16,32768:15,49152:14,57344:13,61440:12,63488:11,64512:10,65024:9,65280:8,65408:7,65472:6,65504:5,65520:4,65528:3,65532:2,65534:1,65535:0};let n,i;for(let r=7;r>=0;r-=1){if(n=this.parts[r],!(n in a))return null;if(i=a[n],t&&0!==i)return null;16!==i&&(t=!0),e+=i}return 128-e},e.prototype.range=function(){return m.subnetMatch(this,this.SpecialRanges)},e.prototype.toByteArray=function(){let e;const t=[],a=this.parts;for(let n=0;n<a.length;n++)e=a[n],t.push(e>>8),t.push(255&e);return t},e.prototype.toFixedLengthString=function(){const e=function(){const e=[];for(let t=0;t<this.parts.length;t++)e.push(p(this.parts[t].toString(16),4));return e}.call(this).join(":");let t="";return this.zoneId&&(t=`%${this.zoneId}`),e+t},e.prototype.toIPv4Address=function(){if(!this.isIPv4MappedAddress())throw new Error("ipaddr: trying to convert a generic ipv6 address to ipv4");const e=this.parts.slice(-2),t=e[0],a=e[1];return new m.IPv4([t>>8,255&t,a>>8,255&a])},e.prototype.toNormalizedString=function(){const e=function(){const e=[];for(let t=0;t<this.parts.length;t++)e.push(this.parts[t].toString(16));return e}.call(this).join(":");let t="";return this.zoneId&&(t=`%${this.zoneId}`),e+t},e.prototype.toRFC5952String=function(){const e=/((^|:)(0(:|$)){2,})/g,t=this.toNormalizedString();let a,n=0,i=-1;for(;a=e.exec(t);)a[0].length>i&&(n=a.index,i=a[0].length);return i<0?t:`${t.substring(0,n)}::${t.substring(n+i)}`},e.prototype.toString=function(){return this.toNormalizedString().replace(/((^|:)(0(:|$))+)/,"::")},e}(),m.IPv6.isIPv6=function(e){return null!==this.parser(e)},m.IPv6.isValid=function(e){if("string"==typeof e&&-1===e.indexOf(":"))return!1;try{const t=this.parser(e);return new this(t.parts,t.zoneId),!0}catch(e){return!1}},m.IPv6.parse=function(e){const t=this.parser(e);if(null===t.parts)throw new Error("ipaddr: string is not formatted like an IPv6 Address");return new this(t.parts,t.zoneId)},m.IPv6.parseCIDR=function(e){let t,a,n;if((a=e.match(/^(.+)\/(\d+)$/))&&(t=parseInt(a[2]),t>=0&&t<=128))return n=[this.parse(a[1]),t],Object.defineProperty(n,"toString",{value:function(){return this.join("/")}}),n;throw new Error("ipaddr: string is not formatted like an IPv6 CIDR range")},m.IPv6.parser=function(e){let t,a,n,i,r,s;if(n=e.match(l.deprecatedTransitional))return this.parser(`::ffff:${n[1]}`);if(l.native.test(e))return c(e,8);if((n=e.match(l.transitional))&&(s=n[6]||"",t=c(n[1].slice(0,-1)+s,6),t.parts)){for(r=[parseInt(n[2]),parseInt(n[3]),parseInt(n[4]),parseInt(n[5])],a=0;a<r.length;a++)if(i=r[a],!(0<=i&&i<=255))return null;return t.parts.push(r[0]<<8|r[1]),t.parts.push(r[2]<<8|r[3]),{parts:t.parts,zoneId:t.zoneId}}return null},m.fromByteArray=function(e){const t=e.length;if(4===t)return new m.IPv4(e);if(16===t)return new m.IPv6(e);throw new Error("ipaddr: the binary input is neither an IPv6 nor IPv4 address")},m.isValid=function(e){return m.IPv6.isValid(e)||m.IPv4.isValid(e)},m.parse=function(e){if(m.IPv6.isValid(e))return m.IPv6.parse(e);if(m.IPv4.isValid(e))return m.IPv4.parse(e);throw new Error("ipaddr: the address has neither IPv6 nor IPv4 format")},m.parseCIDR=function(e){try{return m.IPv6.parseCIDR(e)}catch(t){try{return m.IPv4.parseCIDR(e)}catch(e){throw new Error("ipaddr: the address has neither IPv6 nor IPv4 CIDR format")}}},m.process=function(e){const t=this.parse(e);return"ipv6"===t.kind()&&t.isIPv4MappedAddress()?t.toIPv4Address():t},m.subnetMatch=function(e,t,a){let n,i,r,s;for(i in null==a&&(a="unicast"),t)if(Object.prototype.hasOwnProperty.call(t,i))for(r=t[i],!r[0]||r[0]instanceof Array||(r=[r]),n=0;n<r.length;n++)if(s=r[n],e.kind()===s[0].kind()&&e.match.apply(e,s))return i;return a},e.exports?e.exports=m:t.ipaddr=m}(this)},,,,,,,,function(e,t,a){"use strict";a.r(t),a.d(t,"subPluginClasses",(function(){return _q}));var n=a(9),i=a.n(n),r=a(67),s=a(4),o=a(3),l=a(21),c=a(333),u=a(125),d=a(130),p=a(324),m=a(90),f=a(111),g=a(257),b=a(91),h=a(20),y=a(94),v=a(109),E=a(104),T=a(309),k=a(668),x=a(647),S=a(2);const w=S.i18n.translate("xpack.securitySolution.cases.caseView.sendAlertToTimelineTooltip",{defaultMessage:"Investigate in timeline"});var O=a(461),j=a(527),C=a(640),I=a(101);const M=()=>{const{browserFields:e,docValueFields:t}=Object(v.c)(E.SourcererScopeName.detections);return i.a.createElement(T.a,{browserFields:e,docValueFields:t,entityType:"events",isFlyoutView:!0,timelineId:h.q.casePage})},A=e=>i.a.createElement(k.a,{ariaLabel:w,alertIds:e,key:"investigate-in-timeline",ecsRowData:null,nonEcsRowData:[]}),q=i.a.memo((({caseId:e,subCaseId:t,userCanCrud:a,onCaseDataSuccess:r})=>{const{cases:l,application:{navigateToApp:c}}=Object(m.j)().services,u=Object(b.useDispatch)(),{formatUrl:d,search:p}=Object(f.n)(s.a.case),{formatUrl:g,search:v}=Object(f.n)(s.a.rules),E=Object(f.d)(p),T=d(E),k=d(Object(f.e)()),S=d(Object(f.b)({id:e}),{absolute:!0}),w=Object(n.useCallback)((e=>g(Object(f.k)(null!=e?e:"",v))),[g,v]),q=Object(n.useCallback)(((e,t)=>{u(y.a.toggleDetailPanel({panelView:"eventDetail",timelineId:h.q.casePage,params:{eventId:e,indexName:t}}))}),[u]),D=Object(n.useCallback)((()=>{u(y.a.createTimeline({id:h.q.casePage,columns:[],indexNames:[],expandedDetail:{},show:!1}))}),[u]),P=Object(n.useRef)(null);return i.a.createElement(C.a.Provider,{value:P},l.getCaseView({refreshRef:P,allCasesNavigation:{href:T,onClick:async e=>(e&&e.preventDefault(),c(o.l,{deepLinkId:s.a.case,path:E}))},caseDetailsNavigation:{href:S,onClick:async t=>(t&&t.preventDefault(),c(o.l,{deepLinkId:s.a.case,path:Object(f.b)({id:e})}))},caseId:e,configureCasesNavigation:{href:k,onClick:async e=>(e&&e.preventDefault(),c(o.l,{deepLinkId:s.a.case,path:Object(f.e)(p)}))},getCaseDetailHrefWithCommentId:a=>d(Object(f.c)({id:e,commentId:a,subCaseId:t}),{absolute:!0}),onCaseDataSuccess:r,onComponentInitialized:D,actionsNavigation:{href:e=>d(Object(I.f)({name:"endpointActivityLog",selected_endpoint:e})),onClick:(e,t)=>(t&&t.preventDefault(),c(o.l,{path:Object(I.f)({name:"endpointActivityLog",selected_endpoint:e})}))},ruleDetailsNavigation:{href:w,onClick:async(e,t)=>(t&&t.preventDefault(),c(o.l,{deepLinkId:s.a.rules,path:Object(f.k)(null!=e?e:"")}))},showAlertDetails:q,subCaseId:t,timelineIntegration:{editor_plugins:{parsingPlugin:j.a,processingPluginRenderer:j.c,uiPlugin:j.b},hooks:{useInsertTimeline:O.a},ui:{renderInvestigateInTimelineActionComponent:A,renderTimelineDetailsPanel:M}},useFetchAlertData:x.c,userCanCrud:a}))}));q.displayName="CaseView";const D=i.a.memo((()=>{var e;const{application:{navigateToApp:t}}=Object(m.j)().services,a=Object(m.h)(),{detailName:r,subCaseId:c}=Object(l.useParams)(),b=Object(p.a)(g.a.case);Object(n.useEffect)((()=>{null==a||a.read||t(o.l,{deepLinkId:s.a.case,path:Object(f.d)(b)})}),[a,t,b]);const[h,y]=Object(n.useState)({caseTitle:void 0}),v=Object(n.useCallback)((e=>{void 0!==h.caseTitle&&h.caseTitle===e.title||y({caseTitle:e.title})}),[h.caseTitle]);return null!=r?i.a.createElement(i.a.Fragment,null,i.a.createElement(d.a,{noPadding:!0},i.a.createElement(q,{caseId:r,subCaseId:c,userCanCrud:null!==(e=null==a?void 0:a.crud)&&void 0!==e&&e,onCaseDataSuccess:v})),i.a.createElement(u.a,{state:h,pageName:s.a.case})):null}));D.displayName="CaseDetailsPage";const P=i.a.memo((({userCanCrud:e})=>{const{cases:t,application:{navigateToApp:a}}=Object(m.j)().services,{formatUrl:i,search:r}=Object(f.n)(s.a.case),l=Object(n.useCallback)((async e=>(e.preventDefault(),a(o.l,{deepLinkId:s.a.case,path:Object(f.f)(r)}))),[a,r]),c=Object(n.useCallback)((async e=>(e.preventDefault(),a(o.l,{deepLinkId:s.a.case,path:Object(f.e)(r)}))),[a,r]);return t.getAllCases({caseDetailsNavigation:{href:({detailName:e,subCaseId:t})=>i(Object(f.b)({id:e,subCaseId:t})),onClick:async({detailName:e,subCaseId:t,search:n})=>a(o.l,{deepLinkId:s.a.case,path:Object(f.b)({id:e,search:n,subCaseId:t})})},configureCasesNavigation:{href:i(Object(f.e)()),onClick:c},createCaseNavigation:{href:i(Object(f.f)()),onClick:l},userCanCrud:e,owner:[o.l]})}));P.displayName="AllCases";var R=a(96),F=a.n(R),_=a(55),N=a(56),L=a.n(N);const B=L()(_.EuiEmptyPrompt).withConfig({displayName:"EmptyPrompt",componentId:"sc-1mqs59n-0"})(["align-self:center;max-width:60em;"]);B.displayName="EmptyPrompt";const z=i.a.memo((({actions:e,message:t,title:a,...r})=>{const s=Object.keys(e),o=Object(n.useMemo)((()=>Object.values(e).filter((e=>e.label&&e.url)).map((({icon:e,label:t,target:a,url:n,descriptionTitle:r,description:o,onClick:l,fill:c=!0},u)=>null!=r||null!=o?i.a.createElement(_.EuiFlexItem,{grow:!1,style:{maxWidth:283},key:`empty-page-${s[u]}-action`},i.a.createElement(_.EuiCard,{title:null!=r&&r,description:null!=o&&o,footer:i.a.createElement(_.EuiButton,{href:n,onClick:l,iconType:e,target:a,fill:c,"data-test-subj":`empty-page-${s[u]}-action`},t)})):i.a.createElement(_.EuiFlexItem,{grow:!1,style:{maxWidth:283},key:`empty-page-${s[u]}-action`},i.a.createElement(_.EuiButton,{href:n,onClick:l,iconType:e,target:a,"data-test-subj":`empty-page-${s[u]}-action`},t))))),[e,s]);return i.a.createElement(B,F()({iconType:"logoSecurity",title:i.a.createElement("h2",null,a),body:t&&i.a.createElement("p",null,t),actions:i.a.createElement(_.EuiFlexGroup,{justifyContent:"center"},o)},r))}));z.displayName="EmptyPageComponent";const H=i.a.memo(z);H.displayName="EmptyPage";const U=i.a.memo((()=>{const e=Object(m.j)().services.docLinks,t=Object(n.useMemo)((()=>({feature:{icon:"documents",label:c.g,url:`${e.links.siem.gettingStarted}`,target:"_blank"}})),[e]);return i.a.createElement(H,{actions:t,message:c.b,"data-test-subj":"no_feature_permissions",title:c.c})}));U.displayName="CaseFeatureNoPermissions";const $=i.a.memo((()=>{var e;const t=Object(m.h)();return null==t||null!=t&&t.read?i.a.createElement(i.a.Fragment,null,i.a.createElement(d.a,null,i.a.createElement(P,{userCanCrud:null!==(e=null==t?void 0:t.crud)&&void 0!==e&&e})),i.a.createElement(u.a,{pageName:s.a.case})):i.a.createElement(U,null)}));$.displayName="CasesPage";var Q=a(237);const V=e=>i.a.createElement(Q.a,F()({hideSourcerer:!0},e)),W=i.a.memo(V),G=i.a.memo((()=>{const{cases:e,application:{navigateToApp:t}}=Object(m.j)().services,a=Object(p.a)(g.a.case),i=Object(n.useCallback)((async({id:e})=>t(o.l,{deepLinkId:s.a.case,path:Object(f.b)({id:e,search:a})})),[t,a]),r=Object(n.useCallback)((async()=>t(o.l,{deepLinkId:s.a.case,path:Object(f.d)(a)})),[t,a]);return e.getCreateCase({onCancel:r,onSuccess:i,timelineIntegration:{editor_plugins:{parsingPlugin:j.a,processingPluginRenderer:j.c,uiPlugin:j.b},hooks:{useInsertTimeline:O.a}},owner:[o.l]})}));G.displayName="Create";const K=i.a.memo((()=>{const e=Object(m.h)(),t=Object(p.a)(g.a.case),{application:{navigateToApp:a}}=Object(m.j)().services,r=Object(n.useMemo)((()=>({path:Object(f.d)(t),text:c.a,pageId:s.a.case})),[t]);return Object(n.useEffect)((()=>{null==e||e.crud||a(o.l,{deepLinkId:s.a.case,path:Object(f.d)(t)})}),[e,a,t]),i.a.createElement(i.a.Fragment,null,i.a.createElement(d.a,null,i.a.createElement(W,{backOptions:r,title:c.f,border:!0}),i.a.createElement(G,null)),i.a.createElement(u.a,{pageName:s.a.case}))}));K.displayName="CreateCasePage";const Y=L.a.div.withConfig({displayName:"WhitePageWrapper",componentId:"sc-d11hu8-0"})(["background-color:",";border-top:",";flex:1 1 auto;"],(({theme:e})=>e.eui.euiColorEmptyShade),(({theme:e})=>e.eui.euiBorderThin)),J=L.a.div.withConfig({displayName:"SectionWrapper",componentId:"sc-d11hu8-1"})(["box-sizing:content-box;margin:0 auto;max-width:1175px;width:100%;"]),X=()=>{var e;const{application:{navigateToApp:t},cases:a}=Object(m.j)().services,r=Object(m.h)(),l=Object(p.a)(g.a.case),b=Object(n.useMemo)((()=>({path:Object(f.d)(l),text:c.a,pageId:s.a.case})),[l]);Object(n.useEffect)((()=>{null==r||r.read||t(o.l,{deepLinkId:s.a.case,path:Object(f.d)(l)})}),[t,r,l]);const h=L.a.div.withConfig({displayName:"HeaderWrapper",componentId:"sc-ty9qqa-0"})(["padding-top:",";"],(({theme:e})=>e.eui.paddingSizes.l));return i.a.createElement(i.a.Fragment,null,i.a.createElement(d.a,{noPadding:!0},i.a.createElement(J,null,i.a.createElement(h,null,i.a.createElement(W,{title:c.d,backOptions:b}))),i.a.createElement(Y,null,a.getConfigureCases({userCanCrud:null!==(e=null==r?void 0:r.crud)&&void 0!==e&&e,owner:[o.l]}))),i.a.createElement(u.a,{pageName:s.a.case}))},Z=i.a.memo(X),ee=`${o.v}/:detailName`,te=`${ee}/sub-cases/:subCaseId`,ae=`${ee}/:commentId`,ne=`${te}/:commentId`,ie=`${o.v}/create`,re=`${o.v}/configure`,se=()=>{const e=Object(m.h)(),t=Object(m.j)().services.chrome;return Object(n.useEffect)((()=>(null!=e&&!e.crud&&e.read&&t.setBadge({text:c.i,tooltip:c.j,iconType:"glasses"}),()=>{t.setBadge()})),[e,t]),i.a.createElement(l.Switch,null,i.a.createElement(l.Route,{path:ie},i.a.createElement(K,null)),i.a.createElement(l.Route,{path:re},i.a.createElement(Z,null)),i.a.createElement(l.Route,{exact:!0,path:ne},i.a.createElement(D,null)),i.a.createElement(l.Route,{exact:!0,path:ae},i.a.createElement(D,null)),i.a.createElement(l.Route,{exact:!0,path:te},i.a.createElement(D,null)),i.a.createElement(l.Route,{path:ee},i.a.createElement(D,null)),i.a.createElement(l.Route,{strict:!0,exact:!0,path:o.v},i.a.createElement($,null)))},oe=i.a.memo(se),le=[{path:o.v,render:()=>i.a.createElement(r.TrackApplicationView,{viewId:s.a.case},i.a.createElement(oe,null))}];var ce=a(260),ue=a(187);const de=S.i18n.translate("xpack.securitySolution.alerts.badge.readOnly.text",{defaultMessage:"Read only"}),pe=S.i18n.translate("xpack.securitySolution.alerts.badge.readOnly.tooltip",{defaultMessage:"Unable to update alerts"});var me=a(19),fe=a(116),ge=a(22),be=a(93),he=a(132),ye=a(235),ve=a(159),Ee=a(236),Te=a(156),ke=a(141),xe=a(59),Se=a(451),we=a(127),Oe=a(97),je=a(179),Ce=a(475),Ie=a(110),Me=a(18),Ae=a(165),qe=a(311),De=a(352),Pe=a(117),Re=a(105),Fe=a(462),_e=a(416);const Ne=({browserFields:e,columnId:t,data:a,ecsData:n,eventId:r,globalFilters:s,header:o,isDetails:l,isDraggable:c,isExpandable:u,isExpanded:d,linkValues:p,rowIndex:m,rowRenderers:f,setCellProps:g,timelineId:b,truncate:h})=>i.a.createElement(_e.a,{browserFields:e,columnId:t,data:a,ecsData:n,eventId:r,globalFilters:s,header:o,isDetails:l,isDraggable:c,isExpandable:u,isExpanded:d,linkValues:p,rowIndex:m,rowRenderers:f,setCellProps:g,timelineId:b,truncate:h});var Le=a(460),Be=a(62),ze=a.n(Be),He=a(446),Ue=a(412),$e=a(641),Qe=a(221);const Ve="open",We=({status:e="open",onFilterGroupChanged:t})=>{const a=[{id:"open",label:Qe.A,"data-test-subj":"openAlerts"},{id:"acknowledged",label:Qe.a,"data-test-subj":"acknowledgedAlerts"},{id:"closed",label:Qe.t,"data-test-subj":"closedAlerts"}],r=Object(n.useCallback)((e=>{t(e)}),[t]);return i.a.createElement(_.EuiButtonGroup,{legend:"filter status",color:"primary",options:a,idSelected:e,"data-test-subj":"alerts-table-filter-group",onChange:r})},Ge=i.a.memo(We),Ke=L()(_.EuiFlexGroup).withConfig({displayName:"UtilityBarFlexGroup",componentId:"sc-jqzk8o-0"})(["min-width:175px;"]),Ye=L()(_.EuiFlexItem).withConfig({displayName:"AdditionalFiltersItem",componentId:"sc-jqzk8o-1"})(["padding:",";"],(({theme:e})=>e.eui.paddingSizes.s)),Je=L()(Ye).withConfig({displayName:"BuildingBlockContainer",componentId:"sc-jqzk8o-2"})(["background:",";"],(({theme:e})=>e.eui.euiColorHighlight)),Xe=({areEventsLoading:e,clearSelection:t,currentFilter:a,hasIndexMaintenance:r,hasIndexWrite:s,onShowBuildingBlockAlertsChanged:l,onShowOnlyThreatIndicatorAlertsChanged:c,selectAll:u,selectedEventIds:d,showBuildingBlockAlerts:p,showClearSelection:f,showOnlyThreatIndicatorAlerts:g,totalCount:b,updateAlertsStatus:h})=>{const[y]=Object(m.o)(o.O),v=Object(n.useCallback)((async e=>{await h({alertIds:Object.keys(d),status:a,selectedStatus:e})}),[a,d,h]),E=ze()(b).format(y),T=ze()(Object.keys(d).length).format(y),k=Object(n.useCallback)((()=>{f?t():u()}),[t,u,f]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(Ue.a,null,i.a.createElement(Ue.d,{grow:!0},i.a.createElement(Ue.c,null,i.a.createElement(Ue.f,{dataTestSubj:"showingAlerts"},$e.j(E,b))),i.a.createElement(Ue.c,{grow:!0},s&&r&&i.a.createElement(i.a.Fragment,null,i.a.createElement(Ue.f,{dataTestSubj:"selectedAlerts"},$e.h(f?E:T,f?b:Object.keys(d).length)),i.a.createElement(Ue.b,{dataTestSubj:"alertActionPopover",disabled:e||Object(me.isEmpty)(d)&&!1===f,iconType:"arrowDown",iconSide:"right",ownFocus:!1,popoverContent:e=>i.a.createElement(Ke,{direction:"column"},a!==Ve&&i.a.createElement(_.EuiFlexItem,null,i.a.createElement(He.a,{"aria-label":"openSelectedAlerts",onClick:()=>{e(),v("open")},color:"text","data-test-subj":"openSelectedAlertsButton"},$e.f)),"closed"!==a&&i.a.createElement(_.EuiFlexItem,null,i.a.createElement(He.a,{"aria-label":"closeSelectedAlerts",onClick:()=>{e(),v("closed")},color:"text","data-test-subj":"closeSelectedAlertsButton"},$e.e)),"acknowledged"!==a&&i.a.createElement(_.EuiFlexItem,null,i.a.createElement(He.a,{"aria-label":"markSelectedAlertsAcknowledged",onClick:()=>{e(),v("acknowledged")},color:"text","data-test-subj":"markSelectedAlertsAcknowledgedButton"},$e.d)))},$e.k),i.a.createElement(Ue.b,{"aria-label":"selectAllAlerts",dataTestSubj:"selectAllAlertsButton",iconType:f?"cross":"pagesSelect",onClick:k},f?$e.g:$e.i(E,b))),i.a.createElement(Ue.e,null),i.a.createElement(et,{areEventsLoading:e,onShowBuildingBlockAlertsChanged:l,showBuildingBlockAlerts:p,onShowOnlyThreatIndicatorAlertsChanged:c,showOnlyThreatIndicatorAlerts:g})))))},Ze=i.a.memo(Xe,((e,t)=>e.areEventsLoading===t.areEventsLoading&&e.selectedEventIds===t.selectedEventIds&&e.totalCount===t.totalCount&&e.showClearSelection===t.showClearSelection&&e.showBuildingBlockAlerts===t.showBuildingBlockAlerts&&e.showOnlyThreatIndicatorAlerts===t.showOnlyThreatIndicatorAlerts)),et=({areEventsLoading:e,onShowBuildingBlockAlertsChanged:t,showBuildingBlockAlerts:a,onShowOnlyThreatIndicatorAlertsChanged:n,showOnlyThreatIndicatorAlerts:r})=>i.a.createElement(Ue.b,{dataTestSubj:"additionalFilters",disabled:e,iconType:"arrowDown",iconSide:"right",ownFocus:!0,popoverContent:e=>i.a.createElement(Ke,{direction:"column",gutterSize:"none"},i.a.createElement(Je,null,i.a.createElement(_.EuiCheckbox,{id:"showBuildingBlockAlertsCheckbox","aria-label":"showBuildingBlockAlerts",onChange:a=>{e(),t(a.target.checked)},checked:a,color:"text","data-test-subj":"showBuildingBlockAlertsCheckbox",label:$e.b})),i.a.createElement(Ye,null,i.a.createElement(_.EuiCheckbox,{id:"showOnlyThreatIndicatorAlertsCheckbox","aria-label":"showOnlyThreatIndicatorAlerts",onChange:t=>{e(),n(t.target.checked)},checked:r,color:"text","data-test-subj":"showOnlyThreatIndicatorAlertsCheckbox",label:$e.c})))},$e.a);var tt=a(245),at=a(645);const nt=({clearSelected:e,defaultFilters:t,from:a,globalFilters:r,globalQuery:s,hasIndexMaintenance:o,hasIndexWrite:l,isSelectAllChecked:c,loading:u,loadingEventIds:d,onRuleChange:p,onShowBuildingBlockAlertsChanged:f,onShowOnlyThreatIndicatorAlertsChanged:g,selectedEventIds:h,setEventsDeleted:T,setEventsLoading:k,showBuildingBlockAlerts:x,showOnlyThreatIndicatorAlerts:S,timelineId:w,to:O,filterGroup:j="open"})=>{var C,I;const M=Object(b.useDispatch)(),[A,q]=Object(n.useState)(!1),{browserFields:D,indexPattern:P,loading:R,selectedPatterns:F}=Object(v.c)(E.SourcererScopeName.detections),_=Object(m.j)(),[,N]=Object(we.h)(),{addWarning:L}=Object(Oe.a)(),B=Object(fe.a)("ruleRegistryEnabled"),z=Object(n.useCallback)((e=>null!=D&&null!=P?Object(Pe.i)({config:xe.esQuery.getEsQueryConfig(_.services.uiSettings),dataProviders:[],indexPattern:P,browserFields:D,filters:[...null!=t?t:[],...r,...e,...Object(at.a)(a,O)],kqlQuery:s,kqlMode:s.language,isEventViewer:!0}):null),[D,t,r,s,P,_,O,a]);Object(je.a)({id:w,filterQuery:null===(C=z([]))||void 0===C?void 0:C.filterQuery,kqlError:null===(I=z([]))||void 0===I?void 0:I.kqlError,query:s,startDate:a,endDate:O});const H=Object(n.useCallback)((({eventIds:e,isLoading:t})=>{k({id:w,eventIds:e,isLoading:t})}),[k,w]),U=Object(n.useCallback)((({eventIds:e,isDeleted:t})=>{T({id:w,eventIds:e,isDeleted:t})}),[T,w]),$=Object(n.useCallback)(((e,t,a)=>{if(t>0)L({title:Me.b(t),text:Me.c(e,t)});else{let t="";switch(a){case"closed":t=Qe.v(e);break;case"open":t=Qe.z(e);break;case"acknowledged":case"in-progress":t=Qe.c(e)}Object(we.e)(t,N)}}),[L,N]),Q=Object(n.useCallback)(((e,t)=>{let a="";switch(e){case"closed":a=Qe.u;break;case"open":a=Qe.y;break;case"acknowledged":case"in-progress":a=Qe.b}Object(we.d)(a,[t.message],N)}),[N]);Object(n.useEffect)((()=>{c?M(y.a.setTGridSelectAll({id:w,selectAll:!1})):q(!1)}),[M,c,w]);const V=Object(n.useCallback)((()=>{e({id:w}),M(y.a.setTGridSelectAll({id:w,selectAll:!1})),q(!1)}),[e,M,w]),W=Object(n.useCallback)((()=>{M(y.a.setTGridSelectAll({id:w,selectAll:!0})),q(!0)}),[M,w]),G=Object(n.useCallback)((async(e,{status:t,selectedStatus:a})=>{var n;const i=B?Object(tt.d)(t):Object(tt.c)(t);await Object(Le.c)({query:A?null===(n=z(i))||void 0===n?void 0:n.filterQuery:void 0,alertIds:Object.keys(h),selectedStatus:a,setEventsDeleted:U,setEventsLoading:H,onAlertStatusUpdateSuccess:$,onAlertStatusUpdateFailure:Q}),e()}),[z,h,U,H,A,$,Q,B]),K=Object(n.useCallback)(((e,t)=>i.a.createElement(Ze,{areEventsLoading:d.length>0,clearSelection:V,currentFilter:j,hasIndexMaintenance:o,hasIndexWrite:l,onShowBuildingBlockAlertsChanged:f,onShowOnlyThreatIndicatorAlertsChanged:g,selectAll:W,selectedEventIds:h,showBuildingBlockAlerts:x,showClearSelection:A,showOnlyThreatIndicatorAlerts:S,totalCount:t,updateAlertsStatus:G.bind(null,e)})),[V,j,o,l,d.length,f,g,W,h,x,A,S,G]),Y=i.a.createElement(et,{areEventsLoading:d.length>0,onShowBuildingBlockAlertsChanged:f,showBuildingBlockAlerts:x,onShowOnlyThreatIndicatorAlertsChanged:g,showOnlyThreatIndicatorAlerts:S}),J=Object(n.useMemo)((()=>{const e=B?Object(tt.d)(j):Object(tt.c)(j);return Object(me.isEmpty)(t)?e:null==t||Object(me.isEmpty)(t)?void 0:[...t,...e]}),[t,j,B]),{filterManager:X}=Object(m.j)().services.data.query,Z=B?tt.b:tt.a,ee=Object(fe.a)("tGridEnabled");Object(n.useEffect)((()=>{M(y.a.initializeTGridSettings({defaultColumns:Fe.a.map((e=>ee||null!=e.initialWidth?e:{...e,initialWidth:Ae.a})),documentType:Qe.i,excludedRowRendererIds:Z.excludedRowRendererIds,filterManager:X,footerText:Qe.D,id:w,loadingText:Qe.w,selectAll:!1,queryFields:tt.k,title:"",showCheckboxes:!0}))}),[M,Z,X,ee,w]);const te=Object(n.useMemo)((()=>Object(qe.a)(4)),[]);return u||R||Object(me.isEmpty)(F)?null:i.a.createElement(Se.a,{additionalFilters:Y,currentFilter:j,defaultCellActions:Ce.a,defaultModel:Z,end:O,entityType:"events",hasAlertsCrud:l&&o,id:w,leadingControlColumns:te,onRuleChange:p,pageFilters:J,renderCellValue:Ne,rowRenderers:De.b,scopeId:E.SourcererScopeName.detections,start:a,utilityBar:K})},it=Object(b.connect)((()=>{const e=y.b.getTimelineByIdSelector(),t=Ie.e.globalSelector();return(a,n)=>{var i;const{timelineId:r}=n,s=null!==(i=e(a,r))&&void 0!==i?i:Re.a,{deletedEventIds:o,isSelectAllChecked:l,loadingEventIds:c,selectedEventIds:u}=s,d=t(a),{query:p,filters:m}=d;return{globalQuery:p,globalFilters:m,deletedEventIds:o,isSelectAllChecked:l,loadingEventIds:c,selectedEventIds:u}}}),(e=>({clearSelected:({id:t})=>e(y.a.clearSelected({id:t})),setEventsLoading:({id:t,eventIds:a,isLoading:n})=>e(y.a.setEventsLoading({id:t,eventIds:a,isLoading:n})),setEventsDeleted:({id:t,eventIds:a,isDeleted:n})=>e(y.a.setEventsDeleted({id:t,eventIds:a,isDeleted:n}))})))(i.a.memo(nt)),rt=S.i18n.translate("xpack.securitySolution.detectionEngine.noApiIntegrationKeyCallOutTitle",{defaultMessage:"API integration key required"}),st=S.i18n.translate("xpack.securitySolution.detectionEngine.noApiIntegrationKeyCallOutMsg",{defaultMessage:"A new encryption key is generated for saved objects each time you start Kibana. Without a persistent key, you cannot delete or modify rules after Kibana restarts. To set a persistent key, add the xpack.encryptedSavedObjects.encryptionKey setting with any text value of 32 or more characters to the kibana.yml file."}),ot=S.i18n.translate("xpack.securitySolution.detectionEngine.dismissNoApiIntegrationKeyButton",{defaultMessage:"Dismiss"}),lt=()=>{const[e,t]=Object(n.useState)(!0),a=Object(n.useCallback)((()=>t(!1)),[t]);return e?i.a.createElement(i.a.Fragment,null,i.a.createElement(_.EuiCallOut,{title:rt,color:"danger",iconType:"alert"},i.a.createElement("p",null,st),i.a.createElement(_.EuiButton,{color:"danger",onClick:a},ot)),i.a.createElement(_.EuiSpacer,{size:"l"})):null},ct=Object(n.memo)(lt);var ut=a(530),dt=a(177),pt=a(192);S.i18n.translate("xpack.securitySolution.detectionEngine.detectionsBreadcrumbTitle",{defaultMessage:"Detections"});const mt=S.i18n.translate("xpack.securitySolution.detectionEngine.detectionsPageTitle",{defaultMessage:"Alerts"}),ft=(S.i18n.translate("xpack.securitySolution.detectionEngine.lastSignalTitle",{defaultMessage:"Last alert"}),S.i18n.translate("xpack.securitySolution.detectionEngine.totalSignalTitle",{defaultMessage:"Total"}),S.i18n.translate("xpack.securitySolution.detectionEngine.signalTitle",{defaultMessage:"Detected alerts"}),S.i18n.translate("xpack.securitySolution.detectionEngine.alertTitle",{defaultMessage:"Alerts"})),gt=S.i18n.translate("xpack.securitySolution.detectionEngine.buttonManageRules",{defaultMessage:"Manage rules"}),bt=(S.i18n.translate("xpack.securitySolution.detectionEngine.panelSubtitleShowing",{defaultMessage:"Showing"}),S.i18n.translate("xpack.securitySolution.detectionEngine.emptyTitle",{defaultMessage:"It looks like you don’t have any indices relevant to the detection engine in the Security application"}),S.i18n.translate("xpack.securitySolution.detectionEngine.emptyActionBeats",{defaultMessage:"View setup instructions"}),S.i18n.translate("xpack.securitySolution.detectionEngine.emptyActionSecondary",{defaultMessage:"Go to documentation"}),S.i18n.translate("xpack.securitySolution.detectionEngine.noIndexTitle",{defaultMessage:"Let’s set up your detection engine"})),ht=S.i18n.translate("xpack.securitySolution.detectionEngine.needsSignalsAndListsIndexesMessage",{defaultMessage:"You need permissions for the signals and lists indices."}),yt=S.i18n.translate("xpack.securitySolution.detectionEngine.needsSignalsIndexMessage",{defaultMessage:"You need permissions for the signals index."}),vt=S.i18n.translate("xpack.securitySolution.detectionEngine.needsListsIndexesMessage",{defaultMessage:"You need permissions for the lists indices."}),Et=e=>S.i18n.translate("xpack.securitySolution.detectionEngine.needsIndexPermissionsMessage",{values:{additionalContext:e},defaultMessage:"To use the detection engine, a user with the required cluster and index privileges must first access this page. {additionalContext} For more help, contact your Elastic Stack administrator."}),Tt=S.i18n.translate("xpack.securitySolution.detectionEngine.goToDocumentationButton",{defaultMessage:"View documentation"}),kt=S.i18n.translate("xpack.securitySolution.detectionEngine.userUnauthenticatedTitle",{defaultMessage:"Detection engine permissions required"}),xt=S.i18n.translate("xpack.securitySolution.detectionEngine.userUnauthenticatedMsgBody",{defaultMessage:"You do not have the required permissions for viewing the detection engine. For more help, contact your administrator."}),St=S.i18n.translate("xpack.securitySolution.detectionEngine.mlRulesDisabledMessageTitle",{defaultMessage:"ML rules require Platinum License and ML Admin Permissions"}),wt=S.i18n.translate("xpack.securitySolution.detectionEngine.noPermissionsTitle",{defaultMessage:"Privileges required"}),Ot=S.i18n.translate("xpack.securitySolution.detectionEngine.noPermissionsMessage",{defaultMessage:"To view alerts, you must update privileges. For more information, contact your Kibana administrator."}),jt=({needsListsIndex:e,needsSignalsIndex:t})=>{const a=Object(m.j)().services.docLinks,r=Object(n.useMemo)((()=>({detections:{icon:"documents",label:Tt,url:`${a.links.siem.detectionsReq}`,target:"_blank"}})),[a]),s=((e,t)=>Et(t&&e?ht:t?yt:e?vt:""))(e,t);return i.a.createElement(H,{actions:r,"data-test-subj":"no_index",message:s,title:bt})},Ct=i.a.memo(jt),It=e=>i.a.createElement(Q.a,F()({hideSourcerer:!0},e)),Mt=i.a.memo(It);Mt.displayName="DetectionEngineHeaderPage";var At=a(98),qt=a(207);const Dt=S.i18n.translate("xpack.securitySolution.containers.detectionEngine.alerts.fetchListsIndex.errorDescription",{defaultMessage:"Failed to retrieve the lists index"}),Pt=S.i18n.translate("xpack.securitySolution.containers.detectionEngine.alerts.createListsIndex.errorDescription",{defaultMessage:"Failed to create the lists index"});var Rt=a(279);const Ft=e=>{const[t]=Object.keys(e),a=e[t];return null!=a&&a.manage},_t=e=>{const[t]=Object.keys(e),a=e[t];return null!=a&&a.read},Nt=e=>{const[t]=Object.keys(e),a=e[t];return null!=a&&(a.create||a.create_doc||a.index||a.write)},Lt=()=>{const[e,t]=Object(n.useState)({isAuthenticated:null,canManageIndex:null,canReadIndex:null,canWriteIndex:null}),{listPrivileges:a}=Object(Rt.b)();return Object(n.useEffect)((()=>{if(null!=a.result){const{is_authenticated:e,lists:{index:n},listItems:{index:i}}=a.result;t({isAuthenticated:e,canReadIndex:_t(n)&&_t(i),canManageIndex:Ft(n)&&Ft(i),canWriteIndex:Nt(n)&&Nt(i)})}}),[a.result]),Object(n.useEffect)((()=>{null!=a.error&&t({isAuthenticated:!1,canManageIndex:!1,canReadIndex:!1,canWriteIndex:!1})}),[a.error]),{loading:a.loading,...e}},Bt=()=>{const{createIndex:e,indexExists:t,loading:a,error:i}=(()=>{const[e,t]=Object(n.useState)(null),[a,i]=Object(n.useState)(null),{lists:r}=Object(m.j)().services,s=Object(m.i)(),{addError:o}=Object(Oe.a)(),{canReadIndex:l}=Lt(),{loading:c,start:u,...d}=Object(qt.k)(),{loading:p,start:f,...g}=Object(qt.d)(),b=c||p,h=Object(n.useCallback)((()=>{r&&l&&u({http:s})}),[s,r,u,l]),y=Object(n.useCallback)((()=>{r&&f({http:s})}),[f,s,r]);return Object(n.useEffect)((()=>{c||a||null!==e||h()}),[a,e,h,c]),Object(n.useEffect)((()=>{null!=d.result&&t(d.result.list_index&&d.result.list_item_index)}),[d.result]),Object(n.useEffect)((()=>{null!=g.result&&h()}),[g.result,h]),Object(n.useEffect)((()=>{const e=d.error;null!=e&&(Object(At.t)(e)&&404===e.body.status_code?t(!1):(i(e),o(e,{title:Dt})))}),[o,d.error]),Object(n.useEffect)((()=>{const e=g.error;null!=e&&(i(e),o(e,{title:Pt}))}),[o,g.error]),{createIndex:y,error:a,indexExists:e,loading:b}})(),{canManageIndex:r,canWriteIndex:s,loading:o}=Lt(),{lists:l}=Object(m.j)().services,c=null!=l,u=a||o,d=!1===t,p=!c||d&&(!1===r||!0===r&&null!=i);return Object(n.useEffect)((()=>{d&&r&&e()}),[r,e,d]),{canManageIndex:r,canWriteIndex:s,enabled:c,loading:u,needsConfiguration:p}},zt=i.a.memo((()=>{const e=Object(m.j)().services.docLinks,t=Object(n.useMemo)((()=>({detectionUnauthenticated:{icon:"documents",label:Tt,url:`${e.links.siem.detectionsReq}`,target:"_blank"}})),[e]);return i.a.createElement(H,{actions:t,message:xt,"data-test-subj":"no_index",title:kt})}));zt.displayName="DetectionEngineUserUnauthenticated";var Ht=a(103),Ut=a(128);const $t=L.a.div.withConfig({displayName:"Display",componentId:"sc-1njjyjq-0"})(["",";"],(({show:e})=>e?"":"display: none;"));$t.displayName="Display";var Qt=a(1);const Vt=S.i18n.translate("xpack.securitySolution.callouts.dismissButton",{defaultMessage:"Dismiss"}),Wt=({message:e,text:t,onClick:a=me.noop})=>{const{type:r}=e,s="success"===r?"secondary":r,o=null!=t?t:Vt,l=Object(n.useCallback)((()=>a(e)),[a,e]);return i.a.createElement(_.EuiButton,{color:s,"data-test-subj":"callout-dismiss-btn",onClick:l},o)},Gt=({message:e,iconType:t,dismissButtonText:a,onDismiss:n,showDismissButton:r=!0})=>{const{type:s,id:o,title:l,description:c}=e,u=null!=t?t:Kt(s);return i.a.createElement(_.EuiCallOut,{color:s,title:l,iconType:u,"data-test-subj":`callout-${o}`,"data-test-messages":`[${o}]`},c,r&&i.a.createElement(Wt,{message:e,text:a,onClick:n}))},Kt=e=>{switch(e){case"primary":return"iInCircle";case"success":return"cheer";case"warning":return"help";case"danger":return"alert";default:return Object(Qt.a)(e)}},Yt=Object(n.memo)(Gt);var Jt=a(938),Xt=a.n(Jt);const Zt=()=>{const{storage:e}=Object(m.j)().services,t=Object(n.useCallback)((t=>{var a;return null!==(a=e.get(`${t}-messages`))&&void 0!==a?a:[]}),[e]),a=Object(n.useCallback)(((t,a)=>{var n;const i=null!==(n=e.get(`${t}-messages`))&&void 0!==n?n:[];e.set(`${t}-messages`,[...i,a])}),[e]),i=Object(n.useCallback)(((t,a)=>{var n;return(null!==(n=e.get(`${t}-messages`))&&void 0!==n?n:[]).filter((e=>e===a)).length>0}),[e]),r=Object(n.useCallback)(((t,a)=>{var n;const i=null!==(n=e.get(`${t}-messages`))&&void 0!==n?n:[];e.set(`${t}-messages`,[...i.filter((e=>e!==a))])}),[e]);return{getMessages:t,addMessage:a,clearAllMessages:Object(n.useCallback)((t=>e.remove(`${t}-messages`)),[e]),removeMessage:r,hasMessage:i}},ea=e=>`kibana.securitySolution.${e}.callouts.dismissed`,ta=(e,t)=>aa(e,me.identity,(()=>t)),aa=(e,t,a)=>{const n=e.map((e=>[t(e),a(e)]));return Object(me.fromPairs)(n)},na=({namespace:e,condition:t,message:a})=>{const{isVisible:r,dismiss:s}=((e,t="common")=>{const{getMessages:a,addMessage:i}=Zt(),[r,s]=Xt()({}),o=ea(t),l=Object(n.useCallback)((()=>Object.entries(r).filter((([e,t])=>t)).map((([e,t])=>e))),[r]),c=Object(n.useCallback)((e=>{var t;return null!==(t=r[e.id])&&void 0!==t&&t}),[r]),u=Object(n.useCallback)((e=>{const{id:t,type:a}=e;s.set(t,!1),"primary"!==a&&"success"!==a||i(o,t)}),[s,i,o]),d=Object(n.useCallback)((e=>{const t=a(o),n=Object(me.difference)(e,t),i=Object(me.intersection)(e,t);s.setAll({...ta(n,!0),...ta(i,!1)})}),[a,o,s]);return Object(n.useEffect)((()=>{const t=e.map((e=>e.id)),a=Object.keys(r);Object(me.isEqual)(t,a)||d(t)}),[e,r,d]),{getVisibleMessageIds:l,isVisible:c,dismiss:u}})([a],e);return t&&r(a)?i.a.createElement(i.a.Fragment,null,i.a.createElement(Yt,{message:a,onDismiss:s}),i.a.createElement(_.EuiSpacer,{size:"l"})):null},ia=Object(n.memo)(na),ra=({condition:e,message:t})=>e?i.a.createElement(Yt,{message:t,showDismissButton:!1}):null,sa=Object(n.memo)(ra);var oa=a(57);const la=({url:e,children:t,ariaLabel:a})=>t?i.a.createElement(_.EuiToolTip,{content:e,position:"top","data-test-subj":"externalLinkTooltip"},i.a.createElement(_.EuiLink,{href:e,"aria-label":a,external:!0,target:"_blank",rel:"noopener","data-test-subj":"externalLink"},t)):null,ca=S.i18n.translate("xpack.securitySolution.documentationLinks.ariaLabelEnding",{defaultMessage:"click to open documentation in a new tab"}),ua=S.i18n.translate("xpack.securitySolution.documentationLinks.solutionRequirements.text",{defaultMessage:"Elastic Security system requirements"}),da=S.i18n.translate("xpack.securitySolution.documentationLinks.detectionsRequirements.text",{defaultMessage:"Detections prerequisites and requirements"}),pa=S.i18n.translate("xpack.securitySolution.documentationLinks.mlJobCompatibility.text",{defaultMessage:"ML job compatibility"}),ma=({guidePath:e="security",docPath:t,linkText:a})=>{const{services:n}=Object(m.j)(),{ELASTIC_WEBSITE_URL:r,DOC_LINK_VERSION:s}=n.docLinks,o=`${r}guide/en/${e}/${s}/${t}`,l=`${a} - ${ca}`;return i.a.createElement(la,{url:o,ariaLabel:l},a)},fa=Object(n.memo)(ma),ga=()=>i.a.createElement(fa,{docPath:"sec-requirements.html",linkText:ua}),ba=()=>i.a.createElement(fa,{docPath:"detections-permissions-section.html",linkText:da}),ha=()=>i.a.createElement(fa,{docPath:"alerts-ui-monitor.html#ml-job-compatibility",linkText:pa}),ya={type:"primary",id:"need-admin-for-update-rules",title:S.i18n.translate("xpack.securitySolution.detectionEngine.needAdminForUpdateCallOutBody.messageTitle",{defaultMessage:"Administration permissions required for alert migration"}),description:i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.needAdminForUpdateCallOutBody.messageBody.messageDetail",defaultMessage:"{essence} Related documentation: {docs}",values:{essence:i.a.createElement("p",null,i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.needAdminForUpdateCallOutBody.messageBody.essenceDescription",defaultMessage:"You are currently missing the required permissions to auto migrate your alert data. Please have your administrator visit this page one time to auto migrate your alert data."})),docs:i.a.createElement("ul",null,i.a.createElement("li",null,i.a.createElement(ba,null)),i.a.createElement("li",null,i.a.createElement(ga,null)))}})},va=()=>{const[{signalIndexMappingOutdated:e,hasIndexManage:t}]=Object(dt.b)();return null!=e&&e&&(null!=t&&!t)?i.a.createElement(i.a.Fragment,null,i.a.createElement(sa,{condition:!0,message:ya}),i.a.createElement(_.EuiSpacer,{size:"l"})):null},Ea=Object(n.memo)(va);var Ta=a(939),ka=a.n(Ta);const xa=({values:e})=>i.a.createElement(i.a.Fragment,null,e.map(((t,a)=>i.a.createElement(i.a.Fragment,{key:a},i.a.createElement(_.EuiCode,null,t),a<e.length-1?", ":"")))),Sa=S.i18n.translate("xpack.securitySolution.detectionEngine.missingPrivilegesCallOut.messageTitle",{defaultMessage:"Insufficient privileges"}),wa=S.i18n.translate("xpack.securitySolution.detectionEngine.missingPrivilegesCallOut.cannotEditRules",{defaultMessage:"Without that privilege you cannot create or edit detection engine rules."}),Oa=S.i18n.translate("xpack.securitySolution.detectionEngine.missingPrivilegesCallOut.cannotEditLists",{defaultMessage:"Without these privileges, you cannot create or edit value lists."}),ja=S.i18n.translate("xpack.securitySolution.detectionEngine.missingPrivilegesCallOut.cannotEditAlerts",{defaultMessage:"Without these privileges, you cannot view or change status of alerts."}),Ca=({indexPrivileges:e,featurePrivileges:t=[]})=>i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.missingPrivilegesCallOut.messageBody.messageDetail",defaultMessage:"{essence} {indexPrivileges} {featurePrivileges} Related documentation: {docs}",values:{essence:i.a.createElement("p",null,i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.missingPrivilegesCallOut.messageBody.essenceDescription",defaultMessage:"You need the following privileges to fully access this functionality. Contact your administrator for further assistance."})),indexPrivileges:e.length>0?i.a.createElement(i.a.Fragment,null,i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.missingPrivilegesCallOut.messageBody.indexPrivilegesTitle",defaultMessage:"Missing Elasticsearch index privileges:"}),i.a.createElement("ul",null,e.map((([e,t])=>i.a.createElement("li",{key:e},Aa(e,t)))))):null,featurePrivileges:t.length>0?i.a.createElement(i.a.Fragment,null,i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.missingPrivilegesCallOut.messageBody.featurePrivilegesTitle",defaultMessage:"Missing Kibana feature privileges:"}),i.a.createElement("ul",null,t.map((([e,t])=>i.a.createElement("li",{key:e},qa(e,t)))))):null,docs:i.a.createElement("ul",null,i.a.createElement("li",null,i.a.createElement(ba,null)),i.a.createElement("li",null,i.a.createElement(ga,null)))}}),Ia={[o.Ib]:{all:wa},[o.Q]:{write:ja},[o.M]:{write:Oa},[o.L]:{write:Oa}},Ma=(e,t)=>{var a;const n=null===(a=Object.entries(Ia).find((([e])=>t.startsWith(e))))||void 0===a?void 0:a[1];return e.map((e=>null==n?void 0:n[e])).filter(Boolean).join(" ")},Aa=(e,t)=>i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.missingPrivilegesCallOut.messageBody.missingIndexPrivileges",defaultMessage:"Missing {privileges} privileges for the {index} index. {explanation}",values:{privileges:i.a.createElement(xa,{values:t}),index:i.a.createElement(_.EuiCode,null,e),explanation:Ma(t,e)}}),qa=(e,t)=>i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.missingPrivilegesCallOut.messageBody.missingFeaturePrivileges",defaultMessage:"Missing {privileges} privileges for the {index} feature. {explanation}",values:{privileges:i.a.createElement(xa,{values:t}),index:i.a.createElement(_.EuiCode,null,e),explanation:Ma(t,e)}}),Da=["read","write","view_index_metadata","maintenance"],Pa=e=>{const t=(e=>{const[t]=Object.keys(e);return t})(e),a=e[t],n=Da.filter((e=>!a[e]));if(n.length)return[t,n]},Ra=()=>{const e=(()=>{const{detectionEnginePrivileges:e,listPrivileges:t}=Object(Rt.b)(),[{canUserCRUD:a}]=Object(dt.b)();return Object(n.useMemo)((()=>{const n=[],i=[];if(null==a||null==t.result||null==e.result)return{featurePrivileges:n,indexPrivileges:i};!1===a&&n.push([o.Ib,["all"]]);const r=Pa(t.result.listItems.index);r&&i.push(r);const s=Pa(t.result.lists.index);s&&i.push(s);const l=Pa(e.result.index);return l&&i.push(l),{featurePrivileges:n,indexPrivileges:i}}),[a,t,e])})(),t=Object(n.useMemo)((()=>{if(!(e.indexPrivileges.length>0||e.featurePrivileges.length>0))return null;return{type:"primary",id:`missing-user-privileges-${ka()(e)}`,title:Sa,description:Ca(e)}}),[e]);return t&&i.a.createElement(ia,{namespace:"detections",condition:!0,message:t})},Fa=Object(n.memo)(Ra);var _a=a(24),Na=a.n(_a),La=a(158),Ba=a(328),za=a(169);const Ha=(e,t,a,n=[])=>({size:0,aggs:{alertsByGroupingCount:{terms:{field:e,order:{_count:"desc"},size:o.N}}},query:{bool:{filter:[...n,{range:{"@timestamp":{gte:t,lte:a}}}]}}});a(476);const Ua=S.i18n.translate("xpack.securitySolution.detectionEngine.alerts.count.countTableColumnTitle",{defaultMessage:"Count"}),$a=S.i18n.translate("xpack.securitySolution.detectionEngine.alerts.count.countTableTitle",{defaultMessage:"Count"});var Qa=a(99);const Va=L.a.div.withConfig({displayName:"Wrapper",componentId:"sc-1p6ej67-0"})(["margin-top:-",";"],(({theme:e})=>e.eui.euiSizeS)),Wa=Object(n.memo)((({loading:e,selectedStackByOption:t,data:a})=>{var r,s,l;const[c]=Object(m.o)(o.O),u=null!==(r=null==a||null===(s=a.aggregations)||void 0===s||null===(l=s.alertsByGroupingCount)||void 0===l?void 0:l.buckets)&&void 0!==r?r:[],d=Object(n.useMemo)((()=>((e,t)=>[{field:"key",name:e,truncateText:!1,render:function(t){return i.a.createElement(Qa.b,{isDraggable:!1,field:e,hideTopN:!0,id:`alert-count-draggable-${e}-${t}`,value:t,tooltipContent:null})}},{field:"doc_count",name:Ua,sortable:!0,textOnly:!0,dataType:"number",render:e=>ze()(e).format(t)}])(t,c)),[t,c]);return i.a.createElement(i.a.Fragment,null,e&&i.a.createElement(_.EuiProgress,{size:"xs",position:"absolute",color:"accent"}),i.a.createElement(Va,{"data-test-subj":"alertsCountTable",className:"eui-yScroll"},i.a.createElement(_.EuiInMemoryTable,{isSelectable:!1,columns:d,items:u,loading:e,sorting:!0})))}));Wa.displayName="AlertsCount";var Ga=a(383),Ka=a(682),Ya=a(683);const Ja=Object(n.memo)((({filters:e,query:t,signalIndexName:a})=>{const{to:r,from:s,deleteQuery:o,setQuery:l}=Object(he.a)(),c=Object(n.useMemo)((()=>`detections-alerts-count-${Na.a.v4()}`),[]),[u,d]=Object(n.useState)(Ga.b),p=Object(n.useMemo)((()=>{try{var a;return[xe.esQuery.buildEsQuery(void 0,null!=t?[t]:[],null!==(a=null==e?void 0:e.filter((e=>!1===e.meta.disabled)))&&void 0!==a?a:[])]}catch(e){return[]}}),[t,e]),{loading:m,data:f,setQuery:g,response:b,request:h,refetch:y}=Object(Ba.a)({query:Ha(u,s,r,p),indexName:a});return Object(n.useEffect)((()=>{g(Ha(u,s,r,p))}),[g,u,s,r,p]),Object(Ya.a)({setQuery:l,response:b,request:h,refetch:y,uniqueQueryId:c,deleteQuery:o,loading:m}),i.a.createElement(za.b,null,i.a.createElement(Ka.a,{hasBorder:!0,"data-test-subj":"alertsCountPanel"},i.a.createElement(La.a,{id:c,title:$a,titleSize:"s",hideSubtitle:!0},i.a.createElement(Ka.b,{selected:u,onSelect:d})),i.a.createElement(Wa,{data:f,loading:m,selectedStackByOption:u})))}));Ja.displayName="AlertsCountPanel";const Xa=L.a.div.withConfig({displayName:"StyledFullHeightContainer",componentId:"sc-7rr6ls-0"})(["display:flex;flex-direction:column;flex:1 1 auto;"]),Za=({clearEventsDeleted:e,clearEventsLoading:t,clearSelected:a})=>{const r=Object(b.useDispatch)(),o=Object(n.useRef)(null),l=Object(n.useMemo)((()=>y.b.getTimelineByIdSelector()),[]),c=Object(be.b)((e=>{var t;return(null!==(t=l(e,h.q.detectionsPage))&&void 0!==t?t:Re.a).graphEventId})),u=Object(be.b)((e=>{var t;return(null!==(t=l(e,h.q.detectionsPage))&&void 0!==t?t:Re.a).updated})),p=Object(be.b)((e=>{var t;return(null!==(t=l(e,h.q.detectionsPage))&&void 0!==t?t:Re.a).isLoading})),g=Object(n.useMemo)((()=>Te.d.globalFiltersQuerySelector()),[]),T=Object(n.useMemo)((()=>Te.d.globalQuerySelector()),[]),k=Object(be.a)(T),x=Object(be.a)(g),S=Object(fe.a)("ruleRegistryEnabled"),{to:w,from:O}=Object(he.a)(),{globalFullScreen:j}=Object(Ut.a)(),[{loading:C,isAuthenticated:I,hasEncryptionKey:M,signalIndexName:A,hasIndexWrite:q=!1,hasIndexMaintenance:D=!1,canUserREAD:P,hasIndexRead:R}]=Object(dt.b)(),{loading:F,needsConfiguration:N}=Bt(),{formatUrl:L}=Object(f.n)(s.a.rules),[B,z]=Object(n.useState)(!1),[U,$]=Object(n.useState)(!1),Q=C||F,{application:{navigateToUrl:V},timelines:W,docLinks:G}=Object(m.j)().services,[K,Y]=Object(n.useState)(Ve),J=Object(n.useMemo)((()=>p||Q),[p,Q]),X=Object(n.useCallback)((({x:e})=>{if(!e)return;const[t,a]=e;r(Object(ke.setAbsoluteRangeDatePicker)({id:"global",from:new Date(t).toISOString(),to:new Date(a).toISOString()}))}),[r]),Z=Object(n.useCallback)((e=>{e.preventDefault(),V(L(Object(ve.e)()))}),[L,V]),ee=Object(n.useCallback)((a=>{const n=h.q.detectionsPage;t({id:n}),e({id:n}),Y(a)}),[t,e,Y]),te=Object(n.useMemo)((()=>[...x,...S?[...Object(tt.i)(B),...Object(tt.d)(K)]:[...Object(tt.h)(B),...Object(tt.c)(K)],...Object(tt.j)(U)]),[x,S,B,U,K]),ae=Object(n.useMemo)((()=>[...S?[...Object(tt.i)(B)]:[...Object(tt.h)(B)],...Object(tt.j)(U)]),[S,B,U]),ne=Object(n.useCallback)((e=>{z(e)}),[z]),ie=Object(n.useCallback)((e=>{$(e)}),[$]),{indicesExist:re,indexPattern:se}=Object(v.c)(E.SourcererScopeName.detections),oe=Object(n.useCallback)((()=>{Object(Pe.k)(o.current)}),[o]),le=Object(n.useCallback)((()=>{Object(Pe.m)()}),[]),ce=Object(n.useCallback)((e=>{Object(ge.isTab)(e)&&Object(Pe.l)({containerElement:o.current,keyboardEvent:e,onSkipFocusBeforeEventsTable:oe,onSkipFocusAfterEventsTable:le})}),[o,oe,le]),ue=Object(n.useMemo)((()=>({feature:{icon:"documents",label:Tt,url:`${G.links.siem.privileges}`,target:"_blank"}})),[G]);return Q?i.a.createElement(d.a,null,i.a.createElement(Mt,{border:!0,title:mt,isLoading:Q}),i.a.createElement(_.EuiFlexGroup,{justifyContent:"center",alignItems:"center"},i.a.createElement(_.EuiLoadingSpinner,{size:"xl"}))):null==I||I||Q?Q||!1!==re&&!N?i.a.createElement(i.a.Fragment,null,null!=M&&!M&&i.a.createElement(ct,null),i.a.createElement(Ea,null),i.a.createElement(Fa,null),!re||!1!==R&&!1!==P?re&&R&&P?i.a.createElement(Xa,{onKeyDown:ce,ref:o},i.a.createElement(_.EuiWindowEvent,{event:"resize",handler:me.noop}),i.a.createElement(ye.a,{show:Object(Pe.n)({globalFullScreen:j,graphEventId:c})},i.a.createElement(Ee.a,{id:"global",indexPattern:se})),i.a.createElement(d.a,{noPadding:j,"data-test-subj":"detectionsAlertsPage"},i.a.createElement($t,{show:!j},i.a.createElement(Mt,{title:mt},i.a.createElement(Ht.f,{onClick:Z,href:L(Object(ve.e)()),"data-test-subj":"manage-alert-detection-rules"},gt)),i.a.createElement(_.EuiHorizontalRule,{margin:"m"}),i.a.createElement(_.EuiFlexGroup,{alignItems:"center",justifyContent:"spaceBetween"},i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(Ge,{status:K,onFilterGroupChanged:ee})),i.a.createElement(_.EuiFlexItem,{grow:!1},u&&W.getLastUpdated({updatedAt:u||Date.now(),showUpdating:J}))),i.a.createElement(_.EuiSpacer,{size:"m"}),i.a.createElement(_.EuiFlexGroup,{wrap:!0},i.a.createElement(_.EuiFlexItem,{grow:1},i.a.createElement(Ja,{filters:te,query:k,signalIndexName:A})),i.a.createElement(_.EuiFlexItem,{grow:2},i.a.createElement(ut.a,{chartHeight:Ga.a,filters:te,query:k,showTotalAlertsCount:!1,titleSize:"s",signalIndexName:A,updateDateRange:X}))),i.a.createElement(_.EuiSpacer,{size:"l"})),i.a.createElement(it,{timelineId:h.q.detectionsPage,loading:Q,hasIndexWrite:null!=q&&q,hasIndexMaintenance:null!=D&&D,from:O,defaultFilters:ae,showBuildingBlockAlerts:B,onShowBuildingBlockAlertsChanged:ne,showOnlyThreatIndicatorAlerts:U,onShowOnlyThreatIndicatorAlertsChanged:ie,to:w,filterGroup:K}))):i.a.createElement(d.a,null,i.a.createElement(Mt,{border:!0,title:mt}),i.a.createElement(pt.a,null)):i.a.createElement(H,{actions:ue,message:Ot,"data-test-subj":"no_feature_permissions-alerts",title:wt})):i.a.createElement(d.a,null,i.a.createElement(Mt,{border:!0,title:mt}),i.a.createElement(Ct,{needsSignalsIndex:!1===re,needsListsIndex:N})):i.a.createElement(d.a,null,i.a.createElement(Mt,{border:!0,title:mt}),i.a.createElement(zt,null))},en=Object(b.connect)(null,(e=>({clearSelected:({id:t})=>e(y.a.clearSelected({id:t})),clearEventsLoading:({id:t})=>e(y.a.clearEventsLoading({id:t})),clearEventsDeleted:({id:t})=>e(y.a.clearEventsDeleted({id:t}))})))(i.a.memo(Za));var tn=a(316);const an=()=>i.a.createElement(r.TrackApplicationView,{viewId:o.Kb.alerts},i.a.createElement(en,null),i.a.createElement(u.a,{pageName:o.Kb.alerts})),nn=()=>{const{chrome:e}=Object(m.j)().services,{hasIndexRead:t,hasIndexWrite:a}=Object(tn.a)();return Object(n.useEffect)((()=>(!a&&t&&e.setBadge({text:de,tooltip:pe,iconType:"glasses"}),()=>{e.setBadge()})),[e,t,a]),i.a.createElement(l.Switch,null,i.a.createElement(l.Route,{path:o.c,exact:!0,component:an}),i.a.createElement(l.Route,{component:ue.a}))},rn=i.a.memo(nn),sn=[{path:o.W,render:({location:e})=>e.pathname===o.W?i.a.createElement(l.Redirect,{to:{...e,pathname:o.c}}):i.a.createElement(l.Redirect,{to:{...e,pathname:e.pathname.replace(o.W,"")}})},{path:o.c,render:()=>i.a.createElement(rn,null)}],on=[h.q.detectionsRulesDetailsPage,h.q.detectionsPage];const ln=L.a.a.withConfig({displayName:"InvisibleAnchor",componentId:"sc-bxvucm-0"})(["display:none;"]),cn=({blob:e,name:t,onDownload:a})=>{const r=Object(n.useRef)(null);return Object(n.useEffect)((()=>{if(e&&null!=r&&r.current){if("function"==typeof window.navigator.msSaveOrOpenBlob)window.navigator.msSaveBlob(e);else{const a=window.URL.createObjectURL(e);r.current.href=a,r.current.download=null!=t?t:"download.txt",r.current.click(),window.URL.revokeObjectURL(a)}a&&a()}}),[e,t,a]),i.a.createElement(ln,{ref:r})};var un=a(160);const dn=S.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.idTitle",{defaultMessage:"List ID"}),pn=S.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.listName",{defaultMessage:"Name"}),mn=S.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.numberRulesAssignedTitle",{defaultMessage:"Number of rules assigned to"}),fn=S.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.rulesAssignedTitle",{defaultMessage:"Rules assigned to"}),gn=S.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.dateCreatedTitle",{defaultMessage:"Date created"}),bn=S.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.dateUpdatedTitle",{defaultMessage:"Last edited"}),hn=S.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.errorFetching",{defaultMessage:"Error fetching exception lists"}),yn=S.i18n.translate("xpack.securitySolution.detectionEngine.rules.allExceptionLists.filters.noExceptionsTitle",{defaultMessage:"No exception lists found"}),vn=S.i18n.translate("xpack.securitySolution.detectionEngine.rules.allExceptionLists.search.placeholder",{defaultMessage:"Search exception lists"}),En=S.i18n.translate("xpack.securitySolution.detectionEngine.rules.allExceptions.tableTitle",{defaultMessage:"Exceptions"}),Tn=S.i18n.translate("xpack.securitySolution.detectionEngine.rules.allExceptions.tableTitleDescription",{defaultMessage:"Exceptions are automatically grouped into exception lists."}),kn=S.i18n.translate("xpack.securitySolution.detectionEngine.rules.allExceptions.filters.noListsBody",{defaultMessage:"We weren't able to find any exception lists."}),xn=(S.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.exportSuccess",{defaultMessage:"Exception list export success"}),S.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.exportError",{defaultMessage:"Exception list export error"})),Sn=S.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.deleteError",{defaultMessage:"Error occurred deleting exception list"}),wn=e=>S.i18n.translate("xpack.securitySolution.exceptions.referenceModalSuccessDescription",{defaultMessage:"Exception list - {listId} - deleted successfully.",values:{listId:e}}),On=S.i18n.translate("xpack.securitySolution.exceptions.referenceModalTitle",{defaultMessage:"Remove exception list"}),jn=S.i18n.translate("xpack.securitySolution.exceptions.referenceModalCancelButton",{defaultMessage:"Cancel"}),Cn=S.i18n.translate("xpack.securitySolution.exceptions.referenceModalDeleteButton",{defaultMessage:"Remove exception list"}),In=S.i18n.translate("xpack.securitySolution.exceptions.searchPlaceholder",{defaultMessage:"e.g. Example List Name"});var Mn=a(115);const An=i.a.memo((({canBulkEdit:e,isAllSelected:t,isAutoRefreshOn:a,numberSelectedItems:r,onGetBatchItemsPopoverContent:s,onRefresh:o,onRefreshSwitch:l,onToggleSelectAll:c,paginationTotal:u,showBulkActions:d=!0,hasPagination:p})=>{const m=Object(n.useCallback)((e=>null!=s?i.a.createElement(_.EuiContextMenuPanel,{items:s(e)}):null),[s]),f=Object(n.useCallback)((e=>t=>{null!=l&&(l(t.target.checked),e())}),[l]),g=Object(n.useCallback)((e=>i.a.createElement(_.EuiContextMenuPanel,{items:[i.a.createElement(_.EuiSwitch,{key:"allRulesAutoRefreshSwitch",label:Mn.tb,checked:null!=a&&a,onChange:f(e),compressed:!0,"data-test-subj":"refreshSettingsSwitch"})]})),[a,f]);return i.a.createElement(Ue.a,null,i.a.createElement(Ue.d,null,i.a.createElement(Ue.c,null,d?i.a.createElement(Ue.f,{dataTestSubj:"showingRules"},Mn.Fb(u)):i.a.createElement(Ue.f,{dataTestSubj:"showingExceptionLists"},Mn.Eb(u))),d?i.a.createElement(i.a.Fragment,null,i.a.createElement(Ue.c,{"data-test-subj":"tableBulkActions"},i.a.createElement(Ue.f,{dataTestSubj:"selectedRules"},Mn.Bb(r)),e&&c&&p&&i.a.createElement(Ue.b,{dataTestSubj:"selectAllRules",iconType:t?"cross":"pagesSelect",iconSide:"left",onClick:c},t?Mn.s:Mn.Cb(u)),e&&i.a.createElement(Ue.b,{dataTestSubj:"bulkActions",iconSide:"right",iconType:"arrowDown",popoverContent:m},Mn.h),i.a.createElement(Ue.b,{dataTestSubj:"refreshRulesAction",iconSide:"left",iconType:"refresh",onClick:o},Mn.pb),i.a.createElement(Ue.b,{dataTestSubj:"refreshSettings",iconSide:"right",iconType:"arrowDown",popoverContent:g},Mn.ub))):i.a.createElement(Ue.c,null,i.a.createElement(Ue.b,{dataTestSubj:"refreshRulesAction",iconSide:"left",iconType:"refresh",onClick:o},Mn.pb))))}));An.displayName="AllRulesUtilityBar";var qn=a(171);const Dn=L()(_.EuiBadgeGroup).withConfig({displayName:"ExceptionOverflowWrapper",componentId:"sc-1rraogh-0"})([".euiBadgeGroup__item{display:block;width:100%;}"]),Pn=L()(_.EuiBadgeGroup).withConfig({displayName:"ExceptionOverflowPopoverWrapper",componentId:"sc-1rraogh-1"})(["max-height:200px;max-width:600px;overflow:auto;"]),Rn=L()(_.EuiButton).withConfig({displayName:"ExceptionOverflowPopoverButton",componentId:"sc-1rraogh-2"})(["font-size:"," font-weight:500;height:20px;"],(({theme:e})=>e.eui.euiFontSizeXS)),Fn=({rules:e,navigateToUrl:t,formatUrl:a})=>{const[r,s]=Object(n.useState)(!1),o=({rule:{id:n,name:r},index:s})=>i.a.createElement(qn.h,{key:n},i.a.createElement(Ht.f,{key:n,"data-test-subj":"ruleName",onClick:e=>{e.preventDefault(),t(a(Object(ve.d)(n)))},href:a(Object(ve.d)(n))},r),s!==e.length-1?", ":"");return i.a.createElement(i.a.Fragment,null,e.length<=2?i.a.createElement(Dn,{"data-test-subj":"rules"},e.map(((e,t)=>i.a.createElement(o,{rule:e,index:t})))):i.a.createElement(Dn,{"data-test-subj":"rules"},e.slice(0,2).map(((e,t)=>i.a.createElement(o,{rule:e,index:t}))),i.a.createElement(_.EuiPopover,{ownFocus:!0,"data-test-subj":"rules-display-popover",button:i.a.createElement(Rn,{size:"s","data-test-subj":"rules-display-popover-button",onClick:()=>s(!r)},Mn.E),isOpen:r,closePopover:()=>s(!r),repositionOnScroll:!0},i.a.createElement(Pn,null,e.map(((e,t)=>i.a.createElement(o,{rule:e,index:t})))))))},_n=i.a.memo(Fn);_n.displayName="ExceptionOverflowDisplay";var Nn=a(152);var Ln=a(202);const Bn=L.a.div.withConfig({displayName:"MarkdownContainer",componentId:"sc-1c9tzb5-0"})(["max-height:200px;overflow-y:auto;&::-webkit-scrollbar{height:",";width:",";}&::-webkit-scrollbar-thumb{background-clip:content-box;background-color:",";border:"," solid transparent;}&::-webkit-scrollbar-corner,&::-webkit-scrollbar-track{background-color:transparent;}"],(({theme:e})=>e.eui.euiScrollBar),(({theme:e})=>e.eui.euiScrollBar),(({theme:e})=>Object(Ln.rgba)(e.eui.euiColorDarkShade,.5)),(({theme:e})=>e.eui.euiScrollBarCorner)),zn=({cancelText:e,confirmText:t,contentText:a,onClose:n,onCancel:r,onConfirm:s,references:o=[],showModal:l,titleText:c})=>l?i.a.createElement(_.EuiConfirmModal,{maxWidth:460,title:c,onCancel:r,onConfirm:s,cancelButtonText:e,confirmButtonText:t,buttonColor:"danger",defaultFocusedButton:"confirm","data-test-subj":"referenceErrorModal"},i.a.createElement("p",null,a),i.a.createElement(Bn,null,i.a.createElement(_.EuiListGroup,{gutterSize:"none",showToolTips:!0},o.map(((e,t)=>i.a.createElement(_.EuiListGroupItem,{key:`${t}-${e}`,label:e})))))):null;zn.displayName="ReferenceErrorModalComponent";const Hn=i.a.memo(zn);Hn.displayName="ReferenceErrorModal";const Un={strict:!0,fields:{created_by:{type:"string"},name:{type:"string"},type:{type:"string"},list_id:{type:"string"},tags:{type:"string"}}},$n=i.a.memo((({onSearch:e})=>i.a.createElement(_.EuiSearchBar,{"data-test-subj":"exceptionsHeaderSearch","aria-label":vn,onChange:e,box:{"data-test-subj":"exceptionsHeaderSearchInput",placeholder:In,incremental:!1,schema:Un}})));$n.displayName="ExceptionsSearchBar";const Qn=e=>e.reduce(((e,t)=>"error"in t?{rules:[...e.rules],errors:[...e.errors,t]}:{rules:[...e.rules,t],errors:[...e.errors]}),{rules:[],errors:[]}),Vn=e=>e.sort(((e,t)=>e.toLowerCase().localeCompare(t.toLowerCase()))),Wn=async e=>{const t=(await e.text()).split("\n").filter(Boolean).slice(-1)[0];return JSON.parse(t).exported_count};var Gn=a(212),Kn=a.n(Gn),Yn=a(61),Jn=a.n(Yn),Xn=a(241),Zn=a.n(Xn),ei=a(137),ti=a(175);const ai=({group:e,id:t,action_type_id:a,params:n})=>({group:e,id:t,params:n,actionTypeId:a}),ni=({group:e,id:t,actionTypeId:a,params:n})=>({group:e,id:t,params:n,action_type_id:a});var ii=a(69);const ri=S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.advancedSettingsButton",{defaultMessage:"Advanced settings"}),si=S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.addReferenceDescription",{defaultMessage:"Add reference URL"}),oi=S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.addFalsePositiveDescription",{defaultMessage:"Add false positive example"}),li=S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.endpointExceptionListLabel",{defaultMessage:"Elastic Endpoint exceptions"}),ci=S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.buildingBlockLabel",{defaultMessage:"Building block"}),ui=S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.severityOptionLowDescription",{defaultMessage:"Low"}),di=S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.severityOptionMediumDescription",{defaultMessage:"Medium"}),pi=S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.severityOptionHighDescription",{defaultMessage:"High"}),mi=S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.severityOptionCriticalDescription",{defaultMessage:"Critical"}),fi=S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.referencesUrlInvalidError",{defaultMessage:"URL is invalid format"}),gi=S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutrule.noteHelpText",{defaultMessage:"Add rule investigation guide..."}),bi=L()(_.EuiHealth).withConfig({displayName:"StyledEuiHealth",componentId:"sc-1mv5h4i-0"})(["line-height:inherit;"]),hi=[{value:"low",inputDisplay:i.a.createElement(bi,{color:ii.euiLightVars.euiColorVis0},ui)},{value:"medium",inputDisplay:i.a.createElement(bi,{color:ii.euiLightVars.euiColorVis5},di)},{value:"high",inputDisplay:i.a.createElement(bi,{color:ii.euiLightVars.euiColorVis7},pi)},{value:"critical",inputDisplay:i.a.createElement(bi,{color:ii.euiLightVars.euiColorVis9},mi)}],yi={low:21,medium:47,high:73,critical:99},vi=({rule:e,detailsView:t=!1})=>{const a=Ti(e);return{aboutRuleData:Si(e,t),modifiedAboutRuleDetailsData:Ci(e),defineRuleData:a,scheduleRuleData:ki(e),ruleActionsData:Ei(e)}},Ei=e=>{const{enabled:t,throttle:a,meta:n,actions:i=[]}=e;return{actions:null==i?void 0:i.map(ai),throttle:a,kibanaSiemAppUrl:null==n?void 0:n.kibana_siem_app_url,enabled:t}},Ti=e=>{var t,a,n,i,r,s,o,l,c,u,d,p,m,f,g,b,h;return{ruleType:e.type,anomalyThreshold:null!==(t=e.anomaly_threshold)&&void 0!==t?t:50,machineLearningJobId:null!==(a=e.machine_learning_job_id)&&void 0!==a?a:[],index:null!==(n=e.index)&&void 0!==n?n:[],threatIndex:null!==(i=e.threat_index)&&void 0!==i?i:[],threatQueryBar:{query:{query:null!==(r=e.threat_query)&&void 0!==r?r:"",language:null!==(s=e.threat_language)&&void 0!==s?s:""},filters:null!==(o=e.threat_filters)&&void 0!==o?o:[],saved_id:void 0},threatMapping:null!==(l=e.threat_mapping)&&void 0!==l?l:[],queryBar:{query:{query:null!==(c=e.query)&&void 0!==c?c:"",language:null!==(u=e.language)&&void 0!==u?u:""},filters:null!==(d=e.filters)&&void 0!==d?d:[],saved_id:e.saved_id},timeline:{id:null!==(p=e.timeline_id)&&void 0!==p?p:null,title:null!==(m=e.timeline_title)&&void 0!==m?m:null},threshold:{field:Object(ti.g)(null===(f=e.threshold)||void 0===f?void 0:f.field),value:`${(null===(g=e.threshold)||void 0===g?void 0:g.value)||100}`,...null!==(b=e.threshold)&&void 0!==b&&null!==(h=b.cardinality)&&void 0!==h&&h.length?{cardinality:{field:[`${e.threshold.cardinality[0].field}`],value:`${e.threshold.cardinality[0].value}`}}:{}}}},ki=e=>{const{interval:t,from:a}=e;return{interval:t,from:xi(a,t)}},xi=(e,t)=>{var a,n;const i=null!==(a=Kn.a.parse(e))&&void 0!==a?a:Jn()(),r=null!==(n=Kn.a.parse(`now-${t}`))&&void 0!==n?n:Jn()(),s=Jn.a.duration(r.diff(i)),o=Math.floor(s.asSeconds());return 0===o?"0s":o%3600==0?o/3600+"h":o%60==0?o/60+"m":`${o}s`},Si=(e,t)=>{var a;const{name:n,description:i,note:r}=ji(e,t),{author:s,building_block_type:o,exceptions_list:l,license:c,risk_score_mapping:u,rule_name_override:d,severity_mapping:p,timestamp_override:m,references:f,severity:g,false_positives:b,risk_score:h,tags:y,threat:v,threat_indicator_path:E}=e;return{author:s,isAssociatedToEndpointList:null!==(a=null==l?void 0:l.some((({id:e})=>e===ei.g)))&&void 0!==a&&a,isBuildingBlock:void 0!==o,license:null!=c?c:"",ruleNameOverride:null!=d?d:"",timestampOverride:null!=m?m:"",name:n,description:i,note:r,references:f,severity:{value:g,mapping:Oi(p),isMappingChecked:p.length>0},tags:y,riskScore:{value:h,mapping:u,isMappingChecked:u.length>0},falsePositives:b,threat:v,threatIndicatorPath:E}},wi={low:0,medium:1,high:2,critical:3},Oi=e=>{const t=hi.flatMap((t=>null==e.find((e=>e.severity===t.value))?[{field:"",value:"",operator:"equals",severity:t.value}]:[]));return[...e,...t].sort(((e,t)=>wi[e.severity]-wi[t.severity]))},ji=(e,t)=>{const{name:a,description:n,note:i}=e;return t?{name:"",description:"",note:""}:{name:a,description:n,note:null!=i?i:""}},Ci=e=>{var t;return{note:null!==(t=e.note)&&void 0!==t?t:"",description:e.description}},Ii=(e,t,a)=>null!=t&&0===e&&t>0&&0===a?"ruleNotInstalled":null!=e&&e>0&&0===t&&0===a?"ruleInstalled":null!=e&&null!=t&&e>0&&t>0&&0===a?"someRuleUninstall":null!=e&&null!=t&&null!=a&&e>0&&t>=0&&a>0?"ruleNeedUpdate":"unknown",Mi=(e,t,a)=>null!=t&&0===e&&t>0&&0===a?"timelinesNotInstalled":null!=e&&e>0&&0===t&&0===a?"timelinesInstalled":null!=e&&null!=t&&e>0&&t>0&&0===a?"someTimelineUninstall":null!=e&&null!=t&&null!=a&&e>0&&t>=0&&a>0?"timelineNeedUpdate":"unknown",Ai=(e,t,a,n)=>!1===e||!1===t||!1===a||n,qi=e=>{const t=["index","filters","language","query","saved_id"];switch(e){case"machine_learning":return["anomaly_threshold","machine_learning_job_id"];case"threshold":return["threshold",...t];case"threat_match":case"query":case"saved_query":case"eql":return t}Object(Qt.a)(e)},Di=Zn()((e=>{if(!e)return{state:[],params:[]};const t=(e=>["id","name","description","false_positives","rule_id","max_signals","risk_score","output_index","references","severity","timeline_id","timeline_title","threat","type","version",...qi(e)].sort())(e);return{state:[{name:"signals_count",description:"state.signals_count"}],params:[],context:[{name:"results_link",description:"context.results_link",useWithTripleBracesInTemplates:!0},{name:"alerts",description:"context.alerts"},...t.map((e=>{const t=`rule.${e}`;return{name:t,description:`context.${t}`}}))]}})),Pi=e=>null==e||e,Ri=L()(_.EuiFlexItem).withConfig({displayName:"MaxWidthEuiFlexItem",componentId:"sc-97v502-0"})(["max-width:1000px;overflow:hidden;"]),Fi={contentText:"",rulesReferences:[],isLoading:!1,listId:"",listNamespaceType:"single"},_i=i.a.memo((()=>{var e;const{formatUrl:t}=Object(f.n)(o.Kb.rules),[{loading:a,canUserCRUD:r}]=Object(dt.b)(),s=Pi(r),{loading:l}=Bt(),c=a||l,{services:{http:u,notifications:d,timelines:p,application:g}}=Object(m.j)(),{exportExceptionList:b,deleteExceptionList:h}=Object(qt.c)(u),[y,v]=Object(n.useState)(!1),[E,T]=Object(n.useState)(Fi),[k,x]=Object(n.useState)(void 0),[w,O,j,C,I]=Object(qt.h)({errorMessage:hn,filterOptions:k,http:u,namespaceTypes:["single","agnostic"],notifications:d,showTrustedApps:!1,showEventFilters:!1,showHostIsolationExceptions:!1}),[M,A,q]=(({exceptionLists:e})=>{const[t,a]=Object(n.useState)(!0),[i,r]=Object(n.useState)([]),[s,o]=Object(n.useState)({}),l=Object(n.useCallback)((t=>{const a=e.reduce(((e,{id:t,...a})=>(e[t]={...a,id:t,rules:[]},e)),{});return t.reduce(((e,t)=>{const a=t.exceptions_list;return null!=a&&a.length>0&&a.forEach((a=>{const n=e[a.id];null!=n&&(e[a.id]={...n,rules:[...n.rules,t]})})),e}),a)}),[e]);return Object(n.useEffect)((()=>{let t=!0;const n=new AbortController;return(async()=>{if(0===e.length&&t)return a(!1),r([]),void o({});try{a(!0);const{data:e}=await Object(Nn.h)({pagination:{page:1,perPage:1e4,total:0},signal:n.signal}),i=l(e),s=Object.keys(i).map((e=>i[e]));r(s),o(i),t&&a(!1)}catch(e){t&&a(!1)}})(),()=>{t=!1,n.abort()}}),[e.length,l]),[t,i,s]})({exceptionLists:null!=O?O:[]}),[D,P]=Object(n.useState)(!0),[R,F]=Object(n.useState)(Date.now()),[N,L]=Object(n.useState)([]),[B,z]=Object(n.useState)([]),[H,U]=Object(n.useState)({}),{navigateToUrl:$}=g,{addError:Q}=Object(Oe.a)(),V=Object(n.useCallback)((e=>()=>{d.toasts.addSuccess({title:wn(null!=e?e:E.listId)})}),[d.toasts,E.listId]),W=Object(n.useCallback)((e=>{Q(e,{title:Sn})}),[Q]),G=Object(n.useCallback)((({id:e,listId:t,namespaceType:a})=>async()=>{try{L((t=>[...t,e])),null!=I&&I(),null!=q[e]&&0===q[e].rules.length?(await h({id:e,namespaceType:a,onError:W,onSuccess:V(t)}),null!=I&&I()):(T({contentText:(n=q[e].rules.length,S.i18n.translate("xpack.securitySolution.exceptions.referenceModalDescription",{defaultMessage:"This exception list is associated with ({referenceCount}) {referenceCount, plural, =1 {rule} other {rules}}. Removing this exception list will also remove its reference from the associated rules.",values:{referenceCount:n}})),rulesReferences:q[e].rules.map((({name:e})=>e)),isLoading:!0,listId:e,listNamespaceType:a}),v(!0))}catch(e){W(e)}finally{L((t=>t.filter((t=>t!==e))))}var n}),[h,q,W,V,I]),K=Object(n.useCallback)((e=>t=>{U({name:e,blob:t})}),[]),Y=Object(n.useCallback)((e=>{Q(e,{title:xn})}),[Q]),J=Object(n.useCallback)((({id:e,listId:t,namespaceType:a})=>async()=>{z((t=>[...t,e])),await b({id:e,listId:t,namespaceType:a,onError:Y,onSuccess:K(t)})}),[b,Y,K]),X=Object(n.useMemo)((()=>((e,t,a,n)=>[{align:"left",field:"list_id",name:dn,truncateText:!0,dataType:"string",width:"15%",render:e=>i.a.createElement(_.EuiToolTip,{position:"left",content:e},i.a.createElement("p",{"data-test-subj":"exceptionsTableListId"},e))},{align:"left",field:"name",name:pn,truncateText:!0,dataType:"string",width:"10%",render:e=>i.a.createElement(_.EuiToolTip,{position:"left",content:e},i.a.createElement("p",{"data-test-subj":"exceptionsTableName"},e))},{align:"center",field:"rules",name:mn,truncateText:!0,dataType:"number",width:"10%",render:e=>i.a.createElement("p",null,e.length)},{align:"left",field:"rules",name:fn,truncateText:!0,dataType:"string",width:"20%",render:e=>i.a.createElement(_n,{rules:e,navigateToUrl:n,formatUrl:a})},{align:"left",field:"created_at",name:gn,truncateText:!0,dataType:"date",width:"14%"},{align:"left",field:"updated_at",name:bn,truncateText:!0,width:"14%"},{align:"center",isExpander:!1,width:"25px",render:({id:t,list_id:a,namespace_type:n})=>i.a.createElement(_.EuiButtonIcon,{onClick:e({id:t,listId:a,namespaceType:n}),"aria-label":"Export exception list",iconType:"exportAction","data-test-subj":"exceptionsTableExportButton"})},{align:"center",width:"25px",isExpander:!1,render:({id:e,list_id:a,namespace_type:n})=>i.a.createElement(_.EuiButtonIcon,{color:"danger",onClick:t({id:e,listId:a,namespaceType:n}),"aria-label":"Delete exception list",iconType:"trash",isDisabled:"endpoint_list"===a,"data-test-subj":"exceptionsTableDeleteButton"})}])(J,G,t,$)),[J,G,t,$]),Z=Object(n.useCallback)((()=>{null!=I&&(F(Date.now()),I())}),[I]);Object(n.useEffect)((()=>{!D||c||w||M||P(!1)}),[D,c,w,M]);const ee=Object(n.useMemo)((()=>i.a.createElement(_.EuiEmptyPrompt,{title:i.a.createElement("h3",null,yn),titleSize:"xs",body:kn})),[]),te=Object(n.useCallback)((async({query:e,queryText:t})=>{const a=(({query:e,searchValue:t,filterOptions:a,defaultSearchTerm:n})=>{const i=null==e?void 0:e.ast.getFieldClauses();if(null!=i&&i.length>0)return i.reduce(((e,{field:t,value:a})=>(e[t]=`${a}`,e)),a);return{[n]:t}})({defaultSearchTerm:"name",filterOptions:{name:null,list_id:null,created_by:null,type:null,tags:null},query:e,searchValue:t});x(a)}),[]),ae=Object(n.useCallback)((()=>{L([]),v(!1),T({contentText:"",rulesReferences:[],isLoading:!1,listId:"",listNamespaceType:"single"})}),[]),ne=Object(n.useCallback)((async()=>{const e=E.listId,t=E.listNamespaceType,a=q[e].rules;try{await Promise.all(a.map((t=>{var a;const n=new AbortController,i=(null!==(a=t.exceptions_list)&&void 0!==a?a:[]).filter((({id:t})=>t!==e));return Object(Nn.n)({ruleProperties:{rule_id:t.rule_id,exceptions_list:i},signal:n.signal})}))),await h({id:e,namespaceType:t,onError:W,onSuccess:V()})}catch(e){W(e)}finally{T(Fi),L([]),v(!1),null!=I&&I()}}),[E.listId,E.listNamespaceType,q,h,W,V,I]),ie=Object(n.useMemo)((()=>({pageIndex:j.page-1,pageSize:j.perPage,totalItemCount:j.total||0,pageSizeOptions:[5,10,20,50,100,200,300]})),[j]),re=Object(n.useCallback)((()=>{U({})}),[]),se=Object(n.useMemo)((()=>(null!=A?A:[]).map((e=>({...e,isDeleting:N.includes(e.id),isExporting:B.includes(e.id)})))),[N,A,B]),oe=Object(n.useCallback)((e=>{const{index:t,size:a}=e.page;C((e=>({...e,perPage:a,page:t+1})))}),[C]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(Mt,{title:En,border:!0,subtitle:Tn,subtitle2:p.getLastUpdated({showUpdating:c,updatedAt:R})}),i.a.createElement("div",{"data-test-subj":"allExceptionListsPanel"},M&&i.a.createElement(_.EuiProgress,{"data-test-subj":"loadingRulesInfoProgress",size:"xs",position:"absolute",color:"accent"}),!D&&i.a.createElement($n,{onSearch:te}),i.a.createElement(_.EuiSpacer,{size:"m"}),M&&!D&&!y&&i.a.createElement(un.a,{"data-test-subj":"loadingPanelAllRulesTable",overlay:!0,size:"xl"}),D?i.a.createElement(_.EuiLoadingContent,{"data-test-subj":"initialLoadingPanelAllRulesTable",lines:10}):i.a.createElement(i.a.Fragment,null,i.a.createElement(An,{showBulkActions:!1,canBulkEdit:s,paginationTotal:null!==(e=A.length)&&void 0!==e?e:0,numberSelectedItems:0,onRefresh:Z}),i.a.createElement(_.EuiBasicTable,{"data-test-subj":"exceptions-table",columns:X,isSelectable:s,itemId:"id",items:se,noItemsMessage:ee,onChange:oe,pagination:ie})),i.a.createElement(cn,{blob:H.blob,name:`${H.name}.ndjson`,onDownload:re}),i.a.createElement(Hn,{cancelText:jn,confirmText:Cn,contentText:E.contentText,onCancel:ae,onClose:ae,onConfirm:ne,references:E.rulesReferences,showModal:y,titleText:On})))}));_i.displayName="ExceptionListsTable";const Ni=()=>i.a.createElement(r.TrackApplicationView,{viewId:o.Kb.exceptions},i.a.createElement(_i,null),i.a.createElement(u.a,{pageName:o.Kb.exceptions})),Li=[{path:o.nb,render:()=>i.a.createElement(l.Switch,null,i.a.createElement(l.Route,{path:o.nb,exact:!0,component:Ni}),i.a.createElement(l.Route,{component:ue.a}))}];var Bi=a(12),zi=a(312),Hi=a(663),Ui=a(664),$i=a(222),Qi=a(173),Vi=a(223),Wi=a(210),Gi=a(95),Ki=a.n(Gi),Yi=a(244),Ji=a(188),Xi=a(773),Zi=a(33);const er=({disabled:e,hrefWithSearch:t,id:a,name:r,isSelected:s})=>{const{getAppUrl:o,navigateTo:l}=Object(m.k)(),c=Object(n.useCallback)((e=>{e.preventDefault(),l({path:t}),Object(Zi.e)(Zi.a.CLICK,`${Zi.b.TAB_CLICKED}${a}`)}),[l,t,a]),u=o({path:t});return i.a.createElement(_.EuiTab,{"data-href":u,"data-test-subj":`navigation-${a}`,disabled:e,isSelected:s,href:u,onClick:c},r)},tr=i.a.memo(er),ar=({display:e,navTabs:t,tabName:a})=>{const r=Object(n.useCallback)((()=>Object(me.getOr)("","id",Object.values(t).find((e=>a===e.id)))),[a,t]),[s,o]=Object(n.useState)(r());Object(n.useEffect)((()=>{const e=r();e!==s&&o(e)}),[a,t,r,s]);const{search:c}=Object(l.useLocation)(),u=Object(n.useMemo)((()=>Object.values(t).map((e=>{const t=s===e.id;return i.a.createElement(tr,{key:`navigation-${e.id}`,id:e.id,hrefWithSearch:e.href+c,name:e.name,disabled:e.disabled,isSelected:t})}))),[t,s,c]);return i.a.createElement(_.EuiTabs,{display:e},u)};ar.displayName="TabNavigationComponent";const nr=i.a.memo(ar,((e,t)=>e.display===t.display&&e.tabName===t.tabName&&Ki()(e.navTabs,t.navTabs)));nr.displayName="TabNavigation";const ir=i.a.memo((({detailName:e,display:t,flowTarget:a,navTabs:r,pageName:s,pathName:o,search:l,state:c,tabName:u,urlState:d})=>{const{chrome:p,application:{getUrlForApp:f,navigateToUrl:g}}=Object(m.j)().services,b=Object(Xi.a)();return Object(n.useEffect)((()=>{(o||s)&&b({detailName:e,filters:d.filters,flowTarget:a,navTabs:r,pageName:s,pathName:o,query:d.query,savedQuery:d.savedQuery,search:l,sourcerer:d.sourcerer,state:c,tabName:u,timeline:d.timeline,timerange:d.timerange},p,f,g)}),[p,s,o,l,r,d,c,e,a,u,f,g,b]),i.a.createElement(nr,{query:d.query,display:t,filters:d.filters,navTabs:r,pageName:s,pathName:o,sourcerer:d.sourcerer,savedQuery:d.savedQuery,tabName:u,timeline:d.timeline,timerange:d.timerange})}));ir.displayName="TabNavigationComponent";const rr=Object(Wi.compose)(Object(b.connect)(Ji.i))(i.a.memo(ir,((e,t)=>e.pathName===t.pathName&&e.search===t.search&&Ki()(e.navTabs,t.navTabs)&&Ki()(e.urlState,t.urlState)&&Ki()(e.state,t.state)))),sr=i.a.memo((e=>{const[t]=Object(Yi.a)(),a={...t,...e};return i.a.createElement(rr,a)}),((e,t)=>Ki()(e.navTabs,t.navTabs)));sr.displayName="SecuritySolutionTabNavigation";var or=a(15),lr=a(155),cr=a(114);const ur=S.i18n.translate("xpack.securitySolution.hostsKpiAuthentications.errorSearchDescription",{defaultMessage:"An error has occurred on hosts kpi authentications search"}),dr=S.i18n.translate("xpack.securitySolution.hostsKpiAuthentications.failSearchDescription",{defaultMessage:"Failed to run search on hosts kpi authentications"});var pr=a(23);var mr=a(122),fr=a(66),gr=a(264),br=a(616),hr=a(372);const yr=e=>!!Object(me.get)("value.length",e)&&Object(me.get)("value",e).every((({x:e,y:t})=>!Object(me.isNull)(e)&&Object(me.isNumber)(t)&&t>0)),vr={tickLine:{visible:!1},tickLabel:{padding:3}},Er=({data:e,...t})=>{const a=Object(hr.f)(),n=Object(m.l)(),r=Object(me.get)("configs.axis.xTickFormatter",t),s=Object(me.get)("configs.axis.yTickFormatter",t),o=`group-${e[0].key}-x`,l=`group-${e[0].key}-y`,c={...hr.b,theme:a,...Object(me.get)("configs.settings",t)};return t.width&&t.height?i.a.createElement("div",{style:{height:t.height,width:t.width,position:"relative"}},i.a.createElement(fr.Chart,null,i.a.createElement(fr.Settings,c),e.map((e=>{const a=e.key;return yr(e)?i.a.createElement(fr.AreaSeries,{id:a,key:a,name:e.key.replace("Histogram",""),data:e.value||[],xScaleType:Object(me.getOr)(fr.ScaleType.Linear,"configs.series.xScaleType",t),yScaleType:Object(me.getOr)(fr.ScaleType.Linear,"configs.series.yScaleType",t),timeZone:n,xAccessor:"x",yAccessors:["y"],areaSeriesStyle:{area:{opacity:.04,visible:!0},line:{strokeWidth:1,visible:!0},point:{visible:!1,radius:.2,strokeWidth:1,opacity:1}},color:e.color?e.color:void 0}):null})),i.a.createElement(fr.Axis,{id:o,position:fr.Position.Bottom,showOverlappingTicks:!1,tickFormat:r,style:vr}),i.a.createElement(fr.Axis,{id:l,position:fr.Position.Left,style:vr,tickFormat:s}))):null};Er.displayName="AreaChartBaseComponent";const Tr=i.a.memo(Er);Tr.displayName="AreaChartBase";const kr=({areaChart:e,configs:t})=>{const{ref:a,width:n,height:r}=Object(gr.b)(),s=Object(me.get)("customHeight",t),o=Object(me.get)("customWidth",t),l=Object(hr.d)(s,r),c=Object(hr.e)(o,n);return u=e,Array.isArray(u)&&u.some(yr)?i.a.createElement(hr.a,{ref:a,height:l},i.a.createElement(Tr,{data:e,height:l,width:c,configs:t})):i.a.createElement(br.a,{height:l,width:c,data:e});var u},xr=i.a.memo(kr);var Sr=a(448),wr=a(100);const Or=L()(_.EuiFlexItem).withConfig({displayName:"FlexItem",componentId:"sc-1rm4ik7-0"})(["min-width:0;"]);Or.displayName="FlexItem";const jr=L()(_.EuiTitle).withConfig({displayName:"StatValue",componentId:"sc-1rm4ik7-1"})(["overflow:hidden;text-overflow:ellipsis;white-space:nowrap;"]);jr.displayName="StatValue";const Cr=e=>e.toLocaleString(),Ir=e=>({series:{xScaleType:fr.ScaleType.Time,yScaleType:fr.ScaleType.Linear},axis:{xTickFormatter:Object(me.get)("xTickFormatter",e),yTickFormatter:Cr},settings:{onBrushEnd:Object(me.getOr)((()=>{}),"onBrushEnd",e)},customHeight:74}),Mr=(e,t)=>e.map((e=>({...e,value:Object(me.get)(e.key,t)}))),Ar=(e,t)=>e.filter((e=>null!=Object(me.get)(`${e.key}Histogram`,t))).map((e=>({...e,value:Object(me.get)(`${e.key}Histogram`,t),key:`${e.key}Histogram`}))),qr=(e,t)=>0===e.length?[]:e.reduce(((a,n,i)=>{const{key:r,color:s}=n,o=Object(me.getOr)(null,r,t);return[...a,{key:r,color:s,value:[{x:Object(me.get)(`${i}.name`,e)||Object(me.getOr)("",`${i}.description`,e),y:o,g:r,y0:0}]}]}),[]),Dr=(e,t,a,i,r,s)=>{const[o,l]=Object(n.useState)(e);return Object(n.useEffect)((()=>{l(e.map((e=>({...e,areaChart:e.enableAreaChart?Ar(e.fields,t):void 0,barChart:e.enableBarChart?qr(e.fields,t):void 0,fields:Mr(e.fields,t),id:a,key:`kpi-summary-${e.key}`,statKey:`${e.key}`,from:i,to:r,narrowDateRange:s}))))}),[t]),o},Pr=i.a.memo((({areaChart:e,barChart:t,description:a,enableAreaChart:n,enableBarChart:r,fields:s,from:o,grow:l,id:c,index:u,narrowDateRange:d,statKey:p="item",to:m})=>{const f=t&&t.length&&t.every((e=>null!=e.value&&e.value.length>0)),g=e&&e.length&&e.every((e=>null!=e.value&&e.value.length>0));return i.a.createElement(Or,{grow:l,"data-test-subj":`stat-${p}`},i.a.createElement(za.b,null,i.a.createElement(_.EuiPanel,{hasBorder:!0},i.a.createElement(_.EuiFlexGroup,{gutterSize:"none"},i.a.createElement(_.EuiFlexItem,null,i.a.createElement(_.EuiTitle,{size:"xxxs"},i.a.createElement("h6",null,a))),i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(za.a,{queryId:c,title:`KPI ${a}`,inspectIndex:u}))),i.a.createElement(_.EuiFlexGroup,null,s.map((e=>i.a.createElement(Or,{key:`stat-items-field-${e.key}`},i.a.createElement(_.EuiFlexGroup,{alignItems:"center",gutterSize:"m",responsive:!1},(g||f)&&e.icon&&i.a.createElement(Or,{grow:!1},i.a.createElement(_.EuiIcon,{type:e.icon,color:e.color,size:"l","data-test-subj":"stat-icon"})),i.a.createElement(Or,null,i.a.createElement(jr,null,i.a.createElement("p",{"data-test-subj":"stat-title"},null!=e.value?e.value.toLocaleString():Object(wr.d)()," ",e.description)))))))),(n||r)&&i.a.createElement(_.EuiHorizontalRule,null),i.a.createElement(_.EuiFlexGroup,null,r&&i.a.createElement(Or,null,i.a.createElement(Sr.a,{barChart:t,configs:{series:{xScaleType:fr.ScaleType.Ordinal,yScaleType:fr.ScaleType.Linear,stackAccessors:["y0"]},axis:{xTickFormatter:Cr},settings:{onElementClick:Object(me.getOr)((()=>{}),"onElementClick",b),rotation:90},customHeight:74}})),n&&null!=o&&null!=m&&i.a.createElement(Or,null,i.a.createElement(xr,{areaChart:e,configs:Ir({xTickFormatter:Object(gr.a)([o,m]),onBrushEnd:d})}))))));var b}),((e,t)=>e.description===t.description&&e.enableAreaChart===t.enableAreaChart&&e.enableBarChart===t.enableBarChart&&e.from===t.from&&e.grow===t.grow&&e.id===t.id&&e.index===t.index&&e.narrowDateRange===t.narrowDateRange&&e.statKey===t.statKey&&e.to===t.to&&Ki()(e.areaChart,t.areaChart)&&Ki()(e.barChart,t.barChart)&&Ki()(e.fields,t.fields)));Pr.displayName="StatItemsComponent";const Rr=L()(_.EuiFlexGroup).withConfig({displayName:"FlexGroup",componentId:"sc-17i7jd7-0"})(["min-height:","px;"],247);Rr.displayName="FlexGroup";const Fr=i.a.memo((({fieldsMapping:e,data:t,id:a,loading:n=!1,from:r,to:s,narrowDateRange:o})=>{const l=Dr(e,t,a,r,s,o);return n?i.a.createElement(Rr,{justifyContent:"center",alignItems:"center"},i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(_.EuiLoadingSpinner,{size:"xl"}))):i.a.createElement(_.EuiFlexGroup,{wrap:!0},l.map((e=>i.a.createElement(Pr,e))))}),((e,t)=>e.fieldsMapping===t.fieldsMapping&&e.id===t.id&&e.loading===t.loading&&e.from===t.from&&e.to===t.to&&e.narrowDateRange===t.narrowDateRange&&Ki()(e.data,t.data)));Fr.displayName="HostsKpiBaseComponent";const _r=Object(mr.a)(Fr);var Nr=a(374);const Lr=S.i18n.translate("xpack.securitySolution.kpiHosts.userAuthentications.title",{defaultMessage:"User authentications"}),Br=S.i18n.translate("xpack.securitySolution.kpiHosts.userAuthentications.successUnitLabel",{defaultMessage:"success"}),zr=S.i18n.translate("xpack.securitySolution.kpiHosts.userAuthentications.failUnitLabel",{defaultMessage:"fail"}),Hr=S.i18n.translate("xpack.securitySolution.kpiHosts.userAuthentications.successChartLabel",{defaultMessage:"Succ."}),Ur=S.i18n.translate("xpack.securitySolution.kpiHosts.userAuthentications.failChartLabel",{defaultMessage:"Fail"}),$r=[{key:"authentication",fields:[{key:"authenticationsSuccess",name:Hr,description:Br,value:null,color:Nr.a.authenticationsSuccess,icon:"check"},{key:"authenticationsFailure",name:Ur,description:zr,value:null,color:Nr.a.authenticationsFailure,icon:"cross"}],enableAreaChart:!0,enableBarChart:!0,description:Lr}],Qr=({filterQuery:e,from:t,indexNames:a,to:r,narrowDateRange:s,setQuery:o,skip:l})=>{const[c,{refetch:u,id:d,inspect:p,...f}]=(({filterQuery:e,endDate:t,indexNames:a,skip:i=!1,startDate:r})=>{const{data:s}=Object(m.j)().services,o=Object(n.useRef)(me.noop),l=Object(n.useRef)(new AbortController),c=Object(n.useRef)(new or.Subscription),[u,d]=Object(n.useState)(!1),[p,f]=Object(n.useState)(null),{getTransformChangesIfTheyExist:g}=Object(lr.a)(),[b,h]=Object(n.useState)({authenticationsSuccess:0,authenticationsSuccessHistogram:[],authenticationsFailure:0,authenticationsFailureHistogram:[],id:"hostsKpiAuthenticationsQuery",inspect:{dsl:[],response:[]},isInspected:!1,refetch:o.current}),{addError:y,addWarning:v}=Object(Oe.a)(),E=Object(n.useCallback)((e=>{if(null==e||i)return;const t=async()=>{l.current=new AbortController,d(!0),c.current=s.search.search(e,{strategy:"securitySolutionSearchStrategy",abortSignal:l.current.signal}).subscribe({next:e=>{e.isPartial||e.isRunning?e.isPartial&&!e.isRunning&&(d(!1),v(ur),c.current.unsubscribe()):(d(!1),h((t=>({...t,authenticationsSuccess:e.authenticationsSuccess,authenticationsSuccessHistogram:e.authenticationsSuccessHistogram,authenticationsFailure:e.authenticationsFailure,authenticationsFailureHistogram:e.authenticationsFailureHistogram,inspect:Object(pr.b)(e,t.inspect),refetch:o.current}))),c.current.unsubscribe())},error:e=>{d(!1),y(e,{title:dr}),c.current.unsubscribe()}})};c.current.unsubscribe(),l.current.abort(),t(),o.current=t}),[s.search,y,v,i]);return Object(n.useEffect)((()=>{const{indices:n,factoryQueryType:i,timerange:s}=g({factoryQueryType:Bi.l.kpiAuthentications,indices:a,filterQuery:e,timerange:{interval:"12h",from:r,to:t}});f((t=>{const a={...null!=t?t:{},defaultIndex:n,factoryQueryType:i,filterQuery:Object(cr.a)(e),timerange:s};return Ki()(t,a)?t:a}))}),[a,t,e,r,g]),Object(n.useEffect)((()=>(E(p),()=>{c.current.unsubscribe(),l.current.abort()})),[p,E]),[u,b]})({filterQuery:e,endDate:r,indexNames:a,startDate:t,skip:l});return i.a.createElement(_r,{data:f,id:d,inspect:p,loading:c,fieldsMapping:$r,from:t,to:r,narrowDateRange:s,refetch:u,setQuery:o})};Qr.displayName="HostsKpiAuthenticationsComponent";const Vr=i.a.memo(Qr),Wr=S.i18n.translate("xpack.securitySolution.hostsKpiHosts.errorSearchDescription",{defaultMessage:"An error has occurred on hosts kpi hosts search"}),Gr=S.i18n.translate("xpack.securitySolution.hostsKpiHosts.failSearchDescription",{defaultMessage:"Failed to run search on hosts kpi hosts"}),Kr=S.i18n.translate("xpack.securitySolution.kpiHosts.hosts.title",{defaultMessage:"Hosts"}),Yr=[{key:"hosts",fields:[{key:"hosts",value:null,color:Nr.a.hosts,icon:"storage"}],enableAreaChart:!0,description:Kr}],Jr=({filterQuery:e,from:t,indexNames:a,to:r,narrowDateRange:s,setQuery:o,skip:l})=>{const[c,{refetch:u,id:d,inspect:p,...f}]=(({filterQuery:e,endDate:t,indexNames:a,skip:i=!1,startDate:r})=>{const{data:s}=Object(m.j)().services,o=Object(n.useRef)(me.noop),l=Object(n.useRef)(new AbortController),c=Object(n.useRef)(new or.Subscription),[u,d]=Object(n.useState)(!1),[p,f]=Object(n.useState)(null),{getTransformChangesIfTheyExist:g}=Object(lr.a)(),[b,h]=Object(n.useState)({hosts:0,hostsHistogram:[],id:"hostsKpiHostsQuery",inspect:{dsl:[],response:[]},isInspected:!1,refetch:o.current}),{addError:y,addWarning:v}=Object(Oe.a)(),E=Object(n.useCallback)((e=>{if(null==e||i)return;const t=async()=>{l.current=new AbortController,d(!0),c.current=s.search.search(e,{strategy:"securitySolutionSearchStrategy",abortSignal:l.current.signal}).subscribe({next:e=>{e.isPartial||e.isRunning?e.isPartial&&!e.isRunning&&(d(!1),v(Wr),c.current.unsubscribe()):(d(!1),h((t=>({...t,hosts:e.hosts,hostsHistogram:e.hostsHistogram,inspect:Object(pr.b)(e,t.inspect),refetch:o.current}))),c.current.unsubscribe())},error:e=>{d(!1),y(e,{title:Gr}),c.current.unsubscribe()}})};c.current.unsubscribe(),l.current.abort(),t(),o.current=t}),[s.search,y,v,i]);return Object(n.useEffect)((()=>{f((n=>{const{indices:i,factoryQueryType:s,timerange:o}=g({factoryQueryType:Bi.l.kpiHosts,indices:a,filterQuery:e,timerange:{interval:"12h",from:r,to:t}}),l={...null!=n?n:{},defaultIndex:i,factoryQueryType:s,filterQuery:Object(cr.a)(e),timerange:o};return Ki()(n,l)?n:l}))}),[a,t,e,r,g]),Object(n.useEffect)((()=>(E(p),()=>{c.current.unsubscribe(),l.current.abort()})),[p,E]),[u,b]})({filterQuery:e,endDate:r,indexNames:a,startDate:t,skip:l});return i.a.createElement(_r,{data:f,id:d,inspect:p,loading:c,fieldsMapping:Yr,from:t,to:r,narrowDateRange:s,refetch:u,setQuery:o})},Xr=i.a.memo(Jr),Zr=S.i18n.translate("xpack.securitySolution.hostsKpiUniqueIps.errorSearchDescription",{defaultMessage:"An error has occurred on hosts kpi unique ips search"}),es=S.i18n.translate("xpack.securitySolution.hostsKpiUniqueIps.failSearchDescription",{defaultMessage:"Failed to run search on hosts kpi unique ips"}),ts=S.i18n.translate("xpack.securitySolution.kpiHosts.uniqueIps.title",{defaultMessage:"Unique IPs"}),as=S.i18n.translate("xpack.securitySolution.kpiHosts.uniqueIps.sourceUnitLabel",{defaultMessage:"source"}),ns=S.i18n.translate("xpack.securitySolution.kpiHosts.uniqueIps.destinationUnitLabel",{defaultMessage:"destination"}),is=S.i18n.translate("xpack.securitySolution.kpiHosts.uniqueIps.sourceChartLabel",{defaultMessage:"Src."}),rs=S.i18n.translate("xpack.securitySolution.kpiHosts.uniqueIps.destinationChartLabel",{defaultMessage:"Dest."}),ss=[{key:"uniqueIps",fields:[{key:"uniqueSourceIps",name:is,description:as,value:null,color:Nr.a.uniqueSourceIps,icon:"visMapCoordinate"},{key:"uniqueDestinationIps",name:rs,description:ns,value:null,color:Nr.a.uniqueDestinationIps,icon:"visMapCoordinate"}],enableAreaChart:!0,enableBarChart:!0,description:ts}],os=({filterQuery:e,from:t,indexNames:a,to:r,narrowDateRange:s,setQuery:o,skip:l})=>{const[c,{refetch:u,id:d,inspect:p,...f}]=(({filterQuery:e,endDate:t,indexNames:a,skip:i=!1,startDate:r})=>{const{data:s}=Object(m.j)().services,o=Object(n.useRef)(me.noop),l=Object(n.useRef)(new AbortController),c=Object(n.useRef)(new or.Subscription),[u,d]=Object(n.useState)(!1),{getTransformChangesIfTheyExist:p}=Object(lr.a)(),[f,g]=Object(n.useState)(null),[b,h]=Object(n.useState)({uniqueSourceIps:0,uniqueSourceIpsHistogram:[],uniqueDestinationIps:0,uniqueDestinationIpsHistogram:[],id:"hostsKpiUniqueIpsQuery",inspect:{dsl:[],response:[]},isInspected:!1,refetch:o.current}),{addError:y,addWarning:v}=Object(Oe.a)(),E=Object(n.useCallback)((e=>{if(null==e||i)return;const t=async()=>{l.current=new AbortController,d(!0),c.current=s.search.search(e,{strategy:"securitySolutionSearchStrategy",abortSignal:l.current.signal}).subscribe({next:e=>{e.isPartial||e.isRunning?e.isPartial&&!e.isRunning&&(d(!1),v(Zr),c.current.unsubscribe()):(d(!1),h((t=>({...t,uniqueSourceIps:e.uniqueSourceIps,uniqueSourceIpsHistogram:e.uniqueSourceIpsHistogram,uniqueDestinationIps:e.uniqueDestinationIps,uniqueDestinationIpsHistogram:e.uniqueDestinationIpsHistogram,inspect:Object(pr.b)(e,t.inspect),refetch:o.current}))),c.current.unsubscribe())},error:e=>{d(!1),y(e,{title:es}),c.current.unsubscribe()}})};c.current.unsubscribe(),l.current.abort(),t(),o.current=t}),[s.search,y,v,i]);return Object(n.useEffect)((()=>{const{indices:n,factoryQueryType:i,timerange:s}=p({factoryQueryType:Bi.l.kpiUniqueIps,indices:a,filterQuery:e,timerange:{interval:"12h",from:r,to:t}});g((t=>{const a={...null!=t?t:{},defaultIndex:n,factoryQueryType:i,filterQuery:Object(cr.a)(e),timerange:s};return Ki()(t,a)?t:a}))}),[a,t,e,i,r,p]),Object(n.useEffect)((()=>(E(f),()=>{c.current.unsubscribe(),l.current.abort()})),[f,E]),[u,b]})({filterQuery:e,endDate:r,indexNames:a,startDate:t,skip:l});return i.a.createElement(_r,{data:f,id:d,inspect:p,loading:c,fieldsMapping:ss,from:t,to:r,narrowDateRange:s,refetch:u,setQuery:o})},ls=i.a.memo(os),cs=i.a.memo((({filterQuery:e,from:t,indexNames:a,to:n,setQuery:r,skip:s,narrowDateRange:o})=>i.a.createElement(_.EuiFlexGroup,{wrap:!0},i.a.createElement(_.EuiFlexItem,{grow:1},i.a.createElement(Xr,{filterQuery:e,from:t,indexNames:a,to:n,narrowDateRange:o,setQuery:r,skip:s})),i.a.createElement(_.EuiFlexItem,{grow:2},i.a.createElement(Vr,{filterQuery:e,from:t,indexNames:a,to:n,narrowDateRange:o,setQuery:r,skip:s})),i.a.createElement(_.EuiFlexItem,{grow:2},i.a.createElement(ls,{filterQuery:e,from:t,indexNames:a,to:n,narrowDateRange:o,setQuery:r,skip:s})))));cs.displayName="HostsKpiComponent";const us=i.a.memo((({filterQuery:e,from:t,indexNames:a,to:n,setQuery:r,skip:s,narrowDateRange:o})=>i.a.createElement(_.EuiFlexGroup,{wrap:!0},i.a.createElement(_.EuiFlexItem,{grow:1},i.a.createElement(Vr,{filterQuery:e,from:t,indexNames:a,to:n,narrowDateRange:o,setQuery:r,skip:s})),i.a.createElement(_.EuiFlexItem,{grow:1},i.a.createElement(ls,{filterQuery:e,from:t,indexNames:a,to:n,narrowDateRange:o,setQuery:r,skip:s})))));us.displayName="HostsDetailsKpiComponent";var ds=a(756),ps=a(139),ms=a(370),fs=a(138),gs=a(413),bs=a(355),hs=a(384),ys=a(191),vs=a(684),Es=a(685),Ts=a(330),ks=a(465),xs=a(466),Ss=a(108),ws=a(120);const Os=(e,t,a,n,r)=>{const s=((e,t,a,n)=>[{name:hs.d,field:"hostName",sortable:!0,render:(e,t)=>Object(ys.b)({rowItem:e,attrName:"host.name",idPrefix:`anomalies-host-table-hostName-${Object(Es.a)(t)}-hostName`,render:e=>i.a.createElement(Ht.d,{hostName:e})})},{name:hs.b,field:"anomaly.jobId",sortable:!0,render:(a,n)=>i.a.createElement(xs.a,{score:n.anomaly,startDate:e,endDate:t,linkName:a})},{name:hs.g,field:"anomaly.severity",sortable:!0,render:(e,t)=>i.a.createElement(ks.a,{id:Object(Ss.h)(`anomalies-host-table-severity-${Object(Es.a)(t)}`),score:t.anomaly})},{name:hs.c,field:"anomaly.entityValue",sortable:!0,render:(e,t)=>i.a.createElement(vs.a,{idPrefix:`anomalies-host-table-entityValue${Object(Es.a)(t)}-entity`,entityName:t.anomaly.entityName,entityValue:e})},{name:hs.e,field:"anomaly.influencers",render:(e,t)=>i.a.createElement(_.EuiFlexGroup,{direction:"column",gutterSize:"none",responsive:!1},e&&e.map((e=>{const[a,n]=Object(Ts.a)(e),r=null!=a?a:"",s=null!=n?n:"";return i.a.createElement(_.EuiFlexItem,{key:`${r}-${s}-${Object(Es.a)(t)}`,grow:!1},i.a.createElement(_.EuiFlexGroup,{gutterSize:"none",responsive:!1},i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(vs.a,{idPrefix:`anomalies-host-table-influencers-${r}-${s}-${Object(Es.a)(t)}`,entityName:r,entityValue:s}))))})))},{name:hs.i,field:"anomaly.time",sortable:!0,render:e=>i.a.createElement(ws.b,{value:e})}])(t,a);return e===fs.HostsType.details?s.filter((e=>e.name!==hs.d)):s},js=(e,t)=>null==e?[]:e.anomalies.reduce(((e,a)=>{if(Cs(a,t))return[...e,{hostName:a.entityValue,anomaly:a}];{const n=((e=[],t)=>{const a=e.find((e=>{const[a,n]=Object(Ts.a)(e);return"host.name"===a&&(null==t||n===t)}));return null!=a?Object.values(a)[0]:null})(a.influencers,t);return null!=n?[...e,{hostName:n,anomaly:a}]:e}}),[]),Cs=(e,t)=>"host.name"===e.entityName&&(null==t||e.entityValue===t);var Is=a(686);const Ms=(e,t)=>e.startDate===t.startDate&&e.endDate===t.endDate&&e.skip===t.skip,As=(e,t)=>e===fs.HostsType.details&&null!=t?[{fieldName:"host.name",fieldValue:t}]:[];var qs=a(291);const Ds={sort:{field:"anomaly.severity",direction:"desc"}},Ps=({startDate:e,endDate:t,narrowDateRange:a,hostName:n,skip:r,type:s})=>{const o=Object(Qi.a)(),[l,c]=Object(bs.a)({startDate:e,endDate:t,skip:r,criteriaFields:As(s,n)}),u=js(c,n);null==(d=c)||d.interval;var d;const p=Os(s,e,t),m={initialPageIndex:0,initialPageSize:10,totalItemCount:u.length,pageSizeOptions:[5,10,20,50],hidePerPageOptions:!1};return Object($i.a)(o)?i.a.createElement(qs.a,{loading:l},i.a.createElement(La.a,{subtitle:`${hs.h}: ${m.totalItemCount.toLocaleString()} ${hs.k(m.totalItemCount)}`,title:hs.a,tooltip:hs.j,isInspectDisabled:r}),i.a.createElement(Is.a,{columns:p,items:u,pagination:m,sorting:Ds}),l&&i.a.createElement(un.a,{"data-test-subj":"anomalies-host-table-loading-panel",overlay:!0,size:"xl"})):null},Rs=i.a.memo(Ps,Ms);var Fs=a(445),_s=a(411);const Ns=i.a.memo((({detailName:e,docValueFields:t,filterQuery:a,indexNames:r,indexPattern:s,pageFilters:o,setAbsoluteRangeDatePicker:c,hostDetailsPagePath:u})=>{const{from:d,to:p,isInitializing:m,deleteQuery:f,setQuery:g}=Object(he.a)(),b=Object(n.useCallback)(((e,t)=>{const a=Object(Vi.a)(e,t);c({id:"global",from:a.from,to:a.to})}),[c]),h=Object(n.useCallback)((({x:e})=>{if(!e)return;const[t,a]=e;c({id:"global",from:new Date(t).toISOString(),to:new Date(a).toISOString()})}),[c]),y={deleteQuery:f,endDate:p,filterQuery:a,skip:m||void 0===a,setQuery:g,startDate:d,type:Fs.b,indexPattern:s,indexNames:r,hostName:e,narrowDateRange:b,updateDateRange:h};return i.a.createElement(l.Switch,null,i.a.createElement(l.Route,{path:`${u}/:tabName(${fs.HostsTableType.authentications})`},i.a.createElement(_s.a,F()({docValueFields:t},y))),i.a.createElement(l.Route,{path:`${u}/:tabName(${fs.HostsTableType.hosts})`},i.a.createElement(_s.d,y)),i.a.createElement(l.Route,{path:`${u}/:tabName(${fs.HostsTableType.uncommonProcesses})`},i.a.createElement(_s.e,y)),i.a.createElement(l.Route,{path:`${u}/:tabName(${fs.HostsTableType.anomalies})`},i.a.createElement(gs.a,F()({},y,{AnomaliesTableComponent:Rs}))),i.a.createElement(l.Route,{path:`${u}/:tabName(${fs.HostsTableType.events})`},i.a.createElement(_s.b,F()({},y,{pageFilters:o}))),i.a.createElement(l.Route,{path:`${u}/:tabName(${fs.HostsTableType.alerts})`},i.a.createElement(_s.c,F()({},y,{pageFilters:o}))))}));Ns.displayName="HostDetailsTabs";var Ls=a(289);const Bs=(e,t)=>`${o.pb}/${e}/${t}`,zs=(e,t)=>{const a={[fs.HostsTableType.authentications]:{id:fs.HostsTableType.authentications,name:Ls.g,href:Bs(e,fs.HostsTableType.authentications),disabled:!1},[fs.HostsTableType.uncommonProcesses]:{id:fs.HostsTableType.uncommonProcesses,name:Ls.i,href:Bs(e,fs.HostsTableType.uncommonProcesses),disabled:!1},[fs.HostsTableType.anomalies]:{id:fs.HostsTableType.anomalies,name:Ls.f,href:Bs(e,fs.HostsTableType.anomalies),disabled:!1},[fs.HostsTableType.events]:{id:fs.HostsTableType.events,name:Ls.h,href:Bs(e,fs.HostsTableType.events),disabled:!1},[fs.HostsTableType.alerts]:{id:fs.HostsTableType.alerts,name:Ls.d,href:Bs(e,fs.HostsTableType.alerts),disabled:!1}};return t?a:Object(me.omit)(fs.HostsTableType.anomalies,a)};var Hs=a(788);const Us=Object(mr.a)(ds.a),$s=({detailName:e,hostDetailsPagePath:t})=>{const a=Object(b.useDispatch)(),r=Object(n.useMemo)((()=>y.b.getTimelineByIdSelector()),[]),o=Object(be.b)((e=>{var t;return(null!==(t=r(e,h.q.hostsPageEvents))&&void 0!==t?t:Re.a).graphEventId})),l=Object(n.useMemo)((()=>Ie.e.globalFiltersQuerySelector()),[]),c=Object(n.useMemo)((()=>Ie.e.globalQuerySelector()),[]),p=Object(be.a)(c),f=Object(be.a)(l),{to:g,from:E,deleteQuery:T,setQuery:k,isInitializing:x}=Object(he.a)(),{globalFullScreen:S}=Object(Ut.a)(),w=Object(Qi.a)(),O=Object(m.j)(),j=Object(n.useMemo)((()=>{return[{meta:{alias:null,negate:!1,disabled:!1,type:"phrase",key:"host.name",value:t=e,params:{query:t}},query:{match:{"host.name":{query:t,type:"phrase"}}}}];var t}),[e]),C=Object(n.useCallback)((({x:e})=>{if(!e)return;const[t,n]=e;a(Object(ke.setAbsoluteRangeDatePicker)({id:"global",from:new Date(t).toISOString(),to:new Date(n).toISOString()}))}),[a]),{docValueFields:I,indicesExist:M,indexPattern:A,selectedPatterns:q}=Object(v.c)(),[D,{inspect:P,hostDetails:R,id:F,refetch:N}]=Object(Hs.b)({endDate:g,startDate:E,hostName:e,indexNames:q,skip:0===q.length}),[L,B]=Object(ps.b)({config:xe.esQuery.getEsQueryConfig(O.services.uiSettings),indexPattern:A,queries:[p],filters:[...j,...f]});return Object(je.a)({id:Hs.a,filterQuery:L,kqlError:B,query:p,startDate:E,endDate:g}),Object(n.useEffect)((()=>{a(Object(ms.setHostDetailsTablesActivePageToZero)())}),[a,e]),i.a.createElement(i.a.Fragment,null,M?i.a.createElement(i.a.Fragment,null,i.a.createElement(_.EuiWindowEvent,{event:"resize",handler:me.noop}),i.a.createElement(ye.a,{show:Object(Pe.n)({globalFullScreen:S,graphEventId:o})},i.a.createElement(Ee.a,{indexPattern:A,id:"global"})),i.a.createElement(d.a,{noPadding:S,"data-test-subj":"hostDetailsPage"},i.a.createElement($t,{show:!S},i.a.createElement(Q.a,{border:!0,subtitle:i.a.createElement(zi.a,{docValueFields:I,indexKey:Bi.n.hostDetails,hostName:e,indexNames:q}),title:e}),i.a.createElement(Hi.a,{criteriaFields:Object(Ui.a)(R),startDate:E,endDate:g,skip:x},(({isLoadingAnomaliesData:e,anomaliesData:t})=>i.a.createElement(Us,{docValueFields:I,id:F,isInDetailsSidePanel:!1,data:R,anomaliesData:t,isLoadingAnomaliesData:e,indexNames:q,loading:D,startDate:E,endDate:g,narrowDateRange:(e,t)=>{const a=Object(Vi.a)(e,t);Object(ke.setAbsoluteRangeDatePicker)({id:"global",from:a.from,to:a.to})},setQuery:k,refetch:N,inspect:P}))),i.a.createElement(_.EuiHorizontalRule,null),i.a.createElement(us,{filterQuery:L,from:E,indexNames:q,setQuery:k,to:g,narrowDateRange:C,skip:x}),i.a.createElement(_.EuiSpacer,null),i.a.createElement(sr,{navTabs:zs(e,Object($i.a)(w))}),i.a.createElement(_.EuiSpacer,null)),i.a.createElement(Ns,{docValueFields:I,indexNames:q,isInitializing:x,deleteQuery:T,pageFilters:j,to:g,from:E,detailName:e,type:Fs.b,setQuery:k,filterQuery:L,hostDetailsPagePath:t,indexPattern:A,setAbsoluteRangeDatePicker:ke.setAbsoluteRangeDatePicker}))):i.a.createElement(d.a,null,i.a.createElement(pt.a,null)),i.a.createElement(u.a,{pageName:s.a.hosts}))};$s.displayName="HostDetailsComponent";const Qs=i.a.memo($s);var Vs=a(365),Ws=a(68);const Gs=e=>{try{return Object(Ws.decode)(e)}catch(e){return null}},Ks=e=>Object(me.isObject)(e),Ys=e=>Object(me.isString)(e),Js=(e,t)=>t.reduce(((t,a,n)=>{const i=((e,t)=>1===e.length?`${e[0]}: "${t}"`:e.reduce(((e,a,n,i)=>0===n?`(${a}: "${t}"`:n===i.length-1?`${e} or ${a}: "${t}")`:`${e} or ${a}: "${t}"`),""))(e,a);return 0===n?i:`${t} or ${i}`}),""),Xs=(e,t,a)=>{const n=Gs(a);if(Ks(n)){const a=n;if(Ks(a)&&Ys(a.query)){const i=Js(e,t);return""!==a.query&&""!==i?a.query=`(${i}) and (${a.query})`:""===a.query&&""!==i&&(a.query=`(${i})`),Object(Ws.encode)(n)}}else if(null==n){const a=Js(e,t);return Object(Ws.encode)({query:`(${a})`,language:"kuery"})}return a},Zs=(e,t,a)=>`(${a.split(",").reduce(((e,a,n)=>0===n?`${t}: "${a}"`:`${e} or ${t}: "${a}"`),"")})`,eo=e=>{const t=Gs(e);if(Ks(t)){const e=t;if(Ks(e)&&Ys(e.query))return e.query=e.query.replace(/([\w\.\-\[\]]+)\s*:\s*"(([\w\.\-\(\)\[\]]+,[\w\.\-\(\)\[\]]+){1,})"/g,Zs),Object(Ws.encode)(t)}return e},to=["and","or","not"],ao=(e,...t)=>{if(null==t)return"";const a=t.reduce(((e,t)=>null!=t&&to.includes(t)?[...e,t]:e),[]);return a.length>1?` ${a[a.length-1].trim()} `:""},no=e=>{const t=Gs(e);if(Ks(t)){const e=t;if(Ks(e)&&Ys(e.query))return e.query=e.query.replace(/(\s+)*(and|or|not){0,1}(\s+)*([\w\.\-\[\]]+)\s*:\s*"(\$[\w\.\-\(\)\[\]]+\$)"(\s+)*(and|or|not){0,1}(\s+)*/g,ao),Object(Ws.encode)(t)}return e},io=e=>Object(me.flow)(eo,no)(e),ro=e=>""===e.trim()||e.startsWith("$")&&e.endsWith("$"),so=e=>e.split(",").length>1,oo=e=>e.split(",");var lo=a(30);const co=i.a.memo((()=>{const{path:e}=Object(l.useRouteMatch)();return i.a.createElement(l.Switch,null,i.a.createElement(l.Route,{strict:!0,exact:!0,path:e,render:({location:e})=>{const t=Object(Vs.parse)(e.search.substring(1),{sort:!1});null!=t.query&&(t.query=io(t.query));const a=Object(Vs.stringify)(lo.url.encodeQuery(t),{sort:!1,encode:!1});return i.a.createElement(l.Redirect,{to:`${o.pb}?${a}`})}}),i.a.createElement(l.Route,{path:`${e}/:hostName`,render:({location:e,match:{params:{hostName:t}}})=>{const a=Object(Vs.parse)(e.search.substring(1),{sort:!1});if(null!=a.query&&(a.query=io(a.query)),ro(t)){const e=Object(Vs.stringify)(lo.url.encodeQuery(a),{sort:!1,encode:!1});return i.a.createElement(l.Redirect,{to:`${o.pb}/${fs.HostsTableType.anomalies}?${e}`})}if(so(t)){const e=oo(t);a.query=Xs(["host.name"],e,a.query||"");const n=Object(Vs.stringify)(lo.url.encodeQuery(a),{sort:!1,encode:!1});return i.a.createElement(l.Redirect,{to:`${o.pb}/${fs.HostsTableType.anomalies}?${n}`})}{const e=Object(Vs.stringify)(lo.url.encodeQuery(a),{sort:!1,encode:!1});return i.a.createElement(l.Redirect,{to:`${o.pb}/${t}/${fs.HostsTableType.anomalies}?${e}`})}}}),i.a.createElement(l.Route,{path:`${o.pb}/ml-hosts/`,render:({location:{search:e=""}})=>i.a.createElement(l.Redirect,{from:`${o.pb}/ml-hosts/`,to:`${o.pb}/ml-hosts${e}`})}))}));co.displayName="MlHostConditionalContainer";var uo=a(381);const po=Object(n.memo)((({deleteQuery:e,docValueFields:t,filterQuery:a,from:r,indexNames:s,isInitializing:c,setAbsoluteRangeDatePicker:u,setQuery:d,to:p,type:m})=>{const f={deleteQuery:e,endDate:p,filterQuery:a,indexNames:s,skip:c||void 0===a,setQuery:d,startDate:r,type:m,narrowDateRange:Object(n.useCallback)(((e,t)=>{const a=Object(Vi.a)(e,t);u({id:"global",from:a.from,to:a.to})}),[u]),updateDateRange:Object(n.useCallback)((({x:e})=>{if(!e)return;const[t,a]=e;u({id:"global",from:new Date(t).toISOString(),to:new Date(a).toISOString()})}),[u])};return i.a.createElement(l.Switch,null,i.a.createElement(l.Route,{path:`${o.pb}/:tabName(${fs.HostsTableType.hosts})`},i.a.createElement(_s.d,F()({docValueFields:t},f))),i.a.createElement(l.Route,{path:`${o.pb}/:tabName(${fs.HostsTableType.authentications})`},i.a.createElement(_s.a,F()({docValueFields:t},f))),i.a.createElement(l.Route,{path:`${o.pb}/:tabName(${fs.HostsTableType.uncommonProcesses})`},i.a.createElement(_s.e,f)),i.a.createElement(l.Route,{path:`${o.pb}/:tabName(${fs.HostsTableType.anomalies})`},i.a.createElement(gs.a,F()({},f,{AnomaliesTableComponent:Rs}))),i.a.createElement(l.Route,{path:`${o.pb}/:tabName(${fs.HostsTableType.events})`},i.a.createElement(_s.b,f)),i.a.createElement(l.Route,{path:`${o.pb}/:tabName(${fs.HostsTableType.alerts})`},i.a.createElement(uo.a,f)))}));po.displayName="HostsTabs";const mo=e=>`${o.pb}/${e}`,fo=e=>{const t={[fs.HostsTableType.hosts]:{id:fs.HostsTableType.hosts,name:Ls.e,href:mo(fs.HostsTableType.hosts),disabled:!1},[fs.HostsTableType.authentications]:{id:fs.HostsTableType.authentications,name:Ls.g,href:mo(fs.HostsTableType.authentications),disabled:!1},[fs.HostsTableType.uncommonProcesses]:{id:fs.HostsTableType.uncommonProcesses,name:Ls.i,href:mo(fs.HostsTableType.uncommonProcesses),disabled:!1},[fs.HostsTableType.anomalies]:{id:fs.HostsTableType.anomalies,name:Ls.f,href:mo(fs.HostsTableType.anomalies),disabled:!1},[fs.HostsTableType.events]:{id:fs.HostsTableType.events,name:Ls.h,href:mo(fs.HostsTableType.events),disabled:!1},[fs.HostsTableType.alerts]:{id:fs.HostsTableType.alerts,name:Ls.d,href:mo(fs.HostsTableType.alerts),disabled:!1}};return e?t:Object(me.omit)([fs.HostsTableType.anomalies],t)};var go=a(208),bo=a(790);const ho=L.a.div.withConfig({displayName:"StyledFullHeightContainer",componentId:"sc-13ka402-0"})(["display:flex;flex-direction:column;flex:1 1 auto;"]),yo=()=>{const e=Object(b.useDispatch)(),t=Object(n.useRef)(null),a=Object(n.useMemo)((()=>y.b.getTimelineByIdSelector()),[]),r=Object(be.b)((e=>{var t,n;return(null!==(t=null!==(n=a(e,h.q.hostsPageEvents))&&void 0!==n?n:a(e,h.q.hostsPageExternalAlerts))&&void 0!==t?t:Re.a).graphEventId})),o=Object(n.useMemo)((()=>Ie.e.globalFiltersQuerySelector()),[]),c=Object(n.useMemo)((()=>Ie.e.globalQuerySelector()),[]),p=Object(be.a)(c),f=Object(be.a)(o),{to:g,from:E,deleteQuery:T,setQuery:k,isInitializing:x}=Object(he.a)(),{globalFullScreen:S}=Object(Ut.a)(),w=Object(Qi.a)(),{uiSettings:O}=Object(m.j)().services,{tabName:j}=Object(l.useParams)(),C=i.a.useMemo((()=>j===fs.HostsTableType.alerts?f.length>0?[...f,..._s.g]:_s.g:f),[j,f]),I=Object(n.useCallback)((({x:t})=>{if(!t)return;const[a,n]=t;e(Object(ke.setAbsoluteRangeDatePicker)({id:"global",from:new Date(a).toISOString(),to:new Date(n).toISOString()}))}),[e]),{docValueFields:M,indicesExist:A,indexPattern:q,selectedPatterns:D}=Object(v.c)(),[P,R]=Object(n.useMemo)((()=>Object(ps.b)({config:xe.esQuery.getEsQueryConfig(O),indexPattern:q,queries:[p],filters:f})),[f,q,O,p]),[F]=Object(n.useMemo)((()=>Object(ps.b)({config:xe.esQuery.getEsQueryConfig(O),indexPattern:q,queries:[p],filters:C})),[q,p,C,O]);Object(je.a)({id:bo.a,filterQuery:P,kqlError:R,query:p,startDate:E,endDate:g});const N=Object(n.useCallback)((()=>{var e,a;null===(e=t.current)||void 0===e||null===(a=e.querySelector(".inspectButtonComponent:last-of-type"))||void 0===a||a.focus()}),[t]),L=Object(n.useCallback)((()=>{Object(Pe.m)()}),[]),B=Object(n.useCallback)((e=>{Object(ge.isTab)(e)&&Object(Pe.l)({containerElement:t.current,keyboardEvent:e,onSkipFocusBeforeEventsTable:N,onSkipFocusAfterEventsTable:L})}),[t,N,L]);return i.a.createElement(i.a.Fragment,null,A?i.a.createElement(ho,{onKeyDown:B,ref:t},i.a.createElement(_.EuiWindowEvent,{event:"resize",handler:me.noop}),i.a.createElement(ye.a,{show:Object(Pe.n)({globalFullScreen:S,graphEventId:r})},i.a.createElement(Ee.a,{indexPattern:q,id:"global"})),i.a.createElement(d.a,{noPadding:S},i.a.createElement($t,{show:!S},i.a.createElement(Q.a,{subtitle:i.a.createElement(zi.a,{docValueFields:M,indexKey:Bi.n.hosts,indexNames:D}),title:Ls.j,border:!0}),i.a.createElement(cs,{filterQuery:P,indexNames:D,from:E,setQuery:k,to:g,skip:x||!P,narrowDateRange:I}),i.a.createElement(_.EuiSpacer,null),i.a.createElement(sr,{navTabs:fo(Object($i.a)(w))}),i.a.createElement(_.EuiSpacer,null)),i.a.createElement(po,{deleteQuery:T,docValueFields:M,to:g,filterQuery:F||"",isInitializing:x,indexNames:D,setAbsoluteRangeDatePicker:ke.setAbsoluteRangeDatePicker,setQuery:k,from:E,type:go.b.HostsType.page}))):i.a.createElement(d.a,null,i.a.createElement(pt.a,null)),i.a.createElement(u.a,{pageName:s.a.hosts}))};yo.displayName="HostsComponent";const vo=i.a.memo(yo),Eo=`${o.pb}/:detailName`,To=i.a.memo((()=>i.a.createElement(l.Switch,null,i.a.createElement(l.Route,{exact:!0,strict:!0,path:o.pb,render:({location:{search:e=""}})=>i.a.createElement(l.Redirect,{to:{pathname:`${o.pb}/${fs.HostsTableType.hosts}`,search:e}})}),i.a.createElement(l.Route,{path:`${o.pb}/ml-hosts`},i.a.createElement(co,null)),i.a.createElement(l.Route,{path:`${o.pb}/:tabName(${fs.HostsTableType.hosts}|${fs.HostsTableType.authentications}|${fs.HostsTableType.uncommonProcesses}|${fs.HostsTableType.anomalies}|${fs.HostsTableType.events}|${fs.HostsTableType.alerts})`},i.a.createElement(vo,null)),i.a.createElement(l.Route,{path:`${Eo}/:tabName(${fs.HostsTableType.authentications}|${fs.HostsTableType.uncommonProcesses}|${fs.HostsTableType.anomalies}|${fs.HostsTableType.events}|${fs.HostsTableType.alerts})`,render:({match:{params:{detailName:e}}})=>i.a.createElement(Qs,{hostDetailsPagePath:Eo,detailName:e})}),i.a.createElement(l.Route,{path:Eo,render:({match:{params:{detailName:e}},location:{search:t=""}})=>i.a.createElement(l.Redirect,{to:{pathname:`${o.pb}/${e}/${fs.HostsTableType.authentications}`,search:t}})}))));To.displayName="HostsContainer";const ko=[{path:o.pb,render:()=>i.a.createElement(r.TrackApplicationView,{viewId:s.a.hosts},i.a.createElement(To,null))}],xo=[h.q.hostsPageEvents,h.q.hostsPageExternalAlerts];var So=a(751),wo=a(217),Oo=a(80);const jo=L()(_.EuiPanel).withConfig({displayName:"Panel",componentId:"sc-4inzan-0"})(["overflow:hidden;"]);jo.displayName="Panel";const Co=i.a.memo((({children:e})=>i.a.createElement("section",{className:"siemEmbeddable"},i.a.createElement(jo,{paddingSize:"none",hasBorder:!0},e))));Co.displayName="Embeddable";const Io=L.a.header.attrs((({className:e})=>({className:`siemEmbeddable__header ${e}`}))).withConfig({displayName:"Header",componentId:"sc-yclxqi-0"})(["border-bottom:",";padding:",";"],(({theme:e})=>e.eui.euiBorderThin),(({theme:e})=>e.eui.paddingSizes.m));Io.displayName="Header";const Mo=i.a.memo((({children:e,title:t})=>i.a.createElement(Io,null,i.a.createElement(_.EuiFlexGroup,{alignItems:"center",gutterSize:"m"},i.a.createElement(_.EuiFlexItem,null,i.a.createElement(_.EuiTitle,{size:"xxxs"},i.a.createElement("h6",{"data-test-subj":"header-embeddable-title"},t))),e&&i.a.createElement(_.EuiFlexItem,{"data-test-subj":"header-embeddable-supplements",grow:!1},e)))));Mo.displayName="EmbeddableHeader";a(940);const Ao=S.i18n.translate("xpack.securitySolution.components.embeddables.embeddedMap.embeddableHeaderTitle",{defaultMessage:"Network map"}),qo=S.i18n.translate("xpack.securitySolution.components.embeddables.embeddedMap.embeddableHeaderHelp",{defaultMessage:"Map configuration help"}),Do=S.i18n.translate("xpack.securitySolution.components.embeddables.embeddedMap.embeddablePanelTitle",{defaultMessage:"Source -> Destination Point-to-Point Map"}),Po=S.i18n.translate("xpack.securitySolution.components.embeddables.embeddedMap.sourceLayerLabel",{defaultMessage:"Source Point"}),Ro=S.i18n.translate("xpack.securitySolution.components.embeddables.embeddedMap.destinationLayerLabel",{defaultMessage:"Destination Point"}),Fo=S.i18n.translate("xpack.securitySolution.components.embeddables.embeddedMap.clientLayerLabel",{defaultMessage:"Client Point"}),_o=S.i18n.translate("xpack.securitySolution.components.embeddables.embeddedMap.serverLayerLabel",{defaultMessage:"Server Point"}),No=S.i18n.translate("xpack.securitySolution.components.embeddables.embeddedMap.lineLayerLabel",{defaultMessage:"Line"}),Lo=(S.i18n.translate("xpack.securitySolution.components.embeddables.embeddedMap.errorConfiguringEmbeddableApiTitle",{defaultMessage:"Error configuring Embeddables API"}),S.i18n.translate("xpack.securitySolution.components.embeddables.embeddedMap.errorCreatingMapEmbeddableTitle",{defaultMessage:"Error creating Map Embeddable"})),Bo=S.i18n.translate("xpack.securitySolution.components.embeddables.indexPatternsMissingPrompt.errorTitle",{defaultMessage:"Required index patterns not configured"}),zo=S.i18n.translate("xpack.securitySolution.components.embeddables.indexPatternsMissingPrompt.errorButtonLabel",{defaultMessage:"Configure index patterns"}),Ho=(S.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.filterForValueHoverAction",{defaultMessage:"Filter for value"}),S.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.errorTitle",{defaultMessage:"Error loading map features"})),Uo=S.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.hostTitle",{defaultMessage:"Host"}),$o=S.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.sourceIPTitle",{defaultMessage:"Source IP"}),Qo=S.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.destinationIPTitle",{defaultMessage:"Destination IP"}),Vo=S.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.clientIPTitle",{defaultMessage:"Client IP"}),Wo=S.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.serverIPTitle",{defaultMessage:"Server IP"}),Go=S.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.sourceDomainTitle",{defaultMessage:"Source domain"}),Ko=S.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.destinationDomainTitle",{defaultMessage:"Destination domain"}),Yo=S.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.clientDomainTitle",{defaultMessage:"Client domain"}),Jo=S.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.serverDomainTitle",{defaultMessage:"Server domain"}),Xo=S.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.locationTitle",{defaultMessage:"Location"}),Zo=S.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.asnTitle",{defaultMessage:"ASN"}),el=S.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.lineContent.sourceLabel",{defaultMessage:"Source"}),tl=S.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.lineContent.destinationLabel",{defaultMessage:"Destination"}),al=S.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.lineContent.clientLabel",{defaultMessage:"Client"}),nl=S.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.lineContent.serverLabel",{defaultMessage:"Server"});var il=a(84);const rl=Object(_.euiPaletteColorBlind)(),sl={"host.name":Uo,"source.ip":$o,"source.domain":Go,"source.geo.country_iso_code":Xo,"source.as.organization.name":Zo},ol={"host.name":Uo,"destination.ip":Qo,"destination.domain":Ko,"destination.geo.country_iso_code":Xo,"destination.as.organization.name":Zo},ll={"host.name":Uo,"client.ip":Vo,"client.domain":Yo,"client.geo.country_iso_code":Xo,"client.as.organization.name":Zo},cl={"host.name":Uo,"server.ip":Wo,"server.domain":Jo,"server.geo.country_iso_code":Xo,"server.as.organization.name":Zo},ul={...sl,...ol,...ll,...cl},dl="sum_of_source.bytes",pl={source:{metricField:"client.bytes",geoField:"client.geo.location",tooltipProperties:Object.keys(ll),label:Fo},destination:{metricField:"server.bytes",geoField:"server.geo.location",tooltipProperties:Object.keys(cl),label:_o}},ml={default:{source:{metricField:"source.bytes",geoField:"source.geo.location",tooltipProperties:Object.keys(sl),label:Po},destination:{metricField:"destination.bytes",geoField:"destination.geo.location",tooltipProperties:Object.keys(ol),label:Ro}},"apm-*":pl,"traces-apm*,logs-apm*,metrics-apm*,apm-*":pl},fl=e=>[{sourceDescriptor:{type:il.SOURCE_TYPES.EMS_TMS,isAutoSelect:!0},id:Na.a.v4(),label:null,minZoom:0,maxZoom:24,alpha:1,visible:!0,style:null,type:"VECTOR_TILE"},...e.reduce(((e,{title:t,id:a})=>{var n,i,r,s,o;return[...e,hl(t,a,null!==(n=ml[t])&&void 0!==n?n:ml.default),bl(t,a,null!==(i=null===(r=ml[t])||void 0===r?void 0:r.destination)&&void 0!==i?i:ml.default.destination),gl(t,a,null!==(s=null===(o=ml[t])||void 0===o?void 0:o.source)&&void 0!==s?s:ml.default.source)]}),[])],gl=(e,t,a)=>({sourceDescriptor:{id:Na.a.v4(),type:"ES_SEARCH",applyGlobalQuery:!0,geoField:a.geoField,filterByMapBounds:!1,tooltipProperties:a.tooltipProperties,useTopHits:!1,topHitsTimeField:"@timestamp",topHitsSize:1,indexPatternId:t},style:{type:"VECTOR",properties:{fillColor:{type:"STATIC",options:{color:rl[1]}},lineColor:{type:"STATIC",options:{color:"#FFFFFF"}},lineWidth:{type:"STATIC",options:{size:2}},iconSize:{type:"STATIC",options:{size:8}},iconOrientation:{type:"STATIC",options:{orientation:0}},symbolizeAs:{options:{value:"icon"}},icon:{type:"STATIC",options:{value:"home"}}}},id:Na.a.v4(),label:`${e} | ${a.label}`,minZoom:0,maxZoom:24,alpha:1,visible:!0,type:"VECTOR",query:{query:"",language:"kuery"},joins:[]}),bl=(e,t,a)=>({sourceDescriptor:{id:Na.a.v4(),type:"ES_SEARCH",applyGlobalQuery:!0,geoField:a.geoField,filterByMapBounds:!0,tooltipProperties:a.tooltipProperties,useTopHits:!1,topHitsTimeField:"@timestamp",topHitsSize:1,indexPatternId:t},style:{type:"VECTOR",properties:{fillColor:{type:"STATIC",options:{color:rl[2]}},lineColor:{type:"STATIC",options:{color:"#FFFFFF"}},lineWidth:{type:"STATIC",options:{size:2}},iconSize:{type:"STATIC",options:{size:8}},iconOrientation:{type:"STATIC",options:{orientation:0}},symbolizeAs:{options:{value:"icon"}},icon:{type:"STATIC",options:{value:"marker"}}}},id:Na.a.v4(),label:`${e} | ${a.label}`,minZoom:0,maxZoom:24,alpha:1,visible:!0,type:"VECTOR",query:{query:"",language:"kuery"}}),hl=(e,t,a)=>({sourceDescriptor:{type:il.SOURCE_TYPES.ES_PEW_PEW,applyGlobalQuery:!0,id:Na.a.v4(),indexPatternId:t,sourceGeoField:a.source.geoField,destGeoField:a.destination.geoField,metrics:[{type:"sum",field:a.source.metricField,label:a.source.metricField},{type:"sum",field:a.destination.metricField,label:a.destination.metricField}]},style:{type:"VECTOR",properties:{fillColor:{type:"STATIC",options:{color:"#1EA593"}},lineColor:{type:"STATIC",options:{color:rl[1]}},lineWidth:{type:"DYNAMIC",options:{field:{label:"count",name:"doc_count",origin:"source"},minSize:1,maxSize:8,fieldMetaOptions:{isEnabled:!0,sigma:3}}},iconSize:{type:"STATIC",options:{size:10}},iconOrientation:{type:"STATIC",options:{orientation:0}},symbolizeAs:{options:{value:"icon"}},icon:{type:"STATIC",options:{value:"airfield"}}}},id:Na.a.v4(),label:`${e} | ${No}`,minZoom:0,maxZoom:24,alpha:.5,visible:!0,type:"VECTOR",query:{query:"",language:"kuery"}});var yl=a(85);const vl=()=>{const{docLinks:e}=Object(m.j)().services,t=`${Object(m.e)()}/app`;return i.a.createElement(_.EuiEmptyPrompt,{iconType:"gisApp",title:i.a.createElement("h2",null,Bo),titleSize:"xs",body:i.a.createElement(i.a.Fragment,null,i.a.createElement("p",null,i.a.createElement(oa.FormattedMessage,{defaultMessage:"To display map data, you must define SIEM indices ({defaultIndex}) and Kibana index patterns with matching glob patterns. When using {beats}, you can run the {setup} command on your hosts to automatically create the index patterns. For example: {example}.",id:"xpack.securitySolution.components.embeddables.indexPatternsMissingPrompt.errorDescription1",values:{defaultIndex:i.a.createElement("a",{href:`${t}/management/kibana/settings`,rel:"noopener noreferrer",target:"_blank"},"securitySolution:defaultIndex"),beats:i.a.createElement("a",{href:`${e.links.libbeat.getStarted}`,rel:"noopener noreferrer",target:"_blank"},"beats"),setup:i.a.createElement(_.EuiCode,null,"setup"),example:i.a.createElement(_.EuiCode,null,"./packetbeat setup")}})),i.a.createElement("p",null,i.a.createElement(oa.FormattedMessage,{defaultMessage:"You can also configure index patterns manually in Kibana.",id:"xpack.securitySolution.components.embeddables.indexPatternsMissingPrompt.errorDescription2"}))),actions:i.a.createElement(_.EuiButton,{href:`${t}/management/kibana/indexPatterns`,color:"primary",target:"_blank",fill:!0},zo)})};vl.displayName="IndexPatternsMissingPromptComponent";const El=i.a.memo(vl);El.displayName="IndexPatternsMissingPrompt";L()(_.EuiIcon).withConfig({displayName:"Icon",componentId:"sc-s0r863-0"})(["margin-right:",";"],ii.euiLightVars.euiSizeS).displayName="Icon";const Tl=({featureIndex:e,totalFeatures:t,previousFeature:a,nextFeature:n})=>i.a.createElement(i.a.Fragment,null,i.a.createElement(_.EuiHorizontalRule,{margin:"s"}),i.a.createElement(_.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"center",gutterSize:"xs"},i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(_.EuiText,{size:"xs"},((e,t)=>S.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.footerLabel",{values:{currentFeature:e,totalFeatures:t},defaultMessage:"{currentFeature} of {totalFeatures} {totalFeatures, plural, =1 {feature} other {features}}"}))(e+1,t))),i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement("span",null,i.a.createElement(_.EuiButtonIcon,{"data-test-subj":"previous-feature-button",color:"text",onClick:a,iconType:"arrowLeft","aria-label":"Next",isDisabled:e<=0}),i.a.createElement(_.EuiButtonIcon,{"data-test-subj":"next-feature-button",color:"text",onClick:n,iconType:"arrowRight","aria-label":"Next",isDisabled:e>=t-1})))));Tl.displayName="ToolTipFooterComponent";const kl=i.a.memo(Tl);kl.displayName="ToolTipFooter";var xl=a(415);const Sl=L()(_.EuiBadge).withConfig({displayName:"FlowBadge",componentId:"sc-120vo88-0"})(["height:45px;min-width:85px;"]),wl=L()(_.EuiFlexGroup).withConfig({displayName:"EuiFlexGroupStyled",componentId:"sc-120vo88-1"})(["margin:0 auto;"]),Ol=({contextId:e,featureProps:t})=>{const a=t.reduce(((e,t)=>{var a;const n=null!==(a=t.getRawValue())&&void 0!==a?a:[];return{...e,[t.getPropertyKey()]:Array.isArray(n)?n:[n]}}),{}),n=Object.keys(a).includes(dl);return i.a.createElement(_.EuiFlexGroup,{justifyContent:"center",gutterSize:"none"},i.a.createElement(_.EuiFlexItem,null,i.a.createElement(Sl,{color:"hollow"},i.a.createElement(wl,{direction:"column"},i.a.createElement(_.EuiFlexItem,{grow:!1},n?el:al)))),i.a.createElement(xl.e,{contextId:e,destinationBytes:n?a["sum_of_destination.bytes"]:a["sum_of_server.bytes"],eventId:`map-line-tooltip-${e}`,sourceBytes:n?a[dl]:a["sum_of_client.bytes"]}),i.a.createElement(_.EuiFlexItem,null,i.a.createElement(Sl,{color:"hollow"},i.a.createElement(wl,null,i.a.createElement(_.EuiFlexItem,{grow:!1},n?tl:nl)))))};Ol.displayName="LineToolTipContentComponent";const jl=i.a.memo(Ol);jl.displayName="LineToolTipContent";var Cl=a(292);const Il=({contextId:e,featureProps:t})=>{const a=Object(n.useMemo)((()=>t.map((t=>{var a;const n=t.getPropertyKey(),r=null!==(a=t.getRawValue())&&void 0!==a?a:[];return{title:ul[n],description:i.a.createElement(i.a.Fragment,null,null!=r?i.a.createElement(Cl.b,{rowItems:Array.isArray(r)?r:[r],attrName:n,idPrefix:`map-point-tooltip-${e}-${n}-${r}`,render:e=>Al(n,e)}):Object(wr.d)())}}))),[e,t]);return i.a.createElement(qn.d,{listItems:a})};Il.displayName="PointToolTipContentComponent";const Ml=i.a.memo(Il);Ml.displayName="PointToolTipContent";const Al=(e,t)=>{if(""===t)return Object(wr.f)(t);if(["host.name"].includes(e))return i.a.createElement(Ht.d,{hostName:t});if(["source.ip","destination.ip"].includes(e)){const a=e.split(".")[0];return i.a.createElement(Ht.h,{ip:t,flowTarget:a})}return i.a.createElement(i.a.Fragment,null,t)},ql=({closeTooltip:e,features:t=[],getLayerName:a,loadFeatureProperties:r,loadFeatureGeometry:s})=>{const[o,l]=Object(n.useState)(!0),[c,u]=Object(n.useState)(!1),[d,p]=Object(n.useState)(!1),[m,f]=Object(n.useState)(0),[g,b]=Object(n.useState)([]),[h,y]=Object(n.useState)(null),[,v]=Object(n.useState)(""),E=Object(n.useCallback)((()=>{null!=e&&(e(),f(0))}),[e]),T=Object(n.useCallback)((()=>{f((e=>e-1)),u(!0)}),[]),k=Object(n.useCallback)((()=>{f((e=>e+1)),u(!0)}),[]),x=Object(n.useMemo)((()=>d?i.a.createElement(_.EuiFlexGroup,{justifyContent:"spaceAround"},i.a.createElement(_.EuiFlexItem,{grow:!1},Ho)):o&&!c?i.a.createElement(_.EuiFlexGroup,{justifyContent:"spaceAround"},i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(_.EuiLoadingSpinner,{size:"m"}))):i.a.createElement("div",null,null!=h&&"LineString"===h.type?i.a.createElement(jl,{contextId:`${t[m].layerId}-${t[m].id}-${m}`,featureProps:g}):i.a.createElement(Ml,{contextId:`${t[m].layerId}-${t[m].id}-${m}`,featureProps:g}),t.length>1&&i.a.createElement(kl,{featureIndex:m,totalFeatures:t.length,previousFeature:T,nextFeature:k}),c&&i.a.createElement(un.a,{"data-test-subj":"loading-panel",overlay:!0,size:"m"}))),[h,m,g,t,k,T,d,o,c]);return Object(n.useEffect)((()=>{if(0===t.length||null==a||null==r||null==s)return;c||l(!0),p(!1);(async()=>{if(null!=t[m]){const e=t[m].layerId,n=t[m].id;try{const i=s({layerId:e,featureId:n}),[o,c]=await Promise.all([r({layerId:e,properties:t[m].mbProperties}),a(e)]);b(o),y(i),c&&v(c)}catch(e){p(!0)}finally{l(!1),u(!1)}}})()}),[m,t,a,c,s,r]),i.a.createElement(_.EuiOutsideClickDetector,{onOutsideClick:E},x)};ql.displayName="MapToolTipComponent";const Dl=i.a.memo(ql);Dl.displayName="MapToolTip";var Pl=a(135);const Rl=()=>{const e=Pl.d.kibanaIndexPatternsSelector(),t=Pl.d.scopesSelector();return a=>({kibanaIndexPatterns:e(a),sourcererScope:t(a)[E.SourcererScopeName.default]})},Fl=L.a.div.attrs((()=>({className:"siemEmbeddable__map"}))).withConfig({displayName:"EmbeddableMap",componentId:"sc-1t0ky4k-0"})([".embPanel{border:none;box-shadow:none;}.mapToolbarOverlay__button{display:none;}",""],(({maintainRatio:e})=>e&&Object(N.css)(["padding-top:calc(3 / 4 * 100%);position:relative;@media only screen and (min-width:","){padding-top:calc(9 / 32 * 100%);}@media only screen and (min-width:1441px) and (min-height:901px){padding-top:calc(9 / 21 * 100%);}.embPanel{bottom:0;left:0;position:absolute;right:0;top:0;}"],(({theme:e})=>e.eui.euiBreakpoints.m))));Fl.displayName="EmbeddableMap";const _l=({endDate:e,filters:t,query:a,setQuery:r,startDate:s})=>{const[o,l]=i.a.useState(void 0),[c,u]=Object(n.useState)(!1),[d,p]=Object(n.useState)(!1),[,f]=Object(we.h)(),g=Object(n.useMemo)(Rl,[]),{kibanaIndexPatterns:b,sourcererScope:h}=Object(be.a)(g),[y,v]=Object(n.useState)(b.filter((e=>h.selectedPatterns.includes(e.title)))),E=i.a.useMemo((()=>Object(wo.c)()),[]),{services:T}=Object(m.j)();return Object(n.useEffect)((()=>{v((e=>{const t=b.filter((e=>h.selectedPatterns.includes(e.title)));return Ki()(t,e)?e:(0===t.length&&u(!0),t)}))}),[b,h.selectedPatterns]),Object(n.useEffect)((()=>{let n=!0;return null==o&&h.selectedPatterns.length>0&&async function(){try{const o=await(async(e,t,a,n,r,s,o,l)=>{const c=l.getEmbeddableFactory(yl.MAP_SAVED_OBJECT_TYPE);if(!c)throw new Error("Map embeddable factory undefined");const u={title:Do,attributes:{title:""},id:Na.a.v4(),filters:e,hidePanelTitles:!0,query:a,timeRange:{from:new Date(n).toISOString(),to:new Date(r).toISOString()},viewMode:Oo.ViewMode.VIEW,isLayerTOCOpen:!1,openTOCDetails:[],hideFilterActions:!1,mapCenter:{lon:-1.05469,lat:15.96133,zoom:1},disabledActions:["CUSTOM_TIME_RANGE","CUSTOM_TIME_RANGE_BADGE"]},d=({addFilters:e,closeTooltip:t,features:a,isLocked:n,getLayerName:r,loadFeatureProperties:s,loadFeatureGeometry:l})=>{const c={addFilters:e,closeTooltip:t,features:a,isLocked:n,getLayerName:r,loadFeatureProperties:s,loadFeatureGeometry:l};return i.a.createElement(wo.b,F()({node:o},c))},p=await c.create(u);if(!p)throw new Error("Map embeddable is undefined");return Object(Oo.isErrorEmbeddable)(p)||(p.setRenderTooltipContent(d),p.setLayerList(fl(t))),s({id:"embeddedMap",inspect:null,loading:!1,refetch:()=>p.reload()}),p})(t,y,a,s,e,r,E,T.embeddable);n&&(0===y.length?p(!0):(l(o),p(!1)))}catch(e){n&&(Object(we.d)(Lo,[e.message],f),u(!0))}}(),()=>{n=!1}}),[f,e,o,t,y,a,E,T.embeddable,h.selectedPatterns,r,s]),Object(n.useEffect)((()=>{null==o||Object(Oo.isErrorEmbeddable)(o)||(async()=>{null!=o&&(await o.setLayerList(fl(y)),o.reload())})()}),[o,y]),Object(n.useEffect)((()=>{null!=o&&o.updateInput({query:a})}),[o,a]),Object(n.useEffect)((()=>{null!=o&&o.updateInput({filters:t})}),[o,t]),Object(n.useEffect)((()=>{if(null!=o&&null!=s&&null!=e){const t={from:new Date(s).toISOString(),to:new Date(e).toISOString()};o.updateInput({timeRange:t})}}),[o,s,e]),c?null:i.a.createElement(Co,null,i.a.createElement(Mo,{title:Ao},i.a.createElement(_.EuiText,{size:"xs"},i.a.createElement(_.EuiLink,{href:`${T.docLinks.links.siem.networkMap}`,target:"_blank"},qo))),i.a.createElement(wo.a,{node:E},i.a.createElement(Dl,null)),i.a.createElement(Fl,{maintainRatio:!d},d?i.a.createElement(El,{"data-test-subj":"missing-prompt"}):null!=o?i.a.createElement(T.embeddable.EmbeddablePanel,{embeddable:o}):i.a.createElement(un.a,{"data-test-subj":"loading-panel",overlay:!0,size:"xl"})))};_l.displayName="EmbeddedMapComponent";const Nl=i.a.memo(_l);Nl.displayName="EmbeddedMap";const Ll=S.i18n.translate("xpack.securitySolution.networkKpiDns.errorSearchDescription",{defaultMessage:"An error has occurred on network kpi dns search"}),Bl=S.i18n.translate("xpack.securitySolution.networkKpiDns.failSearchDescription",{defaultMessage:"Failed to run search on network kpi dns"});var zl=a(60);const Hl=L()(_.EuiFlexGroup).withConfig({displayName:"FlexGroup",componentId:"sc-1sakt4o-0"})(["min-height:","px;"],228);Hl.displayName="FlexGroup";const Ul=i.a.memo((({fieldsMapping:e,data:t,id:a,loading:n=!1,from:r,to:s,narrowDateRange:o})=>{const l=Dr(e,t,a,r,s,o);return n?i.a.createElement(Hl,{justifyContent:"center",alignItems:"center"},i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(_.EuiLoadingSpinner,{size:"xl"}))):i.a.createElement(_.EuiFlexGroup,{wrap:!0},l.map((e=>i.a.createElement(Pr,e))))}),((e,t)=>e.fieldsMapping===t.fieldsMapping&&e.loading===t.loading&&e.id===t.id&&e.from===t.from&&e.to===t.to&&e.narrowDateRange===t.narrowDateRange&&Ki()(e.data,t.data)));Ul.displayName="NetworkKpiBaseComponent";const $l=Object(mr.a)(Ul),Ql=[{key:"dnsQueries",fields:[{key:"dnsQueries",value:null}],description:S.i18n.translate("xpack.securitySolution.kpiNetwork.dnsQueries.title",{defaultMessage:"DNS queries"})}],Vl=({filterQuery:e,from:t,indexNames:a,to:r,narrowDateRange:s,setQuery:o,skip:l})=>{const[c,{refetch:u,id:d,inspect:p,...f}]=(({filterQuery:e,endDate:t,indexNames:a,skip:i=!1,startDate:r})=>{const{data:s}=Object(m.j)().services,o=Object(n.useRef)(me.noop),l=Object(n.useRef)(new AbortController),c=Object(n.useRef)(new or.Subscription),[u,d]=Object(n.useState)(!1),[p,f]=Object(n.useState)(null),{getTransformChangesIfTheyExist:g}=Object(lr.a)(),[b,h]=Object(n.useState)({dnsQueries:0,id:"networkKpiDnsQuery",inspect:{dsl:[],response:[]},isInspected:!1,refetch:o.current}),{addError:y,addWarning:v}=Object(Oe.a)(),E=Object(n.useCallback)((e=>{if(null==e||i)return;const t=async()=>{l.current=new AbortController,d(!0),c.current=s.search.search(e,{strategy:"securitySolutionSearchStrategy",abortSignal:l.current.signal}).subscribe({next:e=>{Object(zl.isCompleteResponse)(e)?(d(!1),h((t=>({...t,dnsQueries:e.dnsQueries,inspect:Object(pr.b)(e,t.inspect),refetch:o.current}))),c.current.unsubscribe()):Object(zl.isErrorResponse)(e)&&(d(!1),v(Ll),c.current.unsubscribe())},error:e=>{d(!1),y(e,{title:Bl}),c.current.unsubscribe()}})};c.current.unsubscribe(),l.current.abort(),t(),o.current=t}),[s.search,y,v,i]);return Object(n.useEffect)((()=>{f((n=>{const{indices:i,factoryQueryType:s,timerange:o}=g({factoryQueryType:Bi.v.dns,indices:a,filterQuery:e,timerange:{interval:"12h",from:r,to:t}}),l={...null!=n?n:{},defaultIndex:i,factoryQueryType:s,filterQuery:Object(cr.a)(e),timerange:o};return Ki()(n,l)?n:l}))}),[a,t,e,r,g]),Object(n.useEffect)((()=>(E(p),()=>{c.current.unsubscribe(),l.current.abort()})),[p,E]),[u,b]})({filterQuery:e,endDate:r,indexNames:a,startDate:t,skip:l});return i.a.createElement($l,{data:f,id:d,inspect:p,loading:c,fieldsMapping:Ql,from:t,to:r,narrowDateRange:s,refetch:u,setQuery:o})},Wl=i.a.memo(Vl),Gl=S.i18n.translate("xpack.securitySolution.networkKpiNetworkEvents.errorSearchDescription",{defaultMessage:"An error has occurred on network kpi network events search"}),Kl=S.i18n.translate("xpack.securitySolution.networkKpiNetworkEvents.failSearchDescription",{defaultMessage:"Failed to run search on network kpi network events"}),Yl=S.i18n.translate("xpack.securitySolution.kpiNetwork.networkEvents.title",{defaultMessage:"Network events"}),Jl=[{key:"networkEvents",fields:[{key:"networkEvents",value:null,color:Object(_.euiPaletteColorBlind)()[1]}],description:Yl}],Xl=({filterQuery:e,from:t,indexNames:a,to:r,narrowDateRange:s,setQuery:o,skip:l})=>{const[c,{refetch:u,id:d,inspect:p,...f}]=(({filterQuery:e,endDate:t,indexNames:a,skip:i=!1,startDate:r})=>{const{data:s}=Object(m.j)().services,o=Object(n.useRef)(me.noop),l=Object(n.useRef)(new AbortController),c=Object(n.useRef)(new or.Subscription),[u,d]=Object(n.useState)(!1),[p,f]=Object(n.useState)(null),{getTransformChangesIfTheyExist:g}=Object(lr.a)(),[b,h]=Object(n.useState)({networkEvents:0,id:"networkKpiNetworkEventsQuery",inspect:{dsl:[],response:[]},isInspected:!1,refetch:o.current}),{addError:y,addWarning:v}=Object(Oe.a)(),E=Object(n.useCallback)((e=>{if(null==e||i)return;const t=async()=>{l.current=new AbortController,d(!0),c.current=s.search.search(e,{strategy:"securitySolutionSearchStrategy",abortSignal:l.current.signal}).subscribe({next:e=>{Object(zl.isCompleteResponse)(e)?(d(!1),h((t=>({...t,networkEvents:e.networkEvents,inspect:Object(pr.b)(e,t.inspect),refetch:o.current}))),c.current.unsubscribe()):Object(zl.isErrorResponse)(e)&&(d(!1),v(Gl),c.current.unsubscribe())},error:e=>{d(!1),y(e,{title:Kl}),c.current.unsubscribe()}})};c.current.unsubscribe(),l.current.abort(),t(),o.current=t}),[s.search,y,v,i]);return Object(n.useEffect)((()=>{f((n=>{const{indices:i,factoryQueryType:s,timerange:o}=g({factoryQueryType:Bi.v.networkEvents,indices:a,filterQuery:e,timerange:{interval:"12h",from:r,to:t}}),l={...null!=n?n:{},defaultIndex:i,factoryQueryType:s,filterQuery:Object(cr.a)(e),timerange:o};return Ki()(n,l)?n:l}))}),[a,t,e,r,g]),Object(n.useEffect)((()=>(E(p),()=>{c.current.unsubscribe(),l.current.abort()})),[p,E]),[u,b]})({filterQuery:e,endDate:r,indexNames:a,startDate:t,skip:l});return i.a.createElement($l,{data:f,id:d,inspect:p,loading:c,fieldsMapping:Jl,from:t,to:r,narrowDateRange:s,refetch:u,setQuery:o})},Zl=i.a.memo(Xl),ec=S.i18n.translate("xpack.securitySolution.networkKpiTlsHandshakes.errorSearchDescription",{defaultMessage:"An error has occurred on network kpi tls handshakes search"}),tc=S.i18n.translate("xpack.securitySolution.networkKpiTlsHandshakes.failSearchDescription",{defaultMessage:"Failed to run search on network kpi tls handshakes"}),ac=[{key:"tlsHandshakes",fields:[{key:"tlsHandshakes",value:null}],description:S.i18n.translate("xpack.securitySolution.kpiNetwork.tlsHandshakes.title",{defaultMessage:"TLS handshakes"})}],nc=({filterQuery:e,from:t,indexNames:a,to:r,narrowDateRange:s,setQuery:o,skip:l})=>{const[c,{refetch:u,id:d,inspect:p,...f}]=(({filterQuery:e,endDate:t,indexNames:a,skip:i=!1,startDate:r})=>{const{data:s}=Object(m.j)().services,o=Object(n.useRef)(me.noop),l=Object(n.useRef)(new AbortController),c=Object(n.useRef)(new or.Subscription),[u,d]=Object(n.useState)(!1),[p,f]=Object(n.useState)(null),{getTransformChangesIfTheyExist:g}=Object(lr.a)(),[b,h]=Object(n.useState)({tlsHandshakes:0,id:"networkKpiTlsHandshakesQuery",inspect:{dsl:[],response:[]},isInspected:!1,refetch:o.current}),{addError:y,addWarning:v}=Object(Oe.a)(),E=Object(n.useCallback)((e=>{if(null==e||i)return;const t=async()=>{l.current=new AbortController,d(!0),c.current=s.search.search(e,{strategy:"securitySolutionSearchStrategy",abortSignal:l.current.signal}).subscribe({next:e=>{Object(zl.isCompleteResponse)(e)?(d(!1),h((t=>({...t,tlsHandshakes:e.tlsHandshakes,inspect:Object(pr.b)(e,t.inspect),refetch:o.current}))),c.current.unsubscribe()):Object(zl.isErrorResponse)(e)&&(d(!1),v(ec),c.current.unsubscribe())},error:e=>{d(!1),y(e,{title:tc}),c.current.unsubscribe()}})};c.current.unsubscribe(),l.current.abort(),t(),o.current=t}),[s.search,y,v,i]);return Object(n.useEffect)((()=>{f((n=>{const{indices:i,factoryQueryType:s,timerange:o}=g({factoryQueryType:Bi.v.tlsHandshakes,indices:a,filterQuery:e,timerange:{interval:"12h",from:r,to:t}}),l={...null!=n?n:{},defaultIndex:i,factoryQueryType:s,filterQuery:Object(cr.a)(e),timerange:o};return Ki()(n,l)?n:l}))}),[a,t,e,r,g]),Object(n.useEffect)((()=>(E(p),()=>{c.current.unsubscribe(),l.current.abort()})),[p,E]),[u,b]})({filterQuery:e,endDate:r,indexNames:a,startDate:t,skip:l});return i.a.createElement($l,{data:f,id:d,inspect:p,loading:c,fieldsMapping:ac,from:t,to:r,narrowDateRange:s,refetch:u,setQuery:o})},ic=i.a.memo(nc),rc=S.i18n.translate("xpack.securitySolution.networkKpiUniqueFlows.errorSearchDescription",{defaultMessage:"An error has occurred on network kpi unique flows search"}),sc=S.i18n.translate("xpack.securitySolution.networkKpiUniqueFlows.failSearchDescription",{defaultMessage:"Failed to run search on network kpi unique flows"}),oc=[{key:"uniqueFlowId",fields:[{key:"uniqueFlowId",value:null}],description:S.i18n.translate("xpack.securitySolution.kpiNetwork.uniqueFlowIds.title",{defaultMessage:"Unique flow IDs"})}],lc=({filterQuery:e,from:t,indexNames:a,to:r,narrowDateRange:s,setQuery:o,skip:l})=>{const[c,{refetch:u,id:d,inspect:p,...f}]=(({filterQuery:e,endDate:t,indexNames:a,skip:i=!1,startDate:r})=>{const{data:s}=Object(m.j)().services,o=Object(n.useRef)(me.noop),l=Object(n.useRef)(new AbortController),c=Object(n.useRef)(new or.Subscription),[u,d]=Object(n.useState)(!1),[p,f]=Object(n.useState)(null),[g,b]=Object(n.useState)({uniqueFlowId:0,id:"networkKpiUniqueFlowsQuery",inspect:{dsl:[],response:[]},isInspected:!1,refetch:o.current}),{addError:h,addWarning:y}=Object(Oe.a)(),v=Object(n.useCallback)((e=>{if(null==e||i)return;const t=async()=>{l.current=new AbortController,d(!0),c.current=s.search.search(e,{strategy:"securitySolutionSearchStrategy",abortSignal:l.current.signal}).subscribe({next:e=>{Object(zl.isCompleteResponse)(e)?(d(!1),b((t=>({...t,uniqueFlowId:e.uniqueFlowId,inspect:Object(pr.b)(e,t.inspect),refetch:o.current}))),c.current.unsubscribe()):Object(zl.isErrorResponse)(e)&&(d(!1),y(rc),c.current.unsubscribe())},error:e=>{d(!1),h(e,{title:sc}),c.current.unsubscribe()}})};c.current.unsubscribe(),l.current.abort(),t(),o.current=t}),[s.search,h,y,i]);return Object(n.useEffect)((()=>{f((n=>{const i={...null!=n?n:{},defaultIndex:a,factoryQueryType:Bi.v.uniqueFlows,filterQuery:Object(cr.a)(e),timerange:{interval:"12h",from:r,to:t}};return Ki()(n,i)?n:i}))}),[a,t,e,r]),Object(n.useEffect)((()=>(v(p),()=>{c.current.unsubscribe(),l.current.abort()})),[p,v]),[u,g]})({filterQuery:e,endDate:r,indexNames:a,startDate:t,skip:l});return i.a.createElement($l,{data:f,id:d,inspect:p,loading:c,fieldsMapping:oc,from:t,to:r,narrowDateRange:s,refetch:u,setQuery:o})},cc=i.a.memo(lc),uc=S.i18n.translate("xpack.securitySolution.networkKpiUniquePrivateIps.errorSearchDescription",{defaultMessage:"An error has occurred on network kpi unique private ips search"}),dc=S.i18n.translate("xpack.securitySolution.networkKpiUniquePrivateIps.failSearchDescription",{defaultMessage:"Failed to run search on network kpi unique private ips"}),pc=S.i18n.translate("xpack.securitySolution.kpiNetwork.uniquePrivateIps.title",{defaultMessage:"Unique private IPs"}),mc=S.i18n.translate("xpack.securitySolution.kpiNetwork.uniquePrivateIps.sourceUnitLabel",{defaultMessage:"source"}),fc=S.i18n.translate("xpack.securitySolution.kpiNetwork.uniquePrivateIps.destinationUnitLabel",{defaultMessage:"destination"}),gc=S.i18n.translate("xpack.securitySolution.kpiNetwork.uniquePrivateIps.sourceChartLabel",{defaultMessage:"Src."}),bc=S.i18n.translate("xpack.securitySolution.kpiNetwork.uniquePrivateIps.destinationChartLabel",{defaultMessage:"Dest."}),hc=Object(_.euiPaletteColorBlind)(),yc=[{key:"UniqueIps",fields:[{key:"uniqueSourcePrivateIps",value:null,name:gc,description:mc,color:hc[2],icon:"visMapCoordinate"},{key:"uniqueDestinationPrivateIps",value:null,name:bc,description:fc,color:hc[3],icon:"visMapCoordinate"}],description:pc,enableAreaChart:!0,enableBarChart:!0}],vc=({filterQuery:e,from:t,indexNames:a,to:r,narrowDateRange:s,setQuery:o,skip:l})=>{const[c,{refetch:u,id:d,inspect:p,...f}]=(({filterQuery:e,endDate:t,indexNames:a,skip:i=!1,startDate:r})=>{const{data:s}=Object(m.j)().services,o=Object(n.useRef)(me.noop),l=Object(n.useRef)(new AbortController),c=Object(n.useRef)(new or.Subscription),[u,d]=Object(n.useState)(!1),[p,f]=Object(n.useState)(null),{getTransformChangesIfTheyExist:g}=Object(lr.a)(),[b,h]=Object(n.useState)({uniqueDestinationPrivateIps:0,uniqueDestinationPrivateIpsHistogram:null,uniqueSourcePrivateIps:0,uniqueSourcePrivateIpsHistogram:null,id:"networkKpiUniquePrivateIpsQuery",inspect:{dsl:[],response:[]},isInspected:!1,refetch:o.current}),{addError:y,addWarning:v}=Object(Oe.a)(),E=Object(n.useCallback)((e=>{if(null==e||i)return;const t=async()=>{l.current=new AbortController,d(!0),c.current=s.search.search(e,{strategy:"securitySolutionSearchStrategy",abortSignal:l.current.signal}).subscribe({next:e=>{Object(zl.isCompleteResponse)(e)?(d(!1),h((t=>({...t,uniqueDestinationPrivateIps:e.uniqueDestinationPrivateIps,uniqueDestinationPrivateIpsHistogram:e.uniqueDestinationPrivateIpsHistogram,uniqueSourcePrivateIps:e.uniqueSourcePrivateIps,uniqueSourcePrivateIpsHistogram:e.uniqueSourcePrivateIpsHistogram,inspect:Object(pr.b)(e,t.inspect),refetch:o.current}))),c.current.unsubscribe()):Object(zl.isErrorResponse)(e)&&(d(!1),v(uc),c.current.unsubscribe())},error:e=>{d(!1),y(e,{title:dc}),c.current.unsubscribe()}})};c.current.unsubscribe(),l.current.abort(),t(),o.current=t}),[s.search,y,v,i]);return Object(n.useEffect)((()=>{f((n=>{const{indices:i,factoryQueryType:s,timerange:o}=g({factoryQueryType:Bi.v.uniquePrivateIps,indices:a,filterQuery:e,timerange:{interval:"12h",from:r,to:t}}),l={...null!=n?n:{},defaultIndex:i,factoryQueryType:s,filterQuery:Object(cr.a)(e),timerange:o};return Ki()(n,l)?n:l}))}),[a,t,e,r,g]),Object(n.useEffect)((()=>(E(p),()=>{c.current.unsubscribe(),l.current.abort()})),[p,E]),[u,b]})({filterQuery:e,endDate:r,indexNames:a,startDate:t,skip:l});return i.a.createElement($l,{data:f,id:d,inspect:p,loading:c,fieldsMapping:yc,from:t,to:r,narrowDateRange:s,refetch:u,setQuery:o})},Ec=i.a.memo(vc),Tc=i.a.memo((({filterQuery:e,from:t,indexNames:a,to:n,setQuery:r,skip:s,narrowDateRange:o})=>i.a.createElement(_.EuiFlexGroup,{wrap:!0},i.a.createElement(_.EuiFlexItem,{grow:1},i.a.createElement(_.EuiFlexGroup,{wrap:!0},i.a.createElement(_.EuiFlexItem,null,i.a.createElement(Zl,{filterQuery:e,from:t,indexNames:a,to:n,narrowDateRange:o,setQuery:r,skip:s})),i.a.createElement(_.EuiFlexItem,null,i.a.createElement(Wl,{filterQuery:e,from:t,indexNames:a,to:n,narrowDateRange:o,setQuery:r,skip:s}))),i.a.createElement(_.EuiSpacer,{size:"l"}),i.a.createElement(_.EuiFlexGroup,{wrap:!0},i.a.createElement(_.EuiFlexItem,null,i.a.createElement(cc,{filterQuery:e,from:t,indexNames:a,to:n,narrowDateRange:o,setQuery:r,skip:s})),i.a.createElement(_.EuiFlexItem,null,i.a.createElement(ic,{filterQuery:e,from:t,indexNames:a,to:n,narrowDateRange:o,setQuery:r,skip:s})))),i.a.createElement(_.EuiFlexItem,{grow:1},i.a.createElement(Ec,{filterQuery:e,from:t,indexNames:a,to:n,narrowDateRange:o,setQuery:r,skip:s})))));Tc.displayName="NetworkKpiComponent";var kc=a(121),xc=a(27),Sc=a(776),wc=a(798);const Oc=Object(mr.a)(Sc.a),jc=({endDate:e,filterQuery:t,indexNames:a,skip:n,startDate:r,setQuery:s,flowTarget:o})=>{const[l,{id:c,inspect:u,isInspected:d,loadPage:p,networkTopNFlow:m,pageInfo:f,refetch:g,totalCount:b}]=Object(wc.a)({endDate:e,flowTarget:o,filterQuery:t,indexNames:a,skip:n,startDate:r,type:kc.c.NetworkType.page});return i.a.createElement(Oc,{data:m,fakeTotalCount:Object(me.getOr)(50,"fakeTotalCount",f),flowTargeted:o,id:c,inspect:u,isInspect:d,loading:l,loadPage:p,refetch:g,setQuery:s,showMorePagesIndicator:Object(me.getOr)(!1,"showMorePagesIndicator",f),totalCount:b,type:kc.c.NetworkType.page})};jc.displayName="IPsQueryTabBody";var Cc=a(775),Ic=a(797);const Mc=Object(mr.a)(Cc.a),Ac=({endDate:e,filterQuery:t,indexNames:a,skip:n,startDate:r,setQuery:s,indexPattern:o,flowTarget:l})=>{const[c,{id:u,inspect:d,isInspected:p,loadPage:m,networkTopCountries:f,pageInfo:g,refetch:b,totalCount:h}]=Object(Ic.a)({endDate:e,flowTarget:l,filterQuery:t,indexNames:a,skip:n,startDate:r,type:kc.c.NetworkType.page});return i.a.createElement(Mc,{data:f,fakeTotalCount:Object(me.getOr)(50,"fakeTotalCount",g),flowTargeted:l,id:u,indexPattern:o,inspect:d,isInspect:p,loading:c,loadPage:m,refetch:b,setQuery:s,showMorePagesIndicator:Object(me.getOr)(!1,"showMorePagesIndicator",g),totalCount:h,type:kc.c.NetworkType.page})};Ac.displayName="CountriesQueryTabBody";var qc=a(774),Dc=a(796);const Pc=Object(mr.a)(qc.a),Rc=({endDate:e,filterQuery:t,indexNames:a,skip:n,startDate:r,setQuery:s})=>{const[o,{id:l,inspect:c,isInspected:u,loadPage:d,networkHttp:p,pageInfo:m,refetch:f,totalCount:g}]=Object(Dc.a)({endDate:e,filterQuery:t,indexNames:a,skip:n,startDate:r,type:kc.c.NetworkType.page});return i.a.createElement(Pc,{data:p,fakeTotalCount:Object(me.getOr)(50,"fakeTotalCount",m),id:l,inspect:c,isInspect:u,loading:o,loadPage:d,refetch:f,setQuery:s,showMorePagesIndicator:Object(me.getOr)(!1,"showMorePagesIndicator",m),totalCount:g,type:kc.c.NetworkType.page})};Rc.displayName="HttpQueryTabBody";var Fc=a(757),_c=a(186),Nc=a(147),Lc=a(113),Bc=a(294),zc=a(150);const Hc=S.i18n.translate("xpack.securitySolution.networkDnsTable.title",{defaultMessage:"Top DNS domains"}),Uc=e=>S.i18n.translate("xpack.securitySolution.networkDnsTable.unit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {domain} other {domains}}"}),$c=S.i18n.translate("xpack.securitySolution.networkDnsTable.helperTooltip",{defaultMessage:"This shows DNS protocol traffic only and can be useful for hunting domains used in DNS data exfiltration."}),Qc=S.i18n.translate("xpack.securitySolution.networkDnsTable.column.registeredDomain",{defaultMessage:"Registered domain"}),Vc=S.i18n.translate("xpack.securitySolution.networkDnsTable.column.TotalQueriesTitle",{defaultMessage:"Total queries"}),Wc=S.i18n.translate("xpack.securitySolution.networkDnsTable.column.uniqueDomainsTitle",{defaultMessage:"Unique domains"}),Gc=S.i18n.translate("xpack.securitySolution.networkDnsTable.column.bytesInTitle",{defaultMessage:"DNS bytes in"}),Kc=S.i18n.translate("xpack.securitySolution.networkDnsTable.column.bytesOutTitle",{defaultMessage:"DNS bytes out"}),Yc=S.i18n.translate("xpack.securitySolution.networkDnsTable.select.includePtrRecords",{defaultMessage:"Include PTR records"}),Jc=S.i18n.translate("xpack.securitySolution.networkDnsTable.rows",{values:{numRows:5},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),Xc=S.i18n.translate("xpack.securitySolution.networkDnsTable.rows",{values:{numRows:10},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),Zc=i.a.memo((({isPtrIncluded:e,onChange:t})=>i.a.createElement(_.EuiSwitch,{name:"switch-ptr-included",label:Yc,checked:e,onChange:t})));Zc.displayName="IsPtrIncluded";const eu=kc.c.NetworkTableType.dns,tu=[{text:Jc,numberOfRow:5},{text:Xc,numberOfRow:10}],au=({data:e,fakeTotalCount:t,id:a,isInspect:r,loading:s,loadPage:o,showMorePagesIndicator:l,totalCount:c,type:u})=>{const d=Object(b.useDispatch)(),p=Object(n.useMemo)((()=>kc.e.dnsSelector()),[]),{activePage:m,isPtrIncluded:f,limit:g,sort:h}=Object(be.a)(p),y=Object(n.useCallback)((e=>d(kc.b.updateNetworkTable({networkType:u,tableType:eu,updates:{limit:e}}))),[u,d]),v=Object(n.useCallback)((e=>d(kc.b.updateNetworkTable({networkType:u,tableType:eu,updates:{activePage:e}}))),[d,u]),E=Object(n.useCallback)((e=>{if(null!=e.sort){const t={field:e.sort.field.split(".")[1],direction:e.sort.direction};Ki()(t,h)||d(kc.b.updateNetworkTable({networkType:u,tableType:eu,updates:{sort:t}}))}}),[h,u,d]),T=Object(n.useCallback)((()=>d(kc.b.updateNetworkTable({networkType:u,tableType:eu,updates:{isPtrIncluded:!f}}))),[d,u,f]),k=Object(n.useMemo)((()=>[{field:`node.${Bi.t.dnsName}`,name:Qc,truncateText:!1,hideForMobile:!1,sortable:!0,render:e=>{if(null!=e){const t=Object(Ss.h)(`networkDns-table--name-${e}`);return i.a.createElement(Nc.b,{key:t,dataProvider:{and:[],enabled:!0,id:t,name:e,excluded:!1,kqlQuery:"",queryMatch:{field:"dns.question.registered_domain",value:e,operator:Lc.c}},render:(t,a,n)=>n.isDragging?i.a.createElement(Nc.a,null,i.a.createElement(zc.a,{dataProvider:t})):Object(wr.a)(e)})}return Object(wr.d)()}},{align:"right",field:`node.${Bi.t.queryCount}`,name:Vc,sortable:!0,truncateText:!1,hideForMobile:!1,render:e=>null!=e?ze()(e).format("0"):Object(wr.d)()},{align:"right",field:`node.${Bi.t.uniqueDomains}`,name:Wc,sortable:!0,truncateText:!1,hideForMobile:!1,render:e=>null!=e?ze()(e).format("0"):Object(wr.d)()},{align:"right",field:`node.${Bi.t.dnsBytesIn}`,name:Gc,sortable:!0,truncateText:!1,hideForMobile:!1,render:e=>null!=e?i.a.createElement(Bc.a,{value:e}):Object(wr.d)()},{align:"right",field:`node.${Bi.t.dnsBytesOut}`,name:Kc,sortable:!0,truncateText:!1,hideForMobile:!1,render:e=>null!=e?i.a.createElement(Bc.a,{value:e}):Object(wr.d)()}]),[]),x=Object(n.useMemo)((()=>({field:`node.${h.field}`,direction:h.direction})),[h.direction,h.field]),S=Object(n.useMemo)((()=>i.a.createElement(Zc,{isPtrIncluded:f,onChange:T})),[f,T]);return i.a.createElement(_c.a,{activePage:m,columns:k,dataTestSubj:`table-${eu}`,headerCount:c,headerSupplement:S,headerTitle:Hc,headerTooltip:$c,headerUnit:Uc(c),id:a,itemsPerRow:tu,isInspect:r,limit:g,loading:s,loadPage:o,onChange:E,pageOfItems:e,showMorePagesIndicator:l,sorting:x,totalCount:t,updateActivePage:v,updateLimitPagination:y})};au.displayName="NetworkDnsTableComponent";const nu=i.a.memo(au);var iu=a(174);const ru=S.i18n.translate("xpack.securitySolution.networkDns.errorSearchDescription",{defaultMessage:"An error has occurred on network dns search"}),su=S.i18n.translate("xpack.securitySolution.networkDns.failSearchDescription",{defaultMessage:"Failed to run search on network dns"});var ou,lu=a(385),cu=a(280),uu=a(28);const du="networkDnsHistogramQuery",pu=Object(mr.a)(nu),mu=[{text:"dns.question.registered_domain",value:"dns.question.registered_domain"}],fu={defaultStackByOption:null!==(ou=mu.find((e=>"dns.question.registered_domain"===e.text)))&&void 0!==ou?ou:mu[0],errorMessage:lu.b,histogramType:uu.k.dns,stackByOptions:mu,subtitle:void 0},gu=({deleteQuery:e,docValueFields:t,endDate:a,filterQuery:r,indexNames:s,skip:o,startDate:l,setQuery:c,type:u})=>{const d=kc.e.dnsSelector(),p=Object(be.b)((e=>d(e).isPtrIncluded));Object(n.useEffect)((()=>()=>{e&&e({id:du})}),[e]);const[f,{totalCount:g,networkDns:b,pageInfo:h,loadPage:y,id:v,inspect:E,isInspected:T,refetch:k}]=(({docValueFields:e,endDate:t,filterQuery:a,indexNames:i,skip:r,startDate:s,type:o})=>{const l=Object(n.useMemo)((()=>kc.e.dnsSelector()),[]),{activePage:c,sort:u,isPtrIncluded:d,limit:p}=Object(be.a)(l),{data:f}=Object(m.j)().services,g=Object(n.useRef)(me.noop),b=Object(n.useRef)(new AbortController),h=Object(n.useRef)(new or.Subscription),[y,v]=Object(n.useState)(!1),[E,T]=Object(n.useState)(null),k=Object(n.useCallback)((e=>{T((t=>t?{...t,pagination:Object(iu.a)(e,p)}:t))}),[p]),[x,S]=Object(n.useState)({networkDns:[],histogram:[],id:"networkDnsQuery",inspect:{dsl:[],response:[]},isInspected:!1,loadPage:k,pageInfo:{activePage:0,fakeTotalCount:0,showMorePagesIndicator:!1},refetch:g.current,totalCount:-1}),{addError:w,addWarning:O}=Object(Oe.a)(),j=Object(n.useCallback)((e=>{if(null==e||r)return;const t=async()=>{b.current=new AbortController,v(!0),h.current=f.search.search(e,{strategy:"securitySolutionSearchStrategy",abortSignal:b.current.signal}).subscribe({next:e=>{Object(zl.isCompleteResponse)(e)?(v(!1),S((t=>{var a;return{...t,networkDns:e.edges,inspect:Object(pr.b)(e,t.inspect),pageInfo:e.pageInfo,refetch:g.current,totalCount:e.totalCount,histogram:null!==(a=e.histogram)&&void 0!==a?a:t.histogram}})),h.current.unsubscribe()):Object(zl.isErrorResponse)(e)&&(v(!1),O(ru),h.current.unsubscribe())},error:e=>{v(!1),w(e,{title:su}),h.current.unsubscribe()}})};h.current.unsubscribe(),b.current.abort(),t(),g.current=t}),[f.search,w,O,r]);return Object(n.useEffect)((()=>{T((n=>{const r={...null!=n?n:{},defaultIndex:i,docValueFields:null!=e?e:[],isPtrIncluded:d,factoryQueryType:Bi.w.dns,filterQuery:Object(cr.a)(a),pagination:Object(iu.a)(c,p,!0),sort:u,timerange:{interval:"12h",from:s,to:t}};return Ki()(n,r)?n:r}))}),[c,i,t,a,p,s,u,d,e]),Object(n.useEffect)((()=>(j(E),()=>{h.current.unsubscribe(),b.current.abort()})),[E,j]),[y,x]})({docValueFields:null!=t?t:[],endDate:a,filterQuery:r,indexNames:s,skip:o,startDate:l,type:u}),x=Object(n.useCallback)((e=>lu.a(e.text)),[]),S=Object(n.useMemo)((()=>({...fu,title:x})),[x]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(cu.a,F()({id:du,isPtrIncluded:p,docValueFields:t,endDate:a,filterQuery:r,indexNames:s,setQuery:c,showLegend:!0,startDate:l},S)),i.a.createElement(pu,{data:b,fakeTotalCount:Object(me.getOr)(50,"fakeTotalCount",h),id:v,inspect:E,isInspect:T,loading:f,loadPage:y,refetch:k,setQuery:c,showMorePagesIndicator:Object(me.getOr)(!1,"showMorePagesIndicator",h),totalCount:g,type:u}))};gu.displayName="DnsQueryTabBodyComponent";const bu=i.a.memo(gu);var hu=a(687),yu=a(301),vu=a(799),Eu=a(777);const Tu=Object(mr.a)(Eu.a),ku=({endDate:e,filterQuery:t,flowTarget:a,indexNames:n,ip:r="",setQuery:s,skip:o,startDate:l,type:c})=>{const[u,{id:d,inspect:p,isInspected:m,tls:f,totalCount:g,pageInfo:b,loadPage:h,refetch:y}]=Object(vu.a)({endDate:e,filterQuery:t,flowTarget:a,indexNames:n,ip:r,skip:o,startDate:l,type:c});return i.a.createElement(Tu,{data:f,id:d,inspect:p,isInspect:m,fakeTotalCount:Object(me.getOr)(50,"fakeTotalCount",b),loading:u,loadPage:h,showMorePagesIndicator:Object(me.getOr)(!1,"showMorePagesIndicator",b),refetch:y,setQuery:s,totalCount:g,type:c})};ku.displayName="TlsQueryTabBodyComponent";const xu=i.a.memo(ku);var Su=a(795);const wu=[{query:{bool:{filter:[{bool:{should:[{bool:{should:[{exists:{field:"source.ip"}}],minimum_should_match:1}},{bool:{should:[{exists:{field:"destination.ip"}}],minimum_should_match:1}}],minimum_should_match:1}}]}},meta:{alias:"",disabled:!1,key:"bool",negate:!1,type:"custom",value:'{"bool":{"filter":[{"bool":{"should":[{"bool":{"should":[{"exists":{"field": "source.ip"}}],"minimum_should_match":1}},{"bool":{"should":[{"exists":{"field": "destination.ip"}}],"minimum_should_match":1}}],"minimum_should_match":1}}]}}'}}],Ou=i.a.memo((e=>i.a.createElement(Su.a,F()({entityType:"events",timelineId:h.q.networkPageExternalAlerts},e,{pageFilters:wu}))));Ou.displayName="NetworkAlertsQueryTabBody";const ju=i.a.memo((({docValueFields:e,type:t,to:a,filterQuery:r,isInitializing:s,from:c,indexPattern:u,indexNames:d,setQuery:p,setAbsoluteRangeDatePicker:m})=>{const f=Object(n.useCallback)(((e,t)=>{const a=Object(Vi.a)(e,t);m({id:"global",from:a.from,to:a.to})}),[m]),g=Object(n.useCallback)((({x:e})=>{if(!e)return;const[t,a]=e;m({id:"global",from:new Date(t).toISOString(),to:new Date(a).toISOString()})}),[m]),b={startDate:c,endDate:a,indexNames:d,skip:s,type:t,narrowDateRange:f,setQuery:p,filterQuery:r},h={...b,indexPattern:u,updateDateRange:g},y={...b,anomaliesFilterQuery:{bool:{should:[{exists:{field:"source.ip"}},{exists:{field:"destination.ip"}}],minimum_should_match:1}},AnomaliesTableComponent:Fc.a};return i.a.createElement(l.Switch,null,i.a.createElement(l.Route,{path:`${o.wb}/:tabName(${yu.a.dns})`},i.a.createElement(bu,F()({},h,{docValueFields:e}))),i.a.createElement(l.Route,{path:`${o.wb}/:tabName(${yu.a.flows})`},i.a.createElement(i.a.Fragment,null,i.a.createElement(hu.a,{direction:"column"},i.a.createElement(_.EuiFlexItem,null,i.a.createElement(jc,F()({},h,{flowTarget:xc.b.source}))),i.a.createElement(_.EuiFlexItem,null,i.a.createElement(jc,F()({},h,{flowTarget:xc.b.destination})))),i.a.createElement(_.EuiSpacer,null),i.a.createElement(hu.a,{direction:"column"},i.a.createElement(_.EuiFlexItem,null,i.a.createElement(Ac,F()({},h,{flowTarget:xc.b.source}))),i.a.createElement(_.EuiFlexItem,null,i.a.createElement(Ac,F()({},h,{flowTarget:xc.b.destination})))))),i.a.createElement(l.Route,{path:`${o.wb}/:tabName(${yu.a.http})`},i.a.createElement(Rc,h)),i.a.createElement(l.Route,{path:`${o.wb}/:tabName(${yu.a.tls})`},i.a.createElement(xu,F()({},h,{flowTarget:xc.b.source}))),i.a.createElement(l.Route,{path:`${o.wb}/:tabName(${yu.a.anomalies})`},i.a.createElement(gs.a,F()({},y,{AnomaliesTableComponent:Fc.a}))),i.a.createElement(l.Route,{path:`${o.wb}/:tabName(${yu.a.alerts})`},i.a.createElement(Ou,h)))}));ju.displayName="NetworkRoutes";const Cu=L()(_.EuiFlexGroup).withConfig({displayName:"FlexGroup",componentId:"sc-1sbaj97-0"})(["min-height:200px;"]);Cu.displayName="FlexGroup";const Iu=()=>i.a.createElement(Cu,{justifyContent:"center",alignItems:"center"},i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(_.EuiLoadingSpinner,{size:"xl"})));Iu.displayName="NetworkRoutesLoading";const Mu=e=>`${o.wb}/${e}`,Au=e=>{const t={[yu.a.flows]:{id:yu.a.flows,name:lu.f,href:Mu(yu.a.flows),disabled:!1},[yu.a.dns]:{id:yu.a.dns,name:lu.e,href:Mu(yu.a.dns),disabled:!1},[yu.a.http]:{id:yu.a.http,name:lu.g,href:Mu(yu.a.http),disabled:!1},[yu.a.tls]:{id:yu.a.tls,name:lu.h,href:Mu(yu.a.tls),disabled:!1},[yu.a.anomalies]:{id:yu.a.anomalies,name:lu.d,href:Mu(yu.a.anomalies),disabled:!1},[yu.a.alerts]:{id:yu.a.alerts,name:lu.c,href:Mu(yu.a.alerts),disabled:!1}};return e?t:Object(me.omit)([yu.a.anomalies],t)},qu=L.a.div.withConfig({displayName:"StyledFullHeightContainer",componentId:"sc-5donvf-0"})(["display:flex;flex-direction:column;flex:1 1 auto;"]),Du=i.a.memo((({hasMlUserPermissions:e,capabilitiesFetched:t})=>{const a=Object(b.useDispatch)(),r=Object(n.useRef)(null),o=Object(n.useMemo)((()=>y.b.getTimelineByIdSelector()),[]),c=Object(be.b)((e=>{var t;return(null!==(t=o(e,h.q.networkPageExternalAlerts))&&void 0!==t?t:Re.a).graphEventId})),p=Object(n.useMemo)((()=>Ie.e.globalFiltersQuerySelector()),[]),f=Object(n.useMemo)((()=>Ie.e.globalQuerySelector()),[]),g=Object(be.a)(f),E=Object(be.a)(p),{to:T,from:k,setQuery:x,isInitializing:S}=Object(he.a)(),{globalFullScreen:w}=Object(Ut.a)(),O=Object(m.j)(),{tabName:j}=Object(l.useParams)(),C=Object(n.useMemo)((()=>j===yu.a.alerts?E.length>0?[...E,...wu]:wu:E),[j,E]),I=Object(n.useCallback)((({x:e})=>{if(!e)return;const[t,n]=e;a(Object(ke.setAbsoluteRangeDatePicker)({id:"global",from:new Date(t).toISOString(),to:new Date(n).toISOString()}))}),[a]),{docValueFields:M,indicesExist:A,indexPattern:q,selectedPatterns:D}=Object(v.c)(),P=Object(n.useCallback)((()=>{var e,t;null===(e=r.current)||void 0===e||null===(t=e.querySelector(".inspectButtonComponent:last-of-type"))||void 0===t||t.focus()}),[r]),R=Object(n.useCallback)((()=>{Object(Pe.m)()}),[]),F=Object(n.useCallback)((e=>{Object(ge.isTab)(e)&&Object(Pe.l)({containerElement:r.current,keyboardEvent:e,onSkipFocusBeforeEventsTable:P,onSkipFocusAfterEventsTable:R})}),[r,P,R]),[N,L]=Object(ps.b)({config:xe.esQuery.getEsQueryConfig(O.services.uiSettings),indexPattern:q,queries:[g],filters:E}),[B]=Object(ps.b)({config:xe.esQuery.getEsQueryConfig(O.services.uiSettings),indexPattern:q,queries:[g],filters:C});return Object(je.a)({id:"NetworkQueryId",filterQuery:N,kqlError:L,query:g,startDate:k,endDate:T}),i.a.createElement(i.a.Fragment,null,A?i.a.createElement(qu,{onKeyDown:F,ref:r},i.a.createElement(_.EuiWindowEvent,{event:"resize",handler:me.noop}),i.a.createElement(ye.a,{show:Object(Pe.n)({globalFullScreen:w,graphEventId:c})},i.a.createElement(Ee.a,{indexPattern:q,id:"global"})),i.a.createElement(d.a,{noPadding:w},i.a.createElement($t,{show:!w},i.a.createElement(Q.a,{subtitle:i.a.createElement(zi.a,{docValueFields:M,indexKey:Bi.n.network,indexNames:D}),title:lu.i,border:!0}),i.a.createElement(Nl,{query:g,filters:E,startDate:k,endDate:T,setQuery:x}),i.a.createElement(_.EuiSpacer,null),i.a.createElement(Tc,{filterQuery:N,from:k,indexNames:D,narrowDateRange:I,setQuery:x,skip:S||void 0===N,to:T})),t&&!S?i.a.createElement(i.a.Fragment,null,i.a.createElement($t,{show:!w},i.a.createElement(_.EuiSpacer,null),i.a.createElement(sr,{navTabs:Au(e)}),i.a.createElement(_.EuiSpacer,null)),i.a.createElement(ju,{docValueFields:M,filterQuery:B,from:k,isInitializing:S,indexPattern:q,indexNames:D,setQuery:x,setAbsoluteRangeDatePicker:ke.setAbsoluteRangeDatePicker,type:kc.c.NetworkType.page,to:T})):i.a.createElement(Iu,null))):i.a.createElement(d.a,null,i.a.createElement(pt.a,null)),i.a.createElement(u.a,{pageName:s.a.network}))}));Du.displayName="NetworkComponent";const Pu=i.a.memo(Du),Ru=i.a.memo((()=>{const{path:e}=Object(l.useRouteMatch)();return i.a.createElement(l.Switch,null,i.a.createElement(l.Route,{strict:!0,exact:!0,path:e,render:({location:e})=>{const t=Object(Vs.parse)(e.search.substring(1),{sort:!1});null!=t.query&&(t.query=io(t.query));const a=Object(Vs.stringify)(lo.url.encodeQuery(t),{sort:!1,encode:!1});return i.a.createElement(l.Redirect,{to:`${o.wb}?${a}`})}}),i.a.createElement(l.Route,{path:`${e}/ip/:ip`,render:({location:e,match:{params:{ip:t}}})=>{const a=Object(Vs.parse)(e.search.substring(1),{sort:!1});if(null!=a.query&&(a.query=io(a.query)),ro(t)){const e=Object(Vs.stringify)(lo.url.encodeQuery(a),{sort:!1,encode:!1});return i.a.createElement(l.Redirect,{to:`${o.wb}?${e}`})}if(so(t)){const e=oo(t);a.query=Xs(["source.ip","destination.ip"],e,a.query||"");const n=Object(Vs.stringify)(lo.url.encodeQuery(a),{sort:!1,encode:!1});return i.a.createElement(l.Redirect,{to:`${o.wb}?${n}`})}{const e=Object(Vs.stringify)(lo.url.encodeQuery(a),{sort:!1,encode:!1});return i.a.createElement(l.Redirect,{to:`${o.wb}/ip/${t}?${e}`})}}}),i.a.createElement(l.Route,{path:`${o.wb}/ml-network/`,render:({location:{search:e=""}})=>i.a.createElement(l.Redirect,{from:`${o.wb}/ml-network/`,to:{pathname:`${o.wb}/ml-network`,search:e}})}))}));Ru.displayName="MlNetworkConditionalContainer";const Fu=`${o.wb}/ip/:detailName`,_u=()=>{const e=Object(Qi.a)(),t=e.capabilitiesFetched,a=Object(n.useMemo)((()=>Object($i.a)(e)),[e]),r=Object(n.useMemo)((()=>((e,t)=>e&&!t?`${o.wb}/:tabName(${yu.a.flows}|${yu.a.dns}|${yu.a.http}|${yu.a.tls}|${yu.a.alerts})`:`${o.wb}/:tabName(${yu.a.flows}|${yu.a.dns}|${yu.a.anomalies}|${yu.a.http}|${yu.a.tls}|${yu.a.alerts})`)(t,a)),[t,a]);return i.a.createElement(l.Switch,null,i.a.createElement(l.Route,{exact:!0,strict:!0,path:o.wb,render:({location:{search:e=""}})=>i.a.createElement(l.Redirect,{to:{pathname:`${o.wb}/${yu.a.flows}`,search:e}})}),i.a.createElement(l.Route,{path:`${o.wb}/ml-network`},i.a.createElement(Ru,null)),i.a.createElement(l.Route,{strict:!0,path:r},i.a.createElement(Pu,{capabilitiesFetched:e.capabilitiesFetched,hasMlUserPermissions:a})),i.a.createElement(l.Route,{path:`${Fu}/:flowTarget`},i.a.createElement(So.a,null)),i.a.createElement(l.Route,{path:Fu,render:({location:{search:e=""},match:{params:{detailName:t}}})=>i.a.createElement(l.Redirect,{to:{pathname:`${o.wb}/ip/${t}/${Bi.f.source}`,search:e}})}))},Nu=i.a.memo(_u),Lu=[{path:o.wb,render:()=>i.a.createElement(r.TrackApplicationView,{viewId:s.a.network},i.a.createElement(Nu,null))}];var Bu=a(194),zu=a(47);const Hu=L.a.div.withConfig({displayName:"Display",componentId:"sc-1hfh11-0"})(["",";"],(({show:e})=>e?"":"display: none;"));Hu.displayName="Display";var Uu=a(185);const $u=S.i18n.translate("xpack.securitySolution.hostRules.errorSearchDescription",{defaultMessage:"An error has occurred on risk score search"}),Qu=S.i18n.translate("xpack.securitySolution.hostRules.failSearchDescription",{defaultMessage:"Failed to run search on risk score"}),Vu=e=>S.i18n.translate("xpack.securitySolution.uebaTableHostRules.unit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {rule} other {rules}}"}),Wu=S.i18n.translate("xpack.securitySolution.uebaTableHostRules.ruleName",{defaultMessage:"Rule name"}),Gu=S.i18n.translate("xpack.securitySolution.uebaTableHostRules.totalRiskScore",{defaultMessage:"Total risk score"}),Ku=S.i18n.translate("xpack.securitySolution.uebaTableHostRules.ruleType",{defaultMessage:"Rule type"}),Yu=S.i18n.translate("xpack.securitySolution.uebaTableHostRules.hits",{defaultMessage:"Number of hits"});var Ju=a(302);const Xu=[{text:S.i18n.translate("xpack.securitySolution.uebaTable.rows",{values:{numRows:5},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),numberOfRow:5},{text:S.i18n.translate("xpack.securitySolution.uebaTable.rows",{values:{numRows:10},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),numberOfRow:10}],Zu=({data:e,fakeTotalCount:t,headerTitle:a,headerSupplement:r,id:s,isInspect:o,loading:l,loadPage:c,showMorePagesIndicator:u,tableType:d,totalCount:p,type:m})=>{const f=Object(b.useDispatch)(),{activePage:g,limit:h,sort:y}=Object(be.a)(Uu.e.hostRulesSelector()),v=Object(n.useCallback)((e=>f(Uu.b.updateTableLimit({uebaType:m,limit:e,tableType:d}))),[d,m,f]),E=Object(n.useCallback)((e=>f(Uu.b.updateTableActivePage({activePage:e,uebaType:m,tableType:d}))),[d,m,f]),T=Object(n.useCallback)((e=>{if(null!=e.sort){const t={field:ed(e.sort.field),direction:e.sort.direction};t.direction!==y.direction||(t.field,y.field)}}),[y]),k=Object(n.useMemo)((()=>[{field:`node.${zu.HostRulesFields.ruleName}`,name:Wu,truncateText:!1,hideForMobile:!1,render:e=>{if(null!=e&&e.length>0){const t=Object(Ss.h)(`ueba-table-ruleName-${e}`);return i.a.createElement(Nc.b,{key:t,dataProvider:{and:[],enabled:!0,excluded:!1,id:t,name:e,kqlQuery:"",queryMatch:{field:"signal.rule.name",value:e,operator:Lc.c}},render:(t,a,n)=>n.isDragging?i.a.createElement(Nc.a,null,i.a.createElement(zc.a,{dataProvider:t})):e})}return Object(wr.d)()}},{field:`node.${zu.HostRulesFields.ruleType}`,name:Ku,truncateText:!1,hideForMobile:!1,render:e=>{if(null!=e&&e.length>0){const t=Object(Ss.h)(`ueba-table-ruleType-${e}`);return i.a.createElement(Nc.b,{key:t,dataProvider:{and:[],enabled:!0,excluded:!1,id:t,name:e,kqlQuery:"",queryMatch:{field:"signal.rule.type",value:e,operator:Lc.c}},render:(t,a,n)=>n.isDragging?i.a.createElement(Nc.a,null,i.a.createElement(zc.a,{dataProvider:t})):e})}return Object(wr.d)()}},{field:`node.${zu.HostRulesFields.riskScore}`,name:Gu,truncateText:!1,hideForMobile:!1,render:e=>{if(null!=e){const t=Object(Ss.h)(`ueba-table-riskScore-${e}`);return i.a.createElement(Nc.b,{key:t,dataProvider:{and:[],enabled:!0,excluded:!1,id:t,name:`${e}`,kqlQuery:"",queryMatch:{field:"signal.rule.risk_score",value:e,operator:Lc.c}},render:(t,a,n)=>n.isDragging?i.a.createElement(Nc.a,null,i.a.createElement(zc.a,{dataProvider:t})):e})}return Object(wr.d)()}},{field:`node.${zu.HostRulesFields.hits}`,name:Yu,truncateText:!1,hideForMobile:!1,sortable:!1,render:e=>null!=e?e:Object(wr.d)()}]),[]),x=Object(n.useMemo)((()=>{return e=y.field,t=y.direction,{field:td(e),direction:t};var e,t}),[y]),S=Object(n.useMemo)((()=>d===Uu.c.UebaTableType.userRules&&a&&r?{headerTitle:a,headerSupplement:r}:{headerTitle:Ju.a}),[r,a,d]);return i.a.createElement(_c.a,F()({},S,{activePage:g,columns:k,dataTestSubj:`table-${d}`,headerCount:p,headerUnit:Vu(p),id:s,isInspect:o,itemsPerRow:Xu,limit:h,loading:l,loadPage:c,onChange:T,pageOfItems:e,showMorePagesIndicator:u,sorting:x,totalCount:t,updateLimitPagination:v,updateActivePage:E}))};Zu.displayName="HostRulesTableComponent";const ed=e=>{switch(e){case`node.${zu.HostRulesFields.ruleName}`:return zu.HostRulesFields.ruleName;case`node.${zu.HostRulesFields.riskScore}`:default:return zu.HostRulesFields.riskScore}},td=e=>`node.${e}`,ad=i.a.memo(Zu);ad.displayName="HostRulesTable";const nd=Object(mr.a)(ad),id=({deleteQuery:e,docValueFields:t,endDate:a,filterQuery:r,hostName:s,indexNames:o,skip:l,setQuery:c,startDate:u,type:d})=>{const[p,{data:f,totalCount:g,pageInfo:b,loadPage:h,id:y,inspect:v,isInspected:E,refetch:T}]=(({docValueFields:e,endDate:t,filterQuery:a,hostName:i,indexNames:r,skip:s=!1,startDate:o})=>{const l=Object(n.useMemo)((()=>Uu.e.hostRulesSelector()),[]),{activePage:c,limit:u,sort:d}=Object(be.a)((e=>l(e))),{data:p}=Object(m.j)().services,f=Object(n.useRef)(me.noop),g=Object(n.useRef)(new AbortController),b=Object(n.useRef)(new or.Subscription),[h,y]=Object(n.useState)(!1),[v,E]=Object(n.useState)(null),{getTransformChangesIfTheyExist:T}=Object(lr.a)(),{addError:k,addWarning:x}=Object(Oe.a)(),S=Object(n.useCallback)((e=>{E((t=>t?{...t,pagination:Object(iu.a)(e,u)}:t))}),[u]),[w,O]=Object(n.useState)({data:[],endDate:t,id:"hostRulesQuery",inspect:{dsl:[],response:[]},isInspected:!1,loadPage:S,pageInfo:{activePage:0,fakeTotalCount:0,showMorePagesIndicator:!1},refetch:f.current,startDate:o,totalCount:-1}),j=Object(n.useCallback)((e=>{if(null==e||s)return;const t=async()=>{g.current=new AbortController,y(!0),b.current=p.search.search(e,{strategy:"securitySolutionSearchStrategy",abortSignal:g.current.signal}).subscribe({next:e=>{Object(zl.isCompleteResponse)(e)?(O((t=>({...t,data:e.edges,inspect:Object(pr.b)(e,t.inspect),pageInfo:e.pageInfo,refetch:f.current,totalCount:e.totalCount}))),b.current.unsubscribe()):Object(zl.isErrorResponse)(e)&&(y(!1),x($u),b.current.unsubscribe())},error:e=>{y(!1),k(e,{title:Qu}),b.current.unsubscribe()}}),y(!1)};b.current.unsubscribe(),g.current.abort(),t(),f.current=t}),[p.search,k,x,s]);return Object(n.useEffect)((()=>{E((n=>{const{indices:s,factoryQueryType:l,timerange:p}=T({factoryQueryType:zu.UebaQueries.hostRules,indices:r,filterQuery:a,timerange:{interval:"12h",from:o,to:t}}),m={...null!=n?n:{},hostName:i,defaultIndex:s,docValueFields:null!=e?e:[],factoryQueryType:l,filterQuery:Object(cr.a)(a),pagination:Object(iu.a)(c,u),timerange:p,sort:d};return Ki()(n,m)?n:m}))}),[c,e,t,a,r,u,o,d,T,i]),Object(n.useEffect)((()=>(j(v),()=>{b.current.unsubscribe(),g.current.abort()})),[v,j]),[h,w]})({docValueFields:t,endDate:a,filterQuery:r,hostName:s,indexNames:o,skip:l,startDate:u,type:d});return i.a.createElement(nd,{deleteQuery:e,data:f,fakeTotalCount:Object(me.getOr)(50,"fakeTotalCount",b),id:y,inspect:v,isInspect:E,loading:p,loadPage:h,refetch:T,setQuery:c,showMorePagesIndicator:Object(me.getOr)(!1,"showMorePagesIndicator",b),tableType:Uu.c.UebaTableType.userRules,totalCount:g,type:d})};id.displayName="HostRulesQueryTabBody";const rd=S.i18n.translate("xpack.securitySolution.hostRules.errorSearchDescription",{defaultMessage:"An error has occurred on risk score search"}),sd=S.i18n.translate("xpack.securitySolution.hostRules.failSearchDescription",{defaultMessage:"Failed to run search on risk score"}),od=(e,t)=>S.i18n.translate("xpack.securitySolution.uebaTableHostTactics.tacticTechnique",{values:{techniqueCount:t,totalCount:e},defaultMessage:"{totalCount} {totalCount, plural, =1 {tactic} other {tactics}} with {techniqueCount} {techniqueCount, plural, =1 {technique} other {techniques}}"}),ld=S.i18n.translate("xpack.securitySolution.uebaTableHostTactics.tactic",{defaultMessage:"Tactic"}),cd=S.i18n.translate("xpack.securitySolution.uebaTableHostTactics.totalRiskScore",{defaultMessage:"Total risk score"}),ud=S.i18n.translate("xpack.securitySolution.uebaTableHostTactics.technique",{defaultMessage:"Technique"}),dd=S.i18n.translate("xpack.securitySolution.uebaTableHostTactics.hits",{defaultMessage:"Number of hits"}),pd=Uu.c.UebaTableType.hostTactics,md=({data:e,fakeTotalCount:t,id:a,isInspect:r,loading:s,loadPage:o,showMorePagesIndicator:l,techniqueCount:c,totalCount:u,type:d})=>{const p=Object(b.useDispatch)(),{activePage:m,limit:f,sort:g}=Object(be.a)(Uu.e.hostTacticsSelector()),h=Object(n.useCallback)((e=>p(Uu.b.updateTableLimit({uebaType:d,limit:e,tableType:pd}))),[d,p]),y=Object(n.useCallback)((e=>p(Uu.b.updateTableActivePage({activePage:e,uebaType:d,tableType:pd}))),[d,p]),v=Object(n.useCallback)((e=>{if(null!=e.sort){const t={field:fd(e.sort.field),direction:e.sort.direction};t.direction!==g.direction||(t.field,g.field)}}),[g]),E=Object(n.useMemo)((()=>[{field:`node.${zu.HostTacticsFields.tactic}`,name:ld,truncateText:!1,hideForMobile:!1,render:e=>{if(null!=e&&e.length>0){const t=Object(Ss.h)(`ueba-table-tactic-${e}`);return i.a.createElement(Nc.b,{key:t,dataProvider:{and:[],enabled:!0,excluded:!1,id:t,name:e,kqlQuery:"",queryMatch:{field:"signal.rule.threat.tactic.name",value:e,operator:Lc.c}},render:(t,a,n)=>n.isDragging?i.a.createElement(Nc.a,null,i.a.createElement(zc.a,{dataProvider:t})):e})}return Object(wr.d)()}},{field:`node.${zu.HostTacticsFields.technique}`,name:ud,truncateText:!1,hideForMobile:!1,render:e=>{if(null!=e&&e.length>0){const t=Object(Ss.h)(`ueba-table-technique-${e}`);return i.a.createElement(Nc.b,{key:t,dataProvider:{and:[],enabled:!0,excluded:!1,id:t,name:e,kqlQuery:"",queryMatch:{field:"signal.rule.threat.technique.name",value:e,operator:Lc.c}},render:(t,a,n)=>n.isDragging?i.a.createElement(Nc.a,null,i.a.createElement(zc.a,{dataProvider:t})):e})}return Object(wr.d)()}},{field:`node.${zu.HostTacticsFields.riskScore}`,name:cd,truncateText:!1,hideForMobile:!1,render:e=>{if(null!=e){const t=Object(Ss.h)(`ueba-table-riskScore-${e}`);return i.a.createElement(Nc.b,{key:t,dataProvider:{and:[],enabled:!0,excluded:!1,id:t,name:`${e}`,kqlQuery:"",queryMatch:{field:"signal.rule.risk_score",value:e,operator:Lc.c}},render:(t,a,n)=>n.isDragging?i.a.createElement(Nc.a,null,i.a.createElement(zc.a,{dataProvider:t})):e})}return Object(wr.d)()}},{field:`node.${zu.HostTacticsFields.hits}`,name:dd,truncateText:!1,hideForMobile:!1,sortable:!1,render:e=>null!=e?e:Object(wr.d)()}]),[]),T=Object(n.useMemo)((()=>{return e=g.field,t=g.direction,{field:gd(e),direction:t};var e,t}),[g]);return i.a.createElement(_c.a,{activePage:m,columns:E,dataTestSubj:`table-${pd}`,headerCount:u,headerTitle:Ju.b,headerSubtitle:od(u,c),id:a,isInspect:r,itemsPerRow:Xu,limit:f,loading:s,loadPage:o,onChange:v,pageOfItems:e,showMorePagesIndicator:l,sorting:T,totalCount:t,updateLimitPagination:h,updateActivePage:y})};md.displayName="HostTacticsTableComponent";const fd=e=>{switch(e){case`node.${zu.HostTacticsFields.tactic}`:return zu.HostTacticsFields.tactic;case`node.${zu.HostTacticsFields.riskScore}`:default:return zu.HostTacticsFields.riskScore}},gd=e=>`node.${e}`,bd=i.a.memo(md);bd.displayName="HostTacticsTable";const hd=Object(mr.a)(bd),yd=({deleteQuery:e,docValueFields:t,endDate:a,filterQuery:r,hostName:s,indexNames:o,skip:l,setQuery:c,startDate:u,type:d})=>{const[p,{data:f,techniqueCount:g,totalCount:b,pageInfo:h,loadPage:y,id:v,inspect:E,isInspected:T,refetch:k}]=(({docValueFields:e,endDate:t,filterQuery:a,hostName:i,indexNames:r,skip:s=!1,startDate:o})=>{const l=Object(n.useMemo)((()=>Uu.e.hostTacticsSelector()),[]),{activePage:c,limit:u,sort:d}=Object(be.a)((e=>l(e))),{data:p}=Object(m.j)().services,f=Object(n.useRef)(me.noop),g=Object(n.useRef)(new AbortController),b=Object(n.useRef)(new or.Subscription),[h,y]=Object(n.useState)(!1),[v,E]=Object(n.useState)(null),{getTransformChangesIfTheyExist:T}=Object(lr.a)(),{addError:k,addWarning:x}=Object(Oe.a)(),S=Object(n.useCallback)((e=>{E((t=>t?{...t,pagination:Object(iu.a)(e,u)}:t))}),[u]),[w,O]=Object(n.useState)({data:[],endDate:t,id:"hostTacticsQuery",inspect:{dsl:[],response:[]},isInspected:!1,loadPage:S,pageInfo:{activePage:0,fakeTotalCount:0,showMorePagesIndicator:!1},refetch:f.current,startDate:o,techniqueCount:-1,totalCount:-1}),j=Object(n.useCallback)((e=>{if(null==e||s)return;const t=async()=>{g.current=new AbortController,y(!0),b.current=p.search.search(e,{strategy:"securitySolutionSearchStrategy",abortSignal:g.current.signal}).subscribe({next:e=>{Object(zl.isCompleteResponse)(e)?(O((t=>({...t,data:e.edges,inspect:Object(pr.b)(e,t.inspect),pageInfo:e.pageInfo,refetch:f.current,totalCount:e.totalCount,techniqueCount:e.techniqueCount}))),b.current.unsubscribe()):Object(zl.isErrorResponse)(e)&&(y(!1),x(rd),b.current.unsubscribe())},error:e=>{y(!1),k(e,{title:sd}),b.current.unsubscribe()}}),y(!1)};b.current.unsubscribe(),g.current.abort(),t(),f.current=t}),[p.search,k,x,s]);return Object(n.useEffect)((()=>{E((n=>{const{indices:s,factoryQueryType:l,timerange:p}=T({factoryQueryType:zu.UebaQueries.hostTactics,indices:r,filterQuery:a,timerange:{interval:"12h",from:o,to:t}}),m={...null!=n?n:{},hostName:i,defaultIndex:s,docValueFields:null!=e?e:[],factoryQueryType:l,filterQuery:Object(cr.a)(a),pagination:Object(iu.a)(c,u),timerange:p,sort:d};return Ki()(n,m)?n:m}))}),[c,e,t,a,r,u,o,d,T,i]),Object(n.useEffect)((()=>(j(v),()=>{b.current.unsubscribe(),g.current.abort()})),[v,j]),[h,w]})({docValueFields:t,endDate:a,filterQuery:r,hostName:s,indexNames:o,skip:l,startDate:u,type:d});return i.a.createElement(hd,{deleteQuery:e,data:f,fakeTotalCount:Object(me.getOr)(50,"fakeTotalCount",h),id:v,inspect:E,isInspect:T,loading:p,loadPage:y,refetch:k,setQuery:c,showMorePagesIndicator:Object(me.getOr)(!1,"showMorePagesIndicator",h),techniqueCount:g,totalCount:b,type:d})};yd.displayName="HostTacticsQueryTabBody";const vd=S.i18n.translate("xpack.securitySolution.riskScore.errorSearchDescription",{defaultMessage:"An error has occurred on risk score search"}),Ed=S.i18n.translate("xpack.securitySolution.riskScore.failSearchDescription",{defaultMessage:"Failed to run search on risk score"});var Td=a(780);const kd=e=>S.i18n.translate("xpack.securitySolution.uebaTableRiskScore.unit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {user} other {users}}"}),xd=S.i18n.translate("xpack.securitySolution.uebaTableRiskScore.nameTitle",{defaultMessage:"Host name"}),Sd=S.i18n.translate("xpack.securitySolution.uebaTableRiskScore.riskScore",{defaultMessage:"Risk score"}),wd=S.i18n.translate("xpack.securitySolution.uebaTableRiskScore.currentRisk",{defaultMessage:"Current risk"}),Od=Uu.c.UebaTableType.riskScore,jd=({data:e,fakeTotalCount:t,id:a,isInspect:r,loading:s,loadPage:o,showMorePagesIndicator:l,totalCount:c,type:u})=>{const d=Object(b.useDispatch)(),{activePage:p,limit:m,sort:f}=Object(be.a)(Uu.e.riskScoreSelector()),g=Object(n.useCallback)((e=>d(Uu.b.updateTableLimit({uebaType:u,limit:e,tableType:Od}))),[u,d]),h=Object(n.useCallback)((e=>d(Uu.b.updateTableActivePage({activePage:e,uebaType:u,tableType:Od}))),[u,d]),y=Object(n.useCallback)((e=>{if(null!=e.sort){const t={field:Cd(e.sort.field),direction:e.sort.direction};t.direction!==f.direction||(t.field,f.field)}}),[f]),v=Object(n.useMemo)((()=>[{field:"node.host_name",name:xd,truncateText:!1,hideForMobile:!1,sortable:!0,render:e=>{if(null!=e&&e.length>0){const t=Object(Ss.h)(`ueba-table-hostName-${e}`);return i.a.createElement(Nc.b,{key:t,dataProvider:{and:[],enabled:!0,excluded:!1,id:t,name:e,kqlQuery:"",queryMatch:{field:"host.name",value:e,operator:Lc.c}},render:(t,a,n)=>n.isDragging?i.a.createElement(Nc.a,null,i.a.createElement(zc.a,{dataProvider:t})):i.a.createElement(Ht.k,{hostName:e})})}return Object(wr.d)()}},{field:"node.risk_keyword",name:wd,truncateText:!1,hideForMobile:!1,sortable:!1,render:e=>null!=e?i.a.createElement(Td.a,{filter:Object(Td.b)("risk.keyword",e)},i.a.createElement(i.a.Fragment,null,e)):Object(wr.d)()}]),[]),E=Object(n.useMemo)((()=>{return e=f.field,t=f.direction,{field:Id(e),direction:t};var e,t}),[f]);return i.a.createElement(_c.a,{activePage:p,columns:v,dataTestSubj:`table-${Od}`,headerCount:c,headerTitle:Sd,headerUnit:kd(c),id:a,isInspect:r,itemsPerRow:Xu,limit:m,loading:s,loadPage:o,onChange:y,pageOfItems:e,showMorePagesIndicator:l,sorting:E,totalCount:t,updateLimitPagination:g,updateActivePage:h})};jd.displayName="RiskScoreTableComponent";const Cd=e=>{switch(e){case`node.${zu.RiskScoreFields.hostName}`:return zu.RiskScoreFields.hostName;case`node.${zu.RiskScoreFields.riskScore}`:default:return zu.RiskScoreFields.riskScore}},Id=e=>`node.${e}`,Md=i.a.memo(jd);Md.displayName="RiskScoreTable";const Ad=Object(mr.a)(Md),qd=({deleteQuery:e,docValueFields:t,endDate:a,filterQuery:r,indexNames:s,skip:o,setQuery:l,startDate:c,type:u})=>{const[d,{data:p,totalCount:f,pageInfo:g,loadPage:b,id:h,inspect:y,isInspected:v,refetch:E}]=(({docValueFields:e,endDate:t,filterQuery:a,indexNames:i,skip:r=!1,startDate:s})=>{const o=Object(n.useMemo)((()=>Uu.e.riskScoreSelector()),[]),{activePage:l,limit:c,sort:u}=Object(be.a)((e=>o(e))),{data:d}=Object(m.j)().services,p=Object(n.useRef)(me.noop),f=Object(n.useRef)(new AbortController),g=Object(n.useRef)(new or.Subscription),[b,h]=Object(n.useState)(!1),[y,v]=Object(n.useState)(null),{getTransformChangesIfTheyExist:E}=Object(lr.a)(),{addError:T,addWarning:k}=Object(Oe.a)(),x=Object(n.useCallback)((e=>{v((t=>t?{...t,pagination:Object(iu.a)(e,c)}:t))}),[c]),[S,w]=Object(n.useState)({data:[],endDate:t,id:"riskScoreQuery",inspect:{dsl:[],response:[]},isInspected:!1,loadPage:x,pageInfo:{activePage:0,fakeTotalCount:0,showMorePagesIndicator:!1},refetch:p.current,startDate:s,totalCount:-1}),O=Object(n.useCallback)((e=>{if(null==e||r)return;const t=async()=>{f.current=new AbortController,h(!0),g.current=d.search.search(e,{strategy:"securitySolutionSearchStrategy",abortSignal:f.current.signal}).subscribe({next:e=>{Object(zl.isCompleteResponse)(e)?(w((t=>({...t,data:e.edges,inspect:Object(pr.b)(e,t.inspect),pageInfo:e.pageInfo,refetch:p.current,totalCount:e.totalCount}))),g.current.unsubscribe()):Object(zl.isErrorResponse)(e)&&(h(!1),k(vd),g.current.unsubscribe())},error:e=>{h(!1),T(e,{title:Ed}),g.current.unsubscribe()}}),h(!1)};g.current.unsubscribe(),f.current.abort(),t(),p.current=t}),[d.search,T,k,r]);return Object(n.useEffect)((()=>{v((n=>{const{indices:r,factoryQueryType:o,timerange:d}=E({factoryQueryType:zu.UebaQueries.riskScore,indices:i,filterQuery:a,timerange:{interval:"12h",from:s,to:t}}),p={...null!=n?n:{},defaultIndex:r,docValueFields:null!=e?e:[],factoryQueryType:o,filterQuery:Object(cr.a)(a),pagination:Object(iu.a)(l,c),timerange:d,sort:u};return Ki()(n,p)?n:p}))}),[l,e,t,a,i,c,s,u,E]),Object(n.useEffect)((()=>(O(y),()=>{g.current.unsubscribe(),f.current.abort()})),[y,O]),[b,S]})({docValueFields:t,endDate:a,filterQuery:r,indexNames:s,skip:o,startDate:c,type:u});return i.a.createElement(Ad,{deleteQuery:e,data:p,fakeTotalCount:Object(me.getOr)(50,"fakeTotalCount",g),id:h,inspect:y,isInspect:v,loading:d,loadPage:b,refetch:E,setQuery:l,showMorePagesIndicator:Object(me.getOr)(!1,"showMorePagesIndicator",g),totalCount:f,type:u})};qd.displayName="RiskScoreQueryTabBody";const Dd=S.i18n.translate("xpack.securitySolution.hostRules.errorSearchDescription",{defaultMessage:"An error has occurred on risk score search"}),Pd=S.i18n.translate("xpack.securitySolution.hostRules.failSearchDescription",{defaultMessage:"Failed to run search on risk score"}),Rd=Object(mr.a)(ad),Fd=({deleteQuery:e,docValueFields:t,endDate:a,filterQuery:r,hostName:s,indexNames:o,skip:l,setQuery:c,startDate:u,type:d})=>{const[p,{data:f,loadPage:g,id:b,inspect:h,isInspected:y,refetch:v}]=(({docValueFields:e,endDate:t,filterQuery:a,hostName:i,indexNames:r,skip:s=!1,startDate:o})=>{const l=Object(n.useMemo)((()=>Uu.e.userRulesSelector()),[]),{activePage:c,limit:u,sort:d}=Object(be.a)((e=>l(e))),{data:p}=Object(m.j)().services,f=Object(n.useRef)(me.noop),g=Object(n.useRef)(new AbortController),b=Object(n.useRef)(new or.Subscription),[h,y]=Object(n.useState)(!1),[v,E]=Object(n.useState)(null),{getTransformChangesIfTheyExist:T}=Object(lr.a)(),{addError:k,addWarning:x}=Object(Oe.a)(),S=Object(n.useCallback)((e=>{E((t=>t?{...t,pagination:Object(iu.a)(e,u)}:t))}),[u]),[w,O]=Object(n.useState)({data:[],endDate:t,id:"userRulesQuery",inspect:{dsl:[],response:[]},isInspected:!1,loadPage:S,refetch:f.current,startDate:o}),j=Object(n.useCallback)((e=>{if(null==e||s)return;const t=async()=>{g.current=new AbortController,y(!0),b.current=p.search.search(e,{strategy:"securitySolutionSearchStrategy",abortSignal:g.current.signal}).subscribe({next:e=>{Object(zl.isCompleteResponse)(e)?(O((t=>({...t,data:e.data,inspect:Object(pr.b)(e,t.inspect),refetch:f.current}))),b.current.unsubscribe()):Object(zl.isErrorResponse)(e)&&(y(!1),x(Dd),b.current.unsubscribe())},error:e=>{y(!1),k(e,{title:Pd}),b.current.unsubscribe()}}),y(!1)};b.current.unsubscribe(),g.current.abort(),t(),f.current=t}),[p.search,k,x,s]);return Object(n.useEffect)((()=>{E((n=>{const{indices:s,factoryQueryType:l,timerange:p}=T({factoryQueryType:zu.UebaQueries.userRules,indices:r,filterQuery:a,timerange:{interval:"12h",from:o,to:t}}),m={...null!=n?n:{},hostName:i,defaultIndex:s,docValueFields:null!=e?e:[],factoryQueryType:l,filterQuery:Object(cr.a)(a),pagination:Object(iu.a)(c,u),timerange:p,sort:d};return Ki()(n,m)?n:m}))}),[c,e,t,a,r,u,o,d,T,i]),Object(n.useEffect)((()=>(j(v),()=>{b.current.unsubscribe(),g.current.abort()})),[v,j]),[h,w]})({docValueFields:t,endDate:a,filterQuery:r,hostName:s,indexNames:o,skip:l,startDate:u,type:d});return i.a.createElement(_.EuiFlexGroup,{direction:"column"},f.map(((t,a)=>i.a.createElement(_.EuiFlexItem,{key:`${b}${a}`},i.a.createElement(Rd,{deleteQuery:e,data:t.edges,headerSupplement:i.a.createElement("p",null,`Total user risk score: ${t[zu.UserRulesFields.riskScore]}`),headerTitle:`user.name: ${t[zu.UserRulesFields.userName]}`,fakeTotalCount:Object(me.getOr)(50,"fakeTotalCount",t.pageInfo),id:`${b}${a}`,inspect:h,isInspect:y,loading:p,loadPage:g,refetch:v,setQuery:c,showMorePagesIndicator:Object(me.getOr)(!1,"showMorePagesIndicator",t.pageInfo),tableType:Uu.c.UebaTableType.userRules,totalCount:t.totalCount,type:d})))))};Fd.displayName="UserRulesQueryTabBody";const _d=Object(n.memo)((({deleteQuery:e,docValueFields:t,filterQuery:a,from:r,indexNames:s,isInitializing:c,setAbsoluteRangeDatePicker:u,setQuery:d,to:p,type:m})=>{const f={deleteQuery:e,endDate:p,filterQuery:a,indexNames:s,skip:c||void 0===a,setQuery:d,startDate:r,type:m,narrowDateRange:Object(n.useCallback)(((e,t)=>{const a=Object(Vi.a)(e,t);u({id:"global",from:a.from,to:a.to})}),[u]),updateDateRange:Object(n.useCallback)((({x:e})=>{if(!e)return;const[t,a]=e;u({id:"global",from:new Date(t).toISOString(),to:new Date(a).toISOString()})}),[u])};return i.a.createElement(l.Switch,null,i.a.createElement(l.Route,{path:`${o.Wb}/:tabName(${Bu.UebaTableType.riskScore})`},i.a.createElement(qd,F()({docValueFields:t},f))))}));_d.displayName="UebaTabs";const Nd={[Bu.UebaTableType.riskScore]:{id:Bu.UebaTableType.riskScore,name:Ju.d,href:(Ld=Bu.UebaTableType.riskScore,`${o.Wb}/${Ld}`),disabled:!1}};var Ld;const Bd=L.a.div.withConfig({displayName:"StyledFullHeightContainer",componentId:"sc-1yhvv51-0"})(["display:flex;flex-direction:column;flex:1 1 auto;"]),zd=()=>{const e=Object(n.useRef)(null),t=Object(n.useMemo)((()=>y.b.getTimelineByIdSelector()),[]),a=Object(be.b)((e=>{var a;return(null!==(a=t(e,zu.TimelineId.uebaPageExternalAlerts))&&void 0!==a?a:Re.a).graphEventId})),r=Object(n.useMemo)((()=>Ie.e.globalFiltersQuerySelector()),[]),o=Object(n.useMemo)((()=>Ie.e.globalQuerySelector()),[]),l=Object(be.a)(o),c=Object(be.a)(r),{to:p,from:f,deleteQuery:g,setQuery:b,isInitializing:h}=Object(he.a)(),{globalFullScreen:E}=Object(Ut.a)(),{uiSettings:T}=Object(m.j)().services,k=c,{docValueFields:x,indicesExist:S,indexPattern:w,selectedPatterns:O}=Object(v.c)(),[j,C]=Object(n.useMemo)((()=>Object(ps.b)({config:xe.esQuery.getEsQueryConfig(T),indexPattern:w,queries:[l],filters:c})),[c,w,T,l]),[I]=Object(n.useMemo)((()=>Object(ps.b)({config:xe.esQuery.getEsQueryConfig(T),indexPattern:w,queries:[l],filters:k})),[w,l,k,T]);Object(je.a)({id:"UebaQueryId",filterQuery:j,kqlError:C,query:l,startDate:f,endDate:p});const M=Object(n.useCallback)((()=>{var t,a;null===(t=e.current)||void 0===t||null===(a=t.querySelector(".inspectButtonComponent:last-of-type"))||void 0===a||a.focus()}),[e]),A=Object(n.useCallback)((()=>{Object(Pe.m)()}),[]),q=Object(n.useCallback)((t=>{Object(ge.isTab)(t)&&Object(Pe.l)({containerElement:e.current,keyboardEvent:t,onSkipFocusBeforeEventsTable:M,onSkipFocusAfterEventsTable:A})}),[e,M,A]);return i.a.createElement(i.a.Fragment,null,S?i.a.createElement(Bd,{onKeyDown:q,ref:e},i.a.createElement(_.EuiWindowEvent,{event:"resize",handler:me.noop}),i.a.createElement(ye.a,{show:Object(Pe.n)({globalFullScreen:E,graphEventId:a})},i.a.createElement(Ee.a,{indexPattern:w,id:"global"})),i.a.createElement(d.a,{noPadding:E},i.a.createElement(Hu,{show:!E},i.a.createElement(Q.a,{subtitle:i.a.createElement(zi.a,{docValueFields:x,indexKey:Bi.n.ueba,indexNames:O}),title:Ju.c}),i.a.createElement(sr,{navTabs:Nd}),i.a.createElement(_.EuiSpacer,null)),i.a.createElement(_d,{deleteQuery:g,docValueFields:x,filterQuery:I||"",from:f,indexNames:O,isInitializing:h,setAbsoluteRangeDatePicker:ke.setAbsoluteRangeDatePicker,setQuery:b,to:p,type:Uu.c.UebaType.page}))):i.a.createElement(d.a,null,i.a.createElement(Q.a,{border:!0,title:Ju.c}),i.a.createElement(pt.a,null)),i.a.createElement(u.a,{pageName:s.a.ueba}))};zd.displayName="UebaComponent";const Hd=i.a.memo(zd),Ud=`${o.Wb}/:detailName`;var $d=a(386),Qd=a(478);const Vd=i.a.memo((({detailName:e,docValueFields:t,filterQuery:a,indexNames:r,indexPattern:s,pageFilters:o,setAbsoluteRangeDatePicker:c,uebaDetailsPagePath:u})=>{const{from:d,to:p,isInitializing:m,deleteQuery:f,setQuery:g}=Object(he.a)(),b=Object(n.useCallback)(((e,t)=>{const a=Object(Vi.a)(e,t);c({id:"global",from:a.from,to:a.to})}),[c]),h=Object(n.useCallback)((({x:e})=>{if(!e)return;const[t,a]=e;c({id:"global",from:new Date(t).toISOString(),to:new Date(a).toISOString()})}),[c]),y={deleteQuery:f,endDate:p,filterQuery:a,skip:m||void 0===a,setQuery:g,startDate:d,type:Qd.b,indexPattern:s,indexNames:r,hostName:e,narrowDateRange:b,updateDateRange:h};return i.a.createElement(l.Switch,null,i.a.createElement(l.Route,{path:`${u}/:tabName(${Bu.UebaTableType.hostRules})`},i.a.createElement(id,y)),i.a.createElement(l.Route,{path:`${u}/:tabName(${Bu.UebaTableType.hostTactics})`},i.a.createElement(yd,y)),i.a.createElement(l.Route,{path:`${u}/:tabName(${Bu.UebaTableType.userRules})`},i.a.createElement(Fd,y)))}));Vd.displayName="UebaDetailsTabs";const Wd=(e,t)=>`${o.Wb}/${e}/${t}`,Gd=({detailName:e,uebaDetailsPagePath:t})=>{const a=Object(b.useDispatch)(),r=Object(n.useMemo)((()=>y.b.getTimelineByIdSelector()),[]),o=Object(be.b)((e=>{var t;return(null!==(t=r(e,h.q.hostsPageEvents))&&void 0!==t?t:Re.a).graphEventId})),l=Object(n.useMemo)((()=>Ie.e.globalFiltersQuerySelector()),[]),c=Object(n.useMemo)((()=>Ie.e.globalQuerySelector()),[]),p=Object(be.a)(c),f=Object(be.a)(l),{to:g,from:T,deleteQuery:k,setQuery:x,isInitializing:S}=Object(he.a)(),{globalFullScreen:w}=Object(Ut.a)(),O=Object(m.j)(),j=Object(n.useMemo)((()=>{return[{meta:{alias:null,negate:!1,disabled:!1,type:"phrase",key:"host.name",value:t=e,params:{query:t}},query:{match:{"host.name":{query:t,type:"phrase"}}}}];var t}),[e]),{docValueFields:C,indicesExist:I,indexPattern:M,selectedPatterns:A}=Object(v.c)(E.SourcererScopeName.detections),[q,D]=Object(ps.b)({config:xe.esQuery.getEsQueryConfig(O.services.uiSettings),indexPattern:M,queries:[p],filters:[...j,...f]});return Object(je.a)({id:"UebaDetailsQueryId",filterQuery:q,kqlError:D,query:p,startDate:T,endDate:g}),Object(n.useEffect)((()=>{a(Object($d.setUebaDetailsTablesActivePageToZero)())}),[a,e]),i.a.createElement(i.a.Fragment,null,I?i.a.createElement(i.a.Fragment,null,i.a.createElement(_.EuiWindowEvent,{event:"resize",handler:me.noop}),i.a.createElement(ye.a,{show:Object(Pe.n)({globalFullScreen:w,graphEventId:o})},i.a.createElement(Ee.a,{indexPattern:M,id:"global"})),i.a.createElement(d.a,{noPadding:w},i.a.createElement(Hu,{show:!w},i.a.createElement(Q.a,{border:!0,sourcererScope:E.SourcererScopeName.detections,subtitle:i.a.createElement(zi.a,{docValueFields:C,indexKey:Bi.n.ueba,hostName:e,indexNames:A}),title:e}),i.a.createElement(sr,{navTabs:(P=e,{[Bu.UebaTableType.hostRules]:{id:Bu.UebaTableType.hostRules,name:Ju.a,href:Wd(P,Bu.UebaTableType.hostRules),disabled:!1},[Bu.UebaTableType.hostTactics]:{id:Bu.UebaTableType.hostTactics,name:Ju.b,href:Wd(P,Bu.UebaTableType.hostTactics),disabled:!1},[Bu.UebaTableType.userRules]:{id:Bu.UebaTableType.userRules,name:Ju.e,href:Wd(P,Bu.UebaTableType.userRules),disabled:!1}})}),i.a.createElement(_.EuiSpacer,null)),i.a.createElement(Vd,{deleteQuery:k,detailName:e,docValueFields:C,filterQuery:q,from:T,indexNames:A,indexPattern:M,isInitializing:S,pageFilters:j,setAbsoluteRangeDatePicker:ke.setAbsoluteRangeDatePicker,setQuery:x,to:g,type:Qd.b,uebaDetailsPagePath:t}))):i.a.createElement(d.a,null,i.a.createElement(Q.a,{border:!0,title:e}),i.a.createElement(pt.a,null)),i.a.createElement(u.a,{pageName:s.a.ueba}));var P};Gd.displayName="UebaDetailsComponent";const Kd=i.a.memo(Gd),Yd=`${o.Wb}/:tabName(${Bu.UebaTableType.riskScore})`,Jd=`${Ud}/:tabName(${Bu.UebaTableType.hostRules}|${Bu.UebaTableType.hostTactics}|${Bu.UebaTableType.userRules})`,Xd=i.a.memo((()=>i.a.createElement(l.Switch,null,i.a.createElement(l.Route,{exact:!0,strict:!0,path:o.Wb,render:({location:{search:e=""}})=>i.a.createElement(l.Redirect,{to:{pathname:`${o.Wb}/${Bu.UebaTableType.riskScore}`,search:e}})}),i.a.createElement(l.Route,{path:Yd},i.a.createElement(Hd,null)),i.a.createElement(l.Route,{path:Jd,render:({match:{params:{detailName:e}}})=>i.a.createElement(Kd,{uebaDetailsPagePath:Ud,detailName:e})}),i.a.createElement(l.Route,{path:Ud,render:({match:{params:{detailName:e}},location:{search:t=""}})=>i.a.createElement(l.Redirect,{to:{pathname:`${o.Wb}/${e}/${Bu.UebaTableType.hostRules}`,search:t}})}))));Xd.displayName="UebaContainer";const Zd=[{path:o.Wb,render:()=>i.a.createElement(r.TrackApplicationView,{viewId:s.a.ueba},i.a.createElement(Xd,null))}];var ep=a(382),tp=a(332),ap=a(681),np=a(288);const ip="alertsByCategoryOverview",rp=({deleteQuery:e,filters:t,from:a,hideHeaderChildren:r=!1,indexPattern:l,indexNames:c,query:u,setQuery:d,to:p})=>{const{uiSettings:g,application:{navigateToApp:b}}=Object(m.j)().services,{formatUrl:h,search:y}=Object(f.n)(s.a.hosts),[v]=Object(m.o)(o.O),E=Object(n.useCallback)((e=>{e.preventDefault(),b(o.l,{deepLinkId:s.a.hosts,path:Object(np.b)(fs.HostsTableType.alerts,y)})}),[b,y]),T=Object(n.useMemo)((()=>i.a.createElement(Ht.g,{"data-test-subj":"view-alerts",onClick:E,href:h(Object(np.b)(fs.HostsTableType.alerts))},tp.e)),[E,h]),k=Object(n.useMemo)((()=>{var e;return{...ap.b,defaultStackByOption:null!==(e=ap.a.find((e=>"event.module"===e.text)))&&void 0!==e?e:ap.a[0],subtitle:e=>`${ep.e}: ${ze()(e).format(v)} ${Object(ep.g)(e)}`,legendPosition:fr.Position.Right}}),[]),[x,S]=Object(n.useMemo)((()=>Object(ps.b)({config:xe.esQuery.getEsQueryConfig(g),indexPattern:l,queries:[u],filters:t})),[t,l,g,u]);return Object(je.a)({id:ip,filterQuery:x,kqlError:S,query:u,startDate:a,endDate:p}),Object(n.useEffect)((()=>()=>{e&&e({id:ip})}),[e]),i.a.createElement(cu.a,F()({endDate:p,filterQuery:x,headerChildren:r?null:T,id:ip,indexNames:c,setQuery:d,startDate:a},k))};rp.displayName="AlertsByCategoryComponent";const sp=i.a.memo(rp);var op=a(198),lp=a(614);const cp=S.i18n.translate("xpack.securitySolution.allHost.errorSearchDescription",{defaultMessage:"An error has occurred on all hosts search"}),up=S.i18n.translate("xpack.securitySolution.allHost.failSearchDescription",{defaultMessage:"Failed to run search on all hosts"}),dp="overviewHostQuery",pp=L.a.div.withConfig({displayName:"ProgressContainer",componentId:"sc-1qvjg2g-0"})(["margin-left:8px;min-width:100px;"]),mp=L()(_.EuiLoadingContent).withConfig({displayName:"LoadingContent",componentId:"sc-1qvjg2g-1"})([".euiLoadingContent__singleLine{margin-bottom:0px;}"]),fp=({count:e,isGroupStat:t,isLoading:a,max:r})=>{const[s]=Object(m.o)(o.O),[l,c]=Object(n.useState)(!0);return Object(n.useEffect)((()=>{l&&!a&&c(!1)}),[a,l,c]),i.a.createElement(_.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},i.a.createElement(_.EuiFlexItem,{grow:!1},!l&&i.a.createElement(_.EuiText,{color:t?"default":"subdued",size:t?"m":"s"},ze()(e).format(s))),i.a.createElement(_.EuiFlexItem,{grow:!0},i.a.createElement(pp,null,a?i.a.createElement(mp,{"data-test-subj":"stat-value-loading-spinner",lines:1}):i.a.createElement(_.EuiProgress,{color:t?"primary":"subdued",max:r,size:"m",value:e}))))};fp.displayName="StatValueComponent";const gp=i.a.memo(fp),bp=e=>{var t,a,n,r,s,o,l,c,u,d,p,m,f,g,b,h;return[{count:null!==(t=e.auditbeatAuditd)&&void 0!==t?t:0,title:i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.overview.auditBeatAuditTitle",defaultMessage:"Audit"}),id:"auditbeatAuditd"},{count:null!==(a=e.auditbeatFIM)&&void 0!==a?a:0,title:i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.overview.auditBeatFimTitle",defaultMessage:"File Integrity Module"}),id:"auditbeatFIM"},{count:null!==(n=e.auditbeatLogin)&&void 0!==n?n:0,title:i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.overview.auditBeatLoginTitle",defaultMessage:"Login"}),id:"auditbeatLogin"},{count:null!==(r=e.auditbeatPackage)&&void 0!==r?r:0,title:i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.overview.auditBeatPackageTitle",defaultMessage:"Package"}),id:"auditbeatPackage"},{count:null!==(s=e.auditbeatProcess)&&void 0!==s?s:0,title:i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.overview.auditBeatProcessTitle",defaultMessage:"Process"}),id:"auditbeatProcess"},{count:null!==(o=e.auditbeatUser)&&void 0!==o?o:0,title:i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.overview.auditBeatUserTitle",defaultMessage:"User"}),id:"auditbeatUser"},{count:null!==(l=e.endgameDns)&&void 0!==l?l:0,title:i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.overview.endgameDnsTitle",defaultMessage:"DNS"}),id:"endgameDns"},{count:null!==(c=e.endgameFile)&&void 0!==c?c:0,title:i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.overview.endgameFileTitle",defaultMessage:"File"}),id:"endgameFile"},{count:null!==(u=e.endgameImageLoad)&&void 0!==u?u:0,title:i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.overview.endgameImageLoadTitle",defaultMessage:"Image Load"}),id:"endgameImageLoad"},{count:null!==(d=e.endgameNetwork)&&void 0!==d?d:0,title:i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.overview.endgameNetworkTitle",defaultMessage:"Network"}),id:"endgameNetwork"},{count:null!==(p=e.endgameProcess)&&void 0!==p?p:0,title:i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.overview.endgameProcessTitle",defaultMessage:"Process"}),id:"endgameProcess"},{count:null!==(m=e.endgameRegistry)&&void 0!==m?m:0,title:i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.overview.endgameRegistryTitle",defaultMessage:"Registry"}),id:"endgameRegistry"},{count:null!==(f=e.endgameSecurity)&&void 0!==f?f:0,title:i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.overview.endgameSecurityTitle",defaultMessage:"Security"}),id:"endgameSecurity"},{count:null!==(g=e.filebeatSystemModule)&&void 0!==g?g:0,title:i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.overview.filebeatSystemModuleTitle",defaultMessage:"System Module"}),id:"filebeatSystemModule"},{count:null!==(b=e.winlogbeatSecurity)&&void 0!==b?b:0,title:i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.overview.winlogbeatSecurityTitle",defaultMessage:"Security"}),id:"winlogbeatSecurity"},{count:null!==(h=e.winlogbeatMWSysmonOperational)&&void 0!==h?h:0,title:i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.overview.winlogbeatMWSysmonOperational",defaultMessage:"Microsoft-Windows-Sysmon/Operational"}),id:"winlogbeatMWSysmonOperational"}]},hp=L.a.div.withConfig({displayName:"HostStatsContainer",componentId:"sc-ej4zfy-0"})([".accordion-button{width:100%;}"]),yp=[{groupId:"auditbeat",name:i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.overview.hostStatGroupAuditbeat",defaultMessage:"Auditbeat"}),statIds:["auditbeatAuditd","auditbeatFIM","auditbeatLogin","auditbeatPackage","auditbeatProcess","auditbeatUser"]},{groupId:"endgame",name:i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.overview.hostStatGroupElasticEndpointSecurity",defaultMessage:"Endpoint Security"}),statIds:["endgameDns","endgameFile","endgameImageLoad","endgameNetwork","endgameProcess","endgameRegistry","endgameSecurity"]},{groupId:"filebeat",name:i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.overview.hostStatGroupFilebeat",defaultMessage:"Filebeat"}),statIds:["filebeatSystemModule"]},{groupId:"winlogbeat",name:i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.overview.hostStatGroupWinlogbeat",defaultMessage:"Winlogbeat"}),statIds:["winlogbeatSecurity","winlogbeatMWSysmonOperational"]}],vp=L.a.div.withConfig({displayName:"Title",componentId:"sc-ej4zfy-1"})(["margin-left:24px;"]),Ep=L.a.div.withConfig({displayName:"AccordionContent",componentId:"sc-ej4zfy-2"})(["margin-top:8px;"]),Tp=({data:e,loading:t})=>{const a=bp(e),n=a.reduce(((e,t)=>e+t.count),0);return i.a.createElement(hp,{"data-test-subj":"overview-hosts-stats"},yp.map(((e,r)=>{const s=a.filter((t=>e.statIds.includes(t.id))),o=s.reduce(((e,t)=>e+t.count),0);return i.a.createElement(i.a.Fragment,{key:e.groupId},i.a.createElement(_.EuiHorizontalRule,{margin:"xs"}),i.a.createElement(_.EuiAccordion,{id:`host-stat-accordion-group${e.groupId}`,buttonContent:i.a.createElement(_.EuiFlexGroup,{gutterSize:"none",justifyContent:"spaceBetween"},i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(_.EuiText,null,e.name)),i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(gp,{count:o,isGroupStat:!0,isLoading:t,max:n}))),buttonContentClassName:"accordion-button"},i.a.createElement(Ep,null,s.map((e=>i.a.createElement(_.EuiFlexGroup,{key:e.id,justifyContent:"spaceBetween"},i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(_.EuiText,{color:"subdued",size:"s"},i.a.createElement(vp,null,e.title))),i.a.createElement(_.EuiFlexItem,{"data-test-subj":`host-stat-${e.id}`,grow:!1},i.a.createElement(gp,{count:e.count,isGroupStat:!1,isLoading:t,max:o}))))))))})))},kp=i.a.memo(Tp),xp=Object(mr.a)(kp),Sp=({endDate:e,filterQuery:t,indexNames:a,startDate:r,setQuery:l})=>{const{formatUrl:c,search:u}=Object(f.n)(s.a.hosts),{navigateToApp:d}=Object(m.j)().services.application,[p]=Object(m.o)(o.O),[g,{overviewHost:b,id:h,inspect:y,refetch:v}]=(({filterQuery:e,endDate:t,indexNames:a,skip:i=!1,startDate:r})=>{const{data:s}=Object(m.j)().services,o=Object(n.useRef)(me.noop),l=Object(n.useRef)(new AbortController),c=Object(n.useRef)(new or.Subscription),[u,d]=Object(n.useState)(!1),[p,f]=Object(n.useState)(null),[g,b]=Object(n.useState)({overviewHost:{},id:dp,inspect:{dsl:[],response:[]},isInspected:!1,refetch:o.current}),{addError:h,addWarning:y}=Object(Oe.a)(),v=Object(n.useCallback)((e=>{if(null==e||i)return;const t=async()=>{l.current=new AbortController,d(!0),c.current=s.search.search(e,{strategy:"securitySolutionSearchStrategy",abortSignal:l.current.signal}).subscribe({next:e=>{Object(zl.isCompleteResponse)(e)?(d(!1),b((t=>({...t,overviewHost:e.overviewHost,inspect:Object(pr.b)(e,t.inspect),refetch:o.current}))),c.current.unsubscribe()):Object(zl.isErrorResponse)(e)&&(d(!1),y(cp),c.current.unsubscribe())},error:e=>{d(!1),h(e,{title:up}),c.current.unsubscribe()}})};c.current.unsubscribe(),l.current.abort(),t(),o.current=t}),[s.search,h,y,i]);return Object(n.useEffect)((()=>{f((n=>{const i={...null!=n?n:{},defaultIndex:a,factoryQueryType:uu.h.overview,filterQuery:Object(cr.a)(e),timerange:{interval:"12h",from:r,to:t}};return Ki()(n,i)?n:i}))}),[a,t,e,r]),Object(n.useEffect)((()=>(v(p),()=>{c.current.unsubscribe(),l.current.abort()})),[p,v]),[u,g]})({endDate:e,filterQuery:t,indexNames:a,startDate:r,skip:void 0===t}),E=Object(n.useCallback)((e=>{e.preventDefault(),d(o.l,{deepLinkId:s.a.hosts,path:Object(f.h)("allHosts",u)})}),[d,u]),T=Object(n.useMemo)((()=>bp(b).reduce(((e,t)=>e+t.count),0)),[b]),k=Object(n.useMemo)((()=>ze()(T).format(p)),[p,T]),x=Object(n.useMemo)((()=>i.a.createElement(Ht.g,{onClick:E,href:c("/allHosts")},i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.overview.hostsAction",defaultMessage:"View hosts"}))),[E,c]),S=Object(n.useMemo)((()=>i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.overview.hostsTitle",defaultMessage:"Host events"})),[]),w=Object(n.useMemo)((()=>Object(me.isEmpty)(b)?i.a.createElement(i.a.Fragment,null,""):i.a.createElement(oa.FormattedMessage,{defaultMessage:"Showing: {formattedHostEventsCount} {hostEventsCount, plural, one {event} other {events}}",id:"xpack.securitySolution.overview.overviewHost.hostsSubtitle",values:{hostEventsCount:T,formattedHostEventsCount:k}})),[k,T,b]);return i.a.createElement(_.EuiFlexItem,null,i.a.createElement(za.b,null,i.a.createElement(_.EuiPanel,{hasBorder:!0},i.a.createElement(La.a,{id:dp,subtitle:w,title:S,isInspectDisabled:void 0===t},i.a.createElement(i.a.Fragment,null,x)),i.a.createElement(xp,{loading:g,data:b,setQuery:l,id:h,inspect:y,refetch:v}))))};Sp.displayName="OverviewHostComponent";const wp=i.a.memo(Sp),Op=S.i18n.translate("xpack.securitySolution.allHost.errorSearchDescription",{defaultMessage:"An error has occurred on all hosts search"}),jp=S.i18n.translate("xpack.securitySolution.allHost.failSearchDescription",{defaultMessage:"Failed to run search on all hosts"}),Cp="overviewNetworkQuery",Ip=e=>{var t,a,n,r,s,o,l,c,u;return[{count:null!==(t=e.auditbeatSocket)&&void 0!==t?t:0,title:i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.overview.auditBeatSocketTitle",defaultMessage:"Socket"}),id:"auditbeatSocket"},{count:null!==(a=e.filebeatCisco)&&void 0!==a?a:0,title:i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.overview.filebeatCiscoTitle",defaultMessage:"Cisco"}),id:"filebeatCisco"},{count:null!==(n=e.filebeatNetflow)&&void 0!==n?n:0,title:i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.overview.filebeatNetflowTitle",defaultMessage:"Netflow"}),id:"filebeatNetflow"},{count:null!==(r=e.filebeatPanw)&&void 0!==r?r:0,title:i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.overview.filebeatPanwTitle",defaultMessage:"Palo Alto Networks"}),id:"filebeatPanw"},{count:null!==(s=e.filebeatSuricata)&&void 0!==s?s:0,title:i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.overview.fileBeatSuricataTitle",defaultMessage:"Suricata"}),id:"filebeatSuricata"},{count:null!==(o=e.filebeatZeek)&&void 0!==o?o:0,title:i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.overview.fileBeatZeekTitle",defaultMessage:"Zeek"}),id:"filebeatZeek"},{count:null!==(l=e.packetbeatDNS)&&void 0!==l?l:0,title:i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.overview.packetBeatDnsTitle",defaultMessage:"DNS"}),id:"packetbeatDNS"},{count:null!==(c=e.packetbeatFlow)&&void 0!==c?c:0,title:i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.overview.packetBeatFlowTitle",defaultMessage:"Flow"}),id:"packetbeatFlow"},{count:null!==(u=e.packetbeatTLS)&&void 0!==u?u:0,title:i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.overview.packetbeatTLSTitle",defaultMessage:"TLS"}),id:"packetbeatTLS"}]},Mp=[{groupId:"auditbeat",name:i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.overview.networkStatGroupAuditbeat",defaultMessage:"Auditbeat"}),statIds:["auditbeatSocket"]},{groupId:"filebeat",name:i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.overview.networkStatGroupFilebeat",defaultMessage:"Filebeat"}),statIds:["filebeatCisco","filebeatNetflow","filebeatPanw","filebeatSuricata","filebeatZeek"]},{groupId:"packetbeat",name:i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.overview.networkStatGroupPacketbeat",defaultMessage:"Packetbeat"}),statIds:["packetbeatDNS","packetbeatFlow","packetbeatTLS"]}],Ap=L.a.div.withConfig({displayName:"NetworkStatsContainer",componentId:"sc-1wm45zw-0"})([".accordion-button{width:100%;}"]),qp=L.a.div.withConfig({displayName:"Title",componentId:"sc-1wm45zw-1"})(["margin-left:24px;"]),Dp=L.a.div.withConfig({displayName:"AccordionContent",componentId:"sc-1wm45zw-2"})(["margin-top:8px;"]),Pp=({data:e,loading:t})=>{const a=Ip(e),n=a.reduce(((e,t)=>e+t.count),0);return i.a.createElement(Ap,{"data-test-subj":"overview-network-stats"},Mp.map(((e,r)=>{const s=a.filter((t=>e.statIds.includes(t.id))),o=s.reduce(((e,t)=>e+t.count),0);return i.a.createElement(i.a.Fragment,{key:e.groupId},i.a.createElement(_.EuiHorizontalRule,{margin:"xs"}),i.a.createElement(_.EuiAccordion,{id:`network-stat-accordion-group${e.groupId}`,buttonContent:i.a.createElement(_.EuiFlexGroup,{"data-test-subj":`network-stat-group-${e.groupId}`,justifyContent:"spaceBetween"},i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(_.EuiText,null,e.name)),i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(gp,{count:o,isGroupStat:!0,isLoading:t,max:n}))),buttonContentClassName:"accordion-button"},i.a.createElement(Dp,null,s.map((e=>i.a.createElement(_.EuiFlexGroup,{key:e.id,justifyContent:"spaceBetween"},i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(_.EuiText,{color:"subdued",size:"s"},i.a.createElement(qp,null,e.title))),i.a.createElement(_.EuiFlexItem,{"data-test-subj":`network-stat-${e.id}`,grow:!1},i.a.createElement(gp,{count:e.count,isGroupStat:!1,isLoading:t,max:o}))))))))})))},Rp=i.a.memo(Pp),Fp=Object(mr.a)(Rp),_p=({endDate:e,filterQuery:t,indexNames:a,startDate:r,setQuery:l})=>{const{formatUrl:c,search:u}=Object(f.n)(s.a.network),{navigateToApp:d}=Object(m.j)().services.application,[p]=Object(m.o)(o.O),[g,{overviewNetwork:b,id:h,inspect:y,refetch:v}]=(({filterQuery:e,endDate:t,indexNames:a,skip:i=!1,startDate:r})=>{const{data:s}=Object(m.j)().services,o=Object(n.useRef)(me.noop),l=Object(n.useRef)(new AbortController),c=Object(n.useRef)(new or.Subscription),[u,d]=Object(n.useState)(!1),[p,f]=Object(n.useState)(null),[g,b]=Object(n.useState)({overviewNetwork:{},id:Cp,inspect:{dsl:[],response:[]},isInspected:!1,refetch:o.current}),{addError:h,addWarning:y}=Object(Oe.a)(),v=Object(n.useCallback)((e=>{if(null==e||i)return;const t=async()=>{l.current=new AbortController,d(!0),c.current=s.search.search(e,{strategy:"securitySolutionSearchStrategy",abortSignal:l.current.signal}).subscribe({next:e=>{Object(zl.isCompleteResponse)(e)?(d(!1),b((t=>({...t,overviewNetwork:e.overviewNetwork,inspect:Object(pr.b)(e,t.inspect),refetch:o.current}))),c.current.unsubscribe()):Object(zl.isErrorResponse)(e)&&(d(!1),y(Op),c.current.unsubscribe())},error:e=>{d(!1),h(e,{title:jp}),c.current.unsubscribe()}})};c.current.unsubscribe(),l.current.abort(),t(),o.current=t}),[s.search,h,y,i]);return Object(n.useEffect)((()=>{f((n=>{const i={...null!=n?n:{},defaultIndex:a,factoryQueryType:uu.q.overview,filterQuery:Object(cr.a)(e),timerange:{interval:"12h",from:r,to:t}};return Ki()(n,i)?n:i}))}),[a,t,e,r]),Object(n.useEffect)((()=>(v(p),()=>{c.current.unsubscribe(),l.current.abort()})),[p,v]),[u,g]})({endDate:e,filterQuery:t,indexNames:a,startDate:r,skip:void 0===t}),E=Object(n.useCallback)((e=>{e.preventDefault(),d(o.l,{deepLinkId:s.a.network,path:Object(f.j)(u)})}),[d,u]),T=Object(n.useMemo)((()=>Ip(b).reduce(((e,t)=>e+t.count),0)),[b]),k=Object(n.useMemo)((()=>ze()(T).format(p)),[p,T]),x=Object(n.useMemo)((()=>i.a.createElement(Ht.g,{"data-test-subj":"overview-network-go-to-network-page",onClick:E,href:c(Object(f.j)())},i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.overview.networkAction",defaultMessage:"View network"}))),[E,c]),S=Object(n.useMemo)((()=>i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.overview.networkTitle",defaultMessage:"Network events"})),[]),w=Object(n.useMemo)((()=>Object(me.isEmpty)(b)?i.a.createElement(i.a.Fragment,null,""):i.a.createElement(oa.FormattedMessage,{defaultMessage:"Showing: {formattedNetworkEventsCount} {networkEventsCount, plural, one {event} other {events}}",id:"xpack.securitySolution.overview.overviewNetwork.networkSubtitle",values:{formattedNetworkEventsCount:k,networkEventsCount:T}})),[k,T,b]);return i.a.createElement(_.EuiFlexItem,null,i.a.createElement(za.b,null,i.a.createElement(_.EuiPanel,{hasBorder:!0,"data-test-subj":"overview-network-query"},i.a.createElement(i.a.Fragment,null,i.a.createElement(La.a,{id:Cp,subtitle:w,title:S,isInspectDisabled:void 0===t},x),i.a.createElement(Fp,{loading:g,data:b,id:h,inspect:y,setQuery:l,refetch:v})))))};_p.displayName="OverviewNetworkComponent";const Np=i.a.memo(_p),Lp=L()(_.EuiFlexItem).withConfig({displayName:"HorizontalSpacer",componentId:"sc-1b49qwl-0"})(["width:24px;"]),Bp=({filters:e,from:t,indexNames:a,indexPattern:r,query:s,setQuery:o,to:l})=>{const{uiSettings:c}=Object(m.j)().services,[u,d]=Object(n.useMemo)((()=>Object(ps.b)({config:xe.esQuery.getEsQueryConfig(c),indexPattern:r,queries:[s],filters:[...e,...uo.b]})),[e,r,s,c]),[p]=Object(n.useMemo)((()=>Object(ps.b)({config:xe.esQuery.getEsQueryConfig(c),indexPattern:r,queries:[s],filters:[...e,...wu]})),[e,r,c,s]);return Object(je.a)({id:dp,filterQuery:u||p,kqlError:d,query:s,startDate:t,endDate:l}),i.a.createElement(_.EuiFlexGroup,{gutterSize:"none",justifyContent:"spaceBetween"},i.a.createElement(_.EuiFlexItem,{grow:!0},i.a.createElement(wp,{endDate:l,filterQuery:u,indexNames:a,startDate:t,setQuery:o})),i.a.createElement(Lp,{grow:!1}),i.a.createElement(_.EuiFlexItem,{grow:!0},i.a.createElement(Np,{endDate:l,filterQuery:p,indexNames:a,startDate:t,setQuery:o})))},zp=i.a.memo(Bp),Hp=(S.i18n.translate("xpack.securitySolution.recentTimelines.errorRetrievingUserDetailsMessage",{defaultMessage:"Recent Timelines: An error occurred while retrieving user details"}),S.i18n.translate("xpack.securitySolution.recentTimelines.favoritesButtonLabel",{defaultMessage:"Favorites"})),Up=S.i18n.translate("xpack.securitySolution.recentTimelines.noFavoriteTimelinesMessage",{defaultMessage:"You haven't favorited any timelines yet. Get out there and start threat hunting!"}),$p=S.i18n.translate("xpack.securitySolution.recentTimelines.lastUpdatedButtonLabel",{defaultMessage:"Last updated"}),Qp=S.i18n.translate("xpack.securitySolution.recentTimelines.noTimelinesMessage",{defaultMessage:"You haven't created any timelines yet. Get out there and start threat hunting!"}),Vp=S.i18n.translate("xpack.securitySolution.recentTimelines.notesTooltip",{defaultMessage:"Notes"}),Wp=S.i18n.translate("xpack.securitySolution.recentTimelines.openAsDuplicateTooltip",{defaultMessage:"Open as a timeline duplicate"}),Gp=S.i18n.translate("xpack.securitySolution.recentTimelines.openAsDuplicateTemplateTooltip",{defaultMessage:"Open as a template duplicate"}),Kp=S.i18n.translate("xpack.securitySolution.recentTimelines.pinnedEventsTooltip",{defaultMessage:"Pinned events"}),Yp=S.i18n.translate("xpack.securitySolution.recentTimelines.untitledTimelineLabel",{defaultMessage:"Untitled timeline"}),Jp=S.i18n.translate("xpack.securitySolution.recentTimelines.viewAllTimelinesLink",{defaultMessage:"View all timelines"}),Xp=S.i18n.translate("xpack.securitySolution.recentTimelines.filterControlLegend",{defaultMessage:"Timelines filter"}),Zp=[{id:"favorites",label:Hp,iconType:"starFilled"},{id:"recently-updated",label:$p,iconType:"documentEdit"}],em=i.a.memo((({filterBy:e,setFilterBy:t})=>i.a.createElement(_.EuiButtonGroup,{options:Zp,idSelected:e,onChange:e=>{t(e)},isIconOnly:!0,legend:Xp})));em.displayName="Filters";var tm=a(360),am=a(172),nm=a(14);const im=i.a.memo((({onOpenTimeline:e,timeline:t,timeline:{title:a,savedObjectId:r}})=>{const s=Object(n.useCallback)((()=>e({duplicate:!1,timelineId:`${r}`})),[e,r]);return i.a.createElement(_.EuiText,{size:"s"},i.a.createElement(_.EuiLink,{onClick:s},Object(am.f)(t)?Yp:a))}));im.displayName="RecentTimelineHeader";var rm=a(447);const sm=L()(_.EuiIcon).withConfig({displayName:"Icon",componentId:"sc-1ht70gq-0"})(["margin-right:8px;"]),om=L()(_.EuiFlexGroup).withConfig({displayName:"FlexGroup",componentId:"sc-1ht70gq-1"})(["margin-right:16px;"]),lm=i.a.memo((({count:e,icon:t,tooltip:a})=>i.a.createElement(_.EuiToolTip,{content:a},i.a.createElement(om,{alignItems:"center",gutterSize:"none"},i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(sm,{color:"subdued",size:"s",type:t})),i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(_.EuiText,{color:"subdued",size:"xs"},e))))));lm.displayName="IconWithCount";const cm=i.a.memo((({timeline:e})=>i.a.createElement("div",null,i.a.createElement(lm,{count:Object(am.e)(e),icon:"pinFilled",tooltip:Kp}),i.a.createElement(lm,{count:Object(am.d)(e),icon:"editorComment",tooltip:Vp}))));cm.displayName="RecentTimelineCounts";const um=i.a.memo((({timeline:e,onOpenTimeline:t,isLastItem:a})=>{const r=Object(n.useCallback)((()=>t({duplicate:!0,timelineId:`${e.savedObjectId}`})),[t,e.savedObjectId]),s=Object(n.useCallback)((a=>i.a.createElement(_.EuiFlexGroup,{gutterSize:"none",justifyContent:"spaceBetween","data-test-subj":"overview-recent-timelines"},i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(im,{onOpenTimeline:t,timeline:e}),i.a.createElement(cm,{timeline:e}),e.description&&e.description.length&&i.a.createElement(_.EuiText,{color:"subdued",size:"xs"},e.description)),a&&i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(_.EuiToolTip,{content:e.timelineType===h.x.default?Wp:Gp},i.a.createElement(_.EuiButtonIcon,{"aria-label":e.timelineType===h.x.default?Wp:Gp,"data-test-subj":"open-duplicate",isDisabled:null==e.savedObjectId,iconSize:"s",iconType:"copy",onClick:r,size:"s"}))))),[r,t,e]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(rm.a,{render:s}),i.a.createElement(i.a.Fragment,null,!a&&i.a.createElement(_.EuiSpacer,{size:"l"})))}));um.displayName="RecentTimelinesItem";const dm=i.a.memo((({noTimelinesMessage:e,onOpenTimeline:t,timelines:a})=>{const r=Object(n.useMemo)((()=>a.map(((e,n)=>i.a.createElement(um,{key:`${e.savedObjectId}-${e.title}`,timeline:e,onOpenTimeline:t,isLastItem:n===a.length-1})))),[t,a]);return 0===a.length?i.a.createElement(i.a.Fragment,null,i.a.createElement(_.EuiText,{color:"subdued",size:"s"},e)):i.a.createElement(i.a.Fragment,null,r)}));dm.displayName="RecentTimelines";const pm=({lines:e,placeholders:t})=>i.a.createElement(i.a.Fragment,null,[...Array(t).keys()].map(((a,n)=>i.a.createElement(i.a.Fragment,{key:n},i.a.createElement(_.EuiLoadingContent,{lines:e}),n!==t-1&&i.a.createElement(_.EuiSpacer,{size:"l"})))));pm.displayName="LoadingPlaceholdersComponent";const mm=i.a.memo(pm);var fm=a(627);const gm=({filterBy:e})=>{const t=Object(b.useDispatch)(),a=Object(n.useCallback)((e=>t(Object(nm.updateIsLoading)(e))),[t]),r=Object(n.useMemo)((()=>Object(am.b)(t)),[t]),{formatUrl:l}=Object(f.n)(s.a.timelines),{navigateToApp:c}=Object(m.j)().services.application,u=Object(n.useCallback)((({duplicate:e,timelineId:t})=>{Object(am.h)({duplicate:e,timelineId:t,updateIsLoading:a,updateTimeline:r})}),[a,r]),d=Object(n.useCallback)((e=>{e.preventDefault(),c(o.l,{deepLinkId:s.a.timelines})}),[c]),p="favorites"===e?Up:Qp,g=Object(n.useMemo)((()=>i.a.createElement(Ht.f,{onClick:d,href:l("")},Jp)),[d,l]),y=Object(n.useMemo)((()=>i.a.createElement(mm,{lines:2,placeholders:"favorites"===e?1:3})),[e]),{fetchAllTimeline:v,timelines:E,loading:T}=Object(tm.b)(),k=h.x.default,{timelineStatus:x}=Object(fm.a)({timelineType:k});return Object(n.useEffect)((()=>{v({pageInfo:{pageIndex:1,pageSize:3},search:"",sort:{sortField:h.l.updated,sortOrder:Bi.a.desc},onlyUserFavorite:"favorites"===e,status:x,timelineType:k})}),[v,e,x,k]),i.a.createElement(i.a.Fragment,null,T?y:i.a.createElement(dm,{noTimelinesMessage:p,onOpenTimeline:u,timelines:null!=E?E:[]}),i.a.createElement(_.EuiHorizontalRule,{margin:"s"}),i.a.createElement(_.EuiText,{size:"xs"},g))};gm.displayName="StatefulRecentTimelinesComponent";const bm=i.a.memo(gm),hm="en",ym=[],vm=e=>{const t=(a=hm,""===document.documentElement.lang?a:null!==(n=document.documentElement.lang)&&void 0!==n?n:a);var a,n;return null==e||null==e.items?ym:e.items.filter((e=>null!=e)).map((e=>{var a,n,i,r,s,o,l,c,u,d,p;return{description:null!==(a=null!==(n=Object(me.get)(t,e.description))&&void 0!==n?n:Object(me.get)(hm,e.description))&&void 0!==a?a:"",expireOn:new Date(null!==(i=e.expire_on)&&void 0!==i?i:""),hash:null!==(r=e.hash)&&void 0!==r?r:Na.a.v4(),imageUrl:null!==(s=null!==(o=Object(me.get)(t,e.image_url))&&void 0!==o?o:Object(me.get)(hm,e.image_url))&&void 0!==s?s:null,linkUrl:null!==(l=null!==(c=Object(me.get)(t,e.link_url))&&void 0!==c?c:Object(me.get)(hm,e.link_url))&&void 0!==l?l:"",publishOn:new Date(null!==(u=e.publish_on)&&void 0!==u?u:""),title:null!==(d=null!==(p=Object(me.get)(t,e.title))&&void 0!==p?p:Object(me.get)(hm,e.title))&&void 0!==d?d:""}}))},Em=i.a.memo((({children:e,title:t})=>i.a.createElement(i.a.Fragment,null,i.a.createElement(_.EuiFlexGroup,{alignItems:"center",gutterSize:"none",justifyContent:"spaceBetween"},i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(_.EuiTitle,{size:"xs"},i.a.createElement("h2",null,t))),i.a.createElement(_.EuiFlexItem,{grow:!1},e)),i.a.createElement(_.EuiHorizontalRule,{margin:"s"}))));Em.displayName="SidebarHeader";const Tm=S.i18n.translate("xpack.securitySolution.newsFeed.noNewsMessage",{defaultMessage:"Your current news feed URL returned no recent news."}),km=S.i18n.translate("xpack.securitySolution.newsFeed.noNewsMessageForAdmin",{defaultMessage:"Your current news feed URL returned no recent news. You may update the URL or disable security news via"}),xm=S.i18n.translate("xpack.securitySolution.newsFeed.advancedSettingsLinkTitle",{defaultMessage:"Security Solution advanced settings"}),Sm=i.a.memo((()=>{var e;const{getUrlForApp:t,navigateToApp:a,capabilities:r}=Object(m.j)().services.application,s=null!==(e=r.management.kibana.settings)&&void 0!==e&&e,o=Object(n.useCallback)((()=>a("management",{path:"/kibana/settings"})),[a]);return i.a.createElement(_.EuiText,{color:"subdued",size:"s"},s?km:Tm,s&&i.a.createElement(i.a.Fragment,null," ",i.a.createElement(Ht.f,{onClick:o,href:`${t("management",{path:"/kibana/settings"})}`},xm),"."))}));Sm.displayName="NoNews";const wm=({href:e,children:t})=>i.a.createElement(_.EuiLink,{href:e,rel:"noopener nofollow noreferrer",target:"_blank"},t),Om=L.a.img.withConfig({displayName:"NewsItemPreviewImage",componentId:"sc-e9sq8j-0"})(["height:56px;margin-left:16px;min-width:56px;padding:4px;width:56px;"]),jm=i.a.memo((({newsItem:e})=>{const{linkUrl:t,title:a,publishOn:n,description:r,imageUrl:s}=e;return(({publishOn:e,expireOn:t})=>Jn()(Date.now()).isAfter(e)&&Jn()(Date.now()).isBefore(t))(e)?i.a.createElement(_.EuiFlexGroup,{gutterSize:"none",justifyContent:"spaceBetween"},i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(wm,{href:t},i.a.createElement(_.EuiText,{size:"s"},a)),i.a.createElement(_.EuiText,{color:"subdued",size:"xs"},i.a.createElement(ws.e,{value:n}),i.a.createElement(_.EuiSpacer,{size:"s"}),i.a.createElement("div",null,r),i.a.createElement(_.EuiSpacer,{size:"l"}))),i.a.createElement(_.EuiFlexItem,{grow:!1},s&&i.a.createElement(wm,{href:t},i.a.createElement(Om,{alt:a,className:"euiPanel",src:s})))):null}));jm.displayName="Post";const Cm=({news:e})=>i.a.createElement(i.a.Fragment,null,i.a.createElement(Em,{title:tp.b}),null==e?i.a.createElement(mm,{lines:4,placeholders:5}):0===e.length?i.a.createElement(Sm,null):e.map((e=>i.a.createElement(jm,{key:e.hash,newsItem:e}))));Cm.displayName="NewsFeedComponent";const Im=i.a.memo(Cm),Mm=i.a.memo((({enableNewsFeedSetting:e,newsFeedSetting:t})=>{const a=Object(m.j)().services.newsfeed,[r]=Object(m.o)(e),[s]=Object(m.o)(t),[o,l]=Object(n.useState)(null),c=a&&r,u=(({newsFeedUrlSetting:e,getKibanaVersion:t})=>{return[null==e?void 0:e.trim().replace(/\/$/,""),`v${a=t(),null!==(n=null==a?void 0:a.replace(/-SNAPSHOT/gi,""))&&void 0!==n?n:a}.json`].join("/");var a,n})({newsFeedUrlSetting:s,getKibanaVersion:()=>m.b.getKibanaVersion()});return Object(n.useEffect)((()=>{let e=!1;const t=async()=>{try{const t=await(async({newsFeedUrl:e})=>m.b.get().http.fetch(e,{method:"GET",credentials:"omit",mode:"cors"}))({newsFeedUrl:u});e||l(vm(t))}catch{e||l([])}};return c&&t(),()=>{e=!0}}),[c,u]),i.a.createElement(i.a.Fragment,null,c?i.a.createElement(Im,{news:o}):null)}));Mm.displayName="StatefulNewsFeed";var Am=a(265);const qm=()=>{var e,t;const{formatUrl:a}=Object(f.n)(s.a.case),{cases:n,application:{navigateToApp:i}}=Object(m.j)().services,r=null!==(e=null===(t=Object(m.h)())||void 0===t?void 0:t.crud)&&void 0!==e&&e;return n.getRecentCases({allCasesNavigation:{href:a(Object(Am.c)()),onClick:async e=>(null==e||e.preventDefault(),i(o.l,{deepLinkId:s.a.case}))},caseDetailsNavigation:{href:({detailName:e,subCaseId:t})=>a(Object(Am.a)({id:e,subCaseId:t})),onClick:async({detailName:e,subCaseId:t,search:a},n)=>(null==n||n.preventDefault(),i(o.l,{deepLinkId:s.a.case,path:Object(Am.a)({id:e,search:a,subCaseId:t})}))},createCaseNavigation:{href:a(Object(Am.e)()),onClick:async e=>(null==e||e.preventDefault(),i(o.l,{deepLinkId:s.a.case,path:Object(Am.e)()}))},hasWritePermissions:r,maxCasesToShow:3,owner:[o.l]})};qm.displayName="RecentCasesComponent";const Dm=i.a.memo(qm),Pm=L()(_.EuiFlexGroup).withConfig({displayName:"SidebarFlexGroup",componentId:"sc-s31pt6-0"})(["width:305px;"]),Rm=()=>i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(_.EuiSpacer,{size:"xxl"}));Rm.displayName="SidebarSpacerComponent";const Fm=i.a.memo(Rm),_m=i.a.memo((({recentTimelinesFilterBy:e,setRecentTimelinesFilterBy:t})=>{var a;const r=Object(n.useMemo)((()=>i.a.createElement(em,{filterBy:e,setFilterBy:t})),[e,t]),s=null===(a=Object(m.h)())||void 0===a?void 0:a.read;return i.a.createElement(Pm,{direction:"column",gutterSize:"none"},s&&i.a.createElement(i.a.Fragment,null,i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(Dm,null)),i.a.createElement(Fm,null)),i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(Em,{title:tp.c},r),i.a.createElement(bm,{filterBy:e})),i.a.createElement(Fm,null),i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(Mm,{enableNewsFeedSetting:o.ib,newsFeedSetting:o.xb})))}));_m.displayName="Sidebar";const Nm=i.a.memo((()=>{const[e,t]=Object(n.useState)("favorites");return i.a.createElement(_m,{recentTimelinesFilterBy:e,setRecentTimelinesFilterBy:t})}));Nm.displayName="StatefulSidebar";var Lm=a(791),Bm=a(224);const zm=Object(n.memo)((({onDismiss:e})=>{const{getUrlForApp:t}=Object(m.j)().services.application,a=Object(I.g)({name:"endpointList"}),n=t(o.l,{path:a}),r=Object(Bm.a)(o.l,{path:a});return i.a.createElement(_.EuiCallOut,{"data-test-subj":"endpoint-prompt-banner",iconType:"cheer",title:i.a.createElement(i.a.Fragment,null,i.a.createElement("b",null,i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.overview.endpointNotice.introducing",defaultMessage:"Introducing: "})),i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.overview.endpointNotice.title",defaultMessage:"Endpoint Security"}))},i.a.createElement(i.a.Fragment,null,i.a.createElement("p",null,i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.overview.endpointNotice.message",defaultMessage:"Protect your hosts with threat prevention, detection, and deep security data visibility."})),i.a.createElement(_.EuiButton,{onClick:r,href:n},i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.overview.endpointNotice.tryButton",defaultMessage:"Try Endpoint Security"})),i.a.createElement(_.EuiButtonEmpty,{onClick:e},i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.overview.endpointNotice.dismiss",defaultMessage:"Dismiss message"}))))}));zm.displayName="EndpointNotice";var Hm=a(772),Um=a(151),$m=a(540);const Qm=(e,t)=>{const{uiSettings:a}=Object(m.j)().services,i=a.get(o.R),[r]=Object(ps.b)({config:Object(xe.getEsQueryConfig)(a),indexPattern:{fields:[{name:"event.kind",type:"string"}],title:i.toString()},queries:[{query:"event.type:indicator",language:"kuery"}],filters:[]}),s=Object(n.useMemo)((()=>({endDate:e,errorMessage:S.i18n.translate("xpack.securitySolution.overview.errorFetchingEvents",{defaultMessage:"Error fetching events"}),filterQuery:r,histogramType:Bi.q.events,indexNames:i,stackByField:Um.e,startDate:t,size:0})),[e,t,r,i]);return Object($m.a)(s)},Vm=Object.keys(Um.a).map((e=>({title:e,count:0,path:""}))),Wm={type:"tag",search:"threat intel",searchFields:["name"]},Gm=Object.values(Um.a).reduce(((e,t)=>(e[t]=0,e)),{}),Km="ctiEventCountQuery";var Ym=a(417);const Jm=(e,t,a)=>{var i,r;const s=null===(i=Object(m.j)().services.dashboard)||void 0===i||null===(r=i.dashboardUrlGenerator)||void 0===r?void 0:r.createUrl,o=Object(m.j)().services.savedObjects.client,[l,c]=Object(n.useState)(),[u,d]=Object(n.useState)(Vm),[p,f]=Object(n.useState)(!1),g=Object(n.useCallback)((()=>{var t;p||f(!0),d((t=e,Vm.map((e=>{var a;return{...e,count:null!==(a=t[Um.a[e.title]])&&void 0!==a?a:0}}))))}),[f,d,e,p]),b=Object(n.useCallback)((e=>{var t;if(null!=e&&null!==(t=e.savedObjects)&&void 0!==t&&t.length)return o.find({type:"dashboard",hasReference:{id:e.savedObjects[0].id,type:"tag"}})}),[o]);return Object(n.useEffect)((()=>{s&&o?o.find(Wm).then(b).then((async n=>{var i;if(null!=n&&null!==(i=n.savedObjects)&&void 0!==i&&i.length){var r;const i=await Promise.all(n.savedObjects.map((e=>s({dashboardId:e.id,timeRange:{to:t,from:a}})))),o=null===(r=n.savedObjects)||void 0===r?void 0:r.reduce(((t,a,n)=>{const r=((e,t,a)=>{var n;const i="string"==typeof(null===(n=e.attributes)||void 0===n?void 0:n.title)?e.attributes.title.replace("[Filebeat Threat Intel] ",""):void 0;return{title:i,count:"string"==typeof i?t[Um.a[i]]:void 0,path:a}})(a,e,i[n]);return(e=>"Overview"===e.title)(r)?c(r.path):Object(Ym.c)(r)&&t.push(r),t}),[]).sort(((e,t)=>e.title>t.title?1:-1));d(o)}else g()})):g()}),[s,e,a,g,b,p,o,t]),{buttonHref:l,isPluginDisabled:p,listItems:u}};var Xm=a(376);const Zm=(e,t)=>{const a=e.toFixed(t);return+a<=e?a:(+a-Math.pow(.1,t)).toFixed(t)};var ef=a(636),tf=a(458);const af=[{name:"Name",field:"title",sortable:!0,truncateText:!0,width:"100%"},{name:"Indicator",field:"count",render:e=>{var t;if(e<1e4)return e.toString();const{magnitude:a,unit:n}=null!==(t=[{magnitude:1e18,unit:"E"},{magnitude:1e15,unit:"P"},{magnitude:1e12,unit:"T"},{magnitude:1e9,unit:"B"},{magnitude:1e6,unit:"M"},{magnitude:1e3,unit:"K"}].find((t=>e>=t.magnitude)))&&void 0!==t?t:{magnitude:1,unit:""};return Zm(e/a,1).replace(/\.0+$|(\.[0-9]*[1-9])0+$/,"$1")+n},sortable:!0,truncateText:!0,width:"20%",align:"right"},{name:"",field:"path",truncateText:!0,width:"80px",render:e=>i.a.createElement(ef.a,{path:e,copy:tf.d})}],nf=({buttonHref:e="",isPluginDisabled:t,isInspectEnabled:a=!0,listItems:r,splitPanel:s,totalCount:o=0})=>{const l=`${Object(m.j)().services.docLinks.links.filebeat.base}/load-kibana-dashboards.html`;return i.a.createElement(Ym.b,{button:Object(n.useMemo)((()=>i.a.createElement(_.EuiButton,{href:e,isDisabled:!e,"data-test-subj":"cti-view-dashboard-button",target:"_blank"},Xm.h)),[e]),columns:af,dataTestSubj:"cti-dashboard-links",infoPanel:Object(n.useMemo)((()=>t?i.a.createElement(Ym.a,{dataTestSubj:"cti-inner-panel-info",color:"primary",title:Xm.f,body:Xm.d,button:i.a.createElement(_.EuiButton,{href:l,target:"_blank"},Xm.e)}):null),[t,l]),inspectQueryId:a?Km:void 0,listItems:r,panelTitle:Xm.g,splitPanel:s,subtitle:Object(n.useMemo)((()=>i.a.createElement(oa.FormattedMessage,{"data-test-subj":"cti-total-event-count",defaultMessage:"Showing: {totalCount} {totalCount, plural, one {indicator} other {indicators}}",id:"xpack.securitySolution.overview.ctiDashboardSubtitle",values:{totalCount:o}})),[o])})},rf=i.a.createElement(Ym.a,{color:"warning",title:Xm.j,body:Xm.i,dataTestSubj:"cti-inner-panel-warning"}),sf=({to:e,from:t})=>{const{buttonHref:a,listItems:n,isPluginDisabled:r}=Jm(Gm,e,t);return i.a.createElement(nf,{buttonHref:a,listItems:n,splitPanel:rf,isPluginDisabled:r})},of=i.a.memo(sf);of.displayName="CtiNoEvents";var lf=a(58),cf=a.n(lf);const uf=({eventCountsByDataset:e,from:t,to:a,totalCount:n})=>{const{buttonHref:r,isPluginDisabled:s,listItems:o}=Jm(e,a,t);return i.a.createElement(nf,{buttonHref:r,isPluginDisabled:s,listItems:o,totalCount:n})};uf.displayName="CtiWithEvents";const df=i.a.memo(uf,((e,t)=>e.to===t.to&&e.from===t.from&&e.totalCount===t.totalCount&&Object(lf.isEqual)(e.eventCountsByDataset,t.eventCountsByDataset))),pf=e=>{const{eventCountsByDataset:t,totalCount:a}=(({deleteQuery:e,from:t,setQuery:a,to:i})=>{const[r,s]=Object(n.useState)(!0),[o,{data:l,inspect:c,totalCount:u,refetch:d}]=Qm(i,t),p=Object(n.useMemo)((()=>l.reduce(((e,t)=>(t.y&&t.g&&(e[t.g]+=t.y),e)),{...Gm})),[l]);return Object(n.useEffect)((()=>{r&&l&&s(!1)}),[r,l]),Object(n.useEffect)((()=>{o||r||a({id:Km,inspect:c,loading:o,refetch:d})}),[a,c,o,d,r,s]),Object(n.useEffect)((()=>()=>{e&&e({id:Km})}),[e]),Object(n.useEffect)((()=>{d()}),[i,t,d]),{eventCountsByDataset:p,loading:o,totalCount:u}})(e),{to:r,from:s}=e;switch(a){case-1:return null;case 0:return i.a.createElement("div",{"data-test-subj":"cti-with-no-events"},i.a.createElement(of,{to:r,from:s}));default:return i.a.createElement("div",{"data-test-subj":"cti-with-events"},i.a.createElement(df,{eventCountsByDataset:t,totalCount:a,to:r,from:s}))}},mf=i.a.memo(pf);mf.displayName="CtiEnabledModule";var ff=a(635);const gf=()=>{const e=`${Object(m.j)().services.docLinks.links.filebeat.base}/filebeat-module-threatintel.html`;return i.a.createElement(ff.a,{bodyCopy:Xm.a,buttonCopy:Xm.b,dataTestSubjPrefix:"cti",docLink:e,listItems:Vm,titleCopy:Xm.c,LinkPanelViewComponent:nf})},bf=i.a.memo(gf);bf.displayName="CtiDisabledModule";const hf=e=>{switch(e.isThreatIntelModuleEnabled){case!0:return i.a.createElement("div",{"data-test-subj":"cti-enabled-module"},i.a.createElement(mf,e));case!1:return i.a.createElement("div",{"data-test-subj":"cti-disabled-module"},i.a.createElement(bf,null));default:return null}},yf=i.a.memo(hf);yf.displayName="ThreatIntelDashboardLinksComponent";var vf=a(766),Ef=a(634),Tf=a(536);const kf=({timerange:e})=>{const t=Object(Tf.b)({timerange:e});switch(null==t?void 0:t.isModuleEnabled){case!0:return i.a.createElement(vf.a,{to:e.to,from:e.from,hostRiskScore:t});case!1:return i.a.createElement(Ef.b,null);default:return null}},xf=i.a.memo(kf);xf.displayName="RiskyHostLinks";const Sf=L()(_.EuiFlexItem).withConfig({displayName:"SidebarFlexItem",componentId:"sc-g6j99s-0"})(["margin-right:24px;"]),wf=L()(d.a).withConfig({displayName:"StyledSecuritySolutionPageWrapper",componentId:"sc-g6j99s-1"})(["overflow-x:auto;"]),Of=()=>{const e=Object(n.useMemo)((()=>Ie.e.globalFiltersQuerySelector()),[]),t=Object(n.useMemo)((()=>Ie.e.globalQuerySelector()),[]),a=Object(be.a)(t),r=Object(be.a)(e),{from:l,deleteQuery:c,setQuery:d,to:p}=Object(he.a)(),{indicesExist:m,indexPattern:f,selectedPatterns:g}=Object(v.c)(),b=Object(n.useMemo)((()=>[o.kb]),[]),[,{indexExists:h}]=Object(op.b)(b,!0),{addMessage:y,hasMessage:T}=Zt(),k=Object(n.useMemo)((()=>T("management","dismissEndpointNotice")),[T]),[x,S]=Object(n.useState)(k),w=Object(n.useCallback)((()=>{S(!0),y("management","dismissEndpointNotice")}),[y]),{endpointPrivileges:{canAccessFleet:O}}=Object(Rt.b)(),{hasIndexRead:j,hasKibanaREAD:C}=Object(tn.a)(),I=(()=>{const[e,t]=Object(n.useState)(),{to:a,from:i}=Object(n.useMemo)((()=>({to:(new Date).toISOString(),from:new Date(0).toISOString()})),[]),[,{totalCount:r}]=Qm(a,i);return Object(n.useEffect)((()=>{-1!==r&&t(r>0)}),[r]),e})(),M=Object(fe.a)("riskyHostsEnabled");return i.a.createElement(i.a.Fragment,null,m?i.a.createElement(i.a.Fragment,null,i.a.createElement(ye.a,null,i.a.createElement(Ee.a,{id:"global",indexPattern:f})),i.a.createElement(wf,null,!x&&!h&&O&&i.a.createElement(i.a.Fragment,null,i.a.createElement(zm,{onDismiss:w}),i.a.createElement(_.EuiSpacer,{size:"l"})),i.a.createElement(Hm.a,{scope:E.SourcererScopeName.default}),i.a.createElement(_.EuiFlexGroup,{gutterSize:"none",justifyContent:"spaceBetween"},i.a.createElement(Sf,{grow:!1},i.a.createElement(Nm,null)),i.a.createElement(_.EuiFlexItem,{grow:!0},i.a.createElement(_.EuiFlexGroup,{direction:"column",gutterSize:"none"},j&&C&&i.a.createElement(i.a.Fragment,null,i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(Lm.a,{filters:r,query:a}),i.a.createElement(_.EuiSpacer,{size:"l"})),i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(sp,{deleteQuery:c,filters:r,from:l,indexPattern:f,indexNames:g,query:a,setQuery:d,to:p}))),i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(lp.a,{deleteQuery:c,filters:r,from:l,indexPattern:f,indexNames:g,query:a,setQuery:d,to:p})),i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(zp,{filters:r,from:l,indexNames:g,indexPattern:f,query:a,setQuery:d,to:p})),i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(_.EuiFlexGroup,{direction:"row"},i.a.createElement(_.EuiFlexItem,{grow:1},i.a.createElement(yf,{isThreatIntelModuleEnabled:I,deleteQuery:c,from:l,setQuery:d,to:p})),i.a.createElement(_.EuiFlexItem,{grow:1},M&&i.a.createElement(xf,{timerange:{from:l,to:p}}))))))))):i.a.createElement(pt.a,null),i.a.createElement(u.a,{pageName:s.a.overview}))},jf=i.a.memo(Of),Cf=Object(n.memo)((()=>i.a.createElement(jf,null)));Cf.displayName="Overview";const If=[{path:o.Db,render:()=>i.a.createElement(r.TrackApplicationView,{viewId:o.Kb.overview},i.a.createElement(Cf,null))}];var Mf=a(298),Af=a(203);var qf=a(0),Df=a(154),Pf=qf.recursion("saved_object_attribute_single",(function(){return qf.union([qf.string,qf.number,qf.boolean,qf.null,qf[void 0],Ff])})),Rf=qf.recursion("saved_object_attribute",(function(){return qf.union([Pf,qf.array(Pf)])})),Ff=qf.recursion("saved_object_attributes",(function(){return qf.record(qf.string,Rf)})),_f=qf.string,Nf=qf.string,Lf=qf.string,Bf=Ff,zf=qf.exact(qf.type({group:_f,id:Nf,action_type_id:Lf,params:Bf})),Hf=qf.array(zf),Uf=(qf.array(qf.exact(qf.type({group:_f,id:Nf,actionTypeId:Lf,params:Bf}))),new qf.Type("DefaultActionsArray",Hf.is,(function(e,t){return null==e?qf.success([]):Hf.validate(e,t)}),qf.identity),new qf.Type("DefaultExportFileName",qf.string.is,(function(e,t){return null==e?qf.success("export.ndjson"):qf.string.validate(e,t)}),qf.identity),a(351)),$f=new qf.Type("From",qf.string.is,(function(e,t){return function(e){return"string"==typeof e}(e)&&null==Object(Uf.a)(e)?qf.failure(e,t,'Failed to parse "from" on rule param'):qf.string.validate(e,t)}),qf.identity),Qf=(qf.union([$f,qf[void 0]]),new qf.Type("DefaultFromString",qf.string.is,(function(e,t){return null==e?qf.success("now-6m"):$f.validate(e,t)}),qf.identity),new qf.Type("DefaultIntervalString",qf.string.is,(function(e,t){return null==e?qf.success("5m"):qf.string.validate(e,t)}),qf.identity),qf.keyof({eql:null,kuery:null,lucene:null})),Vf=(qf.union([Qf,qf[void 0]]),new qf.Type("DefaultLanguageString",qf.string.is,(function(e,t){return null==e?qf.success("kuery"):Qf.validate(e,t)}),qf.identity),a(5)),Wf=Vf.l,Gf=(qf.union([Wf,qf[void 0]]),new qf.Type("DefaultMaxSignals",qf.number.is,(function(e,t){return null==e?qf.success(100):Wf.validate(e,t)}),qf.identity),new qf.Type("DefaultPerPage",qf.number.is,(function(e,t){return null==e?qf.success(1):"string"==typeof e?Vf.l.validate(parseInt(e,10),t):Vf.l.validate(e,t)}),qf.identity),new qf.Type("DefaultPerPage",qf.number.is,(function(e,t){return null==e?qf.success(20):"string"==typeof e?Vf.l.validate(parseInt(e,10),t):Vf.l.validate(e,t)}),qf.identity),new qf.Type("RiskScore",qf.number.is,(function(e,t){return"number"==typeof e&&Number.isSafeInteger(e)&&e>=0&&e<=100?qf.success(e):qf.failure(e,t)}),qf.identity)),Kf=qf.union([Gf,qf[void 0]]),Yf=qf.string,Jf=qf.string,Xf=qf.exact(qf.type({field:Yf,value:Jf,operator:Vf.q,risk_score:Kf})),Zf=qf.array(Xf),eg=(qf.union([Zf,qf[void 0]]),new qf.Type("DefaultRiskScoreMappingArray",Zf.is,(function(e,t){return null==e?qf.success([]):Zf.validate(e,t)}),qf.identity),qf.keyof({low:null,medium:null,high:null,critical:null})),tg=(qf.union([eg,qf[void 0]]),qf.string),ag=qf.string,ng=qf.exact(qf.type({field:tg,operator:Vf.q,value:ag,severity:eg})),ig=qf.array(ng),rg=(qf.union([ig,qf[void 0]]),new qf.Type("DefaultSeverityMappingArray",ig.is,(function(e,t){return null==e?qf.success([]):ig.validate(e,t)}),qf.identity),qf.string),sg=qf.string,og=qf.string,lg=qf.type({id:rg,name:sg,reference:og}),cg=qf.string,ug=qf.string,dg=qf.string,pg=qf.type({id:cg,name:ug,reference:dg}),mg=qf.array(pg),fg=qf.string,gg=qf.string,bg=qf.string,hg=qf.intersection([qf.exact(qf.type({id:fg,name:gg,reference:bg})),qf.exact(qf.partial({subtechnique:mg}))]),yg=qf.array(hg),vg=qf.string,Eg=qf.intersection([qf.exact(qf.type({framework:vg,tactic:lg})),qf.exact(qf.partial({technique:yg}))]),Tg=qf.array(Eg),kg=(qf.union([Tg,qf[void 0]]),new qf.Type("DefaultThreatArray",Tg.is,(function(e,t){return null==e?qf.success([]):Tg.validate(e,t)}),qf.identity),qf.string),xg=(qf.union([kg,qf.null]),qf.union([kg,qf.null,qf[void 0]]),new qf.Type("DefaultThreatNull",kg.is,(function(e,t){return null==e?qf.success(null):kg.validate(e,t)}),qf.identity),new qf.Type("DefaultToString",qf.string.is,(function(e,t){return null==e?qf.success("now"):qf.string.validate(e,t)}),qf.identity),new qf.Type("DefaultUuid",qf.string.is,(function(e,t){return null==e?qf.success(Na.a.v4()):Vf.i.validate(e,t)}),qf.identity),Object(Vf.h)(qf.string)),Sg=(qf.union([xg,qf[void 0]]),qf.union([qf.string,xg])),wg=(qf.union([Sg,qf[void 0]]),new qf.Type("referencesWithDefaultArray",qf.array(qf.string).is,(function(e,t){return null==e?qf.success([]):qf.array(qf.string).validate(e,t)}),qf.identity),qf.string),Og=(qf.union([wg,qf[void 0]]),qf.string),jg=(qf.union([Og,qf[void 0]]),qf.array(qf.unknown)),Cg=(qf.union([jg,qf[void 0]]),qf.exact(qf.type({field:Vf.i,type:qf.keyof({mapping:null}),value:Vf.i}))),Ig=qf.array(Cg),Mg=qf.exact(qf.type({entries:Ig})),Ag=Object(Vf.h)(Mg,"NonEmptyArray<ThreatMap>"),qg=(qf.union([Ag,qf[void 0]]),qf.array(qf.string)),Dg=(qf.union([qg,qf[void 0]]),qf.union([Qf,qf[void 0]])),Pg=(qf.union([Dg,qf[void 0]]),Vf.l),Rg=(qf.union([Pg,qf[void 0]]),Vf.l),Fg=(qf.union([Rg,qf[void 0]]),qf.keyof({eql:null,machine_learning:null,query:null,saved_query:null,threshold:null,threat_match:null})),_g=(qf.union([Fg,qf[void 0]]),a(11));const Ng=qf.exact(qf.type({group:qf.string,id:qf.string,action_type_id:qf.string,params:qf.record(qf.string,qf.any)})),Lg=qf.intersection([qf.type({from:qf.string}),qf.partial({throttle:qf.string,kibana_siem_app_url:qf.string})]),Bg=qf.intersection([qf.type({author:_g.c,created_at:qf.string,created_by:qf.string,description:qf.string,enabled:qf.boolean,false_positives:qf.array(qf.string),from:qf.string,id:qf.string,interval:qf.string,immutable:qf.boolean,name:qf.string,max_signals:qf.number,references:qf.array(qf.string),risk_score:qf.number,risk_score_mapping:Zf,rule_id:qf.string,severity:qf.string,severity_mapping:ig,tags:qf.array(qf.string),type:Fg,to:qf.string,threat:Tg,updated_at:qf.string,updated_by:qf.string,actions:qf.array(Ng),throttle:qf.union([qf.string,qf.null])}),qf.partial({outcome:qf.union([qf.literal("exactMatch"),qf.literal("aliasMatch"),qf.literal("conflict")]),alias_target_id:qf.string,building_block_type:_g.d,anomaly_threshold:qf.number,filters:qf.array(qf.unknown),index:qf.array(qf.string),language:qf.string,license:_g.e,last_failure_at:qf.string,last_failure_message:qf.string,last_success_message:qf.string,last_success_at:qf.string,meta:Lg,machine_learning_job_id:qf.array(qf.string),output_index:qf.string,query:qf.string,rule_name_override:_g.i,saved_id:qf.string,status:_g.g,status_date:qf.string,threshold:_g.m,threat_query:wg,threat_filters:jg,threat_index:qg,threat_indicator_path:Og,threat_mapping:Ag,threat_language:Dg,timeline_id:qf.string,timeline_title:qf.string,timestamp_override:_g.n,note:qf.string,exceptions_list:Df.x,version:qf.number})]),zg=(qf.array(Bg),e=>{const[t,a]=Object(n.useState)(null),[i,r]=Object(n.useState)(!0),{addError:s}=Object(Oe.a)();return Object(n.useEffect)((()=>{let t=!0;const n=new AbortController;return null!=e&&(async e=>{try{r(!0);const i=Object(Mf.a)(await Object(Nn.g)({id:e,signal:n.signal}));t&&a(i)}catch(e){t&&(a(null),s(e,{title:Af.h}))}t&&r(!1)})(e),()=>{t=!1,n.abort()}}),[e,s]),[i,t]}),Hg=(e,t)=>{switch(t.type){case"setRules":return{...e,rules:t.rules,selectedRuleIds:e.isAllSelected?t.rules.map((({id:e})=>e)):[],loadingRuleIds:[],loadingRulesAction:null,pagination:{...e.pagination,...t.pagination}};case"updateRules":{const a=e.rules.map((e=>e.id)),n=t.rules.reduce(((e,t)=>{let n=e;return n=a.includes(t.id)?n.map((e=>t.id===e.id?t:e)):[...n,t],n}),e.rules),i=t.rules.map((e=>e.id)),r=e.loadingRuleIds.filter((e=>!i.includes(e)));return{...e,rules:n,loadingRuleIds:r,loadingRulesAction:0===r.length?null:e.loadingRulesAction}}case"updateFilterOptions":return{...e,filterOptions:{...e.filterOptions,...t.filterOptions},pagination:{...e.pagination,...t.pagination}};case"loadingRuleIds":return{...e,loadingRuleIds:null==t.actionType?[]:[...e.loadingRuleIds,...t.ids],loadingRulesAction:t.actionType};case"selectedRuleIds":return{...e,isAllSelected:!1,selectedRuleIds:t.ids};case"setLastRefreshDate":return{...e,lastUpdated:Date.now()};case"setAutoRefreshOn":return{...e,isRefreshOn:t.on};case"setIsRefreshing":return{...e,isRefreshing:t.isRefreshing};case"setIsAllSelected":{const{isAllSelected:a}=t;return{...e,isAllSelected:a,selectedRuleIds:a?e.rules.map((({id:e})=>e)):[]}}case"setShowIdleModal":return{...e,showIdleModal:t.show,isRefreshOn:!t.show};case"failure":return{...e,rules:[]};default:return e}},Ug={rules:[],pagination:{page:1,perPage:20,total:0},filterOptions:{filter:"",sortField:"enabled",sortOrder:"desc",tags:[],showCustomRules:!1,showElasticRules:!1},loadingRulesAction:null,loadingRuleIds:[],selectedRuleIds:[],lastUpdated:0,isRefreshOn:!0,isRefreshing:!1,isAllSelected:!1,showIdleModal:!1},$g=({canUserCRUD:e,hasIndexWrite:t,isAuthenticated:a,hasEncryptionKey:r,isSignalIndexExists:s})=>{const[o,l]=Object(n.useState)({createPrePackagedRules:null,refetchPrePackagedRulesStatus:null,rulesCustomInstalled:null,rulesInstalled:null,rulesNotInstalled:null,rulesNotUpdated:null,timelinesInstalled:null,timelinesNotInstalled:null,timelinesNotUpdated:null}),[c,u]=Object(n.useState)(!1),[d,p]=Object(n.useState)(!0),{addError:m,addSuccess:f}=Object(Oe.a)();Object(n.useEffect)((()=>{let n=!0;const i=new AbortController,o=async()=>{try{p(!0);const e=await Object(Nn.j)({signal:i.signal});n&&l({createPrePackagedRules:c,refetchPrePackagedRulesStatus:o,rulesCustomInstalled:e.rules_custom_installed,rulesInstalled:e.rules_installed,rulesNotInstalled:e.rules_not_installed,rulesNotUpdated:e.rules_not_updated,timelinesInstalled:e.timelines_installed,timelinesNotInstalled:e.timelines_not_installed,timelinesNotUpdated:e.timelines_not_updated})}catch(e){n&&(l({createPrePackagedRules:null,refetchPrePackagedRulesStatus:null,rulesCustomInstalled:null,rulesInstalled:null,rulesNotInstalled:null,rulesNotUpdated:null,timelinesInstalled:null,timelinesNotInstalled:null,timelinesNotUpdated:null}),m(e,{title:Af.h}))}n&&p(!1)},c=async()=>new Promise((async d=>{try{if(e&&t&&a&&r&&s){u(!0);const e=await Object(Nn.a)({signal:i.signal});if(n){let t=0,a=-1;const r=()=>{-1!==a&&window.clearTimeout(a)},s=()=>window.setTimeout((async()=>{t+=1;const p=await Object(Nn.j)({signal:i.signal});n&&(0===p.rules_not_installed&&0===p.rules_not_updated&&0===p.timelines_not_installed&&0===p.timelines_not_updated||t>100)?(u(!1),l({createPrePackagedRules:c,refetchPrePackagedRulesStatus:o,rulesCustomInstalled:p.rules_custom_installed,rulesInstalled:p.rules_installed,rulesNotInstalled:p.rules_not_installed,rulesNotUpdated:p.rules_not_updated,timelinesInstalled:p.timelines_installed,timelinesNotInstalled:p.timelines_not_installed,timelinesNotUpdated:p.timelines_not_updated}),f((e=>{const{rules_installed:t,rules_updated:a,timelines_installed:n,timelines_updated:i}=e;return 0===t&&(n>0||i>0)?Af.m:(t>0||a>0)&&0===n?Af.k:Af.j})(e)),r(),d(!0)):a=s()}),300);a=s()}}else d(!1)}catch(e){n&&(u(!1),m(e,{title:Af.i}),d(!1))}}));return o(),()=>{n=!1,i.abort()}}),[e,t,a,r,s,m,f]);const g=Object(n.useMemo)((()=>Ii(o.rulesInstalled,o.rulesNotInstalled,o.rulesNotUpdated)),[o.rulesInstalled,o.rulesNotInstalled,o.rulesNotUpdated]),b=Object(n.useMemo)((()=>Mi(o.timelinesInstalled,o.timelinesNotInstalled,o.timelinesNotUpdated)),[o.timelinesInstalled,o.timelinesNotInstalled,o.timelinesNotUpdated]),h=Object(n.useCallback)((({isDisabled:e,onClick:t,fill:a,"data-test-subj":n="loadPrebuiltRulesBtn"})=>"ruleNotInstalled"!==g&&"timelinesNotInstalled"!==b||"someRuleUninstall"===g?null:i.a.createElement(_.EuiButton,{fill:a,iconType:"indexOpen",isLoading:c,isDisabled:e,onClick:t,"data-test-subj":n},"ruleNotInstalled"===g&&"timelinesNotInstalled"===b&&Af.b,"ruleNotInstalled"===g&&"timelinesNotInstalled"!==b&&Af.a,"ruleNotInstalled"!==g&&"timelinesNotInstalled"===b&&Af.c)),[c,g,b]),y=Object(n.useCallback)(((e,t)=>e>0&&0===t?Af.d(e):0===e&&t>0?Af.f(t):e>0&&t>0?Af.e(e,t):void 0),[]),v=Object(n.useCallback)((({isDisabled:e,onClick:t,fill:a=!1})=>{var n,r;return"someRuleUninstall"===g||"someTimelineUninstall"===b?i.a.createElement(_.EuiButton,{fill:a,iconType:"plusInCircle",isLoading:c,isDisabled:e,onClick:t,"data-test-subj":"reloadPrebuiltRulesBtn"},y(null!==(n=o.rulesNotInstalled)&&void 0!==n?n:0,null!==(r=o.timelinesNotInstalled)&&void 0!==r?r:0)):null}),[y,c,g,b,o.rulesNotInstalled,o.timelinesNotInstalled]);return{loading:d,loadingCreatePrePackagedRules:c,...o,getLoadPrebuiltRulesAndTemplatesButton:h,getReloadPrebuiltRulesAndTemplatesButton:v}},Qg=e=>{const[t,a]=Object(n.useState)(null),i=Object(n.useRef)(null),[r,s]=Object(n.useState)(!0),{addError:o}=Object(Oe.a)();return Object(n.useEffect)((()=>{let t=!0;const n=new AbortController,r=async i=>{try{s(!0);const r=await Object(Nn.k)({id:i,signal:n.signal});t&&a(r[null!=e?e:""])}catch(e){t&&!Object(At.s)(e)&&(a(null),o(e,{title:Af.h}))}t&&s(!1)};return null!=e&&r(e),i.current=r,()=>{t=!1,n.abort()}}),[e,o]),[r,t,i.current]},Vg=e=>{const[t,a]=Object(n.useState)([]),[i,r]=Object(n.useState)(!1),{addError:s}=Object(Oe.a)();return Object(n.useEffect)((()=>{let t=!0;const n=new AbortController;return e.length>0&&(async i=>{try{r(!0);const s=await Object(Nn.l)({ids:i,signal:n.signal});t&&a(e.map((e=>({id:e.id,activate:e.enabled,name:e.name,...s[e.id]}))))}catch(e){t&&(a([]),s(e,{title:Af.h}))}t&&r(!1)})(e.map((e=>e.id))),()=>{t=!1,n.abort()}}),[e,s]),{loading:i,rulesStatuses:t}},Wg=S.i18n.translate("xpack.securitySolution.detectionEngine.rules.prePackagedRules.emptyPromptTitle",{defaultMessage:"Load Elastic prebuilt detection rules"}),Gg=S.i18n.translate("xpack.securitySolution.detectionEngine.rules.prePackagedRules.emptyPromptMessage",{defaultMessage:"Elastic Security comes with prebuilt detection rules that run in the background and create alerts when their conditions are met. By default, all prebuilt rules except the Endpoint Security rule are disabled. You can select additional rules you want to activate."}),Kg=S.i18n.translate("xpack.securitySolution.detectionEngine.rules.prePackagedRules.createOwnRuletButton",{defaultMessage:"Create your own rules"}),Yg=S.i18n.translate("xpack.securitySolution.detectionEngine.rules.updatePrePackagedRulesTitle",{defaultMessage:"Update available for Elastic prebuilt rules or timeline templates"}),Jg=e=>S.i18n.translate("xpack.securitySolution.detectionEngine.rules.updatePrePackagedRulesMsg",{values:{updateRules:e},defaultMessage:"You can update {updateRules} Elastic prebuilt {updateRules, plural, =1 {rule} other {rules}}"}),Xg=(e,t)=>S.i18n.translate("xpack.securitySolution.detectionEngine.rules.updatePrePackagedRulesAndTimelinesMsg",{values:{updateRules:e,updateTimelines:t},defaultMessage:"You can update {updateRules} Elastic prebuilt {updateRules, plural, =1 {rule} other {rules}} and {updateTimelines} Elastic prebuilt {updateTimelines, plural, =1 {timeline} other {timelines}}. Note that this will reload deleted Elastic prebuilt rules."}),Zg=e=>S.i18n.translate("xpack.securitySolution.detectionEngine.rules.updatePrePackagedRulesButton",{values:{updateRules:e},defaultMessage:"Update {updateRules} Elastic prebuilt {updateRules, plural, =1 {rule} other {rules}}"}),eb=e=>S.i18n.translate("xpack.securitySolution.detectionEngine.rules.updatePrePackagedTimelinesButton",{values:{updateTimelines:e},defaultMessage:"Update {updateTimelines} Elastic prebuilt {updateTimelines, plural, =1 {timeline} other {timelines}}"}),tb=(e,t)=>S.i18n.translate("xpack.securitySolution.detectionEngine.rules.updatePrePackagedRulesAndTimelinesButton",{values:{updateRules:e,updateTimelines:t},defaultMessage:"Update {updateRules} Elastic prebuilt {updateRules, plural, =1 {rule} other {rules}} and {updateTimelines} Elastic prebuilt {updateTimelines, plural, =1 {timeline} other {timelines}}"}),ab=S.i18n.translate("xpack.securitySolution.detectionEngine.rules.releaseNotesHelp",{defaultMessage:"Release notes"});var nb=a(148);const ib=L()(_.EuiEmptyPrompt).withConfig({displayName:"EmptyPrompt",componentId:"sc-1rs1rob-0"})(["align-self:center;"]);ib.displayName="EmptyPrompt";const rb=({createPrePackagedRules:e,loading:t=!1,userHasPermissions:a=!1})=>{const r=Object(n.useCallback)((()=>{e()}),[e]),{formatUrl:o}=Object(f.n)(s.a.rules),{navigateTo:l}=Object(nb.h)(),c=Object(n.useCallback)((e=>{e.preventDefault(),l({deepLinkId:s.a.rules,path:Object(ve.a)()})}),[l]),[{isSignalIndexExists:u,isAuthenticated:d,hasEncryptionKey:p,canUserCRUD:m,hasIndexWrite:g}]=Object(dt.b)(),{getLoadPrebuiltRulesAndTemplatesButton:b}=$g({canUserCRUD:m,hasIndexWrite:g,isSignalIndexExists:u,isAuthenticated:d,hasEncryptionKey:p}),h=Object(n.useMemo)((()=>b({isDisabled:!a||t,onClick:r,fill:!0,"data-test-subj":"load-prebuilt-rules"})),[b,r,a,t]);return i.a.createElement(ib,{"data-test-subj":"rulesEmptyPrompt",title:i.a.createElement("h2",null,Wg),body:i.a.createElement("p",null,Gg),actions:i.a.createElement(_.EuiFlexGroup,{justifyContent:"center"},i.a.createElement(_.EuiFlexItem,{grow:!1},h),i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(Ht.g,{isDisabled:!a,onClick:c,href:o(Object(ve.a)()),iconType:"plusInCircle"},Kg)))})},sb=Object(n.memo)(rb),ob=i.a.createElement(_.EuiEmptyPrompt,{title:i.a.createElement("h3",null,Mn.ib),titleSize:"xs",body:Mn.jb}),lb=({euiBasicTableSelectionProps:e,hasPermissions:t,monitoringColumns:a,pagination:n,rules:r,rulesColumns:s,rulesStatuses:o,sorting:l,tableOnChangeCallback:c,tableRef:u,selectedTab:d})=>i.a.createElement(i.a.Fragment,null,d===Yb.rules&&i.a.createElement(_.EuiBasicTable,{"data-test-subj":"rules-table",columns:s,isSelectable:t,itemId:"id",items:null!=r?r:[],noItemsMessage:ob,onChange:c,pagination:n,ref:u,sorting:l,selection:t?e:void 0}),d===Yb.monitoring&&i.a.createElement(_.EuiBasicTable,{"data-test-subj":"monitoring-table",columns:a,isSelectable:t,itemId:"id",items:o,noItemsMessage:ob,onChange:c,pagination:n})),cb=Object(n.memo)(lb);var ub=a(623);const db=(e,t)=>{t(o.l,{deepLinkId:s.a.rules,path:Object(ve.c)(null!=e?e:"")})},pb=async(e,t,a,n)=>{try{a({type:"loadingRuleIds",ids:t,actionType:"duplicate"});const i=await Object(Nn.d)({rules:e.map((e=>Object(Mf.b)(e)))}),{errors:r,rules:s}=Qn(i);return r.length>0?Object(we.d)(Mn.U,r.map((e=>e.error.message)),n):Object(we.e)(Mn.Gb(t.length),n),s}catch(e){Object(we.g)({title:Mn.U,error:e,dispatchToaster:n})}finally{a({type:"loadingRuleIds",ids:[],actionType:null})}},mb=async(e,t,a)=>{try{t({type:"loadingRuleIds",ids:e,actionType:"export"});const n=await Object(Nn.f)({ids:e});Object(ub.a)(n,`${Mn.Z}.ndjson`);const i=await Wn(n);Object(we.e)(Mn.Hb(i,e.length),a)}catch(e){Object(we.d)(Mn.r,[e.message],a)}finally{t({type:"loadingRuleIds",ids:[],actionType:null})}},fb=async(e,t,a,n)=>{try{t({type:"loadingRuleIds",ids:e,actionType:"delete"});const i=await Object(Nn.c)({ids:e}),{errors:r}=Qn(i);r.length>0?Object(we.d)(Mn.n(e.length),r.map((e=>e.error.message)),a):n&&n()}catch(t){Object(we.g)({title:Mn.n(e.length),error:t,dispatchToaster:a})}finally{t({type:"loadingRuleIds",ids:[],actionType:null})}},gb=async(e,t,a,n)=>{const i=t?Mn.j(e.length):Mn.l(e.length);try{a({type:"loadingRuleIds",ids:e,actionType:t?"enable":"disable"});const r=await Object(Nn.e)({ids:e,enabled:t}),{rules:s,errors:o}=Qn(r);a({type:"updateRules",rules:s}),o.length>0&&Object(we.d)(i,o.map((e=>e.error.message)),n),s.some((e=>e.immutable))&&Object(Zi.e)(Zi.a.COUNT,t?Zi.b.SIEM_RULE_ENABLED:Zi.b.SIEM_RULE_DISABLED),s.some((e=>!e.immutable))&&Object(Zi.e)(Zi.a.COUNT,t?Zi.b.CUSTOM_RULE_ENABLED:Zi.b.CUSTOM_RULE_DISABLED)}catch(e){Object(we.d)(i,[e.message],n)}finally{a({type:"loadingRuleIds",ids:[],actionType:null})}},bb=async(e,t,a,n,i,r)=>{try{if(i({type:"loadingRuleIds",ids:e,actionType:n}),n===_g.a.export){const e=await Object(Nn.o)({query:a,action:n});Object(ub.a)(e,`${Mn.Z}.ndjson`);const i=await Wn(e);Object(we.e)(Mn.Hb(i,t),r)}else await Object(Nn.o)({query:a,action:n})}catch(e){Object(we.d)(Mn.r,[e.message],r)}finally{i({type:"loadingRuleIds",ids:[],actionType:null})}};var hb=a(218);const yb=e=>"boolean"==typeof e,vb=(e,t)=>{var a;return null==e||(!((null===(a=e.actions)||void 0===a?void 0:a.length)>0&&yb(t))||t)},Eb=(e,t,a)=>null==e?void 0:Object(hb.d)(e.type)&&!t?St:vb(e,a)?void 0:Mn.X,Tb=({closePopover:e,dispatch:t,dispatchToaster:a,hasMlPermissions:n,loadingRuleIds:r,reFetchRules:s,refetchPrePackagedRulesStatus:o,rules:l,selectedRuleIds:c,hasActionsPrivileges:u,isAllSelected:d,filterQuery:p,confirmDeletion:m,selectedItemsCount:f})=>{const g=l.filter((({id:e})=>c.includes(e))),b=g.some((({enabled:e})=>e)),h=g.some((({enabled:e})=>!e)),y=c.some((e=>r.includes(e))),v=g.some((({immutable:e})=>e)),E=!u&&g.some((e=>!vb(e,u)));return[i.a.createElement(_.EuiContextMenuItem,{key:Mn.i,"data-test-subj":"activateRuleBulk",icon:"checkInCircleFilled",disabled:E||y||!h&&!d,onClick:async()=>{e();const i=g.filter((({enabled:e})=>!e)),r=i.filter((({type:e})=>!Object(hb.d)(e))),o=i.length-r.length;var l;!n&&o>0&&Object(we.f)((l=o,S.i18n.translate("xpack.securitySolution.detectionEngine.mlUnavailableTitle",{values:{totalRules:l},defaultMessage:"{totalRules} {totalRules, plural, =1 {rule requires} other {rules require}} Machine Learning to enable."})),a);const c=n?i.map((({id:e})=>e)):r.map((({id:e})=>e));d?(await bb(c,f,p,_g.a.enable,t,a),await s()):await gb(c,!0,t,a)}},i.a.createElement(_.EuiToolTip,{position:"right",content:E?Mn.X:void 0},i.a.createElement(i.a.Fragment,null,Mn.i))),i.a.createElement(_.EuiContextMenuItem,{key:Mn.k,"data-test-subj":"deactivateRuleBulk",icon:"crossInACircleFilled",disabled:E||y||!b&&!d,onClick:async()=>{e();const n=g.filter((({enabled:e})=>e)).map((({id:e})=>e));d?(await bb(n,f,p,_g.a.disable,t,a),await s()):await gb(n,!1,t,a)}},i.a.createElement(_.EuiToolTip,{position:"right",content:E?Mn.X:void 0},i.a.createElement(i.a.Fragment,null,Mn.k))),i.a.createElement(_.EuiContextMenuItem,{key:Mn.q,"data-test-subj":"exportRuleBulk",icon:"exportAction",disabled:v&&!d||y||0===c.length,onClick:async()=>{e(),d?await bb(c,f,p,_g.a.export,t,a):await mb(g.map((e=>e.rule_id)),t,a)}},Mn.q),i.a.createElement(_.EuiContextMenuItem,{key:Mn.p,"data-test-subj":"duplicateRuleBulk",icon:"copy",disabled:E||y||0===c.length,onClick:async()=>{e(),d?(await bb(c,f,p,_g.a.duplicate,t,a),await s()):await pb(g,c,t,a),await s(),await o()}},i.a.createElement(_.EuiToolTip,{position:"right",content:E?Mn.X:void 0},i.a.createElement(i.a.Fragment,null,Mn.p))),i.a.createElement(_.EuiContextMenuItem,{"data-test-subj":"deleteRuleBulk",key:Mn.m,icon:"trash",title:v?Mn.o:void 0,disabled:y||0===c.length,onClick:async()=>{if(e(),d){if(!1===await m())return;await bb(c,f,p,_g.a.delete,t,a)}else await fb(c,t,a);await s(),await o()}},Mn.m)]},kb=e=>null==e?"subdued":"succeeded"===e?"success":"failed"===e?"danger":"executing"===e||"going to run"===e||"partial failure"===e||"warning"===e?"warning":"subdued",xb=L()(_.EuiSwitch).withConfig({displayName:"StaticSwitch",componentId:"sc-12pilng-0"})([".euiSwitch__thumb,.euiSwitch__icon{transition:none;}"]);xb.displayName="StaticSwitch";const Sb=({dispatch:e,id:t,isDisabled:a,isLoading:r,enabled:s,optionLabel:o,onChange:l})=>{const[c,u]=Object(n.useState)(!1),[d,p]=Object(n.useState)(null!=s&&s),[,m]=Object(we.h)(),f=Object(n.useCallback)((async a=>{if(u(!0),null!=e)await gb([t],a.target.checked,e,m);else{const e=a.target.checked,n=e?Mn.j(1):Mn.l(1);try{const a=await Object(Nn.e)({ids:[t],enabled:e}),{rules:i,errors:r}=Qn(a);if(r.length>0)u(!1),Object(we.d)(n,r.map((e=>e.error.message)),m);else{const[e]=i;p(e.enabled),null!=l&&l(e.enabled)}}catch(e){u(!1),Object(we.d)(n,e.message,m)}}u(!1)}),[e,t]);Object(n.useEffect)((()=>{d!==s&&p(s)}),[s]);const g=Object(n.useMemo)((()=>c!==r&&r||c),[c,r]);return i.a.createElement(_.EuiFlexGroup,{alignItems:"center",justifyContent:"spaceAround"},i.a.createElement(_.EuiFlexItem,{grow:!1},g?i.a.createElement(_.EuiLoadingSpinner,{size:"m","data-test-subj":"ruleSwitchLoader"}):i.a.createElement(xb,{"data-test-subj":"ruleSwitch",label:null!=o?o:"",showLabel:!Object(me.isEmpty)(o),disabled:a,checked:d,onChange:f})))},wb=i.a.memo(Sb);wb.displayName="RuleSwitch";const Ob=({value:e})=>i.a.createElement(_.EuiHealth,{"data-test-subj":"severity",color:"low"===e?ii.euiLightVars.euiColorVis0:"medium"===e?ii.euiLightVars.euiColorVis5:"high"===e?ii.euiLightVars.euiColorVis7:ii.euiLightVars.euiColorVis9},Object(me.upperFirst)(e)),jb=i.a.memo(Ob);var Cb=a(450);const Ib=({columnName:e,children:t})=>{const[a,r]=Object(n.useState)(!1);return i.a.createElement(_.EuiPopover,{anchorPosition:"upCenter",isOpen:a,closePopover:()=>r(!1),button:i.a.createElement(_.EuiButtonIcon,{"aria-label":Mn.ob(e),onClick:()=>r(!a),size:"s",color:"primary",iconType:"questionInCircle"})},t)},Mb=i.a.memo(Ib);Mb.displayName="PopoverTooltip";const Ab=L()(_.EuiBadgeGroup).withConfig({displayName:"TagWrapper",componentId:"sc-dbczeh-0"})(["width:100%;"]),qb=L()(_.EuiBadgeGroup).withConfig({displayName:"TagPopoverWrapper",componentId:"sc-dbczeh-1"})(["max-height:200px;max-width:600px;overflow:auto;"]),Db=L()(_.EuiButtonEmpty).withConfig({displayName:"TagPopoverButton",componentId:"sc-dbczeh-2"})(["font-size:"," font-weight:500;height:20px;"],(({theme:e})=>e.eui.euiFontSizeXS)),Pb=({tags:e})=>{const[t,a]=Object(n.useState)(!1),r=Object(n.useMemo)((()=>Vn(e)),[e]);return i.a.createElement(i.a.Fragment,null,r.length<=3?i.a.createElement(Ab,{"data-test-subj":"tags"},r.map(((e,t)=>i.a.createElement(_.EuiBadge,{color:"hollow",key:`${e}-${t}`,"data-test-subj":`rules-table-column-tags-${t}`},e)))):i.a.createElement(Ab,{"data-test-subj":"tags"},r.slice(0,3).map(((e,t)=>i.a.createElement(_.EuiBadge,{color:"hollow",key:`${e}-${t}`,"data-test-subj":`rules-table-column-tags-${t}`},e))),i.a.createElement(_.EuiPopover,{ownFocus:!0,display:"block","data-test-subj":"tags-display-popover",button:i.a.createElement(Db,{size:"xs","data-test-subj":"tags-display-popover-button",onClick:()=>a(!t)},Mn.E),isOpen:t,closePopover:()=>a(!t),repositionOnScroll:!0},i.a.createElement(qb,null,r.map(((e,t)=>i.a.createElement(_.EuiBadge,{color:"hollow",key:`${e}-${t}`,"data-test-subj":`rules-table-column-popover-tags-${t}`,title:e},e)))))))},Rb=i.a.memo(Pb);Rb.displayName="TagsDisplay";const Fb=(e,t,a,n,r,s,o)=>[{"data-test-subj":"editRuleAction",description:Mn.W,name:o?Mn.W:i.a.createElement(_.EuiToolTip,{position:"left",content:Mn.X},i.a.createElement(i.a.Fragment,null,Mn.W)),icon:"controlsHorizontal",onClick:e=>db(e.id,n),enabled:e=>vb(e,o)},{"data-test-subj":"duplicateRuleAction",description:Mn.T,icon:"copy",name:o?Mn.T:i.a.createElement(_.EuiToolTip,{position:"left",content:Mn.X},i.a.createElement(i.a.Fragment,null,Mn.T)),enabled:e=>vb(e,o),onClick:async a=>{const i=await pb([a],[a.id],e,t);null!=i&&i.length&&db(i[0].id,n)}},{"data-test-subj":"exportRuleAction",description:Mn.ab,icon:"exportAction",name:Mn.ab,onClick:a=>mb([a.rule_id],e,t),enabled:e=>!e.immutable},{"data-test-subj":"deleteRuleAction",description:Mn.R,icon:"trash",name:Mn.R,onClick:async a=>{await fb([a.id],e,t),await r(),await s()}}];var _b=a(606);const Nb=L.a.div.withConfig({displayName:"PopoverContentWrapper",componentId:"sc-1c6dnvx-0"})(["width:275px;"]),Lb=L.a.div.withConfig({displayName:"ScrollableDiv",componentId:"sc-1c6dnvx-1"})(["max-height:250px;overflow-y:auto;"]),Bb=L.a.span.withConfig({displayName:"TagOverflowContainer",componentId:"sc-1c6dnvx-2"})(["overflow:hidden;text-overflow:ellipsis;white-space:nowrap;"]),zb=({tags:e,selectedTags:t,onSelectedTagsChanged:a,currentFilterTags:r})=>{const s=Object(n.useMemo)((()=>Vn(Array.from(new Set([...e,...r])))),[e,r]),[o,l]=Object(n.useState)(!1),[c,u]=Object(n.useState)(""),[d,p]=Object(n.useState)(s),m=Object(n.useMemo)((()=>d.map(((e,n)=>i.a.createElement(_.EuiFilterSelectItem,{checked:t.includes(e)?"on":void 0,key:`${n}-${e}`,onClick:()=>Object(_b.a)(e,t,a),title:e},i.a.createElement(Bb,null,e))))),[a,t,d]),f=Object(n.useCallback)((e=>{u(e.target.value)}),[]);return Object(n.useEffect)((()=>{p(s.filter((e=>e.toLowerCase().includes(c.toLowerCase()))))}),[s,c]),i.a.createElement(_.EuiPopover,{ownFocus:!0,button:i.a.createElement(_.EuiFilterButton,{grow:!0,"data-test-subj":"tags-filter-popover-button",iconType:"arrowDown",onClick:()=>l(!o),numFilters:e.length,isSelected:o,hasActiveFilters:t.length>0,numActiveFilters:t.length},Mn.Jb),isOpen:o,closePopover:()=>l(!o),panelPaddingSize:"none",repositionOnScroll:!0},i.a.createElement(Nb,null,i.a.createElement(_.EuiPopoverTitle,null,i.a.createElement(_.EuiFieldSearch,{placeholder:"Search tags",value:c,onChange:f,isClearable:!0,"aria-label":"Rules tag search"})),i.a.createElement(Lb,null,m),0===d.length&&i.a.createElement(_.EuiFlexGroup,{gutterSize:"m",justifyContent:"spaceAround"},i.a.createElement(_.EuiFlexItem,{grow:!0},i.a.createElement(_.EuiPanel,null,i.a.createElement(_.EuiText,null,Mn.kb))))))};zb.displayName="TagsFilterPopoverComponent";const Hb=i.a.memo(zb);Hb.displayName="TagsFilterPopover";const Ub=({onFilterChanged:e,rulesCustomInstalled:t,rulesInstalled:a,currentFilterTags:r})=>{const[s,o]=Object(n.useState)(""),[l,c]=Object(n.useState)([]),[u,d]=Object(n.useState)(!1),[p,m]=Object(n.useState)(!1),[f,g,b]=(()=>{const[e,t]=Object(n.useState)([]),[a,i]=Object(n.useState)(!0),r=Object(n.useRef)(me.noop),{addError:s}=Object(Oe.a)();return Object(n.useEffect)((()=>{let e=!0;const a=new AbortController,n=async()=>{i(!0);try{const n=await Object(Nn.i)({signal:a.signal});e&&t(n)}catch(t){e&&s(t,{title:Af.l})}e&&i(!1)};return n(),r.current=n,()=>{e=!1,a.abort()}}),[s]),[a,e,r.current]})();Object(n.useEffect)((()=>{b()}),[t,a]),Object(n.useEffect)((()=>{e({filter:s,showCustomRules:u,showElasticRules:p,tags:l})}),[s,l,u,p,e]);const h=Object(n.useCallback)((e=>o(e.trim())),[o]),y=Object(n.useCallback)((()=>{m(!p),d(!1)}),[m,p,d]),v=Object(n.useCallback)((()=>{d(!u),m(!1)}),[m,u,d]),E=Object(n.useCallback)((e=>{Object(me.isEqual)(e,l)||c(e)}),[l]);return i.a.createElement(_.EuiFlexGroup,{gutterSize:"m",justifyContent:"flexEnd"},i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(_.EuiFieldSearch,{"aria-label":Mn.Ab,fullWidth:!0,incremental:!1,placeholder:Mn.zb,onSearch:h})),i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(_.EuiFilterGroup,null,i.a.createElement(Hb,{isLoading:f,onSelectedTagsChanged:E,selectedTags:l,tags:g,currentFilterTags:r,"data-test-subj":"allRulesTagPopover"}))),i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(_.EuiFilterGroup,null,i.a.createElement(_.EuiFilterButton,{hasActiveFilters:p,onClick:y,"data-test-subj":"showElasticRulesFilterButton",withNext:!0},Mn.Y,null!=a?` (${a})`:""),i.a.createElement(_.EuiFilterButton,{hasActiveFilters:u,onClick:v,"data-test-subj":"showCustomRulesFilterButton"},i.a.createElement(i.a.Fragment,null,Mn.J,null!=t?` (${t})`:"")))))};Ub.displayName="RulesTableFiltersComponent";const $b=i.a.memo(Ub);$b.displayName="RulesTableFilters";var Qb=a(368),Vb=a(284);var Wb=a(638);const Gb=(e=!1)=>{const[t,a]=Object(n.useState)(e);return[t,Object(n.useCallback)((()=>{a(!0)}),[]),Object(n.useCallback)((()=>{a(!1)}),[]),Object(n.useCallback)((()=>{a((e=>!e))}),[])]},Kb=i.a.memo((({history:e,formatUrl:t,createPrePackagedRules:a,hasPermissions:r,loading:s,loadingCreatePrePackagedRules:l,refetchPrePackagedRulesStatus:c,rulesCustomInstalled:u,rulesInstalled:d,rulesNotInstalled:p,rulesNotUpdated:f,setRefreshRulesData:g,selectedTab:b})=>{var h;const y=Object(m.j)().services.docLinks,[v,E]=Object(n.useState)(!0),{services:{application:{capabilities:{actions:T}},timelines:k}}=Object(m.j)(),x=Object(n.useRef)(null),[S]=Object(m.o)(o.P),w=(e=>{const{initialStateOverride:t}=e,a={...Ug,lastUpdated:Date.now(),...t},[i,r]=Object(n.useReducer)(Hg,a),s=Object(n.useRef)((e=>({setRules:(t,a)=>{e({type:"setRules",rules:t,pagination:a})},updateRules:t=>{e({type:"updateRules",rules:t})},updateOptions:(t,a)=>{e({type:"updateFilterOptions",filterOptions:t,pagination:a})},actionStarted:(t,a)=>{e({type:"loadingRuleIds",actionType:t,ids:a})},actionStopped:()=>{e({type:"loadingRuleIds",actionType:null,ids:[]})},setShowIdleModal:t=>{e({type:"setShowIdleModal",show:t})},setLastRefreshDate:()=>{e({type:"setLastRefreshDate"})},setAutoRefreshOn:t=>{e({type:"setAutoRefreshOn",on:t})},setIsRefreshing:t=>{e({type:"setIsRefreshing",isRefreshing:t})}}))(r)),{addError:o}=Object(Oe.a)(),l=Object(n.useRef)((()=>Promise.resolve())),{pagination:c,filterOptions:u}=i,d=u.tags.sort().join();return Object(n.useEffect)((()=>{let e=!0;const t=new AbortController,a=async()=>{try{s.current.actionStarted("load",[]);const a=await Object(Nn.h)({filterOptions:u,pagination:c,signal:t.signal});e&&s.current.setRules(a.data,{page:a.page,perPage:a.perPage,total:a.total})}catch(t){e&&(o(t,{title:Af.h}),s.current.setRules([],{}))}e&&s.current.actionStopped()};return a(),l.current=()=>a(),()=>{e=!1,t.abort()}}),[c.page,c.perPage,u.filter,u.sortField,u.sortOrder,d,u.showCustomRules,u.showElasticRules]),{state:i,dispatch:r,...s.current,reFetchRules:l.current}})({initialStateOverride:{isRefreshOn:S.on}}),{filterOptions:O,loadingRuleIds:j,loadingRulesAction:C,pagination:I,rules:M,selectedRuleIds:A,lastUpdated:q,showIdleModal:D,isRefreshOn:P,isRefreshing:R,isAllSelected:F}=w.state,{dispatch:N,updateOptions:L,setShowIdleModal:B,setLastRefreshDate:z,setAutoRefreshOn:H,setIsRefreshing:U,reFetchRules:$}=w,{loading:Q,rulesStatuses:V}=Vg(M),[,W]=Object(we.h)(),G=Object(Qi.a)(),{navigateToApp:K}=Object(m.j)().services.application,Y=Object(Vb.a)(G)&&Object(Qb.a)(G),J="load"===C,X=Object(n.useMemo)((()=>(!(j.length>0)||"disable"!==C&&"enable"!==C)&&j.length>0),[j,C]),Z=Object(n.useMemo)((()=>({sort:{field:O.sortField,direction:O.sortOrder}})),[O]),ee=Ii(d,p,f),te=Object(n.useMemo)((()=>!yb(T.show)||T.show),[T]),[ae,ne,ie]=Gb(),[re,se,oe]=(({onInit:e,onFinish:t})=>{const a=Object(n.useRef)(),i=Object(n.useCallback)((()=>{var e;null===(e=a.current)||void 0===e||e.call(a,!0)}),[]),r=Object(n.useCallback)((()=>{var e;null===(e=a.current)||void 0===e||e.call(a,!1)}),[]);return[Object(n.useCallback)((()=>(e(),new Promise((e=>{a.current=e})).finally((()=>{t()})))),[e,t]),i,r]})({onInit:ne,onFinish:ie}),le=F?I.total:A.length,ce=I.total>I.perPage,ue=Object(n.useCallback)((e=>Tb({isAllSelected:F,closePopover:e,dispatch:N,dispatchToaster:W,hasMlPermissions:Y,hasActionsPrivileges:te,loadingRuleIds:j,selectedRuleIds:A,reFetchRules:$,refetchPrePackagedRulesStatus:c,rules:M,filterQuery:Object(Wb.a)(O),confirmDeletion:re,selectedItemsCount:le})),[F,N,W,Y,j,$,c,M,A,te,O,re,le]),de=Object(n.useMemo)((()=>({pageIndex:I.page-1,pageSize:I.perPage,totalItemCount:I.total,pageSizeOptions:[5,10,20,50,100]})),[I]),pe=Object(n.useCallback)((e=>{L(e,{page:1})}),[L]),fe=Object(n.useCallback)((({page:e,sort:t})=>{var a,n;L({sortField:null!==(a=null==t?void 0:t.field)&&void 0!==a?a:"enabled",sortOrder:null!==(n=null==t?void 0:t.direction)&&void 0!==n?n:"desc"},{page:e.index+1,perPage:e.size}),z()}),[L,z]),ge=Object(n.useMemo)((()=>(({dispatch:e,dispatchToaster:t,formatUrl:a,history:n,hasMlPermissions:r,hasPermissions:s,loadingRuleIds:l,navigateToApp:c,reFetchRules:u,refetchPrePackagedRulesStatus:d,hasReadActionsPrivileges:p})=>{const m=[{field:"name",name:Mn.D,render:(e,t)=>i.a.createElement(Ht.f,{"data-test-subj":"ruleName",onClick:e=>{e.preventDefault(),c(o.l,{deepLinkId:o.Kb.rules,path:Object(ve.d)(t.id)})},href:a(Object(ve.d)(t.id))},e),width:"20%",sortable:!0},{field:"risk_score",name:Mn.C,render:e=>i.a.createElement(_.EuiText,{"data-test-subj":"riskScore",size:"s"},e),width:"10%"},{field:"severity",name:Mn.F,render:e=>i.a.createElement(jb,{value:e}),width:"12%"},{field:"status_date",name:Mn.x,render:e=>null==e?Object(wr.d)():i.a.createElement(Cb.a,{fieldName:Mn.x,date:new Date(e)},i.a.createElement(oa.FormattedRelative,{value:e})),width:"14%"},{field:"status",name:Mn.y,render:e=>{var t;return i.a.createElement(i.a.Fragment,null,i.a.createElement(_.EuiHealth,{color:kb(null!=e?e:null)},null!==(t=Object(ti.a)(e))&&void 0!==t?t:Object(wr.d)()))},width:"12%"},{field:"updated_at",name:Mn.z,render:e=>null==e?Object(wr.d)():i.a.createElement(Cb.a,{fieldName:Mn.z,date:new Date(e)},i.a.createElement(ws.a,{value:e,fieldName:"last rule update date"})),sortable:!0,width:"14%"},{field:"version",name:Mn.H,render:e=>null==e?Object(wr.d)():i.a.createElement(_.EuiText,{"data-test-subj":"version",size:"s"},e),width:"8%"},{field:"tags",name:Mn.G,render:e=>e.length>0?i.a.createElement(Rb,{tags:e}):Object(wr.d)(),width:"20%"},{align:"center",field:"enabled",name:Mn.t,render:(t,a)=>i.a.createElement(_.EuiToolTip,{position:"top",content:Eb(a,r,p)},i.a.createElement(wb,{"data-test-subj":"enabled",dispatch:e,id:a.id,enabled:a.enabled,isDisabled:!vb(a,p)||!s||Object(hb.d)(a.type)&&!r&&!a.enabled,isLoading:l.includes(a.id)})),sortable:!0,width:"95px"}],f=[{actions:Fb(e,t,0,c,u,d,p),width:"40px"}];return s?[...m,...f]:m})({dispatch:N,dispatchToaster:W,formatUrl:t,history:e,hasMlPermissions:Y,hasPermissions:r,loadingRuleIds:null==C||"enable"!==C&&"disable"!==C?[]:j,navigateToApp:K,reFetchRules:$,refetchPrePackagedRulesStatus:c,hasReadActionsPrivileges:te})),[N,W,t,c,te,r,Y,e,j,C,K,$]),be=Object(n.useMemo)((()=>((e,t,a)=>[{field:"name",name:Mn.D,render:(a,n)=>i.a.createElement(Ht.f,{"data-test-subj":"ruleName",onClick:t=>{t.preventDefault(),e(o.l,{deepLinkId:o.Kb.rules,path:Object(ve.d)(n.id)})},href:t(Object(ve.d)(n.id))},"partial failure"===a?"warning":a),width:"24%"},{field:"current_status.bulk_create_time_durations",name:i.a.createElement(i.a.Fragment,null,Mn.v," ",i.a.createElement(_.EuiToolTip,{content:Mn.w},i.a.createElement(_.EuiIcon,{size:"m",color:"subdued",type:"questionInCircle",style:{margin:4}}))),render:e=>i.a.createElement(_.EuiText,{"data-test-subj":"bulk_create_time_durations",size:"s"},null!=e&&e.length?Object(lf.sum)(e.map(Number)).toFixed():Object(wr.d)()),width:"14%"},{field:"current_status.search_after_time_durations",name:i.a.createElement(i.a.Fragment,null,Mn.A," ",i.a.createElement(_.EuiToolTip,{content:Mn.B},i.a.createElement(_.EuiIcon,{size:"m",color:"subdued",type:"questionInCircle",style:{margin:4}}))),render:e=>i.a.createElement(_.EuiText,{"data-test-subj":"search_after_time_durations",size:"s"},null!=e&&e.length?Object(lf.sum)(e.map(Number)).toFixed():Object(wr.d)()),width:"14%"},{field:"current_status.gap",name:i.a.createElement(i.a.Fragment,null,Mn.u,i.a.createElement(Mb,{columnName:Mn.u},i.a.createElement(_.EuiText,{style:{width:300}},i.a.createElement("p",null,i.a.createElement(oa.FormattedMessage,{defaultMessage:"Duration of most recent gap in Rule execution. Adjust Rule look-back or {seeDocs} for mitigating gaps.",id:"xpack.securitySolution.detectionEngine.rules.allRules.columns.gapTooltip",values:{seeDocs:i.a.createElement(_.EuiLink,{href:`${a.links.siem.troubleshootGaps}`,target:"_blank"},"see documentation")}}))))),render:e=>i.a.createElement(_.EuiText,{"data-test-subj":"gap",size:"s"},null!=e?e:Object(wr.d)()),width:"14%"},{field:"current_status.status_date",name:Mn.x,render:e=>null==e?Object(wr.d)():i.a.createElement(Cb.a,{fieldName:Mn.x,date:new Date(e)},i.a.createElement(oa.FormattedRelative,{value:e})),width:"20%"},{field:"current_status.status",name:Mn.y,render:e=>{var t;return i.a.createElement(i.a.Fragment,null,i.a.createElement(_.EuiHealth,{color:kb(null!=e?e:null)},null!==(t=Object(ti.a)(e))&&void 0!==t?t:Object(wr.d)()))},width:"16%"},{field:"activate",name:Mn.t,render:e=>i.a.createElement(_.EuiText,{"data-test-subj":"search_after_time_durations",size:"s"},e?Mn.d:Mn.fb),width:"95px"}])(K,t,y)),[K,t,y]);Object(n.useEffect)((()=>{g($)}),[$,g]),Object(n.useEffect)((()=>{!v||s||J||Q||E(!1)}),[v,s,J,Q]);const he=Object(n.useCallback)((async()=>{null!=a&&(await a(),await $(),await c())}),[a,$,c]),ye=Object(n.useRef)(!1);((e,t)=>{const a=Object(n.useRef)(t);Object(n.useEffect)((()=>{JSON.stringify(a.current)!==JSON.stringify(t)&&(a.current=t,e(t))}),[e,t])})((e=>{var t;null!=(null===(t=x.current)||void 0===t?void 0:t.changeSelection)&&x.current.setSelection(M.filter((t=>e.includes(t.id))))}),A);const Ee=Object(n.useMemo)((()=>({selectable:e=>!j.includes(e.id),onSelectionChange:e=>{ye.current?ye.current=!1:N({type:"selectedRuleIds",ids:e.map((({id:e})=>e))})}})),[j,N]),Te=Object(n.useCallback)((()=>{ye.current=!0,N({type:"setIsAllSelected",isAllSelected:!F})}),[N,F]),ke=Object(n.useCallback)((async(e="manual")=>{if(X)return;const t="auto"===e;t&&U(!0),await $(),await c(),z(),t&&U(!1)}),[X,U,$,c,z]),xe=Object(n.useCallback)((async()=>{await ke("auto")}),[ke]),Se=Object(n.useCallback)((async()=>{await ke()}),[ke]),je=Object(n.useCallback)((()=>{P&&(B(!0),H(!1))}),[B,H,P]),Ce=Object(n.useMemo)((()=>Object(me.debounce)(S.idleTimeout,je)),[je,S.idleTimeout]);Object(n.useEffect)((()=>{const e=setInterval((()=>{P&&xe()}),S.value);return()=>{clearInterval(e)}}),[P,xe,S.value]);const Ie=Object(n.useCallback)((()=>{B(!1),xe(),H(!0)}),[B,H,xe]),Me=Object(n.useCallback)((e=>{e&&xe(),H(e)}),[H,xe]),Ae=Object(n.useMemo)((()=>(({rulesCustomInstalled:e,rulesInstalled:t})=>null!=e&&e>0||null!=t&&t>0)({rulesCustomInstalled:u,rulesInstalled:d})&&!v),[v,u,d]),qe=Object(n.useMemo)((()=>null!=u&&0===u&&"ruleNotInstalled"===ee&&!v),[v,ee,u]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(_.EuiWindowEvent,{event:"mousemove",handler:Ce}),i.a.createElement(_.EuiWindowEvent,{event:"mousedown",handler:Ce}),i.a.createElement(_.EuiWindowEvent,{event:"click",handler:Ce}),i.a.createElement(_.EuiWindowEvent,{event:"keydown",handler:Ce}),i.a.createElement(_.EuiWindowEvent,{event:"scroll",handler:Ce}),i.a.createElement(_.EuiWindowEvent,{event:"load",handler:Ce}),!v&&(s||J||X)&&R&&i.a.createElement(_.EuiProgress,{"data-test-subj":"loadingRulesInfoProgress",size:"xs",position:"absolute",color:"accent"}),i.a.createElement(La.a,{split:!0,growLeftSplit:!1,title:Mn.g,subtitle:k.getLastUpdated({showUpdating:s||J||Q,updatedAt:q})},Ae&&i.a.createElement($b,{onFilterChanged:pe,rulesCustomInstalled:u,rulesInstalled:d,currentFilterTags:O.tags})),!v&&(s||J||X)&&!R&&i.a.createElement(un.a,{"data-test-subj":"loadingPanelAllRulesTable",overlay:!0,size:"xl"}),qe&&i.a.createElement(sb,{createPrePackagedRules:he,loading:l,userHasPermissions:r}),v&&i.a.createElement(_.EuiLoadingContent,{"data-test-subj":"initialLoadingPanelAllRulesTable",lines:10}),D&&i.a.createElement(_.EuiConfirmModal,{title:Mn.sb,onCancel:Ie,onConfirm:Ie,confirmButtonText:Mn.rb,defaultFocusedButton:"confirm","data-test-subj":"allRulesIdleModal"},i.a.createElement("p",null,Mn.qb)),ae&&i.a.createElement(_.EuiConfirmModal,{title:Mn.Q,onCancel:oe,onConfirm:se,confirmButtonText:Mn.P,cancelButtonText:Mn.O,buttonColor:"danger",defaultFocusedButton:"confirm","data-test-subj":"allRulesDeleteConfirmationModal"},i.a.createElement("p",null,Mn.N)),Ae&&i.a.createElement(i.a.Fragment,null,i.a.createElement(An,{canBulkEdit:r,hasPagination:ce,paginationTotal:null!==(h=I.total)&&void 0!==h?h:0,numberSelectedItems:le,onGetBatchItemsPopoverContent:ue,onRefresh:Se,isAutoRefreshOn:P,onRefreshSwitch:Me,isAllSelected:F,onToggleSelectAll:Te,showBulkActions:!0}),i.a.createElement(cb,{selectedTab:b,euiBasicTableSelectionProps:Ee,hasPermissions:r,monitoringColumns:be,pagination:de,rules:M,rulesColumns:ge,rulesStatuses:V,sorting:Z,tableOnChangeCallback:fe,tableRef:x})))}));let Yb;Kb.displayName="RulesTables",function(e){e.rules="rules",e.monitoring="monitoring",e.exceptions="exceptions"}(Yb||(Yb={}));const Jb=[{id:Yb.rules,name:Mn.vb,disabled:!1},{id:Yb.monitoring,name:Mn.hb,disabled:!1}],Xb=i.a.memo((({createPrePackagedRules:e,hasPermissions:t,loading:a,loadingCreatePrePackagedRules:r,refetchPrePackagedRulesStatus:o,rulesCustomInstalled:c,rulesInstalled:u,rulesNotInstalled:d,rulesNotUpdated:p,setRefreshRulesData:m})=>{const g=Object(l.useHistory)(),{formatUrl:b}=Object(f.n)(s.a.rules),[h,y]=Object(n.useState)(Yb.rules),v=Object(n.useMemo)((()=>i.a.createElement(_.EuiTabs,null,Jb.map((e=>i.a.createElement(_.EuiTab,{"data-test-subj":`allRulesTableTab-${e.id}`,onClick:()=>y(e.id),isSelected:e.id===h,disabled:e.disabled,key:e.id},e.name))))),[Jb,h,y]);return i.a.createElement(i.a.Fragment,null,v,i.a.createElement(_.EuiSpacer,null),i.a.createElement(Kb,{history:g,formatUrl:b,selectedTab:h,createPrePackagedRules:e,hasPermissions:t,loading:a,loadingCreatePrePackagedRules:r,refetchPrePackagedRulesStatus:o,rulesCustomInstalled:c,rulesInstalled:u,rulesNotInstalled:d,rulesNotUpdated:p,setRefreshRulesData:m}))}));Xb.displayName="AllRules";var Zb=a(784),eh=a(168);const th=S.i18n.translate("xpack.securitySolution.lists.uploadValueListTitle",{defaultMessage:"Upload value lists"}),ah=S.i18n.translate("xpack.securitySolution.lists.uploadValueListDescription",{defaultMessage:"Upload single value lists to use while writing rule exceptions."}),nh=S.i18n.translate("xpack.securitySolution.lists.uploadValueListPrompt",{defaultMessage:"Select or drag and drop a file"}),ih=S.i18n.translate("xpack.securitySolution.lists.closeValueListsModalTitle",{defaultMessage:"Close"}),rh=S.i18n.translate("xpack.securitySolution.lists.cancelValueListsUploadTitle",{defaultMessage:"Cancel upload"}),sh=S.i18n.translate("xpack.securitySolution.lists.valueListsUploadButton",{defaultMessage:"Upload list"}),oh=S.i18n.translate("xpack.securitySolution.lists.valueListsUploadSuccessTitle",{defaultMessage:"Value list uploaded"}),lh=S.i18n.translate("xpack.securitySolution.lists.valueListsUploadError",{defaultMessage:"There was an error uploading the value list."}),ch=S.i18n.translate("xpack.securitySolution.lists.valueListsExportError",{defaultMessage:"There was an error exporting the value list."}),uh=S.i18n.translate("xpack.securitySolution.lists.valueListsTable.fileNameColumn",{defaultMessage:"Filename"}),dh=S.i18n.translate("xpack.securitySolution.lists.valueListsTable.typeColumn",{defaultMessage:"Type"}),ph=S.i18n.translate("xpack.securitySolution.lists.valueListsTable.uploadDateColumn",{defaultMessage:"Upload Date"}),mh=S.i18n.translate("xpack.securitySolution.lists.valueListsTable.createdByColumn",{defaultMessage:"Created by"}),fh=S.i18n.translate("xpack.securitySolution.lists.valueListsTable.actionsColumn",{defaultMessage:"Actions"}),gh=(S.i18n.translate("xpack.securitySolution.lists.valueListsTable.exportActionName",{defaultMessage:"Export"}),S.i18n.translate("xpack.securitySolution.lists.valueListsTable.exportActionDescription",{defaultMessage:"Export value list"})),bh=(S.i18n.translate("xpack.securitySolution.lists.valueListsTable.deleteActionName",{defaultMessage:"Remove"}),S.i18n.translate("xpack.securitySolution.lists.valueListsTable.deleteActionDescription",{defaultMessage:"Remove value list"})),hh=S.i18n.translate("xpack.securitySolution.lists.valueListsTable.title",{defaultMessage:"Value lists"}),yh=S.i18n.translate("xpack.securitySolution.lists.valueListsForm.listTypesRadioLabel",{defaultMessage:"Type of value list"}),vh=S.i18n.translate("xpack.securitySolution.lists.valueListsForm.ipRadioLabel",{defaultMessage:"IP addresses"}),Eh=S.i18n.translate("xpack.securitySolution.lists.valueListsForm.keywordsRadioLabel",{defaultMessage:"Keywords"}),Th=S.i18n.translate("xpack.securitySolution.lists.valueListsForm.ipRangesRadioLabel",{defaultMessage:"IP ranges"}),kh=S.i18n.translate("xpack.securitySolution.lists.valueListsForm.textRadioLabel",{defaultMessage:"Text"}),xh=S.i18n.translate("xpack.securitySolution.lists.referenceModalTitle",{defaultMessage:"Remove value list"}),Sh=S.i18n.translate("xpack.securitySolution.lists.referenceModalCancelButton",{defaultMessage:"Cancel"}),wh=S.i18n.translate("xpack.securitySolution.lists.referenceModalDeleteButton",{defaultMessage:"Remove value list"}),Oh=[{value:"keyword",text:Eh},{value:"ip",text:vh},{value:"ip_range",text:Th},{value:"text",text:kh}],jh="keyword",Ch=["text/csv","text/plain"],Ih=({onError:e,onSuccess:t})=>{const a=Object(n.useRef)(new AbortController),[r,s]=Object(n.useState)(null),[o,l]=Object(n.useState)(jh),c=Object(n.useRef)(null),{http:u}=Object(m.j)().services,{start:d,...p}=Object(qt.j)(),f=!r||Ch.some((e=>r.type===e)),g=Object(n.useCallback)((e=>l(e.target.value)),[l]),b=Object(n.useCallback)((e=>{var t;s(null!==(t=null==e?void 0:e.item(0))&&void 0!==t?t:null)}),[]),h=Object(n.useCallback)((()=>{var e;null!==(e=c.current)&&void 0!==e&&e.fileInput&&(c.current.fileInput.value="",c.current.handleChange()),s(null),l(jh)}),[]),y=Object(n.useCallback)((()=>{a.current.abort()}),[]),v=Object(n.useCallback)((e=>{h(),t(e)}),[h,t]),E=Object(n.useCallback)((t=>{e(t)}),[e]),T=Object(n.useCallback)((()=>{!p.loading&&r&&(a.current=new AbortController,d({file:r,listId:void 0,http:u,signal:a.current.signal,type:o}))}),[p.loading,r,d,u,o]);return Object(n.useEffect)((()=>{!p.loading&&p.result?v(p.result):!p.loading&&p.error&&E(p.error)}),[E,v,p.error,p.loading,p.result]),Object(n.useEffect)((()=>y),[y]),i.a.createElement(_.EuiForm,null,i.a.createElement(_.EuiFormRow,{"data-test-subj":"value-list-file-picker-row",label:ah,fullWidth:!0,isInvalid:!f,error:[(k=Ch.join(", "),S.i18n.translate("xpack.securitySolution.lists.uploadValueListExtensionValidationMessage",{values:{fileTypes:k},defaultMessage:"File must be one of the following types: [{fileTypes}]"}))]},i.a.createElement(_.EuiFilePicker,{accept:Ch.join(),"data-test-subj":"value-list-file-picker",id:"value-list-file-picker",initialPromptText:nh,ref:c,onChange:b,fullWidth:!0,isLoading:p.loading,isInvalid:!f})),i.a.createElement(_.EuiFormRow,{fullWidth:!0},i.a.createElement(_.EuiFlexGroup,null,i.a.createElement(_.EuiFlexItem,null,i.a.createElement(_.EuiFormRow,{label:yh},i.a.createElement(_.EuiSelect,{"data-test-subj":"value-lists-form-select-type-action",options:Oh,value:o,onChange:g,name:"valueListType"}))),i.a.createElement(_.EuiFlexItem,null,i.a.createElement(_.EuiFormRow,{hasEmptyLabelSpace:!0},i.a.createElement(_.EuiFlexGroup,{alignItems:"flexEnd"},i.a.createElement(_.EuiFlexItem,null,p.loading&&i.a.createElement(_.EuiButtonEmpty,{onClick:y},rh)),i.a.createElement(_.EuiFlexItem,null,i.a.createElement(_.EuiButton,{"data-test-subj":"value-lists-form-import-action",onClick:T,disabled:null==r||!f||p.loading},sh))))))));var k};Ih.displayName="ValueListsFormComponent";const Mh=i.a.memo(Ih);Mh.displayName="ValueListsForm";const Ah=L()(_.EuiLoadingSpinner).withConfig({displayName:"AlignedSpinner",componentId:"sc-j76bhq-0"})(["margin:",";vertical-align:middle;"],(({theme:e})=>e.eui.euiSizeXS)),qh={contentText:"",exceptionListReferences:[],isLoading:!1,valueListId:""},Dh=({onClose:e,showModal:t})=>{var a,r,s,o;const[l,c]=Object(n.useState)(0),[u,d]=Object(n.useState)(5),[p,f]=Object(qt.e)({pageIndex:l,pageSize:u}),{http:g}=Object(m.j)().services,{start:b,...h}=Object(qt.i)(),{start:y,result:v,error:E}=Object(qt.f)(),[T,k]=Object(n.useState)([]),[x,w]=Object(n.useState)([]),[O,j]=Object(n.useState)({}),{addError:C,addSuccess:I}=Object(Oe.a)(),[M,A]=Object(n.useState)(!1),[q,D]=Object(n.useState)(qh),P=Object(n.useCallback)((()=>{b({cursor:p,http:g,pageIndex:l+1,pageSize:u})}),[p,g,b,l,u]),R=Object(n.useCallback)((({deleteReferences:e,id:t})=>{k([...T,t]),y({deleteReferences:e,http:g,id:t})}),[y,T,g]),F=Object(n.useCallback)((async()=>{A(!1),y({deleteReferences:!0,http:g,id:q.valueListId}),D(qh),k([])}),[y,g,q.valueListId]);Object(n.useEffect)((()=>{null!=v&&(k((e=>[...e.filter((e=>e!==v.id))])),P())}),[v,P]),Object(n.useEffect)((()=>{if(!Object(me.isEmpty)(E)){var e,t,a,n,i,r,s,o;const c=null!==(e=null==E||null===(t=E.body)||void 0===t||null===(a=t.message)||void 0===a||null===(n=a.error)||void 0===n||null===(i=n.references)||void 0===i?void 0:i.map((e=>null==e?void 0:e.exception_list.name)))&&void 0!==e?e:[],u=Array.from(new Set(c));A(!0),D({contentText:(l=u.length,S.i18n.translate("xpack.securitySolution.lists.referenceModalDescription",{defaultMessage:"This value list is associated with ({referenceCount}) exception {referenceCount, plural, =1 {list} other {lists}}. Removing this list will remove all exception items that reference this value list.",values:{referenceCount:l}})),exceptionListReferences:u,isLoading:!1,valueListId:null==E||null===(r=E.body)||void 0===r||null===(s=r.message)||void 0===s||null===(o=s.error)||void 0===o?void 0:o.value_list_id})}var l}),[E]);const N=Object(n.useCallback)((async({id:e})=>{try{w((t=>[...t,e]));const t=await Object(eh.i)({http:g,listId:e,signal:(new AbortController).signal});j({name:e,blob:t})}catch(e){C(e,{title:ch})}finally{w((t=>[...t.filter((t=>t!==e))]))}}),[C,g]),L=Object(n.useCallback)((({page:{index:e,size:t}})=>{c(e),d(t)}),[c,d]),B=Object(n.useCallback)((e=>{"AbortError"!==e.name&&C(e,{title:lh})}),[C]),z=Object(n.useCallback)((e=>{var t;I({text:(t=e.name,S.i18n.translate("xpack.securitySolution.lists.valueListsUploadSuccess",{defaultMessage:"Value list '{fileName}' was uploaded",values:{fileName:t}})),title:oh}),P()}),[I]);Object(n.useEffect)((()=>{t&&P()}),[t,P]),Object(n.useEffect)((()=>{var e;!h.loading&&null!==(e=h.result)&&void 0!==e&&e.cursor&&f(h.result.cursor)}),[h.loading,h.result,f]);const H=Object(n.useCallback)((()=>{k([]),A(!1),D({contentText:"",exceptionListReferences:[],isLoading:!1,valueListId:""})}),[]);if(!t)return null;const U=(null!==(a=null===(r=h.result)||void 0===r?void 0:r.data)&&void 0!==a?a:[]).map((e=>({...e,isDeleting:T.includes(e.id),isExporting:x.includes(e.id)}))),$={pageIndex:l,pageSize:u,totalItemCount:null!==(s=null===(o=h.result)||void 0===o?void 0:o.total)&&void 0!==s?s:0,hidePerPageOptions:!0},Q=(V=N,W=R,[{field:"name",name:uh,truncateText:!1},{field:"type",name:dh,width:"15%",truncateText:!0,render:e=>{const t=Oh.find((({value:t})=>t===e));return i.a.createElement(i.a.Fragment,null,t?t.text:e)}},{field:"created_at",name:ph,render:e=>i.a.createElement(ws.a,{value:e,fieldName:"created_at"}),width:"30%"},{field:"created_by",name:mh,truncateText:!0,width:"20%"},{name:fh,actions:[{render:e=>i.a.createElement(_.EuiToolTip,{content:gh},e.isExporting?i.a.createElement(Ah,{size:"m"}):i.a.createElement(_.EuiButtonIcon,{"aria-label":gh,"data-test-subj":"action-export-value-list",iconType:"exportAction",onClick:()=>V(e)}))},{render:e=>i.a.createElement(_.EuiToolTip,{content:bh},e.isDeleting?i.a.createElement(Ah,{size:"m"}):i.a.createElement(_.EuiButtonIcon,{"aria-label":bh,"data-test-subj":`action-delete-value-list-${e.name}`,iconType:"trash",onClick:()=>W(e)}))}],width:"15%"}]);var V,W;return i.a.createElement(i.a.Fragment,null,i.a.createElement(_.EuiModal,{onClose:e,maxWidth:800},i.a.createElement(_.EuiModalHeader,null,i.a.createElement(_.EuiModalHeaderTitle,null,th)),i.a.createElement(_.EuiModalBody,null,i.a.createElement(Mh,{onSuccess:z,onError:B}),i.a.createElement(_.EuiSpacer,null),i.a.createElement(_.EuiPanel,{hasBorder:!0},i.a.createElement(_.EuiText,{size:"s"},i.a.createElement("h2",null,hh)),i.a.createElement(_.EuiBasicTable,{"data-test-subj":"value-lists-table",columns:Q,items:U,loading:h.loading,onChange:L,pagination:$}))),i.a.createElement(_.EuiModalFooter,null,i.a.createElement(_.EuiButton,{"data-test-subj":"value-lists-modal-close-action",onClick:e},ih))),i.a.createElement(Hn,{cancelText:Sh,confirmText:wh,contentText:q.contentText,onCancel:H,onClose:H,onConfirm:F,references:q.exceptionListReferences,showModal:M,titleText:xh}),i.a.createElement(cn,{blob:O.blob,name:O.name,onDownload:()=>j({})}))};Dh.displayName="ValueListsModalComponent";const Ph=i.a.memo(Dh);Ph.displayName="ValueListsModal";const Rh=({loading:e,numberOfUpdatedRules:t,numberOfUpdatedTimelines:a,updateRules:r})=>{const{services:s}=Object(m.j)(),o=Object(n.useMemo)((()=>{return t>0&&0===a?{callOutMessage:Jg(t),buttonTitle:Zg(t)}:0===t&&a>0?{callOutMessage:(e=a,S.i18n.translate("xpack.securitySolution.detectionEngine.rules.updatePrePackagedTimelinesMsg",{values:{updateTimelines:e},defaultMessage:"You can update {updateTimelines} Elastic prebuilt {updateTimelines, plural, =1 {timeline} other {timelines}}"})),buttonTitle:eb(a)}:t>0&&a>0?{callOutMessage:Xg(t,a),buttonTitle:tb(t,a)}:void 0;var e}),[t,a]);return i.a.createElement(_.EuiCallOut,{title:Yg,"data-test-subj":"update-callout"},i.a.createElement("p",null,null==o?void 0:o.callOutMessage,i.a.createElement("br",null),i.a.createElement(_.EuiLink,{href:`${s.docLinks.links.siem.ruleChangeLog}`,target:"_blank"},ab)),i.a.createElement(_.EuiButton,{onClick:r,size:"s",isLoading:e,"data-test-subj":"update-callout-button"},null==o?void 0:o.buttonTitle))},Fh=Object(n.memo)(Rh);var _h=a(533);const Nh=["v2_rare_process_by_host_linux_ecs","v2_linux_rare_metadata_user","v2_linux_rare_metadata_process","v2_linux_anomalous_user_name_ecs","v2_linux_anomalous_process_all_hosts_ecs","v2_linux_anomalous_network_port_activity_ecs","v2_rare_process_by_host_windows_ecs","v2_windows_anomalous_network_activity_ecs","v2_windows_anomalous_path_activity_ecs","v2_windows_anomalous_process_all_hosts_ecs","v2_windows_anomalous_process_creation","v2_windows_anomalous_user_name_ecs","v2_windows_rare_metadata_process","v2_windows_rare_metadata_user","rare_process_by_host_linux_ecs","linux_anomalous_network_activity_ecs","linux_anomalous_network_port_activity_ecs","linux_anomalous_network_service","linux_anomalous_network_url_activity_ecs","linux_anomalous_process_all_hosts_ecs","linux_anomalous_user_name_ecs","linux_rare_metadata_process","linux_rare_metadata_user","linux_rare_user_compiler","linux_rare_kernel_module_arguments","linux_rare_sudo_user","linux_system_user_discovery","linux_system_information_discovery","linux_system_process_discovery","linux_network_connection_discovery","linux_network_configuration_discovery","rare_process_by_host_windows_ecs","windows_anomalous_network_activity_ecs","windows_anomalous_path_activity_ecs","windows_anomalous_process_all_hosts_ecs","windows_anomalous_process_creation","windows_anomalous_script","windows_anomalous_service","windows_anomalous_user_name_ecs","windows_rare_user_runas_event","windows_rare_metadata_process","windows_rare_metadata_user"],Lh=()=>i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.mlJobCompatibilityCallout.messageBody",defaultMessage:"{summary} Related documentation: {docs}",values:{summary:i.a.createElement("p",null,i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.mlJobCompatibilityCallout.messageBody.summary",defaultMessage:"Machine learning rules specify ML jobs that in turn have dependencies on data fields populated by the Elastic beats and agent integrations that were current when the ML job was created. New ML jobs, prefixed with V2, have been updated to operate on now-current ECS fields. If you are using multiple versions of beats and agents, you need to create new machine learning rules that specify the new ML (V2) jobs, and enable them to run alongside your existing machine learning rules, in order to ensure continued rule coverage."})),docs:i.a.createElement("ul",null,i.a.createElement("li",null,i.a.createElement(ha,null)))}}),Bh={type:"primary",id:"ml-job-compatibility",title:S.i18n.translate("xpack.securitySolution.detectionEngine.mlJobCompatibilityCallout.messageTitle",{defaultMessage:"Your ML jobs may be incompatible with your data sources and/or ML rules"}),description:i.a.createElement(Lh,null)},zh=()=>{const{loading:e,jobs:t}=Object(_h.a)(),a=t.some((e=>Nh.includes(e.id)));return i.a.createElement(ia,{namespace:"detections",condition:!e&&a,message:Bh})},Hh=Object(n.memo)(zh),Uh=()=>{const[e,t]=Object(n.useState)(!1),[a,r]=Object(n.useState)(!1),l=Object(n.useRef)(null),{navigateToApp:c}=Object(m.j)().services.application,[{loading:p,isSignalIndexExists:g,isAuthenticated:b,hasEncryptionKey:h,canUserCRUD:y,hasIndexWrite:v}]=Object(dt.b)(),{loading:E,canWriteIndex:T,needsConfiguration:k}=Bt(),x=p||E,{createPrePackagedRules:S,loading:w,loadingCreatePrePackagedRules:O,refetchPrePackagedRulesStatus:j,rulesCustomInstalled:C,rulesInstalled:I,rulesNotInstalled:M,rulesNotUpdated:A,timelinesInstalled:q,timelinesNotInstalled:D,timelinesNotUpdated:P,getLoadPrebuiltRulesAndTemplatesButton:R,getReloadPrebuiltRulesAndTemplatesButton:F}=$g({canUserCRUD:y,hasIndexWrite:v,isSignalIndexExists:g,isAuthenticated:b,hasEncryptionKey:h}),N=Ii(I,M,A),L=Mi(q,D,P),{formatUrl:B}=Object(f.n)(s.a.rules),z=Object(n.useCallback)((async()=>{null!=l.current&&await l.current()}),[l]),H=Object(n.useCallback)((async()=>{if(null!=S)return await S(),z()}),[S,z]),U=Object(n.useCallback)((()=>null!=j?j():Promise.resolve()),[j]),$=Object(n.useCallback)((e=>{l.current=e}),[]),Q=Object(n.useCallback)((e=>{e.preventDefault(),c(o.l,{deepLinkId:s.a.rules,path:Object(ve.a)()})}),[c]),V=Object(n.useMemo)((()=>R({isDisabled:!Pi(y)||x,onClick:H})),[y,R,H,x]),W=Object(n.useMemo)((()=>F({isDisabled:!Pi(y)||x,onClick:H})),[y,F,H,x]);return Ai(g,b,h,k)?(c(o.l,{deepLinkId:s.a.alerts,path:Object(ve.b)()}),null):i.a.createElement(i.a.Fragment,null,i.a.createElement(Ea,null),i.a.createElement(Fa,null),i.a.createElement(Hh,null),i.a.createElement(Ph,{showModal:a,onClose:()=>r(!1)}),i.a.createElement(Zb.a,{checkBoxLabel:Mn.mb,closeModal:()=>t(!1),description:Mn.Db,errorMessage:Mn.bb,failedDetailed:Mn.cb,importComplete:z,importData:Nn.m,successMessage:Mn.Ib,showCheckBox:!0,showModal:e,submitBtnText:Mn.eb,subtitle:Mn.gb,title:Mn.db}),i.a.createElement(d.a,null,i.a.createElement(Mt,{title:Mn.nb},i.a.createElement(_.EuiFlexGroup,{alignItems:"center",gutterSize:"s",responsive:!1,wrap:!0},V&&i.a.createElement(_.EuiFlexItem,{grow:!1},V),W&&i.a.createElement(_.EuiFlexItem,{grow:!1},W),i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(_.EuiToolTip,{position:"top",content:Mn.Lb},i.a.createElement(_.EuiButton,{"data-test-subj":"open-value-lists-modal-button",iconType:"importAction",isDisabled:!T||x,onClick:()=>r(!0)},Mn.Kb))),i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(_.EuiButton,{iconType:"importAction",isDisabled:!Pi(y)||x,onClick:()=>{t(!0)}},Mn.db)),i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(Ht.g,{"data-test-subj":"create-new-rule",fill:!0,onClick:Q,href:B(Object(ve.a)()),iconType:"plusInCircle",isDisabled:!Pi(y)||x},Mn.e)))),("ruleNeedUpdate"===N||"timelineNeedUpdate"===L)&&i.a.createElement(Fh,{"data-test-subj":"update-callout-button",loading:O,numberOfUpdatedRules:null!=A?A:0,numberOfUpdatedTimelines:null!=P?P:0,updateRules:H}),i.a.createElement(Xb,{createPrePackagedRules:S,"data-test-subj":"all-rules",loading:x||w,loadingCreatePrePackagedRules:O,hasPermissions:Pi(y),refetchPrePackagedRulesStatus:U,rulesCustomInstalled:C,rulesInstalled:I,rulesNotInstalled:M,rulesNotUpdated:A,setRefreshRulesData:$})),i.a.createElement(u.a,{pageName:s.a.rules}))},$h=i.a.memo(Uh),Qh=()=>{const[e]=Object(m.o)(o.B);return e?ii.euiDarkVars:ii.euiLightVars},Vh=L.a.div.withConfig({displayName:"RuleStatusIconStyled",componentId:"sc-1sbrlhw-0"})(["position:relative;svg{position:absolute;top:8px;left:9px;}"]),Wh=({name:e,type:t})=>{const a=Qh(),n="passive"===t?a.euiColorLightestShade:a.euiColorPrimary;return i.a.createElement(Vh,null,i.a.createElement(_.EuiAvatar,{color:n,name:"valid"===t?"":e,size:"l"}),"valid"===t?i.a.createElement(_.EuiIcon,{type:"check",color:a.euiColorEmptyShade,size:"l"}):null)},Gh=Object(n.memo)(Wh),Kh=({name:e,title:t,type:a})=>i.a.createElement(_.EuiFlexGroup,{alignItems:"center",gutterSize:"m",responsive:!1},i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(Gh,{name:e,type:a})),i.a.createElement(_.EuiFlexItem,null,i.a.createElement(_.EuiTitle,{size:"s",className:"euiAccordionForm__title"},i.a.createElement("h6",null,t)))),Yh=i.a.memo(Kh);var Jh=a(290),Xh=a(283),Zh=a.n(Xh);const ey=e=>{const t={unit:"",value:0},a=e.match(/\d+/g),n=e.match(/[a-zA-Z]+/g);return Object(me.isEmpty)(a)||null==a||isNaN(Number(a[0]))||(t.value=Number(a[0])),!Object(me.isEmpty)(n)&&null!=n&&["s","m","h"].includes(n[0])&&(t.unit=n[0]),t},ty=e=>!(null==e||!e.isValid||!e.data),ay=(e,t)=>{switch(t){case"machine_learning":const{index:t,queryBar:a,threshold:n,threatIndex:i,threatQueryBar:r,threatMapping:s,...o}=e;return o;case"threshold":const{anomalyThreshold:l,machineLearningJobId:c,threatIndex:u,threatQueryBar:d,threatMapping:p,...m}=e;return m;case"threat_match":const{anomalyThreshold:f,machineLearningJobId:g,threshold:b,...h}=e;return h;case"query":case"saved_query":case"eql":const{anomalyThreshold:y,machineLearningJobId:v,threshold:E,threatIndex:T,threatQueryBar:k,threatMapping:x,...S}=e;return S}Object(Qt.a)(t)};function ny(e){return e.filter((e=>"none"!==e.name))}const iy=e=>e.filter((e=>"none"!==e.tactic.name)).map((e=>{var t;return{...e,technique:ny(null!==(t=e.technique)&&void 0!==t?t:[]).map((e=>({...e,subtechnique:null!=e.subtechnique?ny(e.subtechnique):[]})))}})),ry=e=>{var t,a,n,i,r,s,o,l,c,u,d,p,m,f,g,b,h,y,v,E,T,k,x,S,w,O,j,C,I,M;const A=ay(e,e.ruleType),{ruleType:q,timeline:D}=A;var P;return{...{type:q,...null!=D.id&&null!=D.title&&{timeline_id:D.id,timeline_title:D.title}},...(P=A,Object(me.has)("anomalyThreshold",P)?{anomaly_threshold:A.anomalyThreshold,machine_learning_job_id:A.machineLearningJobId}:(e=>Object(me.has)("threshold",e))(A)?{index:A.index,filters:null===(t=A.queryBar)||void 0===t?void 0:t.filters,language:null===(a=A.queryBar)||void 0===a||null===(n=a.query)||void 0===n?void 0:n.language,query:null===(i=A.queryBar)||void 0===i||null===(r=i.query)||void 0===r?void 0:r.query,saved_id:null===(s=A.queryBar)||void 0===s?void 0:s.saved_id,..."threshold"===q&&{threshold:{field:null!==(o=null===(l=A.threshold)||void 0===l?void 0:l.field)&&void 0!==o?o:[],value:null!==(c=parseInt(null===(u=A.threshold)||void 0===u?void 0:u.value,10))&&void 0!==c?c:0,cardinality:Object(me.isEmpty)(null===(d=A.threshold.cardinality)||void 0===d?void 0:d.field)||null==(null===(p=A.threshold.cardinality)||void 0===p?void 0:p.value)?[]:[{field:A.threshold.cardinality.field[0],value:parseInt(A.threshold.cardinality.value,10)}]}}}:(e=>Object(me.has)("threatIndex",e))(A)?{index:A.index,filters:null===(m=A.queryBar)||void 0===m?void 0:m.filters,language:null===(f=A.queryBar)||void 0===f||null===(g=f.query)||void 0===g?void 0:g.language,query:null===(b=A.queryBar)||void 0===b||null===(h=b.query)||void 0===h?void 0:h.query,saved_id:null===(y=A.queryBar)||void 0===y?void 0:y.saved_id,threat_index:A.threatIndex,threat_query:null===(v=A.threatQueryBar)||void 0===v||null===(E=v.query)||void 0===E?void 0:E.query,threat_filters:null===(T=A.threatQueryBar)||void 0===T?void 0:T.filters,threat_mapping:A.threatMapping,threat_language:null===(k=A.threatQueryBar)||void 0===k||null===(x=k.query)||void 0===x?void 0:x.language}:{index:A.index,filters:null===(S=A.queryBar)||void 0===S?void 0:S.filters,language:null===(w=A.queryBar)||void 0===w||null===(O=w.query)||void 0===O?void 0:O.language,query:null===(j=A.queryBar)||void 0===j||null===(C=j.query)||void 0===C?void 0:C.query,saved_id:null===(I=A.queryBar)||void 0===I?void 0:I.saved_id,..."query"===q&&(null===(M=A.queryBar)||void 0===M?void 0:M.saved_id)&&{type:"saved_query"}})}},sy=e=>{const{...t}=e;if(!Object(me.isEmpty)(t.interval)&&!Object(me.isEmpty)(t.from)){const{unit:e,value:a}=ey(t.interval),{unit:n,value:i}=ey(t.from),r=Jn.a.duration(a,e);r.add(i,n),t.from=`now-${r.asSeconds()}s`,t.to="now"}return{...t,meta:{from:e.from}}},oy=(e,t)=>{const{author:a,falsePositives:n,references:i,riskScore:r,severity:s,threat:o,isAssociatedToEndpointList:l,isBuildingBlock:c,note:u,ruleNameOverride:d,threatIndicatorPath:p,timestampOverride:m,...f}=e,g=null!=t?t.filter((e=>"endpoint"!==e.type)):[];return{author:a.filter((e=>!Object(me.isEmpty)(e))),...c?{building_block_type:"default"}:{},...l?{exceptions_list:[{id:ei.g,list_id:ei.g,namespace_type:"agnostic",type:"endpoint"},...g]}:null!=t?{exceptions_list:[...g]}:{},false_positives:n.filter((e=>!Object(me.isEmpty)(e))),references:i.filter((e=>!Object(me.isEmpty)(e))),risk_score:r.value,risk_score_mapping:r.isMappingChecked?r.mapping.filter((e=>null!=e.field&&""!==e.field)):[],rule_name_override:""!==d?d:void 0,severity:s.value,severity_mapping:s.isMappingChecked?s.mapping.filter((e=>null!=e.field&&""!==e.field&&null!=e.value)):[],threat:iy(o).map((e=>({...e,framework:"MITRE ATT&CK"}))),threat_indicator_path:p,timestamp_override:""!==m?m:void 0,...Object(me.isEmpty)(u)?{}:{note:u},...f}},ly=e=>{const{actions:t=[],enabled:a,kibanaSiemAppUrl:n,throttle:i=o.Ab}=e;return{actions:t.map(ni),enabled:a,throttle:t.length?i:o.Ab,meta:{kibana_siem_app_url:n}}},cy=(e,t,a,n,i)=>Zh.a.all([ry(e),oy(t,null==i?void 0:i.exceptions_list),sy(a),ly(n)]);var uy=a(274);const dy=S.i18n.translate("xpack.securitySolution.threatMatch.fieldDescription",{defaultMessage:"Field"}),py=S.i18n.translate("xpack.securitySolution.threatMatch.threatFieldDescription",{defaultMessage:"Indicator index field"}),my=S.i18n.translate("xpack.securitySolution.threatMatch.fieldPlaceholderDescription",{defaultMessage:"Search"}),fy=S.i18n.translate("xpack.securitySolution.threatMatch.matchesLabel",{defaultMessage:"MATCHES"}),gy=S.i18n.translate("xpack.securitySolution.threatMatch.andDescription",{defaultMessage:"AND"}),by=S.i18n.translate("xpack.securitySolution.threatMatch.orDescription",{defaultMessage:"OR"}),hy=S.i18n.translate("xpack.securitySolution.alerts.severityMapping.severityTitle",{defaultMessage:"Default severity"}),yy=S.i18n.translate("xpack.securitySolution.alerts.severityMapping.defaultSeverityTitle",{defaultMessage:"Severity"}),vy=S.i18n.translate("xpack.securitySolution.alerts.severityMapping.sourceFieldTitle",{defaultMessage:"Source field"}),Ey=S.i18n.translate("xpack.securitySolution.alerts.severityMapping.sourceValueTitle",{defaultMessage:"Source value"}),Ty=S.i18n.translate("xpack.securitySolution.alerts.severityMapping.severityMappingTitle",{defaultMessage:"Severity override"}),ky=S.i18n.translate("xpack.securitySolution.alerts.severityMapping.defaultDescriptionLabel",{defaultMessage:"Select a severity level for all alerts generated by this rule."}),xy=S.i18n.translate("xpack.securitySolution.alerts.severityMapping.mappingDescriptionLabel",{defaultMessage:"Use source event values to override the default severity."}),Sy=S.i18n.translate("xpack.securitySolution.alerts.severityMapping.mappingDetailsLabel",{defaultMessage:"For multiple matches the highest severity match will apply. If no match is found, the default severity will be used."}),wy=S.i18n.translate("xpack.securitySolution.alerts.riskScoreMapping.riskScoreTitle",{defaultMessage:"Risk score"}),Oy=S.i18n.translate("xpack.securitySolution.alerts.riskScoreMapping.defaultRiskScoreTitle",{defaultMessage:"Default risk score"}),jy=S.i18n.translate("xpack.securitySolution.alerts.riskScoreMapping.riskScoreFieldTitle",{defaultMessage:"signal.rule.risk_score"}),Cy=S.i18n.translate("xpack.securitySolution.alerts.riskScoreMapping.sourceFieldTitle",{defaultMessage:"Source field"}),Iy=S.i18n.translate("xpack.securitySolution.alerts.riskScoreMapping.riskScoreMappingTitle",{defaultMessage:"Risk score override"}),My=S.i18n.translate("xpack.securitySolution.alerts.riskScoreMapping.defaultDescriptionLabel",{defaultMessage:"Select a risk score for all alerts generated by this rule."}),Ay=S.i18n.translate("xpack.securitySolution.alerts.riskScoreMapping.mappingDescriptionLabel",{defaultMessage:"Use a source event value to override the default risk score."}),qy=S.i18n.translate("xpack.securitySolution.alerts.riskScoreMapping.mappingDetailsLabel",{defaultMessage:"If value is out of bounds, or field is not present, the default risk score will be used."}),Dy=[{id:"TA0009",name:"Collection",reference:"https://attack.mitre.org/tactics/TA0009",text:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTactics.collectionDescription",{defaultMessage:"Collection (TA0009)"}),value:"collection"},{id:"TA0011",name:"Command and Control",reference:"https://attack.mitre.org/tactics/TA0011",text:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTactics.commandAndControlDescription",{defaultMessage:"Command and Control (TA0011)"}),value:"commandAndControl"},{id:"TA0006",name:"Credential Access",reference:"https://attack.mitre.org/tactics/TA0006",text:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTactics.credentialAccessDescription",{defaultMessage:"Credential Access (TA0006)"}),value:"credentialAccess"},{id:"TA0005",name:"Defense Evasion",reference:"https://attack.mitre.org/tactics/TA0005",text:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTactics.defenseEvasionDescription",{defaultMessage:"Defense Evasion (TA0005)"}),value:"defenseEvasion"},{id:"TA0007",name:"Discovery",reference:"https://attack.mitre.org/tactics/TA0007",text:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTactics.discoveryDescription",{defaultMessage:"Discovery (TA0007)"}),value:"discovery"},{id:"TA0002",name:"Execution",reference:"https://attack.mitre.org/tactics/TA0002",text:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTactics.executionDescription",{defaultMessage:"Execution (TA0002)"}),value:"execution"},{id:"TA0010",name:"Exfiltration",reference:"https://attack.mitre.org/tactics/TA0010",text:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTactics.exfiltrationDescription",{defaultMessage:"Exfiltration (TA0010)"}),value:"exfiltration"},{id:"TA0040",name:"Impact",reference:"https://attack.mitre.org/tactics/TA0040",text:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTactics.impactDescription",{defaultMessage:"Impact (TA0040)"}),value:"impact"},{id:"TA0001",name:"Initial Access",reference:"https://attack.mitre.org/tactics/TA0001",text:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTactics.initialAccessDescription",{defaultMessage:"Initial Access (TA0001)"}),value:"initialAccess"},{id:"TA0008",name:"Lateral Movement",reference:"https://attack.mitre.org/tactics/TA0008",text:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTactics.lateralMovementDescription",{defaultMessage:"Lateral Movement (TA0008)"}),value:"lateralMovement"},{id:"TA0003",name:"Persistence",reference:"https://attack.mitre.org/tactics/TA0003",text:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTactics.persistenceDescription",{defaultMessage:"Persistence (TA0003)"}),value:"persistence"},{id:"TA0004",name:"Privilege Escalation",reference:"https://attack.mitre.org/tactics/TA0004",text:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTactics.privilegeEscalationDescription",{defaultMessage:"Privilege Escalation (TA0004)"}),value:"privilegeEscalation"},{id:"TA0043",name:"Reconnaissance",reference:"https://attack.mitre.org/tactics/TA0043",text:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTactics.reconnaissanceDescription",{defaultMessage:"Reconnaissance (TA0043)"}),value:"reconnaissance"},{id:"TA0042",name:"Resource Development",reference:"https://attack.mitre.org/tactics/TA0042",text:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTactics.resourceDevelopmentDescription",{defaultMessage:"Resource Development (TA0042)"}),value:"resourceDevelopment"}],Py=[{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.abuseElevationControlMechanismDescription",{defaultMessage:"Abuse Elevation Control Mechanism (T1548)"}),id:"T1548",name:"Abuse Elevation Control Mechanism",reference:"https://attack.mitre.org/techniques/T1548",tactics:"privilege-escalation,defense-evasion",value:"abuseElevationControlMechanism"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.accessTokenManipulationDescription",{defaultMessage:"Access Token Manipulation (T1134)"}),id:"T1134",name:"Access Token Manipulation",reference:"https://attack.mitre.org/techniques/T1134",tactics:"defense-evasion,privilege-escalation",value:"accessTokenManipulation"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.accountAccessRemovalDescription",{defaultMessage:"Account Access Removal (T1531)"}),id:"T1531",name:"Account Access Removal",reference:"https://attack.mitre.org/techniques/T1531",tactics:"impact",value:"accountAccessRemoval"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.accountDiscoveryDescription",{defaultMessage:"Account Discovery (T1087)"}),id:"T1087",name:"Account Discovery",reference:"https://attack.mitre.org/techniques/T1087",tactics:"discovery",value:"accountDiscovery"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.accountManipulationDescription",{defaultMessage:"Account Manipulation (T1098)"}),id:"T1098",name:"Account Manipulation",reference:"https://attack.mitre.org/techniques/T1098",tactics:"persistence",value:"accountManipulation"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.acquireInfrastructureDescription",{defaultMessage:"Acquire Infrastructure (T1583)"}),id:"T1583",name:"Acquire Infrastructure",reference:"https://attack.mitre.org/techniques/T1583",tactics:"resource-development",value:"acquireInfrastructure"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.activeScanningDescription",{defaultMessage:"Active Scanning (T1595)"}),id:"T1595",name:"Active Scanning",reference:"https://attack.mitre.org/techniques/T1595",tactics:"reconnaissance",value:"activeScanning"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.applicationLayerProtocolDescription",{defaultMessage:"Application Layer Protocol (T1071)"}),id:"T1071",name:"Application Layer Protocol",reference:"https://attack.mitre.org/techniques/T1071",tactics:"command-and-control",value:"applicationLayerProtocol"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.applicationWindowDiscoveryDescription",{defaultMessage:"Application Window Discovery (T1010)"}),id:"T1010",name:"Application Window Discovery",reference:"https://attack.mitre.org/techniques/T1010",tactics:"discovery",value:"applicationWindowDiscovery"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.archiveCollectedDataDescription",{defaultMessage:"Archive Collected Data (T1560)"}),id:"T1560",name:"Archive Collected Data",reference:"https://attack.mitre.org/techniques/T1560",tactics:"collection",value:"archiveCollectedData"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.audioCaptureDescription",{defaultMessage:"Audio Capture (T1123)"}),id:"T1123",name:"Audio Capture",reference:"https://attack.mitre.org/techniques/T1123",tactics:"collection",value:"audioCapture"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.automatedCollectionDescription",{defaultMessage:"Automated Collection (T1119)"}),id:"T1119",name:"Automated Collection",reference:"https://attack.mitre.org/techniques/T1119",tactics:"collection",value:"automatedCollection"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.automatedExfiltrationDescription",{defaultMessage:"Automated Exfiltration (T1020)"}),id:"T1020",name:"Automated Exfiltration",reference:"https://attack.mitre.org/techniques/T1020",tactics:"exfiltration",value:"automatedExfiltration"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.bitsJobsDescription",{defaultMessage:"BITS Jobs (T1197)"}),id:"T1197",name:"BITS Jobs",reference:"https://attack.mitre.org/techniques/T1197",tactics:"defense-evasion,persistence",value:"bitsJobs"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.bootOrLogonAutostartExecutionDescription",{defaultMessage:"Boot or Logon Autostart Execution (T1547)"}),id:"T1547",name:"Boot or Logon Autostart Execution",reference:"https://attack.mitre.org/techniques/T1547",tactics:"persistence,privilege-escalation",value:"bootOrLogonAutostartExecution"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.bootOrLogonInitializationScriptsDescription",{defaultMessage:"Boot or Logon Initialization Scripts (T1037)"}),id:"T1037",name:"Boot or Logon Initialization Scripts",reference:"https://attack.mitre.org/techniques/T1037",tactics:"persistence,privilege-escalation",value:"bootOrLogonInitializationScripts"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.browserBookmarkDiscoveryDescription",{defaultMessage:"Browser Bookmark Discovery (T1217)"}),id:"T1217",name:"Browser Bookmark Discovery",reference:"https://attack.mitre.org/techniques/T1217",tactics:"discovery",value:"browserBookmarkDiscovery"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.browserExtensionsDescription",{defaultMessage:"Browser Extensions (T1176)"}),id:"T1176",name:"Browser Extensions",reference:"https://attack.mitre.org/techniques/T1176",tactics:"persistence",value:"browserExtensions"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.bruteForceDescription",{defaultMessage:"Brute Force (T1110)"}),id:"T1110",name:"Brute Force",reference:"https://attack.mitre.org/techniques/T1110",tactics:"credential-access",value:"bruteForce"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.buildImageOnHostDescription",{defaultMessage:"Build Image on Host (T1612)"}),id:"T1612",name:"Build Image on Host",reference:"https://attack.mitre.org/techniques/T1612",tactics:"defense-evasion",value:"buildImageOnHost"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.clipboardDataDescription",{defaultMessage:"Clipboard Data (T1115)"}),id:"T1115",name:"Clipboard Data",reference:"https://attack.mitre.org/techniques/T1115",tactics:"collection",value:"clipboardData"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.cloudInfrastructureDiscoveryDescription",{defaultMessage:"Cloud Infrastructure Discovery (T1580)"}),id:"T1580",name:"Cloud Infrastructure Discovery",reference:"https://attack.mitre.org/techniques/T1580",tactics:"discovery",value:"cloudInfrastructureDiscovery"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.cloudServiceDashboardDescription",{defaultMessage:"Cloud Service Dashboard (T1538)"}),id:"T1538",name:"Cloud Service Dashboard",reference:"https://attack.mitre.org/techniques/T1538",tactics:"discovery",value:"cloudServiceDashboard"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.cloudServiceDiscoveryDescription",{defaultMessage:"Cloud Service Discovery (T1526)"}),id:"T1526",name:"Cloud Service Discovery",reference:"https://attack.mitre.org/techniques/T1526",tactics:"discovery",value:"cloudServiceDiscovery"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.commandAndScriptingInterpreterDescription",{defaultMessage:"Command and Scripting Interpreter (T1059)"}),id:"T1059",name:"Command and Scripting Interpreter",reference:"https://attack.mitre.org/techniques/T1059",tactics:"execution",value:"commandAndScriptingInterpreter"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.commonlyUsedPortDescription",{defaultMessage:"Commonly Used Port (T1043)"}),id:"T1043",name:"Commonly Used Port",reference:"https://attack.mitre.org/techniques/T1043",tactics:"command-and-control",value:"commonlyUsedPort"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.communicationThroughRemovableMediaDescription",{defaultMessage:"Communication Through Removable Media (T1092)"}),id:"T1092",name:"Communication Through Removable Media",reference:"https://attack.mitre.org/techniques/T1092",tactics:"command-and-control",value:"communicationThroughRemovableMedia"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.componentObjectModelAndDistributedComDescription",{defaultMessage:"Component Object Model and Distributed COM (T1175)"}),id:"T1175",name:"Component Object Model and Distributed COM",reference:"https://attack.mitre.org/techniques/T1175",tactics:"lateral-movement,execution",value:"componentObjectModelAndDistributedCom"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.compromiseAccountsDescription",{defaultMessage:"Compromise Accounts (T1586)"}),id:"T1586",name:"Compromise Accounts",reference:"https://attack.mitre.org/techniques/T1586",tactics:"resource-development",value:"compromiseAccounts"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.compromiseClientSoftwareBinaryDescription",{defaultMessage:"Compromise Client Software Binary (T1554)"}),id:"T1554",name:"Compromise Client Software Binary",reference:"https://attack.mitre.org/techniques/T1554",tactics:"persistence",value:"compromiseClientSoftwareBinary"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.compromiseInfrastructureDescription",{defaultMessage:"Compromise Infrastructure (T1584)"}),id:"T1584",name:"Compromise Infrastructure",reference:"https://attack.mitre.org/techniques/T1584",tactics:"resource-development",value:"compromiseInfrastructure"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.containerAdministrationCommandDescription",{defaultMessage:"Container Administration Command (T1609)"}),id:"T1609",name:"Container Administration Command",reference:"https://attack.mitre.org/techniques/T1609",tactics:"execution",value:"containerAdministrationCommand"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.containerAndResourceDiscoveryDescription",{defaultMessage:"Container and Resource Discovery (T1613)"}),id:"T1613",name:"Container and Resource Discovery",reference:"https://attack.mitre.org/techniques/T1613",tactics:"discovery",value:"containerAndResourceDiscovery"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.createAccountDescription",{defaultMessage:"Create Account (T1136)"}),id:"T1136",name:"Create Account",reference:"https://attack.mitre.org/techniques/T1136",tactics:"persistence",value:"createAccount"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.createOrModifySystemProcessDescription",{defaultMessage:"Create or Modify System Process (T1543)"}),id:"T1543",name:"Create or Modify System Process",reference:"https://attack.mitre.org/techniques/T1543",tactics:"persistence,privilege-escalation",value:"createOrModifySystemProcess"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.credentialsFromPasswordStoresDescription",{defaultMessage:"Credentials from Password Stores (T1555)"}),id:"T1555",name:"Credentials from Password Stores",reference:"https://attack.mitre.org/techniques/T1555",tactics:"credential-access",value:"credentialsFromPasswordStores"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dataDestructionDescription",{defaultMessage:"Data Destruction (T1485)"}),id:"T1485",name:"Data Destruction",reference:"https://attack.mitre.org/techniques/T1485",tactics:"impact",value:"dataDestruction"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dataEncodingDescription",{defaultMessage:"Data Encoding (T1132)"}),id:"T1132",name:"Data Encoding",reference:"https://attack.mitre.org/techniques/T1132",tactics:"command-and-control",value:"dataEncoding"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dataEncryptedForImpactDescription",{defaultMessage:"Data Encrypted for Impact (T1486)"}),id:"T1486",name:"Data Encrypted for Impact",reference:"https://attack.mitre.org/techniques/T1486",tactics:"impact",value:"dataEncryptedForImpact"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dataManipulationDescription",{defaultMessage:"Data Manipulation (T1565)"}),id:"T1565",name:"Data Manipulation",reference:"https://attack.mitre.org/techniques/T1565",tactics:"impact",value:"dataManipulation"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dataObfuscationDescription",{defaultMessage:"Data Obfuscation (T1001)"}),id:"T1001",name:"Data Obfuscation",reference:"https://attack.mitre.org/techniques/T1001",tactics:"command-and-control",value:"dataObfuscation"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dataStagedDescription",{defaultMessage:"Data Staged (T1074)"}),id:"T1074",name:"Data Staged",reference:"https://attack.mitre.org/techniques/T1074",tactics:"collection",value:"dataStaged"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dataTransferSizeLimitsDescription",{defaultMessage:"Data Transfer Size Limits (T1030)"}),id:"T1030",name:"Data Transfer Size Limits",reference:"https://attack.mitre.org/techniques/T1030",tactics:"exfiltration",value:"dataTransferSizeLimits"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dataFromCloudStorageObjectDescription",{defaultMessage:"Data from Cloud Storage Object (T1530)"}),id:"T1530",name:"Data from Cloud Storage Object",reference:"https://attack.mitre.org/techniques/T1530",tactics:"collection",value:"dataFromCloudStorageObject"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dataFromConfigurationRepositoryDescription",{defaultMessage:"Data from Configuration Repository (T1602)"}),id:"T1602",name:"Data from Configuration Repository",reference:"https://attack.mitre.org/techniques/T1602",tactics:"collection",value:"dataFromConfigurationRepository"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dataFromInformationRepositoriesDescription",{defaultMessage:"Data from Information Repositories (T1213)"}),id:"T1213",name:"Data from Information Repositories",reference:"https://attack.mitre.org/techniques/T1213",tactics:"collection",value:"dataFromInformationRepositories"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dataFromLocalSystemDescription",{defaultMessage:"Data from Local System (T1005)"}),id:"T1005",name:"Data from Local System",reference:"https://attack.mitre.org/techniques/T1005",tactics:"collection",value:"dataFromLocalSystem"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dataFromNetworkSharedDriveDescription",{defaultMessage:"Data from Network Shared Drive (T1039)"}),id:"T1039",name:"Data from Network Shared Drive",reference:"https://attack.mitre.org/techniques/T1039",tactics:"collection",value:"dataFromNetworkSharedDrive"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dataFromRemovableMediaDescription",{defaultMessage:"Data from Removable Media (T1025)"}),id:"T1025",name:"Data from Removable Media",reference:"https://attack.mitre.org/techniques/T1025",tactics:"collection",value:"dataFromRemovableMedia"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.defacementDescription",{defaultMessage:"Defacement (T1491)"}),id:"T1491",name:"Defacement",reference:"https://attack.mitre.org/techniques/T1491",tactics:"impact",value:"defacement"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.deobfuscateDecodeFilesOrInformationDescription",{defaultMessage:"Deobfuscate/Decode Files or Information (T1140)"}),id:"T1140",name:"Deobfuscate/Decode Files or Information",reference:"https://attack.mitre.org/techniques/T1140",tactics:"defense-evasion",value:"deobfuscateDecodeFilesOrInformation"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.deployContainerDescription",{defaultMessage:"Deploy Container (T1610)"}),id:"T1610",name:"Deploy Container",reference:"https://attack.mitre.org/techniques/T1610",tactics:"defense-evasion,execution",value:"deployContainer"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.developCapabilitiesDescription",{defaultMessage:"Develop Capabilities (T1587)"}),id:"T1587",name:"Develop Capabilities",reference:"https://attack.mitre.org/techniques/T1587",tactics:"resource-development",value:"developCapabilities"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.directVolumeAccessDescription",{defaultMessage:"Direct Volume Access (T1006)"}),id:"T1006",name:"Direct Volume Access",reference:"https://attack.mitre.org/techniques/T1006",tactics:"defense-evasion",value:"directVolumeAccess"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.diskWipeDescription",{defaultMessage:"Disk Wipe (T1561)"}),id:"T1561",name:"Disk Wipe",reference:"https://attack.mitre.org/techniques/T1561",tactics:"impact",value:"diskWipe"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.domainPolicyModificationDescription",{defaultMessage:"Domain Policy Modification (T1484)"}),id:"T1484",name:"Domain Policy Modification",reference:"https://attack.mitre.org/techniques/T1484",tactics:"defense-evasion,privilege-escalation",value:"domainPolicyModification"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.domainTrustDiscoveryDescription",{defaultMessage:"Domain Trust Discovery (T1482)"}),id:"T1482",name:"Domain Trust Discovery",reference:"https://attack.mitre.org/techniques/T1482",tactics:"discovery",value:"domainTrustDiscovery"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.driveByCompromiseDescription",{defaultMessage:"Drive-by Compromise (T1189)"}),id:"T1189",name:"Drive-by Compromise",reference:"https://attack.mitre.org/techniques/T1189",tactics:"initial-access",value:"driveByCompromise"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dynamicResolutionDescription",{defaultMessage:"Dynamic Resolution (T1568)"}),id:"T1568",name:"Dynamic Resolution",reference:"https://attack.mitre.org/techniques/T1568",tactics:"command-and-control",value:"dynamicResolution"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.emailCollectionDescription",{defaultMessage:"Email Collection (T1114)"}),id:"T1114",name:"Email Collection",reference:"https://attack.mitre.org/techniques/T1114",tactics:"collection",value:"emailCollection"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.encryptedChannelDescription",{defaultMessage:"Encrypted Channel (T1573)"}),id:"T1573",name:"Encrypted Channel",reference:"https://attack.mitre.org/techniques/T1573",tactics:"command-and-control",value:"encryptedChannel"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.endpointDenialOfServiceDescription",{defaultMessage:"Endpoint Denial of Service (T1499)"}),id:"T1499",name:"Endpoint Denial of Service",reference:"https://attack.mitre.org/techniques/T1499",tactics:"impact",value:"endpointDenialOfService"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.escapeToHostDescription",{defaultMessage:"Escape to Host (T1611)"}),id:"T1611",name:"Escape to Host",reference:"https://attack.mitre.org/techniques/T1611",tactics:"privilege-escalation",value:"escapeToHost"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.establishAccountsDescription",{defaultMessage:"Establish Accounts (T1585)"}),id:"T1585",name:"Establish Accounts",reference:"https://attack.mitre.org/techniques/T1585",tactics:"resource-development",value:"establishAccounts"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.eventTriggeredExecutionDescription",{defaultMessage:"Event Triggered Execution (T1546)"}),id:"T1546",name:"Event Triggered Execution",reference:"https://attack.mitre.org/techniques/T1546",tactics:"privilege-escalation,persistence",value:"eventTriggeredExecution"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.executionGuardrailsDescription",{defaultMessage:"Execution Guardrails (T1480)"}),id:"T1480",name:"Execution Guardrails",reference:"https://attack.mitre.org/techniques/T1480",tactics:"defense-evasion",value:"executionGuardrails"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.exfiltrationOverAlternativeProtocolDescription",{defaultMessage:"Exfiltration Over Alternative Protocol (T1048)"}),id:"T1048",name:"Exfiltration Over Alternative Protocol",reference:"https://attack.mitre.org/techniques/T1048",tactics:"exfiltration",value:"exfiltrationOverAlternativeProtocol"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.exfiltrationOverC2ChannelDescription",{defaultMessage:"Exfiltration Over C2 Channel (T1041)"}),id:"T1041",name:"Exfiltration Over C2 Channel",reference:"https://attack.mitre.org/techniques/T1041",tactics:"exfiltration",value:"exfiltrationOverC2Channel"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.exfiltrationOverOtherNetworkMediumDescription",{defaultMessage:"Exfiltration Over Other Network Medium (T1011)"}),id:"T1011",name:"Exfiltration Over Other Network Medium",reference:"https://attack.mitre.org/techniques/T1011",tactics:"exfiltration",value:"exfiltrationOverOtherNetworkMedium"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.exfiltrationOverPhysicalMediumDescription",{defaultMessage:"Exfiltration Over Physical Medium (T1052)"}),id:"T1052",name:"Exfiltration Over Physical Medium",reference:"https://attack.mitre.org/techniques/T1052",tactics:"exfiltration",value:"exfiltrationOverPhysicalMedium"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.exfiltrationOverWebServiceDescription",{defaultMessage:"Exfiltration Over Web Service (T1567)"}),id:"T1567",name:"Exfiltration Over Web Service",reference:"https://attack.mitre.org/techniques/T1567",tactics:"exfiltration",value:"exfiltrationOverWebService"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.exploitPublicFacingApplicationDescription",{defaultMessage:"Exploit Public-Facing Application (T1190)"}),id:"T1190",name:"Exploit Public-Facing Application",reference:"https://attack.mitre.org/techniques/T1190",tactics:"initial-access",value:"exploitPublicFacingApplication"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.exploitationForClientExecutionDescription",{defaultMessage:"Exploitation for Client Execution (T1203)"}),id:"T1203",name:"Exploitation for Client Execution",reference:"https://attack.mitre.org/techniques/T1203",tactics:"execution",value:"exploitationForClientExecution"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.exploitationForCredentialAccessDescription",{defaultMessage:"Exploitation for Credential Access (T1212)"}),id:"T1212",name:"Exploitation for Credential Access",reference:"https://attack.mitre.org/techniques/T1212",tactics:"credential-access",value:"exploitationForCredentialAccess"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.exploitationForDefenseEvasionDescription",{defaultMessage:"Exploitation for Defense Evasion (T1211)"}),id:"T1211",name:"Exploitation for Defense Evasion",reference:"https://attack.mitre.org/techniques/T1211",tactics:"defense-evasion",value:"exploitationForDefenseEvasion"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.exploitationForPrivilegeEscalationDescription",{defaultMessage:"Exploitation for Privilege Escalation (T1068)"}),id:"T1068",name:"Exploitation for Privilege Escalation",reference:"https://attack.mitre.org/techniques/T1068",tactics:"privilege-escalation",value:"exploitationForPrivilegeEscalation"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.exploitationOfRemoteServicesDescription",{defaultMessage:"Exploitation of Remote Services (T1210)"}),id:"T1210",name:"Exploitation of Remote Services",reference:"https://attack.mitre.org/techniques/T1210",tactics:"lateral-movement",value:"exploitationOfRemoteServices"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.externalRemoteServicesDescription",{defaultMessage:"External Remote Services (T1133)"}),id:"T1133",name:"External Remote Services",reference:"https://attack.mitre.org/techniques/T1133",tactics:"persistence,initial-access",value:"externalRemoteServices"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.fallbackChannelsDescription",{defaultMessage:"Fallback Channels (T1008)"}),id:"T1008",name:"Fallback Channels",reference:"https://attack.mitre.org/techniques/T1008",tactics:"command-and-control",value:"fallbackChannels"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.fileAndDirectoryDiscoveryDescription",{defaultMessage:"File and Directory Discovery (T1083)"}),id:"T1083",name:"File and Directory Discovery",reference:"https://attack.mitre.org/techniques/T1083",tactics:"discovery",value:"fileAndDirectoryDiscovery"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.fileAndDirectoryPermissionsModificationDescription",{defaultMessage:"File and Directory Permissions Modification (T1222)"}),id:"T1222",name:"File and Directory Permissions Modification",reference:"https://attack.mitre.org/techniques/T1222",tactics:"defense-evasion",value:"fileAndDirectoryPermissionsModification"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.firmwareCorruptionDescription",{defaultMessage:"Firmware Corruption (T1495)"}),id:"T1495",name:"Firmware Corruption",reference:"https://attack.mitre.org/techniques/T1495",tactics:"impact",value:"firmwareCorruption"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.forcedAuthenticationDescription",{defaultMessage:"Forced Authentication (T1187)"}),id:"T1187",name:"Forced Authentication",reference:"https://attack.mitre.org/techniques/T1187",tactics:"credential-access",value:"forcedAuthentication"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.forgeWebCredentialsDescription",{defaultMessage:"Forge Web Credentials (T1606)"}),id:"T1606",name:"Forge Web Credentials",reference:"https://attack.mitre.org/techniques/T1606",tactics:"credential-access",value:"forgeWebCredentials"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.gatherVictimHostInformationDescription",{defaultMessage:"Gather Victim Host Information (T1592)"}),id:"T1592",name:"Gather Victim Host Information",reference:"https://attack.mitre.org/techniques/T1592",tactics:"reconnaissance",value:"gatherVictimHostInformation"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.gatherVictimIdentityInformationDescription",{defaultMessage:"Gather Victim Identity Information (T1589)"}),id:"T1589",name:"Gather Victim Identity Information",reference:"https://attack.mitre.org/techniques/T1589",tactics:"reconnaissance",value:"gatherVictimIdentityInformation"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.gatherVictimNetworkInformationDescription",{defaultMessage:"Gather Victim Network Information (T1590)"}),id:"T1590",name:"Gather Victim Network Information",reference:"https://attack.mitre.org/techniques/T1590",tactics:"reconnaissance",value:"gatherVictimNetworkInformation"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.gatherVictimOrgInformationDescription",{defaultMessage:"Gather Victim Org Information (T1591)"}),id:"T1591",name:"Gather Victim Org Information",reference:"https://attack.mitre.org/techniques/T1591",tactics:"reconnaissance",value:"gatherVictimOrgInformation"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.graphicalUserInterfaceDescription",{defaultMessage:"Graphical User Interface (T1061)"}),id:"T1061",name:"Graphical User Interface",reference:"https://attack.mitre.org/techniques/T1061",tactics:"execution",value:"graphicalUserInterface"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.hardwareAdditionsDescription",{defaultMessage:"Hardware Additions (T1200)"}),id:"T1200",name:"Hardware Additions",reference:"https://attack.mitre.org/techniques/T1200",tactics:"initial-access",value:"hardwareAdditions"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.hideArtifactsDescription",{defaultMessage:"Hide Artifacts (T1564)"}),id:"T1564",name:"Hide Artifacts",reference:"https://attack.mitre.org/techniques/T1564",tactics:"defense-evasion",value:"hideArtifacts"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.hijackExecutionFlowDescription",{defaultMessage:"Hijack Execution Flow (T1574)"}),id:"T1574",name:"Hijack Execution Flow",reference:"https://attack.mitre.org/techniques/T1574",tactics:"persistence,privilege-escalation,defense-evasion",value:"hijackExecutionFlow"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.hypervisorDescription",{defaultMessage:"Hypervisor (T1062)"}),id:"T1062",name:"Hypervisor",reference:"https://attack.mitre.org/techniques/T1062",tactics:"persistence",value:"hypervisor"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.impairDefensesDescription",{defaultMessage:"Impair Defenses (T1562)"}),id:"T1562",name:"Impair Defenses",reference:"https://attack.mitre.org/techniques/T1562",tactics:"defense-evasion",value:"impairDefenses"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.implantInternalImageDescription",{defaultMessage:"Implant Internal Image (T1525)"}),id:"T1525",name:"Implant Internal Image",reference:"https://attack.mitre.org/techniques/T1525",tactics:"persistence",value:"implantInternalImage"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.indicatorRemovalOnHostDescription",{defaultMessage:"Indicator Removal on Host (T1070)"}),id:"T1070",name:"Indicator Removal on Host",reference:"https://attack.mitre.org/techniques/T1070",tactics:"defense-evasion",value:"indicatorRemovalOnHost"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.indirectCommandExecutionDescription",{defaultMessage:"Indirect Command Execution (T1202)"}),id:"T1202",name:"Indirect Command Execution",reference:"https://attack.mitre.org/techniques/T1202",tactics:"defense-evasion",value:"indirectCommandExecution"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.ingressToolTransferDescription",{defaultMessage:"Ingress Tool Transfer (T1105)"}),id:"T1105",name:"Ingress Tool Transfer",reference:"https://attack.mitre.org/techniques/T1105",tactics:"command-and-control",value:"ingressToolTransfer"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.inhibitSystemRecoveryDescription",{defaultMessage:"Inhibit System Recovery (T1490)"}),id:"T1490",name:"Inhibit System Recovery",reference:"https://attack.mitre.org/techniques/T1490",tactics:"impact",value:"inhibitSystemRecovery"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.inputCaptureDescription",{defaultMessage:"Input Capture (T1056)"}),id:"T1056",name:"Input Capture",reference:"https://attack.mitre.org/techniques/T1056",tactics:"collection,credential-access",value:"inputCapture"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.interProcessCommunicationDescription",{defaultMessage:"Inter-Process Communication (T1559)"}),id:"T1559",name:"Inter-Process Communication",reference:"https://attack.mitre.org/techniques/T1559",tactics:"execution",value:"interProcessCommunication"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.internalSpearphishingDescription",{defaultMessage:"Internal Spearphishing (T1534)"}),id:"T1534",name:"Internal Spearphishing",reference:"https://attack.mitre.org/techniques/T1534",tactics:"lateral-movement",value:"internalSpearphishing"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.lcMainHijackingDescription",{defaultMessage:"LC_MAIN Hijacking (T1149)"}),id:"T1149",name:"LC_MAIN Hijacking",reference:"https://attack.mitre.org/techniques/T1149",tactics:"defense-evasion",value:"lcMainHijacking"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.lateralToolTransferDescription",{defaultMessage:"Lateral Tool Transfer (T1570)"}),id:"T1570",name:"Lateral Tool Transfer",reference:"https://attack.mitre.org/techniques/T1570",tactics:"lateral-movement",value:"lateralToolTransfer"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.manInTheBrowserDescription",{defaultMessage:"Man in the Browser (T1185)"}),id:"T1185",name:"Man in the Browser",reference:"https://attack.mitre.org/techniques/T1185",tactics:"collection",value:"manInTheBrowser"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.manInTheMiddleDescription",{defaultMessage:"Man-in-the-Middle (T1557)"}),id:"T1557",name:"Man-in-the-Middle",reference:"https://attack.mitre.org/techniques/T1557",tactics:"credential-access,collection",value:"manInTheMiddle"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.masqueradingDescription",{defaultMessage:"Masquerading (T1036)"}),id:"T1036",name:"Masquerading",reference:"https://attack.mitre.org/techniques/T1036",tactics:"defense-evasion",value:"masquerading"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.modifyAuthenticationProcessDescription",{defaultMessage:"Modify Authentication Process (T1556)"}),id:"T1556",name:"Modify Authentication Process",reference:"https://attack.mitre.org/techniques/T1556",tactics:"credential-access,defense-evasion,persistence",value:"modifyAuthenticationProcess"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.modifyCloudComputeInfrastructureDescription",{defaultMessage:"Modify Cloud Compute Infrastructure (T1578)"}),id:"T1578",name:"Modify Cloud Compute Infrastructure",reference:"https://attack.mitre.org/techniques/T1578",tactics:"defense-evasion",value:"modifyCloudComputeInfrastructure"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.modifyRegistryDescription",{defaultMessage:"Modify Registry (T1112)"}),id:"T1112",name:"Modify Registry",reference:"https://attack.mitre.org/techniques/T1112",tactics:"defense-evasion",value:"modifyRegistry"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.modifySystemImageDescription",{defaultMessage:"Modify System Image (T1601)"}),id:"T1601",name:"Modify System Image",reference:"https://attack.mitre.org/techniques/T1601",tactics:"defense-evasion",value:"modifySystemImage"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.multiStageChannelsDescription",{defaultMessage:"Multi-Stage Channels (T1104)"}),id:"T1104",name:"Multi-Stage Channels",reference:"https://attack.mitre.org/techniques/T1104",tactics:"command-and-control",value:"multiStageChannels"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.multibandCommunicationDescription",{defaultMessage:"Multiband Communication (T1026)"}),id:"T1026",name:"Multiband Communication",reference:"https://attack.mitre.org/techniques/T1026",tactics:"command-and-control",value:"multibandCommunication"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.nativeApiDescription",{defaultMessage:"Native API (T1106)"}),id:"T1106",name:"Native API",reference:"https://attack.mitre.org/techniques/T1106",tactics:"execution",value:"nativeApi"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.networkBoundaryBridgingDescription",{defaultMessage:"Network Boundary Bridging (T1599)"}),id:"T1599",name:"Network Boundary Bridging",reference:"https://attack.mitre.org/techniques/T1599",tactics:"defense-evasion",value:"networkBoundaryBridging"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.networkDenialOfServiceDescription",{defaultMessage:"Network Denial of Service (T1498)"}),id:"T1498",name:"Network Denial of Service",reference:"https://attack.mitre.org/techniques/T1498",tactics:"impact",value:"networkDenialOfService"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.networkServiceScanningDescription",{defaultMessage:"Network Service Scanning (T1046)"}),id:"T1046",name:"Network Service Scanning",reference:"https://attack.mitre.org/techniques/T1046",tactics:"discovery",value:"networkServiceScanning"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.networkShareDiscoveryDescription",{defaultMessage:"Network Share Discovery (T1135)"}),id:"T1135",name:"Network Share Discovery",reference:"https://attack.mitre.org/techniques/T1135",tactics:"discovery",value:"networkShareDiscovery"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.networkSniffingDescription",{defaultMessage:"Network Sniffing (T1040)"}),id:"T1040",name:"Network Sniffing",reference:"https://attack.mitre.org/techniques/T1040",tactics:"credential-access,discovery",value:"networkSniffing"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.nonApplicationLayerProtocolDescription",{defaultMessage:"Non-Application Layer Protocol (T1095)"}),id:"T1095",name:"Non-Application Layer Protocol",reference:"https://attack.mitre.org/techniques/T1095",tactics:"command-and-control",value:"nonApplicationLayerProtocol"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.nonStandardPortDescription",{defaultMessage:"Non-Standard Port (T1571)"}),id:"T1571",name:"Non-Standard Port",reference:"https://attack.mitre.org/techniques/T1571",tactics:"command-and-control",value:"nonStandardPort"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.osCredentialDumpingDescription",{defaultMessage:"OS Credential Dumping (T1003)"}),id:"T1003",name:"OS Credential Dumping",reference:"https://attack.mitre.org/techniques/T1003",tactics:"credential-access",value:"osCredentialDumping"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.obfuscatedFilesOrInformationDescription",{defaultMessage:"Obfuscated Files or Information (T1027)"}),id:"T1027",name:"Obfuscated Files or Information",reference:"https://attack.mitre.org/techniques/T1027",tactics:"defense-evasion",value:"obfuscatedFilesOrInformation"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.obtainCapabilitiesDescription",{defaultMessage:"Obtain Capabilities (T1588)"}),id:"T1588",name:"Obtain Capabilities",reference:"https://attack.mitre.org/techniques/T1588",tactics:"resource-development",value:"obtainCapabilities"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.officeApplicationStartupDescription",{defaultMessage:"Office Application Startup (T1137)"}),id:"T1137",name:"Office Application Startup",reference:"https://attack.mitre.org/techniques/T1137",tactics:"persistence",value:"officeApplicationStartup"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.passwordPolicyDiscoveryDescription",{defaultMessage:"Password Policy Discovery (T1201)"}),id:"T1201",name:"Password Policy Discovery",reference:"https://attack.mitre.org/techniques/T1201",tactics:"discovery",value:"passwordPolicyDiscovery"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.pathInterceptionDescription",{defaultMessage:"Path Interception (T1034)"}),id:"T1034",name:"Path Interception",reference:"https://attack.mitre.org/techniques/T1034",tactics:"persistence,privilege-escalation",value:"pathInterception"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.peripheralDeviceDiscoveryDescription",{defaultMessage:"Peripheral Device Discovery (T1120)"}),id:"T1120",name:"Peripheral Device Discovery",reference:"https://attack.mitre.org/techniques/T1120",tactics:"discovery",value:"peripheralDeviceDiscovery"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.permissionGroupsDiscoveryDescription",{defaultMessage:"Permission Groups Discovery (T1069)"}),id:"T1069",name:"Permission Groups Discovery",reference:"https://attack.mitre.org/techniques/T1069",tactics:"discovery",value:"permissionGroupsDiscovery"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.phishingDescription",{defaultMessage:"Phishing (T1566)"}),id:"T1566",name:"Phishing",reference:"https://attack.mitre.org/techniques/T1566",tactics:"initial-access",value:"phishing"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.phishingForInformationDescription",{defaultMessage:"Phishing for Information (T1598)"}),id:"T1598",name:"Phishing for Information",reference:"https://attack.mitre.org/techniques/T1598",tactics:"reconnaissance",value:"phishingForInformation"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.preOsBootDescription",{defaultMessage:"Pre-OS Boot (T1542)"}),id:"T1542",name:"Pre-OS Boot",reference:"https://attack.mitre.org/techniques/T1542",tactics:"defense-evasion,persistence",value:"preOsBoot"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.processDiscoveryDescription",{defaultMessage:"Process Discovery (T1057)"}),id:"T1057",name:"Process Discovery",reference:"https://attack.mitre.org/techniques/T1057",tactics:"discovery",value:"processDiscovery"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.processInjectionDescription",{defaultMessage:"Process Injection (T1055)"}),id:"T1055",name:"Process Injection",reference:"https://attack.mitre.org/techniques/T1055",tactics:"defense-evasion,privilege-escalation",value:"processInjection"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.protocolTunnelingDescription",{defaultMessage:"Protocol Tunneling (T1572)"}),id:"T1572",name:"Protocol Tunneling",reference:"https://attack.mitre.org/techniques/T1572",tactics:"command-and-control",value:"protocolTunneling"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.proxyDescription",{defaultMessage:"Proxy (T1090)"}),id:"T1090",name:"Proxy",reference:"https://attack.mitre.org/techniques/T1090",tactics:"command-and-control",value:"proxy"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.queryRegistryDescription",{defaultMessage:"Query Registry (T1012)"}),id:"T1012",name:"Query Registry",reference:"https://attack.mitre.org/techniques/T1012",tactics:"discovery",value:"queryRegistry"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.redundantAccessDescription",{defaultMessage:"Redundant Access (T1108)"}),id:"T1108",name:"Redundant Access",reference:"https://attack.mitre.org/techniques/T1108",tactics:"defense-evasion,persistence",value:"redundantAccess"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.remoteAccessSoftwareDescription",{defaultMessage:"Remote Access Software (T1219)"}),id:"T1219",name:"Remote Access Software",reference:"https://attack.mitre.org/techniques/T1219",tactics:"command-and-control",value:"remoteAccessSoftware"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.remoteServiceSessionHijackingDescription",{defaultMessage:"Remote Service Session Hijacking (T1563)"}),id:"T1563",name:"Remote Service Session Hijacking",reference:"https://attack.mitre.org/techniques/T1563",tactics:"lateral-movement",value:"remoteServiceSessionHijacking"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.remoteServicesDescription",{defaultMessage:"Remote Services (T1021)"}),id:"T1021",name:"Remote Services",reference:"https://attack.mitre.org/techniques/T1021",tactics:"lateral-movement",value:"remoteServices"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.remoteSystemDiscoveryDescription",{defaultMessage:"Remote System Discovery (T1018)"}),id:"T1018",name:"Remote System Discovery",reference:"https://attack.mitre.org/techniques/T1018",tactics:"discovery",value:"remoteSystemDiscovery"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.replicationThroughRemovableMediaDescription",{defaultMessage:"Replication Through Removable Media (T1091)"}),id:"T1091",name:"Replication Through Removable Media",reference:"https://attack.mitre.org/techniques/T1091",tactics:"lateral-movement,initial-access",value:"replicationThroughRemovableMedia"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.resourceHijackingDescription",{defaultMessage:"Resource Hijacking (T1496)"}),id:"T1496",name:"Resource Hijacking",reference:"https://attack.mitre.org/techniques/T1496",tactics:"impact",value:"resourceHijacking"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.rogueDomainControllerDescription",{defaultMessage:"Rogue Domain Controller (T1207)"}),id:"T1207",name:"Rogue Domain Controller",reference:"https://attack.mitre.org/techniques/T1207",tactics:"defense-evasion",value:"rogueDomainController"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.rootkitDescription",{defaultMessage:"Rootkit (T1014)"}),id:"T1014",name:"Rootkit",reference:"https://attack.mitre.org/techniques/T1014",tactics:"defense-evasion",value:"rootkit"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.scheduledTaskJobDescription",{defaultMessage:"Scheduled Task/Job (T1053)"}),id:"T1053",name:"Scheduled Task/Job",reference:"https://attack.mitre.org/techniques/T1053",tactics:"execution,persistence,privilege-escalation",value:"scheduledTaskJob"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.scheduledTransferDescription",{defaultMessage:"Scheduled Transfer (T1029)"}),id:"T1029",name:"Scheduled Transfer",reference:"https://attack.mitre.org/techniques/T1029",tactics:"exfiltration",value:"scheduledTransfer"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.screenCaptureDescription",{defaultMessage:"Screen Capture (T1113)"}),id:"T1113",name:"Screen Capture",reference:"https://attack.mitre.org/techniques/T1113",tactics:"collection",value:"screenCapture"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.scriptingDescription",{defaultMessage:"Scripting (T1064)"}),id:"T1064",name:"Scripting",reference:"https://attack.mitre.org/techniques/T1064",tactics:"defense-evasion,execution",value:"scripting"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.searchClosedSourcesDescription",{defaultMessage:"Search Closed Sources (T1597)"}),id:"T1597",name:"Search Closed Sources",reference:"https://attack.mitre.org/techniques/T1597",tactics:"reconnaissance",value:"searchClosedSources"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.searchOpenTechnicalDatabasesDescription",{defaultMessage:"Search Open Technical Databases (T1596)"}),id:"T1596",name:"Search Open Technical Databases",reference:"https://attack.mitre.org/techniques/T1596",tactics:"reconnaissance",value:"searchOpenTechnicalDatabases"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.searchOpenWebsitesDomainsDescription",{defaultMessage:"Search Open Websites/Domains (T1593)"}),id:"T1593",name:"Search Open Websites/Domains",reference:"https://attack.mitre.org/techniques/T1593",tactics:"reconnaissance",value:"searchOpenWebsitesDomains"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.searchVictimOwnedWebsitesDescription",{defaultMessage:"Search Victim-Owned Websites (T1594)"}),id:"T1594",name:"Search Victim-Owned Websites",reference:"https://attack.mitre.org/techniques/T1594",tactics:"reconnaissance",value:"searchVictimOwnedWebsites"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.serverSoftwareComponentDescription",{defaultMessage:"Server Software Component (T1505)"}),id:"T1505",name:"Server Software Component",reference:"https://attack.mitre.org/techniques/T1505",tactics:"persistence",value:"serverSoftwareComponent"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.serviceStopDescription",{defaultMessage:"Service Stop (T1489)"}),id:"T1489",name:"Service Stop",reference:"https://attack.mitre.org/techniques/T1489",tactics:"impact",value:"serviceStop"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.sharedModulesDescription",{defaultMessage:"Shared Modules (T1129)"}),id:"T1129",name:"Shared Modules",reference:"https://attack.mitre.org/techniques/T1129",tactics:"execution",value:"sharedModules"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.sharedWebrootDescription",{defaultMessage:"Shared Webroot (T1051)"}),id:"T1051",name:"Shared Webroot",reference:"https://attack.mitre.org/techniques/T1051",tactics:"lateral-movement",value:"sharedWebroot"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.signedBinaryProxyExecutionDescription",{defaultMessage:"Signed Binary Proxy Execution (T1218)"}),id:"T1218",name:"Signed Binary Proxy Execution",reference:"https://attack.mitre.org/techniques/T1218",tactics:"defense-evasion",value:"signedBinaryProxyExecution"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.signedScriptProxyExecutionDescription",{defaultMessage:"Signed Script Proxy Execution (T1216)"}),id:"T1216",name:"Signed Script Proxy Execution",reference:"https://attack.mitre.org/techniques/T1216",tactics:"defense-evasion",value:"signedScriptProxyExecution"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.softwareDeploymentToolsDescription",{defaultMessage:"Software Deployment Tools (T1072)"}),id:"T1072",name:"Software Deployment Tools",reference:"https://attack.mitre.org/techniques/T1072",tactics:"execution,lateral-movement",value:"softwareDeploymentTools"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.softwareDiscoveryDescription",{defaultMessage:"Software Discovery (T1518)"}),id:"T1518",name:"Software Discovery",reference:"https://attack.mitre.org/techniques/T1518",tactics:"discovery",value:"softwareDiscovery"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.sourceDescription",{defaultMessage:"Source (T1153)"}),id:"T1153",name:"Source",reference:"https://attack.mitre.org/techniques/T1153",tactics:"execution",value:"source"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.stageCapabilitiesDescription",{defaultMessage:"Stage Capabilities (T1608)"}),id:"T1608",name:"Stage Capabilities",reference:"https://attack.mitre.org/techniques/T1608",tactics:"resource-development",value:"stageCapabilities"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.stealApplicationAccessTokenDescription",{defaultMessage:"Steal Application Access Token (T1528)"}),id:"T1528",name:"Steal Application Access Token",reference:"https://attack.mitre.org/techniques/T1528",tactics:"credential-access",value:"stealApplicationAccessToken"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.stealWebSessionCookieDescription",{defaultMessage:"Steal Web Session Cookie (T1539)"}),id:"T1539",name:"Steal Web Session Cookie",reference:"https://attack.mitre.org/techniques/T1539",tactics:"credential-access",value:"stealWebSessionCookie"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.stealOrForgeKerberosTicketsDescription",{defaultMessage:"Steal or Forge Kerberos Tickets (T1558)"}),id:"T1558",name:"Steal or Forge Kerberos Tickets",reference:"https://attack.mitre.org/techniques/T1558",tactics:"credential-access",value:"stealOrForgeKerberosTickets"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.subvertTrustControlsDescription",{defaultMessage:"Subvert Trust Controls (T1553)"}),id:"T1553",name:"Subvert Trust Controls",reference:"https://attack.mitre.org/techniques/T1553",tactics:"defense-evasion",value:"subvertTrustControls"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.supplyChainCompromiseDescription",{defaultMessage:"Supply Chain Compromise (T1195)"}),id:"T1195",name:"Supply Chain Compromise",reference:"https://attack.mitre.org/techniques/T1195",tactics:"initial-access",value:"supplyChainCompromise"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.systemInformationDiscoveryDescription",{defaultMessage:"System Information Discovery (T1082)"}),id:"T1082",name:"System Information Discovery",reference:"https://attack.mitre.org/techniques/T1082",tactics:"discovery",value:"systemInformationDiscovery"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.systemLocationDiscoveryDescription",{defaultMessage:"System Location Discovery (T1614)"}),id:"T1614",name:"System Location Discovery",reference:"https://attack.mitre.org/techniques/T1614",tactics:"discovery",value:"systemLocationDiscovery"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.systemNetworkConfigurationDiscoveryDescription",{defaultMessage:"System Network Configuration Discovery (T1016)"}),id:"T1016",name:"System Network Configuration Discovery",reference:"https://attack.mitre.org/techniques/T1016",tactics:"discovery",value:"systemNetworkConfigurationDiscovery"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.systemNetworkConnectionsDiscoveryDescription",{defaultMessage:"System Network Connections Discovery (T1049)"}),id:"T1049",name:"System Network Connections Discovery",reference:"https://attack.mitre.org/techniques/T1049",tactics:"discovery",value:"systemNetworkConnectionsDiscovery"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.systemOwnerUserDiscoveryDescription",{defaultMessage:"System Owner/User Discovery (T1033)"}),id:"T1033",name:"System Owner/User Discovery",reference:"https://attack.mitre.org/techniques/T1033",tactics:"discovery",value:"systemOwnerUserDiscovery"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.systemServiceDiscoveryDescription",{defaultMessage:"System Service Discovery (T1007)"}),id:"T1007",name:"System Service Discovery",reference:"https://attack.mitre.org/techniques/T1007",tactics:"discovery",value:"systemServiceDiscovery"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.systemServicesDescription",{defaultMessage:"System Services (T1569)"}),id:"T1569",name:"System Services",reference:"https://attack.mitre.org/techniques/T1569",tactics:"execution",value:"systemServices"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.systemShutdownRebootDescription",{defaultMessage:"System Shutdown/Reboot (T1529)"}),id:"T1529",name:"System Shutdown/Reboot",reference:"https://attack.mitre.org/techniques/T1529",tactics:"impact",value:"systemShutdownReboot"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.systemTimeDiscoveryDescription",{defaultMessage:"System Time Discovery (T1124)"}),id:"T1124",name:"System Time Discovery",reference:"https://attack.mitre.org/techniques/T1124",tactics:"discovery",value:"systemTimeDiscovery"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.taintSharedContentDescription",{defaultMessage:"Taint Shared Content (T1080)"}),id:"T1080",name:"Taint Shared Content",reference:"https://attack.mitre.org/techniques/T1080",tactics:"lateral-movement",value:"taintSharedContent"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.templateInjectionDescription",{defaultMessage:"Template Injection (T1221)"}),id:"T1221",name:"Template Injection",reference:"https://attack.mitre.org/techniques/T1221",tactics:"defense-evasion",value:"templateInjection"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.trafficSignalingDescription",{defaultMessage:"Traffic Signaling (T1205)"}),id:"T1205",name:"Traffic Signaling",reference:"https://attack.mitre.org/techniques/T1205",tactics:"defense-evasion,persistence,command-and-control",value:"trafficSignaling"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.transferDataToCloudAccountDescription",{defaultMessage:"Transfer Data to Cloud Account (T1537)"}),id:"T1537",name:"Transfer Data to Cloud Account",reference:"https://attack.mitre.org/techniques/T1537",tactics:"exfiltration",value:"transferDataToCloudAccount"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.trustedDeveloperUtilitiesProxyExecutionDescription",{defaultMessage:"Trusted Developer Utilities Proxy Execution (T1127)"}),id:"T1127",name:"Trusted Developer Utilities Proxy Execution",reference:"https://attack.mitre.org/techniques/T1127",tactics:"defense-evasion",value:"trustedDeveloperUtilitiesProxyExecution"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.trustedRelationshipDescription",{defaultMessage:"Trusted Relationship (T1199)"}),id:"T1199",name:"Trusted Relationship",reference:"https://attack.mitre.org/techniques/T1199",tactics:"initial-access",value:"trustedRelationship"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.twoFactorAuthenticationInterceptionDescription",{defaultMessage:"Two-Factor Authentication Interception (T1111)"}),id:"T1111",name:"Two-Factor Authentication Interception",reference:"https://attack.mitre.org/techniques/T1111",tactics:"credential-access",value:"twoFactorAuthenticationInterception"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.unsecuredCredentialsDescription",{defaultMessage:"Unsecured Credentials (T1552)"}),id:"T1552",name:"Unsecured Credentials",reference:"https://attack.mitre.org/techniques/T1552",tactics:"credential-access",value:"unsecuredCredentials"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.unusedUnsupportedCloudRegionsDescription",{defaultMessage:"Unused/Unsupported Cloud Regions (T1535)"}),id:"T1535",name:"Unused/Unsupported Cloud Regions",reference:"https://attack.mitre.org/techniques/T1535",tactics:"defense-evasion",value:"unusedUnsupportedCloudRegions"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.useAlternateAuthenticationMaterialDescription",{defaultMessage:"Use Alternate Authentication Material (T1550)"}),id:"T1550",name:"Use Alternate Authentication Material",reference:"https://attack.mitre.org/techniques/T1550",tactics:"defense-evasion,lateral-movement",value:"useAlternateAuthenticationMaterial"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.userExecutionDescription",{defaultMessage:"User Execution (T1204)"}),id:"T1204",name:"User Execution",reference:"https://attack.mitre.org/techniques/T1204",tactics:"execution",value:"userExecution"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.validAccountsDescription",{defaultMessage:"Valid Accounts (T1078)"}),id:"T1078",name:"Valid Accounts",reference:"https://attack.mitre.org/techniques/T1078",tactics:"defense-evasion,persistence,privilege-escalation,initial-access",value:"validAccounts"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.videoCaptureDescription",{defaultMessage:"Video Capture (T1125)"}),id:"T1125",name:"Video Capture",reference:"https://attack.mitre.org/techniques/T1125",tactics:"collection",value:"videoCapture"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.virtualizationSandboxEvasionDescription",{defaultMessage:"Virtualization/Sandbox Evasion (T1497)"}),id:"T1497",name:"Virtualization/Sandbox Evasion",reference:"https://attack.mitre.org/techniques/T1497",tactics:"defense-evasion,discovery",value:"virtualizationSandboxEvasion"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.weakenEncryptionDescription",{defaultMessage:"Weaken Encryption (T1600)"}),id:"T1600",name:"Weaken Encryption",reference:"https://attack.mitre.org/techniques/T1600",tactics:"defense-evasion",value:"weakenEncryption"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.webServiceDescription",{defaultMessage:"Web Service (T1102)"}),id:"T1102",name:"Web Service",reference:"https://attack.mitre.org/techniques/T1102",tactics:"command-and-control",value:"webService"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.windowsManagementInstrumentationDescription",{defaultMessage:"Windows Management Instrumentation (T1047)"}),id:"T1047",name:"Windows Management Instrumentation",reference:"https://attack.mitre.org/techniques/T1047",tactics:"execution",value:"windowsManagementInstrumentation"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.xslScriptProcessingDescription",{defaultMessage:"XSL Script Processing (T1220)"}),id:"T1220",name:"XSL Script Processing",reference:"https://attack.mitre.org/techniques/T1220",tactics:"defense-evasion",value:"xslScriptProcessing"}],Ry=[{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.etcPasswdAndEtcShadowT1003Description",{defaultMessage:"/etc/passwd and /etc/shadow (T1003.008)"}),id:"T1003.008",name:"/etc/passwd and /etc/shadow",reference:"https://attack.mitre.org/techniques/T1003/008",tactics:"credential-access",techniqueId:"T1003",value:"etcPasswdAndEtcShadow"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.arpCachePoisoningT1557Description",{defaultMessage:"ARP Cache Poisoning (T1557.002)"}),id:"T1557.002",name:"ARP Cache Poisoning",reference:"https://attack.mitre.org/techniques/T1557/002",tactics:"credential-access,collection",techniqueId:"T1557",value:"arpCachePoisoning"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.asRepRoastingT1558Description",{defaultMessage:"AS-REP Roasting (T1558.004)"}),id:"T1558.004",name:"AS-REP Roasting",reference:"https://attack.mitre.org/techniques/T1558/004",tactics:"credential-access",techniqueId:"T1558",value:"asRepRoasting"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.accessibilityFeaturesT1546Description",{defaultMessage:"Accessibility Features (T1546.008)"}),id:"T1546.008",name:"Accessibility Features",reference:"https://attack.mitre.org/techniques/T1546/008",tactics:"privilege-escalation,persistence",techniqueId:"T1546",value:"accessibilityFeatures"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.activeSetupT1547Description",{defaultMessage:"Active Setup (T1547.014)"}),id:"T1547.014",name:"Active Setup",reference:"https://attack.mitre.org/techniques/T1547/014",tactics:"persistence,privilege-escalation",techniqueId:"T1547",value:"activeSetup"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.addOffice365GlobalAdministratorRoleT1098Description",{defaultMessage:"Add Office 365 Global Administrator Role (T1098.003)"}),id:"T1098.003",name:"Add Office 365 Global Administrator Role",reference:"https://attack.mitre.org/techniques/T1098/003",tactics:"persistence",techniqueId:"T1098",value:"addOffice365GlobalAdministratorRole"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.addInsT1137Description",{defaultMessage:"Add-ins (T1137.006)"}),id:"T1137.006",name:"Add-ins",reference:"https://attack.mitre.org/techniques/T1137/006",tactics:"persistence",techniqueId:"T1137",value:"addIns"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.additionalCloudCredentialsT1098Description",{defaultMessage:"Additional Cloud Credentials (T1098.001)"}),id:"T1098.001",name:"Additional Cloud Credentials",reference:"https://attack.mitre.org/techniques/T1098/001",tactics:"persistence",techniqueId:"T1098",value:"additionalCloudCredentials"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.appCertDlLsT1546Description",{defaultMessage:"AppCert DLLs (T1546.009)"}),id:"T1546.009",name:"AppCert DLLs",reference:"https://attack.mitre.org/techniques/T1546/009",tactics:"privilege-escalation,persistence",techniqueId:"T1546",value:"appCertDlLs"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.appInitDlLsT1546Description",{defaultMessage:"AppInit DLLs (T1546.010)"}),id:"T1546.010",name:"AppInit DLLs",reference:"https://attack.mitre.org/techniques/T1546/010",tactics:"privilege-escalation,persistence",techniqueId:"T1546",value:"appInitDlLs"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.appleScriptT1059Description",{defaultMessage:"AppleScript (T1059.002)"}),id:"T1059.002",name:"AppleScript",reference:"https://attack.mitre.org/techniques/T1059/002",tactics:"execution",techniqueId:"T1059",value:"appleScript"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.applicationAccessTokenT1550Description",{defaultMessage:"Application Access Token (T1550.001)"}),id:"T1550.001",name:"Application Access Token",reference:"https://attack.mitre.org/techniques/T1550/001",tactics:"defense-evasion,lateral-movement",techniqueId:"T1550",value:"applicationAccessToken"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.applicationExhaustionFloodT1499Description",{defaultMessage:"Application Exhaustion Flood (T1499.003)"}),id:"T1499.003",name:"Application Exhaustion Flood",reference:"https://attack.mitre.org/techniques/T1499/003",tactics:"impact",techniqueId:"T1499",value:"applicationExhaustionFlood"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.applicationShimmingT1546Description",{defaultMessage:"Application Shimming (T1546.011)"}),id:"T1546.011",name:"Application Shimming",reference:"https://attack.mitre.org/techniques/T1546/011",tactics:"privilege-escalation,persistence",techniqueId:"T1546",value:"applicationShimming"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.applicationOrSystemExploitationT1499Description",{defaultMessage:"Application or System Exploitation (T1499.004)"}),id:"T1499.004",name:"Application or System Exploitation",reference:"https://attack.mitre.org/techniques/T1499/004",tactics:"impact",techniqueId:"T1499",value:"applicationOrSystemExploitation"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.archiveViaCustomMethodT1560Description",{defaultMessage:"Archive via Custom Method (T1560.003)"}),id:"T1560.003",name:"Archive via Custom Method",reference:"https://attack.mitre.org/techniques/T1560/003",tactics:"collection",techniqueId:"T1560",value:"archiveViaCustomMethod"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.archiveViaLibraryT1560Description",{defaultMessage:"Archive via Library (T1560.002)"}),id:"T1560.002",name:"Archive via Library",reference:"https://attack.mitre.org/techniques/T1560/002",tactics:"collection",techniqueId:"T1560",value:"archiveViaLibrary"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.archiveViaUtilityT1560Description",{defaultMessage:"Archive via Utility (T1560.001)"}),id:"T1560.001",name:"Archive via Utility",reference:"https://attack.mitre.org/techniques/T1560/001",tactics:"collection",techniqueId:"T1560",value:"archiveViaUtility"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.asymmetricCryptographyT1573Description",{defaultMessage:"Asymmetric Cryptography (T1573.002)"}),id:"T1573.002",name:"Asymmetric Cryptography",reference:"https://attack.mitre.org/techniques/T1573/002",tactics:"command-and-control",techniqueId:"T1573",value:"asymmetricCryptography"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.asynchronousProcedureCallT1055Description",{defaultMessage:"Asynchronous Procedure Call (T1055.004)"}),id:"T1055.004",name:"Asynchronous Procedure Call",reference:"https://attack.mitre.org/techniques/T1055/004",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1055",value:"asynchronousProcedureCall"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.atLinuxT1053Description",{defaultMessage:"At (Linux) (T1053.001)"}),id:"T1053.001",name:"At (Linux)",reference:"https://attack.mitre.org/techniques/T1053/001",tactics:"execution,persistence,privilege-escalation",techniqueId:"T1053",value:"atLinux"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.atWindowsT1053Description",{defaultMessage:"At (Windows) (T1053.002)"}),id:"T1053.002",name:"At (Windows)",reference:"https://attack.mitre.org/techniques/T1053/002",tactics:"execution,persistence,privilege-escalation",techniqueId:"T1053",value:"atWindows"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.authenticationPackageT1547Description",{defaultMessage:"Authentication Package (T1547.002)"}),id:"T1547.002",name:"Authentication Package",reference:"https://attack.mitre.org/techniques/T1547/002",tactics:"persistence,privilege-escalation",techniqueId:"T1547",value:"authenticationPackage"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.bashHistoryT1552Description",{defaultMessage:"Bash History (T1552.003)"}),id:"T1552.003",name:"Bash History",reference:"https://attack.mitre.org/techniques/T1552/003",tactics:"credential-access",techniqueId:"T1552",value:"bashHistory"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.bidirectionalCommunicationT1102Description",{defaultMessage:"Bidirectional Communication (T1102.002)"}),id:"T1102.002",name:"Bidirectional Communication",reference:"https://attack.mitre.org/techniques/T1102/002",tactics:"command-and-control",techniqueId:"T1102",value:"bidirectionalCommunication"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.binaryPaddingT1027Description",{defaultMessage:"Binary Padding (T1027.001)"}),id:"T1027.001",name:"Binary Padding",reference:"https://attack.mitre.org/techniques/T1027/001",tactics:"defense-evasion",techniqueId:"T1027",value:"binaryPadding"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.bootkitT1542Description",{defaultMessage:"Bootkit (T1542.003)"}),id:"T1542.003",name:"Bootkit",reference:"https://attack.mitre.org/techniques/T1542/003",tactics:"persistence,defense-evasion",techniqueId:"T1542",value:"bootkit"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.botnetT1583Description",{defaultMessage:"Botnet (T1583.005)"}),id:"T1583.005",name:"Botnet",reference:"https://attack.mitre.org/techniques/T1583/005",tactics:"resource-development",techniqueId:"T1583",value:"botnet"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.botnetT1584Description",{defaultMessage:"Botnet (T1584.005)"}),id:"T1584.005",name:"Botnet",reference:"https://attack.mitre.org/techniques/T1584/005",tactics:"resource-development",techniqueId:"T1584",value:"botnet"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.businessRelationshipsT1591Description",{defaultMessage:"Business Relationships (T1591.002)"}),id:"T1591.002",name:"Business Relationships",reference:"https://attack.mitre.org/techniques/T1591/002",tactics:"reconnaissance",techniqueId:"T1591",value:"businessRelationships"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.bypassUserAccountControlT1548Description",{defaultMessage:"Bypass User Account Control (T1548.002)"}),id:"T1548.002",name:"Bypass User Account Control",reference:"https://attack.mitre.org/techniques/T1548/002",tactics:"privilege-escalation,defense-evasion",techniqueId:"T1548",value:"bypassUserAccountControl"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.cdNsT1596Description",{defaultMessage:"CDNs (T1596.004)"}),id:"T1596.004",name:"CDNs",reference:"https://attack.mitre.org/techniques/T1596/004",tactics:"reconnaissance",techniqueId:"T1596",value:"cdNs"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.cmstpT1218Description",{defaultMessage:"CMSTP (T1218.003)"}),id:"T1218.003",name:"CMSTP",reference:"https://attack.mitre.org/techniques/T1218/003",tactics:"defense-evasion",techniqueId:"T1218",value:"cmstp"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.corProfilerT1574Description",{defaultMessage:"COR_PROFILER (T1574.012)"}),id:"T1574.012",name:"COR_PROFILER",reference:"https://attack.mitre.org/techniques/T1574/012",tactics:"persistence,privilege-escalation,defense-evasion",techniqueId:"T1574",value:"corProfiler"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.cachedDomainCredentialsT1003Description",{defaultMessage:"Cached Domain Credentials (T1003.005)"}),id:"T1003.005",name:"Cached Domain Credentials",reference:"https://attack.mitre.org/techniques/T1003/005",tactics:"credential-access",techniqueId:"T1003",value:"cachedDomainCredentials"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.changeDefaultFileAssociationT1546Description",{defaultMessage:"Change Default File Association (T1546.001)"}),id:"T1546.001",name:"Change Default File Association",reference:"https://attack.mitre.org/techniques/T1546/001",tactics:"privilege-escalation,persistence",techniqueId:"T1546",value:"changeDefaultFileAssociation"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.clearCommandHistoryT1070Description",{defaultMessage:"Clear Command History (T1070.003)"}),id:"T1070.003",name:"Clear Command History",reference:"https://attack.mitre.org/techniques/T1070/003",tactics:"defense-evasion",techniqueId:"T1070",value:"clearCommandHistory"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.clearLinuxOrMacSystemLogsT1070Description",{defaultMessage:"Clear Linux or Mac System Logs (T1070.002)"}),id:"T1070.002",name:"Clear Linux or Mac System Logs",reference:"https://attack.mitre.org/techniques/T1070/002",tactics:"defense-evasion",techniqueId:"T1070",value:"clearLinuxOrMacSystemLogs"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.clearWindowsEventLogsT1070Description",{defaultMessage:"Clear Windows Event Logs (T1070.001)"}),id:"T1070.001",name:"Clear Windows Event Logs",reference:"https://attack.mitre.org/techniques/T1070/001",tactics:"defense-evasion",techniqueId:"T1070",value:"clearWindowsEventLogs"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.clientConfigurationsT1592Description",{defaultMessage:"Client Configurations (T1592.004)"}),id:"T1592.004",name:"Client Configurations",reference:"https://attack.mitre.org/techniques/T1592/004",tactics:"reconnaissance",techniqueId:"T1592",value:"clientConfigurations"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.cloudAccountT1136Description",{defaultMessage:"Cloud Account (T1136.003)"}),id:"T1136.003",name:"Cloud Account",reference:"https://attack.mitre.org/techniques/T1136/003",tactics:"persistence",techniqueId:"T1136",value:"cloudAccount"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.cloudAccountT1087Description",{defaultMessage:"Cloud Account (T1087.004)"}),id:"T1087.004",name:"Cloud Account",reference:"https://attack.mitre.org/techniques/T1087/004",tactics:"discovery",techniqueId:"T1087",value:"cloudAccount"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.cloudAccountsT1078Description",{defaultMessage:"Cloud Accounts (T1078.004)"}),id:"T1078.004",name:"Cloud Accounts",reference:"https://attack.mitre.org/techniques/T1078/004",tactics:"defense-evasion,persistence,privilege-escalation,initial-access",techniqueId:"T1078",value:"cloudAccounts"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.cloudGroupsT1069Description",{defaultMessage:"Cloud Groups (T1069.003)"}),id:"T1069.003",name:"Cloud Groups",reference:"https://attack.mitre.org/techniques/T1069/003",tactics:"discovery",techniqueId:"T1069",value:"cloudGroups"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.cloudInstanceMetadataApiT1552Description",{defaultMessage:"Cloud Instance Metadata API (T1552.005)"}),id:"T1552.005",name:"Cloud Instance Metadata API",reference:"https://attack.mitre.org/techniques/T1552/005",tactics:"credential-access",techniqueId:"T1552",value:"cloudInstanceMetadataApi"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.codeSigningT1553Description",{defaultMessage:"Code Signing (T1553.002)"}),id:"T1553.002",name:"Code Signing",reference:"https://attack.mitre.org/techniques/T1553/002",tactics:"defense-evasion",techniqueId:"T1553",value:"codeSigning"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.codeSigningCertificatesT1587Description",{defaultMessage:"Code Signing Certificates (T1587.002)"}),id:"T1587.002",name:"Code Signing Certificates",reference:"https://attack.mitre.org/techniques/T1587/002",tactics:"resource-development",techniqueId:"T1587",value:"codeSigningCertificates"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.codeSigningCertificatesT1588Description",{defaultMessage:"Code Signing Certificates (T1588.003)"}),id:"T1588.003",name:"Code Signing Certificates",reference:"https://attack.mitre.org/techniques/T1588/003",tactics:"resource-development",techniqueId:"T1588",value:"codeSigningCertificates"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.codeSigningPolicyModificationT1553Description",{defaultMessage:"Code Signing Policy Modification (T1553.006)"}),id:"T1553.006",name:"Code Signing Policy Modification",reference:"https://attack.mitre.org/techniques/T1553/006",tactics:"defense-evasion",techniqueId:"T1553",value:"codeSigningPolicyModification"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.compileAfterDeliveryT1027Description",{defaultMessage:"Compile After Delivery (T1027.004)"}),id:"T1027.004",name:"Compile After Delivery",reference:"https://attack.mitre.org/techniques/T1027/004",tactics:"defense-evasion",techniqueId:"T1027",value:"compileAfterDelivery"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.compiledHtmlFileT1218Description",{defaultMessage:"Compiled HTML File (T1218.001)"}),id:"T1218.001",name:"Compiled HTML File",reference:"https://attack.mitre.org/techniques/T1218/001",tactics:"defense-evasion",techniqueId:"T1218",value:"compiledHtmlFile"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.componentFirmwareT1542Description",{defaultMessage:"Component Firmware (T1542.002)"}),id:"T1542.002",name:"Component Firmware",reference:"https://attack.mitre.org/techniques/T1542/002",tactics:"persistence,defense-evasion",techniqueId:"T1542",value:"componentFirmware"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.componentObjectModelT1559Description",{defaultMessage:"Component Object Model (T1559.001)"}),id:"T1559.001",name:"Component Object Model",reference:"https://attack.mitre.org/techniques/T1559/001",tactics:"execution",techniqueId:"T1559",value:"componentObjectModel"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.componentObjectModelHijackingT1546Description",{defaultMessage:"Component Object Model Hijacking (T1546.015)"}),id:"T1546.015",name:"Component Object Model Hijacking",reference:"https://attack.mitre.org/techniques/T1546/015",tactics:"privilege-escalation,persistence",techniqueId:"T1546",value:"componentObjectModelHijacking"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.compromiseHardwareSupplyChainT1195Description",{defaultMessage:"Compromise Hardware Supply Chain (T1195.003)"}),id:"T1195.003",name:"Compromise Hardware Supply Chain",reference:"https://attack.mitre.org/techniques/T1195/003",tactics:"initial-access",techniqueId:"T1195",value:"compromiseHardwareSupplyChain"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.compromiseSoftwareDependenciesAndDevelopmentToolsT1195Description",{defaultMessage:"Compromise Software Dependencies and Development Tools (T1195.001)"}),id:"T1195.001",name:"Compromise Software Dependencies and Development Tools",reference:"https://attack.mitre.org/techniques/T1195/001",tactics:"initial-access",techniqueId:"T1195",value:"compromiseSoftwareDependenciesAndDevelopmentTools"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.compromiseSoftwareSupplyChainT1195Description",{defaultMessage:"Compromise Software Supply Chain (T1195.002)"}),id:"T1195.002",name:"Compromise Software Supply Chain",reference:"https://attack.mitre.org/techniques/T1195/002",tactics:"initial-access",techniqueId:"T1195",value:"compromiseSoftwareSupplyChain"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.confluenceT1213Description",{defaultMessage:"Confluence (T1213.001)"}),id:"T1213.001",name:"Confluence",reference:"https://attack.mitre.org/techniques/T1213/001",tactics:"collection",techniqueId:"T1213",value:"confluence"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.containerApiT1552Description",{defaultMessage:"Container API (T1552.007)"}),id:"T1552.007",name:"Container API",reference:"https://attack.mitre.org/techniques/T1552/007",tactics:"credential-access",techniqueId:"T1552",value:"containerApi"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.containerOrchestrationJobT1053Description",{defaultMessage:"Container Orchestration Job (T1053.007)"}),id:"T1053.007",name:"Container Orchestration Job",reference:"https://attack.mitre.org/techniques/T1053/007",tactics:"execution,persistence,privilege-escalation",techniqueId:"T1053",value:"containerOrchestrationJob"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.controlPanelT1218Description",{defaultMessage:"Control Panel (T1218.002)"}),id:"T1218.002",name:"Control Panel",reference:"https://attack.mitre.org/techniques/T1218/002",tactics:"defense-evasion",techniqueId:"T1218",value:"controlPanel"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.createCloudInstanceT1578Description",{defaultMessage:"Create Cloud Instance (T1578.002)"}),id:"T1578.002",name:"Create Cloud Instance",reference:"https://attack.mitre.org/techniques/T1578/002",tactics:"defense-evasion",techniqueId:"T1578",value:"createCloudInstance"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.createProcessWithTokenT1134Description",{defaultMessage:"Create Process with Token (T1134.002)"}),id:"T1134.002",name:"Create Process with Token",reference:"https://attack.mitre.org/techniques/T1134/002",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1134",value:"createProcessWithToken"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.createSnapshotT1578Description",{defaultMessage:"Create Snapshot (T1578.001)"}),id:"T1578.001",name:"Create Snapshot",reference:"https://attack.mitre.org/techniques/T1578/001",tactics:"defense-evasion",techniqueId:"T1578",value:"createSnapshot"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.credentialApiHookingT1056Description",{defaultMessage:"Credential API Hooking (T1056.004)"}),id:"T1056.004",name:"Credential API Hooking",reference:"https://attack.mitre.org/techniques/T1056/004",tactics:"collection,credential-access",techniqueId:"T1056",value:"credentialApiHooking"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.credentialStuffingT1110Description",{defaultMessage:"Credential Stuffing (T1110.004)"}),id:"T1110.004",name:"Credential Stuffing",reference:"https://attack.mitre.org/techniques/T1110/004",tactics:"credential-access",techniqueId:"T1110",value:"credentialStuffing"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.credentialsT1589Description",{defaultMessage:"Credentials (T1589.001)"}),id:"T1589.001",name:"Credentials",reference:"https://attack.mitre.org/techniques/T1589/001",tactics:"reconnaissance",techniqueId:"T1589",value:"credentials"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.credentialsInFilesT1552Description",{defaultMessage:"Credentials In Files (T1552.001)"}),id:"T1552.001",name:"Credentials In Files",reference:"https://attack.mitre.org/techniques/T1552/001",tactics:"credential-access",techniqueId:"T1552",value:"credentialsInFiles"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.credentialsFromWebBrowsersT1555Description",{defaultMessage:"Credentials from Web Browsers (T1555.003)"}),id:"T1555.003",name:"Credentials from Web Browsers",reference:"https://attack.mitre.org/techniques/T1555/003",tactics:"credential-access",techniqueId:"T1555",value:"credentialsFromWebBrowsers"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.credentialsInRegistryT1552Description",{defaultMessage:"Credentials in Registry (T1552.002)"}),id:"T1552.002",name:"Credentials in Registry",reference:"https://attack.mitre.org/techniques/T1552/002",tactics:"credential-access",techniqueId:"T1552",value:"credentialsInRegistry"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.cronT1053Description",{defaultMessage:"Cron (T1053.003)"}),id:"T1053.003",name:"Cron",reference:"https://attack.mitre.org/techniques/T1053/003",tactics:"execution,persistence,privilege-escalation",techniqueId:"T1053",value:"cron"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.dcSyncT1003Description",{defaultMessage:"DCSync (T1003.006)"}),id:"T1003.006",name:"DCSync",reference:"https://attack.mitre.org/techniques/T1003/006",tactics:"credential-access",techniqueId:"T1003",value:"dcSync"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.dllSearchOrderHijackingT1574Description",{defaultMessage:"DLL Search Order Hijacking (T1574.001)"}),id:"T1574.001",name:"DLL Search Order Hijacking",reference:"https://attack.mitre.org/techniques/T1574/001",tactics:"persistence,privilege-escalation,defense-evasion",techniqueId:"T1574",value:"dllSearchOrderHijacking"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.dllSideLoadingT1574Description",{defaultMessage:"DLL Side-Loading (T1574.002)"}),id:"T1574.002",name:"DLL Side-Loading",reference:"https://attack.mitre.org/techniques/T1574/002",tactics:"persistence,privilege-escalation,defense-evasion",techniqueId:"T1574",value:"dllSideLoading"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.dnsT1071Description",{defaultMessage:"DNS (T1071.004)"}),id:"T1071.004",name:"DNS",reference:"https://attack.mitre.org/techniques/T1071/004",tactics:"command-and-control",techniqueId:"T1071",value:"dns"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.dnsT1590Description",{defaultMessage:"DNS (T1590.002)"}),id:"T1590.002",name:"DNS",reference:"https://attack.mitre.org/techniques/T1590/002",tactics:"reconnaissance",techniqueId:"T1590",value:"dns"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.dnsCalculationT1568Description",{defaultMessage:"DNS Calculation (T1568.003)"}),id:"T1568.003",name:"DNS Calculation",reference:"https://attack.mitre.org/techniques/T1568/003",tactics:"command-and-control",techniqueId:"T1568",value:"dnsCalculation"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.dnsServerT1583Description",{defaultMessage:"DNS Server (T1583.002)"}),id:"T1583.002",name:"DNS Server",reference:"https://attack.mitre.org/techniques/T1583/002",tactics:"resource-development",techniqueId:"T1583",value:"dnsServer"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.dnsServerT1584Description",{defaultMessage:"DNS Server (T1584.002)"}),id:"T1584.002",name:"DNS Server",reference:"https://attack.mitre.org/techniques/T1584/002",tactics:"resource-development",techniqueId:"T1584",value:"dnsServer"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.dnsPassiveDnsT1596Description",{defaultMessage:"DNS/Passive DNS (T1596.001)"}),id:"T1596.001",name:"DNS/Passive DNS",reference:"https://attack.mitre.org/techniques/T1596/001",tactics:"reconnaissance",techniqueId:"T1596",value:"dnsPassiveDns"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.deadDropResolverT1102Description",{defaultMessage:"Dead Drop Resolver (T1102.001)"}),id:"T1102.001",name:"Dead Drop Resolver",reference:"https://attack.mitre.org/techniques/T1102/001",tactics:"command-and-control",techniqueId:"T1102",value:"deadDropResolver"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.defaultAccountsT1078Description",{defaultMessage:"Default Accounts (T1078.001)"}),id:"T1078.001",name:"Default Accounts",reference:"https://attack.mitre.org/techniques/T1078/001",tactics:"defense-evasion,persistence,privilege-escalation,initial-access",techniqueId:"T1078",value:"defaultAccounts"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.deleteCloudInstanceT1578Description",{defaultMessage:"Delete Cloud Instance (T1578.003)"}),id:"T1578.003",name:"Delete Cloud Instance",reference:"https://attack.mitre.org/techniques/T1578/003",tactics:"defense-evasion",techniqueId:"T1578",value:"deleteCloudInstance"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.determinePhysicalLocationsT1591Description",{defaultMessage:"Determine Physical Locations (T1591.001)"}),id:"T1591.001",name:"Determine Physical Locations",reference:"https://attack.mitre.org/techniques/T1591/001",tactics:"reconnaissance",techniqueId:"T1591",value:"determinePhysicalLocations"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.digitalCertificatesT1587Description",{defaultMessage:"Digital Certificates (T1587.003)"}),id:"T1587.003",name:"Digital Certificates",reference:"https://attack.mitre.org/techniques/T1587/003",tactics:"resource-development",techniqueId:"T1587",value:"digitalCertificates"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.digitalCertificatesT1588Description",{defaultMessage:"Digital Certificates (T1588.004)"}),id:"T1588.004",name:"Digital Certificates",reference:"https://attack.mitre.org/techniques/T1588/004",tactics:"resource-development",techniqueId:"T1588",value:"digitalCertificates"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.digitalCertificatesT1596Description",{defaultMessage:"Digital Certificates (T1596.003)"}),id:"T1596.003",name:"Digital Certificates",reference:"https://attack.mitre.org/techniques/T1596/003",tactics:"reconnaissance",techniqueId:"T1596",value:"digitalCertificates"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.directNetworkFloodT1498Description",{defaultMessage:"Direct Network Flood (T1498.001)"}),id:"T1498.001",name:"Direct Network Flood",reference:"https://attack.mitre.org/techniques/T1498/001",tactics:"impact",techniqueId:"T1498",value:"directNetworkFlood"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.disableCloudLogsT1562Description",{defaultMessage:"Disable Cloud Logs (T1562.008)"}),id:"T1562.008",name:"Disable Cloud Logs",reference:"https://attack.mitre.org/techniques/T1562/008",tactics:"defense-evasion",techniqueId:"T1562",value:"disableCloudLogs"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.disableCryptoHardwareT1600Description",{defaultMessage:"Disable Crypto Hardware (T1600.002)"}),id:"T1600.002",name:"Disable Crypto Hardware",reference:"https://attack.mitre.org/techniques/T1600/002",tactics:"defense-evasion",techniqueId:"T1600",value:"disableCryptoHardware"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.disableWindowsEventLoggingT1562Description",{defaultMessage:"Disable Windows Event Logging (T1562.002)"}),id:"T1562.002",name:"Disable Windows Event Logging",reference:"https://attack.mitre.org/techniques/T1562/002",tactics:"defense-evasion",techniqueId:"T1562",value:"disableWindowsEventLogging"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.disableOrModifyCloudFirewallT1562Description",{defaultMessage:"Disable or Modify Cloud Firewall (T1562.007)"}),id:"T1562.007",name:"Disable or Modify Cloud Firewall",reference:"https://attack.mitre.org/techniques/T1562/007",tactics:"defense-evasion",techniqueId:"T1562",value:"disableOrModifyCloudFirewall"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.disableOrModifySystemFirewallT1562Description",{defaultMessage:"Disable or Modify System Firewall (T1562.004)"}),id:"T1562.004",name:"Disable or Modify System Firewall",reference:"https://attack.mitre.org/techniques/T1562/004",tactics:"defense-evasion",techniqueId:"T1562",value:"disableOrModifySystemFirewall"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.disableOrModifyToolsT1562Description",{defaultMessage:"Disable or Modify Tools (T1562.001)"}),id:"T1562.001",name:"Disable or Modify Tools",reference:"https://attack.mitre.org/techniques/T1562/001",tactics:"defense-evasion",techniqueId:"T1562",value:"disableOrModifyTools"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.diskContentWipeT1561Description",{defaultMessage:"Disk Content Wipe (T1561.001)"}),id:"T1561.001",name:"Disk Content Wipe",reference:"https://attack.mitre.org/techniques/T1561/001",tactics:"impact",techniqueId:"T1561",value:"diskContentWipe"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.diskStructureWipeT1561Description",{defaultMessage:"Disk Structure Wipe (T1561.002)"}),id:"T1561.002",name:"Disk Structure Wipe",reference:"https://attack.mitre.org/techniques/T1561/002",tactics:"impact",techniqueId:"T1561",value:"diskStructureWipe"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.distributedComponentObjectModelT1021Description",{defaultMessage:"Distributed Component Object Model (T1021.003)"}),id:"T1021.003",name:"Distributed Component Object Model",reference:"https://attack.mitre.org/techniques/T1021/003",tactics:"lateral-movement",techniqueId:"T1021",value:"distributedComponentObjectModel"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.domainAccountT1136Description",{defaultMessage:"Domain Account (T1136.002)"}),id:"T1136.002",name:"Domain Account",reference:"https://attack.mitre.org/techniques/T1136/002",tactics:"persistence",techniqueId:"T1136",value:"domainAccount"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.domainAccountT1087Description",{defaultMessage:"Domain Account (T1087.002)"}),id:"T1087.002",name:"Domain Account",reference:"https://attack.mitre.org/techniques/T1087/002",tactics:"discovery",techniqueId:"T1087",value:"domainAccount"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.domainAccountsT1078Description",{defaultMessage:"Domain Accounts (T1078.002)"}),id:"T1078.002",name:"Domain Accounts",reference:"https://attack.mitre.org/techniques/T1078/002",tactics:"defense-evasion,persistence,privilege-escalation,initial-access",techniqueId:"T1078",value:"domainAccounts"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.domainControllerAuthenticationT1556Description",{defaultMessage:"Domain Controller Authentication (T1556.001)"}),id:"T1556.001",name:"Domain Controller Authentication",reference:"https://attack.mitre.org/techniques/T1556/001",tactics:"credential-access,defense-evasion,persistence",techniqueId:"T1556",value:"domainControllerAuthentication"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.domainFrontingT1090Description",{defaultMessage:"Domain Fronting (T1090.004)"}),id:"T1090.004",name:"Domain Fronting",reference:"https://attack.mitre.org/techniques/T1090/004",tactics:"command-and-control",techniqueId:"T1090",value:"domainFronting"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.domainGenerationAlgorithmsT1568Description",{defaultMessage:"Domain Generation Algorithms (T1568.002)"}),id:"T1568.002",name:"Domain Generation Algorithms",reference:"https://attack.mitre.org/techniques/T1568/002",tactics:"command-and-control",techniqueId:"T1568",value:"domainGenerationAlgorithms"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.domainGroupsT1069Description",{defaultMessage:"Domain Groups (T1069.002)"}),id:"T1069.002",name:"Domain Groups",reference:"https://attack.mitre.org/techniques/T1069/002",tactics:"discovery",techniqueId:"T1069",value:"domainGroups"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.domainPropertiesT1590Description",{defaultMessage:"Domain Properties (T1590.001)"}),id:"T1590.001",name:"Domain Properties",reference:"https://attack.mitre.org/techniques/T1590/001",tactics:"reconnaissance",techniqueId:"T1590",value:"domainProperties"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.domainTrustModificationT1484Description",{defaultMessage:"Domain Trust Modification (T1484.002)"}),id:"T1484.002",name:"Domain Trust Modification",reference:"https://attack.mitre.org/techniques/T1484/002",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1484",value:"domainTrustModification"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.domainsT1583Description",{defaultMessage:"Domains (T1583.001)"}),id:"T1583.001",name:"Domains",reference:"https://attack.mitre.org/techniques/T1583/001",tactics:"resource-development",techniqueId:"T1583",value:"domains"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.domainsT1584Description",{defaultMessage:"Domains (T1584.001)"}),id:"T1584.001",name:"Domains",reference:"https://attack.mitre.org/techniques/T1584/001",tactics:"resource-development",techniqueId:"T1584",value:"domains"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.downgradeSystemImageT1601Description",{defaultMessage:"Downgrade System Image (T1601.002)"}),id:"T1601.002",name:"Downgrade System Image",reference:"https://attack.mitre.org/techniques/T1601/002",tactics:"defense-evasion",techniqueId:"T1601",value:"downgradeSystemImage"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.driveByTargetT1608Description",{defaultMessage:"Drive-by Target (T1608.004)"}),id:"T1608.004",name:"Drive-by Target",reference:"https://attack.mitre.org/techniques/T1608/004",tactics:"resource-development",techniqueId:"T1608",value:"driveByTarget"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.dylibHijackingT1574Description",{defaultMessage:"Dylib Hijacking (T1574.004)"}),id:"T1574.004",name:"Dylib Hijacking",reference:"https://attack.mitre.org/techniques/T1574/004",tactics:"persistence,privilege-escalation,defense-evasion",techniqueId:"T1574",value:"dylibHijacking"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.dynamicDataExchangeT1559Description",{defaultMessage:"Dynamic Data Exchange (T1559.002)"}),id:"T1559.002",name:"Dynamic Data Exchange",reference:"https://attack.mitre.org/techniques/T1559/002",tactics:"execution",techniqueId:"T1559",value:"dynamicDataExchange"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.dynamicLinkerHijackingT1574Description",{defaultMessage:"Dynamic Linker Hijacking (T1574.006)"}),id:"T1574.006",name:"Dynamic Linker Hijacking",reference:"https://attack.mitre.org/techniques/T1574/006",tactics:"persistence,privilege-escalation,defense-evasion",techniqueId:"T1574",value:"dynamicLinkerHijacking"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.dynamicLinkLibraryInjectionT1055Description",{defaultMessage:"Dynamic-link Library Injection (T1055.001)"}),id:"T1055.001",name:"Dynamic-link Library Injection",reference:"https://attack.mitre.org/techniques/T1055/001",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1055",value:"dynamicLinkLibraryInjection"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.elevatedExecutionWithPromptT1548Description",{defaultMessage:"Elevated Execution with Prompt (T1548.004)"}),id:"T1548.004",name:"Elevated Execution with Prompt",reference:"https://attack.mitre.org/techniques/T1548/004",tactics:"privilege-escalation,defense-evasion",techniqueId:"T1548",value:"elevatedExecutionWithPrompt"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.emailAccountT1087Description",{defaultMessage:"Email Account (T1087.003)"}),id:"T1087.003",name:"Email Account",reference:"https://attack.mitre.org/techniques/T1087/003",tactics:"discovery",techniqueId:"T1087",value:"emailAccount"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.emailAccountsT1585Description",{defaultMessage:"Email Accounts (T1585.002)"}),id:"T1585.002",name:"Email Accounts",reference:"https://attack.mitre.org/techniques/T1585/002",tactics:"resource-development",techniqueId:"T1585",value:"emailAccounts"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.emailAccountsT1586Description",{defaultMessage:"Email Accounts (T1586.002)"}),id:"T1586.002",name:"Email Accounts",reference:"https://attack.mitre.org/techniques/T1586/002",tactics:"resource-development",techniqueId:"T1586",value:"emailAccounts"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.emailAddressesT1589Description",{defaultMessage:"Email Addresses (T1589.002)"}),id:"T1589.002",name:"Email Addresses",reference:"https://attack.mitre.org/techniques/T1589/002",tactics:"reconnaissance",techniqueId:"T1589",value:"emailAddresses"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.emailForwardingRuleT1114Description",{defaultMessage:"Email Forwarding Rule (T1114.003)"}),id:"T1114.003",name:"Email Forwarding Rule",reference:"https://attack.mitre.org/techniques/T1114/003",tactics:"collection",techniqueId:"T1114",value:"emailForwardingRule"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.emondT1546Description",{defaultMessage:"Emond (T1546.014)"}),id:"T1546.014",name:"Emond",reference:"https://attack.mitre.org/techniques/T1546/014",tactics:"privilege-escalation,persistence",techniqueId:"T1546",value:"emond"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.employeeNamesT1589Description",{defaultMessage:"Employee Names (T1589.003)"}),id:"T1589.003",name:"Employee Names",reference:"https://attack.mitre.org/techniques/T1589/003",tactics:"reconnaissance",techniqueId:"T1589",value:"employeeNames"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.environmentalKeyingT1480Description",{defaultMessage:"Environmental Keying (T1480.001)"}),id:"T1480.001",name:"Environmental Keying",reference:"https://attack.mitre.org/techniques/T1480/001",tactics:"defense-evasion",techniqueId:"T1480",value:"environmentalKeying"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.exchangeEmailDelegatePermissionsT1098Description",{defaultMessage:"Exchange Email Delegate Permissions (T1098.002)"}),id:"T1098.002",name:"Exchange Email Delegate Permissions",reference:"https://attack.mitre.org/techniques/T1098/002",tactics:"persistence",techniqueId:"T1098",value:"exchangeEmailDelegatePermissions"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.executableInstallerFilePermissionsWeaknessT1574Description",{defaultMessage:"Executable Installer File Permissions Weakness (T1574.005)"}),id:"T1574.005",name:"Executable Installer File Permissions Weakness",reference:"https://attack.mitre.org/techniques/T1574/005",tactics:"persistence,privilege-escalation,defense-evasion",techniqueId:"T1574",value:"executableInstallerFilePermissionsWeakness"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.exfiltrationOverAsymmetricEncryptedNonC2ProtocolT1048Description",{defaultMessage:"Exfiltration Over Asymmetric Encrypted Non-C2 Protocol (T1048.002)"}),id:"T1048.002",name:"Exfiltration Over Asymmetric Encrypted Non-C2 Protocol",reference:"https://attack.mitre.org/techniques/T1048/002",tactics:"exfiltration",techniqueId:"T1048",value:"exfiltrationOverAsymmetricEncryptedNonC2Protocol"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.exfiltrationOverBluetoothT1011Description",{defaultMessage:"Exfiltration Over Bluetooth (T1011.001)"}),id:"T1011.001",name:"Exfiltration Over Bluetooth",reference:"https://attack.mitre.org/techniques/T1011/001",tactics:"exfiltration",techniqueId:"T1011",value:"exfiltrationOverBluetooth"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.exfiltrationOverSymmetricEncryptedNonC2ProtocolT1048Description",{defaultMessage:"Exfiltration Over Symmetric Encrypted Non-C2 Protocol (T1048.001)"}),id:"T1048.001",name:"Exfiltration Over Symmetric Encrypted Non-C2 Protocol",reference:"https://attack.mitre.org/techniques/T1048/001",tactics:"exfiltration",techniqueId:"T1048",value:"exfiltrationOverSymmetricEncryptedNonC2Protocol"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.exfiltrationOverUnencryptedObfuscatedNonC2ProtocolT1048Description",{defaultMessage:"Exfiltration Over Unencrypted/Obfuscated Non-C2 Protocol (T1048.003)"}),id:"T1048.003",name:"Exfiltration Over Unencrypted/Obfuscated Non-C2 Protocol",reference:"https://attack.mitre.org/techniques/T1048/003",tactics:"exfiltration",techniqueId:"T1048",value:"exfiltrationOverUnencryptedObfuscatedNonC2Protocol"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.exfiltrationOverUsbT1052Description",{defaultMessage:"Exfiltration over USB (T1052.001)"}),id:"T1052.001",name:"Exfiltration over USB",reference:"https://attack.mitre.org/techniques/T1052/001",tactics:"exfiltration",techniqueId:"T1052",value:"exfiltrationOverUsb"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.exfiltrationToCloudStorageT1567Description",{defaultMessage:"Exfiltration to Cloud Storage (T1567.002)"}),id:"T1567.002",name:"Exfiltration to Cloud Storage",reference:"https://attack.mitre.org/techniques/T1567/002",tactics:"exfiltration",techniqueId:"T1567",value:"exfiltrationToCloudStorage"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.exfiltrationToCodeRepositoryT1567Description",{defaultMessage:"Exfiltration to Code Repository (T1567.001)"}),id:"T1567.001",name:"Exfiltration to Code Repository",reference:"https://attack.mitre.org/techniques/T1567/001",tactics:"exfiltration",techniqueId:"T1567",value:"exfiltrationToCodeRepository"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.exploitsT1587Description",{defaultMessage:"Exploits (T1587.004)"}),id:"T1587.004",name:"Exploits",reference:"https://attack.mitre.org/techniques/T1587/004",tactics:"resource-development",techniqueId:"T1587",value:"exploits"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.exploitsT1588Description",{defaultMessage:"Exploits (T1588.005)"}),id:"T1588.005",name:"Exploits",reference:"https://attack.mitre.org/techniques/T1588/005",tactics:"resource-development",techniqueId:"T1588",value:"exploits"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.externalDefacementT1491Description",{defaultMessage:"External Defacement (T1491.002)"}),id:"T1491.002",name:"External Defacement",reference:"https://attack.mitre.org/techniques/T1491/002",tactics:"impact",techniqueId:"T1491",value:"externalDefacement"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.externalProxyT1090Description",{defaultMessage:"External Proxy (T1090.002)"}),id:"T1090.002",name:"External Proxy",reference:"https://attack.mitre.org/techniques/T1090/002",tactics:"command-and-control",techniqueId:"T1090",value:"externalProxy"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.extraWindowMemoryInjectionT1055Description",{defaultMessage:"Extra Window Memory Injection (T1055.011)"}),id:"T1055.011",name:"Extra Window Memory Injection",reference:"https://attack.mitre.org/techniques/T1055/011",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1055",value:"extraWindowMemoryInjection"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.fastFluxDnsT1568Description",{defaultMessage:"Fast Flux DNS (T1568.001)"}),id:"T1568.001",name:"Fast Flux DNS",reference:"https://attack.mitre.org/techniques/T1568/001",tactics:"command-and-control",techniqueId:"T1568",value:"fastFluxDns"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.fileDeletionT1070Description",{defaultMessage:"File Deletion (T1070.004)"}),id:"T1070.004",name:"File Deletion",reference:"https://attack.mitre.org/techniques/T1070/004",tactics:"defense-evasion",techniqueId:"T1070",value:"fileDeletion"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.fileTransferProtocolsT1071Description",{defaultMessage:"File Transfer Protocols (T1071.002)"}),id:"T1071.002",name:"File Transfer Protocols",reference:"https://attack.mitre.org/techniques/T1071/002",tactics:"command-and-control",techniqueId:"T1071",value:"fileTransferProtocols"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.firmwareT1592Description",{defaultMessage:"Firmware (T1592.003)"}),id:"T1592.003",name:"Firmware",reference:"https://attack.mitre.org/techniques/T1592/003",tactics:"reconnaissance",techniqueId:"T1592",value:"firmware"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.guiInputCaptureT1056Description",{defaultMessage:"GUI Input Capture (T1056.002)"}),id:"T1056.002",name:"GUI Input Capture",reference:"https://attack.mitre.org/techniques/T1056/002",tactics:"collection,credential-access",techniqueId:"T1056",value:"guiInputCapture"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.gatekeeperBypassT1553Description",{defaultMessage:"Gatekeeper Bypass (T1553.001)"}),id:"T1553.001",name:"Gatekeeper Bypass",reference:"https://attack.mitre.org/techniques/T1553/001",tactics:"defense-evasion",techniqueId:"T1553",value:"gatekeeperBypass"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.goldenTicketT1558Description",{defaultMessage:"Golden Ticket (T1558.001)"}),id:"T1558.001",name:"Golden Ticket",reference:"https://attack.mitre.org/techniques/T1558/001",tactics:"credential-access",techniqueId:"T1558",value:"goldenTicket"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.groupPolicyModificationT1484Description",{defaultMessage:"Group Policy Modification (T1484.001)"}),id:"T1484.001",name:"Group Policy Modification",reference:"https://attack.mitre.org/techniques/T1484/001",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1484",value:"groupPolicyModification"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.groupPolicyPreferencesT1552Description",{defaultMessage:"Group Policy Preferences (T1552.006)"}),id:"T1552.006",name:"Group Policy Preferences",reference:"https://attack.mitre.org/techniques/T1552/006",tactics:"credential-access",techniqueId:"T1552",value:"groupPolicyPreferences"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.hardwareT1592Description",{defaultMessage:"Hardware (T1592.001)"}),id:"T1592.001",name:"Hardware",reference:"https://attack.mitre.org/techniques/T1592/001",tactics:"reconnaissance",techniqueId:"T1592",value:"hardware"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.hiddenFileSystemT1564Description",{defaultMessage:"Hidden File System (T1564.005)"}),id:"T1564.005",name:"Hidden File System",reference:"https://attack.mitre.org/techniques/T1564/005",tactics:"defense-evasion",techniqueId:"T1564",value:"hiddenFileSystem"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.hiddenFilesAndDirectoriesT1564Description",{defaultMessage:"Hidden Files and Directories (T1564.001)"}),id:"T1564.001",name:"Hidden Files and Directories",reference:"https://attack.mitre.org/techniques/T1564/001",tactics:"defense-evasion",techniqueId:"T1564",value:"hiddenFilesAndDirectories"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.hiddenUsersT1564Description",{defaultMessage:"Hidden Users (T1564.002)"}),id:"T1564.002",name:"Hidden Users",reference:"https://attack.mitre.org/techniques/T1564/002",tactics:"defense-evasion",techniqueId:"T1564",value:"hiddenUsers"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.hiddenWindowT1564Description",{defaultMessage:"Hidden Window (T1564.003)"}),id:"T1564.003",name:"Hidden Window",reference:"https://attack.mitre.org/techniques/T1564/003",tactics:"defense-evasion",techniqueId:"T1564",value:"hiddenWindow"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.ipAddressesT1590Description",{defaultMessage:"IP Addresses (T1590.005)"}),id:"T1590.005",name:"IP Addresses",reference:"https://attack.mitre.org/techniques/T1590/005",tactics:"reconnaissance",techniqueId:"T1590",value:"ipAddresses"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.identifyBusinessTempoT1591Description",{defaultMessage:"Identify Business Tempo (T1591.003)"}),id:"T1591.003",name:"Identify Business Tempo",reference:"https://attack.mitre.org/techniques/T1591/003",tactics:"reconnaissance",techniqueId:"T1591",value:"identifyBusinessTempo"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.identifyRolesT1591Description",{defaultMessage:"Identify Roles (T1591.004)"}),id:"T1591.004",name:"Identify Roles",reference:"https://attack.mitre.org/techniques/T1591/004",tactics:"reconnaissance",techniqueId:"T1591",value:"identifyRoles"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.imageFileExecutionOptionsInjectionT1546Description",{defaultMessage:"Image File Execution Options Injection (T1546.012)"}),id:"T1546.012",name:"Image File Execution Options Injection",reference:"https://attack.mitre.org/techniques/T1546/012",tactics:"privilege-escalation,persistence",techniqueId:"T1546",value:"imageFileExecutionOptionsInjection"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.impairCommandHistoryLoggingT1562Description",{defaultMessage:"Impair Command History Logging (T1562.003)"}),id:"T1562.003",name:"Impair Command History Logging",reference:"https://attack.mitre.org/techniques/T1562/003",tactics:"defense-evasion",techniqueId:"T1562",value:"impairCommandHistoryLogging"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.indicatorBlockingT1562Description",{defaultMessage:"Indicator Blocking (T1562.006)"}),id:"T1562.006",name:"Indicator Blocking",reference:"https://attack.mitre.org/techniques/T1562/006",tactics:"defense-evasion",techniqueId:"T1562",value:"indicatorBlocking"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.indicatorRemovalFromToolsT1027Description",{defaultMessage:"Indicator Removal from Tools (T1027.005)"}),id:"T1027.005",name:"Indicator Removal from Tools",reference:"https://attack.mitre.org/techniques/T1027/005",tactics:"defense-evasion",techniqueId:"T1027",value:"indicatorRemovalFromTools"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.installDigitalCertificateT1608Description",{defaultMessage:"Install Digital Certificate (T1608.003)"}),id:"T1608.003",name:"Install Digital Certificate",reference:"https://attack.mitre.org/techniques/T1608/003",tactics:"resource-development",techniqueId:"T1608",value:"installDigitalCertificate"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.installRootCertificateT1553Description",{defaultMessage:"Install Root Certificate (T1553.004)"}),id:"T1553.004",name:"Install Root Certificate",reference:"https://attack.mitre.org/techniques/T1553/004",tactics:"defense-evasion",techniqueId:"T1553",value:"installRootCertificate"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.installUtilT1218Description",{defaultMessage:"InstallUtil (T1218.004)"}),id:"T1218.004",name:"InstallUtil",reference:"https://attack.mitre.org/techniques/T1218/004",tactics:"defense-evasion",techniqueId:"T1218",value:"installUtil"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.internalDefacementT1491Description",{defaultMessage:"Internal Defacement (T1491.001)"}),id:"T1491.001",name:"Internal Defacement",reference:"https://attack.mitre.org/techniques/T1491/001",tactics:"impact",techniqueId:"T1491",value:"internalDefacement"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.internalProxyT1090Description",{defaultMessage:"Internal Proxy (T1090.001)"}),id:"T1090.001",name:"Internal Proxy",reference:"https://attack.mitre.org/techniques/T1090/001",tactics:"command-and-control",techniqueId:"T1090",value:"internalProxy"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.internetConnectionDiscoveryT1016Description",{defaultMessage:"Internet Connection Discovery (T1016.001)"}),id:"T1016.001",name:"Internet Connection Discovery",reference:"https://attack.mitre.org/techniques/T1016/001",tactics:"discovery",techniqueId:"T1016",value:"internetConnectionDiscovery"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.invalidCodeSignatureT1036Description",{defaultMessage:"Invalid Code Signature (T1036.001)"}),id:"T1036.001",name:"Invalid Code Signature",reference:"https://attack.mitre.org/techniques/T1036/001",tactics:"defense-evasion",techniqueId:"T1036",value:"invalidCodeSignature"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.javaScriptT1059Description",{defaultMessage:"JavaScript (T1059.007)"}),id:"T1059.007",name:"JavaScript",reference:"https://attack.mitre.org/techniques/T1059/007",tactics:"execution",techniqueId:"T1059",value:"javaScript"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.junkDataT1001Description",{defaultMessage:"Junk Data (T1001.001)"}),id:"T1001.001",name:"Junk Data",reference:"https://attack.mitre.org/techniques/T1001/001",tactics:"command-and-control",techniqueId:"T1001",value:"junkData"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.kerberoastingT1558Description",{defaultMessage:"Kerberoasting (T1558.003)"}),id:"T1558.003",name:"Kerberoasting",reference:"https://attack.mitre.org/techniques/T1558/003",tactics:"credential-access",techniqueId:"T1558",value:"kerberoasting"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.kernelModulesAndExtensionsT1547Description",{defaultMessage:"Kernel Modules and Extensions (T1547.006)"}),id:"T1547.006",name:"Kernel Modules and Extensions",reference:"https://attack.mitre.org/techniques/T1547/006",tactics:"persistence,privilege-escalation",techniqueId:"T1547",value:"kernelModulesAndExtensions"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.keychainT1555Description",{defaultMessage:"Keychain (T1555.001)"}),id:"T1555.001",name:"Keychain",reference:"https://attack.mitre.org/techniques/T1555/001",tactics:"credential-access",techniqueId:"T1555",value:"keychain"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.keyloggingT1056Description",{defaultMessage:"Keylogging (T1056.001)"}),id:"T1056.001",name:"Keylogging",reference:"https://attack.mitre.org/techniques/T1056/001",tactics:"collection,credential-access",techniqueId:"T1056",value:"keylogging"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.lcLoadDylibAdditionT1546Description",{defaultMessage:"LC_LOAD_DYLIB Addition (T1546.006)"}),id:"T1546.006",name:"LC_LOAD_DYLIB Addition",reference:"https://attack.mitre.org/techniques/T1546/006",tactics:"privilege-escalation,persistence",techniqueId:"T1546",value:"lcLoadDylibAddition"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.llmnrNbtNsPoisoningAndSmbRelayT1557Description",{defaultMessage:"LLMNR/NBT-NS Poisoning and SMB Relay (T1557.001)"}),id:"T1557.001",name:"LLMNR/NBT-NS Poisoning and SMB Relay",reference:"https://attack.mitre.org/techniques/T1557/001",tactics:"credential-access,collection",techniqueId:"T1557",value:"llmnrNbtNsPoisoningAndSmbRelay"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.lsaSecretsT1003Description",{defaultMessage:"LSA Secrets (T1003.004)"}),id:"T1003.004",name:"LSA Secrets",reference:"https://attack.mitre.org/techniques/T1003/004",tactics:"credential-access",techniqueId:"T1003",value:"lsaSecrets"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.lsassDriverT1547Description",{defaultMessage:"LSASS Driver (T1547.008)"}),id:"T1547.008",name:"LSASS Driver",reference:"https://attack.mitre.org/techniques/T1547/008",tactics:"persistence,privilege-escalation",techniqueId:"T1547",value:"lsassDriver"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.lsassMemoryT1003Description",{defaultMessage:"LSASS Memory (T1003.001)"}),id:"T1003.001",name:"LSASS Memory",reference:"https://attack.mitre.org/techniques/T1003/001",tactics:"credential-access",techniqueId:"T1003",value:"lsassMemory"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.launchAgentT1543Description",{defaultMessage:"Launch Agent (T1543.001)"}),id:"T1543.001",name:"Launch Agent",reference:"https://attack.mitre.org/techniques/T1543/001",tactics:"persistence,privilege-escalation",techniqueId:"T1543",value:"launchAgent"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.launchDaemonT1543Description",{defaultMessage:"Launch Daemon (T1543.004)"}),id:"T1543.004",name:"Launch Daemon",reference:"https://attack.mitre.org/techniques/T1543/004",tactics:"persistence,privilege-escalation",techniqueId:"T1543",value:"launchDaemon"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.launchctlT1569Description",{defaultMessage:"Launchctl (T1569.001)"}),id:"T1569.001",name:"Launchctl",reference:"https://attack.mitre.org/techniques/T1569/001",tactics:"execution",techniqueId:"T1569",value:"launchctl"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.launchdT1053Description",{defaultMessage:"Launchd (T1053.004)"}),id:"T1053.004",name:"Launchd",reference:"https://attack.mitre.org/techniques/T1053/004",tactics:"execution,persistence,privilege-escalation",techniqueId:"T1053",value:"launchd"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.linkTargetT1608Description",{defaultMessage:"Link Target (T1608.005)"}),id:"T1608.005",name:"Link Target",reference:"https://attack.mitre.org/techniques/T1608/005",tactics:"resource-development",techniqueId:"T1608",value:"linkTarget"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.linuxAndMacFileAndDirectoryPermissionsModificationT1222Description",{defaultMessage:"Linux and Mac File and Directory Permissions Modification (T1222.002)"}),id:"T1222.002",name:"Linux and Mac File and Directory Permissions Modification",reference:"https://attack.mitre.org/techniques/T1222/002",tactics:"defense-evasion",techniqueId:"T1222",value:"linuxAndMacFileAndDirectoryPermissionsModification"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.localAccountT1136Description",{defaultMessage:"Local Account (T1136.001)"}),id:"T1136.001",name:"Local Account",reference:"https://attack.mitre.org/techniques/T1136/001",tactics:"persistence",techniqueId:"T1136",value:"localAccount"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.localAccountT1087Description",{defaultMessage:"Local Account (T1087.001)"}),id:"T1087.001",name:"Local Account",reference:"https://attack.mitre.org/techniques/T1087/001",tactics:"discovery",techniqueId:"T1087",value:"localAccount"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.localAccountsT1078Description",{defaultMessage:"Local Accounts (T1078.003)"}),id:"T1078.003",name:"Local Accounts",reference:"https://attack.mitre.org/techniques/T1078/003",tactics:"defense-evasion,persistence,privilege-escalation,initial-access",techniqueId:"T1078",value:"localAccounts"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.localDataStagingT1074Description",{defaultMessage:"Local Data Staging (T1074.001)"}),id:"T1074.001",name:"Local Data Staging",reference:"https://attack.mitre.org/techniques/T1074/001",tactics:"collection",techniqueId:"T1074",value:"localDataStaging"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.localEmailCollectionT1114Description",{defaultMessage:"Local Email Collection (T1114.001)"}),id:"T1114.001",name:"Local Email Collection",reference:"https://attack.mitre.org/techniques/T1114/001",tactics:"collection",techniqueId:"T1114",value:"localEmailCollection"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.localGroupsT1069Description",{defaultMessage:"Local Groups (T1069.001)"}),id:"T1069.001",name:"Local Groups",reference:"https://attack.mitre.org/techniques/T1069/001",tactics:"discovery",techniqueId:"T1069",value:"localGroups"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.logonScriptMacT1037Description",{defaultMessage:"Logon Script (Mac) (T1037.002)"}),id:"T1037.002",name:"Logon Script (Mac)",reference:"https://attack.mitre.org/techniques/T1037/002",tactics:"persistence,privilege-escalation",techniqueId:"T1037",value:"logonScriptMac"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.logonScriptWindowsT1037Description",{defaultMessage:"Logon Script (Windows) (T1037.001)"}),id:"T1037.001",name:"Logon Script (Windows)",reference:"https://attack.mitre.org/techniques/T1037/001",tactics:"persistence,privilege-escalation",techniqueId:"T1037",value:"logonScriptWindows"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.msBuildT1127Description",{defaultMessage:"MSBuild (T1127.001)"}),id:"T1127.001",name:"MSBuild",reference:"https://attack.mitre.org/techniques/T1127/001",tactics:"defense-evasion",techniqueId:"T1127",value:"msBuild"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.mailProtocolsT1071Description",{defaultMessage:"Mail Protocols (T1071.003)"}),id:"T1071.003",name:"Mail Protocols",reference:"https://attack.mitre.org/techniques/T1071/003",tactics:"command-and-control",techniqueId:"T1071",value:"mailProtocols"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.makeAndImpersonateTokenT1134Description",{defaultMessage:"Make and Impersonate Token (T1134.003)"}),id:"T1134.003",name:"Make and Impersonate Token",reference:"https://attack.mitre.org/techniques/T1134/003",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1134",value:"makeAndImpersonateToken"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.maliciousFileT1204Description",{defaultMessage:"Malicious File (T1204.002)"}),id:"T1204.002",name:"Malicious File",reference:"https://attack.mitre.org/techniques/T1204/002",tactics:"execution",techniqueId:"T1204",value:"maliciousFile"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.maliciousImageT1204Description",{defaultMessage:"Malicious Image (T1204.003)"}),id:"T1204.003",name:"Malicious Image",reference:"https://attack.mitre.org/techniques/T1204/003",tactics:"execution",techniqueId:"T1204",value:"maliciousImage"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.maliciousLinkT1204Description",{defaultMessage:"Malicious Link (T1204.001)"}),id:"T1204.001",name:"Malicious Link",reference:"https://attack.mitre.org/techniques/T1204/001",tactics:"execution",techniqueId:"T1204",value:"maliciousLink"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.malwareT1587Description",{defaultMessage:"Malware (T1587.001)"}),id:"T1587.001",name:"Malware",reference:"https://attack.mitre.org/techniques/T1587/001",tactics:"resource-development",techniqueId:"T1587",value:"malware"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.malwareT1588Description",{defaultMessage:"Malware (T1588.001)"}),id:"T1588.001",name:"Malware",reference:"https://attack.mitre.org/techniques/T1588/001",tactics:"resource-development",techniqueId:"T1588",value:"malware"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.markOfTheWebBypassT1553Description",{defaultMessage:"Mark-of-the-Web Bypass (T1553.005)"}),id:"T1553.005",name:"Mark-of-the-Web Bypass",reference:"https://attack.mitre.org/techniques/T1553/005",tactics:"defense-evasion",techniqueId:"T1553",value:"markOfTheWebBypass"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.masqueradeTaskOrServiceT1036Description",{defaultMessage:"Masquerade Task or Service (T1036.004)"}),id:"T1036.004",name:"Masquerade Task or Service",reference:"https://attack.mitre.org/techniques/T1036/004",tactics:"defense-evasion",techniqueId:"T1036",value:"masqueradeTaskOrService"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.matchLegitimateNameOrLocationT1036Description",{defaultMessage:"Match Legitimate Name or Location (T1036.005)"}),id:"T1036.005",name:"Match Legitimate Name or Location",reference:"https://attack.mitre.org/techniques/T1036/005",tactics:"defense-evasion",techniqueId:"T1036",value:"matchLegitimateNameOrLocation"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.mshtaT1218Description",{defaultMessage:"Mshta (T1218.005)"}),id:"T1218.005",name:"Mshta",reference:"https://attack.mitre.org/techniques/T1218/005",tactics:"defense-evasion",techniqueId:"T1218",value:"mshta"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.msiexecT1218Description",{defaultMessage:"Msiexec (T1218.007)"}),id:"T1218.007",name:"Msiexec",reference:"https://attack.mitre.org/techniques/T1218/007",tactics:"defense-evasion",techniqueId:"T1218",value:"msiexec"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.multiHopProxyT1090Description",{defaultMessage:"Multi-hop Proxy (T1090.003)"}),id:"T1090.003",name:"Multi-hop Proxy",reference:"https://attack.mitre.org/techniques/T1090/003",tactics:"command-and-control",techniqueId:"T1090",value:"multiHopProxy"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.ntdsT1003Description",{defaultMessage:"NTDS (T1003.003)"}),id:"T1003.003",name:"NTDS",reference:"https://attack.mitre.org/techniques/T1003/003",tactics:"credential-access",techniqueId:"T1003",value:"ntds"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.ntfsFileAttributesT1564Description",{defaultMessage:"NTFS File Attributes (T1564.004)"}),id:"T1564.004",name:"NTFS File Attributes",reference:"https://attack.mitre.org/techniques/T1564/004",tactics:"defense-evasion",techniqueId:"T1564",value:"ntfsFileAttributes"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.netshHelperDllT1546Description",{defaultMessage:"Netsh Helper DLL (T1546.007)"}),id:"T1546.007",name:"Netsh Helper DLL",reference:"https://attack.mitre.org/techniques/T1546/007",tactics:"privilege-escalation,persistence",techniqueId:"T1546",value:"netshHelperDll"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.networkAddressTranslationTraversalT1599Description",{defaultMessage:"Network Address Translation Traversal (T1599.001)"}),id:"T1599.001",name:"Network Address Translation Traversal",reference:"https://attack.mitre.org/techniques/T1599/001",tactics:"defense-evasion",techniqueId:"T1599",value:"networkAddressTranslationTraversal"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.networkDeviceAuthenticationT1556Description",{defaultMessage:"Network Device Authentication (T1556.004)"}),id:"T1556.004",name:"Network Device Authentication",reference:"https://attack.mitre.org/techniques/T1556/004",tactics:"credential-access,defense-evasion,persistence",techniqueId:"T1556",value:"networkDeviceAuthentication"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.networkDeviceCliT1059Description",{defaultMessage:"Network Device CLI (T1059.008)"}),id:"T1059.008",name:"Network Device CLI",reference:"https://attack.mitre.org/techniques/T1059/008",tactics:"execution",techniqueId:"T1059",value:"networkDeviceCli"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.networkDeviceConfigurationDumpT1602Description",{defaultMessage:"Network Device Configuration Dump (T1602.002)"}),id:"T1602.002",name:"Network Device Configuration Dump",reference:"https://attack.mitre.org/techniques/T1602/002",tactics:"collection",techniqueId:"T1602",value:"networkDeviceConfigurationDump"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.networkLogonScriptT1037Description",{defaultMessage:"Network Logon Script (T1037.003)"}),id:"T1037.003",name:"Network Logon Script",reference:"https://attack.mitre.org/techniques/T1037/003",tactics:"persistence,privilege-escalation",techniqueId:"T1037",value:"networkLogonScript"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.networkSecurityAppliancesT1590Description",{defaultMessage:"Network Security Appliances (T1590.006)"}),id:"T1590.006",name:"Network Security Appliances",reference:"https://attack.mitre.org/techniques/T1590/006",tactics:"reconnaissance",techniqueId:"T1590",value:"networkSecurityAppliances"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.networkShareConnectionRemovalT1070Description",{defaultMessage:"Network Share Connection Removal (T1070.005)"}),id:"T1070.005",name:"Network Share Connection Removal",reference:"https://attack.mitre.org/techniques/T1070/005",tactics:"defense-evasion",techniqueId:"T1070",value:"networkShareConnectionRemoval"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.networkTopologyT1590Description",{defaultMessage:"Network Topology (T1590.004)"}),id:"T1590.004",name:"Network Topology",reference:"https://attack.mitre.org/techniques/T1590/004",tactics:"reconnaissance",techniqueId:"T1590",value:"networkTopology"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.networkTrustDependenciesT1590Description",{defaultMessage:"Network Trust Dependencies (T1590.003)"}),id:"T1590.003",name:"Network Trust Dependencies",reference:"https://attack.mitre.org/techniques/T1590/003",tactics:"reconnaissance",techniqueId:"T1590",value:"networkTrustDependencies"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.nonStandardEncodingT1132Description",{defaultMessage:"Non-Standard Encoding (T1132.002)"}),id:"T1132.002",name:"Non-Standard Encoding",reference:"https://attack.mitre.org/techniques/T1132/002",tactics:"command-and-control",techniqueId:"T1132",value:"nonStandardEncoding"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.osExhaustionFloodT1499Description",{defaultMessage:"OS Exhaustion Flood (T1499.001)"}),id:"T1499.001",name:"OS Exhaustion Flood",reference:"https://attack.mitre.org/techniques/T1499/001",tactics:"impact",techniqueId:"T1499",value:"osExhaustionFlood"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.odbcconfT1218Description",{defaultMessage:"Odbcconf (T1218.008)"}),id:"T1218.008",name:"Odbcconf",reference:"https://attack.mitre.org/techniques/T1218/008",tactics:"defense-evasion",techniqueId:"T1218",value:"odbcconf"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.officeTemplateMacrosT1137Description",{defaultMessage:"Office Template Macros (T1137.001)"}),id:"T1137.001",name:"Office Template Macros",reference:"https://attack.mitre.org/techniques/T1137/001",tactics:"persistence",techniqueId:"T1137",value:"officeTemplateMacros"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.officeTestT1137Description",{defaultMessage:"Office Test (T1137.002)"}),id:"T1137.002",name:"Office Test",reference:"https://attack.mitre.org/techniques/T1137/002",tactics:"persistence",techniqueId:"T1137",value:"officeTest"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.oneWayCommunicationT1102Description",{defaultMessage:"One-Way Communication (T1102.003)"}),id:"T1102.003",name:"One-Way Communication",reference:"https://attack.mitre.org/techniques/T1102/003",tactics:"command-and-control",techniqueId:"T1102",value:"oneWayCommunication"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.outlookFormsT1137Description",{defaultMessage:"Outlook Forms (T1137.003)"}),id:"T1137.003",name:"Outlook Forms",reference:"https://attack.mitre.org/techniques/T1137/003",tactics:"persistence",techniqueId:"T1137",value:"outlookForms"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.outlookHomePageT1137Description",{defaultMessage:"Outlook Home Page (T1137.004)"}),id:"T1137.004",name:"Outlook Home Page",reference:"https://attack.mitre.org/techniques/T1137/004",tactics:"persistence",techniqueId:"T1137",value:"outlookHomePage"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.outlookRulesT1137Description",{defaultMessage:"Outlook Rules (T1137.005)"}),id:"T1137.005",name:"Outlook Rules",reference:"https://attack.mitre.org/techniques/T1137/005",tactics:"persistence",techniqueId:"T1137",value:"outlookRules"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.parentPidSpoofingT1134Description",{defaultMessage:"Parent PID Spoofing (T1134.004)"}),id:"T1134.004",name:"Parent PID Spoofing",reference:"https://attack.mitre.org/techniques/T1134/004",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1134",value:"parentPidSpoofing"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.passTheHashT1550Description",{defaultMessage:"Pass the Hash (T1550.002)"}),id:"T1550.002",name:"Pass the Hash",reference:"https://attack.mitre.org/techniques/T1550/002",tactics:"defense-evasion,lateral-movement",techniqueId:"T1550",value:"passTheHash"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.passTheTicketT1550Description",{defaultMessage:"Pass the Ticket (T1550.003)"}),id:"T1550.003",name:"Pass the Ticket",reference:"https://attack.mitre.org/techniques/T1550/003",tactics:"defense-evasion,lateral-movement",techniqueId:"T1550",value:"passTheTicket"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.passwordCrackingT1110Description",{defaultMessage:"Password Cracking (T1110.002)"}),id:"T1110.002",name:"Password Cracking",reference:"https://attack.mitre.org/techniques/T1110/002",tactics:"credential-access",techniqueId:"T1110",value:"passwordCracking"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.passwordFilterDllT1556Description",{defaultMessage:"Password Filter DLL (T1556.002)"}),id:"T1556.002",name:"Password Filter DLL",reference:"https://attack.mitre.org/techniques/T1556/002",tactics:"credential-access,defense-evasion,persistence",techniqueId:"T1556",value:"passwordFilterDll"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.passwordGuessingT1110Description",{defaultMessage:"Password Guessing (T1110.001)"}),id:"T1110.001",name:"Password Guessing",reference:"https://attack.mitre.org/techniques/T1110/001",tactics:"credential-access",techniqueId:"T1110",value:"passwordGuessing"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.passwordManagersT1555Description",{defaultMessage:"Password Managers (T1555.005)"}),id:"T1555.005",name:"Password Managers",reference:"https://attack.mitre.org/techniques/T1555/005",tactics:"credential-access",techniqueId:"T1555",value:"passwordManagers"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.passwordSprayingT1110Description",{defaultMessage:"Password Spraying (T1110.003)"}),id:"T1110.003",name:"Password Spraying",reference:"https://attack.mitre.org/techniques/T1110/003",tactics:"credential-access",techniqueId:"T1110",value:"passwordSpraying"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.patchSystemImageT1601Description",{defaultMessage:"Patch System Image (T1601.001)"}),id:"T1601.001",name:"Patch System Image",reference:"https://attack.mitre.org/techniques/T1601/001",tactics:"defense-evasion",techniqueId:"T1601",value:"patchSystemImage"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.pathInterceptionByPathEnvironmentVariableT1574Description",{defaultMessage:"Path Interception by PATH Environment Variable (T1574.007)"}),id:"T1574.007",name:"Path Interception by PATH Environment Variable",reference:"https://attack.mitre.org/techniques/T1574/007",tactics:"persistence,privilege-escalation,defense-evasion",techniqueId:"T1574",value:"pathInterceptionByPathEnvironmentVariable"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.pathInterceptionBySearchOrderHijackingT1574Description",{defaultMessage:"Path Interception by Search Order Hijacking (T1574.008)"}),id:"T1574.008",name:"Path Interception by Search Order Hijacking",reference:"https://attack.mitre.org/techniques/T1574/008",tactics:"persistence,privilege-escalation,defense-evasion",techniqueId:"T1574",value:"pathInterceptionBySearchOrderHijacking"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.pathInterceptionByUnquotedPathT1574Description",{defaultMessage:"Path Interception by Unquoted Path (T1574.009)"}),id:"T1574.009",name:"Path Interception by Unquoted Path",reference:"https://attack.mitre.org/techniques/T1574/009",tactics:"persistence,privilege-escalation,defense-evasion",techniqueId:"T1574",value:"pathInterceptionByUnquotedPath"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.plistModificationT1547Description",{defaultMessage:"Plist Modification (T1547.011)"}),id:"T1547.011",name:"Plist Modification",reference:"https://attack.mitre.org/techniques/T1547/011",tactics:"persistence,privilege-escalation",techniqueId:"T1547",value:"plistModification"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.pluggableAuthenticationModulesT1556Description",{defaultMessage:"Pluggable Authentication Modules (T1556.003)"}),id:"T1556.003",name:"Pluggable Authentication Modules",reference:"https://attack.mitre.org/techniques/T1556/003",tactics:"credential-access,defense-evasion,persistence",techniqueId:"T1556",value:"pluggableAuthenticationModules"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.portKnockingT1205Description",{defaultMessage:"Port Knocking (T1205.001)"}),id:"T1205.001",name:"Port Knocking",reference:"https://attack.mitre.org/techniques/T1205/001",tactics:"defense-evasion,persistence,command-and-control",techniqueId:"T1205",value:"portKnocking"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.portMonitorsT1547Description",{defaultMessage:"Port Monitors (T1547.010)"}),id:"T1547.010",name:"Port Monitors",reference:"https://attack.mitre.org/techniques/T1547/010",tactics:"persistence,privilege-escalation",techniqueId:"T1547",value:"portMonitors"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.portableExecutableInjectionT1055Description",{defaultMessage:"Portable Executable Injection (T1055.002)"}),id:"T1055.002",name:"Portable Executable Injection",reference:"https://attack.mitre.org/techniques/T1055/002",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1055",value:"portableExecutableInjection"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.powerShellT1059Description",{defaultMessage:"PowerShell (T1059.001)"}),id:"T1059.001",name:"PowerShell",reference:"https://attack.mitre.org/techniques/T1059/001",tactics:"execution",techniqueId:"T1059",value:"powerShell"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.powerShellProfileT1546Description",{defaultMessage:"PowerShell Profile (T1546.013)"}),id:"T1546.013",name:"PowerShell Profile",reference:"https://attack.mitre.org/techniques/T1546/013",tactics:"privilege-escalation,persistence",techniqueId:"T1546",value:"powerShellProfile"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.printProcessorsT1547Description",{defaultMessage:"Print Processors (T1547.012)"}),id:"T1547.012",name:"Print Processors",reference:"https://attack.mitre.org/techniques/T1547/012",tactics:"persistence,privilege-escalation",techniqueId:"T1547",value:"printProcessors"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.privateKeysT1552Description",{defaultMessage:"Private Keys (T1552.004)"}),id:"T1552.004",name:"Private Keys",reference:"https://attack.mitre.org/techniques/T1552/004",tactics:"credential-access",techniqueId:"T1552",value:"privateKeys"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.procFilesystemT1003Description",{defaultMessage:"Proc Filesystem (T1003.007)"}),id:"T1003.007",name:"Proc Filesystem",reference:"https://attack.mitre.org/techniques/T1003/007",tactics:"credential-access",techniqueId:"T1003",value:"procFilesystem"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.procMemoryT1055Description",{defaultMessage:"Proc Memory (T1055.009)"}),id:"T1055.009",name:"Proc Memory",reference:"https://attack.mitre.org/techniques/T1055/009",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1055",value:"procMemory"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.processDoppelgangingT1055Description",{defaultMessage:"Process Doppelgänging (T1055.013)"}),id:"T1055.013",name:"Process Doppelgänging",reference:"https://attack.mitre.org/techniques/T1055/013",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1055",value:"processDoppelganging"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.processHollowingT1055Description",{defaultMessage:"Process Hollowing (T1055.012)"}),id:"T1055.012",name:"Process Hollowing",reference:"https://attack.mitre.org/techniques/T1055/012",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1055",value:"processHollowing"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.protocolImpersonationT1001Description",{defaultMessage:"Protocol Impersonation (T1001.003)"}),id:"T1001.003",name:"Protocol Impersonation",reference:"https://attack.mitre.org/techniques/T1001/003",tactics:"command-and-control",techniqueId:"T1001",value:"protocolImpersonation"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.ptraceSystemCallsT1055Description",{defaultMessage:"Ptrace System Calls (T1055.008)"}),id:"T1055.008",name:"Ptrace System Calls",reference:"https://attack.mitre.org/techniques/T1055/008",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1055",value:"ptraceSystemCalls"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.pubPrnT1216Description",{defaultMessage:"PubPrn (T1216.001)"}),id:"T1216.001",name:"PubPrn",reference:"https://attack.mitre.org/techniques/T1216/001",tactics:"defense-evasion",techniqueId:"T1216",value:"pubPrn"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.purchaseTechnicalDataT1597Description",{defaultMessage:"Purchase Technical Data (T1597.002)"}),id:"T1597.002",name:"Purchase Technical Data",reference:"https://attack.mitre.org/techniques/T1597/002",tactics:"reconnaissance",techniqueId:"T1597",value:"purchaseTechnicalData"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.pythonT1059Description",{defaultMessage:"Python (T1059.006)"}),id:"T1059.006",name:"Python",reference:"https://attack.mitre.org/techniques/T1059/006",tactics:"execution",techniqueId:"T1059",value:"python"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.rcScriptsT1037Description",{defaultMessage:"RC Scripts (T1037.004)"}),id:"T1037.004",name:"RC Scripts",reference:"https://attack.mitre.org/techniques/T1037/004",tactics:"persistence,privilege-escalation",techniqueId:"T1037",value:"rcScripts"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.rdpHijackingT1563Description",{defaultMessage:"RDP Hijacking (T1563.002)"}),id:"T1563.002",name:"RDP Hijacking",reference:"https://attack.mitre.org/techniques/T1563/002",tactics:"lateral-movement",techniqueId:"T1563",value:"rdpHijacking"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.rommoNkitT1542Description",{defaultMessage:"ROMMONkit (T1542.004)"}),id:"T1542.004",name:"ROMMONkit",reference:"https://attack.mitre.org/techniques/T1542/004",tactics:"defense-evasion,persistence",techniqueId:"T1542",value:"rommoNkit"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.reOpenedApplicationsT1547Description",{defaultMessage:"Re-opened Applications (T1547.007)"}),id:"T1547.007",name:"Re-opened Applications",reference:"https://attack.mitre.org/techniques/T1547/007",tactics:"persistence,privilege-escalation",techniqueId:"T1547",value:"reOpenedApplications"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.reduceKeySpaceT1600Description",{defaultMessage:"Reduce Key Space (T1600.001)"}),id:"T1600.001",name:"Reduce Key Space",reference:"https://attack.mitre.org/techniques/T1600/001",tactics:"defense-evasion",techniqueId:"T1600",value:"reduceKeySpace"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.reflectionAmplificationT1498Description",{defaultMessage:"Reflection Amplification (T1498.002)"}),id:"T1498.002",name:"Reflection Amplification",reference:"https://attack.mitre.org/techniques/T1498/002",tactics:"impact",techniqueId:"T1498",value:"reflectionAmplification"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.registryRunKeysStartupFolderT1547Description",{defaultMessage:"Registry Run Keys / Startup Folder (T1547.001)"}),id:"T1547.001",name:"Registry Run Keys / Startup Folder",reference:"https://attack.mitre.org/techniques/T1547/001",tactics:"persistence,privilege-escalation",techniqueId:"T1547",value:"registryRunKeysStartupFolder"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.regsvcsRegasmT1218Description",{defaultMessage:"Regsvcs/Regasm (T1218.009)"}),id:"T1218.009",name:"Regsvcs/Regasm",reference:"https://attack.mitre.org/techniques/T1218/009",tactics:"defense-evasion",techniqueId:"T1218",value:"regsvcsRegasm"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.regsvr32T1218Description",{defaultMessage:"Regsvr32 (T1218.010)"}),id:"T1218.010",name:"Regsvr32",reference:"https://attack.mitre.org/techniques/T1218/010",tactics:"defense-evasion",techniqueId:"T1218",value:"regsvr32"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.remoteDataStagingT1074Description",{defaultMessage:"Remote Data Staging (T1074.002)"}),id:"T1074.002",name:"Remote Data Staging",reference:"https://attack.mitre.org/techniques/T1074/002",tactics:"collection",techniqueId:"T1074",value:"remoteDataStaging"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.remoteDesktopProtocolT1021Description",{defaultMessage:"Remote Desktop Protocol (T1021.001)"}),id:"T1021.001",name:"Remote Desktop Protocol",reference:"https://attack.mitre.org/techniques/T1021/001",tactics:"lateral-movement",techniqueId:"T1021",value:"remoteDesktopProtocol"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.remoteEmailCollectionT1114Description",{defaultMessage:"Remote Email Collection (T1114.002)"}),id:"T1114.002",name:"Remote Email Collection",reference:"https://attack.mitre.org/techniques/T1114/002",tactics:"collection",techniqueId:"T1114",value:"remoteEmailCollection"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.renameSystemUtilitiesT1036Description",{defaultMessage:"Rename System Utilities (T1036.003)"}),id:"T1036.003",name:"Rename System Utilities",reference:"https://attack.mitre.org/techniques/T1036/003",tactics:"defense-evasion",techniqueId:"T1036",value:"renameSystemUtilities"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.revertCloudInstanceT1578Description",{defaultMessage:"Revert Cloud Instance (T1578.004)"}),id:"T1578.004",name:"Revert Cloud Instance",reference:"https://attack.mitre.org/techniques/T1578/004",tactics:"defense-evasion",techniqueId:"T1578",value:"revertCloudInstance"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.rightToLeftOverrideT1036Description",{defaultMessage:"Right-to-Left Override (T1036.002)"}),id:"T1036.002",name:"Right-to-Left Override",reference:"https://attack.mitre.org/techniques/T1036/002",tactics:"defense-evasion",techniqueId:"T1036",value:"rightToLeftOverride"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.runVirtualInstanceT1564Description",{defaultMessage:"Run Virtual Instance (T1564.006)"}),id:"T1564.006",name:"Run Virtual Instance",reference:"https://attack.mitre.org/techniques/T1564/006",tactics:"defense-evasion",techniqueId:"T1564",value:"runVirtualInstance"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.rundll32T1218Description",{defaultMessage:"Rundll32 (T1218.011)"}),id:"T1218.011",name:"Rundll32",reference:"https://attack.mitre.org/techniques/T1218/011",tactics:"defense-evasion",techniqueId:"T1218",value:"rundll32"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.runtimeDataManipulationT1565Description",{defaultMessage:"Runtime Data Manipulation (T1565.003)"}),id:"T1565.003",name:"Runtime Data Manipulation",reference:"https://attack.mitre.org/techniques/T1565/003",tactics:"impact",techniqueId:"T1565",value:"runtimeDataManipulation"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.samlTokensT1606Description",{defaultMessage:"SAML Tokens (T1606.002)"}),id:"T1606.002",name:"SAML Tokens",reference:"https://attack.mitre.org/techniques/T1606/002",tactics:"credential-access",techniqueId:"T1606",value:"samlTokens"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.sidHistoryInjectionT1134Description",{defaultMessage:"SID-History Injection (T1134.005)"}),id:"T1134.005",name:"SID-History Injection",reference:"https://attack.mitre.org/techniques/T1134/005",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1134",value:"sidHistoryInjection"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.sipAndTrustProviderHijackingT1553Description",{defaultMessage:"SIP and Trust Provider Hijacking (T1553.003)"}),id:"T1553.003",name:"SIP and Trust Provider Hijacking",reference:"https://attack.mitre.org/techniques/T1553/003",tactics:"defense-evasion",techniqueId:"T1553",value:"sipAndTrustProviderHijacking"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.smbWindowsAdminSharesT1021Description",{defaultMessage:"SMB/Windows Admin Shares (T1021.002)"}),id:"T1021.002",name:"SMB/Windows Admin Shares",reference:"https://attack.mitre.org/techniques/T1021/002",tactics:"lateral-movement",techniqueId:"T1021",value:"smbWindowsAdminShares"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.snmpMibDumpT1602Description",{defaultMessage:"SNMP (MIB Dump) (T1602.001)"}),id:"T1602.001",name:"SNMP (MIB Dump)",reference:"https://attack.mitre.org/techniques/T1602/001",tactics:"collection",techniqueId:"T1602",value:"snmpMibDump"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.sqlStoredProceduresT1505Description",{defaultMessage:"SQL Stored Procedures (T1505.001)"}),id:"T1505.001",name:"SQL Stored Procedures",reference:"https://attack.mitre.org/techniques/T1505/001",tactics:"persistence",techniqueId:"T1505",value:"sqlStoredProcedures"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.sshT1021Description",{defaultMessage:"SSH (T1021.004)"}),id:"T1021.004",name:"SSH",reference:"https://attack.mitre.org/techniques/T1021/004",tactics:"lateral-movement",techniqueId:"T1021",value:"ssh"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.sshAuthorizedKeysT1098Description",{defaultMessage:"SSH Authorized Keys (T1098.004)"}),id:"T1098.004",name:"SSH Authorized Keys",reference:"https://attack.mitre.org/techniques/T1098/004",tactics:"persistence",techniqueId:"T1098",value:"sshAuthorizedKeys"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.sshHijackingT1563Description",{defaultMessage:"SSH Hijacking (T1563.001)"}),id:"T1563.001",name:"SSH Hijacking",reference:"https://attack.mitre.org/techniques/T1563/001",tactics:"lateral-movement",techniqueId:"T1563",value:"sshHijacking"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.scanDatabasesT1596Description",{defaultMessage:"Scan Databases (T1596.005)"}),id:"T1596.005",name:"Scan Databases",reference:"https://attack.mitre.org/techniques/T1596/005",tactics:"reconnaissance",techniqueId:"T1596",value:"scanDatabases"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.scanningIpBlocksT1595Description",{defaultMessage:"Scanning IP Blocks (T1595.001)"}),id:"T1595.001",name:"Scanning IP Blocks",reference:"https://attack.mitre.org/techniques/T1595/001",tactics:"reconnaissance",techniqueId:"T1595",value:"scanningIpBlocks"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.scheduledTaskT1053Description",{defaultMessage:"Scheduled Task (T1053.005)"}),id:"T1053.005",name:"Scheduled Task",reference:"https://attack.mitre.org/techniques/T1053/005",tactics:"execution,persistence,privilege-escalation",techniqueId:"T1053",value:"scheduledTask"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.screensaverT1546Description",{defaultMessage:"Screensaver (T1546.002)"}),id:"T1546.002",name:"Screensaver",reference:"https://attack.mitre.org/techniques/T1546/002",tactics:"privilege-escalation,persistence",techniqueId:"T1546",value:"screensaver"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.searchEnginesT1593Description",{defaultMessage:"Search Engines (T1593.002)"}),id:"T1593.002",name:"Search Engines",reference:"https://attack.mitre.org/techniques/T1593/002",tactics:"reconnaissance",techniqueId:"T1593",value:"searchEngines"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.securityAccountManagerT1003Description",{defaultMessage:"Security Account Manager (T1003.002)"}),id:"T1003.002",name:"Security Account Manager",reference:"https://attack.mitre.org/techniques/T1003/002",tactics:"credential-access",techniqueId:"T1003",value:"securityAccountManager"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.securitySoftwareDiscoveryT1518Description",{defaultMessage:"Security Software Discovery (T1518.001)"}),id:"T1518.001",name:"Security Software Discovery",reference:"https://attack.mitre.org/techniques/T1518/001",tactics:"discovery",techniqueId:"T1518",value:"securitySoftwareDiscovery"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.securitySupportProviderT1547Description",{defaultMessage:"Security Support Provider (T1547.005)"}),id:"T1547.005",name:"Security Support Provider",reference:"https://attack.mitre.org/techniques/T1547/005",tactics:"persistence,privilege-escalation",techniqueId:"T1547",value:"securitySupportProvider"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.securitydMemoryT1555Description",{defaultMessage:"Securityd Memory (T1555.002)"}),id:"T1555.002",name:"Securityd Memory",reference:"https://attack.mitre.org/techniques/T1555/002",tactics:"credential-access",techniqueId:"T1555",value:"securitydMemory"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.serverT1583Description",{defaultMessage:"Server (T1583.004)"}),id:"T1583.004",name:"Server",reference:"https://attack.mitre.org/techniques/T1583/004",tactics:"resource-development",techniqueId:"T1583",value:"server"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.serverT1584Description",{defaultMessage:"Server (T1584.004)"}),id:"T1584.004",name:"Server",reference:"https://attack.mitre.org/techniques/T1584/004",tactics:"resource-development",techniqueId:"T1584",value:"server"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.serviceExecutionT1569Description",{defaultMessage:"Service Execution (T1569.002)"}),id:"T1569.002",name:"Service Execution",reference:"https://attack.mitre.org/techniques/T1569/002",tactics:"execution",techniqueId:"T1569",value:"serviceExecution"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.serviceExhaustionFloodT1499Description",{defaultMessage:"Service Exhaustion Flood (T1499.002)"}),id:"T1499.002",name:"Service Exhaustion Flood",reference:"https://attack.mitre.org/techniques/T1499/002",tactics:"impact",techniqueId:"T1499",value:"serviceExhaustionFlood"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.servicesFilePermissionsWeaknessT1574Description",{defaultMessage:"Services File Permissions Weakness (T1574.010)"}),id:"T1574.010",name:"Services File Permissions Weakness",reference:"https://attack.mitre.org/techniques/T1574/010",tactics:"persistence,privilege-escalation,defense-evasion",techniqueId:"T1574",value:"servicesFilePermissionsWeakness"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.servicesRegistryPermissionsWeaknessT1574Description",{defaultMessage:"Services Registry Permissions Weakness (T1574.011)"}),id:"T1574.011",name:"Services Registry Permissions Weakness",reference:"https://attack.mitre.org/techniques/T1574/011",tactics:"persistence,privilege-escalation,defense-evasion",techniqueId:"T1574",value:"servicesRegistryPermissionsWeakness"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.setuidAndSetgidT1548Description",{defaultMessage:"Setuid and Setgid (T1548.001)"}),id:"T1548.001",name:"Setuid and Setgid",reference:"https://attack.mitre.org/techniques/T1548/001",tactics:"privilege-escalation,defense-evasion",techniqueId:"T1548",value:"setuidAndSetgid"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.sharepointT1213Description",{defaultMessage:"Sharepoint (T1213.002)"}),id:"T1213.002",name:"Sharepoint",reference:"https://attack.mitre.org/techniques/T1213/002",tactics:"collection",techniqueId:"T1213",value:"sharepoint"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.shortcutModificationT1547Description",{defaultMessage:"Shortcut Modification (T1547.009)"}),id:"T1547.009",name:"Shortcut Modification",reference:"https://attack.mitre.org/techniques/T1547/009",tactics:"persistence,privilege-escalation",techniqueId:"T1547",value:"shortcutModification"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.silverTicketT1558Description",{defaultMessage:"Silver Ticket (T1558.002)"}),id:"T1558.002",name:"Silver Ticket",reference:"https://attack.mitre.org/techniques/T1558/002",tactics:"credential-access",techniqueId:"T1558",value:"silverTicket"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.socialMediaT1593Description",{defaultMessage:"Social Media (T1593.001)"}),id:"T1593.001",name:"Social Media",reference:"https://attack.mitre.org/techniques/T1593/001",tactics:"reconnaissance",techniqueId:"T1593",value:"socialMedia"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.socialMediaAccountsT1585Description",{defaultMessage:"Social Media Accounts (T1585.001)"}),id:"T1585.001",name:"Social Media Accounts",reference:"https://attack.mitre.org/techniques/T1585/001",tactics:"resource-development",techniqueId:"T1585",value:"socialMediaAccounts"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.socialMediaAccountsT1586Description",{defaultMessage:"Social Media Accounts (T1586.001)"}),id:"T1586.001",name:"Social Media Accounts",reference:"https://attack.mitre.org/techniques/T1586/001",tactics:"resource-development",techniqueId:"T1586",value:"socialMediaAccounts"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.softwareT1592Description",{defaultMessage:"Software (T1592.002)"}),id:"T1592.002",name:"Software",reference:"https://attack.mitre.org/techniques/T1592/002",tactics:"reconnaissance",techniqueId:"T1592",value:"software"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.softwarePackingT1027Description",{defaultMessage:"Software Packing (T1027.002)"}),id:"T1027.002",name:"Software Packing",reference:"https://attack.mitre.org/techniques/T1027/002",tactics:"defense-evasion",techniqueId:"T1027",value:"softwarePacking"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.spaceAfterFilenameT1036Description",{defaultMessage:"Space after Filename (T1036.006)"}),id:"T1036.006",name:"Space after Filename",reference:"https://attack.mitre.org/techniques/T1036/006",tactics:"defense-evasion",techniqueId:"T1036",value:"spaceAfterFilename"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.spearphishingAttachmentT1566Description",{defaultMessage:"Spearphishing Attachment (T1566.001)"}),id:"T1566.001",name:"Spearphishing Attachment",reference:"https://attack.mitre.org/techniques/T1566/001",tactics:"initial-access",techniqueId:"T1566",value:"spearphishingAttachment"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.spearphishingAttachmentT1598Description",{defaultMessage:"Spearphishing Attachment (T1598.002)"}),id:"T1598.002",name:"Spearphishing Attachment",reference:"https://attack.mitre.org/techniques/T1598/002",tactics:"reconnaissance",techniqueId:"T1598",value:"spearphishingAttachment"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.spearphishingLinkT1566Description",{defaultMessage:"Spearphishing Link (T1566.002)"}),id:"T1566.002",name:"Spearphishing Link",reference:"https://attack.mitre.org/techniques/T1566/002",tactics:"initial-access",techniqueId:"T1566",value:"spearphishingLink"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.spearphishingLinkT1598Description",{defaultMessage:"Spearphishing Link (T1598.003)"}),id:"T1598.003",name:"Spearphishing Link",reference:"https://attack.mitre.org/techniques/T1598/003",tactics:"reconnaissance",techniqueId:"T1598",value:"spearphishingLink"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.spearphishingServiceT1598Description",{defaultMessage:"Spearphishing Service (T1598.001)"}),id:"T1598.001",name:"Spearphishing Service",reference:"https://attack.mitre.org/techniques/T1598/001",tactics:"reconnaissance",techniqueId:"T1598",value:"spearphishingService"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.spearphishingViaServiceT1566Description",{defaultMessage:"Spearphishing via Service (T1566.003)"}),id:"T1566.003",name:"Spearphishing via Service",reference:"https://attack.mitre.org/techniques/T1566/003",tactics:"initial-access",techniqueId:"T1566",value:"spearphishingViaService"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.standardEncodingT1132Description",{defaultMessage:"Standard Encoding (T1132.001)"}),id:"T1132.001",name:"Standard Encoding",reference:"https://attack.mitre.org/techniques/T1132/001",tactics:"command-and-control",techniqueId:"T1132",value:"standardEncoding"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.startupItemsT1037Description",{defaultMessage:"Startup Items (T1037.005)"}),id:"T1037.005",name:"Startup Items",reference:"https://attack.mitre.org/techniques/T1037/005",tactics:"persistence,privilege-escalation",techniqueId:"T1037",value:"startupItems"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.steganographyT1027Description",{defaultMessage:"Steganography (T1027.003)"}),id:"T1027.003",name:"Steganography",reference:"https://attack.mitre.org/techniques/T1027/003",tactics:"defense-evasion",techniqueId:"T1027",value:"steganography"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.steganographyT1001Description",{defaultMessage:"Steganography (T1001.002)"}),id:"T1001.002",name:"Steganography",reference:"https://attack.mitre.org/techniques/T1001/002",tactics:"command-and-control",techniqueId:"T1001",value:"steganography"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.storedDataManipulationT1565Description",{defaultMessage:"Stored Data Manipulation (T1565.001)"}),id:"T1565.001",name:"Stored Data Manipulation",reference:"https://attack.mitre.org/techniques/T1565/001",tactics:"impact",techniqueId:"T1565",value:"storedDataManipulation"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.sudoAndSudoCachingT1548Description",{defaultMessage:"Sudo and Sudo Caching (T1548.003)"}),id:"T1548.003",name:"Sudo and Sudo Caching",reference:"https://attack.mitre.org/techniques/T1548/003",tactics:"privilege-escalation,defense-evasion",techniqueId:"T1548",value:"sudoAndSudoCaching"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.symmetricCryptographyT1573Description",{defaultMessage:"Symmetric Cryptography (T1573.001)"}),id:"T1573.001",name:"Symmetric Cryptography",reference:"https://attack.mitre.org/techniques/T1573/001",tactics:"command-and-control",techniqueId:"T1573",value:"symmetricCryptography"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.systemChecksT1497Description",{defaultMessage:"System Checks (T1497.001)"}),id:"T1497.001",name:"System Checks",reference:"https://attack.mitre.org/techniques/T1497/001",tactics:"defense-evasion,discovery",techniqueId:"T1497",value:"systemChecks"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.systemFirmwareT1542Description",{defaultMessage:"System Firmware (T1542.001)"}),id:"T1542.001",name:"System Firmware",reference:"https://attack.mitre.org/techniques/T1542/001",tactics:"persistence,defense-evasion",techniqueId:"T1542",value:"systemFirmware"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.systemdServiceT1543Description",{defaultMessage:"Systemd Service (T1543.002)"}),id:"T1543.002",name:"Systemd Service",reference:"https://attack.mitre.org/techniques/T1543/002",tactics:"persistence,privilege-escalation",techniqueId:"T1543",value:"systemdService"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.systemdTimersT1053Description",{defaultMessage:"Systemd Timers (T1053.006)"}),id:"T1053.006",name:"Systemd Timers",reference:"https://attack.mitre.org/techniques/T1053/006",tactics:"execution,persistence,privilege-escalation",techniqueId:"T1053",value:"systemdTimers"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.tftpBootT1542Description",{defaultMessage:"TFTP Boot (T1542.005)"}),id:"T1542.005",name:"TFTP Boot",reference:"https://attack.mitre.org/techniques/T1542/005",tactics:"defense-evasion,persistence",techniqueId:"T1542",value:"tftpBoot"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.threadExecutionHijackingT1055Description",{defaultMessage:"Thread Execution Hijacking (T1055.003)"}),id:"T1055.003",name:"Thread Execution Hijacking",reference:"https://attack.mitre.org/techniques/T1055/003",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1055",value:"threadExecutionHijacking"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.threadLocalStorageT1055Description",{defaultMessage:"Thread Local Storage (T1055.005)"}),id:"T1055.005",name:"Thread Local Storage",reference:"https://attack.mitre.org/techniques/T1055/005",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1055",value:"threadLocalStorage"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.threatIntelVendorsT1597Description",{defaultMessage:"Threat Intel Vendors (T1597.001)"}),id:"T1597.001",name:"Threat Intel Vendors",reference:"https://attack.mitre.org/techniques/T1597/001",tactics:"reconnaissance",techniqueId:"T1597",value:"threatIntelVendors"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.timeBasedEvasionT1497Description",{defaultMessage:"Time Based Evasion (T1497.003)"}),id:"T1497.003",name:"Time Based Evasion",reference:"https://attack.mitre.org/techniques/T1497/003",tactics:"defense-evasion,discovery",techniqueId:"T1497",value:"timeBasedEvasion"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.timeProvidersT1547Description",{defaultMessage:"Time Providers (T1547.003)"}),id:"T1547.003",name:"Time Providers",reference:"https://attack.mitre.org/techniques/T1547/003",tactics:"persistence,privilege-escalation",techniqueId:"T1547",value:"timeProviders"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.timestompT1070Description",{defaultMessage:"Timestomp (T1070.006)"}),id:"T1070.006",name:"Timestomp",reference:"https://attack.mitre.org/techniques/T1070/006",tactics:"defense-evasion",techniqueId:"T1070",value:"timestomp"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.tokenImpersonationTheftT1134Description",{defaultMessage:"Token Impersonation/Theft (T1134.001)"}),id:"T1134.001",name:"Token Impersonation/Theft",reference:"https://attack.mitre.org/techniques/T1134/001",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1134",value:"tokenImpersonationTheft"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.toolT1588Description",{defaultMessage:"Tool (T1588.002)"}),id:"T1588.002",name:"Tool",reference:"https://attack.mitre.org/techniques/T1588/002",tactics:"resource-development",techniqueId:"T1588",value:"tool"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.trafficDuplicationT1020Description",{defaultMessage:"Traffic Duplication (T1020.001)"}),id:"T1020.001",name:"Traffic Duplication",reference:"https://attack.mitre.org/techniques/T1020/001",tactics:"exfiltration",techniqueId:"T1020",value:"trafficDuplication"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.transmittedDataManipulationT1565Description",{defaultMessage:"Transmitted Data Manipulation (T1565.002)"}),id:"T1565.002",name:"Transmitted Data Manipulation",reference:"https://attack.mitre.org/techniques/T1565/002",tactics:"impact",techniqueId:"T1565",value:"transmittedDataManipulation"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.transportAgentT1505Description",{defaultMessage:"Transport Agent (T1505.002)"}),id:"T1505.002",name:"Transport Agent",reference:"https://attack.mitre.org/techniques/T1505/002",tactics:"persistence",techniqueId:"T1505",value:"transportAgent"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.trapT1546Description",{defaultMessage:"Trap (T1546.005)"}),id:"T1546.005",name:"Trap",reference:"https://attack.mitre.org/techniques/T1546/005",tactics:"privilege-escalation,persistence",techniqueId:"T1546",value:"trap"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.unixShellT1059Description",{defaultMessage:"Unix Shell (T1059.004)"}),id:"T1059.004",name:"Unix Shell",reference:"https://attack.mitre.org/techniques/T1059/004",tactics:"execution",techniqueId:"T1059",value:"unixShell"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.unixShellConfigurationModificationT1546Description",{defaultMessage:"Unix Shell Configuration Modification (T1546.004)"}),id:"T1546.004",name:"Unix Shell Configuration Modification",reference:"https://attack.mitre.org/techniques/T1546/004",tactics:"privilege-escalation,persistence",techniqueId:"T1546",value:"unixShellConfigurationModification"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.uploadMalwareT1608Description",{defaultMessage:"Upload Malware (T1608.001)"}),id:"T1608.001",name:"Upload Malware",reference:"https://attack.mitre.org/techniques/T1608/001",tactics:"resource-development",techniqueId:"T1608",value:"uploadMalware"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.uploadToolT1608Description",{defaultMessage:"Upload Tool (T1608.002)"}),id:"T1608.002",name:"Upload Tool",reference:"https://attack.mitre.org/techniques/T1608/002",tactics:"resource-development",techniqueId:"T1608",value:"uploadTool"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.userActivityBasedChecksT1497Description",{defaultMessage:"User Activity Based Checks (T1497.002)"}),id:"T1497.002",name:"User Activity Based Checks",reference:"https://attack.mitre.org/techniques/T1497/002",tactics:"defense-evasion,discovery",techniqueId:"T1497",value:"userActivityBasedChecks"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.vbaStompingT1564Description",{defaultMessage:"VBA Stomping (T1564.007)"}),id:"T1564.007",name:"VBA Stomping",reference:"https://attack.mitre.org/techniques/T1564/007",tactics:"defense-evasion",techniqueId:"T1564",value:"vbaStomping"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.vdsoHijackingT1055Description",{defaultMessage:"VDSO Hijacking (T1055.014)"}),id:"T1055.014",name:"VDSO Hijacking",reference:"https://attack.mitre.org/techniques/T1055/014",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1055",value:"vdsoHijacking"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.vncT1021Description",{defaultMessage:"VNC (T1021.005)"}),id:"T1021.005",name:"VNC",reference:"https://attack.mitre.org/techniques/T1021/005",tactics:"lateral-movement",techniqueId:"T1021",value:"vnc"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.verclsidT1218Description",{defaultMessage:"Verclsid (T1218.012)"}),id:"T1218.012",name:"Verclsid",reference:"https://attack.mitre.org/techniques/T1218/012",tactics:"defense-evasion",techniqueId:"T1218",value:"verclsid"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.virtualPrivateServerT1583Description",{defaultMessage:"Virtual Private Server (T1583.003)"}),id:"T1583.003",name:"Virtual Private Server",reference:"https://attack.mitre.org/techniques/T1583/003",tactics:"resource-development",techniqueId:"T1583",value:"virtualPrivateServer"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.virtualPrivateServerT1584Description",{defaultMessage:"Virtual Private Server (T1584.003)"}),id:"T1584.003",name:"Virtual Private Server",reference:"https://attack.mitre.org/techniques/T1584/003",tactics:"resource-development",techniqueId:"T1584",value:"virtualPrivateServer"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.visualBasicT1059Description",{defaultMessage:"Visual Basic (T1059.005)"}),id:"T1059.005",name:"Visual Basic",reference:"https://attack.mitre.org/techniques/T1059/005",tactics:"execution",techniqueId:"T1059",value:"visualBasic"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.vulnerabilitiesT1588Description",{defaultMessage:"Vulnerabilities (T1588.006)"}),id:"T1588.006",name:"Vulnerabilities",reference:"https://attack.mitre.org/techniques/T1588/006",tactics:"resource-development",techniqueId:"T1588",value:"vulnerabilities"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.vulnerabilityScanningT1595Description",{defaultMessage:"Vulnerability Scanning (T1595.002)"}),id:"T1595.002",name:"Vulnerability Scanning",reference:"https://attack.mitre.org/techniques/T1595/002",tactics:"reconnaissance",techniqueId:"T1595",value:"vulnerabilityScanning"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.whoisT1596Description",{defaultMessage:"WHOIS (T1596.002)"}),id:"T1596.002",name:"WHOIS",reference:"https://attack.mitre.org/techniques/T1596/002",tactics:"reconnaissance",techniqueId:"T1596",value:"whois"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.webCookiesT1606Description",{defaultMessage:"Web Cookies (T1606.001)"}),id:"T1606.001",name:"Web Cookies",reference:"https://attack.mitre.org/techniques/T1606/001",tactics:"credential-access",techniqueId:"T1606",value:"webCookies"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.webPortalCaptureT1056Description",{defaultMessage:"Web Portal Capture (T1056.003)"}),id:"T1056.003",name:"Web Portal Capture",reference:"https://attack.mitre.org/techniques/T1056/003",tactics:"collection,credential-access",techniqueId:"T1056",value:"webPortalCapture"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.webProtocolsT1071Description",{defaultMessage:"Web Protocols (T1071.001)"}),id:"T1071.001",name:"Web Protocols",reference:"https://attack.mitre.org/techniques/T1071/001",tactics:"command-and-control",techniqueId:"T1071",value:"webProtocols"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.webServicesT1583Description",{defaultMessage:"Web Services (T1583.006)"}),id:"T1583.006",name:"Web Services",reference:"https://attack.mitre.org/techniques/T1583/006",tactics:"resource-development",techniqueId:"T1583",value:"webServices"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.webServicesT1584Description",{defaultMessage:"Web Services (T1584.006)"}),id:"T1584.006",name:"Web Services",reference:"https://attack.mitre.org/techniques/T1584/006",tactics:"resource-development",techniqueId:"T1584",value:"webServices"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.webSessionCookieT1550Description",{defaultMessage:"Web Session Cookie (T1550.004)"}),id:"T1550.004",name:"Web Session Cookie",reference:"https://attack.mitre.org/techniques/T1550/004",tactics:"defense-evasion,lateral-movement",techniqueId:"T1550",value:"webSessionCookie"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.webShellT1505Description",{defaultMessage:"Web Shell (T1505.003)"}),id:"T1505.003",name:"Web Shell",reference:"https://attack.mitre.org/techniques/T1505/003",tactics:"persistence",techniqueId:"T1505",value:"webShell"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.windowsCommandShellT1059Description",{defaultMessage:"Windows Command Shell (T1059.003)"}),id:"T1059.003",name:"Windows Command Shell",reference:"https://attack.mitre.org/techniques/T1059/003",tactics:"execution",techniqueId:"T1059",value:"windowsCommandShell"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.windowsCredentialManagerT1555Description",{defaultMessage:"Windows Credential Manager (T1555.004)"}),id:"T1555.004",name:"Windows Credential Manager",reference:"https://attack.mitre.org/techniques/T1555/004",tactics:"credential-access",techniqueId:"T1555",value:"windowsCredentialManager"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.windowsFileAndDirectoryPermissionsModificationT1222Description",{defaultMessage:"Windows File and Directory Permissions Modification (T1222.001)"}),id:"T1222.001",name:"Windows File and Directory Permissions Modification",reference:"https://attack.mitre.org/techniques/T1222/001",tactics:"defense-evasion",techniqueId:"T1222",value:"windowsFileAndDirectoryPermissionsModification"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.windowsManagementInstrumentationEventSubscriptionT1546Description",{defaultMessage:"Windows Management Instrumentation Event Subscription (T1546.003)"}),id:"T1546.003",name:"Windows Management Instrumentation Event Subscription",reference:"https://attack.mitre.org/techniques/T1546/003",tactics:"privilege-escalation,persistence",techniqueId:"T1546",value:"windowsManagementInstrumentationEventSubscription"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.windowsRemoteManagementT1021Description",{defaultMessage:"Windows Remote Management (T1021.006)"}),id:"T1021.006",name:"Windows Remote Management",reference:"https://attack.mitre.org/techniques/T1021/006",tactics:"lateral-movement",techniqueId:"T1021",value:"windowsRemoteManagement"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.windowsServiceT1543Description",{defaultMessage:"Windows Service (T1543.003)"}),id:"T1543.003",name:"Windows Service",reference:"https://attack.mitre.org/techniques/T1543/003",tactics:"persistence,privilege-escalation",techniqueId:"T1543",value:"windowsService"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.winlogonHelperDllT1547Description",{defaultMessage:"Winlogon Helper DLL (T1547.004)"}),id:"T1547.004",name:"Winlogon Helper DLL",reference:"https://attack.mitre.org/techniques/T1547/004",tactics:"persistence,privilege-escalation",techniqueId:"T1547",value:"winlogonHelperDll"},{label:S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.xdgAutostartEntriesT1547Description",{defaultMessage:"XDG Autostart Entries (T1547.013)"}),id:"T1547.013",name:"XDG Autostart Entries",reference:"https://attack.mitre.org/techniques/T1547/013",tactics:"persistence,privilege-escalation",techniqueId:"T1547",value:"xdgAutostartEntries"}],Fy=S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.filtersLabel",{defaultMessage:"Filters"}),_y=S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.QueryLabel",{defaultMessage:"Custom query"}),Ny=S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.threatQueryLabel",{defaultMessage:"Indicator index query"}),Ly=S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.savedIdLabel",{defaultMessage:"Saved query name"}),By=S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.mlRuleTypeDescription",{defaultMessage:"Machine Learning"}),zy=S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.eqlRuleTypeDescription",{defaultMessage:"Event Correlation"}),Hy=S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.queryRuleTypeDescription",{defaultMessage:"Query"}),Uy=S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.thresholdRuleTypeDescription",{defaultMessage:"Threshold"}),$y=S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.threatMatchRuleTypeDescription",{defaultMessage:"Indicator Match"}),Qy=S.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.mlJobStartedDescription",{defaultMessage:"Started"}),Vy=S.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.mlJobStoppedDescription",{defaultMessage:"Stopped"}),Wy=S.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.thresholdResultsAllDescription",{defaultMessage:"All results"}),Gy=S.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.thresholdResultsAggregatedByDescription",{defaultMessage:"Results aggregated by"});var Ky=a(944),Yy=a.n(Ky);const Jy=L()(_.EuiFlexItem).withConfig({displayName:"NoteDescriptionContainer",componentId:"sc-123zi2b-0"})(["height:105px;overflow-y:hidden;"]),Xy=e=>!Object(me.isEmpty)(e.join("")),Zy=L()(_.EuiBadge).withConfig({displayName:"EuiBadgeWrap",componentId:"sc-123zi2b-1"})([".euiBadge__text{white-space:pre-wrap !important;}"]),ev=L.a.div.withConfig({displayName:"Query",componentId:"sc-123zi2b-2"})(["white-space:pre-wrap;"]),tv=({field:e,filters:t,filterManager:a,query:n,savedId:r,indexPatterns:s,queryLabel:o})=>{let l=[];return Object(me.isEmpty)(t)||(a.setFilters(t),l=[...l,{title:i.a.createElement(i.a.Fragment,null,Fy," "),description:i.a.createElement(_.EuiFlexGroup,{wrap:!0,responsive:!1,gutterSize:"xs"},a.getFilters().map(((t,a)=>i.a.createElement(_.EuiFlexItem,{grow:!1,key:`${e}-filter-${a}`},i.a.createElement(Zy,{color:"hollow"},null!=s?i.a.createElement(xe.esFilters.FilterLabel,{filter:t,valueLabel:xe.esFilters.getDisplayValueFromFilter(t,[s])}):i.a.createElement(_.EuiLoadingSpinner,{size:"m"}))))))}]),Object(me.isEmpty)(n)||(l=[...l,{title:i.a.createElement(i.a.Fragment,null,null!=o?o:_y),description:i.a.createElement(ev,null,n)}]),Object(me.isEmpty)(r)||(l=[...l,{title:i.a.createElement(i.a.Fragment,null,Ly," "),description:i.a.createElement(i.a.Fragment,null,r," ")}]),l},av=L()(_.EuiFlexGroup).withConfig({displayName:"ThreatEuiFlexGroup",componentId:"sc-123zi2b-3"})([".euiFlexItem{margin-bottom:0px;}"]),nv=L()(_.EuiFlexItem).withConfig({displayName:"SubtechniqueFlexItem",componentId:"sc-123zi2b-4"})(["margin-left:",";"],(({theme:e})=>e.eui.paddingSizes.m)),iv=L()(_.EuiButtonEmpty).withConfig({displayName:"TechniqueLinkItem",componentId:"sc-123zi2b-5"})([".euiIcon{width:8px;height:8px;}align-self:flex-start;"]),rv=L()(_.EuiFlexItem).withConfig({displayName:"OverrideColumn",componentId:"sc-123zi2b-6"})(["width:125px;max-width:125px;overflow:hidden;text-overflow:ellipsis;"]),sv=L()(_.EuiLink).withConfig({displayName:"MyRefUrlLink",componentId:"sc-123zi2b-7"})(["word-break:break-word;"]);var ov,lv=a(76),cv=a(534);!function(e){e.info="info",e.warning="warning",e.error="error"}(ov||(ov={}));const uv=({message:e})=>{if(!e)return null;let t="primary",a="alert";return e.level===ov.info?a="iInCircle":e.level===ov.warning?t="warning":e.level===ov.error&&(t="danger"),i.a.createElement(_.EuiToolTip,{content:e.text},i.a.createElement(_.EuiIcon,{type:a,color:t}))},dv=i.a.memo(uv),pv=({job:e})=>{const t=Object(hb.c)(e.jobState,e.datafeedState),a=t?"secondary":"danger",n=t?Qy:Vy;return i.a.createElement(_.EuiBadge,{"data-test-subj":"machineLearningJobStatus",color:a},n)},mv=i.a.memo(pv),fv=L()(_.EuiLink).withConfig({displayName:"JobLink",componentId:"sc-c3w1h4-0"})(["margin-right:",";"],(({theme:e})=>e.eui.euiSizeS)),gv=L.a.div.withConfig({displayName:"Wrapper",componentId:"sc-c3w1h4-1"})(["overflow:hidden;"]),bv=({jobId:e})=>{const{jobs:t}=Object(cv.a)(!1),{services:{http:a,ml:n}}=Object(m.j)(),r=Object(lv.useMlHref)(n,a.basePath.get(),{page:lv.ML_PAGES.ANOMALY_DETECTION_JOBS_MANAGE,pageState:{jobId:[e]}}),s=t.find((({id:t})=>t===e)),o=i.a.createElement("span",{"data-test-subj":"machineLearningJobId"},e);return null!=s?i.a.createElement(gv,null,i.a.createElement("div",null,i.a.createElement(fv,{href:r,target:"_blank"},o),i.a.createElement(dv,{message:s.auditMessage})),i.a.createElement(mv,{job:s})):o},hv=i.a.memo(bv),yv=({jobIds:e})=>i.a.createElement(i.a.Fragment,null,e.map((e=>i.a.createElement(hv,{key:e,jobId:e})))),vv=({actions:e})=>e.length?i.a.createElement("ul",null,e.map(((e,t)=>i.a.createElement("li",{key:t},Ev(e.actionTypeId))))):null,Ev=e=>{if(!e)return"";const t=e.split(".")[1];return t?Object(me.startCase)(t):""};var Tv=a(124);const kv=[{value:o.Ab,text:"Perform no actions"},{value:o.Bb,text:"On each rule execution"},{value:"1h",text:"Hourly"},{value:"1d",text:"Daily"},{value:"7d",text:"Weekly"}],xv=kv[0],Sv=e=>{const{setValue:t}=e.field,a=Object(n.useCallback)((e=>{const a=e.target.value;t(a)}),[t]),r={...e.euiFieldProps,onChange:a};return i.a.createElement(Tv.e,F()({},e,{euiFieldProps:r}))},wv=(e=xv.value,t)=>{const a=Object(me.find)(["value",e],kv);return{title:t,description:a?a.text:e}},Ov=L()(_.EuiDescriptionList).withConfig({displayName:"DescriptionListContainer",componentId:"sc-1jqwta0-0"})(["&.euiDescriptionList--column .euiDescriptionList__title{width:30%;}&.euiDescriptionList--column .euiDescriptionList__description{width:70%;overflow-wrap:anywhere;}"]),jv=({data:e,columns:t="multi",indexPatterns:a,schema:r})=>{const s=Object(m.j)(),[o]=Object(n.useState)(new xe.FilterManager(s.services.uiSettings)),l=Object.keys(r).reduce(((t,n)=>{return"machineLearningJobId"===n?[...t,(s=Object(me.get)(n,e),l=Object(me.get)(n,r).label,{title:l,description:i.a.createElement(yv,{jobIds:s})})]:"throttle"===n?[...t,wv(Object(me.get)(n,e),Object(me.get)([n,"label"],r))]:"actions"===n?[...t,(c=Object(me.get)(n,e),u=Object(me.get)([n,"label"],r),{title:c.length?u:"",description:i.a.createElement(vv,{actions:c})})]:[...t,...Iv(e,Object(me.pick)(n,r),o,a)];var s,l,c,u}),[]);return"multi"===t?i.a.createElement(_.EuiFlexGroup,null,Object(me.chunk)(Math.ceil(l.length/2),l).map(((e,t)=>i.a.createElement(_.EuiFlexItem,{"data-test-subj":"listItemColumnStepRuleDescription",key:`description-step-rule-${t}`},i.a.createElement(_.EuiDescriptionList,{listItems:e}))))):i.a.createElement(_.EuiFlexGroup,null,i.a.createElement(_.EuiFlexItem,{"data-test-subj":"listItemColumnStepRuleDescription"},"single"===t?i.a.createElement(_.EuiDescriptionList,{listItems:l}):i.a.createElement(Ov,{"data-test-subj":"singleSplitStepRuleDescriptionList",type:"column",listItems:l})))},Cv=Object(n.memo)(jv),Iv=(e,t,a,n)=>Object.keys(t).reduce(((i,r)=>[...i,...Av(r,Object(me.get)([r,"label"],t),e,a,n)]),[]),Mv=e=>e.map((e=>null==e.$state?{$state:{store:xe.esFilters.FilterStateStore.APP_STATE},...e}:e)),Av=(e,t,a,n,r)=>{if("queryBar"===e){var s;const t=Mv(null!==(s=Object(me.get)("queryBar.filters",a))&&void 0!==s?s:[]),i=Object(me.get)("queryBar.query.query",a),o=Object(me.get)("queryBar.saved_id",a);return tv({field:e,filters:t,filterManager:n,query:i,savedId:o,indexPatterns:r})}if("threat"===e){const n=Object(me.get)(e,a);return(({label:e,threat:t})=>t.length>0?[{title:e,description:i.a.createElement(av,{direction:"column"},t.map(((e,t)=>{const a=Dy.find((t=>t.id===e.tactic.id));return i.a.createElement(_.EuiFlexItem,{key:`${e.tactic.name}-${t}`},i.a.createElement(_.EuiLink,{"data-test-subj":"threatTacticLink",href:e.tactic.reference,target:"_blank"},null!=a?a.text:`${e.tactic.name} (${e.tactic.id})`),i.a.createElement(_.EuiFlexGroup,{gutterSize:"none",alignItems:"flexStart",direction:"column"},e.technique&&e.technique.map(((e,t)=>{var a;const n=Py.find((t=>t.id===e.id));return i.a.createElement(_.EuiFlexItem,{key:null!==(a=null==n?void 0:n.id)&&void 0!==a?a:t},i.a.createElement(iv,{"data-test-subj":"threatTechniqueLink",href:e.reference,target:"_blank",iconType:Yy.a,size:"xs"},null!=n?n.label:`${e.name} (${e.id})`),i.a.createElement(_.EuiFlexGroup,{gutterSize:"none",alignItems:"flexStart",direction:"column"},null!=e.subtechnique&&e.subtechnique.map(((e,t)=>{var a;const n=Ry.find((t=>t.id===e.id));return i.a.createElement(nv,{key:null!==(a=null==n?void 0:n.id)&&void 0!==a?a:t},i.a.createElement(iv,{"data-test-subj":"threatSubtechniqueLink",href:e.reference,target:"_blank",iconType:Yy.a,size:"xs"},null!=n?n.label:`${e.name} (${e.id})`))}))))}))))})),i.a.createElement(_.EuiSpacer,null))}]:[])({label:t,threat:iy(n)})}if("threshold"===e){return((e,t)=>[{title:e,description:i.a.createElement(i.a.Fragment,null,Object(me.isEmpty)(t.field[0])?`${Wy} >= ${t.value}`:`${Gy} ${Array.isArray(t.field)?t.field.join(","):t.field} >= ${t.value}`)}])(t,Object(me.get)(e,a))}if("references"===e){return((e,t)=>Xy(t)?[{title:e,description:i.a.createElement(_.EuiText,{size:"s"},i.a.createElement("ul",null,t.filter((e=>!Object(me.isEmpty)(e))).map(((e,t)=>i.a.createElement("li",{"data-test-subj":"urlsDescriptionReferenceLinkItem",key:`${t}-${e}`},i.a.createElement(sv,{href:e,external:!0,target:"_blank"},e))))))}]:[])(t,Object(me.get)(e,a))}if("falsePositives"===e){return((e,t,a)=>Xy(a)?[{title:e,description:i.a.createElement(_.EuiText,{size:"s"},i.a.createElement("ul",null,a.map((e=>Object(me.isEmpty)(e)?null:i.a.createElement("li",{"data-test-subj":"unorderedListArrayDescriptionItem",key:`${t}-${e}`},e)))))}]:[])(t,e,Object(me.get)(e,a))}if(Array.isArray(Object(me.get)(e,a))&&"threatMapping"!==e){return((e,t,a)=>Xy(a)?[{title:e,description:i.a.createElement(_.EuiFlexGroup,{responsive:!1,gutterSize:"xs",wrap:!0},a.map((e=>Object(me.isEmpty)(e)?null:i.a.createElement(_.EuiFlexItem,{grow:!1,key:`${t}-${e}`},i.a.createElement(Zy,{"data-test-subj":"stringArrayDescriptionBadgeItem",color:"hollow"},e)))))}]:[])(t,e,Object(me.get)(e,a))}if("riskScore"===e){const t=Object(me.get)(e,a);return[{title:wy,description:(u=t).value},...u.isMappingChecked?u.mapping.filter((e=>""!==e.field)).map(((e,t)=>({title:0===t?Iy:"",description:i.a.createElement(_.EuiFlexGroup,{alignItems:"center"},i.a.createElement(rv,null,i.a.createElement(_.EuiToolTip,{content:e.field,"data-test-subj":`riskScoreOverrideField${t}`},i.a.createElement(i.a.Fragment,null,e.field))),i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(_.EuiIcon,{type:"sortRight"})),i.a.createElement(_.EuiFlexItem,null,"signal.rule.risk_score"))}))):[]]}if("severity"===e){const t=Object(me.get)(e,a);return c=t,[{title:yy,description:i.a.createElement(jb,{value:c.value})},...c.isMappingChecked?c.mapping.filter((e=>""!==e.field)).map(((e,t)=>({title:0===t?Ty:"",description:i.a.createElement(_.EuiFlexGroup,{alignItems:"center"},i.a.createElement(rv,null,i.a.createElement(_.EuiToolTip,{content:e.field,"data-test-subj":`severityOverrideField${t}`},i.a.createElement(i.a.Fragment,null,`${e.field}:`))),i.a.createElement(rv,null,i.a.createElement(_.EuiToolTip,{content:e.value,"data-test-subj":`severityOverrideValue${t}`},Object(wr.a)(e.value))),i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(_.EuiIcon,{type:"sortRight"})),i.a.createElement(_.EuiFlexItem,null,i.a.createElement(jb,{"data-test-subj":`severityOverrideSeverity${t}`,value:e.severity})))}))):[]]}if("timeline"===e){var o;return[{title:t,description:null!==(o=Object(me.get)(e,a).title)&&void 0!==o?o:Jh.b}]}if("note"===e){return((e,t)=>""!==t.trim()?[{title:e,description:i.a.createElement(Jy,null,i.a.createElement("div",{"data-test-subj":"noteDescriptionItem",className:"eui-yScrollWithShadows"},t))}]:[])(t,Object(me.get)(e,a))}if("ruleType"===e){return((e,t)=>{switch(t){case"machine_learning":return[{title:e,description:By}];case"query":case"saved_query":return[{title:e,description:Hy}];case"threshold":return[{title:e,description:Uy}];case"eql":return[{title:e,description:zy}];case"threat_match":return[{title:e,description:$y}];default:return Object(Qt.a)(t)}})(t,Object(me.get)(e,a))}if("kibanaSiemAppUrl"===e)return[];if("threatQueryBar"===e){var l;const t=Mv(null!==(l=Object(me.get)("threatQueryBar.filters",a))&&void 0!==l?l:[]),i=Object(me.get)("threatQueryBar.query.query",a),s=Object(me.get)("threatQueryBar.saved_id",a);return tv({field:e,filters:t,filterManager:n,query:i,savedId:s,indexPatterns:r,queryLabel:Ny})}if("threatMapping"===e){const n=Object(me.get)(e,a);return[{title:t,description:n.reduce(((e,t,a,{length:n})=>{const i=t.entries.reduce(((e,t,a,{length:n})=>1===n?`${t.field} ${fy} ${t.value}`:0===a?`(${t.field} ${fy} ${t.value})`:`${e} ${gy} (${t.field} ${fy} ${t.value})`),"");return 1===n?`${i}`:0===a?`(${i})`:`${e} ${by} (${i})`}),"")}]}var c,u;const d=Object(me.get)(e,a);return Object(me.isNumber)(d)||!Object(me.isEmpty)(d)?[{title:t,description:d}]:[]};var qv=a(622),Dv=a(389),Pv=a(479),Rv=a(390);const Fv=S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.importTimelineModalTitle",{defaultMessage:"Import query from saved timeline"}),_v=["duplicate","createFrom"],Nv=L()(_.EuiFormRow).withConfig({displayName:"StyledEuiFormRow",componentId:"sc-8c6vgp-0"})([".kbnTypeahead__items{max-height:45vh !important;}.globalQueryBar{padding:4px 0px 0px 0px;.kbnQueryBar{& > div:first-child{margin:0px 0px 0px 4px;}}}"]),Lv=({browserFields:e,dataTestSubj:t,field:a,idAria:r,indexPattern:s,isLoading:o=!1,onCloseTimelineSearch:l,openTimelineSearch:c=!1,resizeParentContainer:u,onValidityChange:d})=>{const{value:p,setValue:f}=a,[g,b]=Object(n.useState)(-1),[h,y]=Object(n.useState)(!1),[v,E]=Object(n.useState)(void 0),{isInvalid:T,errorMessage:k}=Object(Tv.j)(a),{uiSettings:x}=Object(m.j)().services,[S]=Object(n.useState)(new xe.FilterManager(x)),w=Object(Rv.a)();Object(n.useEffect)((()=>{null!=d&&d(!T)}),[T,d]),Object(n.useEffect)((()=>{let e=!0;const t=new or.Subscription;return S.setFilters([]),t.add(S.getUpdates$().subscribe({next:()=>{if(e){const e=S.getFilters(),{filters:t}=p;Ki()(t,e)||f({...p,filters:e})}}})),()=>{e=!1,t.unsubscribe()}}),[p,S,f]),Object(n.useEffect)((()=>{let e=!0;return async function(){const{filters:t,saved_id:a}=p;if(Ki()(t,S.getFilters())||S.setFilters(t),null!=a&&null!=v&&a!==v.id||null!=a&&null==v)try{const t=await w.getSavedQuery(a);e&&null!=t&&E(t)}catch{E(void 0)}else null==a&&null!=v&&E(void 0)}(),()=>{e=!1}}),[p,S,v,w]);const O=Object(n.useCallback)((e=>{const{query:t}=p;Ki()(t,e)||f({...p,query:e})}),[p,f]),j=Object(n.useCallback)((e=>{const{query:t}=p;Ki()(t,e)||f({...p,query:e})}),[p,f]),C=Object(n.useCallback)((e=>{if(null!=e){const{saved_id:a}=p;var t;if(e.id!==a)E(e),f({filters:null!==(t=e.attributes.filters)&&void 0!==t?t:[],query:e.attributes.query,saved_id:e.id});else E(e),f({filters:[],query:{query:"",language:"kuery"},saved_id:void 0})}}),[p,f]),I=Object(n.useCallback)((()=>{y(!0),l()}),[l]),M=Object(n.useCallback)((t=>{var a,n,i,r,o,l,c;y(!1);const u={query:null!==(a=null===(n=t.kqlQuery.filterQuery)||void 0===n||null===(i=n.kuery)||void 0===i?void 0:i.expression)&&void 0!==a?a:"",language:null!==(r=null===(o=t.kqlQuery.filterQuery)||void 0===o||null===(l=o.kuery)||void 0===l?void 0:l.kind)&&void 0!==r?r:"kuery"},d=null!=t.dataProviders&&t.dataProviders.length>0?Object(ps.a)(Object(Pe.g)(t.dataProviders,e),s):"",p=null!==(c=t.filters)&&void 0!==c?c:[];f({filters:""!==d?[...p,Object(Pv.b)(d)]:p,query:u,saved_id:void 0})}),[e,s,f]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(Nv,{label:a.label,labelAppend:a.labelAppend,helpText:a.helpText,error:k,isInvalid:T,fullWidth:!0,"data-test-subj":t,describedByIds:r?[r]:void 0},i.a.createElement(_.EuiMutationObserver,{observerOptions:{subtree:!0,attributes:!0,childList:!0},onMutation:()=>{if(null!=u){const e=document.getElementById("kbnTypeahead__items");if(null!=e){const t=e.getBoundingClientRect(),a=document.getElementById("define-rule");if(null!=a){const e=a.getBoundingClientRect();(-1===g||e.height<g+t.height)&&u(g+t.height-100),-1===g&&b(e.height)}}else u(-1)}}},(e=>i.a.createElement("div",{ref:e},i.a.createElement(Dv.a,{indexPattern:s,isLoading:o||h,isRefreshPaused:!1,filterQuery:p.query,filterManager:S,filters:S.getFilters()||[],onChangedQuery:j,onSubmitQuery:O,savedQuery:v,onSavedQuery:C,hideSavedQuery:!1}))))),c?i.a.createElement(qv.a,{hideActions:_v,modalTitle:Fv,onClose:I,onOpen:M}):null)},Bv=S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.eqlTypeTitle",{defaultMessage:"Event Correlation"}),zv=S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.eqlTypeDescription",{defaultMessage:"Use Event Query Language (EQL) to match events, generate sequences, and stack data"}),Hv=S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.queryTypeTitle",{defaultMessage:"Custom query"}),Uv=S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.queryTypeDescription",{defaultMessage:"Use KQL or Lucene to detect issues across indices."}),$v=S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.mlTypeTitle",{defaultMessage:"Machine Learning"}),Qv=S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.mlTypeDescription",{defaultMessage:"Select ML job to detect anomalous activity."}),Vv=S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.thresholdTypeTitle",{defaultMessage:"Threshold"}),Wv=S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.thresholdTypeDescription",{defaultMessage:"Aggregate query results to detect when number of matches exceeds threshold."}),Gv=S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.threatMatchTitle",{defaultMessage:"Indicator Match"}),Kv=S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.threatMatchDescription",{defaultMessage:"Use indicators from intelligence sources to detect matching events and alerts."}),Yv=L.a.span.withConfig({displayName:"SmallText",componentId:"sc-lss4m0-0"})(["font-size:",";"],(({theme:e})=>e.eui.euiFontSizeS)),Jv=({subscriptionUrl:e,hasValidLicense:t=!1})=>i.a.createElement(Yv,null,t?Qv:i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.mlTypeDisabledDescription",defaultMessage:"Access to ML requires a {subscriptionsLink}.",values:{subscriptionsLink:i.a.createElement(_.EuiLink,{href:e,target:"_blank"},i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.components.stepDefineRule.ruleTypeField.subscriptionsLink",defaultMessage:"Platinum subscription"}))}}));Jv.displayName="MlCardDescriptionComponent";const Xv=i.a.memo(Jv);Xv.displayName="MlCardDescription";const Zv=({describedByIds:e=[],field:t,isUpdateView:a,hasValidLicense:r,isMlAdmin:s})=>{const o=t.value,l=Object(n.useCallback)((e=>{t.setValue(e)}),[t]),c=Object(n.useCallback)((()=>l("eql")),[l]),u=Object(n.useCallback)((()=>l("machine_learning")),[l]),d=Object(n.useCallback)((()=>l("query")),[l]),p=Object(n.useCallback)((()=>l("threshold")),[l]),f=Object(n.useCallback)((()=>l("threat_match")),[l]),g=Object(m.j)().services.application.getUrlForApp("kibana",{path:"#/management/stack/license_management"}),b=Object(n.useMemo)((()=>({onClick:c,isSelected:Object(ti.c)(o)})),[o,c]),h=Object(n.useMemo)((()=>({onClick:d,isSelected:Object(ti.d)(o)})),[o,d]),y=Object(n.useMemo)((()=>({isDisabled:!r||!s,onClick:u,isSelected:Object(hb.d)(o)})),[o,u,r,s]),v=Object(n.useMemo)((()=>({onClick:p,isSelected:Object(ti.f)(o)})),[o,p]),E=Object(n.useMemo)((()=>({onClick:f,isSelected:Object(ti.e)(o)})),[o,f]);return i.a.createElement(_.EuiFormRow,{fullWidth:!0,"data-test-subj":"selectRuleType",describedByIds:e,label:t.label},i.a.createElement(_.EuiFlexGrid,{columns:3},(!a||h.isSelected)&&i.a.createElement(_.EuiFlexItem,null,i.a.createElement(_.EuiCard,{"data-test-subj":"customRuleType",title:Hv,titleSize:"xs",description:Uv,icon:i.a.createElement(_.EuiIcon,{size:"xl",type:"search"}),selectable:h,layout:"horizontal"})),(!a||y.isSelected)&&i.a.createElement(_.EuiFlexItem,null,i.a.createElement(_.EuiCard,{"data-test-subj":"machineLearningRuleType",title:$v,titleSize:"xs",description:i.a.createElement(Xv,{subscriptionUrl:g,hasValidLicense:r}),icon:i.a.createElement(_.EuiIcon,{size:"l",type:"machineLearningApp"}),isDisabled:y.isDisabled&&!y.isSelected,selectable:y,layout:"horizontal"})),(!a||v.isSelected)&&i.a.createElement(_.EuiFlexItem,null,i.a.createElement(_.EuiCard,{"data-test-subj":"thresholdRuleType",title:Vv,titleSize:"xs",description:Wv,icon:i.a.createElement(_.EuiIcon,{size:"l",type:"indexFlush"}),selectable:v,layout:"horizontal"})),(!a||b.isSelected)&&i.a.createElement(_.EuiFlexItem,null,i.a.createElement(_.EuiCard,{"data-test-subj":"eqlRuleType",title:Bv,titleSize:"xs",description:zv,icon:i.a.createElement(_.EuiIcon,{size:"l",type:"eql"}),selectable:b,layout:"horizontal"})),(!a||E.isSelected)&&i.a.createElement(_.EuiFlexItem,null,i.a.createElement(_.EuiCard,{"data-test-subj":"threatMatchRuleType",title:Gv,titleSize:"xs",description:Kv,icon:i.a.createElement(_.EuiIcon,{size:"l",type:"list"}),selectable:E,layout:"horizontal"}))))},eE=({describedByIds:e=[],field:t})=>{const a=t.value,r=Object(n.useCallback)((e=>{const a=Number(e.target.value);t.setValue(a)}),[t]);return i.a.createElement(_.EuiFormRow,{label:t.label,"data-test-subj":"anomalyThresholdSlider",describedByIds:e},i.a.createElement(_.EuiFlexGroup,null,i.a.createElement(_.EuiFlexItem,null,i.a.createElement(_.EuiRange,{value:a,onChange:r,fullWidth:!0,showInput:!0,showRange:!0,showTicks:!0,tickInterval:25}))))},tE=S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.customQueryFieldRequiredError",{defaultMessage:"A custom query is required."}),aE=S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.customQueryFieldInvalidError",{defaultMessage:"The KQL is invalid"}),nE=(S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.indicesFromConfigDescription",{defaultMessage:"Use Elasticsearch indices from Security Solution advanced settings"}),S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.indicesCustomDescription",{defaultMessage:"Provide custom list of indices"}),S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.indicesHelperDescription",{defaultMessage:"Enter the pattern of Elasticsearch indices where you would like this rule to run. By default, these will include index patterns defined in Security Solution advanced settings."})),iE=S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.resetDefaultIndicesButton",{defaultMessage:"Reset to default index patterns"}),rE=S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.importTimelineQueryButton",{defaultMessage:"Import query from saved timeline"}),sE=S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.mlJobSelectPlaceholderText",{defaultMessage:"Select a job"}),oE=S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldQuerBarLabel",{defaultMessage:"Custom query"}),lE=S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.EqlQueryBarLabel",{defaultMessage:"EQL query"}),cE=S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.threatMatchingIcesHelperDescription",{defaultMessage:"Select threat indices"}),uE=S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.customThreatQueryFieldRequiredError",{defaultMessage:"At least one indicator match is required."}),dE=S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.customThreatQueryFieldRequiredEmptyError",{defaultMessage:"All matches require both a field and threat index field."}),pE=L.a.div.withConfig({displayName:"HelpTextWarningContainer",componentId:"sc-v7btd6-0"})(["margin-top:10px;"]),mE=({href:e,notRunningJobIds:t})=>i.a.createElement(i.a.Fragment,null,i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.createRule.stepDefineRule.machineLearningJobIdHelpText",defaultMessage:"We've provided a few common jobs to get you started. To add your own custom jobs, assign a group of 'security' to those jobs in the {machineLearning} application to make them appear here.",values:{machineLearning:i.a.createElement(_.EuiLink,{href:e,target:"_blank"},i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.components.mlJobSelect.machineLearningLink",defaultMessage:"Machine Learning"}))}}),t.length>0&&i.a.createElement(pE,{"data-test-subj":"ml-warning-not-running-jobs"},i.a.createElement(_.EuiText,{size:"xs",color:"warning"},i.a.createElement(_.EuiIcon,{type:"alert"}),i.a.createElement("span",null,1===t.length?i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.createRule.stepDefineRule.mlEnableJobSingle",defaultMessage:"The selected ML job, {jobName}, is not currently running. Please set {jobName} to run via 'ML job settings' before activating this rule.",values:{jobName:t[0]}}):i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.createRule.stepDefineRule.mlEnableJobMulti",defaultMessage:"The selected ML jobs, {jobNames}, are not currently running. Please set all of these jobs to run via 'ML job settings' before activating this rule.",values:{jobNames:t.reduce(((e,t,a,n)=>e+(a<n.length-1?", ":", and ")+t))}}))))),fE=i.a.memo(mE),gE=L.a.div.withConfig({displayName:"JobDisplayContainer",componentId:"sc-1kiq2lp-0"})(["width:100%;height:100%;display:flex;flex-direction:column;"]),bE=L()(_.EuiFlexGroup).withConfig({displayName:"MlJobSelectEuiFlexGroup",componentId:"sc-1kiq2lp-1"})(["margin-bottom:5px;"]),hE=({id:e,description:t})=>i.a.createElement(gE,null,i.a.createElement("strong",null,e),i.a.createElement(_.EuiToolTip,{content:t},i.a.createElement(_.EuiText,{size:"xs",color:"subdued"},i.a.createElement("p",null,t)))),yE=e=>i.a.createElement(hE,{id:e.value.id,description:e.value.description}),vE=({describedByIds:e=[],field:t})=>{const a=t.value,{isInvalid:r,errorMessage:s}=Object(Tv.j)(t),{loading:o,jobs:l}=Object(cv.a)(!1),c=Object(m.j)().services.application.getUrlForApp("ml"),u=Object(n.useCallback)((e=>{const a=e.map((e=>e.value.id));t.setValue(a)}),[t]),d=l.map((e=>({value:{id:e.id,description:e.description},label:e.id}))),p=d.filter((e=>a.includes(e.value.id))),f=Object(n.useMemo)((()=>l.filter((({id:e})=>a.includes(e))).reduce(((e,t)=>(Object(hb.c)(t.jobState,t.datafeedState)||e.push(t.id),e)),[])),[l,a]);return i.a.createElement(bE,null,i.a.createElement(_.EuiFlexItem,null,i.a.createElement(_.EuiFormRow,{label:t.label,helpText:i.a.createElement(fE,{href:c,notRunningJobIds:f}),isInvalid:r,error:s,"data-test-subj":"mlJobSelect",describedByIds:e},i.a.createElement(_.EuiFlexGroup,null,i.a.createElement(_.EuiFlexItem,null,i.a.createElement(_.EuiComboBox,{isLoading:o,onChange:u,options:d,placeholder:sE,renderOption:yE,rowHeight:50,selectedOptions:p}))))))};var EE=a(625);const TE=L()(_.EuiFieldText).withConfig({displayName:"StyledEuiFieldText",componentId:"sc-oqcycb-0"})(["padding-left:12px;padding-right:40px;&[readonly]{cursor:pointer;background-size:0 100%;background-repeat:no-repeat;&:focus{background-color:#fff;background-image:linear-gradient( to top,#006bb4,#006bb4 2px,transparent 2px,transparent 100% );background-size:100% 100%;}}& + .euiFormControlLayoutIcons{left:unset;right:12px;}"]),kE=e=>[{description:Jh.a,favorite:[],label:Jh.b,id:void 0,title:Jh.b,checked:"-1"===e?"on":void 0}],xE=({isDisabled:e,hideUntitled:t=!1,timelineId:a,timelineTitle:r,timelineType:s=h.x.template,onTimelineChange:o})=>{const[l,c]=Object(n.useState)(!1),u=Object(n.useCallback)((()=>{c(!1)}),[]),d=Object(n.useCallback)((()=>{c(!0)}),[]),p=Object(n.useMemo)((()=>i.a.createElement(TE,{readOnly:!0,disabled:e,onFocus:d,value:null!=r?r:Jh.b,icon:"arrowDown"})),[d,e,r]),m=Object(n.useCallback)((({timelines:e,onlyFavorites:n,searchTimelineValue:i})=>[...n||""!==i?[]:kE(null==a?"-1":a),...e.filter((e=>!t||""!==e.title)).map(((e,t)=>({description:e.description,favorite:e.favorite,label:e.title,id:s===h.x.template?e.templateTimelineId:e.savedObjectId,key:`${e.title}-${t}`,title:e.title,checked:[e.savedObjectId,e.templateTimelineId].includes(a)?"on":void 0})))]),[t,a,s]);return i.a.createElement(_.EuiInputPopover,{id:"searchTimelinePopover",input:p,isOpen:l,closePopover:u},i.a.createElement(EE.a,{hideUntitled:t,getSelectableOptions:m,onClosePopover:u,onTimelineChange:o,timelineType:s}))},SE=Object(n.memo)(xE),wE=({dataTestSubj:e,field:t,idAria:a,isDisabled:r=!1})=>{const[s,o]=Object(n.useState)(null),[l,c]=Object(n.useState)(null),{isInvalid:u,errorMessage:d}=Object(Tv.j)(t);Object(n.useEffect)((()=>{const{id:e,title:a}=t.value;l!==a&&s!==e&&(o(e),c(a))}),[t.value]);const p=Object(n.useCallback)(((e,a)=>{null===a?t.setValue({id:a,title:null}):l!==e&&s!==a&&t.setValue({id:a,title:e})}),[t]);return i.a.createElement(_.EuiFormRow,{label:t.label,labelAppend:t.labelAppend,helpText:t.helpText,error:d,isInvalid:u,"data-test-subj":e,describedByIds:a?[a]:void 0},i.a.createElement(SE,{isDisabled:r,hideUntitled:!0,timelineId:s,timelineTitle:l,onTimelineChange:p}))},OE=L.a.div.withConfig({displayName:"StyledDiv",componentId:"sc-1adamx3-0"})(["padding-left:",";"],(({addPadding:e})=>e&&"53px"));OE.defaultProps={addPadding:!1};const jE=i.a.memo(OE);jE.displayName="StepContentWrapper";const CE=i.a.memo((({onClick:e,isDisabled:t,dataTestSubj:a="nextStep-continue"})=>i.a.createElement(i.a.Fragment,null,i.a.createElement(_.EuiHorizontalRule,{margin:"m"}),i.a.createElement(_.EuiFlexGroup,{alignItems:"center",justifyContent:"flexEnd",gutterSize:"xs",responsive:!1},i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(_.EuiButton,{fill:!0,onClick:e,isDisabled:t,"data-test-subj":a},Mn.I))))));CE.displayName="NextStep";var IE=a(620);const ME=S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.thresholdField.thresholdFieldPlaceholderText",{defaultMessage:"All results"}),AE=L()(_.EuiFlexItem).withConfig({displayName:"OperatorWrapper",componentId:"sc-10hzoxx-0"})(["align-self:center;"]),qE=["detectionEngineStepDefineRuleThresholdField"],DE=["detectionEngineStepDefineRuleThresholdValue"],PE=["detectionEngineStepDefineRuleThresholdCardinalityField"],RE=["detectionEngineStepDefineRuleThresholdCardinalityValue"],FE=({thresholdField:e,thresholdValue:t,browserFields:a,thresholdCardinalityField:r,thresholdCardinalityValue:s})=>{const o=Object(n.useMemo)((()=>({fullWidth:!0,noSuggestions:!1,options:Object(IE.a)(a),placeholder:ME,onCreateOption:void 0,style:{width:"410px"}})),[a]),l=Object(n.useMemo)((()=>({fullWidth:!0,noSuggestions:!1,options:Object(IE.a)(a),placeholder:ME,onCreateOption:void 0,style:{width:"410px"},singleSelection:{asPlainText:!0}})),[a]);return i.a.createElement(_.EuiFlexGroup,{direction:"column",style:{marginLeft:0}},i.a.createElement(_.EuiFlexGroup,null,i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(Tv.c,{field:e,idAria:qE[0],"data-test-subj":qE[0],describedByIds:qE,type:e.type,euiFieldProps:o})),i.a.createElement(AE,{grow:!1},">="),i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(Tv.c,{field:t,idAria:DE[0],"data-test-subj":DE[0],describedByIds:DE,type:t.type}))),i.a.createElement(_.EuiFlexGroup,null,i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(Tv.c,{field:r,idAria:PE[0],"data-test-subj":PE[0],describedByIds:PE,type:r.type,euiFieldProps:l})),i.a.createElement(AE,{grow:!1},">="),i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(Tv.c,{field:s,idAria:RE[0],"data-test-subj":RE[0],describedByIds:RE,type:s.type}))))},_E=i.a.memo(FE);var NE=a(232),LE=a(363);const BE=(e,t,a)=>a.reduce(((a,n,i)=>{const r=((e,t,a,n,i=Na.a.v4)=>{var r;const{fields:s}=e,{fields:o}=t,l=a.field,c=a.value,[u]=s.filter((({name:e})=>null!=l&&l===e)),[d]=o.filter((({name:e})=>null!=c&&c===e));return{id:null!==(r=a.id)&&void 0!==r?r:i(),field:u,type:"mapping",value:d,entryIndex:n}})(e,t,n,i);return[...a,r]}),[]),zE=()=>Object(LE.addIdToItem)({field:"",type:"mapping",value:""}),HE=(e,t)=>{let a;if(a="string"==typeof e?e===t:!!Array.isArray(e)&&!!e.find((e=>e===t)),a)return{code:"ERR_FIELD_FORMAT",message:S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.threatMatchIndexForbiddenError",{defaultMessage:"The index pattern cannot be { forbiddenString }. Please choose a more specific index pattern.",values:{forbiddenString:t}})}};var UE=a(353);const $E={index:{fieldsToValidateOnChange:["index","queryBar"],type:Tv.b.COMBO_BOX,label:S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fiedIndexPatternsLabel",{defaultMessage:"Index patterns"}),helpText:i.a.createElement(_.EuiText,{size:"xs"},nE),validations:[{validator:(...e)=>{const[{formData:t}]=e;if(!Object(hb.d)(t.ruleType))return Tv.i.emptyField(S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.outputIndiceNameFieldRequiredError",{defaultMessage:"A minimum of one index pattern is required."}))(...e)}}]},queryBar:{validations:[{validator:(...e)=>{const[{value:t,path:a,formData:n}]=e,{query:i,filters:r}=t;if(!Object(hb.d)(n.ruleType))return Object(lf.isEmpty)(i.query)&&Object(lf.isEmpty)(r)?{code:"ERR_FIELD_MISSING",path:a,message:tE}:void 0}},{validator:(...e)=>{const[{value:t,path:a,formData:n}]=e,{query:i}=t;if(!Object(hb.d)(n.ruleType)&&!Object(lf.isEmpty)(i.query)&&"kuery"===i.language)try{Object(NE.c)(i.query)}catch(e){return{code:"ERR_FIELD_FORMAT",path:a,message:aE}}}},{validator:Object(UE.a)(UE.b,300)}]},ruleType:{label:S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldRuleTypeLabel",{defaultMessage:"Rule type"}),validations:[]},anomalyThreshold:{label:S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldAnomalyThresholdLabel",{defaultMessage:"Anomaly score threshold"}),validations:[]},machineLearningJobId:{label:S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldMachineLearningJobIdLabel",{defaultMessage:"Machine Learning job"}),validations:[{validator:(...e)=>{const[{formData:t}]=e;if(Object(hb.d)(t.ruleType))return Tv.i.emptyField(S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.machineLearningJobIdRequired",{defaultMessage:"A Machine Learning job is required."}))(...e)}}]},timeline:{label:S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldTimelineTemplateLabel",{defaultMessage:"Timeline template"}),helpText:S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldTimelineTemplateHelpText",{defaultMessage:"Select which timeline to use when investigating generated alerts."})},threshold:{label:S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldThresholdLabel",{defaultMessage:"Threshold"}),field:{type:Tv.b.COMBO_BOX,label:S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldThresholdFieldLabel",{defaultMessage:"Group by"}),helpText:S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldThresholdFieldHelpText",{defaultMessage:"Select fields to group by. Fields are joined together with 'AND'"}),validations:[{validator:(...e)=>{const[{formData:t}]=e;if(Object(ti.f)(t.ruleType))return Tv.i.maxLengthField({length:3,message:S.i18n.translate("xpack.securitySolution.detectionEngine.validations.thresholdFieldFieldData.arrayLengthGreaterThanMaxErrorMessage",{defaultMessage:"Number of fields must be 3 or less."})})(...e)}}]},value:{type:Tv.b.NUMBER,label:S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldThresholdValueLabel",{defaultMessage:"Threshold"}),validations:[{validator:(...e)=>{const[{formData:t}]=e;if(Object(ti.f)(t.ruleType))return Tv.i.numberGreaterThanField({than:1,message:S.i18n.translate("xpack.securitySolution.detectionEngine.validations.thresholdValueFieldData.numberGreaterThanOrEqualOneErrorMessage",{defaultMessage:"Value must be greater than or equal to one."}),allowEquality:!0})(...e)}}]},cardinality:{field:{defaultValue:[],fieldsToValidateOnChange:["threshold.cardinality.field","threshold.cardinality.value"],type:Tv.b.COMBO_BOX,label:S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldThresholdCardinalityFieldLabel",{defaultMessage:"Count"}),validations:[{validator:(...e)=>{const[{formData:t}]=e;if(Object(ti.f)(t.ruleType))return Object(lf.isEmpty)(t["threshold.cardinality.field"])&&!Object(lf.isEmpty)(t["threshold.cardinality.value"])?Tv.i.emptyField(S.i18n.translate("xpack.securitySolution.detectionEngine.validations.thresholdCardinalityFieldFieldData.thresholdCardinalityFieldNotSuppliedMessage",{defaultMessage:"A Cardinality Field is required."}))(...e):void 0}}],helpText:S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldThresholdFieldCardinalityFieldHelpText",{defaultMessage:"Select a field to check cardinality"})},value:{fieldsToValidateOnChange:["threshold.cardinality.field","threshold.cardinality.value"],type:Tv.b.NUMBER,label:S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldThresholdCardinalityValueFieldLabel",{defaultMessage:"Unique values"}),validations:[{validator:(...e)=>{const[{formData:t}]=e;if(Object(ti.f)(t.ruleType))return Object(lf.isEmpty)(t["threshold.cardinality.field"])?void 0:Tv.i.numberGreaterThanField({than:1,message:S.i18n.translate("xpack.securitySolution.detectionEngine.validations.thresholdCardinalityValueFieldData.numberGreaterThanOrEqualOneErrorMessage",{defaultMessage:"Value must be greater than or equal to one."}),allowEquality:!0})(...e)}}]}}},threatIndex:{type:Tv.b.COMBO_BOX,label:S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldThreatIndexPatternsLabel",{defaultMessage:"Indicator index patterns"}),helpText:i.a.createElement(_.EuiText,{size:"xs"},cE),validations:[{validator:(...e)=>{const[{formData:t}]=e;if(Object(ti.e)(t.ruleType))return Tv.i.emptyField(S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.threatMatchoutputIndiceNameFieldRequiredError",{defaultMessage:"A minimum of one index pattern is required."}))(...e)}},{validator:(...e)=>{const[{formData:t,value:a}]=e;if(Object(ti.e)(t.ruleType))return HE(a,"*")}}]},threatMapping:{label:S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldThreatMappingLabel",{defaultMessage:"Indicator mapping"}),validations:[{validator:(...e)=>{const[{path:t,formData:a}]=e;var n;if(Object(ti.e)(a.ruleType))return 1===(n=a.threatMapping).length&&1===n[0].entries.length&&""===n[0].entries[0].field&&""===n[0].entries[0].value?{code:"ERR_FIELD_MISSING",path:t,message:uE}:(e=>e.some((e=>e.entries.some((e=>""===e.field||""===e.value)))))(a.threatMapping)?{code:"ERR_FIELD_MISSING",path:t,message:dE}:void 0}}]},threatQueryBar:{label:S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldThreatQueryBarLabel",{defaultMessage:"Indicator index query"}),validations:[{validator:(...e)=>{const[{value:t,path:a,formData:n}]=e;if(!Object(ti.e)(n.ruleType))return;const{query:i,filters:r}=t;return Object(lf.isEmpty)(i.query)&&Object(lf.isEmpty)(r)?{code:"ERR_FIELD_MISSING",path:a,message:tE}:void 0}},{validator:(...e)=>{const[{value:t,path:a,formData:n}]=e;if(!Object(ti.e)(n.ruleType))return;const{query:i}=t;if(!Object(lf.isEmpty)(i.query)&&"kuery"===i.language)try{Object(NE.c)(i.query)}catch(e){return{code:"ERR_FIELD_FORMAT",path:a,message:aE}}}}]}};var QE=a(528),VE=S.i18n.translate("autocomplete.loadingDescription",{defaultMessage:"Loading..."}),WE=S.i18n.translate("autocomplete.selectField",{defaultMessage:"Please select a field first..."}),GE=S.i18n.translate("autocomplete.fieldRequiredError",{defaultMessage:"Value cannot be empty"}),KE=S.i18n.translate("autocomplete.invalidNumberError",{defaultMessage:"Not a valid number"}),YE=S.i18n.translate("autocomplete.invalidDateError",{defaultMessage:"Not a valid date"}),JE=a(131),XE=a.n(JE),ZE=function(e){var t=e.getLabel,a=e.options,n=e.selectedOptions,i=a.map(t),r=i.map((function(e){return{label:e}})),s=n.map(t).filter((function(e){return-1!==i.indexOf(e)})).map((function(e){return r[i.indexOf(e)]}));return{comboOptions:r,labels:i,selectedComboOptions:s}},eT=a(74),tT={asPlainText:!0},aT=function(e){var t=e.fieldInputWidth,a=e.fieldTypeFilter,i=void 0===a?[]:a,r=e.indexPattern,s=e.isClearable,o=void 0!==s&&s,l=e.isDisabled,c=void 0!==l&&l,u=e.isLoading,d=void 0!==u&&u,p=e.isRequired,m=void 0!==p&&p,f=e.onChange,g=e.placeholder,b=e.selectedField,h=Object(n.useState)(!1),y=XE()(h,2),v=y[0],E=y[1],T=Object(n.useMemo)((function(){return nT(r,b,i)}),[r,b,i]),k=T.availableFields,x=T.selectedFields,S=Object(n.useMemo)((function(){return iT({availableFields:k,selectedFields:x})}),[k,x]),w=S.comboOptions,O=S.labels,j=S.selectedComboOptions,C=Object(n.useCallback)((function(e){var t=e.map((function(e){var t=e.label;return k[O.indexOf(t)]}));f(t)}),[k,O,f]),I=Object(n.useCallback)((function(){E(!0)}),[E]),M=Object(n.useMemo)((function(){return t?{width:"".concat(t,"px")}:{}}),[t]);return Object(eT.jsx)(_.EuiComboBox,{placeholder:g,options:w,selectedOptions:j,onChange:C,isLoading:d,isDisabled:c,isClearable:o,isInvalid:!!m&&(v&&null==b),onFocus:I,singleSelection:tT,"data-test-subj":"fieldAutocompleteComboBox",style:M,fullWidth:!0})};aT.displayName="Field";var nT=function(e,t,a){var n=rT(e),i=sT(t);return{availableFields:oT(n,i,a),selectedFields:i}},iT=function(e){var t=e.availableFields,a=e.selectedFields;return ZE({getLabel:function(e){return e.name},options:t,selectedOptions:a})},rT=function(e){return null!=e?e.fields:[]},sT=function(e){return e?[e]:[]},oT=function(e,t,a){var n=new Map;e.forEach((function(e){return n.set(e.name,e)})),t.forEach((function(e){return n.set(e.name,e)}));var i=Array.from(n.values());return a.length>0?i.filter((function(e){var t=e.type;return a.includes(t)})):i},lT=a(149),cT=a.n(lT),uT=a(123),dT=a.n(uT),pT=a(215),mT=a.n(pT),fT=a(216),gT=a.n(fT),bT=function(e){var t=e.selectedField,a=e.operatorType,i=e.fieldValue,r=e.query,s=e.indexPattern,o=e.autocompleteService,l=Object(n.useState)(!1),c=XE()(l,2),u=c[0],d=c[1],p=Object(n.useState)(!0),m=XE()(p,2),f=m[0],g=m[1],b=Object(n.useState)([]),h=XE()(b,2),y=h[0],v=h[1],E=Object(n.useRef)(null);return Object(n.useEffect)((function(){var e=!0,n=new AbortController,l=Object(lf.debounce)(function(){var t=mT()(gT.a.mark((function t(a){var i,r,s,l,c,u;return gT.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=a.fieldSelected,r=a.patterns,s=a.searchQuery,t.prev=1,!e){t.next=17;break}if(null!=i&&null!=r){t.next=5;break}return t.abrupt("return");case 5:if("boolean"!==i.type){t.next=8;break}return g(!1),t.abrupt("return");case 8:return d(!0),l=Object(NE.d)(i),c=l?dT()(dT()({},i),{},{name:"".concat(l.nested.path,".").concat(i.name)}):i,t.next=13,o.getValueSuggestions({field:c,indexPattern:r,query:s,signal:n.signal});case 13:0===(u=t.sent).length&&g(!1),d(!1),v(cT()(u));case 17:t.next=22;break;case 19:t.prev=19,t.t0=t.catch(1),e&&(v([]),d(!1));case 22:case"end":return t.stop()}}),t,null,[[1,19]])})));return function(e){return t.apply(this,arguments)}}(),500);return a!==Df.c.EXISTS&&l({fieldSelected:t,patterns:s,searchQuery:r,value:i}),E.current=l,function(){e=!1,n.abort()}}),[t,a,i,s,r,o]),[u,f,y,E.current]},hT=function(e,t,a,n){if(null!=t){var i=function(e,t,a,n){return a&&n&&(null==e||""===e.trim())?GE:null==t||a&&!n||!(a||null!=e&&""!==e)?void 0:null}(e,t,a,n);if(null!==i)return i;switch(t.type){case"date":var r=Kn.a.parse(null!=e?e:"");return Boolean(r&&r.isValid())?void 0:YE;case"number":return null!=e&&""!==e.trim()&&!isNaN(+e)?void 0:KE;default:return}}},yT=[{inputDisplay:"true",value:"true"},{inputDisplay:"false",value:"false"}],vT={asPlainText:!0},ET=function(e){var t=e.placeholder,a=e.rowLabel,i=e.selectedField,r=e.selectedValue,s=e.indexPattern,o=e.isLoading,l=e.isDisabled,c=void 0!==l&&l,u=e.isClearable,d=void 0!==u&&u,p=e.isRequired,m=void 0!==p&&p,f=e.fieldInputWidth,g=e.onChange,b=e.onError,h=e.autocompleteService,y=Object(n.useState)(""),v=XE()(y,2),E=v[0],T=v[1],k=Object(n.useState)(!1),x=XE()(k,2),S=x[0],w=x[1],O=Object(n.useState)(void 0),j=XE()(O,2),C=j[0],I=j[1],M=bT({autocompleteService:h,fieldValue:r,indexPattern:s,operatorType:Df.c.MATCH,query:E,selectedField:i}),A=XE()(M,3),q=A[0],D=A[1],P=A[2],R=Object(n.useCallback)((function(e){return e}),[]),F=Object(n.useMemo)((function(){var e=String(r);return null!=r&&""!==r.trim()?Object(lf.uniq)([e].concat(cT()(P))):P}),[P,r]),N=Object(n.useMemo)((function(){var e=String(r);return r?[e]:[]}),[r]),L=Object(n.useCallback)((function(e){I((function(t){var a=null!=e;return null!=t!==a&&null!=b&&b(a),e}))}),[I,b]),B=Object(n.useMemo)((function(){return ZE({getLabel:R,options:F,selectedOptions:N})}),[F,N,R]),z=B.comboOptions,H=B.labels,U=B.selectedComboOptions,$=Object(n.useCallback)((function(e){var t=e.map((function(e){var t=e.label;return F[H.indexOf(t)]})),a=XE()(t,1)[0];L(void 0),g(null!=a?a:"")}),[L,H,g,F]),Q=Object(n.useCallback)((function(e){if(""!==e&&null!=i){var t=hT(e,i,m,S);L(t),T(e)}}),[L,m,i,S]),V=Object(n.useCallback)((function(e){var t=hT(e,i,m,S);return L(t),null==t&&void g(e)}),[m,g,i,S,L]),W=Object(n.useCallback)((function(e){var t=e.target.value;g(t)}),[g]),G=Object(n.useCallback)((function(e){g(e)}),[g]),K=Object(n.useCallback)((function(){w(!0);var e=hT(r,i,m,!0);L(e)}),[w,L,r,i,m]),Y=Object(n.useMemo)((function(){return o||q?VE:null==i?WE:t}),[o,i,q,t]),J=Object(n.useMemo)((function(){return o||q}),[o,q]);Object(n.useEffect)((function(){I(void 0),null!=b&&b(!1)}),[i,b]);var X=Object(n.useMemo)((function(){return Object(eT.jsx)(_.EuiFormRow,{label:a,error:C,isInvalid:null!=i&&null!=C,"data-test-subj":"valuesAutocompleteMatchLabel",fullWidth:!0},Object(eT.jsx)(_.EuiComboBox,{placeholder:Y,isDisabled:c||!i,isLoading:J,isClearable:d,options:z,selectedOptions:U,onChange:$,singleSelection:vT,onSearchChange:Q,onCreateOption:V,isInvalid:null!=i&&null!=C,onBlur:K,sortMatchesBy:"startsWith","data-test-subj":"valuesAutocompleteMatch",style:f?{width:"".concat(f,"px")}:{},fullWidth:!0,async:!0}))}),[z,C,f,V,Q,$,Y,d,c,J,a,U,i,K]);if(D||null==i)return X;switch(i.type){case"number":return Object(eT.jsx)(_.EuiFormRow,{label:a,error:C,isInvalid:null!=i&&null!=C,"data-test-subj":"valuesAutocompleteMatchLabel",fullWidth:!0},Object(eT.jsx)(_.EuiFieldNumber,{placeholder:Y,onBlur:K,value:"string"==typeof r&&r.trim().length>0?parseFloat(r):null!=r?r:"",onChange:W,"data-test-subj":"valueAutocompleteFieldMatchNumber",style:f?{width:"".concat(f,"px")}:{},fullWidth:!0}));case"boolean":return Object(eT.jsx)(_.EuiFormRow,{label:a,error:C,isInvalid:null!=i&&null!=C,"data-test-subj":"valuesAutocompleteMatchLabel",fullWidth:!0},Object(eT.jsx)(_.EuiSuperSelect,{isLoading:J,options:yT,valueOfSelected:null!=r?r:"true",onChange:G,"data-test-subj":"valuesAutocompleteMatchBoolean",style:f?{width:"".concat(f,"px")}:{},fullWidth:!0}));default:return X}};ET.displayName="AutocompleteFieldMatch";var TT=a(233),kT={asPlainText:!0};(function(e){var t=e.isClearable,a=void 0!==t&&t,i=e.isDisabled,r=void 0!==i&&i,s=e.isLoading,o=void 0!==s&&s,l=e.onChange,c=e.operator,u=e.operatorOptions,d=e.operatorInputWidth,p=void 0===d?150:d,m=e.placeholder,f=e.selectedField,g=Object(n.useCallback)((function(e){return e.message}),[]),b=Object(n.useMemo)((function(){return null!=u&&u.length>0?u:null==(e=f)?[TT.o]:"boolean"===e.type?[TT.o,TT.n,TT.f,TT.e]:"nested"===e.type?[TT.o]:TT.b;var e}),[u,f]),h=Object(n.useMemo)((function(){return c?[c]:[]}),[c]),y=Object(n.useMemo)((function(){return ZE({getLabel:g,options:b,selectedOptions:h})}),[b,h,g]),v=y.comboOptions,E=y.labels,T=y.selectedComboOptions,k=Object(n.useCallback)((function(e){var t=e.map((function(e){var t=e.label;return b[E.indexOf(t)]}));l(t)}),[E,l,b]),x=Object(n.useMemo)((function(){return{width:"".concat(p,"px")}}),[p]);return Object(eT.jsx)(_.EuiComboBox,{placeholder:m,options:v,selectedOptions:T,onChange:k,isLoading:o,isDisabled:r,isClearable:a,singleSelection:kT,"data-test-subj":"operatorAutocompleteComboBox",style:x})}).displayName="Operator";const xT=L()(_.EuiFlexItem).withConfig({displayName:"FlexItemWithLabel",componentId:"sc-1i1appc-0"})(["padding-top:20px;text-align:center;"]),ST=L()(_.EuiFlexItem).withConfig({displayName:"FlexItemWithoutLabel",componentId:"sc-1i1appc-1"})(["text-align:center;"]),wT=({entry:e,indexPattern:t,threatIndexPatterns:a,showLabel:r,onChange:s})=>{const o=Object(n.useCallback)((([t])=>{const{updatedEntry:a,index:n}=((e,t)=>{const{entryIndex:a}=e;return{updatedEntry:{id:e.id,field:null!=t?t.name:"",type:"mapping",value:null!=e.value?e.value.name:""},index:a}})(e,t);s(a,n)}),[s,e]),l=Object(n.useCallback)((([t])=>{const{updatedEntry:a,index:n}=((e,t)=>{const{entryIndex:a}=e;return{updatedEntry:{id:e.id,field:null!=e.field?e.field.name:"",type:"mapping",value:null!=t?t.name:""},index:a}})(e,t);s(a,n)}),[s,e]),c=Object(n.useMemo)((()=>{const a=i.a.createElement(aT,{placeholder:my,indexPattern:t,selectedField:e.field,isClearable:!1,isLoading:!1,isDisabled:null==t,onChange:o,"data-test-subj":"entryField",fieldInputWidth:360});return r?i.a.createElement(_.EuiFormRow,{label:dy,"data-test-subj":"entryItemFieldInputFormRow"},a):i.a.createElement(_.EuiFormRow,{label:"","data-test-subj":"entryItemFieldInputFormRow"},a)}),[o,t,e,r]),u=Object(n.useMemo)((()=>{const t=i.a.createElement(aT,{placeholder:my,indexPattern:a,selectedField:e.value,isClearable:!1,isLoading:!1,isDisabled:null==a,onChange:l,"data-test-subj":"threatEntryField",fieldInputWidth:360});return r?i.a.createElement(_.EuiFormRow,{label:py,"data-test-subj":"threatFieldInputFormRow"},t):i.a.createElement(_.EuiFormRow,{label:"","data-test-subj":"threatFieldInputFormRow"},t)}),[l,a,e,r]);return i.a.createElement(_.EuiFlexGroup,{direction:"row",gutterSize:"s",alignItems:"center",justifyContent:"spaceAround","data-test-subj":"itemEntryContainer"},i.a.createElement(_.EuiFlexItem,{grow:!1},c),i.a.createElement(_.EuiFlexItem,{grow:!0},i.a.createElement(_.EuiFlexGroup,{justifyContent:"spaceAround",alignItems:"center"},r?i.a.createElement(xT,{grow:!0},fy):i.a.createElement(ST,{grow:!0},fy))),i.a.createElement(_.EuiFlexItem,{grow:!1},u))};wT.displayName="EntryItem";const OT=L()(_.EuiFlexItem).withConfig({displayName:"MyFirstRowContainer",componentId:"sc-136w498-0"})(["padding-top:20px;"]),jT=i.a.memo((({entries:e,isOnlyItem:t,entryIndex:a,itemIndex:r,onDelete:s})=>{const o=t&&1===e.length&&0===r&&(null==e[0].field||""===e[0].field),l=Object(n.useCallback)((()=>{s(a)}),[s,a]),c=i.a.createElement(_.EuiButtonIcon,{color:"danger",iconType:"trash",onClick:l,isDisabled:o,"aria-label":"entryDeleteButton",className:"itemEntryDeleteButton","data-test-subj":"itemEntryDeleteButton"});return 0===a&&0===r?i.a.createElement(OT,{grow:!1,"data-test-subj":"firstRowDeleteButton"},c):i.a.createElement(_.EuiFlexItem,{grow:!1,"data-test-subj":"deleteButton"},c)}));jT.displayName="EntryDeleteButton";var CT=a(256);const IT=L()(_.EuiFlexItem).withConfig({displayName:"MyInvisibleAndBadge",componentId:"sc-d6yaa8-0"})(["visibility:hidden;"]),MT=L()(_.EuiFlexItem).withConfig({displayName:"MyFirstRowContainer",componentId:"sc-d6yaa8-1"})(["padding-top:20px;"]),AT=i.a.memo((({entriesLength:e,entryItemIndex:t})=>{const a=i.a.createElement(CT.a,{includeAntennas:!0,type:"and"});return e>1&&0===t?i.a.createElement(MT,{grow:!1,"data-test-subj":"entryItemEntryFirstRowAndBadge"},a):e<=1?i.a.createElement(IT,{grow:!1,"data-test-subj":"entryItemEntryInvisibleAndBadge"},a):i.a.createElement(_.EuiFlexItem,{grow:!1,"data-test-subj":"entryItemEntryAndBadge"},a)}));AT.displayName="AndBadge";const qT=L()(_.EuiFlexItem).withConfig({displayName:"MyOverflowContainer",componentId:"sc-o1uavm-0"})(["overflow:hidden;width:100%;"]),DT=i.a.memo((({listItem:e,listItemIndex:t,indexPattern:a,threatIndexPatterns:r,isOnlyItem:s,andLogicIncluded:o,onDeleteEntryItem:l,onChangeEntryItem:c})=>{const u=Object(n.useCallback)(((a,n)=>{const i=[...e.entries.slice(0,n),{...a},...e.entries.slice(n+1)],r={...e,entries:i};c(r,t)}),[c,e,t]),d=Object(n.useCallback)((a=>{const n=((e,t)=>({...e,entries:[...e.entries.slice(0,t),...e.entries.slice(t+1)]}))(e,a);l(n,t)}),[e,l,t]),p=Object(n.useMemo)((()=>null!=a&&e.entries.length>0?BE(a,r,e.entries):[]),[e.entries,a,r]);return i.a.createElement(_.EuiFlexItem,null,i.a.createElement(_.EuiFlexGroup,{gutterSize:"s","data-test-subj":"entriesContainer"},o&&i.a.createElement(AT,{entriesLength:e.entries.length,entryItemIndex:t}),i.a.createElement(qT,{grow:6},i.a.createElement(_.EuiFlexGroup,{gutterSize:"s",direction:"column"},p.map(((n,o)=>i.a.createElement(_.EuiFlexItem,{key:n.id,grow:1},i.a.createElement(_.EuiFlexGroup,{gutterSize:"xs",alignItems:"center",direction:"row"},i.a.createElement(qT,{grow:1},i.a.createElement(wT,{entry:n,threatIndexPatterns:r,indexPattern:a,showLabel:0===t&&0===o,onChange:u})),i.a.createElement(jT,{entries:e.entries,isOnlyItem:s,entryIndex:n.entryIndex,itemIndex:t,onDelete:d})))))))))}));DT.displayName="ListItem";const PT=L()(_.EuiButton).withConfig({displayName:"MyEuiButton",componentId:"sc-1dsnlky-0"})(["min-width:95px;"]),RT=({isOrDisabled:e=!1,isAndDisabled:t=!1,onAndClicked:a,onOrClicked:n})=>i.a.createElement(_.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(PT,{fill:!0,size:"s",iconType:"plusInCircle",onClick:a,"data-test-subj":"andButton",isDisabled:t},gy)),i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(PT,{fill:!0,size:"s",iconType:"plusInCircle",onClick:n,isDisabled:e,"data-test-subj":"orButton"},by))),FT=L()(_.EuiFlexItem).withConfig({displayName:"MyInvisibleAndBadge",componentId:"sc-ph2s87-0"})(["visibility:hidden;"]),_T=L()(CT.a).withConfig({displayName:"MyAndBadge",componentId:"sc-ph2s87-1"})(["& > .euiFlexItem{margin:0;}"]),NT=L()(_.EuiFlexItem).withConfig({displayName:"MyButtonsContainer",componentId:"sc-ph2s87-2"})(["margin:16px 0;"]),LT={andLogicIncluded:!1,entries:[],entriesToDelete:[]},BT=({listItems:e,indexPatterns:t,threatIndexPatterns:a,onChange:r})=>{const[{entries:s,entriesToDelete:o,andLogicIncluded:l},c]=Object(n.useReducer)(((e,t)=>{switch(t.type){case"setEntries":{const a=t.entries.filter((({entries:e})=>e.length>1)).length>0;return{...e,andLogicIncluded:a,entries:t.entries}}case"setDefault":return{...e,...t.initialState,entries:[{...t.lastEntry,entries:[zE()]}]};default:return e}}),{...LT}),u=Object(n.useCallback)((e=>{c({type:"setEntries",entries:e})}),[c]),d=Object(n.useCallback)((e=>{c({type:"setDefault",initialState:LT,lastEntry:e})}),[c]),p=Object(n.useCallback)(((e,t)=>{const a=[...s.slice(0,t),{...e},...s.slice(t+1)];u(a)}),[u,s]),m=Object(n.useCallback)(((e,t)=>{if(0===e.entries.length){0===[...s.slice(0,t),...s.slice(t+1)].length?d(e):u([...s.slice(0,t),...s.slice(t+1)])}else p(e,t)}),[p,u,s,d]),f=Object(n.useCallback)((()=>{const e=s[s.length-1],{entries:t}=e,a={...e,entries:[...t,zE()]};u([...s.slice(0,s.length-1),{...a}])}),[u,s]),g=Object(n.useCallback)((()=>{const e=Object(LE.addIdToItem)({entries:[Object(LE.addIdToItem)({field:"",type:"mapping",value:""})]});u([...s,{...e}])}),[u,s]),b=Object(n.useCallback)((()=>{f()}),[f]);return Object(n.useEffect)((()=>{var e;r({entryItems:(e=s,e.reduce(((e,t)=>{const a={...t,entries:t.entries};return Mg.is(a)?[...e,a]:e}),[])),entriesToDelete:o})}),[r,o,s]),Object(n.useEffect)((()=>{(0===s.length||1===s.length&&null!=s[0].entries&&0===s[0].entries.length)&&g()}),[s,g]),Object(n.useEffect)((()=>{e.length>0&&u(e)}),[]),i.a.createElement(_.EuiFlexGroup,{gutterSize:"s",direction:"column"},s.map(((e,n)=>{var r;const o=null!==(r=e.id)&&void 0!==r?r:`${n}`;return i.a.createElement(_.EuiFlexItem,{grow:1,key:o},i.a.createElement(_.EuiFlexGroup,{gutterSize:"s",direction:"column"},0!==n&&(l?i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(_.EuiFlexGroup,{gutterSize:"none",direction:"row"},i.a.createElement(FT,{grow:!1},i.a.createElement(_T,{includeAntennas:!0,type:"and"})),i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(_T,{type:"or"})))):i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(_T,{type:"or"}))),i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(DT,{key:o,listItem:e,indexPattern:t,threatIndexPatterns:a,listItemIndex:n,andLogicIncluded:l,isOnlyItem:1===s.length,onDeleteEntryItem:m,onChangeEntryItem:p}))))})),i.a.createElement(NT,{"data-test-subj":"andOrOperatorButtons"},i.a.createElement(_.EuiFlexGroup,{gutterSize:"s"},l&&i.a.createElement(FT,{grow:!1},i.a.createElement(CT.a,{includeAntennas:!0,type:"and"})),i.a.createElement(_.EuiFlexItem,{grow:1},i.a.createElement(RT,{isOrDisabled:!1,isAndDisabled:!1,onOrClicked:g,onAndClicked:b})))))};BT.displayName="ThreatMatch";const zT=Object(Tv.k)({component:Tv.c}),HT=({threatIndexModified:e,handleResetThreatIndices:t,threatMapping:a,indexPatterns:r,threatIndexPatterns:s,threatIndexPatternsLoading:o,threatBrowserFields:l})=>{const{setValue:c,value:u}=a,{isInvalid:d,errorMessage:p}=Object(Tv.j)(a),m=Object(n.useCallback)((({entryItems:e})=>{c(e)}),[c]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(_.EuiSpacer,{size:"m"}),i.a.createElement(_.EuiFlexGroup,{direction:"column"},i.a.createElement(_.EuiFlexItem,{grow:!0},i.a.createElement(zT,{path:"threatIndex",config:{...$E.threatIndex,labelAppend:e?i.a.createElement(qk,{onClick:t,iconType:"refresh"},iE):null},componentProps:{idAria:"detectionEngineStepDefineRuleThreatMatchIndices","data-test-subj":"detectionEngineStepDefineRuleThreatMatchIndices",euiFieldProps:{fullWidth:!0,isDisabled:!1,placeholder:""}}})),i.a.createElement(_.EuiFlexItem,{grow:!0},i.a.createElement(Tv.f,{path:"threatQueryBar",config:{...$E.threatQueryBar,labelAppend:null},component:Lv,componentProps:{browserFields:l,idAria:"detectionEngineStepDefineThreatRuleQueryBar",indexPattern:s,isDisabled:!1,isLoading:o,dataTestSubj:"detectionEngineStepDefineThreatRuleQueryBar",openTimelineSearch:!1}}))),i.a.createElement(_.EuiSpacer,{size:"m"}),i.a.createElement(_.EuiFormRow,{label:a.label,labelAppend:a.labelAppend,helpText:a.helpText,error:p,isInvalid:d,fullWidth:!0},i.a.createElement(BT,{listItems:u,indexPatterns:r,threatIndexPatterns:s,"data-test-subj":"threatmatch-builder","id-aria":"threatmatch-builder",onChange:m})),i.a.createElement(_.EuiSpacer,{size:"m"}))},UT=i.a.memo(HT),$T=S.i18n.translate("xpack.securitySolution.stepDefineRule.previewQueryButton",{defaultMessage:"Preview results"}),QT=S.i18n.translate("xpack.securitySolution.stepDefineRule.previewQueryAriaLabel",{defaultMessage:"Query preview timeframe select"}),VT=S.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.queryPreviewLabel",{defaultMessage:"Quick query preview"}),WT=S.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.queryPreviewHelpText",{defaultMessage:"Select a timeframe of data to preview query results"}),GT=S.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.queryGraphCountLabel",{defaultMessage:"Count"}),KT=S.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.queryThresholdGraphCountLabel",{defaultMessage:"Cumulative Threshold Count"}),YT=S.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.queryGraphHitsTitle",{defaultMessage:"Hits"}),JT=e=>S.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.queryPreviewGraphTitle",{values:{hits:e},defaultMessage:"{hits} {hits, plural, =1 {hit} other {hits}}"}),XT=(S.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.queryGraphPreviewInspectTitle",{defaultMessage:"query preview"}),S.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.queryGraphPreviewNoiseWarning",{defaultMessage:"Noise warning: This rule may cause a lot of noise. Consider narrowing your query. This is based on a linear progression of 1 alert per hour."})),ZT=(S.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.queryNoHits",{defaultMessage:"No hits were found."}),S.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.queryGraphPreviewError",{defaultMessage:"Error fetching preview"})),ek=S.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.queryGraphDisclaimer",{defaultMessage:"Note: This preview excludes effects of rule exceptions and timestamp overrides."}),tk=S.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.queryGraphDisclaimerEql",{defaultMessage:"Note: This preview excludes effects of rule exceptions and timestamp overrides, and is limited to 100 results."}),ak=S.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.queryPreviewSubtitleLoading",{defaultMessage:"...loading"});S.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.queryPreviewEqlSequenceTitle",{defaultMessage:"No histogram available"}),S.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.queryPreviewEqlSequenceDescription",{defaultMessage:"No histogram is available at this time for EQL sequence queries. You can use the inspect in the top right corner to view query details."});var nk=a(32),ik=a(658);const rk=(e,t)=>"h"===t?e>1:"d"===t?e/24>1:"M"===t&&e/730>1,sk=(e,t,a=!1)=>({series:{xScaleType:fr.ScaleType.Time,yScaleType:fr.ScaleType.Linear,stackAccessors:["g"]},axis:{xTickFormatter:Object(gr.a)([e,t]),yTickFormatter:e=>e.toLocaleString(),tickSize:8},yAxisTitle:GT,settings:{legendPosition:fr.Position.Right,showLegend:a,showLegendExtra:a,theme:{scales:{barsPadding:.08},chartMargins:{left:0,right:0,top:0,bottom:0},chartPaddings:{left:0,right:0,top:0,bottom:0}}},customHeight:200}),ok=L()(_.EuiLoadingChart).withConfig({displayName:"LoadingChart",componentId:"sc-1sjd0mf-0"})(["display:block;margin:0 auto;"]),lk=({id:e,data:t,dataTestSubj:a,barConfig:n,title:r,subtitle:s,disclaimer:o,isLoading:l})=>i.a.createElement(i.a.Fragment,null,i.a.createElement(qs.a,{height:300,"data-test-subj":a},i.a.createElement(_.EuiFlexGroup,{gutterSize:"none",direction:"column"},i.a.createElement(_.EuiFlexItem,{grow:1},i.a.createElement(La.a,{id:e,title:r,titleSize:"xs",subtitle:s})),i.a.createElement(_.EuiFlexItem,{grow:1},l?i.a.createElement(ok,{size:"l","data-test-subj":"queryPreviewLoading"}):i.a.createElement(Sr.a,{configs:n,barChart:t,stackByField:void 0,timelineId:void 0,"data-test-subj":"sharedPreviewQueryHistogram"})),i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(i.a.Fragment,null,i.a.createElement(_.EuiSpacer,null),i.a.createElement(_.EuiText,{size:"s",color:"subdued"},i.a.createElement("p",null,o))))))),ck="queryEqlPreviewHistogramQuery",uk=({from:e,to:t,totalCount:a,data:r,inspect:s,refetch:o,isLoading:l})=>{const{setQuery:c,isInitializing:u}=Object(he.a)();Object(n.useEffect)((()=>{u||c({id:ck,inspect:s,loading:!1,refetch:o})}),[c,s,u,o]);const d=Object(n.useMemo)((()=>sk(t,e)),[e,t]),p=Object(n.useMemo)((()=>l?ak:JT(a)),[l,a]),m=Object(n.useMemo)((()=>[{key:"hits",value:r}]),[r]);return i.a.createElement(lk,{id:ck,data:m,barConfig:d,title:YT,subtitle:p,disclaimer:tk,isLoading:l,dataTestSubj:"queryPreviewEqlHistogram"})};var dk=a(25),pk=a(577),mk=a(86);const fk=(e,t)=>{const a=e.rawResponse.meta.request.params.body,n="string"==typeof a?JSON.parse(a):a;return{dsl:[JSON.stringify({...e.rawResponse.meta.request.params,index:t,body:n},null,2)],response:[JSON.stringify(e.rawResponse.body,null,2)]}},gk=(e,t,a,n,i,r)=>{const{dsl:s,response:o}=fk(e,i),l=Date.parse(a),c=hk(t,l),u=((e,t)=>{var a;const n=null!==(a=t.rawResponse.body.hits)&&void 0!==a?a:[];var i,r,s;return e?null!==(i=null===(r=n.sequences)||void 0===r?void 0:r.map((e=>e.events[e.events.length-1])))&&void 0!==i?i:[]:null!==(s=n.events)&&void 0!==s?s:[]})(r,e),d=e.rawResponse.body.hits.total.value,p=u.reduce(((e,a)=>{const n=a._source["@timestamp"];if(null==n)return e;const i=new Date(n).toISOString(),r=Date.parse(i),s="h"===t?((e,t)=>{const a=Math.abs(t-e),n=Math.floor(a/6e4);return 2*Math.ceil(n/2)})(r,l):((e,t)=>{const a=Math.abs(t-e),n=Math.floor(a/6e4);return Math.ceil(n/60)})(r,l);return null!=e[s]&&(e[s].total+=1),e}),c),m=Object.keys(p).map((e=>({x:Number(p[e].timestamp),y:p[e].total,g:"hits"}))),f=m.every((({y:e})=>0===e));return{data:m,totalCount:f?0:d,inspect:{dsl:s,response:o},refetch:n}},bk=(e,t,a)=>Array(t-e+1).fill(0).map(((t,n)=>e+n*a)),hk=(e,t)=>{switch(e){case"h":return bk(0,30,2).reduce(((e,a)=>({...e,[a]:{timestamp:Jn()(t).subtract(a,"m").format("x"),total:0}})),{});case"d":return bk(0,24,1).reduce(((e,a)=>({...e,[a]:{timestamp:Jn()(t).subtract(a,"h").format("x"),total:0}})),{});default:throw new RangeError('Invalid time range selected. Must be "Last hour" or "Last day".')}};var yk=a(87);const vk="queryPreviewThresholdHistogramQuery",Ek=({buckets:e,inspect:t,refetch:a,isLoading:r})=>{const{setQuery:s,isInitializing:o}=Object(he.a)();Object(n.useEffect)((()=>{r||o||s({id:vk,inspect:t,loading:r,refetch:a})}),[s,t,r,o,a]);const{data:l,totalCount:c}=Object(n.useMemo)((()=>{const t=e.length;return{data:[{key:"hits",value:e.map((({key:e,doc_count:t})=>({x:e,y:t,g:e})))}],totalCount:t}}),[e]),u=Object(n.useMemo)((()=>({series:{xScaleType:fr.ScaleType.Ordinal,yScaleType:fr.ScaleType.Linear,stackAccessors:["g"]},axis:{yTickFormatter:e=>e.toLocaleString(),tickSize:8},yAxisTitle:KT,settings:{legendPosition:fr.Position.Right,showLegend:!0,showLegendExtra:!0,theme:{scales:{barsPadding:.08},chartMargins:{left:0,right:0,top:0,bottom:0},chartPaddings:{left:0,right:0,top:0,bottom:0}}},customHeight:200})),[]),d=Object(n.useMemo)((()=>r?ak:(e=>S.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.queryPreviewGraphThresholdWithFieldTitle",{values:{buckets:e},defaultMessage:"{buckets} {buckets, plural, =1 {unique hit} other {unique hits}}"}))(c)),[r,c]);return i.a.createElement(lk,{id:vk,data:l,barConfig:u,title:YT,subtitle:d,disclaimer:ek,isLoading:r,dataTestSubj:"thresholdQueryPreviewHistogram"})};var Tk=a(262);const kk=()=>(e,t)=>{switch(t.type){case"setQueryInfo":if(null!=t.queryBar){const{queryString:a,language:n,filters:i,queryFilter:r}=((e,t,a)=>{const n="string"==typeof e.query.query?e.query.query:"",i=e.query.language,r=e.filters;try{return{queryString:n,language:i,filters:r,queryFilter:"eql"!==a?Object(ik.a)(n,i,r,t,[],!0):void 0}}catch{return{queryString:n,language:i,filters:r,queryFilter:void 0}}})(t.queryBar,t.index,t.ruleType);return{...e,queryString:a,language:n,filters:i,queryFilter:r,showHistogram:!1}}return{...e,showHistogram:!1};case"setTimeframeSelect":return{...e,timeframe:t.timeframe,showHistogram:!1,warnings:[]};case"setResetRuleTypeChange":{const n="query"===t.ruleType||"saved_query"===t.ruleType||"threshold"===t.ruleType&&!e.thresholdFieldExists;return{...e,showHistogram:!1,timeframe:"h",timeframeOptions:(a=t.ruleType,"eql"===a?[{value:"h",text:"Last hour"},{value:"d",text:"Last day"}]:[{value:"h",text:"Last hour"},{value:"d",text:"Last day"},{value:"M",text:"Last month"}]),showNonEqlHistogram:n,warnings:[]}}case"setWarnings":return{...e,warnings:t.warnings};case"setShowHistogram":return{...e,showHistogram:t.show};case"setThresholdQueryVals":{const a=null!=t.threshold&&null!=t.threshold.field&&t.threshold.field.length>0&&t.threshold.field.every((e=>""!==e.trim())),n="query"===t.ruleType||"saved_query"===t.ruleType||"threshold"===t.ruleType&&!a;return{...e,thresholdFieldExists:a,showNonEqlHistogram:n,showHistogram:!1,warnings:[]}}case"setToFrom":return{...e,fromTime:Object(Tk.c)("now"),toTime:Object(Tk.c)(`now-1${e.timeframe}`)};case"setNoiseWarning":return{...e,warnings:[...e.warnings,XT]};default:return e}var a},xk="queryPreviewCustomHistogramQuery",Sk=({to:e,from:t,data:a,totalCount:r,inspect:s,refetch:o,isLoading:l})=>{const{setQuery:c,isInitializing:u}=Object(he.a)();Object(n.useEffect)((()=>{l||u||c({id:xk,inspect:s,loading:l,refetch:o})}),[c,s,l,u,o]);const d=Object(n.useMemo)((()=>sk(e,t,!0)),[t,e]),p=Object(n.useMemo)((()=>l?ak:JT(r)),[l,r]),m=Object(n.useMemo)((()=>[{key:"hits",value:a}]),[a]);return i.a.createElement(lk,{id:xk,data:m,barConfig:d,title:YT,subtitle:p,disclaimer:ek,isLoading:l,dataTestSubj:"queryPreviewCustomHistogram"})},wk=L()(_.EuiSelect).withConfig({displayName:"Select",componentId:"sc-111a7av-0"})(["width:",";"],(({theme:e})=>e.eui.euiSuperDatePickerWidth)),Ok=L()(_.EuiButton).withConfig({displayName:"PreviewButton",componentId:"sc-111a7av-1"})(["margin-left:0;"]),jk={timeframeOptions:[],showHistogram:!1,timeframe:"h",warnings:[],queryFilter:void 0,toTime:"",fromTime:"",queryString:"",language:"kuery",filters:[],thresholdFieldExists:!1,showNonEqlHistogram:!1},Ck=({ruleType:e,dataTestSubj:t,idAria:a,query:r,index:s,threshold:o,isDisabled:l})=>{const[c,u,{totalCount:d,data:p,refetch:f,inspect:g}]=(()=>{const{data:e}=Object(m.j)().services,t=Object(n.useRef)(me.noop),a=Object(n.useRef)(new AbortController),i=Object(n.useRef)(new or.Subject),[r,s]=Object(n.useState)(!1),o=Object(n.useRef)(!1),{addError:l,addWarning:c}=Object(Oe.a)(),[u,d]=Object(n.useState)({data:[],inspect:{dsl:[],response:[]},refetch:t.current,totalCount:0}),p=Object(n.useCallback)((({from:n,to:r,query:u,index:p,interval:m})=>{if(null==Object(Uf.a)(r)||null==Object(Uf.a)(n))return void c(pk.d);const f=async()=>{a.current=new AbortController,s(!0),d((e=>({...e,data:[],inspect:{dsl:[],response:[]},totalCount:0}))),e.search.search({params:{index:p.join(),body:{filter:{range:{"@timestamp":{gte:n,lte:r,format:"strict_date_optional_time"}}},query:u,size:100}}},{strategy:yk.EQL_SEARCH_STRATEGY,abortSignal:a.current.signal}).pipe(Object(dk.takeUntil)(i.current)).subscribe({next:e=>{Object(zl.isCompleteResponse)(e)?(o.current||(s(!1),d((a=>{const{inspect:n,...i}=gk(e,m,r,t.current,p,Object(ti.b)(u)),s=a.inspect.dsl[0]?a.inspect.dsl:n.dsl,o=a.inspect.response[0]?a.inspect.response:n.response;return{...a,...i,inspect:{dsl:s,response:o}}}))),i.current.next()):Object(zl.isPartialResponse)(e)?d((t=>({...t,inspect:fk(e,p)}))):Object(zl.isErrorResponse)(e)&&(s(!1),c(pk.c),i.current.next())},error:e=>{e instanceof mk.AbortError||(s(!1),d({data:[],inspect:{dsl:[],response:[]},refetch:t.current,totalCount:0}),l(e,{title:pk.c}))}})};a.current.abort(),f(),t.current=f}),[e.search,l,c]);return Object(n.useEffect)((()=>()=>{o.current=!0,a.current.abort(),i.current.complete()}),[]),[r,p,u]})(),[{thresholdFieldExists:b,showNonEqlHistogram:h,timeframeOptions:y,showHistogram:v,timeframe:E,warnings:T,queryFilter:k,toTime:x,fromTime:S,queryString:w},O]=Object(n.useReducer)(kk(),{...jk,toTime:Object(Tk.c)("now-1h"),fromTime:Object(Tk.c)("now")}),[j,{inspect:C,totalCount:I,refetch:M,data:A,buckets:q},D]=Object($m.a)({errorMessage:ZT,endDate:S,startDate:x,filterQuery:k,indexNames:s,includeMissingData:!1,histogramType:nk.c.events,stackByField:"event.category",threshold:"threshold"===e?o:void 0,skip:!0}),P=Object(n.useCallback)(((e,t,a)=>{O({type:"setQueryInfo",queryBar:e,index:t,ruleType:a})}),[O]),R=Object(n.useRef)(Object(me.debounce)(500,P)),F=Object(n.useCallback)((e=>{O({type:"setTimeframeSelect",timeframe:e})}),[O]),N=Object(n.useCallback)((e=>{O({type:"setResetRuleTypeChange",ruleType:e})}),[O]),L=Object(n.useCallback)((e=>{O({type:"setWarnings",warnings:e})}),[O]),B=Object(n.useCallback)((()=>{O({type:"setNoiseWarning"})}),[O]),z=Object(n.useCallback)((e=>{O({type:"setShowHistogram",show:e})}),[O]),H=Object(n.useCallback)(((e,t)=>{O({type:"setThresholdQueryVals",threshold:e,ruleType:t})}),[O]);Object(n.useEffect)((()=>{R.current(r,s,e)}),[s,r,e]),Object(n.useEffect)((()=>{H(o,e)}),[H,o,e]),Object(n.useEffect)((()=>{N(e)}),[e,N]),Object(n.useEffect)((()=>{switch(e){case"eql":rk(d,E)&&B();break;case"threshold":const e=b?q.length:I;rk(e,E)&&B();break;default:rk(I,E)&&B()}}),[E,I,d,e,B,b,q.length]);const U=Object(n.useCallback)(((e,t)=>{u({index:s,query:w,from:t,to:e,interval:E})}),[u,s,w,E]),$=Object(n.useCallback)((({target:{value:e}})=>{F(e)}),[F]),Q=Object(n.useCallback)((()=>{const t=Object(Tk.c)("now"),a=Object(Tk.c)(`now-1${E}`);L([]),z(!0),"eql"===e?U(t,a):D(t,a)}),[L,z,e,U,D,E]),V=Object(n.useMemo)((()=>j||c||l||null==r||null!=r&&""===r.query.query&&0===r.filters.length),[c,l,j,r]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(_.EuiFormRow,{label:VT,helpText:WT,error:void 0,isInvalid:!1,"data-test-subj":t,describedByIds:a?[a]:void 0},i.a.createElement(_.EuiFlexGroup,null,i.a.createElement(_.EuiFlexItem,{grow:1},i.a.createElement(wk,{id:"queryPreviewSelect",options:y,value:E,onChange:$,"aria-label":QT,disabled:l,"data-test-subj":"queryPreviewTimeframeSelect"})),i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(Ok,{fill:!0,isDisabled:V,onClick:Q,"data-test-subj":"queryPreviewButton"},$T)))),i.a.createElement(_.EuiSpacer,{size:"s"}),h&&v&&i.a.createElement(Sk,{to:x,from:S,data:A,totalCount:I,inspect:C,refetch:M,isLoading:j}),"threshold"===e&&b&&v&&i.a.createElement(Ek,{isLoading:j,buckets:q,inspect:C,refetch:M}),"eql"===e&&v&&i.a.createElement(uk,{to:x,from:S,totalCount:d,data:p,inspect:g,refetch:f,isLoading:c}),v&&T.length>0&&T.map(((e,t)=>i.a.createElement(n.Fragment,{key:`${e}-${t}`},i.a.createElement(_.EuiSpacer,{size:"s"}),i.a.createElement(_.EuiCallOut,{color:"warning",iconType:"help","data-test-subj":"previewQueryWarning"},i.a.createElement(_.EuiText,null,i.a.createElement("p",null,e)))))))},Ik=Object(Tv.k)({component:Tv.c}),Mk={anomalyThreshold:50,index:[],machineLearningJobId:[],ruleType:"query",threatIndex:[],queryBar:{query:{query:"",language:"kuery"},filters:[],saved_id:void 0},threatQueryBar:{query:{query:o.S,language:"kuery"},filters:[],saved_id:void 0},threatMapping:[],threshold:{field:[],value:"200",cardinality:{field:[],value:""}},timeline:{id:null,title:Jh.b}},Ak={...Mk.queryBar,query:{...Mk.queryBar.query,query:"*:*"}},qk=L()(_.EuiButtonEmpty).withConfig({displayName:"MyLabelButton",componentId:"sc-f0vskm-0"})(["height:18px;font-size:12px;.euiIcon{width:14px;height:14px;}"]);qk.defaultProps={flush:"right"};const Dk=L()(_.EuiFormRow).attrs((({$isVisible:e})=>({style:{display:e?"flex":"none"}}))).withConfig({displayName:"RuleTypeEuiFormRow",componentId:"sc-f0vskm-1"})([""]),Pk=({addPadding:e=!1,defaultValues:t,descriptionColumns:a="singleSplit",isReadOnlyView:r,isLoading:s,isUpdateView:l=!1,onSubmit:c,setForm:u})=>{const d=Object(Qi.a)(),[p,f]=Object(n.useState)(!1),[g,b]=Object(n.useState)(!1),[h,y]=Object(n.useState)(!1),[v]=Object(m.o)(o.F),[E]=Object(m.o)(o.R),T=null!=t?t:{...Mk,index:v,threatIndex:E},{form:k}=Object(Tv.l)({defaultValue:T,options:{stripEmptyFields:!1},schema:$E}),{getFields:x,getFormData:S,reset:w,submit:O}=k,[{index:j,ruleType:C,queryBar:I,threatIndex:M,threshold:A}]=Object(Tv.n)({form:k,watch:["index","ruleType","queryBar","threshold","threshold.field","threshold.value","threshold.cardinality.field","threshold.cardinality.value","threatIndex"]}),[q,D]=Object(n.useState)(!1),P=j||T.index,R=M||T.threatIndex,F=C||T.ruleType,[N,{browserFields:L,indexPatterns:B}]=Object(op.b)(P),z=Object.entries(L).reduce(((e,[t,a])=>{var n;return{...e,[t]:{fields:Object.entries(null!==(n=a.fields)&&void 0!==n?n:{}).reduce(((e,[t,a])=>(!0===a.aggregatable&&(e[t]=a),e)),{})}}}),{}),[H,{browserFields:U,indexPatterns:$}]=Object(op.b)(R);Object(n.useEffect)((()=>{w({resetValues:!1})}),[w,F]),Object(n.useEffect)((()=>{b(!Object(lf.isEqual)(P,v))}),[P,v]),Object(n.useEffect)((()=>{y(!Object(lf.isEqual)(R,E))}),[R,E]),Object(n.useEffect)((()=>{const{queryBar:e}=x();if(null!=e){const{queryBar:t}=Mk;Object(ti.e)(F)&&e.value===t?e.reset({defaultValue:Ak}):e.value===Ak&&e.reset({defaultValue:t})}}),[F,x]);const Q=Object(n.useCallback)((()=>{c&&c()}),[c]),V=Object(n.useCallback)((async()=>{const e=await O();return e.isValid?e:{isValid:!1,data:S()}}),[S,O]);Object(n.useEffect)((()=>{let e=!1;return u&&!e&&u(uy.a.defineRule,V),()=>{e=!0}}),[V,u]);const W=Object(n.useCallback)((()=>{x().index.setValue(v)}),[x,v]),G=Object(n.useCallback)((()=>{x().threatIndex.setValue(E)}),[x,E]),K=Object(n.useCallback)((()=>{f(!0)}),[]),Y=Object(n.useCallback)((()=>{f(!1)}),[]),J=Object(n.useCallback)((({thresholdField:e,thresholdValue:t,thresholdCardinalityField:a,thresholdCardinalityValue:n})=>i.a.createElement(_E,{browserFields:z,thresholdField:e,thresholdValue:t,thresholdCardinalityField:a,thresholdCardinalityValue:n})),[z]),X=Object(n.useCallback)((({threatMapping:e})=>i.a.createElement(UT,{handleResetThreatIndices:G,indexPatterns:B,threatBrowserFields:U,threatIndexModified:h,threatIndexPatterns:$,threatIndexPatternsLoading:H,threatMapping:e})),[G,B,U,h,$,H]);return r?i.a.createElement(jE,{"data-test-subj":"definitionRule",addPadding:e},i.a.createElement(Cv,{columns:a,indexPatterns:B,schema:ay($E,F),data:ay(T,F)})):i.a.createElement(i.a.Fragment,null,i.a.createElement(jE,{addPadding:!l},i.a.createElement(Tv.d,{form:k,"data-test-subj":"stepDefineRule"},i.a.createElement(Tv.f,{path:"ruleType",component:Zv,componentProps:{describedByIds:["detectionEngineStepDefineRuleType"],isUpdateView:l,hasValidLicense:Object(Vb.a)(d),isMlAdmin:Object(Qb.a)(d)}}),i.a.createElement(Dk,{$isVisible:!Object(hb.d)(F),fullWidth:!0},i.a.createElement(i.a.Fragment,null,i.a.createElement(Ik,{path:"index",config:{...$E.index,labelAppend:g?i.a.createElement(qk,{onClick:W,iconType:"refresh"},iE):null},componentProps:{idAria:"detectionEngineStepDefineRuleIndices","data-test-subj":"detectionEngineStepDefineRuleIndices",euiFieldProps:{fullWidth:!0,placeholder:""}}}),Object(ti.c)(F)?i.a.createElement(Tv.f,{key:"EqlQueryBar",path:"queryBar",component:QE.a,componentProps:{onValidityChange:D,idAria:"detectionEngineStepDefineRuleEqlQueryBar",isDisabled:s,isLoading:N,dataTestSubj:"detectionEngineStepDefineRuleEqlQueryBar"},config:{...$E.queryBar,label:lE}}):i.a.createElement(Tv.f,{key:"QueryBarDefineRule",path:"queryBar",config:{...$E.queryBar,label:oE,labelAppend:i.a.createElement(qk,{"data-test-subj":"importQueryFromSavedTimeline",onClick:K},rE)},component:Lv,componentProps:{browserFields:L,idAria:"detectionEngineStepDefineRuleQueryBar",indexPattern:B,isDisabled:s,isLoading:N,dataTestSubj:"detectionEngineStepDefineRuleQueryBar",openTimelineSearch:p,onValidityChange:D,onCloseTimelineSearch:Y}}))),i.a.createElement(Dk,{$isVisible:Object(hb.d)(F),fullWidth:!0},i.a.createElement(i.a.Fragment,null,i.a.createElement(Tv.f,{path:"machineLearningJobId",component:vE,componentProps:{describedByIds:["detectionEngineStepDefineRulemachineLearningJobId"]}}),i.a.createElement(Tv.f,{path:"anomalyThreshold",component:eE,componentProps:{describedByIds:["detectionEngineStepDefineRuleAnomalyThreshold"]}}))),i.a.createElement(Dk,{$isVisible:Object(ti.f)(F),"data-test-subj":"thresholdInput",fullWidth:!0},i.a.createElement(i.a.Fragment,null,i.a.createElement(Tv.g,{fields:{thresholdField:{path:"threshold.field"},thresholdValue:{path:"threshold.value"},thresholdCardinalityField:{path:"threshold.cardinality.field"},thresholdCardinalityValue:{path:"threshold.cardinality.value"}}},J))),i.a.createElement(Dk,{$isVisible:Object(ti.e)(F),"data-test-subj":"threatMatchInput",fullWidth:!0},i.a.createElement(i.a.Fragment,null,i.a.createElement(Tv.g,{fields:{threatMapping:{path:"threatMapping"}}},X))),i.a.createElement(Tv.f,{path:"timeline",component:wE,componentProps:{idAria:"detectionEngineStepDefineRuleTimeline",isDisabled:s,dataTestSubj:"detectionEngineStepDefineRuleTimeline"}})),"machine_learning"!==F&&"threat_match"!==F&&i.a.createElement(i.a.Fragment,null,i.a.createElement(_.EuiSpacer,{size:"s"}),i.a.createElement(Ck,{dataTestSubj:"ruleCreationQueryPreview",idAria:"ruleCreationQueryPreview",ruleType:F,index:P,query:I,isDisabled:!q||0===P.length,threshold:A}))),!l&&i.a.createElement(CE,{dataTestSubj:"define-continue",onClick:Q,isDisabled:s}))},Rk=Object(n.memo)(Pk),Fk=L()(_.EuiFormRow).withConfig({displayName:"MyEuiFormRow",componentId:"sc-1urlknr-0"})([".euiFormRow__labelWrapper{.euiText{padding-right:32px;}}"]),_k=L()(_.EuiButtonEmpty).withConfig({displayName:"MyAddItemButton",componentId:"sc-1urlknr-1"})(["margin:4px 0px;&.euiButtonEmpty--small{font-size:12px;}.euiIcon{width:12px;height:12px;}"]);_k.defaultProps={flush:"left",iconType:"plusInCircle",size:"s"};const Nk=({addText:e,dataTestSubj:t,field:a,idAria:r,isDisabled:s,validate:o})=>{const[l,c]=Object(n.useState)(!1),{isInvalid:u,errorMessage:d}=Object(Tv.j)(a),[p,m]=Object(n.useState)(-1),f=Object(n.useRef)([]),g=Object(n.useCallback)((e=>{const t=a.value,n=[...t.slice(0,e),...t.slice(e+1)];a.setValue(0===n.length?[""]:n),f.current=[...f.current.slice(0,e),...f.current.slice(e+1)],f.current=f.current.map(((t,a)=>(a>=e&&null!=f.current[e]&&(t.value="re-render"),t)))}),[a]),b=Object(n.useCallback)((()=>{const e=a.value;a.setValue([...e,""])}),[a]),h=Object(n.useCallback)(((e,t)=>{e.persist();const n=a.value,i=e.target.value;a.setValue([...n.slice(0,t),i,...n.slice(t+1)])}),[a]),y=Object(n.useCallback)(((e,t)=>{null!=t&&(f.current=[...f.current.slice(0,e),t,...f.current.slice(e+1)])}),[f]);Object(n.useEffect)((()=>{-1===p||Object(me.isEmpty)(f.current)||null==f.current[p]||(f.current[p].focus(),m(-1))}),[p,f.current]);const v=a.value;return i.a.createElement(Fk,{label:a.label,labelAppend:a.labelAppend,error:l?d:null,isInvalid:l&&u,fullWidth:!0,"data-test-subj":t,describedByIds:r?[r]:void 0},i.a.createElement(i.a.Fragment,null,v.map(((e,t)=>{const a={disabled:s,...t===v.length-1?{inputRef:y.bind(null,t)}:{},value:e,isInvalid:null!=o&&(l&&o(e))};return i.a.createElement("div",{key:t},i.a.createElement(_.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},i.a.createElement(_.EuiFlexItem,{grow:!0},i.a.createElement(_.EuiFieldText,F()({onBlur:()=>c(!0),onChange:e=>h(e,t),fullWidth:!0},a))),i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(_.EuiButtonIcon,{color:"danger",iconType:"trash",isDisabled:s||Object(me.isEmpty)(e)&&1===v.length,onClick:()=>g(t),"aria-label":Mn.M}))),v.length-1!==t&&i.a.createElement(_.EuiSpacer,{size:"s"}))})),i.a.createElement(_k,{onClick:b,isDisabled:s},e)))},Lk=[{framework:"MITRE ATT&CK",tactic:{id:"none",name:"none",reference:"none"},technique:[]}],Bk={author:[],name:"",description:"",isAssociatedToEndpointList:!1,isBuildingBlock:!1,severity:{value:"low",mapping:Oi([]),isMappingChecked:!1},riskScore:{value:21,mapping:[],isMappingChecked:!1},references:[""],falsePositives:[""],license:"",ruleNameOverride:"",tags:[],timestampOverride:"",threat:Lk,note:""},zk=S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttack.threatsDescription",{defaultMessage:"threats"}),Hk=S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttack.tacticsDescription",{defaultMessage:"tactic"}),Uk=S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttack.techniquesDescription",{defaultMessage:"technique"}),$k=S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttack.subtechniquesDescription",{defaultMessage:"subtechnique"}),Qk=S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttack.addTacticTitle",{defaultMessage:"Add tactic"}),Vk=S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttack.addTechniqueTitle",{defaultMessage:"Add technique"}),Wk=S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttack.addSubtechniqueTitle",{defaultMessage:"Add subtechnique"}),Gk=S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttack.tacticPlaceHolderDescription",{defaultMessage:"Select a tactic ..."}),Kk=S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttack.techniquePlaceHolderDescription",{defaultMessage:"Select a technique ..."}),Yk=S.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttack.subtechniquePlaceHolderDescription",{defaultMessage:"Select a subtechnique ..."}),Jk=e=>Ry.some((t=>t.techniqueId===e.id)),Xk=L.a.div.withConfig({displayName:"SubtechniqueContainer",componentId:"sc-1cb5h5o-0"})(["margin-left:48px;"]),Zk=({field:e,idAria:t,isDisabled:a,threatIndex:r,techniqueIndex:s,onFieldChange:o})=>{const l=e.value,c=Object(n.useMemo)((()=>{var e;return[...null!==(e=l[r].technique)&&void 0!==e?e:[]]}),[l,r]),u=Object(n.useCallback)((t=>{var a;const n=[...e.value],i=null!==(a=c[s].subtechnique)&&void 0!==a?a:[];null!=i&&(i.splice(t,1),c[s]={...c[s],subtechnique:i},n[r].technique=c,o(n))}),[e,o,s,c,r]),d=Object(n.useCallback)((()=>{const t=[...e.value],a=c[s].subtechnique;c[s]=null!=a?{...c[s],subtechnique:[...a,{id:"none",name:"none",reference:"none"}]}:{...c[s],subtechnique:[{id:"none",name:"none",reference:"none"}]},t[r].technique=c,o(t)}),[e,o,s,c,r]),p=Object(n.useCallback)(((t,a)=>{const n=[...e.value],{id:i,reference:l,name:u}=Ry.find((e=>e.value===a))||{id:"",name:"",reference:""},d=c[s].subtechnique;null!=d&&o([...n.slice(0,r),{...n[r],technique:[...c.slice(0,s),{...c[s],subtechnique:[...d.slice(0,t),{id:i,reference:l,name:u},...d.slice(t+1)]},...c.slice(s+1)]},...n.slice(r+1)])}),[r,s,o,e,c]),m=Object(n.useCallback)(((t,a,n)=>{const r=Ry.filter((e=>e.techniqueId===c[s].id));return i.a.createElement(i.a.Fragment,null,i.a.createElement(_.EuiSuperSelect,{id:"mitreAttackSubtechnique",options:[..."none"===n.name?[{inputDisplay:i.a.createElement(i.a.Fragment,null,Yk),value:"none",disabled:a}]:[],...r.map((e=>({inputDisplay:i.a.createElement(i.a.Fragment,null,e.label),value:e.value,disabled:a})))],prepend:`${e.label} ${$k}`,"aria-label":"",onChange:p.bind(null,t),fullWidth:!0,valueOfSelected:Object(me.camelCase)(n.name),"data-test-subj":"mitreAttackSubtechnique",disabled:a,placeholder:Yk}))}),[e,p,c,s]),f=Object(n.useMemo)((()=>c[s].subtechnique),[c,s]);return i.a.createElement(Xk,null,null!=f&&f.map(((e,n)=>i.a.createElement("div",{key:n},i.a.createElement(_.EuiSpacer,{size:"s"}),i.a.createElement(_.EuiFormRow,{fullWidth:!0,describedByIds:t?[`${t} ${$k}`]:void 0},i.a.createElement(_.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},i.a.createElement(_.EuiFlexItem,{grow:!0},m(n,a,e)),i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(_.EuiButtonIcon,{color:"danger",iconType:"trash",isDisabled:a,onClick:()=>u(n),"aria-label":Mn.M}))))))),i.a.createElement(_k,{"data-test-subj":"addMitreAttackSubtechnique",onClick:d,isDisabled:a},Wk))},ex=L.a.div.withConfig({displayName:"TechniqueContainer",componentId:"sc-1fugnao-0"})(["",""],(({theme:e})=>Object(N.css)(["margin-left:24px;padding-left:24px;border-left:2px solid ",";"],e.eui.euiColorLightestShade))),tx=({field:e,idAria:t,isDisabled:a,threatIndex:r,onFieldChange:s})=>{var o;const l=e.value,c=Object(n.useCallback)((t=>{var a;const n=[...e.value],i=null!==(a=n[r].technique)&&void 0!==a?a:[];i.splice(t,1),n[r]={...n[r],technique:i},s(n)}),[e,r,s]),u=Object(n.useCallback)((()=>{var t;const a=[...e.value];a[r]={...a[r],technique:[...null!==(t=a[r].technique)&&void 0!==t?t:[],{id:"none",name:"none",reference:"none",subtechnique:[]}]},s(a)}),[e,r,s]),d=Object(n.useCallback)(((t,a)=>{var n;const i=[...e.value],{id:o,reference:l,name:c}=Py.find((e=>e.value===a))||{id:"",name:"",reference:""},u=null!==(n=i[r].technique)&&void 0!==n?n:[];s([...i.slice(0,r),{...i[r],technique:[...u.slice(0,t),{id:o,reference:l,name:c,subtechnique:[]},...u.slice(t+1)]},...i.slice(r+1)])}),[r,s,e]),p=Object(n.useCallback)(((t,a,n,r)=>{const s=Py.filter((e=>e.tactics.includes(Object(me.kebabCase)(t))));return i.a.createElement(i.a.Fragment,null,i.a.createElement(_.EuiSuperSelect,{id:"mitreAttackTechnique",options:[..."none"===r.name?[{inputDisplay:i.a.createElement(i.a.Fragment,null,Kk),value:"none",disabled:n}]:[],...s.map((e=>({inputDisplay:i.a.createElement(i.a.Fragment,null,e.label),value:e.value,disabled:n})))],prepend:`${e.label} ${Uk}`,"aria-label":"",onChange:d.bind(null,a),fullWidth:!0,valueOfSelected:Object(me.camelCase)(r.name),"data-test-subj":"mitreAttackTechnique",disabled:n,placeholder:Kk}))}),[e,d]),m=null!==(o=l[r].technique)&&void 0!==o?o:[];return i.a.createElement(ex,null,m.map(((n,o)=>i.a.createElement("div",{key:o},i.a.createElement(_.EuiSpacer,{size:"s"}),i.a.createElement(_.EuiFormRow,{fullWidth:!0,describedByIds:t?[`${t} ${Uk}`]:void 0},i.a.createElement(_.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},i.a.createElement(_.EuiFlexItem,{grow:!0},p(l[r].tactic.name,o,a,n)),i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(_.EuiButtonIcon,{color:"danger",iconType:"trash",isDisabled:a,onClick:()=>c(o),"aria-label":Mn.M})))),i.a.createElement(Zk,{field:e,idAria:t,isDisabled:a||"none"===n.name||!1===Jk(n),threatIndex:r,techniqueIndex:o,onFieldChange:s})))),i.a.createElement(_k,{"data-test-subj":"addMitreAttackTechnique",onClick:u,isDisabled:a},Vk))},ax=L.a.div.withConfig({displayName:"MitreAttackContainer",componentId:"sc-bsl0gv-0"})(["margin-top:16px;"]),nx=L()(_.EuiFormRow).withConfig({displayName:"InitialMitreAttackFormRow",componentId:"sc-bsl0gv-1"})([".euiFormRow__labelWrapper{.euiText{padding-right:32px;}}"]),ix=Object(n.memo)((({field:e,idAria:t,isDisabled:a})=>{const r=Object(n.useCallback)((t=>{const a=[...e.value];a.splice(t,1),Object(me.isEmpty)(a)?e.setValue(Lk):e.setValue(a)}),[e]),s=Object(n.useCallback)((()=>{const t=[...e.value];Object(me.isEmpty)(t[t.length-1])?e.setValue([{tactic:{id:"none",name:"none",reference:"none"},technique:[]}]):e.setValue([...t,{tactic:{id:"none",name:"none",reference:"none"},technique:[]}])}),[e]),o=Object(n.useCallback)(((t,a)=>{const n=[...e.value],{id:i,reference:r,name:s}=Dy.find((e=>e.value===a))||{id:"",name:"",reference:""};n.splice(t,1,{...n[t],tactic:{id:i,reference:r,name:s},technique:[]}),e.setValue([...n])}),[e]),l=Object(n.useMemo)((()=>[...e.value]),[e]),c=Object(n.useCallback)(((t,n,s)=>{const c=t.tactic.name;return i.a.createElement(_.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},i.a.createElement(_.EuiFlexItem,{grow:!0},i.a.createElement(_.EuiSuperSelect,{id:"mitreAttackTactic",options:[..."none"===c?[{inputDisplay:i.a.createElement(i.a.Fragment,null,Gk),value:"none",disabled:s}]:[],...Dy.map((e=>({inputDisplay:i.a.createElement(i.a.Fragment,null,e.text),value:e.value,disabled:s})))],prepend:`${e.label} ${Hk}`,"aria-label":"",onChange:o.bind(null,n),fullWidth:!0,valueOfSelected:Object(me.camelCase)(c),"data-test-subj":"mitreAttackTactic",placeholder:Gk})),i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(_.EuiButtonIcon,{color:"danger",iconType:"trash",isDisabled:a||Object(lf.isEqual)(l,Lk),onClick:()=>r(n),"aria-label":Mn.M})))}),[e,a,r,o,l]),u=Object(n.useCallback)((t=>{e.setValue(t)}),[e]);return i.a.createElement(ax,null,l.map(((n,r)=>i.a.createElement("div",{key:r},0===r?i.a.createElement(nx,{fullWidth:!0,label:`${e.label} ${zk}`,labelAppend:e.labelAppend,describedByIds:t?[`${t} ${Hk}`]:void 0},i.a.createElement(i.a.Fragment,null,c(n,r,a))):i.a.createElement(_.EuiFormRow,{fullWidth:!0,describedByIds:t?[`${t} ${Hk}`]:void 0},c(n,r,a)),i.a.createElement(tx,{field:e,threatIndex:r,isDisabled:a||"none"===n.tactic.name,idAria:t,onFieldChange:u})))),i.a.createElement(_k,{"data-test-subj":"addMitreAttackTactic",onClick:s,isDisabled:a},Qk))}));var rx=a(209);const sx=i.a.createElement(_.EuiText,{color:"subdued",size:"xs"},Mn.lb),{emptyField:ox}=Tv.i,lx={author:{type:Tv.b.COMBO_BOX,label:S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldAuthorLabel",{defaultMessage:"Author"}),helpText:S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldAuthorHelpText",{defaultMessage:"Type one or more authors for this rule. Press enter after each author to add a new one."}),labelAppend:sx,validations:[{validator:ox(S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.authorFieldEmptyError",{defaultMessage:"An author must not be empty"})),type:Tv.h.ARRAY_ITEM,isBlocking:!1}]},name:{type:Tv.b.TEXT,label:S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldNameLabel",{defaultMessage:"Name"}),validations:[{validator:ox(S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.nameFieldRequiredError",{defaultMessage:"A name is required."}))}]},description:{type:Tv.b.TEXTAREA,label:S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldDescriptionLabel",{defaultMessage:"Description"}),validations:[{validator:ox(S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.descriptionFieldRequiredError",{defaultMessage:"A description is required."}))}]},isBuildingBlock:{type:Tv.b.CHECKBOX,label:S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldBuildingBlockLabel",{defaultMessage:'Mark all generated alerts as "building block" alerts'}),labelAppend:sx},isAssociatedToEndpointList:{type:Tv.b.CHECKBOX,label:S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldAssociatedToEndpointListLabel",{defaultMessage:"Add existing Endpoint exceptions to the rule"}),labelAppend:sx},severity:{value:{},mapping:{},isMappingChecked:{}},riskScore:{value:{},mapping:{},isMappingChecked:{}},references:{label:S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldReferenceUrlsLabel",{defaultMessage:"Reference URLs"}),labelAppend:sx,validations:[{validator:(...e)=>{const[{value:t,path:a}]=e;let n=!1;return t.forEach((e=>{Object(rx.c)(e)&&(n=!0)})),n?{code:"ERR_FIELD_FORMAT",path:a,message:fi}:void 0}}]},falsePositives:{label:S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldFalsePositiveLabel",{defaultMessage:"False positive examples"}),labelAppend:sx},license:{type:Tv.b.TEXT,label:S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldLicenseLabel",{defaultMessage:"License"}),helpText:S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldLicenseHelpText",{defaultMessage:"Add a license name"}),labelAppend:sx},ruleNameOverride:{type:Tv.b.TEXT,label:S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldRuleNameOverrideLabel",{defaultMessage:"Rule name override"}),helpText:S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldRuleNameOverrideHelpText",{defaultMessage:"Choose a field from the source event to populate the rule name in the alert list."}),labelAppend:sx},threat:{label:S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldMitreThreatLabel",{defaultMessage:"MITRE ATT&CK\\u2122"}),labelAppend:sx},threatIndicatorPath:{type:Tv.b.TEXT,label:S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldThreatIndicatorPathLabel",{defaultMessage:"Indicator prefix override"}),helpText:S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldThreatIndicatorPathHelpText",{defaultMessage:"Specify the document prefix containing your indicator fields. Used for enrichment of indicator match alerts."}),labelAppend:sx},timestampOverride:{type:Tv.b.TEXT,label:S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldTimestampOverrideLabel",{defaultMessage:"Timestamp override"}),helpText:S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldTimestampOverrideHelpText",{defaultMessage:"Choose timestamp field used when executing rule. Pick field with timestamp closest to ingest time (e.g. event.ingested)."}),labelAppend:sx},tags:{type:Tv.b.COMBO_BOX,label:S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldTagsLabel",{defaultMessage:"Tags"}),helpText:S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldTagsHelpText",{defaultMessage:"Type one or more custom identifying tags for this rule. Press enter after each tag to begin a new one."}),labelAppend:sx,validations:[{validator:ox(S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.tagFieldEmptyError",{defaultMessage:"A tag must not be empty"})),type:Tv.h.ARRAY_ITEM,isBlocking:!1}]},note:{type:Tv.b.TEXTAREA,label:S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.guideLabel",{defaultMessage:"Investigation guide"}),helpText:S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.guideHelpText",{defaultMessage:"Provide helpful information for analysts that are investigating detection alerts. This guide will appear on the rule details page and in timelines (as notes) created from detection alerts generated by this rule."}),labelAppend:sx}};var cx=a(453);const ux=L.a.div.withConfig({displayName:"NestedContent",componentId:"sc-1o9f6e3-0"})(["margin-left:24px;"]),dx=L()(_.EuiFlexItem).withConfig({displayName:"EuiFlexItemComboBoxColumn",componentId:"sc-1o9f6e3-1"})(["max-width:376px;"]),px=L()(_.EuiFlexItem).withConfig({displayName:"EuiFlexItemIconColumn",componentId:"sc-1o9f6e3-2"})(["width:20px;"]),mx=L()(_.EuiFlexItem).withConfig({displayName:"EuiFlexItemSeverityColumn",componentId:"sc-1o9f6e3-3"})(["width:80px;"]),fx=({dataTestSubj:e,field:t,idAria:a,indices:r,isDisabled:s,options:o})=>{const{services:l}=Object(m.j)(),{value:c,isMappingChecked:u,mapping:d}=t.value,{setValue:p}=t,f=Object(n.useCallback)(((e,t)=>{p({value:c,isMappingChecked:u,mapping:[...d.slice(0,t),...e,...d.slice(t+1)]})}),[c,u,d,p]),g=Object(n.useCallback)(((e,t,[a])=>{var n;const i=[{...d[e],field:null!==(n=null==a?void 0:a.name)&&void 0!==n?n:"",value:null!=a?d[e].value:"",operator:"equals",severity:t}];f(i,e)}),[d,f]),b=Object(n.useCallback)((e=>{p({value:e,isMappingChecked:u,mapping:d})}),[u,d,p]),h=Object(n.useCallback)(((e,t,a)=>{const n=[{...d[e],field:d[e].field,value:null!=d[e].field&&""!==d[e].field?a:"",operator:"equals",severity:t}];f(n,e)}),[d,f]),y=Object(n.useCallback)((()=>{p({value:c,mapping:[...d],isMappingChecked:!u})}),[u,d,c,p]),v=Object(n.useMemo)((()=>i.a.createElement("div",null,i.a.createElement(_.EuiFlexGroup,{gutterSize:"s"},i.a.createElement(_.EuiFlexItem,null,hy)),i.a.createElement(_.EuiSpacer,{size:"xs"}),i.a.createElement(_.EuiText,{size:"xs"},ky))),[]),E=Object(n.useMemo)((()=>i.a.createElement("div",null,i.a.createElement(_.EuiFlexGroup,{alignItems:"center",gutterSize:"s",onClick:s?me.noop:y},i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(_.EuiCheckbox,{id:"severity-mapping-override",checked:u,disabled:s,onChange:y})),i.a.createElement(_.EuiFlexItem,null,Ty)),i.a.createElement(_.EuiSpacer,{size:"xs"}),i.a.createElement(ux,null,i.a.createElement(_.EuiText,{size:"xs"},xy)))),[y,s,u]);return i.a.createElement(_.EuiFlexGroup,{direction:"column"},i.a.createElement(_.EuiFlexItem,null,i.a.createElement(_.EuiFormRow,{label:v,labelAppend:t.labelAppend,helpText:t.helpText,error:"errorMessage",isInvalid:!1,fullWidth:!0,"data-test-subj":"detectionEngineStepAboutRuleSeverity",describedByIds:["detectionEngineStepAboutRuleSeverity"]},i.a.createElement(_.EuiSuperSelect,{fullWidth:!1,disabled:!1,valueOfSelected:c,onChange:b,options:o,"data-test-subj":"select"}))),i.a.createElement(_.EuiFlexItem,null,i.a.createElement(_.EuiFormRow,{label:E,labelAppend:t.labelAppend,helpText:u?i.a.createElement(ux,null,Sy):"",error:"errorMessage",isInvalid:!1,fullWidth:!0,"data-test-subj":`${e}-severityOverride`,describedByIds:a?[a]:void 0},i.a.createElement(ux,null,i.a.createElement(_.EuiSpacer,{size:"s"}),u&&i.a.createElement(_.EuiFlexGroup,{direction:"column",gutterSize:"s"},i.a.createElement(_.EuiFlexItem,null,i.a.createElement(_.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},i.a.createElement(dx,null,i.a.createElement(_.EuiFormLabel,null,vy)),i.a.createElement(dx,null,i.a.createElement(_.EuiFormLabel,null,Ey)),i.a.createElement(px,{grow:!1}),i.a.createElement(mx,{grow:!1},i.a.createElement(_.EuiFormLabel,null,yy)))),d.map(((e,t)=>{var a;return i.a.createElement(_.EuiFlexItem,{key:`${e.severity}-${t}`},i.a.createElement(_.EuiFlexGroup,{"data-test-subj":"severityOverrideRow",alignItems:"center",gutterSize:"s"},i.a.createElement(dx,null,i.a.createElement(aT,{placeholder:"",selectedField:gx(e,r),isLoading:!1,isDisabled:s,isClearable:!1,indexPattern:r,onChange:g.bind(null,t,e.severity),"data-test-subj":`detectionEngineStepAboutRuleSeverityMappingField-${e.severity}-${t}`,"aria-label":`detectionEngineStepAboutRuleSeverityMappingField-${e.severity}-${t}`})),i.a.createElement(dx,null,i.a.createElement(ET,{autocompleteService:l.data.autocomplete,placeholder:"",selectedField:gx(e,r),selectedValue:e.value,isClearable:!1,isDisabled:s,isLoading:!1,indexPattern:r,onChange:h.bind(null,t,e.severity),"data-test-subj":`detectionEngineStepAboutRuleSeverityMappingValue-${e.severity}-${t}`,"aria-label":`detectionEngineStepAboutRuleSeverityMappingValue-${e.severity}-${t}`})),i.a.createElement(px,{grow:!1},i.a.createElement(_.EuiIcon,{type:"sortRight"})),i.a.createElement(mx,{grow:!1},null===(a=o.find((t=>t.value===e.severity)))||void 0===a?void 0:a.inputDisplay)))})))))))},gx=(e,t)=>{const{field:a}=e,[n]=t.fields.filter((({name:e})=>a===e));return null!=n?n:{name:a,type:"string"}},bx=L.a.div.withConfig({displayName:"NestedContent",componentId:"sc-1k1nimg-0"})(["margin-left:24px;"]),hx=L()(_.EuiFlexItem).withConfig({displayName:"EuiFlexItemComboBoxColumn",componentId:"sc-1k1nimg-1"})(["max-width:376px;"]),yx=L()(_.EuiFlexItem).withConfig({displayName:"EuiFlexItemIconColumn",componentId:"sc-1k1nimg-2"})(["width:20px;"]),vx=L()(_.EuiFlexItem).withConfig({displayName:"EuiFlexItemRiskScoreColumn",componentId:"sc-1k1nimg-3"})(["width:160px;"]),Ex=({dataTestSubj:e,field:t,idAria:a,indices:r,isDisabled:s,placeholder:o})=>{const{value:l,isMappingChecked:c,mapping:u}=t.value,{setValue:d}=t,p=Object(n.useMemo)((()=>["number"]),[]),m=Object(n.useMemo)((()=>Tx(u,r)),[u,r]),f=Object(n.useCallback)((e=>{const t=e.target.value;d({value:Number(t.trim()),isMappingChecked:c,mapping:u})}),[d,c,u]),g=Object(n.useCallback)((([e])=>{var t;d({value:l,isMappingChecked:c,mapping:[{field:null!==(t=null==e?void 0:e.name)&&void 0!==t?t:"",operator:"equals",value:"",risk_score:void 0}]})}),[d,l,c]),b=Object(n.useCallback)((()=>{d({value:l,isMappingChecked:!c,mapping:[...u]})}),[d,l,c,u]),h=Object(n.useMemo)((()=>i.a.createElement("div",null,i.a.createElement(_.EuiFlexGroup,{gutterSize:"s"},i.a.createElement(_.EuiFlexItem,null,Oy)),i.a.createElement(_.EuiSpacer,{size:"xs"}),i.a.createElement(_.EuiText,{size:"xs"},My))),[]),y=Object(n.useMemo)((()=>i.a.createElement("div",null,i.a.createElement(_.EuiFlexGroup,{alignItems:"center",gutterSize:"s",onClick:s?me.noop:b},i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(_.EuiCheckbox,{id:"risk_score-mapping-override",checked:c,disabled:s,onChange:b})),i.a.createElement(_.EuiFlexItem,null,Iy)),i.a.createElement(_.EuiSpacer,{size:"xs"}),i.a.createElement(bx,null,i.a.createElement(_.EuiText,{size:"xs"},Ay)))),[c,b,s]);return i.a.createElement(_.EuiFlexGroup,{direction:"column"},i.a.createElement(_.EuiFlexItem,null,i.a.createElement(_.EuiFormRow,{label:h,labelAppend:t.labelAppend,helpText:t.helpText,error:"errorMessage",isInvalid:!1,fullWidth:!0,"data-test-subj":`${e}-defaultRisk`,describedByIds:a?[a]:void 0},i.a.createElement(_.EuiRange,{value:l,onChange:f,max:100,min:0,showRange:!0,showInput:!0,fullWidth:!1,showTicks:!0,tickInterval:25,"data-test-subj":`${e}-defaultRiskRange`}))),i.a.createElement(_.EuiFlexItem,null,i.a.createElement(_.EuiFormRow,{label:y,labelAppend:t.labelAppend,helpText:c?i.a.createElement(bx,null,qy):"",error:"errorMessage",isInvalid:!1,fullWidth:!0,"data-test-subj":`${e}-riskOverride`,describedByIds:a?[a]:void 0},i.a.createElement(bx,null,i.a.createElement(_.EuiSpacer,{size:"s"}),c&&i.a.createElement(_.EuiFlexGroup,{direction:"column",gutterSize:"s"},i.a.createElement(_.EuiFlexItem,null,i.a.createElement(_.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},i.a.createElement(hx,null,i.a.createElement(_.EuiFormLabel,null,Cy)),i.a.createElement(yx,{grow:!1}),i.a.createElement(vx,{grow:!1},i.a.createElement(_.EuiFormLabel,null,Oy)))),i.a.createElement(_.EuiFlexItem,null,i.a.createElement(_.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},i.a.createElement(hx,null,i.a.createElement(aT,{placeholder:null!=o?o:"",indexPattern:r,selectedField:m,fieldTypeFilter:p,isLoading:!1,isClearable:!1,isDisabled:s,onChange:g,"data-test-subj":e,"aria-label":a})),i.a.createElement(yx,{grow:!1},i.a.createElement(_.EuiIcon,{type:"sortRight"})),i.a.createElement(vx,{grow:!1},i.a.createElement(_.EuiText,{size:"s"},jy)))))))))},Tx=(e,t)=>{var a,n;const i=null!==(a=null==e||null===(n=e[0])||void 0===n?void 0:n.field)&&void 0!==a?a:"",[r]=t.fields.filter((({name:e})=>null!=i&&i===e));return null!=r?r:{name:i,type:"number"}},kx=({dataTestSubj:e,field:t,idAria:a,indices:r,isDisabled:s,fieldType:o,placeholder:l})=>{const c=Object(n.useCallback)((([e])=>{var a;t.setValue(null!==(a=null==e?void 0:e.name)&&void 0!==a?a:"")}),[t]),u=Object(n.useMemo)((()=>{var e;const a=null!==(e=t.value)&&void 0!==e?e:"",[n]=r.fields.filter((({name:e})=>null!=a&&a===e));return n}),[t.value,r]),d=Object(n.useMemo)((()=>[o]),[o]);return i.a.createElement(_.EuiFormRow,{"data-test-subj":e,describedByIds:a?[a]:void 0,fullWidth:!0,helpText:t.helpText,label:t.label,labelAppend:t.labelAppend},i.a.createElement(aT,{placeholder:null!=l?l:"",indexPattern:r,selectedField:u,fieldTypeFilter:d,isLoading:!1,isDisabled:s,isClearable:!1,onChange:c,"data-test-subj":e,"aria-label":a,fieldInputWidth:500}))},xx=Object(Tv.k)({component:Tv.c});L.a.div.withConfig({displayName:"ThreeQuartersContainer",componentId:"sc-1nsr0kk-0"})(["max-width:740px;"]).displayName="ThreeQuartersContainer";const Sx=L.a.div.withConfig({displayName:"TagContainer",componentId:"sc-1nsr0kk-1"})(["margin-top:16px;"]);Sx.displayName="TagContainer";const wx=({addPadding:e=!1,defaultValues:t,defineRuleData:a,descriptionColumns:r="singleSplit",isReadOnlyView:s,isUpdateView:l=!1,isLoading:c,onSubmit:u,setForm:d})=>{var p;const m=null!=t?t:Bk,[f,g]=Object(n.useState)(m.severity.value),[b,{indexPatterns:h}]=Object(op.b)(null!==(p=null==a?void 0:a.index)&&void 0!==p?p:[]),{form:y}=Object(Tv.l)({defaultValue:m,options:{stripEmptyFields:!1},schema:lx}),{getFields:v,getFormData:E,submit:T}=y,[{severity:k}]=Object(Tv.n)({form:y,watch:["severity"]});Object(n.useEffect)((()=>{const e=null==k?void 0:k.value;if(null!=e&&e!==f){g(e);const t=yi[e];if(null!=t){const e=v().riskScore;e.setValue({...e.value,value:t})}}}),[null==k?void 0:k.value,v,f]);const x=Object(n.useCallback)((async()=>{const e=await T();return null!=e&&e.isValid?e:{isValid:!1,data:E()}}),[E,T]),S=Object(n.useCallback)((()=>{u&&u()}),[u]);return Object(n.useEffect)((()=>{let e=!1;return d&&!e&&d(uy.a.aboutRule,x),()=>{e=!0}}),[x,d]),s?i.a.createElement(jE,{"data-test-subj":"aboutStep",addPadding:e},i.a.createElement(Cv,{columns:r,schema:lx,data:m})):i.a.createElement(i.a.Fragment,null,i.a.createElement(jE,{addPadding:!l},i.a.createElement(Tv.d,{form:y},i.a.createElement(xx,{path:"name",componentProps:{idAria:"detectionEngineStepAboutRuleName","data-test-subj":"detectionEngineStepAboutRuleName",euiFieldProps:{fullWidth:!0,disabled:c}}}),i.a.createElement(_.EuiSpacer,{size:"l"}),i.a.createElement(xx,{path:"description",componentProps:{idAria:"detectionEngineStepAboutRuleDescription","data-test-subj":"detectionEngineStepAboutRuleDescription",euiFieldProps:{disabled:c,compressed:!0,fullWidth:!0}}}),i.a.createElement(_.EuiSpacer,{size:"l"}),i.a.createElement(_.EuiFlexItem,null,i.a.createElement(Tv.f,{path:"severity",component:fx,componentProps:{dataTestSubj:"detectionEngineStepAboutRuleSeverityField",idAria:"detectionEngineStepAboutRuleSeverityField",isDisabled:c||b,options:hi,indices:h}})),i.a.createElement(_.EuiSpacer,{size:"l"}),i.a.createElement(_.EuiFlexItem,null,i.a.createElement(xx,{path:"riskScore",component:Ex,componentProps:{dataTestSubj:"detectionEngineStepAboutRuleRiskScore",idAria:"detectionEngineStepAboutRuleRiskScore",isDisabled:c||b,indices:h}})),i.a.createElement(Sx,null,i.a.createElement(xx,{path:"tags",componentProps:{idAria:"detectionEngineStepAboutRuleTags","data-test-subj":"detectionEngineStepAboutRuleTags",euiFieldProps:{fullWidth:!0,isDisabled:c||b,placeholder:""}}})),i.a.createElement(_.EuiSpacer,{size:"l"}),i.a.createElement(_.EuiAccordion,{"data-test-subj":"advancedSettings",id:"advancedSettingsAccordion",buttonContent:ri},i.a.createElement(_.EuiSpacer,{size:"l"}),i.a.createElement(Tv.f,{path:"references",component:Nk,componentProps:{addText:si,idAria:"detectionEngineStepAboutRuleReferenceUrls",isDisabled:c,dataTestSubj:"detectionEngineStepAboutRuleReferenceUrls",validate:rx.c}}),i.a.createElement(Tv.f,{path:"falsePositives",component:Nk,componentProps:{addText:oi,idAria:"detectionEngineStepAboutRuleFalsePositives",isDisabled:c,dataTestSubj:"detectionEngineStepAboutRuleFalsePositives"}}),i.a.createElement(Tv.f,{path:"threat",component:ix,componentProps:{idAria:"detectionEngineStepAboutRuleMitreThreat",isDisabled:c,dataTestSubj:"detectionEngineStepAboutRuleMitreThreat"}}),i.a.createElement(_.EuiSpacer,{size:"l"}),i.a.createElement(Tv.f,{path:"note",component:cx.a,componentProps:{idAria:"detectionEngineStepAboutRuleNote",isDisabled:c,dataTestSubj:"detectionEngineStepAboutRuleNote",placeholder:gi}}),i.a.createElement(_.EuiSpacer,{size:"l"}),i.a.createElement(xx,{path:"author",componentProps:{idAria:"detectionEngineStepAboutRuleAuthor","data-test-subj":"detectionEngineStepAboutRuleAuthor",euiFieldProps:{fullWidth:!0,isDisabled:c,placeholder:""}}}),i.a.createElement(_.EuiSpacer,{size:"l"}),i.a.createElement(xx,{path:"license",componentProps:{idAria:"detectionEngineStepAboutRuleLicense","data-test-subj":"detectionEngineStepAboutRuleLicense",euiFieldProps:{fullWidth:!0,disabled:c,placeholder:""}}}),i.a.createElement(_.EuiSpacer,{size:"l"}),i.a.createElement(_.EuiFormRow,{label:li,fullWidth:!0},i.a.createElement(xx,{path:"isAssociatedToEndpointList",componentProps:{idAria:"detectionEngineStepAboutRuleAssociatedToEndpointList","data-test-subj":"detectionEngineStepAboutRuleAssociatedToEndpointList",euiFieldProps:{disabled:c}}})),i.a.createElement(_.EuiFormRow,{label:ci,fullWidth:!0},i.a.createElement(xx,{path:"isBuildingBlock",componentProps:{idAria:"detectionEngineStepAboutRuleBuildingBlock","data-test-subj":"detectionEngineStepAboutRuleBuildingBlock",euiFieldProps:{disabled:c}}})),i.a.createElement(_.EuiSpacer,{size:"l"}),Object(ti.e)(null==a?void 0:a.ruleType)&&i.a.createElement(i.a.Fragment,null,i.a.createElement(xx,{path:"threatIndicatorPath",componentProps:{idAria:"detectionEngineStepAboutThreatIndicatorPath","data-test-subj":"detectionEngineStepAboutThreatIndicatorPath",euiFieldProps:{fullWidth:!0,disabled:c,placeholder:o.I}}})),i.a.createElement(_.EuiSpacer,{size:"l"}),i.a.createElement(Tv.f,{path:"ruleNameOverride",component:kx,componentProps:{dataTestSubj:"detectionEngineStepAboutRuleRuleNameOverride",fieldType:"string",idAria:"detectionEngineStepAboutRuleRuleNameOverride",indices:h,isDisabled:c||b,placeholder:""}}),i.a.createElement(_.EuiSpacer,{size:"l"}),i.a.createElement(Tv.f,{path:"timestampOverride",component:kx,componentProps:{dataTestSubj:"detectionEngineStepAboutRuleTimestampOverride",fieldType:"date",idAria:"detectionEngineStepAboutRuleTimestampOverride",indices:h,isDisabled:c||b,placeholder:""}})))),!l&&i.a.createElement(CE,{dataTestSubj:"about-continue",onClick:S,isDisabled:c}))},Ox=Object(n.memo)(wx),jx=S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRuleForm.secondsOptionDescription",{defaultMessage:"Seconds"}),Cx=S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRuleForm.minutesOptionDescription",{defaultMessage:"Minutes"}),Ix=S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRuleForm.hoursOptionDescription",{defaultMessage:"Hours"}),Mx=(S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRuleForm.invalidTimeMessageDescription",{defaultMessage:"A time is required."}),[{value:"s",text:jx},{value:"m",text:Cx},{value:"h",text:Ix}]),Ax=L()(_.EuiFlexItem).withConfig({displayName:"StyledLabelAppend",componentId:"sc-d3i8n6-0"})(["&.euiFlexItem.euiFlexItem--flexGrowZero{margin-left:31px;}"]),qx=L()(_.EuiFormRow).withConfig({displayName:"StyledEuiFormRow",componentId:"sc-d3i8n6-1"})(["max-width:none;.euiFormControlLayout{max-width:200px !important;}.euiFormControlLayout__childrenWrapper > *:first-child{box-shadow:none;height:38px;}.euiFormControlLayout:not(:first-child){border-left:1px solid ",";}"],(({theme:e})=>e.eui.euiColorLightShade)),Dx=L()(_.EuiSelect).withConfig({displayName:"MyEuiSelect",componentId:"sc-d3i8n6-2"})(["width:auto;"]),Px=({dataTestSubj:e,field:t,idAria:a,isDisabled:r,minimumValue:s=0})=>{const[o,l]=Object(n.useState)("s"),[c,u]=Object(n.useState)(0),{isInvalid:d,errorMessage:p}=Object(Tv.j)(t),{value:m,setValue:f}=t,g=Object(n.useCallback)((e=>{l(e.target.value),f(`${c}${e.target.value}`)}),[f,c]),b=Object(n.useCallback)((e=>{const t=((e,t=0)=>{const a=parseInt(e,10);return Number.isNaN(a)?t:Math.min(a,Number.MAX_SAFE_INTEGER)})(e.target.value,s);u(t),f(`${t}${o}`)}),[s,f,o]);Object(n.useEffect)((()=>{if(m!==`${c}${o}`){const e=m.match(/\d+/g),t=m.match(/[a-zA-Z]+/g);Object(me.isEmpty)(e)||null==e||isNaN(Number(e[0]))||Number(e[0])===Number(c)||u(Number(e[0])),!Object(me.isEmpty)(t)&&null!=t&&["s","m","h"].includes(t[0])&&t[0]!==o&&l(t[0])}}),[o,c,m]);const h={disabled:r},y=Object(n.useMemo)((()=>i.a.createElement(_.EuiFlexGroup,{gutterSize:"s",justifyContent:"flexStart",alignItems:"center"},i.a.createElement(_.EuiFlexItem,{grow:!1,component:"span"},t.label),i.a.createElement(Ax,{grow:!1,component:"span"},t.labelAppend))),[t.label,t.labelAppend]);return i.a.createElement(qx,{label:y,helpText:t.helpText,error:p,isInvalid:d,fullWidth:!1,"data-test-subj":e,describedByIds:a?[a]:void 0},i.a.createElement(_.EuiFormControlLayout,{append:i.a.createElement(Dx,F()({fullWidth:!1,options:Mx,onChange:g,value:o,"data-test-subj":"timeType"},h))},i.a.createElement(_.EuiFieldNumber,F()({fullWidth:!0,min:s,max:Number.MAX_SAFE_INTEGER,onChange:b,value:c,"data-test-subj":"interval"},h))))},Rx={interval:{label:S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRule.fieldIntervalLabel",{defaultMessage:"Runs every"}),helpText:S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRule.fieldIntervalHelpText",{defaultMessage:"Rules run periodically and detect alerts within the specified time frame."})},from:{label:S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRule.fieldAdditionalLookBackLabel",{defaultMessage:"Additional look-back time"}),labelAppend:sx,helpText:S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRule.fieldAdditionalLookBackHelpText",{defaultMessage:"Adds time to the look-back period to prevent missed alerts."})}},Fx=({addPadding:e=!1,defaultValues:t,descriptionColumns:a="singleSplit",isReadOnlyView:r,isLoading:s,isUpdateView:o=!1,onSubmit:l,setForm:c,ruleType:u})=>{const d=null!=t?t:(e=>({interval:Object(ti.e)(e)?"1h":"5m",from:Object(ti.e)(e)?"5m":"1m"}))(u),{form:p}=Object(Tv.l)({defaultValue:d,options:{stripEmptyFields:!1},schema:Rx}),{getFormData:m,submit:f}=p,g=Object(n.useCallback)((()=>{l&&l()}),[l]),b=Object(n.useCallback)((async()=>{const e=await f();return null!=e&&e.isValid?e:{isValid:!1,data:m()}}),[m,f]);return Object(n.useEffect)((()=>{let e=!1;return c&&!e&&c(uy.a.scheduleRule,b),()=>{e=!0}}),[b,c]),r?i.a.createElement(jE,{addPadding:e},i.a.createElement(Cv,{columns:a,schema:Rx,data:d})):i.a.createElement(i.a.Fragment,null,i.a.createElement(jE,{addPadding:!o},i.a.createElement(Tv.d,{form:p,"data-test-subj":"stepScheduleRule"},i.a.createElement(Tv.f,{path:"interval",component:Px,componentProps:{idAria:"detectionEngineStepScheduleRuleInterval",isDisabled:s,dataTestSubj:"detectionEngineStepScheduleRuleInterval"}}),i.a.createElement(Tv.f,{path:"from",component:Px,componentProps:{idAria:"detectionEngineStepScheduleRuleFrom",isDisabled:s,dataTestSubj:"detectionEngineStepScheduleRuleFrom",minimumValue:1}}))),!o&&i.a.createElement(CE,{dataTestSubj:"schedule-continue",onClick:g,isDisabled:s}))},_x=Object(n.memo)(Fx);var Nx=a(945),Lx=a.n(Nx),Bx=a(88);const zx=S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.ruleActionsField.ruleActionsFormErrorsTitle",{defaultMessage:"Please fix issues listed below"}),Hx=L.a.div.withConfig({displayName:"FieldErrorsContainer",componentId:"sc-1brsijn-0"})(["p{margin-bottom:0;}"]),Ux=L.a.div.attrs((({className:e="",$caseIndexes:t=[]})=>({className:e}))).withConfig({displayName:"ContainerActions",componentId:"sc-1brsijn-1"})(["",""],(({$caseIndexes:e})=>e.map((e=>`\n        div[id="${e}"].euiAccordion__childWrapper .euiAccordion__padding--l {\n          padding: 0px;\n          .euiFlexGroup {\n            display: none;\n          }\n          .euiSpacer.euiSpacer--xl {\n            height: 0px;\n          }\n        }\n      `)))),$x=({field:e,hasErrorOnCreationCaseAction:t,messageVariables:a})=>{const[r,s]=Object(n.useState)(null),[l,c]=Object(n.useState)(),u=Object(Tv.m)(),{isSubmitted:d,isSubmitting:p,isValid:f}=u,{http:g,triggersActionsUi:{actionTypeRegistry:b}}=Object(m.j)().services,h=Object(n.useMemo)((()=>Object(me.isEmpty)(e.value)?[]:e.value),[e.value]),y=Object(n.useMemo)((()=>h.reduce(((e,t,a)=>".case"===t.actionTypeId?[...e,`${a}`]:e),[])),[h]),v=Object(n.useCallback)(((t,a)=>{const n=[...h];n[a]=Zh()(n[a],{id:t}),e.setValue(n)}),[e.setValue,h]),E=Object(n.useCallback)((t=>e.setValue(t)),[e]),T=Object(n.useCallback)(((t,a,n)=>{const i=[...h];i[n]={...i[n],params:{...i[n].params,[t]:a}},e.setValue(i)}),[e.setValue,h]);return Object(n.useEffect)((()=>{!async function(){const e=((e,t)=>e.filter((e=>(".case"!==e.id||!t)&&o.zb.includes(e.id))))(Object(m.c)(await Object(Bx.loadActionTypes)({http:g})),t);c(e)}()}),[t]),Object(n.useEffect)((()=>{if(p||!e.errors.length)return s(null);if(d&&!p&&!1===f&&e.errors.length){const t=e.errors.map((({message:e})=>e)).join("\n");return s(t)}}),[d,p,e.isChangingValue,f,e.errors,s]),l?i.a.createElement(Ux,{$caseIndexes:y},r?i.a.createElement(i.a.Fragment,null,i.a.createElement(Hx,null,i.a.createElement(_.EuiCallOut,{title:zx,color:"danger",iconType:"alert"},i.a.createElement(Lx.a,{source:r}))),i.a.createElement(_.EuiSpacer,null)):null,i.a.createElement(Bx.ActionForm,{actions:h,messageVariables:a,defaultActionGroupId:"default",setActionIdByIndex:v,setActions:E,setActionParamsProperty:T,actionTypeRegistry:b,actionTypes:l,defaultActionMessage:"Rule {{context.rule.name}} generated {{state.signals_count}} alerts"})):i.a.createElement(i.a.Fragment,null)};var Qx=a(1025),Vx=a.n(Qx);const Wx=S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRule.completeWithoutActivatingTitle",{defaultMessage:"Create rule without activating it"}),Gx=S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRule.completeWithActivatingTitle",{defaultMessage:"Create & activate rule"}),Kx=(S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepRuleActions.noConnectorSelectedErrorMessage",{defaultMessage:"No connector selected"}),S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepRuleActions.noReadActionsPrivileges",{defaultMessage:'Cannot create rule actions. You do not have "Read" permissions for the "Actions" plugin.'})),Yx=e=>{if(!e)return"";const t=e.split(".")[1];return t?Object(me.startCase)(t):""},Jx=e=>{const t=[];return Object.entries(e).forEach((([e,a])=>{if(Object(me.isString)(a))try{Vx.a.render(a,{})}catch(a){t.push((e=>S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepRuleActions.invalidMustacheTemplateErrorMessage",{defaultMessage:"{key} is not valid mustache template",values:{key:Object(me.startCase)(e)}}))(e))}})),t},Xx=async(e,t)=>{const a=await(async(e,t)=>{var a;const n=await(null===(a=t.get(e.actionTypeId))||void 0===a?void 0:a.validateParams(e.params));if(n){const e=Object.values(n.errors);if(e.length){const t=e.filter((e=>Object(me.isString)(e)||Object(me.isArray)(e))),a=Object(me.uniq)(Object(me.flattenDeep)(t));if(a.length)return a}}return[]})(e,t);return[...a,...Jx(e.params)]},Zx=e=>async(...t)=>{const[{value:a,path:n}]=t,i=[];for(const t of a){const a=await Xx(t,e);if(a.length){const e=Yx(t.actionTypeId),n=a.map((e=>`*   ${e}\n`));i.push(`\n**${e}:**\n${n.join("")}`)}}if(i.length)return{code:"ERR_FIELD_FORMAT",path:n,message:`${i.join("\n")}`}};var eS=a(34);const tS="Cases",aS=()=>{const e=Object(n.useRef)(!0),[t,a]=Object(n.useState)(!0),[i,r]=Object(n.useState)(!1);return Object(n.useEffect)((()=>{const t=new AbortController;return e.current&&(e.current=!1,(async()=>{try{Object(m.c)(await m.b.get().http.fetch(Object(eS.getAllConnectorsUrl)(),{method:"GET",signal:t.signal})).some((e=>".case"===e.connectorTypeId&&e.name===tS))||await m.b.get().http.post(Object(eS.getCreateConnectorUrl)(),{method:"POST",body:JSON.stringify({connector_type_id:".case",config:{},name:tS,secrets:{}}),signal:t.signal}),a(!1)}catch{a(!1),r(!0)}})()),()=>{t.abort()}}),[]),[t,i]},nS={enabled:!0,actions:[],kibanaSiemAppUrl:"",throttle:xv.value},iS=()=>i.a.createElement(i.a.Fragment,null),rS=({addPadding:e=!1,defaultValues:t,isReadOnlyView:a,isLoading:r,isUpdateView:s=!1,onSubmit:l,setForm:c,actionMessageParams:u})=>{const[d,p]=aS(),{services:{application:f,triggersActionsUi:{actionTypeRegistry:g}}}=Object(m.j)(),b=Object(n.useMemo)((()=>f.getUrlForApp(`${o.l}`,{absolute:!0})),[f]),h={...null!=t?t:nS,kibanaSiemAppUrl:b},y=Object(n.useMemo)((()=>(({actionTypeRegistry:e})=>({actions:{validations:[{validator:Zx(e)}]},enabled:{},kibanaSiemAppUrl:{},throttle:{label:S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepRuleActions.fieldThrottleLabel",{defaultMessage:"Actions frequency"}),helpText:S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepRuleActions.fieldThrottleHelpText",{defaultMessage:"Select when automated actions should be performed if a rule evaluates as true."})}}))({actionTypeRegistry:g})),[g]),{form:v}=Object(Tv.l)({defaultValue:h,options:{stripEmptyFields:!1},schema:y}),{getFields:E,getFormData:T,submit:k}=v,[{throttle:x}]=Object(Tv.n)({form:v,watch:["throttle"]}),w=x||h.throttle,O=Object(n.useCallback)((e=>{E().enabled.setValue(e),l&&l()}),[E,l]),j=Object(n.useCallback)((async()=>{const e=await k();return null!=e&&e.isValid?e:{isValid:!1,data:T()}}),[T,k]);Object(n.useEffect)((()=>{let e=!1;return c&&!e&&c(uy.a.ruleActions,j),()=>{e=!0}}),[j,c]);const C=Object(n.useMemo)((()=>(e=>e&&Object(me.findIndex)(["value",e],kv)<0?[...kv,{value:e,text:e}]:kv)(w)),[w]),I=Object(n.useMemo)((()=>({idAria:"detectionEngineStepRuleActionsThrottle",isDisabled:r,isLoading:d,dataTestSubj:"detectionEngineStepRuleActionsThrottle",hasNoInitialSelection:!1,euiFieldProps:{options:C}})),[r,d,C]),M=Object(n.useMemo)((()=>w!==nS.throttle?i.a.createElement(i.a.Fragment,null,i.a.createElement(_.EuiSpacer,null),i.a.createElement(Tv.f,{path:"actions",component:$x,componentProps:{messageVariables:u,hasErrorOnCreationCaseAction:p}})):i.a.createElement(Tv.f,{path:"actions",component:iS})),[w,u,p]),A=Object(n.useMemo)((()=>f.capabilities.actions.show?i.a.createElement(i.a.Fragment,null,i.a.createElement(Tv.f,{path:"throttle",component:Sv,componentProps:I}),M,i.a.createElement(Tv.f,{path:"kibanaSiemAppUrl",component:iS}),i.a.createElement(Tv.f,{path:"enabled",component:iS})):i.a.createElement(i.a.Fragment,null,i.a.createElement(_.EuiText,null,Kx),i.a.createElement(Tv.f,{path:"throttle",componentProps:I,component:iS}),i.a.createElement(Tv.f,{path:"actions",component:iS}),i.a.createElement(Tv.f,{path:"kibanaSiemAppUrl",component:iS}),i.a.createElement(Tv.f,{path:"enabled",component:iS}))),[f.capabilities.actions.show,M,I]);return a?i.a.createElement(jE,{addPadding:e},i.a.createElement(Cv,{schema:y,data:h,columns:"single"})):i.a.createElement(i.a.Fragment,null,i.a.createElement(jE,{addPadding:!s},i.a.createElement(Tv.d,{form:v,"data-test-subj":"stepRuleActions"},i.a.createElement(_.EuiForm,null,A))),!s&&i.a.createElement(i.a.Fragment,null,i.a.createElement(_.EuiHorizontalRule,{margin:"m"}),i.a.createElement(_.EuiFlexGroup,{alignItems:"center",justifyContent:"flexEnd",gutterSize:"xs",responsive:!1},i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(_.EuiButton,{fill:!1,isDisabled:r,isLoading:r,onClick:()=>O(!1)},Wx)),i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(_.EuiButton,{fill:!0,isDisabled:r,isLoading:r,onClick:()=>O(!0),"data-test-subj":"create-activate"},Gx)))))},sS=Object(n.memo)(rS),oS=S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.pageTitle",{defaultMessage:"Create new rule"}),lS=S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.backToRulesButton",{defaultMessage:"Rules"}),cS=S.i18n.translate("xpack.securitySolution.detectionEngine.createRule.editRuleButton",{defaultMessage:"Edit"});var uS=a(477);const dS=async()=>{},pS=L()(_.EuiPanel).withConfig({displayName:"MyEuiPanel",componentId:"sc-wzrzmg-0"})(["position:relative;z-index:",";> .euiAccordion > .euiAccordion__triggerWrapper{.euiAccordion__button{cursor:default !important;&:hover{text-decoration:none !important;}}.euiAccordion__iconWrapper{display:none;}}"],(e=>e.zindex));pS.displayName="MyEuiPanel";const mS=L()(_.EuiAccordion).withConfig({displayName:"StepDefineRuleAccordion",componentId:"sc-wzrzmg-1"})([".euiAccordion__childWrapper{overflow:visible;}"]);mS.displayName="StepDefineRuleAccordion";const fS=()=>{var e,t;const[{loading:a,isSignalIndexExists:r,isAuthenticated:l,hasEncryptionKey:c,canUserCRUD:p}]=Object(dt.b)(),{loading:f,needsConfiguration:g}=Bt(),{navigateToApp:b}=Object(m.j)().services.application,h=a||f,[,y]=Object(we.h)(),[v,E]=Object(n.useState)(uy.a.defineRule),T=Object(n.useRef)(null),k=Object(n.useRef)(null),x=Object(n.useRef)(null),w=Object(n.useRef)(null),O=Object(n.useRef)({[uy.a.defineRule]:dS,[uy.a.aboutRule]:dS,[uy.a.scheduleRule]:dS,[uy.a.ruleActions]:dS}),j=Object(n.useCallback)(((e,t)=>{O.current[e]=t}),[]),C=Object(n.useRef)({[uy.a.defineRule]:{isValid:!1,data:void 0},[uy.a.aboutRule]:{isValid:!1,data:void 0},[uy.a.scheduleRule]:{isValid:!1,data:void 0},[uy.a.ruleActions]:{isValid:!1,data:void 0}}),I=(e,t)=>{C.current[e]=t},[M,A]=Object(n.useState)({[uy.a.defineRule]:!1,[uy.a.aboutRule]:!1,[uy.a.scheduleRule]:!1,[uy.a.ruleActions]:!1}),[{isLoading:q,ruleId:D},P]=(()=>{const[e,t]=Object(n.useState)(null),[a,i]=Object(n.useState)(null),[r,s]=Object(n.useState)(!1),{addError:o}=Object(Oe.a)();return Object(n.useEffect)((()=>{let t=!0;const a=new AbortController;return i(null),(async()=>{if(null!=e){try{s(!0);const n=await Object(Nn.b)({rule:Object(Mf.b)(e),signal:a.signal});t&&i(n.id)}catch(e){t&&o(e,{title:Af.g})}t&&s(!1)}})(),()=>{t=!1,a.abort()}}),[e,o]),[{isLoading:r,ruleId:a},t]})(),R=null===(e=C.current[uy.a.defineRule].data)||void 0===e?void 0:e.ruleType,F=null===(t=C.current[uy.a.aboutRule].data)||void 0===t?void 0:t.name,N=Object(n.useMemo)((()=>Di(R)),[R]),L=Object(n.useCallback)(((e,t)=>A((a=>({...a,[e]:t})))),[]),B=Object(n.useCallback)((e=>{uS.b.indexOf(e)>uS.b.indexOf(v)&&!M[e]&&z(e),E(e)}),[v,M]),z=e=>{var t;if(e===uy.a.defineRule)null===(t=T.current)||void 0===t||t.onToggle();else if(e===uy.a.aboutRule){var a;null===(a=k.current)||void 0===a||a.onToggle()}else if(e===uy.a.scheduleRule){var n;null===(n=x.current)||void 0===n||n.onToggle()}else if(e===uy.a.ruleActions){var i;null===(i=w.current)||void 0===i||i.onToggle()}},H=Object(n.useCallback)((async e=>{const t=await O.current[v]();null!=t&&t.isValid&&(I(v,t),B(e))}),[v,B]),U=Object(n.useCallback)((async e=>{const t=await O.current[e]();if(null!=t&&t.isValid){I(e,t);const a=(e=>uS.b[uS.b.indexOf(e)+1])(e);if(null!=a)B(a);else{const e=C.current[uy.a.defineRule],t=C.current[uy.a.aboutRule],a=C.current[uy.a.scheduleRule],n=C.current[uy.a.ruleActions];ty(e)&&ty(t)&&ty(a)&&ty(n)&&P(cy(e.data,t.data,a.data,n.data))}}}),[B,P]),$=Object(n.useCallback)((e=>e===v?"active":C.current[e].isValid?"valid":"passive"),[v]),Q=Object(n.useCallback)((()=>{U(uy.a.defineRule)}),[U]),V=i.a.createElement(Yh,{name:"1",title:Mn.K,type:$(uy.a.defineRule)}),W=i.a.createElement(Yh,{name:"2",title:Mn.b,type:$(uy.a.aboutRule)}),G=i.a.createElement(Yh,{name:"3",title:Mn.yb,type:$(uy.a.scheduleRule)}),K=i.a.createElement(Yh,{name:"4",title:Mn.wb,type:$(uy.a.ruleActions)});return F&&D?(Object(we.e)((e=>S.i18n.translate("xpack.securitySolution.detectionEngine.rules.create.successfullyCreatedRuleTitle",{values:{ruleName:e},defaultMessage:"{ruleName} was created"}))(F),y),b(o.l,{deepLinkId:s.a.rules,path:Object(ve.d)(D)}),null):Ai(r,l,c,g)?(b(o.l,{deepLinkId:s.a.alerts,path:Object(ve.b)()}),null):Pi(p)?i.a.createElement(i.a.Fragment,null,i.a.createElement(d.a,null,i.a.createElement(_.EuiFlexGroup,{direction:"row",justifyContent:"spaceAround"},i.a.createElement(Ri,null,i.a.createElement(Mt,{backOptions:{path:Object(ve.e)(),text:lS,pageId:s.a.rules},isLoading:q||h,title:oS}),i.a.createElement(pS,{zindex:4,hasBorder:!0},i.a.createElement(mS,{initialIsOpen:!0,id:uy.a.defineRule,buttonContent:V,paddingSize:"xs",ref:T,onToggle:L.bind(null,uy.a.defineRule),extraAction:C.current[uy.a.defineRule].isValid&&i.a.createElement(_.EuiButtonEmpty,{"data-test-subj":"edit-define-rule",iconType:"pencil",size:"xs",onClick:()=>H(uy.a.defineRule)},cS)},i.a.createElement(_.EuiHorizontalRule,{margin:"m"}),i.a.createElement(Rk,{addPadding:!0,defaultValues:C.current[uy.a.defineRule].data,isReadOnlyView:v!==uy.a.defineRule,isLoading:q||h,setForm:j,onSubmit:Q,descriptionColumns:"singleSplit"}))),i.a.createElement(_.EuiSpacer,{size:"l"}),i.a.createElement(pS,{hasBorder:!0,zindex:3},i.a.createElement(_.EuiAccordion,{initialIsOpen:!1,id:uy.a.aboutRule,buttonContent:W,paddingSize:"xs",ref:k,onToggle:L.bind(null,uy.a.aboutRule),extraAction:C.current[uy.a.aboutRule].isValid&&i.a.createElement(_.EuiButtonEmpty,{"data-test-subj":"edit-about-rule",iconType:"pencil",size:"xs",onClick:()=>H(uy.a.aboutRule)},cS)},i.a.createElement(_.EuiHorizontalRule,{margin:"m"}),i.a.createElement(Ox,{addPadding:!0,defaultValues:C.current[uy.a.aboutRule].data,defineRuleData:C.current[uy.a.defineRule].data,descriptionColumns:"singleSplit",isReadOnlyView:v!==uy.a.aboutRule,isLoading:q||h,setForm:j,onSubmit:()=>U(uy.a.aboutRule)}))),i.a.createElement(_.EuiSpacer,{size:"l"}),i.a.createElement(pS,{hasBorder:!0,zindex:2},i.a.createElement(_.EuiAccordion,{initialIsOpen:!1,id:uy.a.scheduleRule,buttonContent:G,paddingSize:"xs",ref:x,onToggle:L.bind(null,uy.a.scheduleRule),extraAction:C.current[uy.a.scheduleRule].isValid&&i.a.createElement(_.EuiButtonEmpty,{iconType:"pencil",size:"xs",onClick:()=>H(uy.a.scheduleRule)},cS)},i.a.createElement(_.EuiHorizontalRule,{margin:"m"}),i.a.createElement(_x,{ruleType:R,addPadding:!0,defaultValues:C.current[uy.a.scheduleRule].data,descriptionColumns:"singleSplit",isReadOnlyView:v!==uy.a.scheduleRule,isLoading:q||h,setForm:j,onSubmit:()=>U(uy.a.scheduleRule)}))),i.a.createElement(_.EuiSpacer,{size:"l"}),i.a.createElement(pS,{hasBorder:!0,zindex:1},i.a.createElement(_.EuiAccordion,{initialIsOpen:!1,id:uy.a.ruleActions,buttonContent:K,paddingSize:"xs",ref:w,onToggle:L.bind(null,uy.a.ruleActions),extraAction:C.current[uy.a.ruleActions].isValid&&i.a.createElement(_.EuiButtonEmpty,{iconType:"pencil",size:"xs",onClick:()=>H(uy.a.ruleActions)},cS)},i.a.createElement(_.EuiHorizontalRule,{margin:"m"}),i.a.createElement(sS,{addPadding:!0,defaultValues:C.current[uy.a.ruleActions].data,isReadOnlyView:v!==uy.a.ruleActions,isLoading:q||h,setForm:j,onSubmit:()=>U(uy.a.ruleActions),actionMessageParams:N})))))),i.a.createElement(u.a,{pageName:s.a.rules})):(b(o.l,{deepLinkId:s.a.rules,path:Object(ve.e)()}),null)},gS=i.a.memo(fS);var bS=a(354);const hS=S.i18n.translate("xpack.securitySolution.detectionEngine.details.stepAboutRule.detailsLabel",{defaultMessage:"Details"}),yS=S.i18n.translate("xpack.securitySolution.detectionEngine.details.stepAboutRule.aboutText",{defaultMessage:"About"}),vS=S.i18n.translate("xpack.securitySolution.detectionEngine.details.stepAboutRule.investigationGuideLabel",{defaultMessage:"Investigation guide"}),ES=S.i18n.translate("xpack.securitySolution.detectionEngine.details.stepAboutRule.controlLegend",{defaultMessage:"Viewing"}),TS=L()(_.EuiPanel).withConfig({displayName:"MyPanel",componentId:"sc-wtwaaw-0"})(["position:relative;"]),kS=L()(_.EuiFlexGroup).withConfig({displayName:"FlexGroupFullHeight",componentId:"sc-wtwaaw-1"})(["height:100%;"]),xS=L.a.div.withConfig({displayName:"VerticalOverflowContainer",componentId:"sc-wtwaaw-2"})((e=>({"max-height":`${e.maxHeight}px`,"overflow-y":"hidden","word-break":"break-word"}))),SS=L.a.div.withConfig({displayName:"VerticalOverflowContent",componentId:"sc-wtwaaw-3"})((e=>({"max-height":`${e.maxHeight}px`}))),wS=L.a.div.withConfig({displayName:"AboutContent",componentId:"sc-wtwaaw-4"})(["height:100%;"]),OS=[{id:"details",label:hS,"data-test-subj":"stepAboutDetailsToggle-details"},{id:"notes",label:vS,"data-test-subj":"stepAboutDetailsToggle-notes"}],jS=({stepData:e,stepDataDetails:t,loading:a})=>{const[r,s]=Object(n.useState)("details"),[o,l]=Object(n.useState)(0),c=Object(n.useCallback)((e=>{l(e.height)}),[l]);return i.a.createElement(TS,{hasBorder:!0},a&&i.a.createElement(i.a.Fragment,null,i.a.createElement(_.EuiProgress,{size:"xs",color:"accent",position:"absolute"}),i.a.createElement(La.a,{title:yS})),null!=e&&null!=t&&i.a.createElement(kS,{gutterSize:"xs",direction:"column"},i.a.createElement(_.EuiFlexItem,{grow:!1,key:"header"},i.a.createElement(La.a,{title:yS},!Object(me.isEmpty)(t.note)&&""!==t.note.trim()&&i.a.createElement(_.EuiButtonGroup,{options:OS,idSelected:r,onChange:e=>{s(e)},"data-test-subj":"stepAboutDetailsToggle",legend:ES}))),i.a.createElement(_.EuiFlexItem,{key:"details"},"details"===r?i.a.createElement(_.EuiResizeObserver,{"data-test-subj":"stepAboutDetailsContent",onResize:c},(a=>i.a.createElement(wS,{ref:a},i.a.createElement(xS,{maxHeight:120},i.a.createElement(SS,{maxHeight:120,className:"eui-yScrollWithShadows"},i.a.createElement(_.EuiText,{size:"s","data-test-subj":"stepAboutRuleDetailsToggleDescriptionText"},t.description))),i.a.createElement(_.EuiSpacer,{size:"m"}),i.a.createElement(Ox,{descriptionColumns:"singleSplit",isReadOnlyView:!0,isLoading:!1,defaultValues:e})))):i.a.createElement(xS,{"data-test-subj":"stepAboutDetailsNoteContent",maxHeight:o},i.a.createElement(SS,{maxHeight:o,className:"eui-yScrollWithShadows"},i.a.createElement(bS.b,null,t.note))))))},CS=Object(n.memo)(jS),IS=L()(_.EuiPanel).withConfig({displayName:"MyPanel",componentId:"sc-177nzsv-0"})(["position:relative;"]);IS.displayName="MyPanel";const MS=({children:e,loading:t,title:a})=>i.a.createElement(IS,{hasBorder:!0},t&&i.a.createElement(_.EuiProgress,{size:"xs",color:"accent",position:"absolute"}),i.a.createElement(La.a,{title:a}),e),AS=Object(n.memo)(MS),qS=S.i18n.translate("xpack.securitySolution.detectionEngine.rules.components.ruleActionsOverflow.allActionsTitle",{defaultMessage:"All actions"}),DS=L()(_.EuiButtonIcon).withConfig({displayName:"MyEuiButtonIcon",componentId:"sc-wltxb1-0"})(["&.euiButtonIcon{svg{transform:rotate(90deg);}border:1px solid  ",";width:40px;height:40px;}"],(({theme:e})=>e.euiColorPrimary)),PS=({rule:e,userHasPermissions:t,canDuplicateRuleWithActions:a})=>{const[r,,s,l]=Gb(),{navigateToApp:c}=Object(m.j)().services.application,[,u]=Object(we.h)(),d=Object(n.useCallback)((()=>{c(o.l,{deepLinkId:o.Kb.rules,path:Object(ve.e)()})}),[c]),p=Object(n.useMemo)((()=>null!=e?[i.a.createElement(_.EuiContextMenuItem,{key:Mn.T,icon:"copy",disabled:!a||!t,"data-test-subj":"rules-details-duplicate-rule",onClick:async()=>{s();const t=await pb([e],[e.id],me.noop,u);null!=t&&t.length&&db(t[0].id,c)}},i.a.createElement(_.EuiToolTip,{position:"left",content:Eb(e,!0,a)},i.a.createElement(i.a.Fragment,null,Mn.T))),i.a.createElement(_.EuiContextMenuItem,{key:Mn.ab,icon:"exportAction",disabled:!t||e.immutable,"data-test-subj":"rules-details-export-rule",onClick:async()=>{s(),await mb([e.rule_id],me.noop,u)}},Mn.ab),i.a.createElement(_.EuiContextMenuItem,{key:Mn.R,icon:"trash",disabled:!t,"data-test-subj":"rules-details-delete-rule",onClick:async()=>{s(),await fb([e.id],me.noop,u,d)}},Mn.R)]:[]),[a,s,u,c,d,e,t]),f=Object(n.useMemo)((()=>i.a.createElement(_.EuiToolTip,{position:"top",content:qS},i.a.createElement(DS,{iconType:"boxesHorizontal","aria-label":qS,isDisabled:!t,"data-test-subj":"rules-details-popover-button-icon",onClick:l}))),[l,t]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(_.EuiPopover,{anchorPosition:"leftCenter",button:f,closePopover:s,id:"ruleActionsOverflow",isOpen:r,"data-test-subj":"rules-details-popover",ownFocus:!0,panelPaddingSize:"none",repositionOnScroll:!0},i.a.createElement(_.EuiContextMenuPanel,{"data-test-subj":"rules-details-menu-panel",items:p})))},RS=i.a.memo(PS);RS.displayName="RuleActionsOverflow";const FS=S.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.pageTitle",{defaultMessage:"Rule details"}),_S=S.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.backToRulesButton",{defaultMessage:"Rules"}),NS=(S.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.experimentalDescription",{defaultMessage:"Experimental"}),S.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.activateRuleLabel",{defaultMessage:"Activate"})),LS=S.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.unknownDescription",{defaultMessage:"Unknown"}),BS=S.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.errorCalloutTitle",{defaultMessage:"Rule failure at"}),zS=S.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.partialErrorCalloutTitle",{defaultMessage:"Warning at"}),HS=S.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.failureHistoryTab",{defaultMessage:"Failure History"}),US=S.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.lastFiveErrorsTitle",{defaultMessage:"Last five errors"}),$S=S.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.statusTypeColumn",{defaultMessage:"Type"}),QS=S.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.statusFailedAtColumn",{defaultMessage:"Failed at"}),VS=S.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.statusFailedMsgColumn",{defaultMessage:"Failed message"}),WS=S.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.statusFailedDescription",{defaultMessage:"Failed"}),GS=S.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.exceptionsTab",{defaultMessage:"Exceptions"}),KS=S.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.deletedRule",{defaultMessage:"Deleted rule"}),YS=({date:e,message:t,color:a})=>i.a.createElement(_.EuiCallOut,{title:i.a.createElement(_.EuiFlexGroup,{gutterSize:"xs",alignItems:"center",justifyContent:"flexStart"},i.a.createElement(_.EuiFlexItem,{grow:!1},"warning"===a?zS:BS),i.a.createElement(_.EuiFlexItem,{grow:!0},i.a.createElement(ws.a,{value:e,fieldName:"last_failure_at"}))),color:a||"danger",iconType:"alert"},i.a.createElement("p",null,t)),JS=Object(n.memo)(YS),XS=()=>i.a.createElement(_.EuiHealth,{color:"danger"},WS),ZS=e=>i.a.createElement(ws.a,{value:e,fieldName:"last_failure_at"}),ew=e=>i.a.createElement(i.a.Fragment,null,e),tw=({id:e})=>{const[t,a]=Qg(e);if(t)return i.a.createElement(_.EuiPanel,{hasBorder:!0},i.a.createElement(La.a,{title:US}),i.a.createElement(_.EuiLoadingContent,null));const n=[{name:$S,render:XS,truncateText:!1,width:"16%"},{field:"last_failure_at",name:QS,render:ZS,sortable:!1,truncateText:!1,width:"24%"},{field:"last_failure_message",name:VS,render:ew,sortable:!1,truncateText:!1,width:"60%"}];return i.a.createElement(_.EuiPanel,{hasBorder:!0},i.a.createElement(La.a,{title:US}),i.a.createElement(_.EuiBasicTable,{columns:n,loading:t,items:null!=a?null==a?void 0:a.failures.filter((e=>null!=e.last_failure_at)):[],sorting:{sort:{field:"status_date",direction:"desc"}}}))},aw=Object(n.memo)(tw),nw=S.i18n.translate("xpack.securitySolution.detectionEngine.ruleStatus.statusDescription",{defaultMessage:"Last response"}),iw=S.i18n.translate("xpack.securitySolution.detectionEngine.ruleStatus.statusAtDescription",{defaultMessage:"at"}),rw=S.i18n.translate("xpack.securitySolution.detectionEngine.ruleStatus.statusDateDescription",{defaultMessage:"Status date"}),sw=(S.i18n.translate("xpack.securitySolution.detectionEngine.ruleStatus.refreshButton",{defaultMessage:"Refresh"}),({children:e,statusDate:t,status:a})=>i.a.createElement(i.a.Fragment,null,i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(_.EuiHealth,{color:kb(null!=a?a:null)},i.a.createElement(_.EuiText,{"data-test-subj":"ruleStatus",size:"xs"},null!=a?a:Object(wr.d)()))),null!=t&&null!=a&&i.a.createElement(i.a.Fragment,null,i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(i.a.Fragment,null,iw)),i.a.createElement(_.EuiFlexItem,{grow:!0},i.a.createElement(ws.a,{value:t,fieldName:rw}))),i.a.createElement(_.EuiFlexItem,{grow:!1},e))),ow=Object(n.memo)(sw);var lw=a(166);const cw=({isInitLoading:e,supportedListTypes:t,detectionsListItems:a,endpointListItems:r,onFilterChange:s,onAddExceptionClick:o})=>{const[l,c]=Object(n.useState)(""),[u,d]=Object(n.useState)([]),[p,m]=Object(n.useState)(!1),[f,g]=Object(n.useState)(!1),[b,h]=Object(n.useState)(!1);Object(n.useEffect)((()=>{s({filter:{filter:l,tags:u},pagination:{pageIndex:0},showDetectionsListsOnly:p,showEndpointListsOnly:f})}),[l,u,p,f,s]);const y=Object(n.useCallback)((()=>h(!b)),[h,b]),v=Object(n.useCallback)((()=>{m(!p),g(!1)}),[p,m,g]),E=Object(n.useCallback)((()=>{g(!f),m(!1)}),[f,g,m]),T=Object(n.useCallback)((e=>{const t=/(tags:[^\s]*)/i,a=e.match(t),n=null!=a?a[0].split(":")[1]:"",i=null!=a?e.replace(t,""):e;n.length>0&&d(n.split(",")),c(i.trim())}),[d,c]),k=Object(n.useCallback)((e=>{o(e),h(!1)}),[o,h]),x=Object(n.useMemo)((()=>[{id:0,items:[{name:lw.g,onClick:()=>k(Df.a.ENDPOINT),"data-test-subj":"addEndpointExceptionBtn"},{name:lw.f,onClick:()=>k(Df.a.DETECTION),"data-test-subj":"addDetectionsExceptionBtn"}]}]),[k]);return i.a.createElement(_.EuiFlexGroup,{alignItems:"center"},i.a.createElement(_.EuiFlexItem,{grow:!0},i.a.createElement(_.EuiFieldSearch,{"data-test-subj":"exceptionsHeaderSearch","aria-label":lw.O,placeholder:lw.O,onSearch:T,disabled:e,incremental:!1,fullWidth:!0})),1===t.length&&i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(_.EuiButton,{"data-test-subj":"exceptionsHeaderAddExceptionBtn",onClick:()=>k(t[0]),isDisabled:e,fill:!0},lw.d)),t.length>1&&i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(_.EuiFlexGroup,{alignItems:"center",justifyContent:"spaceBetween"},i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(_.EuiFilterGroup,{"data-test-subj":"exceptionsFilterGroupBtns"},i.a.createElement(_.EuiFilterButton,{"data-test-subj":"exceptionsDetectionFilterBtn",hasActiveFilters:p,onClick:v,isDisabled:e},lw.r,null!=a?` (${a})`:""),i.a.createElement(_.EuiFilterButton,{"data-test-subj":"exceptionsEndpointFilterBtn",hasActiveFilters:f,onClick:E,isDisabled:e},lw.v,null!=r?` (${r})`:""))),i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(_.EuiPopover,{button:i.a.createElement(_.EuiButton,{"data-test-subj":"exceptionsHeaderAddExceptionPopoverBtn",onClick:y,isDisabled:e,iconType:"arrowDown",iconSide:"right",fill:!0},lw.d),isOpen:b,closePopover:y,anchorPosition:"downCenter",panelPaddingSize:"none",repositionOnScroll:!0},i.a.createElement(_.EuiContextMenu,{initialPanelId:0,panels:x}))))))};cw.displayName="ExceptionsViewerHeaderComponent";const uw=i.a.memo(cw);uw.displayName="ExceptionsViewerHeader";const dw=({pagination:e,onPaginationChange:t})=>{const[a,r]=Object(n.useState)(!1),s=Object(n.useCallback)((()=>r(!1)),[r]),o=Object(n.useCallback)((()=>r((e=>!e))),[r]),l=Object(n.useCallback)((a=>{t({pagination:{pageIndex:a,pageSize:e.pageSize,totalItemCount:e.totalItemCount}})}),[e,t]),c=Object(n.useMemo)((()=>e.pageSizeOptions.map((a=>i.a.createElement(_.EuiContextMenuItem,{key:a,icon:"empty",onClick:()=>{t({pagination:{pageIndex:0,pageSize:a,totalItemCount:e.totalItemCount}}),s()},"data-test-subj":"exceptionsPerPageItem"},lw.F(a))))),[e,t,s]),u=Object(n.useMemo)((()=>e.totalItemCount>0?Math.ceil(e.totalItemCount/e.pageSize):1),[e]);return i.a.createElement(_.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"center"},i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(_.EuiPopover,{button:i.a.createElement(_.EuiButtonEmpty,{size:"s",color:"text",iconType:"arrowDown",iconSide:"right",onClick:o,"data-test-subj":"exceptionsPerPageBtn"},lw.B(e.pageSize)),isOpen:a,closePopover:s,panelPaddingSize:"none",repositionOnScroll:!0},i.a.createElement(_.EuiContextMenuPanel,{items:c}))),i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(_.EuiPagination,{pageCount:u,activePage:e.pageIndex,onPageClick:l,"data-test-subj":"exceptionsPagination"})))};dw.displayName="ExceptionsViewerPaginationComponent";const pw=i.a.memo(dw);pw.displayName="ExceptionsViewerPagination";const mw=L()(_.EuiText).withConfig({displayName:"StyledText",componentId:"sc-oztuyc-0"})(["font-style:italic;"]),fw=L()(_.EuiFlexGroup).withConfig({displayName:"MyUtilities",componentId:"sc-oztuyc-1"})(["height:50px;"]),gw=({pagination:e,showEndpointListsOnly:t,showDetectionsListsOnly:a,ruleSettingsUrl:n,onRefreshClick:r})=>{var s;return i.a.createElement(fw,{alignItems:"center",justifyContent:"spaceBetween"},i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(Ue.a,null,i.a.createElement(Ue.d,null,i.a.createElement(Ue.c,null,i.a.createElement(Ue.f,{dataTestSubj:"exceptionsShowing"},lw.P(null!==(s=e.totalItemCount)&&void 0!==s?s:0))),i.a.createElement(Ue.c,null,i.a.createElement(Ue.b,{dataTestSubj:"exceptionsRefresh",iconSide:"left",iconType:"refresh",onClick:r},lw.M))))),i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(mw,{size:"s"},t&&i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.exceptions.viewer.exceptionEndpointDetailsDescription",defaultMessage:"All exceptions to this rule are applied to the endpoint and the detection rule. View {ruleSettings} for more details.","data-test-subj":"exceptionsEndpointMessage",values:{ruleSettings:i.a.createElement(_.EuiLink,{href:n,target:"_blank"},i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.exceptions.viewer.exceptionEndpointDetailsDescription.ruleSettingsLink",defaultMessage:"rule settings"}))}}),a&&i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.exceptions.viewer.exceptionDetectionDetailsDescription",defaultMessage:"All exceptions to this rule are applied to the detection rule, not the endpoint. View {ruleSettings} for more details.","data-test-subj":"exceptionsDetectionsMessage",values:{ruleSettings:i.a.createElement(_.EuiLink,{href:n,target:"_blank"},i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.exceptions.viewer.exceptionDetectionDetailsDescription.ruleSettingsLink",defaultMessage:"rule settings"}))}}))))};gw.displayName="ExceptionsViewerUtilityComponent";const bw=i.a.memo(gw);bw.displayName="ExceptionsViewerUtility";var hw=a(255);const yw=({isNested:e,item:t})=>{var a;const n=Object(TT.h)(t),i=Object(TT.g)(t);return{fieldName:null!==(a=t.field)&&void 0!==a?a:"",operator:n.message,value:i,isNested:e}},vw=L()(_.EuiFlexItem).withConfig({displayName:"MyExceptionDetails",componentId:"sc-z36hrg-0"})(["",""],(({theme:e})=>Object(N.css)(["background-color:",";padding:",";.eventFiltersDescriptionList{margin:"," "," 0 ",";}.eventFiltersDescriptionListTitle{width:40%;margin-top:0;margin-bottom:",";}.eventFiltersDescriptionListDescription{width:60%;margin-top:0;margin-bottom:",";}"],e.eui.euiColorLightestShade,e.eui.euiSize,e.eui.euiSize,e.eui.euiSize,e.eui.euiSize,e.eui.euiSizeS,e.eui.euiSizeS))),Ew=L()(_.EuiFlexItem).withConfig({displayName:"StyledCommentsSection",componentId:"sc-z36hrg-1"})(["",""],(({theme:e})=>Object(N.css)(["&&&{margin:"," "," "," ",";}"],e.eui.euiSizeXS,e.eui.euiSize,e.eui.euiSizeL,e.eui.euiSize))),Tw=({showComments:e,showModified:t=!1,showName:a=!1,onCommentsClick:r,exceptionItem:s})=>{const o=Object(n.useMemo)((()=>((e,t=!1,a=!1)=>[...a?[{title:lw.E,value:e.name}]:[],{title:lw.G,value:Object(hw.j)(e.os_types)},{title:lw.n,value:Jn()(e.created_at).format("MMMM Do YYYY @ HH:mm:ss")},{title:lw.m,value:e.created_by},...t?[{title:lw.o,value:Jn()(e.updated_at).format("MMMM Do YYYY @ HH:mm:ss")},{title:lw.D,value:e.updated_by}]:[],{title:lw.q,value:e.description}].reduce(((e,{value:t,title:a})=>null!=t&&""!==t.trim()?[...e,{title:a,description:t}]:e),[]))(s,t,a)),[s,t,a]),l=Object(n.useMemo)((()=>{const{comments:t}=s;return t.length>0?i.a.createElement(_.EuiButtonEmpty,{onClick:r,flush:"left",size:"xs","data-test-subj":"exceptionsViewerItemCommentsBtn"},e?lw.j(t.length):lw.k(t.length)):i.a.createElement(i.a.Fragment,null)}),[e,r,s]);return i.a.createElement(vw,{grow:2},i.a.createElement(_.EuiFlexGroup,{direction:"column",alignItems:"flexStart"},i.a.createElement(_.EuiFlexItem,{grow:1,className:"eventFiltersDescriptionList"},i.a.createElement(_.EuiDescriptionList,{compressed:!0,type:"column","data-test-subj":"exceptionsViewerItemDetails"},o.map((e=>i.a.createElement(n.Fragment,{key:`${e.title}`},i.a.createElement(_.EuiToolTip,{content:e.title,anchorClassName:"eventFiltersDescriptionListTitle"},i.a.createElement(_.EuiDescriptionListTitle,{className:"eui-textTruncate eui-fullWidth"},e.title)),i.a.createElement(_.EuiToolTip,{content:e.description,anchorClassName:"eventFiltersDescriptionListDescription"},i.a.createElement(_.EuiDescriptionListDescription,{className:"eui-textBreakWord eui-textTruncate eui-fullWidth"},e.description))))))),i.a.createElement(Ew,{grow:!1},l)))};Tw.displayName="ExceptionDetailsComponent";const kw=i.a.memo(Tw);kw.displayName="ExceptionDetails";const xw=L()(_.EuiFlexItem).withConfig({displayName:"MyEntriesDetails",componentId:"sc-1tpcxfd-0"})(["",""],(({theme:e})=>Object(N.css)(["padding:"," "," "," ",";&&&{margin-left:0;}"],e.eui.euiSize,e.eui.euiSizeL,e.eui.euiSizeL,e.eui.euiSizeXS))),Sw=L()(_.EuiButton).withConfig({displayName:"MyEditButton",componentId:"sc-1tpcxfd-1"})(["",""],(({theme:e})=>Object(N.css)(["background-color:",";border:none;font-weight:",";"],Object(Ln.transparentize)(.9,e.eui.euiColorPrimary),e.eui.euiFontWeightSemiBold))),ww=L()(_.EuiButton).withConfig({displayName:"MyRemoveButton",componentId:"sc-1tpcxfd-2"})(["",""],(({theme:e})=>Object(N.css)(["background-color:",";border:none;font-weight:",";"],Object(Ln.transparentize)(.9,e.eui.euiColorDanger),e.eui.euiFontWeightSemiBold))),Ow=L()(_.EuiFlexItem).withConfig({displayName:"MyAndOrBadgeContainer",componentId:"sc-1tpcxfd-3"})(["",""],(({theme:e})=>Object(N.css)(["padding:"," "," "," 0;"],e.eui.euiSizeXL,e.eui.euiSize,e.eui.euiSizeS))),jw=L()(_.EuiFlexItem).withConfig({displayName:"MyActionButton",componentId:"sc-1tpcxfd-4"})(["align-self:flex-end;"]),Cw=L.a.div.withConfig({displayName:"MyNestedValueContainer",componentId:"sc-1tpcxfd-5"})(["margin-left:",";"],(({theme:e})=>e.eui.euiSizeL)),Iw=L.a.span.withConfig({displayName:"MyNestedValue",componentId:"sc-1tpcxfd-6"})(["margin-left:",";"],(({theme:e})=>e.eui.euiSizeS)),Mw=L()(_.EuiBadgeGroup).withConfig({displayName:"ValueBadgeGroup",componentId:"sc-1tpcxfd-7"})(["width:100%;"]),Aw=({entries:e,disableActions:t,onDelete:a,onEdit:r})=>{const s=Object(n.useMemo)((()=>[{field:"fieldName",name:"Field",sortable:!1,truncateText:!0,textOnly:!0,"data-test-subj":"exceptionFieldNameCell",width:"30%",render:(e,t)=>null!=e&&t.isNested?i.a.createElement(Cw,null,i.a.createElement(_.EuiIconTip,{type:"nested",size:"s"}),i.a.createElement(Iw,null,e)):null!=e?e:Object(wr.e)()},{field:"operator",name:"Operator",sortable:!1,truncateText:!0,"data-test-subj":"exceptionFieldOperatorCell",width:"20%",render:e=>null!=e?e:Object(wr.e)()},{field:"value",name:"Value",sortable:!1,truncateText:!0,"data-test-subj":"exceptionFieldValueCell",width:"60%",render:e=>Array.isArray(e)?i.a.createElement(Mw,{gutterSize:"xs"},e.map((e=>i.a.createElement(_.EuiBadge,{color:"#DDD",key:e},e)))):e?i.a.createElement(_.EuiToolTip,{content:e,anchorClassName:"eui-textTruncate"},i.a.createElement("span",null,e)):Object(wr.e)()}]),[e]);return i.a.createElement(xw,{grow:5},i.a.createElement(_.EuiFlexGroup,{direction:"column",gutterSize:"m"},i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(_.EuiFlexGroup,{direction:"row",gutterSize:"none"},e.length>1&&i.a.createElement(_.EuiHideFor,{sizes:["xs","s"]},i.a.createElement(Ow,{grow:!1},i.a.createElement(CT.a,{type:"and",includeAntennas:!0,"data-test-subj":"exceptionsViewerAndBadge"}))),i.a.createElement(_.EuiFlexItem,{grow:1},i.a.createElement(_.EuiBasicTable,{isSelectable:!1,itemId:"id",columns:s,items:e,responsive:!0})))),!t&&i.a.createElement(_.EuiFlexItem,{grow:1},i.a.createElement(_.EuiFlexGroup,{gutterSize:"s",justifyContent:"flexEnd"},i.a.createElement(jw,{grow:!1},i.a.createElement(Sw,{size:"s",color:"primary",onClick:r,"data-test-subj":"exceptionsViewerEditBtn"},lw.u)),i.a.createElement(jw,{grow:!1},i.a.createElement(ww,{size:"s",color:"danger",onClick:a,"data-test-subj":"exceptionsViewerDeleteBtn"},lw.N))))))};Aw.displayName="ExceptionEntriesComponent";const qw=i.a.memo(Aw);qw.displayName="ExceptionEntries";const Dw=L()(_.EuiFlexItem).withConfig({displayName:"MyFlexItem",componentId:"sc-l5qlm8-0"})(["&.comments--show{padding:",";border-top:",";}"],(({theme:e})=>e.eui.euiSize),(({theme:e})=>`${e.eui.euiBorderThin}`)),Pw=({disableActions:e,loadingItemIds:t,exceptionItem:a,commentsAccordionId:r,onDeleteException:s,onEditException:o,showModified:l=!1,showName:c=!1,"data-test-subj":u})=>{const[d,p]=Object(n.useState)([]),[m,f]=Object(n.useState)(!1);Object(n.useEffect)((()=>{const e=a.entries.map((e=>{if(Df.m.is(e)){const t={fieldName:e.field,operator:void 0,value:void 0,isNested:!1};return e.entries.reduce(((e,t)=>[...e,{...yw({isNested:!0,item:t})}]),[t])}return yw({isNested:!1,item:e})})).flat();p(e)}),[a.entries]);const g=Object(n.useCallback)((()=>{s({id:a.id,namespaceType:a.namespace_type})}),[s,a.id,a.namespace_type]),b=Object(n.useCallback)((()=>{o(a)}),[o,a]),h=Object(n.useCallback)((()=>{f(!m)}),[f,m]),y=Object(n.useMemo)((()=>Object(hw.k)(a.comments)),[a.comments]),v=Object(n.useMemo)((()=>t.filter((({id:e})=>e===a.id)).length>0),[t,a.id]);return i.a.createElement(_.EuiPanel,{paddingSize:"none","data-test-subj":u,hasBorder:!0,hasShadow:!1},i.a.createElement(_.EuiFlexGroup,{direction:"column",gutterSize:"none"},i.a.createElement(_.EuiFlexItem,null,i.a.createElement(_.EuiFlexGroup,{direction:"row"},i.a.createElement(kw,{showComments:m,exceptionItem:a,onCommentsClick:h,showModified:l,showName:c}),i.a.createElement(qw,{disableActions:v||e,entries:d,onDelete:g,onEdit:b}))),i.a.createElement(Dw,{className:m?"comments--show":""},i.a.createElement(_.EuiAccordion,{id:r,arrowDisplay:"none",forceState:m?"open":"closed","data-test-subj":"exceptionsViewerCommentAccordion"},i.a.createElement(_.EuiCommentList,{comments:y})))))};Pw.displayName="ExceptionItemComponent";const Rw=i.a.memo(Pw);Rw.displayName="ExceptionItem";const Fw=L()(_.EuiFlexItem).withConfig({displayName:"MyFlexItem",componentId:"sc-z8zhds-0"})(["margin:",";&:first-child{margin:",";}"],(({theme:e})=>`${e.eui.euiSize} 0`),(({theme:e})=>`${e.eui.euiSizeXS} 0 ${e.eui.euiSize}`)),_w=L()(_.EuiFlexGroup).withConfig({displayName:"MyExceptionsContainer",componentId:"sc-z8zhds-1"})(["height:600px;overflow:hidden;"]),Nw=L()(_.EuiFlexGroup).withConfig({displayName:"MyExceptionItemContainer",componentId:"sc-z8zhds-2"})(["margin:",";"],(({theme:e})=>`0 ${e.eui.euiSize} ${e.eui.euiSize} 0`)),Lw=({showEmpty:e,showNoResults:t,isInitLoading:a,exceptions:n,loadingItemIds:r,commentsAccordionId:s,onDeleteException:o,onEditExceptionItem:l,disableActions:c})=>i.a.createElement(_w,{direction:"column",className:"eui-yScrollWithShadows"},e||t||a?i.a.createElement(_.EuiFlexItem,{grow:1},i.a.createElement(_.EuiEmptyPrompt,{iconType:t?"searchProfilerApp":"list",title:i.a.createElement("h2",{"data-test-subj":"exceptionsEmptyPromptTitle"},t?"":lw.y),body:i.a.createElement("p",{"data-test-subj":"exceptionsEmptyPromptBody"},t?lw.z:lw.x),"data-test-subj":"exceptionsEmptyPrompt"})):i.a.createElement(_.EuiFlexItem,{grow:!1,className:"eui-yScrollWithShadows"},i.a.createElement(Nw,{"data-test-subj":"exceptionsContainer",gutterSize:"none",direction:"column"},!a&&n.length>0&&n.map(((e,t)=>i.a.createElement(Fw,{"data-test-subj":"exceptionItemContainer",grow:!1,key:e.id},0!==t?i.a.createElement(i.a.Fragment,null,i.a.createElement(CT.a,{"data-test-subj":"exceptionItemOrBadge",type:"or"}),i.a.createElement(_.EuiSpacer,null)):i.a.createElement(_.EuiSpacer,{size:"s"}),i.a.createElement(Rw,{disableActions:c,loadingItemIds:r,commentsAccordionId:s,exceptionItem:e,onDeleteException:o,onEditException:l})))))));Lw.displayName="ExceptionsViewerItemsComponent";const Bw=i.a.memo(Lw);Bw.displayName="ExceptionsViewerItems";var zw=a(318),Hw=a(659);const Uw=S.i18n.translate("xpack.securitySolution.exceptions.editException.cancel",{defaultMessage:"Cancel"}),$w=S.i18n.translate("xpack.securitySolution.exceptions.editException.editExceptionSaveButton",{defaultMessage:"Save"}),Qw=S.i18n.translate("xpack.securitySolution.exceptions.editException.editExceptionTitle",{defaultMessage:"Edit Rule Exception"}),Vw=S.i18n.translate("xpack.securitySolution.exceptions.editException.editEndpointExceptionTitle",{defaultMessage:"Edit Endpoint Exception"}),Ww=(S.i18n.translate("xpack.securitySolution.exceptions.editException.error",{defaultMessage:"Failed to update exception"}),S.i18n.translate("xpack.securitySolution.exceptions.editException.success",{defaultMessage:"Successfully updated exception"})),Gw=S.i18n.translate("xpack.securitySolution.exceptions.editException.bulkCloseLabel",{defaultMessage:"Close all alerts that match this exception and were generated by this rule"}),Kw=S.i18n.translate("xpack.securitySolution.exceptions.editException.bulkCloseLabel.disabled",{defaultMessage:"Close all alerts that match this exception and were generated by this rule (Lists and non-ECS fields are not supported)"}),Yw=S.i18n.translate("xpack.securitySolution.exceptions.editException.endpointQuarantineText",{defaultMessage:"On all Endpoint hosts, quarantined files that match the exception are automatically restored to their original locations. This exception applies to all rules using Endpoint exceptions."}),Jw=S.i18n.translate("xpack.securitySolution.exceptions.editException.infoLabel",{defaultMessage:"Alerts are generated when the rule's conditions are met, except when:"}),Xw=S.i18n.translate("xpack.securitySolution.exceptions.editException.versionConflictTitle",{defaultMessage:"Sorry, there was an error"}),Zw=S.i18n.translate("xpack.securitySolution.exceptions.editException.versionConflictDescription",{defaultMessage:"It appears this exception was updated since you first selected to edit it. Try clicking 'Cancel' and editing the exception again."}),eO=S.i18n.translate("xpack.securitySolution.exceptions.editException.sequenceWarning",{defaultMessage:"This rule's query contains an EQL sequence statement. The exception modified will apply to all events in the sequence."});var tO=a(657),aO=a(463),nO=a(793),iO=a(794);const rO=L()(_.EuiModal).withConfig({displayName:"Modal",componentId:"sc-1xmfgey-0"})(["",""],(({theme:e})=>Object(N.css)(["width:",";max-width:",";"],e.eui.euiBreakpoints.l,e.eui.euiBreakpoints.l))),sO=L()(_.EuiModalHeader).withConfig({displayName:"ModalHeader",componentId:"sc-1xmfgey-1"})(["flex-direction:column;align-items:flex-start;"]),oO=L.a.div.withConfig({displayName:"ModalHeaderSubtitle",componentId:"sc-1xmfgey-2"})(["",""],(({theme:e})=>Object(N.css)(["color:",";"],e.eui.euiColorMediumShade))),lO=L.a.section.withConfig({displayName:"ModalBodySection",componentId:"sc-1xmfgey-3"})(["",""],(({theme:e})=>Object(N.css)(["padding:"," ",";&.builder-section{overflow-y:scroll;}"],e.eui.euiSizeS,e.eui.euiSizeL))),cO=Object(n.memo)((function({ruleName:e,ruleId:t,ruleIndices:a,exceptionItem:r,exceptionListType:s,onCancel:o,onConfirm:l,onRuleChange:c}){const{http:u,data:d}=Object(m.j)().services,[p,f]=Object(n.useState)(""),[g,b]=Object(n.useState)(!1),{rule:h,loading:y}=Object(Hw.a)(t),[v,E]=Object(n.useState)(null),[T,k]=Object(n.useState)(!1),[x,S]=Object(n.useState)(!1),[w,O]=Object(n.useState)(!1),[j,C]=Object(n.useState)([]),{addError:I,addSuccess:M}=Object(Oe.a)(),{loading:A,signalIndexName:q}=Object(zw.a)(),D=Object(n.useMemo)((()=>null!==q?[q]:[]),[q]),[P,{indexPatterns:R}]=Object(op.b)(D),F=Object(n.useMemo)((()=>{var e;return null!==(e=null==h?void 0:h.machine_learning_job_id)&&void 0!==e?e:[]}),[h]),{loading:N,jobs:L}=Object(iO.a)(F),B=Object(n.useMemo)((()=>L.length>0?L[0].results_index_name?[`.ml-anomalies-${L[0].results_index_name}`]:[]:a),[L,a]),[z,{indexPatterns:H}]=Object(op.b)(B),U=Object(n.useCallback)(((e,t,a)=>{e.message.includes("Conflict")?k(!0):E({reason:e.message,code:t,details:a,listListId:r.list_id})}),[E,k,r.list_id]),$=Object(n.useCallback)((e=>{M(lw.t(e)),c&&c(),o()}),[M,o,c]),Q=Object(n.useCallback)((e=>{I(e,{title:lw.s}),o()}),[I,o]),V=Object(n.useCallback)((()=>{M(Ww),l()}),[M,l]),[{isLoading:W},G]=Object(tO.a)({http:u,onSuccess:V,onError:U});Object(n.useEffect)((()=>{!1===P&&!1===A&&O(Object(hw.f)(j)||Object(hw.g)(j,R)||j.every((e=>0===e.entries.length)))}),[O,j,P,A,R]),Object(n.useEffect)((()=>{!0===w&&S(!1)}),[w]);const K=Object(n.useMemo)((()=>j.every((e=>0===e.entries.length))||T||g),[j,T,g]),Y=Object(n.useCallback)((({exceptionItems:e,errorExists:t})=>{C(e),b(t)}),[C]),J=Object(n.useCallback)((e=>{f(e)}),[f]),X=Object(n.useCallback)((e=>{S(e.currentTarget.checked)}),[S]),Z=Object(n.useCallback)((()=>{const[e]=j;let t=[{...Object(hw.d)(e,[...r.comments,...""!==p.trim()?[{comment:p}]:[]])}];return"endpoint"===s&&(t=Object(hw.l)(Object(hw.c)(t,r.os_types))),t}),[j,r,p,s]),ee=Object(n.useCallback)((()=>{if(null!==G){const e=x&&null!==q?[q]:void 0;G(t,Z(),void 0,e)}}),[G,t,Z,x,q]),te=Object(n.useMemo)((()=>null!=h&&(Object(ti.c)(h.type)&&Object(ti.b)(h.query))),[h]);return i.a.createElement(rO,{onClose:o,"data-test-subj":"add-exception-modal"},i.a.createElement(sO,null,i.a.createElement(_.EuiModalHeaderTitle,null,"endpoint"===s?Vw:Qw),i.a.createElement(_.EuiSpacer,{size:"xs"}),i.a.createElement(oO,{className:"eui-textTruncate",title:e},e)),(W||z||A)&&i.a.createElement(un.a,{"data-test-subj":"loadingEditExceptionModal",size:"xl"}),!A&&!W&&!z&&!y&&!N&&i.a.createElement(i.a.Fragment,null,i.a.createElement(lO,{className:"builder-section"},te&&i.a.createElement(i.a.Fragment,null,i.a.createElement(_.EuiCallOut,{"data-test-subj":"eql-sequence-callout",title:eO}),i.a.createElement(_.EuiSpacer,null)),i.a.createElement(_.EuiText,null,Jw),i.a.createElement(_.EuiSpacer,null),"endpoint"===s&&i.a.createElement(i.a.Fragment,null,i.a.createElement(_.EuiText,{size:"xs"},i.a.createElement("dl",null,i.a.createElement("dt",null,lw.H),i.a.createElement("dd",null,r.os_types.reduce(((e,t)=>`${(e=>"linux"===e?lw.I:"macos"===e?lw.J:lw.K)(t)}, ${e}`),"").slice(0,-2)))),i.a.createElement(_.EuiSpacer,null)),Tv.a.getExceptionBuilderComponentLazy({allowLargeValueLists:!Object(ti.c)(null==h?void 0:h.type)&&!Object(ti.f)(null==h?void 0:h.type),httpService:u,autocompleteService:d.autocomplete,exceptionListItems:[r],listType:s,listId:r.list_id,listNamespaceType:r.namespace_type,listTypeSpecificIndexPatternFilter:hw.h,ruleName:e,isOrDisabled:!0,isAndDisabled:!1,osTypes:r.os_types,isNestedDisabled:!1,dataTestSubj:"edit-exception-modal-builder",idAria:"edit-exception-modal-builder",onChange:Y,indexPatterns:H}),i.a.createElement(_.EuiSpacer,null),i.a.createElement(aO.a,{exceptionItemComments:r.comments,newCommentValue:p,newCommentOnChange:J})),i.a.createElement(_.EuiHorizontalRule,null),i.a.createElement(lO,null,i.a.createElement(_.EuiFormRow,{fullWidth:!0},i.a.createElement(_.EuiCheckbox,{"data-test-subj":"close-alert-on-add-edit-exception-checkbox",id:"close-alert-on-add-edit-exception-checkbox",label:w?Kw:Gw,checked:x,onChange:X,disabled:w})),"endpoint"===s&&i.a.createElement(i.a.Fragment,null,i.a.createElement(_.EuiSpacer,{size:"s"}),i.a.createElement(_.EuiText,{"data-test-subj":"edit-exception-endpoint-text",color:"subdued",size:"s"},Yw)))),null!=v&&i.a.createElement(lO,null,i.a.createElement(nO.a,{http:u,errorInfo:v,rule:h,onCancel:o,onSuccess:$,onError:Q})),T&&i.a.createElement(lO,null,i.a.createElement(_.EuiCallOut,{title:Xw,color:"danger",iconType:"alert"},i.a.createElement("p",null,Zw))),null==v&&i.a.createElement(_.EuiModalFooter,null,i.a.createElement(_.EuiButtonEmpty,{"data-test-subj":"cancelExceptionAddButton",onClick:o},Uw),i.a.createElement(_.EuiButton,{"data-test-subj":"edit-exception-confirm-button",onClick:ee,isLoading:W,isDisabled:K,fill:!0},$w)))}));var uO=a(771);const dO={filterOptions:{filter:"",tags:[]},pagination:{pageIndex:0,pageSize:20,totalItemCount:0,pageSizeOptions:[5,10,20,50,100,200,300]},exceptions:[],exceptionToEdit:null,loadingItemIds:[],isInitLoading:!0,currentModal:null,exceptionListTypeToEdit:null,totalEndpointItems:0,totalDetectionsItems:0,showEndpointListsOnly:!1,showDetectionsListsOnly:!1},pO=({ruleId:e,ruleName:t,ruleIndices:a,exceptionListsMeta:r,availableListTypes:s,commentsAccordionId:o,onRuleChange:l})=>{const{services:c}=Object(m.j)(),[,u]=Object(we.h)(),d=Object(n.useCallback)((({title:e,color:t,iconType:a})=>()=>{u({type:"addToaster",toast:{id:Na.a.v4(),title:e,color:t,iconType:a}})}),[u]),[{exceptions:p,filterOptions:f,pagination:g,loadingItemIds:b,isInitLoading:h,currentModal:y,exceptionToEdit:v,exceptionListTypeToEdit:E,totalEndpointItems:T,totalDetectionsItems:k,showDetectionsListsOnly:x,showEndpointListsOnly:S},w]=Object(n.useReducer)(((e,t)=>{switch(t.type){case"setExceptions":{var a;const{exceptions:n,pagination:i}=t;return{...e,pagination:{...e.pagination,pageIndex:i.page-1,pageSize:i.perPage,totalItemCount:null!==(a=i.total)&&void 0!==a?a:0},exceptions:n}}case"updateFilterOptions":{const{filter:a,pagination:n,showEndpointListsOnly:i,showDetectionsListsOnly:r}=t.filters;return{...e,filterOptions:{...e.filterOptions,...a},pagination:{...e.pagination,...n},showEndpointListsOnly:null!=i?i:e.showEndpointListsOnly,showDetectionsListsOnly:null!=r?r:e.showDetectionsListsOnly}}case"setExceptionItemTotals":return{...e,totalEndpointItems:null==t.totalEndpointItems?e.totalEndpointItems:t.totalEndpointItems,totalDetectionsItems:null==t.totalDetectionsItems?e.totalDetectionsItems:t.totalDetectionsItems};case"updateIsInitLoading":return{...e,isInitLoading:t.loading};case"updateLoadingItemIds":return{...e,loadingItemIds:[...e.loadingItemIds,...t.items]};case"updateExceptionToEdit":{const{exception:a,lists:n}=t,i=n.find((e=>null!==e&&a.list_id===e.listId));return{...e,exceptionToEdit:a,exceptionListTypeToEdit:i?i.type:null}}case"updateModalOpen":return{...e,currentModal:t.modalName};case"updateExceptionListTypeToEdit":return{...e,exceptionListTypeToEdit:t.exceptionListType};default:return e}}),{...dO}),{deleteExceptionItem:O,getExceptionListsItems:j}=Object(qt.c)(c.http),[C,I]=Object(n.useState)([]),[{canUserCRUD:M,hasIndexWrite:A}]=Object(dt.b)();Object(n.useEffect)((()=>{I(M&&A?s:[])}),[s,M,A]);const q=Object(n.useCallback)((({exceptions:e,pagination:t})=>{w({type:"setExceptions",lists:r,exceptions:e,pagination:t})}),[w,r]),[D,,,P]=Object(qt.g)({http:c.http,lists:r,filterOptions:""!==f.filter||f.tags.length>0?[f]:[],pagination:{page:g.pageIndex+1,perPage:g.pageSize,total:g.totalItemCount},showDetectionsListsOnly:x,showEndpointListsOnly:S,matchFilters:!0,onSuccess:q,onError:d({color:"danger",title:lw.A,iconType:"alert"})}),R=Object(n.useCallback)((e=>{w({type:"updateModalOpen",modalName:e})}),[w]),F=Object(n.useCallback)(((e,t)=>{w({type:"setExceptionItemTotals",totalEndpointItems:e,totalDetectionsItems:t})}),[w]),N=Object(n.useCallback)((async()=>{await j({lists:r,filterOptions:[],pagination:{page:0,perPage:1,total:0},showDetectionsListsOnly:!0,showEndpointListsOnly:!1,onSuccess:({pagination:e})=>{var t;F(null,null!==(t=e.total)&&void 0!==t?t:0)},onError:()=>{d({color:"danger",title:lw.Q,iconType:"alert"})()}}),await j({lists:r,filterOptions:[],pagination:{page:0,perPage:1,total:0},showDetectionsListsOnly:!1,showEndpointListsOnly:!0,onSuccess:({pagination:e})=>{var t;F(null!==(t=e.total)&&void 0!==t?t:0,null)},onError:()=>{d({color:"danger",title:lw.Q,iconType:"alert"})()}})}),[F,r,j,d]),L=Object(n.useCallback)((()=>{null!=P&&(P(),N())}),[P,N]),B=Object(n.useCallback)((e=>{w({type:"updateFilterOptions",filters:e})}),[w]),z=Object(n.useCallback)((e=>{w({type:"updateExceptionListTypeToEdit",exceptionListType:e}),R("addModal")}),[R]),H=Object(n.useCallback)((e=>{w({type:"updateExceptionToEdit",lists:r,exception:e}),R("editModal")}),[R,r]),U=Object(n.useCallback)((()=>{R(null),L()}),[R,L]),$=Object(n.useCallback)((()=>{R(null),L()}),[R,L]),Q=Object(n.useCallback)((e=>{w({type:"updateLoadingItemIds",items:e})}),[w]),V=Object(n.useCallback)((({id:e,namespaceType:t})=>{Q([{id:e,namespaceType:t}]),O({id:e,namespaceType:t,onSuccess:()=>{Q(b.filter((({id:t})=>t!==e))),L()},onError:()=>{d({color:"danger",title:lw.p,iconType:"alert"})(),Q(b.filter((({id:t})=>t!==e)))}})}),[Q,O,b,L,d]);Object(n.useEffect)((()=>{!h||D||0!==p.length&&null==p||(N(),w({type:"updateIsInitLoading",loading:!1}))}),[N,h,p,D,w]);const W=c.application.getUrlForApp(`security/detections/rules/id/${encodeURI(e)}/edit`),G=!h&&!D&&0===T&&0===k,K=0===p.length&&(T>0||k>0);return i.a.createElement(i.a.Fragment,null,"editModal"===y&&null!=v&&null!=E&&i.a.createElement(cO,{ruleName:t,ruleId:e,ruleIndices:a,exceptionListType:E,exceptionItem:v,onCancel:U,onConfirm:$,onRuleChange:l}),"addModal"===y&&null!=E&&i.a.createElement(uO.a,{ruleName:t,ruleIndices:a,ruleId:e,exceptionListType:E,onCancel:U,onConfirm:$,onRuleChange:l}),i.a.createElement(qs.a,{loading:h||D},(h||D)&&i.a.createElement(un.a,{"data-test-subj":"loadingPanelAllRulesTable",overlay:!0,size:"xl"}),i.a.createElement(uw,{isInitLoading:h,supportedListTypes:C,detectionsListItems:k,endpointListItems:T,onFilterChange:B,onAddExceptionClick:z}),i.a.createElement(_.EuiSpacer,{size:"l"}),i.a.createElement(bw,{pagination:g,showEndpointListsOnly:S,showDetectionsListsOnly:x,onRefreshClick:L,ruleSettingsUrl:W}),i.a.createElement(Bw,{disableActions:!M||!A,showEmpty:G,showNoResults:K,isInitLoading:h,exceptions:p,loadingItemIds:b,commentsAccordionId:o,onDeleteException:V,onEditExceptionItem:H}),i.a.createElement(pw,{onPaginationChange:B,pagination:g})))};pO.displayName="ExceptionsViewerComponent";const mO=i.a.memo(pO);mO.displayName="ExceptionsViewer";var fO=a(637);const gO=L.a.div.withConfig({displayName:"StyledFullHeightContainer",componentId:"sc-ycgey0-0"})(["display:flex;flex-direction:column;flex:1 1 auto;"]);var bO;!function(e){e.alerts="alerts",e.failures="failures",e.exceptions="exceptions"}(bO||(bO={}));const hO=[{id:bO.alerts,name:ft,disabled:!1,dataTestSubj:"alertsTab"},{id:bO.exceptions,name:GS,disabled:!1,dataTestSubj:"exceptionsTab"},{id:bO.failures,name:HS,disabled:!1,dataTestSubj:"failureHistoryTab"}],yO=({clearEventsDeleted:e,clearEventsLoading:t,clearSelected:a})=>{var r,c,p,g;const{navigateToApp:T}=Object(m.j)().services.application,k=Object(b.useDispatch)(),x=Object(n.useRef)(null),w=Object(n.useMemo)((()=>y.b.getTimelineByIdSelector()),[]),O=Object(be.b)((e=>{var t;return(null!==(t=w(e,h.q.detectionsRulesDetailsPage))&&void 0!==t?t:Re.a).graphEventId})),j=Object(be.b)((e=>{var t;return(null!==(t=w(e,h.q.detectionsRulesDetailsPage))&&void 0!==t?t:Re.a).updated})),C=Object(be.b)((e=>{var t;return(null!==(t=w(e,h.q.detectionsPage))&&void 0!==t?t:Re.a).isLoading})),I=Object(n.useMemo)((()=>Te.d.globalFiltersQuerySelector()),[]),M=Object(n.useMemo)((()=>Te.d.globalQuerySelector()),[]),A=Object(be.a)(M),q=Object(be.a)(I),{to:D,from:P}=Object(he.a)(),[{loading:R,isSignalIndexExists:F,isAuthenticated:N,hasEncryptionKey:L,canUserCRUD:B,hasIndexWrite:z,hasIndexRead:H,hasIndexMaintenance:U,signalIndexName:$}]=Object(dt.b)(),{loading:Q,needsConfiguration:V}=Bt(),W=R||Q,{detailName:G}=Object(l.useParams)(),{rule:K,refresh:Y,loading:J,isExistingRule:X}=Object(fO.a)(G),[Z,ee,te]=Qg(G),[ae,ne]=Object(n.useState)(null!==(r=null==ee?void 0:ee.current_status)&&void 0!==r?r:null);Object(n.useEffect)((()=>{var e;Ki()(ae,null==ee?void 0:ee.current_status)||ne(null!==(e=null==ee?void 0:ee.current_status)&&void 0!==e?e:null)}),[ae,ee,ne]);const[ie,re]=Object(n.useState)(null),se=J&&null==ie,[oe,le]=Object(n.useState)(null),[ce,ue]=Object(n.useState)(bO.alerts),[de,pe]=Object(n.useState)(hO),{aboutRuleData:xe,modifiedAboutRuleDetailsData:Se,defineRuleData:we,scheduleRuleData:Oe}=null!=ie?vi({rule:ie,detailsView:!0}):{aboutRuleData:null,modifiedAboutRuleDetailsData:null,defineRuleData:null,scheduleRuleData:null},[je,Ce]=Object(n.useState)(!1),[Ie,Me]=Object(n.useState)(!1),Ae=Object(Qi.a)(),{formatUrl:qe}=Object(f.n)(s.a.rules),{globalFullScreen:De}=Object(Ut.a)(),[Fe,_e]=Object(n.useState)(Ve),Ne=Object(fe.a)("ruleRegistryEnabled"),Le=Object(fe.a)("uebaEnabled"),Be=Object(Vb.a)(Ae)&&Object(Qb.a)(Ae),{services:{application:{capabilities:{actions:ze}},timelines:He,spaces:Ue}}=Object(m.j)(),$e=Object(n.useMemo)((()=>!(null!=(null==ie?void 0:ie.actions)&&(null==ie?void 0:ie.actions.length)>0&&yb(ze.show))||ze.show),[ze,null==ie?void 0:ie.actions]);Object(n.useEffect)((()=>{null!=K&&re(K)}),[K]),Object(n.useEffect)((()=>{if(ie){const e=ie.outcome;if(Ue&&"aliasMatch"===e){const e=`rules/id/${ie.id}${window.location.search}${window.location.hash}`;Ue.ui.redirectLegacyUrl(e,S.i18n.translate("xpack.triggersActionsUI.sections.alertDetails.redirectObjectNoun",{defaultMessage:"rule"}))}}}),[ie,Ue]);const Qe=Object(n.useMemo)((()=>{if(null!=(null==ie?void 0:ie.alias_target_id)&&Ue&&"conflict"===ie.outcome){const e=ie.alias_target_id,t=`rules/id/${e}${window.location.search}${window.location.hash}`;return i.a.createElement(i.a.Fragment,null,i.a.createElement(_.EuiSpacer,null),Ue.ui.components.getLegacyUrlConflict({objectNoun:S.i18n.translate("xpack.triggersActionsUI.sections.alertDetails.redirectObjectNoun",{defaultMessage:"rule"}),currentObjectId:ie.id,otherObjectId:e,otherObjectPath:t}))}return null}),[ie,Ue]);Object(n.useEffect)((()=>{H?(pe(hO),ue(bO.alerts)):(pe(hO.filter((({id:e})=>e!==bO.alerts))),ue(bO.exceptions))}),[H]);const We=Object(n.useMemo)((()=>C||W),[C,W]),Ke=Object(n.useMemo)((()=>i.a.createElement(i.a.Fragment,null,null==ie?void 0:ie.name," ",J&&i.a.createElement(_.EuiLoadingSpinner,{size:"m"}))),[ie,J]),Ye=Object(n.useMemo)((()=>J||X?void 0:{text:KS,color:"default"}),[X,J]),Je=Object(n.useMemo)((()=>{var e,t,a,n;return ie?[i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.ruleDetails.ruleCreationDescription",defaultMessage:"Created by: {by} on {date}",values:{by:null!==(e=null==ie?void 0:ie.created_by)&&void 0!==e?e:LS,date:i.a.createElement(ws.a,{value:null!==(t=null==ie?void 0:ie.created_at)&&void 0!==t?t:(new Date).toISOString(),fieldName:"createdAt"})}}),null!=(null==ie?void 0:ie.updated_by)?i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.ruleDetails.ruleUpdateDescription",defaultMessage:"Updated by: {by} on {date}",values:{by:null!==(a=null==ie?void 0:ie.updated_by)&&void 0!==a?a:LS,date:i.a.createElement(ws.a,{value:null!==(n=null==ie?void 0:ie.updated_at)&&void 0!==n?n:(new Date).toISOString(),fieldName:"updatedAt"})}}):""]:J?i.a.createElement(_.EuiLoadingSpinner,{size:"m"}):null}),[ie,J]),Xe=Object(n.useCallback)((n=>{const i=h.q.detectionsRulesDetailsPage;t({id:i}),e({id:i}),a({id:i}),_e(n)}),[t,e,a,_e]);Object(n.useEffect)((()=>{Ce(null!=(null==ie?void 0:ie.building_block_type))}),[ie]);const Ze=Object(n.useMemo)((()=>[...Object(tt.g)(G),...Ne?[...Object(tt.i)(je),...Object(tt.d)(Fe)]:[...Object(tt.h)(je),...Object(tt.c)(Fe)],...Object(tt.j)(Ie)]),[G,Ne,je,Ie,Fe]),et=Object(n.useMemo)((()=>[...Object(tt.g)(G),...Ne?[...Object(tt.i)(je)]:[...Object(tt.h)(je)],...Object(tt.j)(Ie)]),[G,Ne,je,Ie]),at=Object(n.useMemo)((()=>[...Ze,...q]),[Ze,q]),nt=Object(n.useMemo)((()=>i.a.createElement(_.EuiTabs,null,de.map((e=>i.a.createElement(_.EuiTab,{onClick:()=>ue(e.id),isSelected:e.id===ce,disabled:e.disabled,key:e.id,"data-test-subj":e.dataTestSubj},e.name))))),[ce,ue,de]),rt=Object(n.useMemo)((()=>{var e;return null!==(e=null==ie?void 0:ie.index)&&void 0!==e?e:Le?[...o.G,...o.H]:o.G}),[null==ie?void 0:ie.index,Le]),st=Object(n.useCallback)((()=>{null!=te&&null!=G&&te(G)}),[te,G]),ot=Object(n.useMemo)((()=>Z?i.a.createElement(_.EuiFlexItem,null,i.a.createElement(_.EuiLoadingSpinner,{size:"m","data-test-subj":"rule-status-loader"})):i.a.createElement(i.a.Fragment,null,i.a.createElement(ow,{status:Object(ti.a)(null==ae?void 0:ae.status),statusDate:null==ae?void 0:ae.status_date},i.a.createElement(_.EuiButtonIcon,{"data-test-subj":"refreshButton",color:"primary",onClick:st,iconType:"refresh","aria-label":Mn.pb,isDisabled:!X})))),[X,ae,Z,st]),lt=Object(n.useMemo)((()=>{return Z?i.a.createElement(_.EuiFlexItem,null,i.a.createElement(_.EuiLoadingSpinner,{size:"m","data-test-subj":"rule-status-loader"})):"failed"!==(null==ae?void 0:ae.status)||ce!==bO.alerts&&ce!==bO.failures||null==(null==ae?void 0:ae.last_failure_at)?"warning"!==(null==ae?void 0:ae.status)&&"partial failure"!==(null==ae?void 0:ae.status)||ce!==bO.alerts&&ce!==bO.failures||null==(null==ae?void 0:ae.last_success_at)?null:i.a.createElement(JS,{message:null!==(t=null==ae?void 0:ae.last_success_message)&&void 0!==t?t:"",date:null==ae?void 0:ae.last_success_at,color:"warning"}):i.a.createElement(JS,{message:null!==(e=null==ae?void 0:ae.last_failure_message)&&void 0!==e?e:"",date:null==ae?void 0:ae.last_failure_at});var e,t}),[ce,ae,Z]),ct=Object(n.useCallback)((({x:e})=>{if(!e)return;const[t,a]=e;k(Object(ke.setAbsoluteRangeDatePicker)({id:"global",from:new Date(t).toISOString(),to:new Date(a).toISOString()}))}),[k]),mt=Object(n.useCallback)((e=>{null!=oe&&e===oe||le(e)}),[oe,le]),ft=Object(n.useCallback)((e=>{e.preventDefault(),T(o.l,{deepLinkId:s.a.rules,path:Object(ve.c)(null!=G?G:"")})}),[T,G]),gt=Object(n.useMemo)((()=>$e?i.a.createElement(Ht.g,{onClick:ft,iconType:"controlsHorizontal",isDisabled:!X||!Pi(B),href:qe(Object(ve.c)(null!=G?G:""))},Mn.W):i.a.createElement(_.EuiToolTip,{position:"top",content:Mn.X},i.a.createElement(Ht.g,{onClick:ft,iconType:"controlsHorizontal",isDisabled:!0,href:qe(Object(ve.c)(null!=G?G:""))},Mn.W))),[X,B,qe,ft,$e,G]),bt=Object(n.useCallback)((e=>{Ce(e)}),[Ce]),ht=Object(n.useCallback)((e=>{Me(e)}),[Me]),{indicesExist:yt,indexPattern:vt}=Object(v.c)(E.SourcererScopeName.detections),Et=Object(n.useMemo)((()=>null!=ie&&null!=ie.exceptions_list?ie.exceptions_list.reduce(((e,{id:t,list_id:a,namespace_type:n,type:i})=>{const{allowedExceptionListTypes:r,lists:s}=e;return{lists:[...s,{id:t,listId:a,namespaceType:n,type:i}],allowedExceptionListTypes:i===Df.a.ENDPOINT&&!r.includes(Df.a.ENDPOINT)?[...r,Df.a.ENDPOINT]:r}}),{lists:[],allowedExceptionListTypes:[Df.a.DETECTION]}):{lists:[],allowedExceptionListTypes:[Df.a.DETECTION]}),[ie]),Tt=Object(n.useCallback)((()=>{Object(Pe.k)(x.current)}),[x]),kt=Object(n.useCallback)((()=>{Object(Pe.m)()}),[]),xt=Object(n.useCallback)((e=>{Object(ge.isTab)(e)&&Object(Pe.l)({containerElement:x.current,keyboardEvent:e,onSkipFocusBeforeEventsTable:Tt,onSkipFocusAfterEventsTable:kt})}),[x,Tt,kt]);if(Ai(F,N,L,V))return T(o.l,{deepLinkId:s.a.alerts,path:Object(ve.b)()}),null;return i.a.createElement(i.a.Fragment,null,i.a.createElement(Ea,null),i.a.createElement(Fa,null),yt?i.a.createElement(gO,{onKeyDown:xt,ref:x},i.a.createElement(_.EuiWindowEvent,{event:"resize",handler:me.noop}),i.a.createElement(ye.a,{show:Object(Pe.n)({globalFullScreen:De,graphEventId:O})},i.a.createElement(Ee.a,{id:"global",indexPattern:vt})),i.a.createElement(d.a,{noPadding:De},i.a.createElement($t,{show:!De},i.a.createElement(Mt,{backOptions:{path:Object(ve.e)(),text:_S,pageId:s.a.rules,dataTestSubj:"ruleDetailsBackToAllRules"},border:!0,subtitle:Je,subtitle2:i.a.createElement(i.a.Fragment,null,i.a.createElement(_.EuiFlexGroup,{gutterSize:"xs",alignItems:"center",justifyContent:"flexStart"},i.a.createElement(_.EuiFlexItem,{grow:!1},nw,":"),ot)),title:Ke,badgeOptions:Ye},i.a.createElement(_.EuiFlexGroup,{alignItems:"center"},i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(_.EuiToolTip,{position:"top",content:Eb(ie,Be,$e)},i.a.createElement(_.EuiFlexGroup,null,i.a.createElement(wb,{id:null!==(c=null==ie?void 0:ie.id)&&void 0!==c?c:"-1",isDisabled:!(X&&vb(ie,$e)&&Pi(B)&&(Be||null!=ie&&ie.enabled)),enabled:X&&null!==(p=null==ie?void 0:ie.enabled)&&void 0!==p&&p,onChange:mt}),i.a.createElement(_.EuiFlexItem,null,NS)))),i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(_.EuiFlexGroup,{alignItems:"center",gutterSize:"s",responsive:!1},i.a.createElement(_.EuiFlexItem,{grow:!1},gt),i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(RS,{rule:ie,userHasPermissions:X&&Pi(B),canDuplicateRuleWithActions:vb(ie,$e)})))))),lt,Qe,i.a.createElement(_.EuiSpacer,null),i.a.createElement(_.EuiFlexGroup,null,i.a.createElement(_.EuiFlexItem,{"data-test-subj":"aboutRule",component:"section",grow:1},i.a.createElement(CS,{loading:se,stepData:xe,stepDataDetails:Se})),i.a.createElement(_.EuiFlexItem,{grow:1},i.a.createElement(_.EuiFlexGroup,{direction:"column"},i.a.createElement(_.EuiFlexItem,{component:"section",grow:1},i.a.createElement(AS,{loading:se,title:Mn.L},null!=we&&i.a.createElement(Rk,{descriptionColumns:"singleSplit",isReadOnlyView:!0,isLoading:!1,defaultValues:we}))),i.a.createElement(_.EuiSpacer,null),i.a.createElement(_.EuiFlexItem,{"data-test-subj":"schedule",component:"section",grow:1},i.a.createElement(AS,{loading:se,title:Mn.xb},null!=Oe&&i.a.createElement(_x,{descriptionColumns:"singleSplit",isReadOnlyView:!0,isLoading:!1,defaultValues:Oe})))))),i.a.createElement(_.EuiSpacer,null),nt,i.a.createElement(_.EuiSpacer,null)),ce===bO.alerts&&H&&i.a.createElement(i.a.Fragment,null,i.a.createElement(_.EuiFlexGroup,{alignItems:"center",justifyContent:"spaceBetween"},i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(Ge,{status:Fe,onFilterGroupChanged:Xe})),i.a.createElement(_.EuiFlexItem,{grow:!1},j&&He.getLastUpdated({updatedAt:j||Date.now(),showUpdating:We}))),i.a.createElement(_.EuiSpacer,{size:"l"}),i.a.createElement($t,{show:!De},i.a.createElement(ut.a,{filters:at,query:A,signalIndexName:$,defaultStackByOption:"event.category",updateDateRange:ct}),i.a.createElement(_.EuiSpacer,null)),null!=G&&i.a.createElement(it,{filterGroup:Fe,timelineId:h.q.detectionsRulesDetailsPage,defaultFilters:et,hasIndexWrite:null!=z&&z,hasIndexMaintenance:null!=U&&U,from:P,loading:W,showBuildingBlockAlerts:je,showOnlyThreatIndicatorAlerts:Ie,onShowBuildingBlockAlertsChanged:bt,onShowOnlyThreatIndicatorAlertsChanged:ht,onRuleChange:Y,to:D})),ce===bO.exceptions&&i.a.createElement(mO,{ruleId:null!=G?G:"",ruleName:null!==(g=null==ie?void 0:ie.name)&&void 0!==g?g:"",ruleIndices:rt,availableListTypes:Et.allowedExceptionListTypes,commentsAccordionId:"ruleDetailsTabExceptions",exceptionListsMeta:Et.lists,onRuleChange:Y}),ce===bO.failures&&i.a.createElement(aw,{id:null==ie?void 0:ie.id}))):i.a.createElement(d.a,null,i.a.createElement(Mt,{border:!0,title:FS}),i.a.createElement(pt.a,null)),i.a.createElement(u.a,{pageName:s.a.rules,state:{ruleName:null==ie?void 0:ie.name}}))},vO=Object(b.connect)(null,(e=>({clearSelected:({id:t})=>e(y.a.clearSelected({id:t})),clearEventsLoading:({id:t})=>e(y.a.clearEventsLoading({id:t})),clearEventsDeleted:({id:t})=>e(y.a.clearEventsDeleted({id:t}))})));yO.displayName="RuleDetailsPageComponent";const EO=vO(i.a.memo(yO));EO.displayName="RuleDetailsPage";const TO=S.i18n.translate("xpack.securitySolution.detectionEngine.editRule.pageTitle",{defaultMessage:"Edit rule settings"}),kO=S.i18n.translate("xpack.securitySolution.detectionEngine.editRule.cancelTitle",{defaultMessage:"Cancel"}),xO=S.i18n.translate("xpack.securitySolution.detectionEngine.editRule.saveChangeTitle",{defaultMessage:"Save changes"}),SO=S.i18n.translate("xpack.securitySolution.detectionEngine.editRule.errorMsgDescription",{defaultMessage:"Sorry"}),wO=S.i18n.translate("xpack.securitySolution.detectionEngine.editRule.backToDescription",{defaultMessage:"Back to"}),OO=async()=>{},jO=()=>{var e;const[,t]=Object(we.h)(),[{loading:a,isSignalIndexExists:r,isAuthenticated:c,hasEncryptionKey:p,canUserCRUD:f}]=Object(dt.b)(),{loading:g,needsConfiguration:b}=Bt(),{navigateToApp:h}=Object(m.j)().services.application,{detailName:y}=Object(l.useParams)(),[v,E]=zg(y),T=v||a||g,k=Object(n.useRef)({[uy.a.defineRule]:OO,[uy.a.aboutRule]:OO,[uy.a.scheduleRule]:OO,[uy.a.ruleActions]:OO}),x=Object(n.useRef)({[uy.a.defineRule]:{isValid:!1,data:void 0},[uy.a.aboutRule]:{isValid:!1,data:void 0},[uy.a.scheduleRule]:{isValid:!1,data:void 0},[uy.a.ruleActions]:{isValid:!1,data:void 0}}),w=x.current[uy.a.defineRule],O=x.current[uy.a.aboutRule],j=x.current[uy.a.scheduleRule],C=x.current[uy.a.ruleActions],[I,M]=Object(n.useState)(uy.a.defineRule),A=uS.b.filter((e=>{const t=x.current[e];return null!=t.data&&!ty(t)})),[{isLoading:q,isSaved:D},P]=(()=>{const[e,t]=Object(n.useState)(null),[a,i]=Object(n.useState)(!1),[r,s]=Object(n.useState)(!1),{addError:o}=Object(Oe.a)();return Object(n.useEffect)((()=>{let t=!0;const a=new AbortController;return i(!1),(async()=>{if(null!=e){try{s(!0),await Object(Nn.q)({rule:Object(Mf.b)(e),signal:a.signal}),t&&i(!0)}catch(e){t&&o(e,{title:Af.g})}t&&s(!1)}})(),()=>{t=!1,a.abort()}}),[e,o]),[{isLoading:r,isSaved:a},t]})(),R=Object(n.useMemo)((()=>Di(null==E?void 0:E.type)),[null==E?void 0:E.type]),F=Object(n.useCallback)(((e,t)=>{k.current[e]=t,e===I&&t()}),[I]),N=Object(n.useCallback)(((e,t,a)=>{x.current[e]={...x.current[e],data:t,isValid:a}}),[]),L=Object(n.useMemo)((()=>[{"data-test-subj":"edit-rule-define-tab",id:uy.a.defineRule,name:Mn.L,disabled:null==E?void 0:E.immutable,content:i.a.createElement(i.a.Fragment,null,i.a.createElement(_.EuiSpacer,null),i.a.createElement(AS,{loading:T,title:Mn.L},null!=w.data&&i.a.createElement(Rk,{isReadOnlyView:!1,isLoading:q,isUpdateView:!0,defaultValues:w.data,setForm:F}),i.a.createElement(_.EuiSpacer,null)))},{"data-test-subj":"edit-rule-about-tab",id:uy.a.aboutRule,name:Mn.a,disabled:null==E?void 0:E.immutable,content:i.a.createElement(i.a.Fragment,null,i.a.createElement(_.EuiSpacer,null),i.a.createElement(AS,{loading:T,title:Mn.a},null!=O.data&&null!=w.data&&i.a.createElement(Ox,{isReadOnlyView:!1,isLoading:q,isUpdateView:!0,defaultValues:O.data,defineRuleData:w.data,setForm:F}),i.a.createElement(_.EuiSpacer,null)))},{"data-test-subj":"edit-rule-schedule-tab",id:uy.a.scheduleRule,name:Mn.xb,disabled:null==E?void 0:E.immutable,content:i.a.createElement(i.a.Fragment,null,i.a.createElement(_.EuiSpacer,null),i.a.createElement(AS,{loading:T,title:Mn.xb},null!=j.data&&i.a.createElement(_x,{isReadOnlyView:!1,isLoading:q,isUpdateView:!0,defaultValues:j.data,setForm:F}),i.a.createElement(_.EuiSpacer,null)))},{"data-test-subj":"edit-rule-actions-tab",id:uy.a.ruleActions,name:Mn.c,content:i.a.createElement(i.a.Fragment,null,i.a.createElement(_.EuiSpacer,null),i.a.createElement(AS,{loading:T,title:Mn.c},null!=C.data&&i.a.createElement(sS,{isReadOnlyView:!1,isLoading:q,isUpdateView:!0,defaultValues:C.data,setForm:F,actionMessageParams:R}),i.a.createElement(_.EuiSpacer,null)))}]),[null==E?void 0:E.immutable,T,w.data,q,F,O.data,j.data,C.data,R]),B=Object(n.useCallback)((async()=>{const e=await k.current[I]();null!=(null==e?void 0:e.data)&&N(I,e.data,e.isValid);const t=(a=e,Object(me.has)("data.ruleType",a)?e:w);var a;const n=(e=>Object(me.has)("data.name",e))(e)?e:O,i=(e=>Object(me.has)("data.interval",e))(e)?e:j,r=(e=>Object(me.has)("data.actions",e))(e)?e:C;ty(t)&&ty(n)&&ty(i)&&ty(r)&&P({...cy(t.data,n.data,i.data,r.data,E),...y?{id:y}:{},...null!=E?{max_signals:E.max_signals}:{}})}),[O,C,I,w,E,y,j,P,N]);Object(n.useEffect)((()=>{if(null!=E){const{aboutRuleData:e,defineRuleData:t,scheduleRuleData:a,ruleActionsData:n}=vi({rule:E});N(uy.a.defineRule,t,!0),N(uy.a.aboutRule,e,!0),N(uy.a.scheduleRule,a,!0),N(uy.a.ruleActions,n,!0)}}),[E,N]);const z=Object(n.useCallback)((async e=>{M(e),await k.current[e]()}),[]),H=Object(n.useCallback)((async e=>{const t=e.id,a=await k.current[I]();null!=(null==a?void 0:a.data)&&(N(I,a.data,a.isValid),z(t))}),[I,z,N]),U=Object(n.useCallback)((e=>{e.preventDefault(),h(o.l,{deepLinkId:s.a.rules,path:Object(ve.d)(null!=y?y:"")})}),[h,y]);var $,Q;return Object(n.useEffect)((()=>{null!=E&&E.immutable?M(uy.a.ruleActions):M(uy.a.defineRule)}),[E]),D?(Object(we.e)((Q=null!==($=null==E?void 0:E.name)&&void 0!==$?$:"",S.i18n.translate("xpack.securitySolution.detectionEngine.rules.update.successfullySavedRuleTitle",{values:{ruleName:Q},defaultMessage:"{ruleName} was saved"})),t),h(o.l,{deepLinkId:s.a.rules,path:Object(ve.d)(null!=y?y:"")}),null):Ai(r,c,p,b)?(h(o.l,{deepLinkId:s.a.alerts,path:Object(ve.b)()}),null):Pi(f)?i.a.createElement(i.a.Fragment,null,i.a.createElement(d.a,null,i.a.createElement(_.EuiFlexGroup,{direction:"row",justifyContent:"spaceAround"},i.a.createElement(Ri,null,i.a.createElement(Mt,{backOptions:{path:Object(ve.d)(null!=y?y:""),text:`${wO} ${null!==(e=null==E?void 0:E.name)&&void 0!==e?e:""}`,pageId:s.a.rules,dataTestSubj:"ruleEditBackToRuleDetails"},isLoading:q,title:TO}),A.length>0&&i.a.createElement(_.EuiCallOut,{title:SO,color:"danger",iconType:"alert"},i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.rule.editRule.errorMsgDescription",defaultMessage:"You have an invalid input in {countError, plural, one {this tab} other {these tabs}}: {tabHasError}",values:{countError:A.length,tabHasError:A.map((e=>e===uy.a.aboutRule?Mn.a:e===uy.a.defineRule?Mn.L:e===uy.a.scheduleRule?Mn.xb:e===uy.a.ruleActions?Mn.wb:e)).join(", ")}})),i.a.createElement(_.EuiTabbedContent,{initialSelectedTab:L[0],selectedTab:L.find((e=>e.id===I)),onTabClick:H,tabs:L}),i.a.createElement(_.EuiSpacer,null),i.a.createElement(_.EuiFlexGroup,{alignItems:"center",gutterSize:"s",justifyContent:"flexEnd",responsive:!1},i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(_.EuiButton,{iconType:"cross",onClick:U},kO)),i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(_.EuiButton,{"data-test-subj":"ruleEditSubmitButton",fill:!0,onClick:B,iconType:"save",isLoading:q,isDisabled:T},xO)))))),i.a.createElement(u.a,{pageName:s.a.rules,state:{ruleName:null==E?void 0:E.name}})):(h(o.l,{deepLinkId:s.a.rules,path:Object(ve.d)(null!=y?y:"")}),null)},CO=[{path:"/rules/id/:detailName/edit",main:Object(n.memo)(jO),exact:!0},{path:"/rules/id/:detailName",main:EO,exact:!0},{path:"/rules/create",main:gS,exact:!0},{path:"/rules",main:$h,exact:!0}],IO=[{path:o.Gb,render:()=>i.a.createElement(r.TrackApplicationView,{viewId:o.Kb.rules},i.a.createElement(l.Switch,null,CO.map(((e,t)=>{var a;return i.a.createElement(l.Route,{key:`rules-route-${e.path}`,path:e.path,exact:null!==(a=null==e?void 0:e.exact)&&void 0!==a&&a},i.a.createElement(e.main,null))})),i.a.createElement(l.Route,{component:ue.a})))}];var MO=a(782);const AO=[{path:o.Lb,render:()=>i.a.createElement(r.TrackApplicationView,{viewId:s.a.timelines},i.a.createElement(MO.a,null))}];var qO=a(242),DO=a(427);const PO={timelineById:{},autoSavedWarningMsg:{timelineId:null,newTimelineModel:null},showCallOutUnauthorizedMsg:!1,insertTimeline:null},RO=Object(qO.reducerWithInitialState)(PO).case(nm.addTimeline,((e,{id:t,timeline:a,resolveTimelineConfig:n})=>({...e,timelineById:Object(DO.f)({id:t,timeline:a,resolveTimelineConfig:n,timelineById:e.timelineById})}))).case(nm.createTimeline,((e,{id:t,timelineType:a=h.x.default,...n})=>({...e,timelineById:Object(DO.a)({id:t,timelineById:e.timelineById,timelineType:a,...n})}))).case(nm.addHistory,((e,{id:t,historyId:a})=>({...e,timelineById:Object(DO.b)({id:t,historyId:a,timelineById:e.timelineById})}))).case(nm.addNote,((e,{id:t,noteId:a})=>({...e,timelineById:Object(DO.c)({id:t,noteId:a,timelineById:e.timelineById})}))).case(nm.addNoteToEvent,((e,{id:t,noteId:a,eventId:n})=>({...e,timelineById:Object(DO.d)({id:t,noteId:a,eventId:n,timelineById:e.timelineById})}))).case(nm.addProvider,((e,{id:t,provider:a})=>({...e,timelineById:Object(DO.e)({id:t,provider:a,timelineById:e.timelineById})}))).case(nm.applyKqlFilterQuery,((e,{id:t,filterQuery:a})=>({...e,timelineById:Object(DO.g)({id:t,filterQuery:a,timelineById:e.timelineById})}))).case(nm.showTimeline,((e,{id:t,show:a})=>({...e,timelineById:Object(DO.B)({id:t,show:a,timelineById:e.timelineById})}))).case(nm.updateTimelineGraphEventId,((e,{id:t,graphEventId:a})=>({...e,timelineById:Object(DO.n)({id:t,graphEventId:a,timelineById:e.timelineById})}))).case(nm.pinEvent,((e,{id:t,eventId:a})=>({...e,timelineById:Object(DO.i)({id:t,eventId:a,timelineById:e.timelineById})}))).case(nm.removeProvider,((e,{id:t,providerId:a,andProviderId:n})=>({...e,timelineById:Object(DO.j)({id:t,providerId:a,timelineById:e.timelineById,andProviderId:n})}))).case(nm.startTimelineSaving,((e,{id:t})=>({...e,timelineById:{...e.timelineById,[t]:{...e.timelineById[t],isSaving:!0}}}))).case(nm.endTimelineSaving,((e,{id:t})=>({...e,timelineById:{...e.timelineById,[t]:{...e.timelineById[t],isSaving:!1}}}))).case(nm.setExcludedRowRendererIds,((e,{id:t,excludedRowRendererIds:a})=>({...e,timelineById:Object(DO.l)({id:t,excludedRowRendererIds:a,timelineById:e.timelineById})}))).case(nm.updateTimeline,((e,{id:t,timeline:a})=>({...e,timelineById:{...e.timelineById,[t]:a}}))).case(nm.unPinEvent,((e,{id:t,eventId:a})=>({...e,timelineById:Object(DO.k)({id:t,eventId:a,timelineById:e.timelineById})}))).case(nm.updateEventType,((e,{id:t,eventType:a})=>({...e,timelineById:Object(DO.p)({id:t,eventType:a,timelineById:e.timelineById})}))).case(nm.updateIsFavorite,((e,{id:t,isFavorite:a})=>({...e,timelineById:Object(DO.q)({id:t,isFavorite:a,timelineById:e.timelineById})}))).case(nm.updateIsLive,((e,{id:t,isLive:a})=>({...e,timelineById:Object(DO.r)({id:t,isLive:a,timelineById:e.timelineById})}))).case(nm.updateKqlMode,((e,{id:t,kqlMode:a})=>({...e,timelineById:Object(DO.s)({id:t,kqlMode:a,timelineById:e.timelineById})}))).case(nm.updateTitleAndDescription,((e,{id:t,title:a,description:n})=>({...e,timelineById:Object(DO.C)({id:t,title:a,description:n,timelineById:e.timelineById})}))).case(nm.updateProviders,((e,{id:t,providers:a})=>({...e,timelineById:Object(DO.z)({id:t,providers:a,timelineById:e.timelineById})}))).case(nm.updateRange,((e,{id:t,start:a,end:n})=>({...e,timelineById:Object(DO.A)({id:t,start:a,end:n,timelineById:e.timelineById})}))).case(nm.updateDataProviderEnabled,((e,{id:t,enabled:a,providerId:n,andProviderId:i})=>({...e,timelineById:Object(DO.u)({id:t,enabled:a,providerId:n,timelineById:e.timelineById,andProviderId:i})}))).case(nm.updateDataProviderExcluded,((e,{id:t,excluded:a,providerId:n,andProviderId:i})=>({...e,timelineById:Object(DO.v)({id:t,excluded:a,providerId:n,timelineById:e.timelineById,andProviderId:i})}))).case(nm.dataProviderEdited,((e,{andProviderId:t,excluded:a,field:n,id:i,operator:r,providerId:s,value:o})=>({...e,timelineById:Object(DO.x)({andProviderId:t,excluded:a,field:n,id:i,operator:r,providerId:s,timelineById:e.timelineById,value:o})}))).case(nm.updateDataProviderType,((e,{id:t,type:a,providerId:n,andProviderId:i})=>({...e,timelineById:Object(DO.y)({id:t,type:a,providerId:n,timelineById:e.timelineById,andProviderId:i})}))).case(nm.updateDataProviderKqlQuery,((e,{id:t,kqlQuery:a,providerId:n})=>({...e,timelineById:Object(DO.w)({id:t,kqlQuery:a,providerId:n,timelineById:e.timelineById})}))).case(nm.updatePageIndex,((e,{id:t,activePage:a})=>({...e,timelineById:Object(DO.t)({id:t,activePage:a,timelineById:e.timelineById})}))).case(nm.updateAutoSaveMsg,((e,{timelineId:t,newTimelineModel:a})=>({...e,autoSavedWarningMsg:{timelineId:t,newTimelineModel:a}}))).case(nm.showCallOutUnauthorizedMsg,(e=>({...e,showCallOutUnauthorizedMsg:!0}))).case(nm.setSavedQueryId,((e,{id:t,savedQueryId:a})=>({...e,timelineById:Object(DO.o)({id:t,savedQueryId:a,timelineById:e.timelineById})}))).case(nm.setFilters,((e,{id:t,filters:a})=>({...e,timelineById:Object(DO.m)({id:t,filters:a,timelineById:e.timelineById})}))).case(nm.setInsertTimeline,((e,t)=>({...e,insertTimeline:t}))).case(nm.updateIndexNames,((e,{id:t,indexNames:a})=>({...e,timelineById:{...e.timelineById,[t]:{...e.timelineById[t],indexNames:a}}}))).case(nm.setActiveTabTimeline,((e,{id:t,activeTab:a,scrollToTop:n})=>({...e,timelineById:{...e.timelineById,[t]:{...e.timelineById[t],activeTab:a,prevActiveTab:e.timelineById[t].activeTab,scrollToTop:n?{timestamp:Math.floor(Date.now()/1e3)}:void 0}}}))).case(nm.toggleModalSaveTimeline,((e,{id:t,showModalSaveTimeline:a})=>({...e,timelineById:{...e.timelineById,[t]:{...e.timelineById[t],showSaveModal:a}}}))).case(nm.updateEqlOptions,((e,{id:t,field:a,value:n})=>{var i;return{...e,timelineById:{...e.timelineById,[t]:{...e.timelineById[t],eqlOptions:{...null!==(i=e.timelineById[t].eqlOptions)&&void 0!==i?i:{},[a]:n}}}}})).case(nm.setInsertTimeline,((e,t)=>({...e,insertTimeline:t}))).case(nm.showTimeline,((e,{id:t,show:a})=>({...e,timelineById:Object(DO.B)({id:t,show:a,timelineById:e.timelineById})}))).case(nm.setTimelineUpdatedAt,((e,{id:t,updated:a})=>({...e,timelineById:{...e.timelineById,[t]:{...e.timelineById[t],updated:a}}}))).build();var FO=a(106),_O=a(112),NO=a(170),LO=a(153);const BO=S.i18n.translate("xpack.securitySolution.endpointDetails.overview",{defaultMessage:"Overview"}),zO={tabTitle:S.i18n.translate("xpack.securitySolution.endpointDetails.activityLog",{defaultMessage:"Activity Log"}),LogEntry:{endOfLog:S.i18n.translate("xpack.securitySolution.endpointDetails.activityLog.logEntry.action.endOfLog",{defaultMessage:"Nothing more to show"}),dateRangeMessage:S.i18n.translate("xpack.securitySolution.endpointDetails.activityLog.logEntry.dateRangeMessage.title",{defaultMessage:"Nothing to show for selected date range, please select another and try again."}),emptyState:{title:S.i18n.translate("xpack.securitySolution.endpointDetails.activityLog.logEntry.emptyState.title",{defaultMessage:"No logged actions"}),body:S.i18n.translate("xpack.securitySolution.endpointDetails.activityLog.logEntry.emptyState.body",{defaultMessage:"No actions have been logged for this endpoint."})},action:{isolatedAction:S.i18n.translate("xpack.securitySolution.endpointDetails.activityLog.logEntry.action.isolated",{defaultMessage:"submitted request: Isolate host"}),unisolatedAction:S.i18n.translate("xpack.securitySolution.endpointDetails.activityLog.logEntry.action.unisolated",{defaultMessage:"submitted request: Release host"}),failedEndpointReleaseAction:S.i18n.translate("xpack.securitySolution.endpointDetails.activityLog.logEntry.action.failedEndpointReleaseAction",{defaultMessage:"failed to submit request: Release host"}),failedEndpointIsolateAction:S.i18n.translate("xpack.securitySolution.endpointDetails.activityLog.logEntry.action.failedEndpointIsolateAction",{defaultMessage:"failed to submit request: Isolate host"})},response:{isolationCompletedAndSuccessful:S.i18n.translate("xpack.securitySolution.endpointDetails.activityLog.logEntry.response.isolationCompletedAndSuccessful",{defaultMessage:"Host isolation request completed by Endpoint"}),isolationCompletedAndUnsuccessful:S.i18n.translate("xpack.securitySolution.endpointDetails.activityLog.logEntry.response.isolationCompletedAndUnsuccessful",{defaultMessage:"Host isolation request completed by Endpoint with errors"}),unisolationCompletedAndSuccessful:S.i18n.translate("xpack.securitySolution.endpointDetails.activityLog.logEntry.response.unisolationCompletedAndSuccessful",{defaultMessage:"Release request completed by Endpoint"}),unisolationCompletedAndUnsuccessful:S.i18n.translate("xpack.securitySolution.endpointDetails.activityLog.logEntry.response.unisolationCompletedAndUnsuccessful",{defaultMessage:"Release request completed by Endpoint with errors"}),isolationSuccessful:S.i18n.translate("xpack.securitySolution.endpointDetails.activityLog.logEntry.response.isolationSuccessful",{defaultMessage:"Host isolation request received by Endpoint"}),isolationFailed:S.i18n.translate("xpack.securitySolution.endpointDetails.activityLog.logEntry.response.isolationFailed",{defaultMessage:"Host isolation request received by Endpoint with errors"}),unisolationSuccessful:S.i18n.translate("xpack.securitySolution.endpointDetails.activityLog.logEntry.response.unisolationSuccessful",{defaultMessage:"Release host request received by Endpoint"}),unisolationFailed:S.i18n.translate("xpack.securitySolution.endpointDetails.activityLog.logEntry.response.unisolationFailed",{defaultMessage:"Release host request received by Endpoint with errors"})}}};S.i18n.translate("xpack.securitySolution.endpointDetails.activityLog.search",{defaultMessage:"Search activity log"});var HO=a(118);const UO=L()(_.EuiContextMenuItem).withConfig({displayName:"StyledEuiContextMenuItem",componentId:"sc-gn0u4-0"})([".additional-info{display:none;max-width:50%;}&:hover{.additional-info{display:block !important;}}"]),$O=L()("div").withConfig({displayName:"StyledEuiFlexItem",componentId:"sc-gn0u4-1"})(["max-width:50%;padding-right:10px;"]),QO=Object(n.memo)((({navigateAppId:e,navigateOptions:t,onClick:a,textTruncate:r,hoverInfo:s,children:o,...l})=>{const c=Object(Bm.a)(null!=e?e:"",{...t,onClick:a}),u=Object(HO.a)(l["data-test-subj"]),d=Object(n.useMemo)((()=>{const e="additional-info "+("object"!=typeof s?"eui-textTruncate":"");return s?i.a.createElement($O,{className:e},s):null}),[s]);return i.a.createElement(UO,F()({},l,{onClick:e?c:a}),i.a.createElement(_.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},r?i.a.createElement(i.a.Fragment,null,i.a.createElement("div",F()({className:"eui-textTruncate","data-test-subj":u("truncateWrapper")},"string"==typeof o?{title:o}:{}),o),d):i.a.createElement(i.a.Fragment,null,i.a.createElement(_.EuiFlexItem,null,o),d)))}));QO.displayName="EuiContextMenuItemNavByRouter";const VO=i.a.memo((()=>{const e=Object(NO.b)(LO.detailsData),t=Object(NO.a)(e),[a,r]=Object(n.useState)(!1),s=Object(n.useCallback)((()=>{r(!1)}),[]),o=Object(n.useMemo)((()=>t.map((e=>i.a.createElement(QO,F()({},e,{onClick:s}))))),[s,t]),l=Object(n.useMemo)((()=>i.a.createElement(_.EuiButton,{iconSide:"right",fill:!0,iconType:"arrowDown","data-test-subj":"endpointDetailsActionsButton",onClick:()=>{r(!a)}},i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.endpoint.detailsActions.buttonLabel",defaultMessage:"Take action"}))),[a]);return i.a.createElement(_.EuiPopover,{id:"endpointDetailsActionsPanel",button:l,isOpen:a,closePopover:s,panelPaddingSize:"none",anchorPosition:"downLeft"},i.a.createElement(_.EuiContextMenuPanel,{size:"s",items:o}))}));VO.displayName="ActionMenu";const WO=L()(_.EuiFlyoutHeader).withConfig({displayName:"StyledEuiFlyoutHeader",componentId:"sc-tppb74-0"})(["padding:",";&.hasButtons{.buttons{padding-bottom:",";}.flyoutSubHeaderBackButton{font-size:",";}.back-button-content{padding-left:0;&-text{margin-left:0;}}}.flyout-content{padding-left:",";}"],(e=>e.theme.eui.paddingSizes.s),(e=>e.theme.eui.paddingSizes.s),(e=>e.theme.eui.euiFontSizeXS),(e=>e.theme.eui.paddingSizes.m)),GO=Object.freeze({className:"back-button-content"}),KO=Object.freeze({className:"back-button-content-text"}),YO=Object(n.memo)((({children:e,backButton:t,...a})=>{var n;return i.a.createElement(WO,F()({},a,{className:t&&"hasButtons"}),t&&i.a.createElement("div",{className:"buttons"},i.a.createElement(_.EuiButtonEmpty,{"data-test-subj":"flyoutSubHeaderBackButton",iconType:"arrowLeft",contentProps:GO,textProps:KO,size:"xs",href:null!==(n=null==t?void 0:t.href)&&void 0!==n?n:"",onClick:null==t?void 0:t.onClick,className:"flyoutSubHeaderBackButton"},null==t?void 0:t.title)),i.a.createElement("div",{className:"flyout-content"},e))}));YO.displayName="FlyoutSubHeader";var JO=a(334);const XO=Object(n.memo)((({endpointId:e})=>{const{getAppUrl:t}=Object(nb.b)(),{show:a,...r}=Object(NO.b)(LO.uiQueryParams),s=Object(n.useMemo)((()=>Object(I.f)({name:"endpointDetails",...r,selected_endpoint:e})),[r,e]),o=Object(JO.a)(s),l=Object(n.useMemo)((()=>({title:S.i18n.translate("xpack.securitySolution.endpoint.policyResponse.backLinkTitle",{defaultMessage:"Endpoint Details"}),href:t({path:s}),onClick:o})),[o,t,s]);return i.a.createElement(YO,{backButton:l,"data-test-subj":"endpointDetailsPolicyResponseFlyoutHeader"})}));XO.displayName="BackToEndpointDetailsFlyoutSubHeader";var ZO=a(695),ej=a(278);const tj=L()(_.EuiFlyoutBody).withConfig({displayName:"FlyoutBodyNoTopPadding",componentId:"sc-1ncm5aa-0"})([".euiFlyoutBody__overflowContent{padding-top:0;}"]),aj=Object(n.memo)((({hostMeta:e})=>{const t=Object(l.useHistory)(),a=Object(b.useDispatch)(),{show:r,...s}=Object(NO.b)(LO.uiQueryParams),o=Object(NO.b)(LO.getIsEndpointHostIsolated),c=Object(NO.b)(LO.getIsIsolationRequestPending),u=Object(NO.b)(LO.getWasIsolationRequestSuccessful),d=Object(NO.b)(LO.getIsolationRequestError),[p,m]=Object(n.useState)({comment:""}),f=o?ej.e:ej.c,g=Object(n.useCallback)((()=>{t.push(Object(I.f)({name:"endpointDetails",...s,selected_endpoint:e.agent.id}))}),[t,e.agent.id,s]),h=Object(n.useCallback)((()=>{a({type:"endpointIsolationRequest",payload:{type:o?"unisolate":"isolate",data:{endpoint_ids:[e.agent.id],comment:p.comment}}})}),[a,p.comment,e.agent.id,o]),y=Object(n.useCallback)((e=>{m((t=>({...t,...e})))}),[]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(XO,{endpointId:e.agent.id}),u&&i.a.createElement(ej.d,{hostName:e.host.name,isolateAction:o?"unisolateHost":"isolateHost"}),i.a.createElement(tj,null,u?i.a.createElement(ej.a,{onClick:g,buttonText:S.i18n.translate("xpack.securitySolution.endpoint.hostIsolation.successProceedButton",{defaultMessage:"Return to endpoint details"})}):i.a.createElement(_.EuiForm,{isInvalid:!!d,error:null==d?void 0:d.message,"data-test-subj":"endpointIsolationForm"},i.a.createElement(f,{comment:p.comment,isLoading:c,hostName:e.host.name,onCancel:g,onConfirm:h,onChange:y}))))}));aj.displayName="EndpointIsolateFlyoutPanel";var nj=a(696),ij=a(107);const rj=Object(n.memo)((({avatarColor:e,avatarIconColor:t,avatarSize:a,iconType:n,isResponseEvent:r})=>i.a.createElement(_.EuiAvatar,{name:"Timeline Icon",size:null!=a?a:"s",color:e,iconColor:null!=t?t:"default",iconType:null!=n?n:"dot"})));rj.displayName="LogEntryTimelineIcon";const sj=L()(_.EuiComment).withConfig({displayName:"StyledEuiComment",componentId:"sc-2nb170-0"})([".euiCommentEvent__headerTimestamp{display:flex;:before{content:'';background-color:",";display:block;width:",";height:",";margin:0 "," 0 ",";border-radius:50%;content:'';margin:0 8px 0 4px;border-radius:50%;position:relative;top:10px;}}"],(e=>e.theme.eui.euiColorInk),(e=>e.theme.eui.euiBorderWidthThick),(e=>e.theme.eui.euiBorderWidthThick),(e=>e.theme.eui.euiSizeXS),(e=>e.theme.eui.euiSizeS)),oj=Object(n.memo)((({logEntry:e})=>{const t=Qh(),{actionEventTitle:a,avatarColor:r,avatarIconColor:s,avatarSize:o,commentText:l,commentType:c,displayComment:u,displayResponseEvent:d,failedActionEventTitle:p,iconType:m,isResponseEvent:f,responseEventTitle:g,username:b}=((e,t)=>Object(n.useMemo)((()=>{let a,n="dot",i="update",r="",s=t.euiColorLightestShade,o="s",l="",c=!1,u=!1,d=!1,p=!1,m=!1,f=!0,g="";var b,h,y,v;return e.type===ij.a.FLEET_ACTION&&(o="m",i="regular",r=null!==(b=null===(h=e.item.data.data.comment)||void 0===h?void 0:h.trim())&&void 0!==b?b:"",f=!1,n="lockOpen",g=e.item.data.user_id,e.item.data.data)&&("isolate"===e.item.data.data.command&&(n="lock",c=!0),r&&(m=!0)),e.type===ij.a.ACTION?(o="m",i="regular",r=null!==(y=null===(v=e.item.data.EndpointActions.data.comment)||void 0===v?void 0:v.trim())&&void 0!==y?y:"",f=!1,n="lockOpen",g=e.item.data.user.id,a=t.euiColorVis9_behindText,l=zO.LogEntry.action.failedEndpointReleaseAction,e.item.data.EndpointActions.data&&("isolate"===e.item.data.EndpointActions.data.command&&(n="lock",l=zO.LogEntry.action.failedEndpointIsolateAction),r&&(m=!0))):e.type===ij.a.FLEET_RESPONSE?(u=!0,"isolate"===e.item.data.action_data.command&&(c=!0),e.item.data.completed_at&&!e.item.data.error?d=!0:s=t.euiColorVis9_behindText):e.type===ij.a.RESPONSE&&(n="check",u=!0,"isolate"===e.item.data.EndpointActions.data.command&&(c=!0),e.item.data.EndpointActions.completed_at&&(p=!0,e.item.data.error?(d=!1,s=t.euiColorVis9_behindText):(d=!0,s=t.euiColorVis0_behindText))),{actionEventTitle:c?zO.LogEntry.action.isolatedAction:zO.LogEntry.action.unisolatedAction,avatarColor:s,avatarIconColor:a,avatarSize:o,commentText:r,commentType:i,displayComment:m,displayResponseEvent:f,failedActionEventTitle:l,iconType:n,isResponseEvent:u,isSuccessful:d,isCompleted:p,responseEventTitle:c?p?d?zO.LogEntry.response.isolationCompletedAndSuccessful:zO.LogEntry.response.isolationCompletedAndUnsuccessful:d?zO.LogEntry.response.isolationSuccessful:zO.LogEntry.response.isolationFailed:p?d?zO.LogEntry.response.unisolationCompletedAndSuccessful:zO.LogEntry.response.unisolationCompletedAndUnsuccessful:d?zO.LogEntry.response.unisolationSuccessful:zO.LogEntry.response.unisolationFailed,username:g}}),[e,t]))(e,t);return i.a.createElement(sj,{type:null!=c?c:"regular",username:b,timestamp:i.a.createElement(ws.b,{value:e.item.data["@timestamp"]}),event:i.a.createElement("b",null,d?g:p||a),timelineIcon:i.a.createElement(rj,{avatarSize:o,iconType:m,isResponseEvent:f,avatarColor:r,avatarIconColor:s}),"data-test-subj":"timelineEntry"},u?i.a.createElement(_.EuiText,{size:"s","data-test-subj":"activityLogCommentText"},i.a.createElement("p",null,l)):void 0)}));oj.displayName="LogEntry";const lj=L.a.div.withConfig({displayName:"DatePickerWrapper",componentId:"sc-1c7nzmv-0"})(["width:",";"],(e=>e.theme.eui.fractions.single.percentage)),cj=L()(_.EuiFlexItem).withConfig({displayName:"StickyFlexItem",componentId:"sc-1c7nzmv-1"})(["background:",";position:sticky;top:0;z-index:1;padding:",";"],(e=>`${e.theme.eui.euiHeaderBackgroundColor}`),(e=>`${e.theme.eui.paddingSizes.m}`)),uj=Object(n.memo)((()=>{var e,t;const a=Object(b.useDispatch)(),{page:r,pageSize:s,startDate:l,endDate:c,autoRefreshOptions:u,recentlyUsedDateRanges:d}=Object(NO.b)(LO.getActivityLogDataPaging),p=Object(NO.b)(LO.getActivityLogRequestLoading),f=Object(n.useCallback)((async({start:e,end:t})=>{var n,i;a({type:"endpointDetailsActivityLogUpdatePaging",payload:{disabled:!1,page:r,pageSize:s,startDate:null===(n=Kn.a.parse(e))||void 0===n?void 0:n.toISOString(),endDate:null===(i=Kn.a.parse(t))||void 0===i?void 0:i.toISOString()}})}),[a,r,s]),g=Object(n.useCallback)((e=>{a({type:"userUpdatedActivityLogRefreshOptions",payload:{autoRefreshOptions:{enabled:!e.isPaused,duration:e.refreshInterval}}})}),[a]),h=Object(n.useCallback)((()=>{a({type:"endpointDetailsActivityLogUpdatePaging",payload:{disabled:!1,page:r,pageSize:s,startDate:l,endDate:c}})}),[a,r,s,l,c]),y=Object(n.useCallback)((({start:e,end:t})=>{const n=[{start:e,end:t},...d.filter((a=>!(a.start===e&&a.end===t))).slice(0,9)];a({type:"userUpdatedActivityLogRecentlyUsedDateRanges",payload:n}),f({start:e,end:t})}),[a,d,f]),[v]=Object(m.o)(o.T),E=v.length?v.map((({from:e,to:t,display:a})=>({start:e,end:t,label:a}))):[];return i.a.createElement(cj,{grow:!1},i.a.createElement(_.EuiFlexGroup,{justifyContent:"flexStart",responsive:!0},i.a.createElement(lj,{"data-test-subj":"activityLogSuperDatePicker"},i.a.createElement(_.EuiFlexItem,null,i.a.createElement(_.EuiSuperDatePicker,{isLoading:p,commonlyUsedRanges:E,end:null===(e=Kn.a.parse(c))||void 0===e?void 0:e.toISOString(),isPaused:!u.enabled,onTimeChange:y,onRefreshChange:g,refreshInterval:u.duration,onRefresh:h,recentlyUsedRanges:d,start:null===(t=Kn.a.parse(l))||void 0===t?void 0:t.toISOString()})))))}));uj.displayName="DateRangePicker";const dj=L()(_.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-14gz10s-0"})(["height:",";"],(({isShorter:e})=>e?"25vh":"85vh")),pj=L.a.div.withConfig({displayName:"LoadMoreTrigger",componentId:"sc-14gz10s-1"})(["height:",";width:",";"],(e=>e.theme.eui.euiSizeXS),(e=>e.theme.eui.fractions.single.percentage)),mj=Object(n.memo)((({activityLog:e})=>{const t=Object(NO.b)(LO.getActivityLogUninitialized),a=Object(NO.b)(LO.getActivityLogRequestLoading),r=Object(NO.b)(LO.getActivityLogRequestLoaded),s=Object(NO.b)(LO.getLastLoadedActivityLogData),o=Object(NO.b)(LO.getActivityLogIterableData),l=o.length,c=Object(NO.b)(LO.getActivityLogError),u=Object(b.useDispatch)(),{page:d,pageSize:p,startDate:m,endDate:f,disabled:g}=Object(NO.b)(LO.getActivityLogDataPaging),h=Object(n.useMemo)((()=>!!m||!!f),[m,f]),y=Object(n.useMemo)((()=>r&&!l&&!h||c),[r,l,h,c]),v=Object(n.useMemo)((()=>!(!h||!g||a||l)),[h,g,a,l]),E=Object(n.useMemo)((()=>!(null!=s&&s.data.length||o.length)),[s,o]),T=Object(n.useMemo)((()=>!g&&r&&!o.length||E),[g,r,o,E]),k=Object(n.useRef)(null),x=Object(n.useCallback)((e=>{e.some((e=>e.isIntersecting))&&r&&!g&&u({type:"endpointDetailsActivityLogUpdatePaging",payload:{page:d+1,pageSize:p,startDate:m,endDate:f}})}),[r,u,g,d,p,m,f]);return Object(n.useEffect)((()=>{const e=new IntersectionObserver(x),t=k.current;return t&&e.observe(t),()=>{e.disconnect()}}),[x]),i.a.createElement(i.a.Fragment,null,i.a.createElement(dj,{direction:"column",responsive:!1,isShorter:v},a&&(null==s||!s.data.length)||t?i.a.createElement(_.EuiLoadingContent,{lines:3}):y?i.a.createElement(_.EuiFlexItem,null,i.a.createElement(_.EuiEmptyPrompt,{iconType:"editorUnorderedList",titleSize:"s",title:i.a.createElement("h2",null,zO.LogEntry.emptyState.title),body:i.a.createElement("p",null,zO.LogEntry.emptyState.body),"data-test-subj":"activityLogEmpty"})):i.a.createElement(i.a.Fragment,null,i.a.createElement(uj,null),i.a.createElement(_.EuiFlexItem,{grow:!0},T&&i.a.createElement(i.a.Fragment,null,i.a.createElement(_.EuiSpacer,{size:"m"}),i.a.createElement(_.EuiCallOut,{"data-test-subj":"activityLogNoDataCallout",size:"s",title:zO.LogEntry.dateRangeMessage,iconType:"alert"})),r&&o.map((e=>i.a.createElement(oj,{key:`${e.item.id}`,logEntry:e}))),a&&(null==s?void 0:s.data.map((e=>i.a.createElement(oj,{key:`${e.item.id}`,logEntry:e}))))),i.a.createElement(_.EuiFlexItem,{grow:!1},a&&i.a.createElement(_.EuiLoadingContent,{lines:3}),(!a||!g)&&!T&&i.a.createElement(pj,{"data-test-subj":"activityLogLoadMoreTrigger",ref:k}),g&&!a&&!T&&i.a.createElement(_.EuiText,{color:"subdued",textAlign:"center"},i.a.createElement("p",null,zO.LogEntry.endOfLog))))))}));mj.displayName="EndpointActivityLog";var fj=a(487),gj=a(375);const bj=({date:e})=>Date.now()-e.getTime()>=36e5?i.a.createElement(i.a.Fragment,null,i.a.createElement(oa.FormattedDate,{value:e,year:"numeric",month:"short",day:"2-digit"})," @",i.a.createElement(oa.FormattedTime,{value:e})):i.a.createElement(i.a.Fragment,null,i.a.createElement(oa.FormattedRelative,{value:e})),hj=Object(n.memo)((({policyId:e,children:t,onClick:a,...r})=>{const s=Object(NO.b)(LO.nonExistingPolicies),{getAppUrl:o}=Object(nb.b)(),{toRoutePath:l,toRouteUrl:c}=Object(n.useMemo)((()=>{const t=Object(I.j)(e);return{toRoutePath:t,toRouteUrl:o({path:t})}}),[e,o]),u=Object(JO.a)(l,a);return s[e]?i.a.createElement("span",{className:r.className,"data-test-subj":r["data-test-subj"]},t):i.a.createElement(_.EuiLink,F()({href:c,onClick:u},r),t)}));hj.displayName="EndpointPolicyLink";const yj=i.a.memo((({style:e,...t})=>i.a.createElement(_.EuiText,F()({color:"subdued",size:"xs",className:"eui-textNoWrap",style:e},t),i.a.createElement(_.EuiIcon,{size:"m",type:"alert",color:"warning"}),i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.outOfDateLabel",defaultMessage:"Out-of-date"}))));yj.displayName="OutOfDate";var vj=a(457);const Ej=L()(_.EuiFlexGroup).withConfig({displayName:"EuiFlexGroupStyled",componentId:"sc-4x4obe-0"})([".isolation-status{margin-left:",";}"],(({theme:e})=>e.eui.paddingSizes.s)),Tj=Object(n.memo)((({endpointMetadata:e,hostStatus:t})=>{const a=Object(NO.b)(LO.getEndpointHostIsolationStatusPropsCallback);return i.a.createElement(Ej,{gutterSize:"none",responsive:!1,className:"eui-textTruncate"},i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(vj.a,{hostStatus:t})),i.a.createElement(_.EuiFlexItem,{grow:!1,className:"eui-textTruncate isolation-status"},i.a.createElement(ej.b,F()({"data-test-subj":"rowIsolationStatus"},a(e)))))}));Tj.displayName="EndpointAgentStatus";const kj=L()(_.EuiListGroupItem).withConfig({displayName:"HostIds",componentId:"sc-2wf17-0"})(["margin-top:0;.euiListGroupItem__text{padding:0;}"]),xj=Object(n.memo)((({details:e,policyInfo:t,hostStatus:a})=>{const r=Object(NO.b)(LO.uiQueryParams),s=Object(NO.b)(LO.policyResponseStatus),o=Object(n.useMemo)((()=>{const{selected_endpoint:t,show:a,...n}=r;return Object(I.f)({name:"endpointPolicyResponse",...n,selected_endpoint:e.agent.id})}),[e.agent.id,r]),l=Object(JO.a)(o),c=Object(n.useMemo)((()=>[{title:S.i18n.translate("xpack.securitySolution.endpoint.details.os",{defaultMessage:"OS"}),description:i.a.createElement(_.EuiText,null,e.host.os.full)},{title:S.i18n.translate("xpack.securitySolution.endpoint.details.agentStatus",{defaultMessage:"Agent Status"}),description:i.a.createElement(Tj,{hostStatus:a,endpointMetadata:e})},{title:S.i18n.translate("xpack.securitySolution.endpoint.details.lastSeen",{defaultMessage:"Last Seen"}),description:i.a.createElement(_.EuiText,null," ",i.a.createElement(bj,{date:new Date(e["@timestamp"])}))},{title:S.i18n.translate("xpack.securitySolution.endpoint.details.policy",{defaultMessage:"Policy"}),description:i.a.createElement(_.EuiFlexGroup,{alignItems:"center"},i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(_.EuiText,null,i.a.createElement(hj,{policyId:e.Endpoint.policy.applied.id,"data-test-subj":"policyDetailsValue"},e.Endpoint.policy.applied.name))),i.a.createElement(_.EuiFlexGroup,{gutterSize:"s",alignItems:"baseline"},e.Endpoint.policy.applied.endpoint_policy_version&&i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(_.EuiText,{color:"subdued",size:"xs",style:{whiteSpace:"nowrap"},"data-test-subj":"policyDetailsRevNo"},i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.endpoint.details.policy.revisionNumber",defaultMessage:"rev. {revNumber}",values:{revNumber:e.Endpoint.policy.applied.endpoint_policy_version}}))),Object(fj.b)(e.Endpoint.policy.applied,t)&&i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(yj,null))))},{title:S.i18n.translate("xpack.securitySolution.endpoint.details.policyStatus",{defaultMessage:"Policy Status"}),description:i.a.createElement(_.EuiHealth,{"data-test-subj":`policyStatusValue-${s}`,color:gj.b[s]||"default"},i.a.createElement(_.EuiLink,{onClick:l,"data-test-subj":"policyStatusValue"},i.a.createElement(_.EuiText,{size:"m"},i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.endpoint.details.policyStatusValue",defaultMessage:"{policyStatus, select, success {Success} warning {Warning} failure {Failed} other {Unknown}}",values:{policyStatus:s}}))))},{title:S.i18n.translate("xpack.securitySolution.endpoint.details.endpointVersion",{defaultMessage:"Endpoint Version"}),description:i.a.createElement(_.EuiText,null,e.agent.version)},{title:S.i18n.translate("xpack.securitySolution.endpoint.details.ipAddress",{defaultMessage:"IP Address"}),description:i.a.createElement(_.EuiListGroup,{flush:!0},i.a.createElement(_.EuiText,{size:"xs"},e.host.ip.map(((e,t)=>i.a.createElement(kj,{key:t,label:e})))))}]),[e,a,s,l,t]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(_.EuiSpacer,{size:"l"}),i.a.createElement(_.EuiDescriptionList,{type:"column",listItems:c,"data-test-subj":"endpointDetailsList"}))}));xj.displayName="EndpointDetailsContent";const Sj=[["configure_dns_events",S.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.configure_dns_events",{defaultMessage:"Configure DNS Events"})],["configure_elasticsearch_connection",S.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.configure_elasticsearch_connection",{defaultMessage:"Configure Elasticsearch Connection"})],["configure_file_events",S.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.configure_file_events",{defaultMessage:"Configure File Events"})],["configure_imageload_events",S.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.configure_imageload_events",{defaultMessage:"Configure Image Load Events"})],["configure_kernel",S.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.configure_kernel",{defaultMessage:"Configure Kernel"})],["configure_logging",S.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.configure_logging",{defaultMessage:"Configure Logging"})],["configure_malware",S.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.configure_malware",{defaultMessage:"Configure Malware"})],["configure_network_events",S.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.configure_network_events",{defaultMessage:"Configure Network Events"})],["configure_process_events",S.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.configure_process_events",{defaultMessage:"Configure Process Events"})],["configure_registry_events",S.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.configure_registry_events",{defaultMessage:"Configure Registry Events"})],["configure_security_events",S.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.configure_security_events",{defaultMessage:"Configure Security Events"})],["connect_kernel",S.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.connect_kernel",{defaultMessage:"Connect Kernel"})],["detect_async_image_load_events",S.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.detect_async_image_load_events",{defaultMessage:"Detect Async Image Load Events"})],["detect_file_open_events",S.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.detect_file_open_events",{defaultMessage:"Detect File Open Events"})],["detect_file_write_events",S.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.detect_file_write_events",{defaultMessage:"Detect File Write Events"})],["detect_network_events",S.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.detect_network_events",{defaultMessage:"Detect Network Events"})],["detect_process_events",S.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.detect_process_events",{defaultMessage:"Detect Process Events"})],["detect_registry_events",S.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.detect_registry_events",{defaultMessage:"Detect Registry Events"})],["detect_sync_image_load_events",S.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.detect_sync_image_load_events",{defaultMessage:"Detect Sync Image Load Events"})],["download_global_artifacts",S.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.download_global_artifacts",{defaultMessage:"Download Global Artifacts"})],["download_user_artifacts",S.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.download_user_artifacts",{defaultMessage:"Download User Artifacts"})],["load_config",S.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.load_config",{defaultMessage:"Load Config"})],["load_malware_model",S.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.load_malware_model",{defaultMessage:"Load Malware Model"})],["read_elasticsearch_config",S.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.read_elasticsearch_config",{defaultMessage:"Read Elasticsearch Config"})],["read_events_config",S.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.read_events_config",{defaultMessage:"Read Events Config"})],["read_kernel_config",S.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.read_kernel_config",{defaultMessage:"Read Kernel Config"})],["read_logging_config",S.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.read_logging_config",{defaultMessage:"Read Logging Config"})],["read_malware_config",S.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.read_malware_config",{defaultMessage:"Read Malware Config"})],["workflow",S.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.workflow",{defaultMessage:"Workflow"})]],wj=new Map(Sj);function Oj(e){return wj.has(e)||wj.set(e,e.replace(/_/g," ").replace(/\b(\w)/g,(e=>e.toUpperCase()))),wj.get(e)}wj.set("success",S.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.success",{defaultMessage:"Success"})),wj.set("warning",S.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.warning",{defaultMessage:"Warning"})),wj.set("failure",S.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.failed",{defaultMessage:"Failed"})),wj.set("logging",S.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.logging",{defaultMessage:"Logging"})),wj.set("streaming",S.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.streaming",{defaultMessage:"Streaming"})),wj.set("malware",S.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.malware",{defaultMessage:"Malware"})),wj.set("events",S.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.events",{defaultMessage:"Events"})),wj.set("memory_protection",S.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.memory_protection",{defaultMessage:"Memory Threat"})),wj.set("behavior_protection",S.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.behavior_protection",{defaultMessage:"Malicious Behavior"}));const jj=L()(_.EuiAccordion).withConfig({displayName:"PolicyResponseConfigAccordion",componentId:"sc-5lan6u-0"})([".euiAccordion__triggerWrapper{padding:",";}&.euiAccordion-isOpen{background-color:",";}.euiAccordion__childWrapper{background-color:",";}.policyResponseAttentionBadge{background-color:",";color:",";}.euiAccordion__button{:hover,:focus{text-decoration:none;}}:hover:not(.euiAccordion-isOpen){background-color:",";}.policyResponseActionsAccordion{.euiAccordion__iconWrapper,svg{height:",";width:",";}}.policyResponseStatusHealth{width:100px;}.policyResponseMessage{padding-left:",";}"],(e=>e.theme.eui.paddingSizes.xs),(e=>e.theme.eui.euiFocusBackgroundColor),(e=>e.theme.eui.euiColorLightestShade),(e=>e.theme.eui.euiColorDanger),(e=>e.theme.eui.euiColorEmptyShade),(e=>e.theme.eui.euiColorLightestShade),(e=>e.theme.eui.euiIconSizes.small),(e=>e.theme.eui.euiIconSizes.small),(e=>e.theme.eui.paddingSizes.l)),Cj=Object(n.memo)((({actions:e,responseActions:t})=>i.a.createElement(i.a.Fragment,null,e.map(((e,a)=>{const n=t.find((t=>t.name===e));if(void 0!==n)return i.a.createElement(_.EuiAccordion,{id:e+a,key:e+a,"data-test-subj":"endpointDetailsPolicyResponseActionsAccordion",className:"policyResponseActionsAccordion",buttonContent:i.a.createElement(_.EuiText,{size:"xs",className:"eui-textTruncate","data-test-subj":"policyResponseAction"},i.a.createElement("h4",null,Oj(e))),paddingSize:"s",extraAction:i.a.createElement(_.EuiHealth,{color:gj.c[n.status],"data-test-subj":"policyResponseStatusHealth",className:"policyResponseStatusHealth"},i.a.createElement(_.EuiText,{size:"xs"},i.a.createElement("p",null,Oj(n.status))))},i.a.createElement(_.EuiText,{size:"xs","data-test-subj":"policyResponseMessage"},i.a.createElement("p",{className:"policyResponseMessage"},n.message)))})))));Cj.displayName="ResponseActions";const Ij=Object(n.memo)((({responseConfig:e,responseActions:t,responseAttentionCount:a})=>{const r=Object(n.useMemo)((()=>Object(_.htmlIdGenerator)()),[]);return i.a.createElement(i.a.Fragment,null,Object.entries(e).map((([e,n])=>{const s=a.get(e);return i.a.createElement(jj,{id:r(`id_${e}`),key:r(`key_${e}`),"data-test-subj":"endpointDetailsPolicyResponseConfigAccordion",buttonContent:i.a.createElement(_.EuiText,{size:"s"},i.a.createElement("p",null,Oj(e))),paddingSize:"m",extraAction:s&&s>0&&i.a.createElement(_.EuiNotificationBadge,{className:"policyResponseAttentionBadge","data-test-subj":"endpointDetailsPolicyResponseAttentionBadge"},s)},i.a.createElement(Cj,{actions:n.concerned_actions,responseActions:t}))})))}));Ij.displayName="PolicyResponse";const Mj=Object(n.memo)((()=>{var e;const t=Object(m.m)(),a=Object(NO.b)(LO.uiQueryParams),r=Object(NO.b)(LO.getActivityLogData),s=Object(NO.b)(LO.detailsData),o=Object(NO.b)(LO.detailsError),l=Object(NO.b)(LO.policyVersionInfo),c=Object(NO.b)(LO.hostStatusInfo),u=Object(NO.b)(LO.showView),d=Object(n.useMemo)((()=>i.a.createElement(i.a.Fragment,null,i.a.createElement(_.EuiLoadingContent,{lines:3}),i.a.createElement(_.EuiSpacer,{size:"l"}),i.a.createElement(_.EuiLoadingContent,{lines:3}))),[]),p=Object(n.useCallback)((e=>[{id:ZO.b.overview,name:BO,route:Object(I.f)({...a,name:"endpointDetails",selected_endpoint:e}),content:void 0===s?d:i.a.createElement(xj,{details:s,policyInfo:l,hostStatus:c})},{id:ZO.b.activityLog,name:zO.tabTitle,route:Object(I.f)({...a,name:"endpointActivityLog",selected_endpoint:e}),content:i.a.createElement(mj,{activityLog:r})}]),[d,s,l,c,r,a]),f="details"===u||"policy_response"===u||"activity_log"===u;return Object(n.useEffect)((()=>{void 0!==o&&t.addDanger({title:S.i18n.translate("xpack.securitySolution.endpoint.details.errorTitle",{defaultMessage:"Could not find host"}),text:S.i18n.translate("xpack.securitySolution.endpoint.details.errorBody",{defaultMessage:"Please exit the flyout and select an available host."})})}),[o,u,t]),i.a.createElement(i.a.Fragment,null,("policy_response"===u||"isolate"===u||"unisolate"===u)&&i.a.createElement(nj.a,{hostname:null==s||null===(e=s.host)||void 0===e?void 0:e.hostname}),void 0===s?i.a.createElement(_.EuiFlyoutBody,null,i.a.createElement(_.EuiLoadingContent,{lines:3})," ",i.a.createElement(_.EuiSpacer,{size:"l"})," ",i.a.createElement(_.EuiLoadingContent,{lines:3})):i.a.createElement(i.a.Fragment,null,("details"===u||"activity_log"===u)&&i.a.createElement(ZO.a,{hostname:s.host.hostname,show:u,tabs:p(s.agent.id)}),"policy_response"===u&&i.a.createElement(Aj,{hostMeta:s}),("isolate"===u||"unisolate"===u)&&i.a.createElement(aj,{hostMeta:s}),f&&i.a.createElement(_.EuiFlyoutFooter,{className:"eui-textRight","data-test-subj":"endpointDetailsFlyoutFooter"},i.a.createElement(VO,null))))}));Mj.displayName="EndpointDetails";const Aj=Object(n.memo)((({hostMeta:e})=>{const t=Object(NO.b)(LO.policyResponseConfigurations),a=Object(NO.b)(LO.policyResponseActions),n=Object(NO.b)(LO.policyResponseFailedOrWarningActionCount),r=Object(NO.b)(LO.policyResponseLoading),s=Object(NO.b)(LO.policyResponseError),o=Object(NO.b)(LO.policyResponseTimestamp),l=Object(NO.b)(LO.policyResponseAppliedRevision);return i.a.createElement(i.a.Fragment,null,i.a.createElement(XO,{endpointId:e.agent.id}),i.a.createElement(tj,{"data-test-subj":"endpointDetailsPolicyResponseFlyoutBody",className:"endpointDetailsPolicyResponseFlyoutBody"},i.a.createElement(_.EuiText,{"data-test-subj":"endpointDetailsPolicyResponseFlyoutTitle"},i.a.createElement("h4",null,i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyResponse.title",defaultMessage:"Policy Response"}))),i.a.createElement(_.EuiSpacer,{size:"s"}),i.a.createElement(_.EuiText,{size:"xs",color:"subdued","data-test-subj":"endpointDetailsPolicyResponseTimestamp"},i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyResponse.appliedOn",defaultMessage:"Revision {rev} applied on {date}",values:{rev:l,date:i.a.createElement(ws.d,{value:o})}})),i.a.createElement(_.EuiSpacer,{size:"s"}),s&&i.a.createElement(_.EuiEmptyPrompt,{title:i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.endpoint.details.noPolicyResponse",defaultMessage:"No policy response available"})}),r&&i.a.createElement(_.EuiLoadingContent,{lines:3}),void 0!==t&&void 0!==a&&i.a.createElement(Ij,{responseConfig:t,responseActions:a,responseAttentionCount:n})))}));Aj.displayName="PolicyResponseFlyoutPanel";const qj=Object(n.memo)((()=>{const e=Object(l.useHistory)(),t=Object(NO.b)(LO.uiQueryParams),{selected_endpoint:a,...r}=t,s=Object(n.useCallback)((()=>{const{show:t,...a}=r;e.push(Object(I.g)({name:"endpointList",...a}))}),[e,r]);return i.a.createElement(_.EuiFlyout,{onClose:s,style:{zIndex:4001},"data-test-subj":"endpointDetailsFlyout",size:"m",paddingSize:"l",ownFocus:!1},i.a.createElement(Mj,null))}));qj.displayName="EndpointDetailsFlyout";var Dj=a(1026),Pj=a.n(Dj);const Rj=Object.freeze({textAlign:"center"}),Fj=Object.freeze({maxWidth:550,maxHeight:420}),_j=i.a.memo((({loading:e,onActionClick:t,actionDisabled:a})=>{const n=Object(m.j)().services.docLinks;return i.a.createElement("div",{"data-test-subj":"emptyPolicyTable"},e?i.a.createElement(_.EuiFlexGroup,{alignItems:"center",justifyContent:"center"},i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(_.EuiLoadingSpinner,{size:"xl",className:"essentialAnimation"}))):i.a.createElement(_.EuiFlexGroup,{"data-test-subj":"policyOnboardingInstructions",alignItems:"center"},i.a.createElement(_.EuiFlexItem,null,i.a.createElement(_.EuiText,null,i.a.createElement("h3",null,i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyList.onboardingTitle",defaultMessage:"Get started with Endpoint Security"}))),i.a.createElement(_.EuiSpacer,{size:"m"}),i.a.createElement(_.EuiText,{size:"s",color:"subdued"},i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyList.onboardingSectionOne",defaultMessage:"Protect your hosts with threat prevention, detection, and deep security data visibility."})),i.a.createElement(_.EuiSpacer,{size:"m"}),i.a.createElement(_.EuiText,{size:"s",color:"subdued"},i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyList.onboardingSectionTwo",defaultMessage:"From this page, you’ll be able to view and manage the hosts in your environment running Endpoint Security."})),i.a.createElement(_.EuiSpacer,{size:"m"}),i.a.createElement(_.EuiText,{size:"s",color:"subdued"},i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyList.onboardingSectionThree",defaultMessage:"To get started, add the Endpoint Security integration to your Agents. For more information, "}),i.a.createElement(_.EuiLink,{external:!0,href:`${n.links.siem.guide}`},i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyList.onboardingDocsLink",defaultMessage:"view the Elastic Security documentation"}))),i.a.createElement(_.EuiSpacer,{size:"l"}),i.a.createElement(_.EuiFlexGroup,null,i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(_.EuiButton,{fill:!0,iconType:"plusInCircle",onClick:t,isDisabled:a,"data-test-subj":"onboardingStartButton"},i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyList.actionButtonText",defaultMessage:"Add Endpoint Security"}))))),i.a.createElement(_.EuiFlexItem,null,i.a.createElement(_.EuiIcon,{type:Pj.a,size:"original",style:Fj}))))})),Nj=i.a.memo((({loading:e,onActionClick:t,actionDisabled:a,handleSelectableOnChange:r,selectionOptions:s})=>{const o=Object(n.useMemo)((()=>[{title:S.i18n.translate("xpack.securitySolution.endpoint.list.stepOneTitle",{defaultMessage:"Select the integration you want to use"}),children:i.a.createElement(i.a.Fragment,null,i.a.createElement(_.EuiText,{color:"subdued",size:"m",grow:!1},i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.endpoint.list.stepOne",defaultMessage:"Select from existing integrations. This can be changed later."})),i.a.createElement(_.EuiSpacer,{size:"xxl"}),i.a.createElement(_.EuiSelectable,{options:s,singleSelection:"always",isLoading:e,height:100,listProps:{bordered:!0,singleSelection:!0},onChange:r,"data-test-subj":"onboardingPolicySelect"},(t=>e?i.a.createElement(_.EuiSelectableMessage,null,i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.endpoint.list.loadingPolicies",defaultMessage:"Loading integrations"})):s.length?t:i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.endpoint.list.noPolicies",defaultMessage:"There are no integrations."}))))},{title:S.i18n.translate("xpack.securitySolution.endpoint.list.stepTwoTitle",{defaultMessage:"Enroll your agents enabled with Endpoint Security through Fleet"}),status:a?"disabled":"",children:i.a.createElement(_.EuiFlexGroup,{alignItems:"center"},i.a.createElement(_.EuiFlexItem,null,i.a.createElement(_.EuiText,{color:"subdued",size:"m",grow:!1},i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.endpoint.list.stepTwo",defaultMessage:"You’ll be provided with the necessary commands to get started."}))),i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(_.EuiButton,{fill:!0,onClick:t,isDisabled:a,"data-test-subj":"onboardingStartButton"},i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyList.emptyCreateNewButton",defaultMessage:"Enroll Agent"}))))}]),[s,r,e,a,t]);return i.a.createElement(Lj,{loading:e,dataTestSubj:"emptyHostsTable",steps:o,headerComponent:i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.endpoint.list.noEndpointsPrompt",defaultMessage:"Next step: Enroll an Agent with Endpoint Security"}),bodyComponent:i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.endpoint.list.noEndpointsInstructions",defaultMessage:"You’ve added the Endpoint Security integration. Now enroll your agents using the steps below."})})})),Lj=i.a.memo((({loading:e,dataTestSubj:t,steps:a,headerComponent:n,bodyComponent:r})=>i.a.createElement("div",{"data-test-subj":t},e?i.a.createElement(_.EuiFlexGroup,{alignItems:"center",justifyContent:"center"},i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(_.EuiLoadingSpinner,{size:"xl",className:"essentialAnimation"}))):i.a.createElement(i.a.Fragment,null,i.a.createElement(_.EuiSpacer,{size:"xxl"}),i.a.createElement(_.EuiTitle,{size:"m"},i.a.createElement("h2",{style:Rj},n)),i.a.createElement(_.EuiSpacer,{size:"xxl"}),i.a.createElement(_.EuiText,{textAlign:"center",color:"subdued",size:"m"},r),i.a.createElement(_.EuiSpacer,{size:"xxl"}),a&&i.a.createElement(_.EuiFlexGroup,{alignItems:"center",justifyContent:"center"},i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(_.EuiSteps,{steps:a,"data-test-subj":"onboardingSteps"})))))));_j.displayName="PolicyEmptyState",Nj.displayName="HostsEmptyState",Lj.displayName="ManagementEmptyState";var Bj=a(70),zj=a(219),Hj=a.n(zj);const Uj=L.a.div.withConfig({displayName:"AdminQueryBar",componentId:"sc-kpdev9-0"})([".globalQueryBar{padding:0;}"]),$j=Object(n.memo)((()=>{const e=Object(l.useHistory)(),{admin_query:t,...a}=Object(NO.b)(LO.uiQueryParams),r=Object(NO.b)(LO.patterns),s=Object(NO.b)(LO.searchBarQuery),o=Object(n.useMemo)((()=>r.map((e=>{return t=e,Object(Xh.all)([t]);var t}))),[r]),c=Object(n.useCallback)((t=>{var n;e.push(function(e){return{search:Hj.a.stringify(e)}}({...a,page_index:"0",...null!==(n=t.query)&&void 0!==n&&n.query.trim()?{admin_query:Object(Ws.encode)(t.query)}:{}}))}),[e,a]),u=Object(n.useMemo)((()=>new xe.TimeHistory(new lo.Storage(localStorage))),[]);return i.a.createElement("div",null,r&&r.length>0&&i.a.createElement(Uj,null,i.a.createElement(xe.SearchBar,{dataTestSubj:"adminSearchBar",query:s,indexPatterns:o,timeHistory:u,onQuerySubmit:c,isLoading:!1,iconType:"search",showFilterBar:!1,showDatePicker:!1,showQueryBar:!0,showQueryInput:!0})))}));$j.displayName="AdminSearchBar";const Qj=Object(n.memo)((({title:e,subtitle:t,actions:a,children:r,restrictWidth:s=!1,hasBottomBorder:l=!0,hideHeader:c=!1,headerBackComponent:d,...p})=>{const m=Object(n.useMemo)((()=>i.a.createElement(_.EuiFlexGroup,{direction:"column",gutterSize:"none",alignItems:"flexStart"},i.a.createElement(_.EuiFlexItem,{grow:!1},d&&i.a.createElement(i.a.Fragment,null,d)),i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(_.EuiTitle,{size:"l"},i.a.createElement("span",{"data-test-subj":"header-page-title"},e))))),[d,e]),f=Object(n.useMemo)((()=>t?i.a.createElement("span",{"data-test-subj":"header-panel-subtitle"},t):void 0),[t]),g=Object(HO.a)(p["data-test-subj"]),b=Object(n.useMemo)((()=>c?i.a.createElement(_.EuiFlexGroup,{direction:"column",gutterSize:"none",alignItems:"flexStart"},i.a.createElement(_.EuiFlexItem,{grow:!1},d&&i.a.createElement(i.a.Fragment,null,d))):i.a.createElement(i.a.Fragment,null,i.a.createElement(_.EuiPageHeader,{pageTitle:m,description:f,bottomBorder:l,rightSideItems:a?[a]:void 0,restrictWidth:s,"data-test-subj":g("header")}),i.a.createElement(_.EuiSpacer,{size:"l"}))),[a,f,g,l,m,d,c,s]);return i.a.createElement("div",p,b,i.a.createElement(_.EuiPageContent,{hasBorder:!1,hasShadow:!1,paddingSize:"none",color:"transparent",borderRadius:"none"},i.a.createElement(_.EuiPageContentBody,{restrictWidth:s},r)),i.a.createElement(u.a,{pageName:o.Kb.administration}))}));Qj.displayName="AdministrationListPage";var Vj=a(63),Wj=a(225);const Gj=Object(n.memo)((({endpointMetadata:e})=>{const[t,a]=Object(n.useState)(!1),r=Object(NO.a)(e),s=Object(n.useCallback)((()=>a(!1)),[a]),o=Object(n.useCallback)((()=>a(!t)),[t]),l=Object(n.useMemo)((()=>r.map((e=>i.a.createElement(QO,F()({},e,{onClick:s}))))),[s,r]),c=Object(n.useMemo)((()=>({"data-test-subj":"tableRowActionsMenuPanel"})),[]);return i.a.createElement(_.EuiPopover,{anchorPosition:"downRight",panelPaddingSize:"none",panelProps:c,button:i.a.createElement(_.EuiButtonIcon,{"data-test-subj":"endpointTableRowActions",iconType:"boxesHorizontal",onClick:o,"aria-label":S.i18n.translate("xpack.securitySolution.endpoint.list.actionmenu",{defaultMessage:"Open"})}),isOpen:t,closePopover:s},i.a.createElement(_.EuiContextMenuPanel,{items:l}))}));Gj.displayName="EndpointTableRowActions";var Kj=a(26);const Yj=9999,Jj=L.a.div.withConfig({displayName:"StyledDatePicker",componentId:"sc-1m5xywg-0"})([".euiFormControlLayout--group{background-color:rgba(0,119,204,0.2);}.euiDatePickerRange--readOnly{background-color:",";}"],(e=>e.theme.eui.euiFormBackgroundColor)),Xj=Object(n.memo)((({name:e,href:t,route:a,dataTestSubj:n})=>{const r=Object(JO.a)(a);return i.a.createElement(_.EuiLink,{"data-test-subj":n,className:"eui-displayInline eui-textTruncate",href:t,onClick:r},e)}));Xj.displayName="EndpointListNavLink";const Zj=Object(_O.createStructuredSelector)(LO),eC=()=>{var e,t;const a=Object(l.useHistory)(),{services:r}=Object(Vj.useKibana)(),{listData:c,pageIndex:u,pageSize:d,totalHits:p,listLoading:m,listError:g,uiQueryParams:h,hasSelectedEndpoint:y,policyItems:v,selectedPolicyId:E,policyItemsLoading:T,endpointPackageVersion:k,endpointsExist:x,autoRefreshInterval:w,isAutoRefreshEnabled:O,patternsError:j,areEndpointsEnrolling:C,agentsWithEndpointsTotalError:M,endpointsTotalError:A,metadataTransformStats:q}=Object(NO.b)(Zj),{search:D}=Object(f.n)(s.a.administration),{getAppUrl:P}=Object(nb.b)(),R=Object(b.useDispatch)(),F=p>Yj?Yj:p,[N,L]=Object(n.useState)(!1);Object(n.useEffect)((()=>{x&&null!=c&&c.length&&R({type:"loadMetadataTransformStats"})}),[x,c.length,R]),Object(n.useEffect)((()=>{const e=q.some((e=>o.Xb.has(null==e?void 0:e.state)));L(e)}),[q]);const B=Object(n.useCallback)((()=>{L(!1)}),[]),z=Object(n.useMemo)((()=>({pageIndex:u,pageSize:d,totalItemCount:F,pageSizeOptions:[...FO.d],hidePerPageOptions:!1})),[u,d,F]),H=Object(n.useCallback)((({page:e})=>{const{index:t,size:n}=e;a.push(Object(I.g)({name:"endpointList",...h,page_index:JSON.stringify(t),page_size:JSON.stringify(n)}))}),[a,h]),U=Object(Bm.a)("fleet",{path:`/integrations/${k?`/endpoint-${k}`:""}/add-integration`,state:{onCancelNavigateTo:["securitySolution",{path:Object(I.g)({name:"endpointList"})}],onCancelUrl:P({path:Object(I.g)({name:"endpointList"})}),onSaveNavigateTo:["securitySolution",{path:Object(I.g)({name:"endpointList"})}]}}),$=Object(n.useCallback)((()=>{R({type:"appRequestedEndpointList"})}),[R]),Q=Object(n.useCallback)((e=>{R({type:"userUpdatedEndpointListRefreshOptions",payload:{isAutoRefreshEnabled:!e.isPaused,autoRefreshInterval:e.refreshInterval}})}),[R]),V=Object(n.useCallback)((()=>{}),[]),W=Object(n.useMemo)((()=>({paddingLeft:"6px"})),[]),G=Object(Bm.a)("fleet",{path:`/policies/${E}?openEnrollmentFlyout=true`,state:{onDoneNavigateTo:["securitySolution",{path:Object(I.g)({name:"endpointList"})}]}}),K=Object(n.useMemo)((()=>v.map((e=>({key:e.policy_id,label:e.name,checked:E===e.policy_id?"on":void 0})))),[v,E]),Y=Object(n.useCallback)((e=>e.some((e=>"checked"in e&&"on"===e.checked&&(R({type:"userSelectedEndpointPolicy",payload:{selectedPolicyId:e.key}}),!0)))),[R]),J=Object(n.useMemo)((()=>{const e=S.i18n.translate("xpack.securitySolution.endpoint.list.lastActive",{defaultMessage:"Last active"});return[{field:"metadata",width:"15%",name:S.i18n.translate("xpack.securitySolution.endpoint.list.hostname",{defaultMessage:"Endpoint"}),render:({host:{hostname:e},agent:{id:t}})=>{const a=Object(I.f)({...h,name:"endpointDetails",selected_endpoint:t},D),n=P({path:a});return i.a.createElement(_.EuiToolTip,{content:e,anchorClassName:"eui-textTruncate"},i.a.createElement(Xj,{name:e,href:n,route:a,dataTestSubj:"hostnameCellLink"}))}},{field:"host_status",width:"14%",name:S.i18n.translate("xpack.securitySolution.endpoint.list.hostStatus",{defaultMessage:"Agent status"}),render:(e,t)=>i.a.createElement(Tj,{hostStatus:e,endpointMetadata:t.metadata})},{field:"metadata.Endpoint.policy.applied",width:"15%",name:S.i18n.translate("xpack.securitySolution.endpoint.list.policy",{defaultMessage:"Policy"}),truncateText:!0,render:(e,t)=>i.a.createElement(i.a.Fragment,null,i.a.createElement(_.EuiToolTip,{content:e.name,anchorClassName:"eui-textTruncate"},i.a.createElement(hj,{policyId:e.id,className:"eui-textTruncate","data-test-subj":"policyNameCellLink"},e.name)),e.endpoint_policy_version&&i.a.createElement(_.EuiText,{color:"subdued",size:"xs",style:{whiteSpace:"nowrap",...W},className:"eui-textTruncate","data-test-subj":"policyListRevNo"},i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.endpoint.list.policy.revisionNumber",defaultMessage:"rev. {revNumber}",values:{revNumber:e.endpoint_policy_version}})),Object(fj.b)(e,t.policy_info)&&i.a.createElement(yj,{style:W,"data-test-subj":"rowPolicyOutOfDate"}))},{field:"metadata.Endpoint.policy.applied",width:"9%",name:S.i18n.translate("xpack.securitySolution.endpoint.list.policyStatus",{defaultMessage:"Policy status"}),render:(e,t)=>{const a=Object(I.f)({name:"endpointPolicyResponse",...h,selected_endpoint:t.metadata.agent.id}),n=P({path:a});return i.a.createElement(_.EuiToolTip,{content:gj.d[e.status],anchorClassName:"eui-textTruncate"},i.a.createElement(_.EuiHealth,{color:gj.c[e.status],className:"eui-textTruncate eui-fullWidth","data-test-subj":"rowPolicyStatus"},i.a.createElement(Xj,{name:gj.d[e.status],href:n,route:a,dataTestSubj:"policyStatusCellLink"})))}},{field:"metadata.host.os.name",width:"9%",name:S.i18n.translate("xpack.securitySolution.endpoint.list.os",{defaultMessage:"OS"}),render:e=>i.a.createElement(_.EuiToolTip,{content:e,anchorClassName:"eui-textTruncate"},i.a.createElement(_.EuiText,{size:"s",className:"eui-textTruncate eui-fullWidth"},i.a.createElement("p",{className:"eui-displayInline eui-TextTruncate"},e)))},{field:"metadata.host.ip",width:"12%",name:S.i18n.translate("xpack.securitySolution.endpoint.list.ip",{defaultMessage:"IP address"}),render:e=>i.a.createElement(_.EuiToolTip,{content:e.toString().replace(",",", "),anchorClassName:"eui-textTruncate"},i.a.createElement(_.EuiText,{size:"s",className:"eui-textTruncate eui-fullWidth"},i.a.createElement("p",{className:"eui-displayInline eui-textTruncate"},e.toString().replace(",",", "))))},{field:"metadata.agent.version",width:"9%",name:S.i18n.translate("xpack.securitySolution.endpoint.list.endpointVersion",{defaultMessage:"Version"}),render:e=>i.a.createElement(_.EuiToolTip,{content:e,anchorClassName:"eui-textTruncate"},i.a.createElement(_.EuiText,{size:"s",className:"eui-textTruncate eui-fullWidth"},i.a.createElement("p",{className:"eui-displayInline eui-TextTruncate"},e)))},{field:"metadata.@timestamp",name:e,width:"9%",render:t=>i.a.createElement(ws.a,{fieldName:e,value:t,className:"eui-textTruncate"})},{field:"",width:"8%",name:S.i18n.translate("xpack.securitySolution.endpoint.list.actions",{defaultMessage:"Actions"}),actions:[{render:e=>i.a.createElement(Gj,{endpointMetadata:e.metadata})}]}]}),[h,D,P,W]),X=Object(n.useMemo)((()=>x||C?i.a.createElement(_.EuiBasicTable,{"data-test-subj":"endpointListTable",items:[...c],columns:J,error:null==g?void 0:g.message,pagination:z,onChange:H,loading:m}):!T&&v&&v.length>0?i.a.createElement(Nj,{loading:m,onActionClick:G,actionDisabled:void 0===E,handleSelectableOnChange:Y,selectionOptions:K}):i.a.createElement(_j,{loading:T,onActionClick:U})),[m,x,T,v,c,J,null==g?void 0:g.message,z,H,G,E,Y,K,U,C]),Z=c&&c.length>0,ee=Object(n.useMemo)((()=>({display:x?"flex":"none",maxWidth:200})),[x]),te=Object(n.useMemo)((()=>!!x&&(!!y||!O)),[x,y,O]),ae=Object(n.useMemo)((()=>x?w:FO.a),[x,w]),ne=Object(n.useMemo)((()=>!(!A&&!M)),[A,M]),ie=Object(n.useMemo)((()=>x&&!j),[x,j]),re=Object(n.useMemo)((()=>{var e;const t=q.filter((e=>o.Xb.has(e.state))).map((e=>e.id)).join(", ");return i.a.createElement(i.a.Fragment,null,i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.endpoint.list.transformFailed.message",defaultMessage:"A required transform, {transformId}, is currently failing. Most of the time this can be fixed by {transformsPage}. For additional help, please visit the {docsPage}",values:{transformId:t||Kj.q,transformsPage:i.a.createElement(Wj.a,{"data-test-subj":"failed-transform-restart-link",appId:"management",appPath:"/data/transform"},i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.endpoint.list.transformFailed.restartLink",defaultMessage:"restarting the transform"})),docsPage:i.a.createElement(_.EuiLink,{"data-test-subj":"failed-transform-docs-link",href:null==r||null===(e=r.docLinks)||void 0===e?void 0:e.links.endpoints.troubleshooting,target:"_blank"},i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.endpoint.list.transformFailed.docsLink",defaultMessage:"troubleshooting documentation"}))}}),i.a.createElement(_.EuiSpacer,{size:"s"}))}),[q,null==r||null===(e=r.docLinks)||void 0===e?void 0:e.links.endpoints.troubleshooting]),se=Object(n.useMemo)((()=>{if(N)return i.a.createElement(i.a.Fragment,null,i.a.createElement(Yt,{message:{id:"endpoints-list-transform-failed",type:"warning",title:S.i18n.translate("xpack.securitySolution.endpoint.list.transformFailed.title",{defaultMessage:"Required transform failed"}),description:re},dismissButtonText:S.i18n.translate("xpack.securitySolution.endpoint.list.transformFailed.dismiss",{defaultMessage:"Dismiss"}),onDismiss:B,showDismissButton:!0}),i.a.createElement(_.EuiSpacer,{size:"m"}))}),[N,B,re]);return i.a.createElement(Qj,{"data-test-subj":"endpointPage",title:i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.endpoint.list.pageTitle",defaultMessage:"Endpoints"}),subtitle:i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.endpoint.list.pageSubTitle",defaultMessage:"Hosts running endpoint security"})},y&&i.a.createElement(qj,null),i.a.createElement(i.a.Fragment,null,C&&!ne&&i.a.createElement(i.a.Fragment,null,i.a.createElement(_.EuiCallOut,{size:"s","data-test-subj":"endpointsEnrollingNotification"},i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.endpoint.list.endpointsEnrolling",defaultMessage:"Endpoints are enrolling. {agentsLink} to track progress.",values:{agentsLink:i.a.createElement(Wj.a,{appId:"fleet",appPath:`#${Bj.pagePathGetters.agent_list({kuery:'packages : "endpoint"'})}`,href:`${null==r||null===(t=r.application)||void 0===t?void 0:t.getUrlForApp("fleet")}#${Bj.pagePathGetters.agent_list({kuery:'packages : "endpoint"'})}`},i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.endpoint.list.endpointsEnrolling.viewAgentsLink",defaultMessage:"View agents"}))}})),i.a.createElement(_.EuiSpacer,{size:"m"})),se,i.a.createElement(_.EuiFlexGroup,null,ie&&i.a.createElement(_.EuiFlexItem,null,i.a.createElement($j,null)),i.a.createElement(_.EuiFlexItem,{grow:!1,style:ee},i.a.createElement(Jj,null,i.a.createElement(_.EuiSuperDatePicker,{className:"endpointListDatePicker",onTimeChange:V,isDisabled:y,onRefresh:$,isPaused:te,refreshInterval:ae,onRefreshChange:Q,isAutoRefreshOnly:!0})))),i.a.createElement(_.EuiSpacer,{size:"m"})),Z&&i.a.createElement(i.a.Fragment,null,i.a.createElement(_.EuiText,{color:"subdued",size:"xs","data-test-subj":"endpointListTableTotal"},p>1e4?i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.endpoint.list.totalCount.limited",defaultMessage:"Showing {limit} of {totalItemCount, plural, one {# endpoint} other {# endpoints}}",values:{totalItemCount:p,limit:1e4}}):i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.endpoint.list.totalCount",defaultMessage:"Showing {totalItemCount, plural, one {# endpoint} other {# endpoints}}",values:{totalItemCount:p}})),i.a.createElement(_.EuiHorizontalRule,{margin:"xs"})),X)};var tC=a(1027);class ApiRouteNotMocked extends Error{}const aC=["delete","fetch","get","post","put","head","patch"],nC=e=>(t,a)=>{let n=0;const{ignoreUnMockedApiRouteErrors:i=!1}=null!=a?a:{},r=[],s=new Error("HTTP MOCK APPLIED FROM:").stack,o=e.reduce(((e,t)=>{const a=jest.fn(t.handler);return a.mockDelay=jest.fn(t.delay||(async()=>{})),e[t.id]=a,e}),{}),l={async waitForApi(){await Object(tC.act)((async()=>{await new Promise((e=>{n>0?r.push(e):e()}))}))},responseProvider:o};return aC.forEach((a=>{const l=t[a].getMockImplementation(),c=e.filter((e=>e.method===a));t[a].mockImplementation((async(...e)=>{const t=rC(e[0])?e[0].path:e[0],u=c.find((e=>iC(e.path,t)));if(u){(async e=>{n++,e&&await e(),await new Promise((e=>setTimeout(e,1))),n--,0===n&&r.length>0&&r.splice(0).forEach((e=>e()))})(o[u.id].mockDelay),await o[u.id].mockDelay();const t=rC(e[0])?e[0]:{...e[1]||{},path:e[0]};return o[u.id](t)}if(l)return l(...e);if(i)return;const d=new ApiRouteNotMocked(`API [${a.toUpperCase()} ${t}] is not MOCKED!`);throw d.stack+=`\n${s}`,console.error(d),d}))})),l},iC=(e,t)=>{if(e===t)return!0;if(/{.*?}/.test(e)){const a=t.split(/\//),n=e.split(/\//);return a.length===n.length&&a.every(((e,t)=>e===n[t]||/{.*?}/.test(n[t])))}return!1},rC=e=>"object"==typeof e&&"path"in e,sC=e=>t=>{const a=[],n={async waitForApi(){await Object(tC.act)((async()=>Promise.all(a.map((e=>e()))).then((()=>{}))))},responseProvider:{}};return e.forEach((e=>{const{waitForApi:a,...i}=e(t);Object(lf.merge)(n,i)})),n};var oC=a(7),lC=a.n(oC),cC=a(650),uC=a.n(cC),dC=a(89),pC=a(407),mC=a(199),fC=a(65),gC=a(357),bC=a(1343),hC=a.n(bC);const yC=["windows","macos","linux"],vC=Array.from({length:14},((e,t)=>864e5*(t+1))),EC=["elastic","shay","Damian","Sarai","Deirdre","Shawana","Treena","Ellamae","Myriam","Roberto","Cordell","Demetrice","Audrea","Shanel","Gail","Hermila","Mara","Elden","Malisa","Derick","Teddy","Dovie","Betty","Kay","Sharice","Evalyn","Teressa","Teisha","Marianne","Cherelle","Tabitha","Deneen","Leo","Tess","Clair","Marty","Dexter","Candis","Dina","Bennett","Vesta","Trinity","Drusilla","Bree","Bryon","Johnson","Justa","Jada","Armand","Raeann","Yolande","Genevieve"];class base_data_generator_BaseDataGenerator{constructor(e=Math.random().toString()){lC()(this,"random",void 0),this.random="string"==typeof e?hC()(e):e}generate(){throw new Error("method not implemented!")}randomUser(){return this.randomChoice(EC)}randomFutureDate(e){const t=e?e.getTime():Date.now();return new Date(t+this.randomChoice(vC)).toISOString()}randomPastDate(e){const t=e?e.getTime():Date.now();return new Date(t-this.randomChoice(vC)).toISOString()}randomBoolean(e=.5){return this.random()<e}randomOSFamily(){return this.randomChoice(yC)}randomUUID(){return Na.a.v4()}seededUUIDv4(){return Na.a.v4({random:[...this.randomNGenerator(255,16)]})}randomN(e){return Math.floor(this.random()*e)}*randomNGenerator(e,t){let a=t;for(;a>0;)yield this.randomN(e),a-=1}randomArray(e,t){const a=this.randomN(e)+1;return[...Array(a).keys()].map(t)}randomMac(){return[...this.randomNGenerator(255,6)].map((e=>e.toString(16))).join("-")}randomIP(){return[10,...this.randomNGenerator(255,3)].map((e=>e.toString())).join(".")}randomVersion(){return[7,...this.randomNGenerator(20,2)].map((e=>e.toString())).join(".")}randomChoice(e){return e[this.randomN(e.length)]}randomString(e){return[...this.randomNGenerator(36,e)].map((e=>e.toString(36))).join("")}randomHostname(){return`Host-${this.randomString(10)}`}}const TC=[{name:"Windows",full:"Windows 10",version:"10.0",platform:"Windows",family:"windows",Ext:{variant:"Windows Pro"}},{name:"Windows",full:"Windows Server 2016",version:"10.0",platform:"Windows",family:"windows",Ext:{variant:"Windows Server"}},{name:"Windows",full:"Windows Server 2012",version:"6.2",platform:"Windows",family:"windows",Ext:{variant:"Windows Server"}},{name:"Windows",full:"Windows Server 2012R2",version:"6.3",platform:"Windows",family:"windows",Ext:{variant:"Windows Server Release 2"}}],kC=[ij.d.success,ij.d.failure,ij.d.warning,ij.d.unsupported],xC=[{name:"Default",id:"00000000-0000-0000-0000-000000000000",status:ij.d.success,endpoint_policy_version:1,version:3},{name:"With Eventing",id:"C2A9093E-E289-4C0A-AA44-8C32A414FA7A",status:ij.d.success,endpoint_policy_version:3,version:5},{name:"Detect Malware Only",id:"47d7965d-6869-478b-bd9c-fb0d2bb3959f",status:ij.d.success,endpoint_policy_version:4,version:9}],SC=["creation","open","rename","execution","deletion"];let wC,OC;!function(e){e.Driver="driver",e.File="file",e.Network="network",e.Registry="registry",e.Authentication="authentication",e.Session="session"}(wC||(wC={})),function(e){e.Random="random",e.Driver="driver",e.File="file",e.Network="network",e.Registry="registry",e.Security="security"}(OC||(OC={}));const jC={[OC.Security]:[wC.Authentication,wC.Session],[OC.Driver]:wC.Driver,[OC.File]:wC.File,[OC.Network]:wC.Network,[OC.Registry]:wC.Registry,[OC.Random]:""},CC={[OC.Security]:{category:jC[OC.Security],creationType:"start"},[OC.Driver]:{category:jC[OC.Driver],creationType:"start"},[OC.File]:{category:jC[OC.File],creationType:"creation"},[OC.Network]:{category:jC[OC.Network],creationType:"start"},[OC.Registry]:{category:jC[OC.Registry],creationType:"creation"}};function IC(e){var t,a,n,i,r,s,o,l,c,u,d,p;return{ancestors:null!==(t=null==e?void 0:e.ancestors)&&void 0!==t?t:3,generations:null!==(a=null==e?void 0:e.generations)&&void 0!==a?a:2,children:null!==(n=null==e?void 0:e.children)&&void 0!==n?n:2,relatedEvents:null!==(i=null==e?void 0:e.relatedEvents)&&void 0!==i?i:5,relatedEventsOrdered:null!==(r=null==e?void 0:e.relatedEventsOrdered)&&void 0!==r&&r,relatedAlerts:null!==(s=null==e?void 0:e.relatedAlerts)&&void 0!==s?s:3,percentWithRelated:null!==(o=null==e?void 0:e.percentWithRelated)&&void 0!==o?o:30,percentTerminated:null!==(l=null==e?void 0:e.percentTerminated)&&void 0!==l?l:100,alwaysGenMaxChildrenPerNode:null!==(c=null==e?void 0:e.alwaysGenMaxChildrenPerNode)&&void 0!==c&&c,ancestryArraySize:null!==(u=null==e?void 0:e.ancestryArraySize)&&void 0!==u?u:2,eventsDataStream:null!==(d=null==e?void 0:e.eventsDataStream)&&void 0!==d?d:qC,alertsDataStream:null!==(p=null==e?void 0:e.alertsDataStream)&&void 0!==p?p:PC}}const MC={type:"metrics",dataset:"endpoint.metadata",namespace:"default"},AC={type:"metrics",dataset:"endpoint.policy",namespace:"default"},qC={type:"logs",dataset:"endpoint.events.process",namespace:"default"};var DC;!function(e){e.MALWARE="MALWARE",e.MEMORY_SIGNATURE="MEMORY_SIGNATURE",e.MEMORY_SHELLCODE="MEMORY_SHELLCODE",e.BEHAVIOR="BEHAVIOR"}(DC||(DC={}));const PC={type:"logs",dataset:"endpoint.alerts",namespace:"default"};class generate_data_EndpointDocGenerator extends base_data_generator_BaseDataGenerator{constructor(e=Math.random().toString()){super(e),lC()(this,"commonInfo",void 0),lC()(this,"sequence",0),this.commonInfo=this.createHostData()}updateHostData(){this.commonInfo.host.ip=this.randomArray(3,(()=>this.randomIP()))}updateHostPolicyData(){this.commonInfo.Endpoint.policy.applied=this.randomChoice(xC),this.commonInfo.Endpoint.policy.applied.status=this.randomChoice(kC)}updateCommonInfo(){this.commonInfo=this.createHostData()}static createDataStreamFromIndex(e){const t=e.split("-");return{type:t[0],dataset:t[1],namespace:t[2]}}createHostData(){const e=this.randomHostname(),t=this.randomBoolean(.3),a=this.randomVersion();return{agent:{version:a,id:this.seededUUIDv4(),type:"endpoint"},elastic:{agent:{id:this.seededUUIDv4()}},host:{id:this.seededUUIDv4(),hostname:e,name:e,architecture:this.randomString(10),ip:this.randomArray(3,(()=>this.randomIP())),mac:this.randomArray(3,(()=>this.randomMac())),os:this.randomChoice(TC)},Endpoint:{status:ij.c.enrolled,policy:{applied:this.randomChoice(xC)},configuration:{isolation:t},state:{isolation:t},capabilities:uC()("7.15.0",a)?["isolation"]:[]}}}generateHostMetadata(e=(new Date).getTime(),t=MC){return{"@timestamp":e,event:{created:e,id:this.seededUUIDv4(),kind:"metric",category:["host"],type:["info"],module:"endpoint",action:"endpoint_metadata",dataset:"endpoint.metadata"},...this.commonInfo,data_stream:t}}generateMalwareAlert({ts:e=(new Date).getTime(),entityID:t=this.randomString(10),parentEntityID:a,ancestry:n=[],alertsDataStream:i=PC}={}){return{...this.commonInfo,data_stream:i,"@timestamp":e,ecs:{version:"1.4.0"},event:{action:this.randomChoice(SC),kind:"alert",category:"malware",code:"malicious_file",id:this.seededUUIDv4(),dataset:"endpoint",module:"endpoint",type:"creation",sequence:this.sequence++},file:{owner:"SYSTEM",name:"fake_malware.exe",path:"C:/fake_malware.exe",accessed:e,mtime:e,created:e,size:3456,hash:{md5:"fake file md5",sha1:"fake file sha1",sha256:"fake file sha256"},Ext:{code_signature:[{trusted:!1,subject_name:"bad signer"}],malware_classification:{identifier:"endpointpe",score:1,threshold:.66,version:"3.0.33"},temp_file_path:"C:/temp/fake_malware.exe",quarantine_result:!0,quarantine_message:"fake quarantine message"}},process:{pid:2,name:"malware writer",start:e,uptime:0,entity_id:t,executable:"C:/malware.exe",parent:a?{entity_id:a,pid:1}:void 0,hash:{md5:"fake md5",sha1:"fake sha1",sha256:"fake sha256"},Ext:{ancestry:n,code_signature:[{trusted:!1,subject_name:"bad signer"}],user:"SYSTEM",token:{domain:"NT AUTHORITY",integrity_level:16384,integrity_level_name:"system",privileges:[{description:"Replace a process level token",enabled:!1,name:"SeAssignPrimaryTokenPrivilege"}],sid:"S-1-5-18",type:"tokenPrimary",user:"SYSTEM"}}},dll:this.getAlertsDefaultDll()}}generateMemoryAlert({ts:e=(new Date).getTime(),entityID:t=this.randomString(10),parentEntityID:a,ancestry:n=[],alertsDataStream:i=PC,alertType:r}={}){const s=this.randomProcessName(),o=r===DC.MEMORY_SHELLCODE,l={...this.commonInfo,data_stream:i,"@timestamp":e,ecs:{version:"1.6.0"},Memory_protection:{feature:o?"shellcode_thread":"signature",self_injection:!0},event:{action:"start",kind:"alert",category:"malware",code:o?"shellcode_thread":"memory_signature",id:this.seededUUIDv4(),dataset:"endpoint",module:"endpoint",type:"info",sequence:this.sequence++},file:{},process:{pid:2,name:s,start:e,uptime:0,entity_id:t,executable:`C:/fake/${s}`,parent:a?{entity_id:a,pid:1}:void 0,hash:{md5:"fake md5",sha1:"fake sha1",sha256:"fake sha256"},Ext:{ancestry:n,code_signature:[{trusted:!1,subject_name:"bad signer"}],user:"SYSTEM",token:{integrity_level_name:"high"},malware_signature:{all_names:"Windows.Trojan.FakeAgent",identifier:"diagnostic-malware-signature-v1-fake"}}},dll:this.getAlertsDefaultDll()};return o&&(l.Target={process:{thread:{Ext:{start_address_allocation_offset:0,start_address_bytes_disasm_hash:"a disam hash",start_address_details:{allocation_type:"PRIVATE",allocation_size:4e3,region_size:4e3,region_protection:"RWX",memory_pe:{imphash:"a hash"}}}}}}),l}generateAlert({ts:e=(new Date).getTime(),entityID:t=this.randomString(10),parentEntityID:a,ancestry:n=[],alertsDataStream:i=PC}={}){const r=this.randomChoice(Object.values(DC));switch(r){case DC.MALWARE:return this.generateMalwareAlert({ts:e,entityID:t,parentEntityID:a,ancestry:n,alertsDataStream:i});case DC.MEMORY_SIGNATURE:case DC.MEMORY_SHELLCODE:return this.generateMemoryAlert({ts:e,entityID:t,parentEntityID:a,ancestry:n,alertsDataStream:i,alertType:r});case DC.BEHAVIOR:return this.generateBehaviorAlert({ts:e,entityID:t,parentEntityID:a,ancestry:n,alertsDataStream:i});default:return Object(dC.assertNever)(r)}}generateBehaviorAlert({ts:e=(new Date).getTime(),entityID:t=this.randomString(10),parentEntityID:a,ancestry:n=[],alertsDataStream:i=PC}={}){const r=this.randomProcessName();return{...this.commonInfo,data_stream:i,"@timestamp":e,ecs:{version:"1.6.0"},rule:{id:this.randomUUID(),description:"Behavior rule description"},event:{action:"rule_detection",kind:"alert",category:"behavior",code:"behavior",id:this.seededUUIDv4(),dataset:"endpoint.diagnostic.collection",module:"endpoint",type:"info",sequence:this.sequence++},file:{name:"fake_behavior.exe",path:"C:/fake_behavior.exe"},destination:{port:443,ip:this.randomIP()},source:{port:59406,ip:this.randomIP()},network:{transport:"tcp",type:"ipv4",direction:"outgoing"},registry:{path:"HKEY_USERS\\S-1-5-21-2460036010-3910878774-3458087990-1001\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\chrome",value:r,data:{strings:`C:/fake_behavior/${r}`}},process:{pid:2,name:r,entity_id:t,executable:`C:/fake_behavior/${r}`,code_signature:{status:"trusted",subject_name:"Microsoft Windows"},parent:a?{entity_id:a,pid:1}:void 0,Ext:{ancestry:n,code_signature:[{trusted:!1,subject_name:"bad signer"}],user:"SYSTEM",token:{integrity_level_name:"high",elevation_level:"full"}}},dll:this.getAlertsDefaultDll()}}getAlertsDefaultDll(){return[{pe:{architecture:"x64"},code_signature:{subject_name:"Cybereason Inc",trusted:!0},hash:{md5:"1f2d082566b0fc5f2c238a5180db7451",sha1:"ca85243c0af6a6471bdaa560685c51eefd6dbc0d",sha256:"8ad40c90a611d36eb8f9eb24fa04f7dbca713db383ff55a03aa0f382e92061a2"},path:"C:\\Program Files\\Cybereason ActiveProbe\\AmSvc.exe",Ext:{compile_time:1534424710,mapped_address:5362483200,mapped_size:0,malware_classification:{identifier:"Whitelisted",score:0,threshold:0,version:"3.0.0"}}}]}generateEvent(e={}){var t,a,n,i;const r=null!==(t=null===(a=e.ancestry)||void 0===a?void 0:a.slice(0,null!==(n=null==e?void 0:e.ancestryArrayLimit)&&void 0!==n?n:2))&&void 0!==t?t:[],s=e.processName?e.processName:this.randomProcessName(),o=e.extensions||(e=>"registry"===e?{registry:{key:`HKLM/Windows/Software/${this.randomString(5)}`}}:"network"===e?{network:{direction:this.randomChoice(["inbound","outbound"]),forwarded_ip:`${this.randomIP()}`}}:"file"===e?{file:{path:"C:\\My Documents\\business\\January\\processName"}}:"dns"===e?{dns:{question:{name:`${this.randomIP()}`}}}:{})(e.eventCategory);return{data_stream:null!==(i=null==e?void 0:e.eventsDataStream)&&void 0!==i?i:qC,"@timestamp":e.timestamp?e.timestamp:(new Date).getTime(),agent:{...this.commonInfo.agent,type:"endpoint"},ecs:{version:"1.4.0"},...o,event:{category:e.eventCategory?e.eventCategory:["process"],kind:"event",type:e.eventType?e.eventType:["start"],id:this.seededUUIDv4(),sequence:this.sequence++},host:this.commonInfo.host,process:{pid:"pid"in e&&void 0!==e.pid?e.pid:this.randomN(5e3),executable:`C:\\${s}`,args:`"C:\\${s}" \\${this.randomString(3)}`,code_signature:{status:"trusted",subject_name:"Microsoft"},hash:{md5:this.seededUUIDv4()},entity_id:e.entityID?e.entityID:this.randomString(10),parent:e.parentEntityID?{entity_id:e.parentEntityID,pid:"parentPid"in e&&void 0!==e.parentPid?e.parentPid:this.randomN(5e3)}:void 0,name:s,Ext:{ancestry:r}},user:{domain:this.randomString(10),name:this.randomString(10)}}}static getStartEndTimes(e){let t,a;var n;e.length>0?(t=null!==(n=Object(mC.o)(e[0]))&&void 0!==n?n:(new Date).getTime(),a=t):(t=(new Date).getTime(),a=t);for(const n of e){const e=Object(mC.o)(n);void 0!==e&&(e<t&&(t=e),e>a&&(a=e))}return{startTime:new Date(t),endTime:new Date(a)}}generateTree(e={}){const t=IC(e),a=(e,t)=>{var a,n;const i=Object(mC.c)(t);if(!i)return e;let r=e.get(i);var s;(r||(r={id:i,lifecycle:[],relatedEvents:[],relatedAlerts:[]}),"event"===Object(gC.a)(null===(a=t.event)||void 0===a?void 0:a.kind))?"process"===Object(gC.a)(null===(s=t.event)||void 0===s?void 0:s.category)?r.lifecycle.push(t):r.relatedEvents.push(t):"alert"===Object(gC.a)(null===(n=t.event)||void 0===n?void 0:n.kind)&&r.relatedAlerts.push(t);return e.set(i,r)},n=(e,t,a)=>{if(!a||0===a.size)return t;t.push(a);const i=new Map;for(const t of a.values()){const a=e.get(t.id);if(a)for(const e of a.values())i.set(e.id,e)}return n(e,t,i)},i=this.createAlertEventAncestry(t),r=i.reduce(a,new Map),s=i[i.length-1],o=Object(mC.c)(s);if(!o)throw Error("could not find the originating alert's entity id");const l=r.get(o);if(!l)throw Error(`could not find origin while building tree: ${o}`);const c=Array.from(this.descendantsTreeGenerator(s,t)),u=c.reduce(a,new Map),d=(e=>{const t=new Map;for(const a of e.values()){const e=Object(mC.l)(a.lifecycle[0]);if(e){let n=t.get(e);n||(n=new Map,t.set(e,n)),n.set(a.id,a)}}return t})(u),p=n(d,[],d.get(l.id)),m=[...i,...c],{startTime:f,endTime:g}=generate_data_EndpointDocGenerator.getStartEndTimes(m);return{childrenByParent:d,children:u,ancestry:r,allEvents:m,origin:l,childrenLevels:p,startTime:f,endTime:g}}*alertsGenerator(e,t={}){const a=IC(t);for(let t=0;t<e;t++)yield*this.fullResolverTreeGenerator(a)}*fullResolverTreeGenerator(e={}){const t=IC(e),a=this.createAlertEventAncestry(t);for(let e=0;e<a.length;e++)yield a[e];yield*this.descendantsTreeGenerator(a[a.length-1],t)}createAlertEventAncestry(e={}){var t;const a=IC(e),n=[],i=(new Date).getTime(),r=this.generateEvent({timestamp:i+1e3,eventsDataStream:a.eventsDataStream});n.push(r);let s=r,o=(null!==(t=Object(mC.o)(r))&&void 0!==t?t:0)+1e3;const l=(e,t,n,i)=>{for(const r of this.relatedAlertsGenerator({node:e,relatedAlerts:t,alertCreationTime:n,alertsDataStream:a.alertsDataStream}))i.push(r)},c=(e,t,n)=>{for(const i of this.relatedEventsGenerator({node:e,relatedEvents:a.relatedEvents,processDuration:t,ordered:a.relatedEventsOrdered,eventsDataStream:a.eventsDataStream}))n.push(i)},u=21600;if(this.randomN(100)<a.percentWithRelated&&(c(s,u,n),l(s,a.relatedAlerts,u,n)),this.randomN(100)<a.percentTerminated){const e=this.randomN(1e6);n.push(this.generateEvent({timestamp:o+1e3*e,entityID:Object(mC.c)(r),parentEntityID:Object(mC.l)(r),eventCategory:["process"],eventType:["end"],eventsDataStream:a.eventsDataStream,processName:Object(mC.n)(r)}))}for(let e=0;e<a.ancestors;e++){var d,p;const t=Object(mC.c)(s),i=[];if(t&&i.push(t),i.push(...null!==(d=Object(mC.a)(s))&&void 0!==d?d:[]),s=this.generateEvent({timestamp:o,parentEntityID:Object(mC.c)(s),ancestry:i,ancestryArrayLimit:a.ancestryArraySize,parentPid:Object(gC.a)(null===(p=s.process)||void 0===p?void 0:p.pid),pid:this.randomN(5e3),eventsDataStream:a.eventsDataStream}),n.push(s),o+=1e3,this.randomN(100)<a.percentTerminated){const e=this.randomN(1e6);n.push(this.generateEvent({timestamp:o+1e3*e,entityID:Object(mC.c)(s),parentEntityID:Object(mC.l)(s),eventCategory:["process"],eventType:["end"],ancestry:Object(mC.a)(s),ancestryArrayLimit:a.ancestryArraySize,eventsDataStream:a.eventsDataStream,processName:Object(mC.n)(s)}))}if(this.randomN(100)<a.percentWithRelated){c(s,u,n);let t=a.relatedAlerts;e===a.ancestors-1&&(t-=1),l(s,t,u,n)}}return o+=1e3,n.push(this.generateAlert({ts:o,entityID:Object(mC.c)(s),parentEntityID:Object(mC.l)(s),ancestry:Object(mC.a)(s),alertsDataStream:a.alertsDataStream})),n}*descendantsTreeGenerator(e,t={}){var a;const n=IC(t);let i=this.randomN(n.children+1);n.alwaysGenMaxChildrenPerNode&&(i=n.children);const r=[{event:e,childrenCreated:0,maxChildren:i}];let s=null!==(a=Object(mC.o)(e))&&void 0!==a?a:0;for(;r.length>0;){var o;const e=r[r.length-1];if(e.childrenCreated===e.maxChildren||r.length===n.generations+1){r.pop();continue}e.childrenCreated++,s+=1e3;const t=Object(mC.c)(e.event),a=[];t&&a.push(t),a.push(...null!==(o=Object(mC.a)(e.event))&&void 0!==o?o:[]);const l=this.generateEvent({timestamp:s,parentEntityID:t,ancestry:a,ancestryArrayLimit:n.ancestryArraySize,eventsDataStream:n.eventsDataStream});i=this.randomN(n.children+1),n.alwaysGenMaxChildrenPerNode&&(i=n.children),r.push({event:l,childrenCreated:0,maxChildren:i}),yield l;let c=21600;this.randomN(100)<n.percentTerminated&&(c=this.randomN(1e6),yield this.generateEvent({timestamp:s+1e3*c,entityID:Object(mC.c)(l),parentEntityID:Object(mC.l)(l),eventCategory:["process"],eventType:["end"],ancestry:a,ancestryArrayLimit:n.ancestryArraySize,eventsDataStream:n.eventsDataStream})),this.randomN(100)<n.percentWithRelated&&(yield*this.relatedEventsGenerator({node:l,relatedEvents:n.relatedEvents,processDuration:c,ordered:n.relatedEventsOrdered,eventsDataStream:n.eventsDataStream}),yield*this.relatedAlertsGenerator({node:l,relatedAlerts:n.relatedAlerts,alertCreationTime:c,alertsDataStream:n.alertsDataStream}))}}*relatedEventsGenerator({node:e,relatedEvents:t=10,processDuration:a=21600,ordered:n=!1,eventsDataStream:i=qC}){var r;let s;const o=null!==(r=Object(mC.o)(e))&&void 0!==r?r:0;let l=o+1;s="number"==typeof t?[{category:OC.Random,count:t}]:t;for(const t of s){let r;for(let s=0;s<t.count;s++)r=t.category===OC.Random?this.randomChoice(Object.values(CC)):CC[t.category],n?l+=1e3*this.randomN(a):l=o+1e3*this.randomN(a),yield this.generateEvent({timestamp:l,entityID:Object(mC.c)(e),parentEntityID:Object(mC.l)(e),eventCategory:r.category,eventType:r.creationType,ancestry:Object(mC.a)(e),eventsDataStream:i})}}*relatedAlertsGenerator({node:e,relatedAlerts:t=3,alertCreationTime:a=21600,alertsDataStream:n=PC}){for(let r=0;r<t;r++){var i;const t=(null!==(i=Object(mC.o)(e))&&void 0!==i?i:0)+1e3*this.randomN(a);yield this.generateAlert({ts:t,entityID:Object(mC.c)(e),parentEntityID:Object(mC.l)(e),ancestry:Object(mC.a)(e),alertsDataStream:n})}}generatePolicyPackagePolicy(){const e=new Date(Date.now()-864e5).toISOString();return{id:this.seededUUIDv4(),name:"Endpoint Policy",description:"Policy to protect the worlds data",created_at:e,created_by:"elastic",updated_at:(new Date).toISOString(),updated_by:"elastic",policy_id:this.seededUUIDv4(),enabled:!0,output_id:"",inputs:[{type:"endpoint",enabled:!0,streams:[],config:{artifact_manifest:{value:{manifest_version:"1.0.0",schema_version:"v1",artifacts:{}}},policy:{value:Object(pC.c)()}}}],namespace:"default",package:{name:"endpoint",title:"Elastic Endpoint",version:"1.0.0"},revision:1}}generateAgentPolicy(){return{id:this.seededUUIDv4(),name:"Agent Policy",status:fC.agentPolicyStatuses.Active,description:"Some description",namespace:"default",is_managed:!1,monitoring_enabled:["logs","metrics"],revision:2,updated_at:"2020-07-22T16:36:49.196Z",updated_by:"elastic",package_policies:["852491f0-cc39-11ea-bac2-cdbf95b4b41a"],agents:0}}generateEpmPackage(){return{id:this.seededUUIDv4(),name:"endpoint",title:"Elastic Endpoint",version:"0.5.0",description:"This is the Elastic Endpoint package.",type:"integration",download:"/epr/endpoint/endpoint-0.5.0.tar.gz",path:"/package/endpoint/0.5.0",icons:[{path:"/package/endpoint/0.5.0/img/logo-endpoint-64-color.svg",src:"/img/logo-endpoint-64-color.svg",size:"16x16",type:"image/svg+xml"}],status:"installed",release:"ga",savedObject:{type:"epm-packages",id:"endpoint",attributes:{installed_kibana:[{id:"826759f0-7074-11ea-9bc8-6b38f4d29a16",type:"dashboard"},{id:"1cfceda0-728b-11ea-9bc8-6b38f4d29a16",type:"visualization"},{id:"1e525190-7074-11ea-9bc8-6b38f4d29a16",type:"visualization"},{id:"55387750-729c-11ea-9bc8-6b38f4d29a16",type:"visualization"},{id:"92b1edc0-706a-11ea-9bc8-6b38f4d29a16",type:"visualization"},{id:"a3a3bd10-706b-11ea-9bc8-6b38f4d29a16",type:"map"}],installed_es:[{id:"logs-endpoint.alerts",type:"index_template"},{id:"events-endpoint",type:"index_template"},{id:"logs-endpoint.events.file",type:"index_template"},{id:"logs-endpoint.events.library",type:"index_template"},{id:"metrics-endpoint.metadata",type:"index_template"},{id:"metrics-endpoint.metadata_mirror",type:"index_template"},{id:"logs-endpoint.events.network",type:"index_template"},{id:"metrics-endpoint.policy",type:"index_template"},{id:"logs-endpoint.events.process",type:"index_template"},{id:"logs-endpoint.events.registry",type:"index_template"},{id:"logs-endpoint.events.security",type:"index_template"},{id:"metrics-endpoint.telemetry",type:"index_template"}],package_assets:[],es_index_patterns:{alerts:"logs-endpoint.alerts-*",events:"events-endpoint-*",file:"logs-endpoint.events.file-*",library:"logs-endpoint.events.library-*",metadata:"metrics-endpoint.metadata-*",metadata_mirror:"metrics-endpoint.metadata_mirror-*",network:"logs-endpoint.events.network-*",policy:"metrics-endpoint.policy-*",process:"logs-endpoint.events.process-*",registry:"logs-endpoint.events.registry-*",security:"logs-endpoint.events.security-*",telemetry:"metrics-endpoint.telemetry-*"},name:"endpoint",version:"0.5.0",internal:!1,removable:!1,install_version:"0.5.0",install_status:"installed",install_started_at:"2020-06-24T14:41:23.098Z",install_source:"registry",keep_policies_up_to_date:!1},references:[],updated_at:"2020-06-24T14:41:23.098Z",version:"Wzc0LDFd"}}}generatePolicyResponse({ts:e=(new Date).getTime(),allStatus:t,policyDataStream:a=AC}={}){const n=this.randomN(10),i=()=>t||this.randomHostPolicyResponseActionStatus();return{data_stream:a,"@timestamp":e,agent:{id:this.commonInfo.agent.id,version:"1.0.0-local.20200416.0"},elastic:{agent:{id:this.commonInfo.elastic.agent.id}},ecs:{version:"1.4.0"},host:this.commonInfo.host,Endpoint:{policy:{applied:{actions:[{name:"configure_elasticsearch_connection",message:"elasticsearch comes configured successfully",status:ij.d.success},{name:"configure_kernel",message:"Failed to configure kernel",status:ij.d.failure},{name:"configure_logging",message:"Successfully configured logging",status:ij.d.success},{name:"configure_malware",message:"Unexpected error configuring malware",status:ij.d.failure},{name:"connect_kernel",message:"Successfully initialized minifilter",status:ij.d.success},{name:"detect_file_open_events",message:"Successfully stopped file open event reporting",status:ij.d.success},{name:"detect_file_write_events",message:"Failed to stop file write event reporting",status:ij.d.success},{name:"detect_image_load_events",message:"Successfully started image load event reporting",status:ij.d.success},{name:"detect_process_events",message:"Successfully started process event reporting",status:ij.d.success},{name:"download_global_artifacts",message:"Failed to download EXE model",status:ij.d.success},{name:"load_config",message:"Successfully parsed configuration",status:ij.d.success},{name:"load_malware_model",message:"Error deserializing EXE model; no valid malware model installed",status:ij.d.success},{name:"read_elasticsearch_config",message:"Successfully read Elasticsearch configuration",status:ij.d.success},{name:"read_events_config",message:"Successfully read events configuration",status:ij.d.success},{name:"read_kernel_config",message:"Succesfully read kernel configuration",status:ij.d.success},{name:"read_logging_config",message:"Field (logging.debugview) not found in config",status:ij.d.success},{name:"read_malware_config",message:"Successfully read malware detect configuration",status:ij.d.success},{name:"workflow",message:"Failed to apply a portion of the configuration (kernel)",status:ij.d.unsupported},{name:"download_model",message:"Failed to apply a portion of the configuration (kernel)",status:ij.d.success},{name:"ingest_events_config",message:"Failed to apply a portion of the configuration (kernel)",status:ij.d.success}],id:this.commonInfo.Endpoint.policy.applied.id,response:{configurations:{events:{concerned_actions:["download_model"],status:i()},logging:{concerned_actions:this.randomHostPolicyResponseActionNames(),status:i()},malware:{concerned_actions:this.randomHostPolicyResponseActionNames(),status:i()},streaming:{concerned_actions:this.randomHostPolicyResponseActionNames(),status:i()}}},artifacts:{global:{version:"1.4.0",identifiers:[{name:"endpointpe-model",sha256:"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855"}]},user:{version:"1.4.0",identifiers:[{name:"user-model",sha256:"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855"}]}},status:this.commonInfo.Endpoint.policy.applied.status,version:n,name:this.commonInfo.Endpoint.policy.applied.name,endpoint_policy_version:this.commonInfo.Endpoint.policy.applied.endpoint_policy_version}}},event:{created:e,id:this.seededUUIDv4(),kind:"state",category:["host"],type:["change"],module:"endpoint",action:"endpoint_policy_response",dataset:"endpoint.policy"}}}randomHostPolicyResponseActionNames(){return this.randomArray(this.randomN(8),(()=>this.randomChoice(["load_config","workflow","download_global_artifacts","configure_malware","read_malware_config","load_malware_model","read_kernel_config","configure_kernel","detect_process_events","detect_file_write_events","detect_file_open_events","detect_image_load_events","connect_kernel"])))}randomHostPolicyResponseActionStatus(){return this.randomChoice([ij.d.failure,ij.d.success,ij.d.warning,ij.d.unsupported])}randomProcessName(){return this.randomChoice(RC)}randomIP(){return super.randomIP()}}const RC=["lsass.exe","notepad.exe","mimikatz.exe","powershell.exe","iexlorer.exe","explorer.exe"],FC=["isolate","unisolate"];class fleet_action_generator_FleetActionGenerator extends base_data_generator_BaseDataGenerator{generate(e={}){const t=new Date(this.randomPastDate());return Object(lf.merge)({action_id:this.randomUUID(),"@timestamp":t.toISOString(),expiration:this.randomFutureDate(t),type:"INPUT_ACTION",input_type:"endpoint",agents:[this.randomUUID()],user_id:"elastic",data:{command:this.randomIsolateCommand(),comment:this.randomString(15)}},e)}generateIsolateAction(e={}){return Object(lf.merge)(this.generate({data:{command:"isolate"}}),e)}generateUnIsolateAction(e={}){return Object(lf.merge)(this.generate({data:{command:"unisolate"}}),e)}generateResponse(e={}){const t=new Date;return Object(lf.merge)({action_data:{command:this.randomIsolateCommand(),comment:""},action_id:this.randomUUID(),agent_id:this.randomUUID(),started_at:this.randomPastDate(),completed_at:t.toISOString(),error:"some error happen","@timestamp":t.toISOString()},e)}randomFloat(){return this.random()}randomN(e){return super.randomN(e)}randomIsolateCommand(){return this.randomChoice(FC)}}const _C=nC([{id:"pendingActions",method:"get",path:Kj.a,handler:e=>{const t=e.query.agent_ids;return t.length?{data:t.map(((e,t)=>({agent_id:e,pending_actions:t%2?{isolate:1}:{}})))}:{data:[{agent_id:"111-111",pending_actions:{}},{agent_id:"222-222",pending_actions:{isolate:1}}]}}}]),NC=nC([{id:"packageList",method:"get",path:fC.EPM_API_ROUTES.LIST_PATTERN,handler:()=>({response:[new generate_data_EndpointDocGenerator("seed").generateEpmPackage()]})}]),LC=(nC([{id:"endpointPackagePolicy",path:fC.PACKAGE_POLICY_API_ROUTES.INFO_PATTERN,method:"get",handler:()=>({item:new generate_data_EndpointDocGenerator("seed").generatePolicyPackagePolicy()})}]),nC([{id:"endpointPackagePolicyList",path:fC.PACKAGE_POLICY_API_ROUTES.LIST_PATTERN,method:"get",handler:()=>{const e=new generate_data_EndpointDocGenerator("seed");return{items:Array.from({length:5},((t,a)=>{const n=e.generatePolicyPackagePolicy();return n.name+=` ${a}`,n})),total:1,page:1,perPage:10}}}]),nC([{id:"agentPolicy",path:fC.AGENT_POLICY_API_ROUTES.LIST_PATTERN,method:"get",handler:()=>{const e=new generate_data_EndpointDocGenerator("seed"),t=e.generateHostMetadata(),a=e.generateAgentPolicy();return a.package_policies.push(t.Endpoint.policy.applied.id),{items:[a],perPage:10,total:1,page:1}}}])),BC=nC([{id:"checkPermissions",path:fC.appRoutesService.getCheckPermissionsPath(),method:"get",handler:()=>({error:void 0,success:!0})}]),zC=(nC([{id:"agentStatus",path:fC.AGENT_API_ROUTES.STATUS_PATTERN,method:"get",handler:()=>({results:{total:50,inactive:5,online:40,error:0,offline:5,updating:0,other:0,events:0}})}]),["Symantec Endpoint Security","Bitdefender GravityZone","Malwarebytes","Sophos Intercept X","Webroot Business Endpoint Protection","ESET Endpoint Security","FortiClient","Kaspersky Endpoint Security","Trend Micro Apex One","CylancePROTECT","VIPRE","Norton","McAfee Endpoint Security","AVG AntiVirus","CrowdStrike Falcon","Avast Business Antivirus","Avira Antivirus","Cisco AMP for Endpoints","Eset Endpoint Antivirus","VMware Carbon Black","Palo Alto Networks Traps","Trend Micro","SentinelOne","Panda Security for Desktops","Microsoft Defender ATP"]),HC=["policy","global"];class trusted_app_generator_TrustedAppGenerator extends base_data_generator_BaseDataGenerator{generate(e={}){return Object(lf.merge)(this.generateTrustedAppForCreate(),{id:this.seededUUIDv4(),version:this.randomString(5),created_at:this.randomPastDate(),updated_at:(new Date).toISOString(),created_by:this.randomUser(),updated_by:this.randomUser()},e)}generateTrustedAppForCreate({effectScope:e,...t}={}){var a;const n=this.randomChoice(zC),i=this.randomChoice(HC),r=null!=e?e:{type:i,..."policy"===i?{policies:this.randomArray(5,(()=>this.randomUUID()))}:{}},s=null!==(a=t.os)&&void 0!==a?a:"windows",o=this.randomChoice([{field:ij.b.PATH,operator:"included",type:"match",value:"windows"!==s?"/one/two/three":"c:\\fol\\bin.exe"},{field:ij.b.PATH,operator:"included",type:"wildcard",value:"windows"!==s?"/one/t*/*re/three.app":"c:\\fol*\\*ub*\\bin.exe"}]);return Object(lf.merge)({description:`Generator says we trust ${n}`,name:n,os:s,effectScope:r,entries:[{field:ij.b.HASH,operator:"included",type:"match",value:"1234234659af249ddf3e40864e9fb241"},o]},t)}}nC([{id:"trustedAppsList",path:Kj.l,method:"get",handler:({query:e})=>{var t,a;const n=e,i=new trusted_app_generator_TrustedAppGenerator("seed"),r=null!==(t=n.per_page)&&void 0!==t?t:10,s=Array.from({length:Math.min(r,50)},(()=>i.generate()));return s[2].effectScope={type:"policy",policies:["ddf6570b-9175-4a6d-b288-61a09771c647","b8e616ae-44fc-4be7-846c-ce8fa5c082dd"]},{page:null!==(a=n.page)&&void 0!==a?a:1,per_page:r,total:20,data:s}}}]),nC([{id:"trustedAppUpdate",path:Kj.n,method:"put",handler:({body:e,path:t})=>({data:{...e,id:t.split("/").pop(),created_at:"2021-10-12T16:02:55.856Z",created_by:"elastic",updated_at:"2021-10-13T16:02:55.856Z",updated_by:"elastic",version:"abc"}})}]);const UC=nC([{id:"metadataList",path:Kj.e,method:"post",handler:()=>{const e=new generate_data_EndpointDocGenerator("seed");return{hosts:Array.from({length:10},(()=>{const t={metadata:e.generateHostMetadata(),host_status:ij.e.UNHEALTHY};return e.updateCommonInfo(),t})),total:10,request_page_size:10,request_page_index:0}}},{id:"metadataDetails",path:Kj.d,method:"get",handler:()=>({metadata:new generate_data_EndpointDocGenerator("seed").generateHostMetadata(),host_status:ij.e.UNHEALTHY})}]),$C=nC([{id:"policyResponse",path:Kj.b,method:"get",handler:()=>new generate_data_EndpointDocGenerator("seed").generatePolicyResponse()}]),QC=nC([{id:"activityLogResponse",path:Kj.c,method:"get",handler:()=>{const e=new generate_data_EndpointDocGenerator("seed").generateHostMetadata(),t=new fleet_action_generator_FleetActionGenerator("seed"),a=t.generate({agents:[e.agent.id]});return{page:1,pageSize:50,startDate:"now-1d",endDate:"now",data:[{type:"response",item:{id:"",data:t.generateResponse({agent_id:e.agent.id})}},{type:"action",item:{id:"",data:a}}]}}}]),VC={count:1,transforms:[{state:o.Ub.FAILED}]},WC=nC([{id:"metadataTransformStats",path:o.ub,method:"get",handler:()=>VC}]),GC=sC([NC,LC,BC]),KC=(sC([UC,$C,QC,GC,_C,WC]),Object(n.memo)((()=>i.a.createElement(l.Switch,null,i.a.createElement(l.Route,{path:FO.e,exact:!0,component:eC}),i.a.createElement(l.Route,{path:"*",component:ue.a})))));KC.displayName="EndpointsContainer";var YC=a(146),JC=a(136);const XC=Object(n.memo)((e=>{const t=Object(n.useMemo)((()=>[{key:"total",title:S.i18n.translate("xpack.securitySolution.endpoint.policyDetails.agentsSummary.totalTitle",{defaultMessage:"Total agents"}),health:""},{key:"online",title:S.i18n.translate("xpack.securitySolution.endpoint.policyDetails.agentsSummary.onlineTitle",{defaultMessage:"Healthy"}),health:"success"},{key:"error",title:S.i18n.translate("xpack.securitySolution.endpoint.policyDetails.agentsSummary.errorTitle",{defaultMessage:"Unhealthy"}),health:"warning"},{key:"offline",title:S.i18n.translate("xpack.securitySolution.endpoint.policyDetails.agentsSummary.offlineTitle",{defaultMessage:"Offline"}),health:"subdued"}]),[]),a=Object(n.useContext)(N.ThemeContext);return i.a.createElement(_.EuiFlexGroup,{gutterSize:"l",responsive:!1,"data-test-subj":"policyAgentsSummary"},t.map((({key:t,title:n,health:r})=>i.a.createElement(_.EuiFlexItem,{grow:!1,key:t,style:{marginRight:"total"===t?a.eui.gutterTypes.gutterExtraLarge:void 0}},i.a.createElement(_.EuiDescriptionList,{textStyle:"reverse",style:{textAlign:"right"},listItems:[{title:n,description:i.a.createElement(i.a.Fragment,null,r&&i.a.createElement(_.EuiHealth,{color:"warning"===r?a.eui.euiColorWarning:r,className:"eui-alignMiddle"}),i.a.createElement(_.EuiI18nNumber,{value:e[t]}))}]})))))}));XC.displayName="AgentsSummary";const ZC=(e,t)=>{const{getAppUrl:a}=Object(nb.b)(),{toRoutePath:i,toRouteUrl:r}=Object(n.useMemo)((()=>{const e=Object(I.m)();return{toRoutePath:e,toRouteUrl:a({path:e})}}),[a]),s=Object(n.useMemo)((()=>Object(I.l)(e)),[e]),l=Object(n.useMemo)((()=>({backButtonLabel:S.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.empty.unassigned.backButtonLabel",{defaultMessage:"Back to {policyName} policy",values:{policyName:t}}),onBackButtonNavigateTo:[o.l,{path:s}],backButtonUrl:a({appId:o.l,path:s})})),[a,t,s]);return{onClickHandler:Object(Bm.a)(o.l,{state:l,path:i}),toRouteUrl:r}};var eI=a(282);const tI=Object(n.memo)((({policyId:e,policyName:t})=>{const{isPlatinumPlus:a}=Object(eI.a)(),r=Object(YC.a)(),{onClickHandler:s,toRouteUrl:o}=ZC(e,t),l=Object(n.useCallback)((()=>r({show:"list"})),[r]);return i.a.createElement(_.EuiPageTemplate,{template:"centeredContent"},i.a.createElement(_.EuiEmptyPrompt,{iconType:"plusInCircle","data-test-subj":"policy-trusted-apps-empty-unassigned",title:i.a.createElement("h2",null,i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.trustedApps.empty.unassigned.title",defaultMessage:"No assigned trusted applications"})),body:i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.trustedApps.empty.unassigned.content",defaultMessage:"There are currently no trusted applications assigned to {policyName}. Assign trusted applications now or add and manage them on the trusted applications page.",values:{policyName:t}}),actions:[...a?[i.a.createElement(_.EuiButton,{color:"primary",fill:!0,onClick:l,"data-test-subj":"assign-ta-button"},i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.trustedApps.empty.unassigned.primaryAction",defaultMessage:"Assign trusted applications"}))]:[],i.a.createElement(_.EuiLink,{onClick:s,href:o},i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.trustedApps.empty.unassigned.secondaryAction",defaultMessage:"Manage trusted applications"}))]}))}));tI.displayName="PolicyTrustedAppsEmptyUnassigned";const aI=Object(n.memo)((({policyId:e,policyName:t})=>{const{onClickHandler:a,toRouteUrl:n}=ZC(e,t);return i.a.createElement(_.EuiPageTemplate,{template:"centeredContent"},i.a.createElement(_.EuiEmptyPrompt,{iconType:"plusInCircle","data-test-subj":"policy-trusted-apps-empty-unexisting",title:i.a.createElement("h2",null,i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.trustedApps.empty.unexisting.title",defaultMessage:"No trusted applications exist"})),body:i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.trustedApps.empty.unexisting.content",defaultMessage:"There are currently no trusted applications applied to your endpoints."}),actions:i.a.createElement(_.EuiButton,{color:"primary",fill:!0,onClick:a,href:n},i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.trustedApps.empty.unexisting.action",defaultMessage:"Add trusted application"}))}))}));aI.displayName="PolicyTrustedAppsEmptyUnexisting";const nI=S.i18n.translate("xpack.securitySolution.artifactCard.lastUpdated",{defaultMessage:"Last updated"}),iI=S.i18n.translate("xpack.securitySolution.artifactCard.created",{defaultMessage:"Created"}),rI=S.i18n.translate("xpack.securitySolution.artifactCard.lastUpdatedBy",{defaultMessage:"Updated by"}),sI=S.i18n.translate("xpack.securitySolution.artifactCard.createdBy",{defaultMessage:"Created by"}),oI=S.i18n.translate("xpack.securitySolution.artifactCard.globalEffectScope",{defaultMessage:"Applied globally"}),lI=(e=0)=>S.i18n.translate("xpack.securitySolution.artifactCard.policyEffectScope",{defaultMessage:"Applied to {count} {count, plural, one {policy} other {policies}}",values:{count:e}}),cI=(e=0)=>S.i18n.translate("xpack.securitySolution.artifactCard.policyEffectScope.title",{defaultMessage:"Applied to the following {count, plural, one {policy} other {policies}}",values:{count:e}}),uI=S.i18n.translate("xpack.securitySolution.artifactCard.conditions.matchOperator",{defaultMessage:"IS"}),dI=S.i18n.translate("xpack.securitySolution.artifactCard.conditions.matchOperator.not",{defaultMessage:"IS NOT"}),pI=S.i18n.translate("xpack.securitySolution.artifactCard.conditions.wildcardOperator",{defaultMessage:"MATCHES"}),mI=S.i18n.translate("xpack.securitySolution.artifactCard.conditions.nestedOperator",{defaultMessage:"has"}),fI=S.i18n.translate("xpack.securitySolution.artifactCard.conditions.matchAnyOperator",{defaultMessage:"is one of"}),gI=S.i18n.translate("xpack.securitySolution.artifactCard.conditions.matchAnyOperator.not",{defaultMessage:"is not one of"}),bI=S.i18n.translate("xpack.securitySolution.artifactCard.conditions.existsOperator",{defaultMessage:"exists"}),hI=S.i18n.translate("xpack.securitySolution.artifactCard.conditions.listOperator",{defaultMessage:"included in"}),yI=S.i18n.translate("xpack.securitySolution.artifactCard.conditions.os",{defaultMessage:"OS"}),vI=S.i18n.translate("xpack.securitySolution.artifactCard.conditions.and",{defaultMessage:"AND"}),EI=S.i18n.translate("xpack.securitySolution.artifactCard.conditions.windows",{defaultMessage:"Windows"}),TI=S.i18n.translate("xpack.securitySolution.artifactCard.conditions.linux",{defaultMessage:"Linux"}),kI=S.i18n.translate("xpack.securitySolution.artifactCard.conditions.macos",{defaultMessage:"Mac"}),xI=S.i18n.translate("xpack.securitySolution.artifactExpandableCard.expand",{defaultMessage:"Expand"}),SI=S.i18n.translate("xpack.securitySolution.artifactExpandableCard.collpase",{defaultMessage:"Collapse"}),wI=S.i18n.translate("xpack.securitySolution.artifactMinifiedCard.descriptionLabel",{defaultMessage:"Description"});var OI=a(72),jI=a.n(OI);const CI=Object(n.memo)((({bold:e,truncate:t,size:a="s",withTooltip:r=!1,"data-test-subj":s,children:o})=>{const l=Object(n.useMemo)((()=>jI()({"eui-textTruncate":t,"eui-textBreakWord":!0})),[t]),c=Object(n.useMemo)((()=>e?i.a.createElement("strong",null,o):o),[e,o]);return i.a.createElement(_.EuiText,{size:a,className:l,"data-test-subj":s},r&&"string"==typeof o&&o.length>0&&o!==Object(wr.e)()?i.a.createElement(_.EuiToolTip,{content:o,position:"top"},i.a.createElement(i.a.Fragment,null,c)):c)}));CI.displayName="TextValueDisplay";const II=L()(_.EuiFlexItem).withConfig({displayName:"StyledEuiFlexItem",componentId:"sc-14lo602-0"})(["padding-top:2px;"]),MI=Object(n.memo)((({date:e,type:t,"data-test-subj":a})=>{const n=Object(HO.a)(a);return i.a.createElement(_.EuiFlexGroup,{responsive:!1,alignItems:"flexStart",gutterSize:"m","data-test-subj":a},i.a.createElement(II,{grow:!1},i.a.createElement(_.EuiIcon,{type:"calendar"})),i.a.createElement(_.EuiFlexItem,{grow:!0},i.a.createElement(_.EuiFlexGroup,{responsive:!1,direction:"column",alignItems:"flexStart",gutterSize:"xs"},i.a.createElement(_.EuiFlexItem,{className:"eui-textTruncate","data-test-subj":n("label")},i.a.createElement(CI,null,"update"===t?nI:iI)),i.a.createElement(_.EuiFlexItem,{className:"eui-textTruncate","data-test-subj":n("value")},i.a.createElement(CI,{bold:!0},i.a.createElement(ws.b,{value:e,dateFormat:"M/D/YYYY"}))))))}));MI.displayName="DateField";const AI=Object(n.memo)((({items:e,button:t,panelPaddingSize:a,anchorPosition:r,maxWidth:s="32ch",maxHeight:o="255px",fixedWidth:l=!1,title:c,loading:u=!1,hoverInfo:d,...p})=>{const m=Object(HO.a)(p["data-test-subj"]),[f,g]=Object(n.useState)(!1),b=Object(n.useCallback)((()=>g(!1)),[g]),h=Object(n.useCallback)((()=>g(!f)),[f]),y=Object(n.useMemo)((()=>({"data-test-subj":m("popoverPanel")})),[m]),v=Object(n.useMemo)((()=>e.map(((e,t)=>{var a,n;return u?i.a.createElement(_.EuiLoadingContent,{lines:1,key:Na.a.v4(),"data-test-subj":null!==(n=e["data-test-subj"])&&void 0!==n?n:m(`item-loading-${t}`)}):i.a.createElement(QO,F()({},e,{key:Na.a.v4(),"data-test-subj":null!==(a=e["data-test-subj"])&&void 0!==a?a:m(`item-${t}`),textTruncate:Boolean(s)||e.textTruncate,hoverInfo:d,onClick:t=>{if(b(),e.onClick)return e.onClick(t)}}))}))),[m,b,e,s,u,d]),E=Object(n.useMemo)((()=>{const e={className:"eui-yScroll",style:{}};return s&&!l&&(e.style.maxWidth=s),o&&(e.style.maxHeight=o),l&&(e.style.width=null!=s?s:"32ch"),e}),[s,l,o]);return i.a.createElement(_.EuiPopover,F()({},p,{anchorPosition:r,panelPaddingSize:a,panelProps:y,button:i.a.createElement("div",{className:"eui-displayInlineBlock","data-test-subj":m("triggerButtonWrapper"),onClick:h},t),isOpen:f,closePopover:b}),c?i.a.createElement(_.EuiPopoverTitle,{paddingSize:"m"},c):null,i.a.createElement(_.EuiContextMenuPanel,F()({hasFocus:!1},E,{items:v})))}));AI.displayName="ContextMenuWithRouterSupport";const qI=Object(n.memo)((({items:e,"data-test-subj":t,icon:a="boxesHorizontal"})=>{const r=Object(HO.a)(t),[s,o]=Object(n.useState)(!1),l=Object(n.useCallback)((()=>o(!1)),[o]),c=Object(n.useCallback)((()=>o(!s)),[s]),u=Object(n.useMemo)((()=>({"data-test-subj":r("popoverPanel")})),[r]),d=Object(n.useMemo)((()=>e.map((e=>i.a.createElement(QO,F()({},e,{key:Na.a.v4(),onClick:t=>{if(l(),e.onClick)return e.onClick(t)}}))))),[l,e]);return i.a.createElement(_.EuiPopover,{anchorPosition:"downRight",panelPaddingSize:"none",panelProps:u,"data-test-subj":t,button:i.a.createElement(_.EuiButtonIcon,{"data-test-subj":r("button"),iconType:a,onClick:c,"aria-label":S.i18n.translate("xpack.securitySolution.actionsContextMenu.label",{defaultMessage:"Open"})}),isOpen:s,closePopover:l},i.a.createElement(_.EuiContextMenuPanel,{items:d,"data-test-subj":r("contextMenuPanel")}))}));qI.displayName="ActionsContextMenu";const DI=Object(n.memo)((({actions:e,"data-test-subj":t})=>e&&e.length>0?i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(qI,{items:e,icon:"boxesHorizontal","data-test-subj":t})):null));DI.displayName="CardActionsFlexItem";const PI=L()(_.EuiFlexItem).withConfig({displayName:"StyledEuiFlexItemSmallBottomMargin",componentId:"sc-k6t7b4-0"})(["margin-bottom:4px !important;"]),RI=Object(n.memo)((({name:e,createdDate:t,updatedDate:a,actions:n,"data-test-subj":r})=>{const s=Object(HO.a)(r);return i.a.createElement(_.EuiFlexGroup,{responsive:!1,alignItems:"flexStart","data-test-subj":r},i.a.createElement(PI,{grow:!0},i.a.createElement(_.EuiFlexGroup,{alignItems:"flexStart"},i.a.createElement(_.EuiFlexItem,{grow:!0},i.a.createElement(_.EuiTitle,{size:"s"},i.a.createElement("h3",{"data-test-subj":s("title")},e))),i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(_.EuiFlexGroup,{responsive:!1,gutterSize:"xl"},i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(MI,{date:a,type:"update","data-test-subj":s("updated")})),i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(MI,{date:t,type:"create","data-test-subj":s("created")})))))),i.a.createElement(DI,{actions:n,"data-test-subj":s("actions")}))}));RI.displayName="CardHeader";const FI=L()(_.EuiFlexItem).withConfig({displayName:"StyledEuiFlexItem",componentId:"sc-ylzny6-0"})(["margin:6px;"]),_I=Object(n.memo)((({createdBy:e,updatedBy:t,"data-test-subj":a})=>{const n=Object(HO.a)(a);return i.a.createElement(_.EuiFlexGroup,{alignItems:"center",gutterSize:"l",responsive:!1,"data-test-subj":a},i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(NI,{label:sI,value:e,"data-test-subj":n("createdBy")})),i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(NI,{label:rI,value:t,"data-test-subj":n("updatedBy")})))}));_I.displayName="TouchedByUsers";const NI=Object(n.memo)((({label:e,value:t,"data-test-subj":a})=>{const n=Object(HO.a)(a);return i.a.createElement(_.EuiFlexGroup,{alignItems:"center",gutterSize:"m",wrap:!1,responsive:!1,"data-test-subj":a},i.a.createElement(FI,{grow:!1},i.a.createElement(_.EuiBadge,{"data-test-subj":n("label")},e)),i.a.createElement(FI,{grow:!1},i.a.createElement(_.EuiFlexGroup,{responsive:!1,gutterSize:"s",alignItems:"center",wrap:!1},i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(_.EuiAvatar,{name:t,size:"s","data-test-subj":n("avatar")})),i.a.createElement(_.EuiFlexItem,{grow:!1,className:"eui-textTruncate","data-test-subj":n("value")},i.a.createElement(CI,null,t)))))}));NI.displayName="UserName";const LI=L()("div").withConfig({displayName:"StyledWithContextMenuShiftedWrapper",componentId:"sc-rwna0x-0"})(["margin-left:-10px;"]),BI=L()(_.EuiButtonEmpty).withConfig({displayName:"StyledEuiButtonEmpty",componentId:"sc-rwna0x-1"})(["height:10px !important;"]),zI=Object(n.memo)((({policies:e,loadingPoliciesList:t=!1,"data-test-subj":a})=>{const r=Object(HO.a)(a),[s,o]=Object(n.useMemo)((()=>e?["partial",lI(e.length)]:["globe",oI]),[e]),l=i.a.createElement(_.EuiFlexGroup,{responsive:!1,wrap:!1,alignItems:"center",gutterSize:"s","data-test-subj":a},i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(_.EuiIcon,{type:s,size:"s"})),i.a.createElement(_.EuiFlexItem,{grow:!1,"data-test-subj":r("value")},i.a.createElement(CI,{size:"xs"},o)));return e&&e.length?i.a.createElement(LI,null,i.a.createElement(HI,{policies:e,loadingPoliciesList:t,"data-test-subj":r("popupMenu")},l)):l}));zI.displayName="EffectScope";const HI=Object(n.memo)((({policies:e,loadingPoliciesList:t=!1,children:a,"data-test-subj":r})=>{const s=Object(HO.a)(r),o=Object(n.useMemo)((()=>i.a.createElement(BI,{flush:"right",size:"s",iconSide:"right",iconType:"popout"},i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.contextMenuItemByRouter.viewDetails",defaultMessage:"View details"}))),[]);return i.a.createElement(AI,{maxHeight:"235px",fixedWidth:!0,panelPaddingSize:"none",items:e,anchorPosition:e.length>1?"rightCenter":"rightUp","data-test-subj":r,loading:t,hoverInfo:o,button:i.a.createElement(_.EuiButtonEmpty,{size:"xs","data-test-subj":s("button")},a),title:cI(e.length)})}));HI.displayName="WithContextMenu";const UI=Object(n.memo)((({createdBy:e,updatedBy:t,policies:a,loadingPoliciesList:n=!1,"data-test-subj":r})=>{const s=Object(HO.a)(r);return i.a.createElement(_.EuiFlexGroup,{alignItems:"center",responsive:!0,"data-test-subj":r},i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(_I,{createdBy:e,updatedBy:t,"data-test-subj":s("touchedBy")})),i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(zI,{policies:a,loadingPoliciesList:n,"data-test-subj":s("effectScope")})))}));UI.displayName="CardSubHeader";const $I=Object.freeze({linux:TI,mac:kI,macos:kI,windows:EI}),QI=Object.freeze({[Df.c.NESTED]:mI,[Df.c.MATCH_ANY]:fI,[Df.c.MATCH]:uI,[Df.c.WILDCARD]:pI,[Df.c.EXISTS]:bI,[Df.c.LIST]:hI}),VI=Object.freeze({[Df.c.MATCH_ANY]:gI,[Df.c.MATCH]:dI}),WI=L()(_.EuiFlexGroup).withConfig({displayName:"EuiFlexGroupNested",componentId:"sc-145kt5g-0"})(["margin-left:",";"],(({theme:e})=>e.eui.spacerSizes.xl)),GI=L()(_.EuiFlexItem).withConfig({displayName:"EuiFlexItemNested",componentId:"sc-145kt5g-1"})(["margin-bottom:6px !important;margin-top:6px !important;"]),KI=L()("span").withConfig({displayName:"StyledCondition",componentId:"sc-145kt5g-2"})(["margin-right:6px;"]),YI=Object(n.memo)((({os:e,entries:t,"data-test-subj":a})=>{const r=Object(HO.a)(a),s=Object(n.useMemo)((()=>e.map((e=>{var t;return null!==(t=$I[e])&&void 0!==t?t:e})).join(", ")),[e]),o=(e,t)=>"match_any"===e&&Array.isArray(t)?t.map((e=>i.a.createElement(_.EuiBadge,{color:"hollow"},e))):t,l=(e,t)=>{var a,n;return"nested"===e?"":"included"===t?null!==(a=QI[e])&&void 0!==a?a:e:null!==(n=VI[e])&&void 0!==n?n:e},c=Object(n.useCallback)(((e,t)=>{if("nested"===e&&t.length)return t.map((({field:e,type:t,value:a,operator:n})=>i.a.createElement(WI,{"data-test-subj":r("nestedCondition"),key:e+t+a,direction:"row",alignItems:"center",gutterSize:"m",responsive:!1},i.a.createElement(GI,{grow:!1},i.a.createElement(_.EuiToken,{iconType:"tokenNested",size:"s"})),i.a.createElement(GI,{grow:!1},i.a.createElement(_.EuiExpression,{description:"",value:e,color:"subdued"})),i.a.createElement(GI,{grow:!1},i.a.createElement(_.EuiExpression,{description:l(t,n),value:o(t,a)})))))}),[r]);return i.a.createElement("div",{"data-test-subj":a},i.a.createElement("div",{"data-test-subj":r("os")},i.a.createElement("strong",null,i.a.createElement(_.EuiExpression,{description:"",value:yI}),i.a.createElement(_.EuiExpression,{description:uI,value:s}))),t.map((({field:e,type:t,value:a,operator:n,entries:s=[]})=>i.a.createElement("div",{"data-test-subj":r("condition"),key:e+t+a},i.a.createElement(_.EuiExpression,{description:i.a.createElement(KI,null,vI),value:e,color:"subdued"}),i.a.createElement(_.EuiExpression,{description:l(t,n),value:o(t,a)}),c(t,s)))))}));YI.displayName="CriteriaConditions";const JI=e=>"effectScope"in e,XI="policy:",ZI=e=>(e=>{const t=e.filter((e=>e.startsWith(XI)));return t.some((e=>"policy:all"===e))?{type:"global"}:{type:"policy",policies:t.map((e=>e.substr(XI.length)))}})(e.tags),eM=e=>Object(n.useMemo)((()=>(e=>{var t;const a=e,{name:n,created_by:i,created_at:r,updated_at:s,updated_by:o,description:l="",entries:c}=a;return{name:n,created_by:i,created_at:r,updated_at:s,updated_by:o,description:l,comments:JI(a)?[]:a.comments,entries:c,os:JI(a)?[a.os]:null!==(t=a.os_types)&&void 0!==t?t:[],effectScope:JI(a)?a.effectScope:ZI(a)}})(e)),[e]),tM=L()(_.EuiPanel).withConfig({displayName:"EuiPanelStyled",componentId:"sc-13mspil-0"})(["&.artifactEntryCard + &.artifactEntryCard{margin-top:",";}"],(({theme:e})=>e.eui.spacerSizes.l)),aM=Object(n.memo)((({className:e,...t})=>i.a.createElement(tM,F()({},t,{hasBorder:!0,paddingSize:"none",className:`artifactEntryCard ${null!=e?e:""}`}))));aM.displayName="CardContainerPanel";const nM=L()(_.EuiPanel).withConfig({displayName:"StyledEuiPanel",componentId:"sc-1cjqxs3-0"})(["padding:32px;&.top-section{padding-bottom:24px;}&.bottom-section{padding-top:24px;}&.artifact-entry-collapsible-card{padding:24px !important;}"]),iM=Object(n.memo)((e=>i.a.createElement(nM,F()({},e,{hasBorder:!1,hasShadow:!1,paddingSize:"l"}))));iM.displayName="CardSectionPanel";const rM=L()(_.EuiAvatar).withConfig({displayName:"CustomEuiAvatar",componentId:"sc-1xphza0-0"})(["background-color:"," !important;"],(({theme:e})=>e.eui.euiColorLightShade)),sM=Object(n.memo)((({comments:e,"data-test-subj":t})=>{const a=Object(HO.a)(t),[r,s]=Object(n.useState)(!1),o=Object(n.useCallback)((()=>{s(!r)}),[s,r]),l=Object(n.useMemo)((()=>(e=>e.map((e=>({username:e.created_by,timestamp:i.a.createElement(ws.b,{value:e.created_at,dateFormat:"MMM D, YYYY"}),event:lw.l,timelineIcon:i.a.createElement(rM,{size:"s",name:e.created_by}),children:i.a.createElement(_.EuiText,{size:"s"},e.comment)}))))(e)),[e]),c=Object(n.useMemo)((()=>r?((e=0)=>S.i18n.translate("xpack.securitySolution.artifactCard.comments.label.hide",{defaultMessage:"Hide comments ({count})",values:{count:e}}))(e.length):((e=0)=>S.i18n.translate("xpack.securitySolution.artifactCard.comments.label.show",{defaultMessage:"Show comments ({count})",values:{count:e}}))(e.length)),[e.length,r]);return Object(me.isEmpty)(e)?null:i.a.createElement("div",{"data-test-subj":t},i.a.createElement(_.EuiSpacer,{size:"s"}),i.a.createElement(_.EuiButtonEmpty,{onClick:o,flush:"left",size:"xs","data-test-subj":a("label")},c),i.a.createElement(_.EuiAccordion,{id:"1",arrowDisplay:"none",forceState:r?"open":"closed"},i.a.createElement(_.EuiSpacer,{size:"m"}),i.a.createElement(_.EuiCommentList,{comments:l,"data-test-subj":a("list")})))}));sM.displayName="CardComments";const oM=(e,t)=>Object(n.useMemo)((()=>"policy"===e.effectScope.type?null==e?void 0:e.effectScope.policies.map((e=>t&&t[e]?t[e]:{children:e})):void 0),[e.effectScope,t]),lM=Object(n.memo)((({truncate:e,children:t,"data-test-subj":a,withTooltip:n})=>i.a.createElement(CI,{size:"m",truncate:e,"data-test-subj":a,withTooltip:n},t||Object(wr.e)())));lM.displayName="ArtifactDescription";const cM=Object(n.memo)((({item:e,policies:t,loadingPoliciesList:a=!1,actions:n,hideDescription:r=!1,hideComments:s=!1,"data-test-subj":o,...l})=>{const c=eM(e),u=Object(HO.a)(o),d=oM(c,t);return i.a.createElement(aM,F()({},l,{"data-test-subj":o}),i.a.createElement(iM,{className:"top-section"},i.a.createElement(RI,{name:c.name,createdDate:c.created_at,updatedDate:c.updated_at,actions:n,"data-test-subj":u("header")}),i.a.createElement(UI,{createdBy:c.created_by,updatedBy:c.updated_by,policies:d,loadingPoliciesList:a,"data-test-subj":u("subHeader")}),!r&&i.a.createElement(i.a.Fragment,null,i.a.createElement(_.EuiSpacer,{size:"l"}),i.a.createElement(lM,{"data-test-subj":u("description")},c.description)),s?null:i.a.createElement(i.a.Fragment,null,i.a.createElement(_.EuiSpacer,{size:"l"}),i.a.createElement(sM,{comments:c.comments,"data-test-subj":u("comments")}))),i.a.createElement(_.EuiHorizontalRule,{margin:"none"}),i.a.createElement(iM,{className:"bottom-section"},i.a.createElement(YI,{os:c.os,entries:c.entries,"data-test-subj":u("criteriaConditions")})))}));cM.displayName="ArtifactEntryCard";const uM=L()(_.EuiSplitPanel.Outer).withConfig({displayName:"CardContainerPanel",componentId:"sc-khxq0i-0"})(["&.artifactEntryCardMinified + &.artifactEntryCardMinified{margin-top:",";}"],(({theme:e})=>e.eui.spacerSizes.l)),dM=L()(_.EuiSplitPanel.Inner).withConfig({displayName:"CustomSplitInnerPanel",componentId:"sc-khxq0i-1"})(["background-color:"," !important;"],(({theme:e})=>e.eui.euiColorLightestShade)),pM=Object(n.memo)((({item:e,isSelected:t=!1,onToggleSelectedArtifact:a,"data-test-subj":r,...s})=>{var o;const l=eM(e),c=Object(HO.a)(r),[u,d]=Object(n.useState)("closed"),p=Object(n.useCallback)((()=>{d((e=>"closed"===e?"open":"closed"))}),[]),m=Object(n.useCallback)((()=>"open"===u?"Hide details":"Show details"),[u]),f=Object(n.useMemo)((()=>i.a.createElement(dM,null,i.a.createElement(_.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(_.EuiCheckbox,{id:l.name,"data-test-subj":`${l.name}_checkbox`,checked:t,onChange:()=>a(!t)})),i.a.createElement(_.EuiFlexItem,null,i.a.createElement(_.EuiTitle,{size:"xxs"},i.a.createElement("h5",{"data-test-subj":c("title")},l.name)))))),[l.name,c,t,a]);return i.a.createElement(uM,F()({},s,{"data-test-subj":r,className:`${null!==(o=s.className)&&void 0!==o?o:""}  artifactEntryCardMinified`,id:l.name,hasShadow:!1,hasBorder:!0}),f,i.a.createElement(_.EuiSplitPanel.Inner,{paddingSize:"s"},i.a.createElement(_.EuiPanel,{hasBorder:!1,hasShadow:!1,paddingSize:"s"},i.a.createElement(_.EuiTitle,{size:"xxs"},i.a.createElement("h5",{"data-test-subj":c("descriptionTitle")},wI)),i.a.createElement(lM,{"data-test-subj":c("description")},l.description)),i.a.createElement(_.EuiPanel,{hasBorder:!1,hasShadow:!1,paddingSize:"s"},i.a.createElement(_.EuiButtonEmpty,{"data-test-subj":c("collapse"),color:"primary",size:"s",flush:"left",iconType:"open"===u?"arrowUp":"arrowDown",iconSide:"right",iconSize:"m",onClick:p,style:{fontWeight:400}},m()),i.a.createElement(_.EuiAccordion,{id:"showDetails",arrowDisplay:"none",forceState:u},i.a.createElement(YI,{os:l.os,entries:l.entries,"data-test-subj":c("criteriaConditions")})))))}));pM.displayName="ArtifactEntryCardMinified";const mM=Object(n.memo)((({expanded:e,onClick:t,"data-test-subj":a})=>i.a.createElement(_.EuiButtonIcon,{iconType:e?"arrowUp":"arrowDown",onClick:t,"data-test-subj":a,"aria-label":e?SI:xI})));mM.displayName="CardExpandButton";const fM=Object(n.memo)((({artifact:e,onExpandCollapse:t,policies:a,actions:r,expanded:s=!1,"data-test-subj":o})=>{const l=Object(HO.a)(o),c=oM(e,a),u=Object(n.useCallback)((()=>{t()}),[t]);return i.a.createElement(hM,{"data-test-subj":o,expanded:s,expandToggle:i.a.createElement(mM,{expanded:s,onClick:u,"data-test-subj":l("expandCollapse")}),name:i.a.createElement(CI,{bold:!0,truncate:!s,withTooltip:!s},e.name),description:i.a.createElement(lM,{truncate:!s,withTooltip:!s},e.description),effectScope:i.a.createElement(zI,{policies:c,"data-test-subj":l("effectScope")}),actionMenu:i.a.createElement(DI,{actions:r,"data-test-subj":l("actions")})})}));fM.displayName="CardCompressedHeader";const gM=L.a.div.withConfig({displayName:"ButtonIconPlaceHolder",componentId:"sc-17lokoz-0"})(["display:inline-block;width:",";height:",";"],(({theme:e})=>e.eui.euiIconSizes.large),(({theme:e})=>e.eui.euiIconSizes.large)),bM=L()(_.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-17lokoz-1"})(["&.flushTop,.flushTop{padding-top:0;margin-top:0;}"]),hM=Object(n.memo)((({expanded:e,name:t,expandToggle:a,effectScope:r,actionMenu:s,description:o,"data-test-subj":l,flushTop:c})=>{const u=Object(HO.a)(l),d=(e=>Object(n.useMemo)((()=>jI()({"eui-textTruncate":!e})),[e]))(e),p=c?" flushTop":"";return i.a.createElement(bM,{responsive:!1,alignItems:"center","data-test-subj":l,className:p},i.a.createElement(_.EuiFlexItem,{grow:!1,className:p,"data-test-subj":u("expandCollapseHolder")},a),i.a.createElement(_.EuiFlexItem,{className:d+p},i.a.createElement(_.EuiFlexGroup,{alignItems:"center",className:p},i.a.createElement(_.EuiFlexItem,{grow:2,className:d+p,"data-test-subj":u("titleHolder")},t),i.a.createElement(_.EuiFlexItem,{grow:3,className:d+p,"data-test-subj":u("descriptionHolder")},o),i.a.createElement(_.EuiFlexItem,{grow:1,"data-test-subj":u("effectScopeHolder"),className:p},r))),!0===s?i.a.createElement(_.EuiFlexItem,{grow:!1,"data-test-subj":u("cardActionsPlaceholder"),className:p},i.a.createElement(gM,null)):s)}));hM.displayName="CardCompressedHeaderLayout";const yM=Object(n.memo)((({item:e,onExpandCollapse:t,policies:a,actions:n,expanded:r=!1,"data-test-subj":s,...o})=>{const l=eM(e),c=Object(HO.a)(s);return i.a.createElement(aM,F()({},o,{"data-test-subj":s}),i.a.createElement(iM,{className:"artifact-entry-collapsible-card"},i.a.createElement(fM,{artifact:l,actions:n,policies:a,expanded:r,onExpandCollapse:t,"data-test-subj":c("header")})),r&&i.a.createElement(i.a.Fragment,null,i.a.createElement(_.EuiHorizontalRule,{margin:"xs"}),i.a.createElement(iM,null,i.a.createElement(YI,{os:l.os,entries:l.entries,"data-test-subj":c("criteriaConditions")}))))}));yM.displayName="ArtifactEntryCollapsibleCard";const vM=i.a.memo((({artifacts:e,isListLoading:t,selectedArtifactIds:a,selectedArtifactsUpdated:r})=>{const s=Object(n.useMemo)((()=>a.reduce(((e,t)=>({...e,[t]:!0})),{})),[a]),o=Object(n.useMemo)((()=>{if(!e||!e.data.length)return null;const t=Array.from(e.data);return i.a.createElement("div",{"data-test-subj":"artifactsList"},t.map((e=>i.a.createElement(pM,{key:e.id,item:e,isSelected:s[e.id]||!1,onToggleSelectedArtifact:t=>r(e.id,t)}))))}),[e,s,r]);return t?i.a.createElement(un.a,{size:"xl"}):i.a.createElement("div",null,o)}));vM.displayName="PolicyArtifactsAssignableList";const EM=S.i18n.translate("xpack.securitySolution.management.policiesSelector.globalEntries",{defaultMessage:"Global entries"}),TM=S.i18n.translate("xpack.securitySolution.management.policiesSelector.unassignedEntries",{defaultMessage:"Unassigned entries"}),kM=Object(n.memo)((({policies:e,onChangeSelection:t,defaultExcludedPolicies:a,defaultIncludedPolicies:r})=>{const[s,o]=Object(n.useState)(!1),[l,c]=Object(n.useState)(""),[u,d]=Object(n.useState)([]),p=Object(fe.a)("excludePoliciesInFilterEnabled");Object(n.useEffect)((()=>{const t=r?r.split(",").reduce(((e,t)=>({...e,[t]:!0})),{}):{},n=a?a.split(",").reduce(((e,t)=>({...e,[t]:!0})),{}):{},i=e=>t[e]?"on":n[e]?"off":void 0;d([...e.map((e=>({name:e.name,id:e.id,checked:i(e.id)}))),{name:EM,id:"global",checked:i("global")},{name:TM,id:"unassigned",checked:i("unassigned")}])}),[e]);const m=Object(n.useCallback)((()=>{o((e=>!e))}),[]),f=Object(n.useCallback)((()=>{o(!1)}),[]),g=Object(n.useCallback)((e=>{const t=e.target.value||"";c(t)}),[]),b=Object(n.useCallback)((e=>{if(!u[e])return;const a=[...u];switch(a[e].checked){case"on":a[e].checked=p?"off":void 0;break;case"off":a[e].checked=void 0;break;default:a[e].checked="on"}d(a),t(a)}),[u,t,p]),h=Object(n.useMemo)((()=>u.map(((e,t)=>e.name.toLowerCase().includes(l.toLowerCase())?i.a.createElement(_.EuiFilterSelectItem,{checked:e.checked,key:t,onClick:()=>b(t)},e.name):null))),[u,l,b]),y=Object(n.useMemo)((()=>i.a.createElement(_.EuiFilterButton,{iconType:"arrowDown","data-test-subj":"policiesSelectorButton",onClick:m,isSelected:s,numFilters:u.length,hasActiveFilters:!!u.find((e=>"on"===e.checked)),numActiveFilters:u.filter((e=>"on"===e.checked)).length},i.a.createElement(_.EuiText,null,i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.management.policiesSelector.label",defaultMessage:"Policies"})))),[s,u,m]);return i.a.createElement(_.EuiFlexGroup,{"data-test-subj":"policiesSelector",direction:"row",alignItems:"center",gutterSize:"l"},i.a.createElement(_.EuiFlexItem,null,i.a.createElement(_.EuiFilterGroup,null,i.a.createElement(_.EuiPopover,{button:y,isOpen:s,closePopover:f,panelPaddingSize:"none"},i.a.createElement(_.EuiPopoverTitle,{paddingSize:"s"},i.a.createElement(_.EuiFieldSearch,{"data-test-subj":"policiesSelectorSearch",compressed:!0,onChange:g,value:l})),i.a.createElement("div",{className:"euiFilterSelect__items"},h)))))}));kM.displayName="PoliciesSelector";const xM=Object(n.memo)((({defaultValue:e="",onSearch:t,placeholder:a,hasPolicyFilter:r,policyList:s,defaultIncludedPolicies:o,defaultExcludedPolicies:l,hideRefreshButton:c=!1})=>{const{isPlatinumPlus:u}=Object(eI.a)(),[d,p]=Object(n.useState)(e),[m,f]=Object(n.useState)(o||""),[g,b]=Object(n.useState)(l||""),h=Object(n.useCallback)((e=>{const a=e.filter((e=>"on"===e.checked)).map((e=>e.id)).join(","),n=e.filter((e=>"off"===e.checked)).map((e=>e.id)).join(",");f(a),b(n),t(d,a,n)}),[t,d]),y=Object(n.useCallback)((e=>p(e.target.value)),[p]),v=Object(n.useCallback)((()=>t(d,m,g)),[t,d,m,g]),E=Object(n.useCallback)((e=>{t(e,m,g)}),[t,m,g]);return i.a.createElement(_.EuiFlexGroup,{"data-test-subj":"searchExceptions",direction:"row",alignItems:"center",gutterSize:"m"},i.a.createElement(_.EuiFlexItem,null,i.a.createElement(_.EuiFieldSearch,{defaultValue:e,placeholder:a,onChange:y,onSearch:E,isClearable:!0,fullWidth:!0,"data-test-subj":"searchField"})),u&&r&&s?i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(kM,{policies:s,defaultExcludedPolicies:l,defaultIncludedPolicies:o,onChangeSelection:h})):null,c?null:i.a.createElement(_.EuiFlexItem,{grow:!1,onClick:v,"data-test-subj":"searchButton"},i.a.createElement(_.EuiButton,{iconType:"refresh"},S.i18n.translate("xpack.securitySolution.management.search.button",{defaultMessage:"Refresh"}))))}));xM.displayName="SearchExceptions";const SM=i.a.memo((()=>{var e;Object(YC.c)();const t=Object(b.useDispatch)(),[a,r]=Object(n.useState)([]),s=Object(YC.b)(JC.j),o=Object(YC.b)(JC.J),l=Object(YC.b)(JC.f),c=Object(YC.b)(JC.i),u=Object(YC.b)(JC.A),d=Object(YC.b)(JC.B),p=Object(YC.b)(JC.g),m=Object(YC.b)(JC.h),f=Object(YC.a)(),g=null!==(e=null==o?void 0:o.name)&&void 0!==e?e:"",h=Object(n.useCallback)((()=>f({show:void 0})),[f]);Object(n.useEffect)((()=>{d&&(h(),t({type:"policyArtifactsUpdateTrustedAppsChanged",payload:{type:"UninitialisedResourceState"}}))}),[t,h,d]);const y=Object(n.useCallback)((()=>{t({type:"policyArtifactsUpdateTrustedApps",payload:{action:"assign",artifacts:a.map((e=>{var t;return null==l||null===(t=l.data)||void 0===t?void 0:t.find((t=>t.id===e))}))}})}),[null==l?void 0:l.data,t,a]),v=Object(n.useCallback)((e=>{t({type:"policyArtifactsAssignableListPageDataFilter",payload:{filter:e}})}),[t]),E=Object(n.useMemo)((()=>i.a.createElement(i.a.Fragment,null,i.a.createElement(_.EuiCallOut,{"data-test-subj":"tooMuchResultsWarningMessageTrustedAppsFlyout",color:"warning",size:"s",heading:"h4",title:S.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.layout.flyout.searchWarning.title",{defaultMessage:"Limited search results"})},S.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.layout.flyout.searchWarning.text",{defaultMessage:"Only the first 100 trusted applications are displayed. Please use the search bar to refine the results."})),i.a.createElement(_.EuiSpacer,{size:"m"}))),[]),T=Object(n.useMemo)((()=>m||c||!Object(me.isEmpty)(null==l?void 0:l.data)),[null==l?void 0:l.data,m,c]),k=Object(n.useMemo)((()=>Object(me.isEmpty)(null==l?void 0:l.data)&&p),[null==l?void 0:l.data,p]);return i.a.createElement(_.EuiFlyout,{onClose:h},i.a.createElement(_.EuiFlyoutHeader,{hasBorder:!0},i.a.createElement(_.EuiTitle,{size:"m"},i.a.createElement("h2",null,i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.trustedApps.layout.flyout.title",defaultMessage:"Assign trusted applications"}))),i.a.createElement(_.EuiSpacer,{size:"m"}),i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.trustedApps.layout.flyout.subtitle",defaultMessage:"Select trusted applications to add to {policyName}",values:{policyName:g}})),i.a.createElement(_.EuiFlyoutBody,null,((null==l?void 0:l.total)||0)>100?E:null,i.a.createElement(xM,{defaultValue:s.filter,onSearch:v,placeholder:S.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.layout.searh.label",{defaultMessage:"Search trusted applications"}),hideRefreshButton:!0}),i.a.createElement(_.EuiSpacer,{size:"m"}),T?i.a.createElement(vM,{"data-test-subj":"artifactsListTrustedAppsFlyout",artifacts:l,selectedArtifactIds:a,isListLoading:c||m,selectedArtifactsUpdated:(e,t)=>{r((a=>t?[...a,e]:Object(me.without)([e],a)))}}):k?i.a.createElement(_.EuiEmptyPrompt,{"data-test-subj":"noItemsFoundTrustedAppsFlyout",title:i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.trustedApps.layout.flyout.noResults",defaultMessage:"No items found"})}):i.a.createElement(_.EuiEmptyPrompt,{"data-test-subj":"noAssignableItemsTrustedAppsFlyout",title:i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.trustedApps.layout.flyout.noAssignable",defaultMessage:"There are no trusted applications that can be assigned to this policy."})})),i.a.createElement(_.EuiFlyoutFooter,null,i.a.createElement(_.EuiFlexGroup,{justifyContent:"spaceBetween"},i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(_.EuiButtonEmpty,{"data-test-subj":"cancelPolicyTrustedAppsFlyout",onClick:h},i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.trustedApps.layout.flyout.cancel",defaultMessage:"Cancel"}))),i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(_.EuiButton,{className:"eui-textTruncate",style:{maxWidth:"300px"},"data-test-subj":"confirmPolicyTrustedAppsFlyout",fill:!0,onClick:y,isLoading:u,disabled:Object(me.isEmpty)(a),title:g},i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.trustedApps.layout.flyout.confirm",defaultMessage:"Assign to {policyName}",values:{policyName:g}}))))))}));SM.displayName="PolicyTrustedAppsFlyout";const wM=L.a.div.withConfig({displayName:"RootContainer",componentId:"sc-nycnfh-0"})(["position:relative;padding-top:",";.body{min-height:",";&-content{position:relative;}}"],(({theme:e})=>e.eui.paddingSizes.xs),(({theme:e})=>e.eui.gutterTypes.gutterExtraLarge)),OM=Object(n.memo)((()=>i.a.createElement(_.EuiEmptyPrompt,{title:i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.endpoint.paginatedContent.noItemsFoundTitle",defaultMessage:"No items found"})})));OM.displayName="DefaultNoItemsFound";const jM=Object(n.memo)((({message:e,"data-test-subj":t})=>i.a.createElement(_.EuiText,{textAlign:"center","data-test-subj":t},i.a.createElement(_.EuiSpacer,{size:"m"}),i.a.createElement(_.EuiIcon,{type:"minusInCircle",color:"danger"})," ",e,i.a.createElement(_.EuiSpacer,{size:"m"}))));jM.displayName="ErrorMessage";const CM=Object(n.memo)((({items:e,ItemComponent:t,itemComponentProps:a,itemId:r,onChange:s,pagination:o,loading:l,noItemsMessage:c,error:u,contentClassName:d,"data-test-subj":p,"aria-label":m,className:f,children:g})=>{const[b]=Object(n.useState)(new WeakMap),h=Object(HO.a)(p),y=Object(n.useMemo)((()=>Math.ceil(((null==o?void 0:o.totalItemCount)||1)/((null==o?void 0:o.pageSize)||1))),[null==o?void 0:o.pageSize,null==o?void 0:o.totalItemCount]);Object(n.useEffect)((()=>{!l&&y>0&&y<((null==o?void 0:o.pageIndex)||0)+1&&s({pageIndex:y-1,pageSize:(null==o?void 0:o.pageSize)||0})}),[y,s,o,l]);const v=Object(n.useCallback)((e=>{s({pageSize:e,pageIndex:(null==o?void 0:o.pageIndex)||0})}),[s,null==o?void 0:o.pageIndex]),E=Object(n.useCallback)((e=>{s({pageIndex:e,pageSize:(null==o?void 0:o.pageSize)||10})}),[s,null==o?void 0:o.pageSize]),T=Object(n.useMemo)((()=>{if(u)return"string"==typeof u?i.a.createElement(jM,{message:u,"data-test-subj":h("error")}):u;const n=t;return e.length?e.map((e=>{let t;return r?t=e[r]:b.has(e)?t=b.get(e):(t=Object(_a.v4)(),b.set(e,t)),i.a.createElement(n,F()({},a(e),{key:t}))})):l?void 0:c||i.a.createElement(OM,null)}),[t,u,h,a,r,b,e,c,l]);return i.a.createElement(wM,{"data-test-subj":p,"aria-label":m,className:f},l&&i.a.createElement(_.EuiProgress,{size:"xs",color:"primary",position:"absolute","data-test-subj":h("loader")}),i.a.createElement("div",{className:"body","data-test-subj":h("body")},i.a.createElement("div",{className:`body-content ${d}`},g||T)),o&&(g||e.length>0)&&i.a.createElement("div",{"data-test-subj":h("footer")},i.a.createElement(_.EuiSpacer,{size:"l"}),i.a.createElement(_.EuiTablePagination,{activePage:o.pageIndex,itemsPerPage:o.pageSize,itemsPerPageOptions:o.pageSizeOptions,pageCount:y,hidePerPageOptions:o.hidePerPageOptions,onChangeItemsPerPage:v,onChangePage:E})))}));CM.displayName="PaginatedContent";const IM=L()(iM).withConfig({displayName:"GridHeaderContainer",componentId:"sc-1qje9ej-0"})(["padding-top:0;padding-bottom:",";"],(({theme:e})=>e.eui.paddingSizes.s)),MM=Object(n.memo)((({"data-test-subj":e})=>{const t=Object(HO.a)(e),a=Object(n.useMemo)((()=>i.a.createElement("div",{"data-test-subj":t("expandCollapsePlaceHolder"),style:{width:"24px"}})),[t]);return i.a.createElement(IM,{"data-test-subj":e},i.a.createElement(hM,{expanded:!1,expandToggle:a,"data-test-subj":t("layout"),flushTop:!0,name:i.a.createElement(_.EuiText,{size:"xs","data-test-subj":t("name")},i.a.createElement("strong",null,i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.artifactCardGrid.nameColumn",defaultMessage:"Name"}))),description:i.a.createElement(_.EuiText,{size:"xs","data-test-subj":t("description")},i.a.createElement("strong",null,i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.artifactCardGrid.DescriptionColumn",defaultMessage:"Description"}))),effectScope:i.a.createElement(_.EuiText,{size:"xs","data-test-subj":t("assignment")},i.a.createElement("strong",null,i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.artifactCardGrid.assignmentColumn",defaultMessage:"Assignment"}))),actionMenu:!0}))}));MM.displayName="GridHeader";const AM=CM,qM=Object(n.memo)((({items:e,cardComponentProps:t,onPageChange:a,onExpandCollapse:r,"data-test-subj":s,...o})=>{const l=Object(HO.a)(s),c=e,u=Object(n.useMemo)((()=>{const e=new Map;for(const a of c)e.set(a,t?t(a):{});return e}),[t,c]),d=Object(n.useCallback)((e=>{const t=[],a=[];for(const[n,i]of u){const r=Boolean(i.expanded);(n===e?!r:r)?t.push(n):a.push(n)}r({expanded:t,collapsed:a})}),[u,r]),p=Object(n.useMemo)((()=>{const e=new Map;for(const[a,n]of u){var t;e.set(a,{...n,item:a,onExpandCollapse:()=>d(a),"data-test-subj":null!==(t=n["data-test-subj"])&&void 0!==t?t:l("card")})}return e}),[u,l,d]),m=Object(n.useCallback)((e=>p.get(e)),[p]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(MM,{"data-test-subj":l("header")}),i.a.createElement(AM,F()({},o,{"data-test-subj":s,items:c,ItemComponent:yM,itemComponentProps:m,onChange:a})))}));qM.displayName="ArtifactCardGrid";const DM=Object(n.memo)((({trustedApps:e,onClose:t})=>{var a;const r=Object(m.m)(),s=Object(b.useDispatch)(),o=null===(a=Object(YC.b)(JC.J))||void 0===a?void 0:a.name,l=Object(YC.b)(JC.u),c=Object(YC.b)(JC.w),u=Object(YC.b)(JC.x),d=Object(n.useMemo)((()=>{const t=e.length;return 0===t?"":t>1?S.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.list.removeDialog.successMultiplesToastText",{defaultMessage:"{count} trusted applications have been removed from {policyName} policy",values:{count:t,policyName:o}}):S.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.list.removeDialog.successToastText",{defaultMessage:'"{trustedAppName}" has been removed from {policyName} policy',values:{trustedAppName:e[0].name,policyName:o}})}),[o,e]),p=Object(n.useCallback)((()=>{l||t()}),[l,t]),f=Object(n.useCallback)((()=>{s({type:"policyArtifactsUpdateTrustedApps",payload:{action:"remove",artifacts:e}})}),[s,e]);return Object(n.useEffect)((()=>()=>{s({type:"policyDetailsArtifactsResetRemove"})}),[s]),Object(n.useEffect)((()=>{c&&r.addError(c,{title:S.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.list.removeDialog.errorToastTitle",{defaultMessage:"Error while attempt to remove trusted application"})})}),[c,r]),Object(n.useEffect)((()=>{u&&(r.addSuccess({title:S.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.list.removeDialog.successToastTitle",{defaultMessage:"Successfully removed"}),text:d}),p())}),[p,o,d,r,e,u]),i.a.createElement(_.EuiConfirmModal,{onCancel:p,onConfirm:f,title:S.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.list.removeDialog.title",{defaultMessage:"Remove trusted application from policy"}),cancelButtonText:S.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.list.removeDialog.cancelLabel",{defaultMessage:"Cancel"}),confirmButtonText:S.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.list.removeDialog.confirmLabel",{defaultMessage:"Remove from policy"}),isLoading:l},i.a.createElement(_.EuiCallOut,{color:"warning",iconType:"help"},i.a.createElement("p",null,i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.trustedApps.list.removeDialog.messageCallout",defaultMessage:"This trusted application will be removed only from this policy and can still be found and managed from the trusted applications page."}))),i.a.createElement(_.EuiSpacer,null),i.a.createElement(_.EuiText,{size:"s"},i.a.createElement("p",null,i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.trustedApps.list.removeDialog.message",defaultMessage:"Are you sure you wish to continue?"}))))}));DM.displayName="RemoveTrustedAppFromPolicyModal";const PM="policyTrustedAppsGrid",RM=Object(n.memo)((({hideTotalShowingLabel:e=!1})=>{const t=Object(HO.a)(PM),a=Object(m.m)(),r=Object(l.useHistory)(),{getAppUrl:s}=Object(m.d)(),{isPlatinumPlus:c}=Object(eI.a)(),u=Object(YC.b)(JC.L),d=Object(YC.b)(JC.c),p=Object(YC.b)(JC.G),f=Object(YC.b)(JC.e),g=Object(YC.b)(JC.q),b=Object(YC.b)(JC.s),h=Object(YC.b)(JC.j),y=Object(YC.b)(JC.t),v=Object(YC.b)(JC.r),[E,T]=Object(n.useState)({}),[k,x]=Object(n.useState)([]),[w,O]=Object(n.useState)(!1),j=Object(n.useCallback)((({pageIndex:e,pageSize:t})=>{r.push(Object(I.k)(u,{...h,page_index:t!==b.pageSize?0:e,page_size:t}))}),[r,b.pageSize,u,h]),C=Object(n.useCallback)((({expanded:e,collapsed:t})=>{const a={};for(const t of e)a[t.id]=!0;for(const e of t)a[e.id]=!1;T(a)}),[]),M=Object(n.useMemo)((()=>S.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.list.totalCount",{defaultMessage:"Showing {totalItemsCount, plural, one {# trusted application} other {# trusted applications}}",values:{totalItemsCount:b.totalItemCount}})),[b.totalItemCount]),A=Object(n.useMemo)((()=>{const e=new Map;for(const a of g){const n="global"===a.effectScope.type,i=Object(I.m)({filter:a.id}),r="global"===a.effectScope.type?void 0:a.effectScope.policies.reduce(((e,t)=>{if(!y[t])return e[t]={children:t},e;const a=Object(I.j)(t),n={navigateAppId:o.l,navigateOptions:{path:a},href:s({path:a}),children:y[t].name};return e[t]=n,e}),{}),l=[{icon:"controlsHorizontal",children:S.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.list.viewAction",{defaultMessage:"View full details"}),href:s({appId:o.l,path:i}),navigateAppId:o.l,navigateOptions:{path:i},"data-test-subj":t("viewFullDetailsAction")}],u={expanded:Boolean(E[a.id]),actions:c?[...l,{icon:"trash",children:S.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.list.removeAction",{defaultMessage:"Remove from policy"}),onClick:()=>{x([a]),O(!0)},disabled:n,toolTipContent:n?S.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.list.removeActionNotAllowed",{defaultMessage:"Globally applied trusted applications cannot be removed from policy."}):void 0,toolTipPosition:"top","data-test-subj":t("removeAction")}]:l,policies:r};e.set(a,u)}return e}),[y,s,t,E,g,c]),q=Object(n.useCallback)((e=>A.get(e)),[A]),D=Object(n.useCallback)((()=>{O(!1)}),[]);return Object(n.useEffect)((()=>{T({})}),[g]),Object(n.useEffect)((()=>{v&&a.addError(v,{title:S.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.list.apiError",{defaultMessage:"Error while retrieving list of trusted applications"})})}),[a,v]),d.loading||f?i.a.createElement(_.EuiPageTemplate,{template:"centeredContent"},i.a.createElement(_.EuiLoadingSpinner,{className:"essentialAnimation",size:"xl","data-test-subj":t("loading")})):i.a.createElement(i.a.Fragment,null,!e&&i.a.createElement(_.EuiText,{color:"subdued",size:"xs","data-test-subj":"policyDetailsTrustedAppsCount"},M),i.a.createElement(_.EuiSpacer,{size:"m"}),i.a.createElement(qM,{items:g,onPageChange:j,onExpandCollapse:C,cardComponentProps:q,loading:p,error:null==v?void 0:v.message,pagination:b,"data-test-subj":PM}),w&&i.a.createElement(DM,{trustedApps:k,onClose:D}))}));RM.displayName="PolicyTrustedAppsList";const FM=i.a.memo((()=>{const{getAppUrl:e}=Object(m.d)(),t=Object(YC.b)(JC.j),a=Object(YC.b)(JC.o),r=Object(YC.b)(JC.e),s=Object(YC.b)(JC.J),l=Object(YC.a)(),c=Object(YC.b)(JC.c),{isPlatinumPlus:u}=Object(eI.a)(),d=Object(YC.b)(JC.s).totalItemCount,p="list"===t.show,f=Object(n.useMemo)((()=>i.a.createElement(_.EuiButton,{fill:!0,iconType:"plusInCircle","data-test-subj":"assignTrustedAppButton",onClick:()=>l({show:"list"})},S.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.layout.assignToPolicy",{defaultMessage:"Assign trusted applications to policy"}))),[l]),g=Object(n.useMemo)((()=>!r&&!c.loading&&!c.hasTrustedApps),[c.hasTrustedApps,c.loading,r]),b=Object(n.useMemo)((()=>r||c.loading),[c.loading,r]),h=Object(n.useMemo)((()=>{const t=i.a.createElement(_.EuiLink,{href:e({appId:o.l,path:Object(I.m)()}),target:"_blank"},i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.trustedApps.layout.about.viewAllLinkLabel",defaultMessage:"view all trusted applications"}));return i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.trustedApps.layout.about",defaultMessage:"There {count, plural, one {is} other {are}} {count} trusted {count, plural, =1 {application} other {applications}} associated with this policy. Click here to {link}",values:{count:d,link:t}})}),[e,d]);return s?i.a.createElement("div",null,b||g?null:i.a.createElement(i.a.Fragment,null,i.a.createElement(_.EuiPageHeader,{alignItems:"center"},i.a.createElement(_.EuiPageHeaderSection,null,i.a.createElement(_.EuiTitle,{size:"m"},i.a.createElement("h2",null,S.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.layout.title",{defaultMessage:"Assigned trusted applications"}))),i.a.createElement(_.EuiSpacer,{size:"s"}),i.a.createElement(_.EuiText,{size:"xs"},i.a.createElement("p",null,h))),i.a.createElement(_.EuiPageHeaderSection,null,u&&f)),i.a.createElement(_.EuiSpacer,{size:"m"})),i.a.createElement(_.EuiPageContent,{hasBorder:!1,hasShadow:!1,paddingSize:"none",color:"transparent",borderRadius:"none"},g?a?i.a.createElement(tI,{policyId:s.id,policyName:s.name}):i.a.createElement(aI,{policyId:s.id,policyName:s.name}):i.a.createElement(RM,{hideTotalShowingLabel:!0})),u&&p?i.a.createElement(SM,null):null):null}));FM.displayName="PolicyTrustedAppsLayout";var _M=a(749);const NM=i.a.memo((({hostCount:e,onCancel:t,onConfirm:a})=>i.a.createElement(_.EuiConfirmModal,{"data-test-subj":"policyDetailsConfirmModal",title:S.i18n.translate("xpack.securitySolution.endpoint.policy.details.updateConfirm.title",{defaultMessage:"Save and deploy changes"}),onCancel:t,onConfirm:a,confirmButtonText:S.i18n.translate("xpack.securitySolution.endpoint.policy.details.updateConfirm.confirmButtonTitle",{defaultMessage:"Save and deploy changes"}),cancelButtonText:S.i18n.translate("xpack.securitySolution.endpoint.policy.details.updateConfirm.cancelButtonTitle",{defaultMessage:"Cancel"})},e>0&&i.a.createElement(i.a.Fragment,null,i.a.createElement(_.EuiCallOut,{"data-test-subj":"policyDetailsWarningCallout",title:S.i18n.translate("xpack.securitySolution.endpoint.policy.details.updateConfirm.warningTitle",{defaultMessage:"This action will update {hostCount, plural, one {# host} other {# hosts}}",values:{hostCount:e}})},i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.details.updateConfirm.warningMessage",defaultMessage:"Saving these changes will apply updates to all endpoints assigned to this agent policy."})),i.a.createElement(_.EuiSpacer,{size:"xl"})),i.a.createElement("p",null,i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.details.updateConfirm.message",defaultMessage:"This action cannot be undone. Are you sure you wish to continue?"})))));NM.displayName="ConfirmUpdate";const LM=i.a.memo((()=>{var e,t;const a=Object(b.useDispatch)(),{services:{application:{navigateToApp:r}}}=Object(m.j)(),c=Object(m.m)(),{state:p}=Object(l.useLocation)(),f=Object(YC.b)(JC.J),g=Object(YC.b)(JC.a),h=Object(YC.b)(JC.M),y=Object(YC.b)(JC.D),[v,E]=Object(n.useState)(!1),[T,k]=Object(n.useState)(),x=null!==(e=null==f?void 0:f.name)&&void 0!==e?e:"",w=Object(I.g)({name:"endpointList"}),O=null==T?void 0:T.onCancelNavigateTo,j=Object(n.useMemo)((()=>null!=O?O:[o.l,{path:w}]),[w,O]);Object(n.useEffect)((()=>{h&&(h.success?(c.addSuccess({title:S.i18n.translate("xpack.securitySolution.endpoint.policy.details.updateSuccessTitle",{defaultMessage:"Success!"}),text:Object(Vj.toMountPoint)(i.a.createElement("span",{"data-test-subj":"policyDetailsSuccessMessage"},i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.details.updateSuccessMessage",defaultMessage:"Integration {name} has been updated.",values:{name:x}})))}),T&&T.onSaveNavigateTo&&r(...T.onSaveNavigateTo)):c.addDanger({title:S.i18n.translate("xpack.securitySolution.endpoint.policy.details.updateErrorTitle",{defaultMessage:"Failed!"}),text:h.error.message}))}),[r,c,x,h,T]);const C=Object(Bm.a)(...j),M=Object(n.useCallback)((()=>{E(!0)}),[]),A=Object(n.useCallback)((()=>{a({type:"userClickedPolicyDetailsSaveButton"}),E(!1)}),[a]),q=Object(n.useCallback)((()=>{E(!1)}),[]);return Object(n.useEffect)((()=>{!T&&p&&k(p)}),[p,T]),f?i.a.createElement(i.a.Fragment,null,v&&i.a.createElement(NM,{hostCount:null!==(t=null==g?void 0:g.total)&&void 0!==t?t:0,onCancel:q,onConfirm:A}),i.a.createElement(_M.a,null),i.a.createElement(_.EuiSpacer,{size:"xxl"}),i.a.createElement(_.EuiBottomBar,{paddingSize:"s"},i.a.createElement(_.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"s"},i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(_.EuiButtonEmpty,{color:"ghost",onClick:C,"data-test-subj":"policyDetailsCancelButton"},i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.details.cancel",defaultMessage:"Cancel"}))),i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(_.EuiButton,{fill:!0,iconType:"save","data-test-subj":"policyDetailsSaveButton",onClick:M,isLoading:y},i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.details.save",defaultMessage:"Save"})))))):i.a.createElement(d.a,{noTimeline:!0},y?i.a.createElement(_.EuiLoadingSpinner,{size:"xl"}):null,i.a.createElement(u.a,{pageName:s.a.administration}))}));LM.displayName="PolicyFormLayout";const BM=i.a.memo((()=>{const e=Object(l.useHistory)(),t=Object(YC.b)(JC.E),a=Object(YC.b)(JC.F),r=Object(YC.b)(JC.L),s=Object(n.useMemo)((()=>[{id:"settings",name:S.i18n.translate("xpack.securitySolution.endpoint.policy.details.tabs.policyForm",{defaultMessage:"Policy settings"}),content:i.a.createElement(i.a.Fragment,null,i.a.createElement(_.EuiSpacer,null),i.a.createElement(LM,null))},{id:"trustedApps",name:S.i18n.translate("xpack.securitySolution.endpoint.policy.details.tabs.trustedApps",{defaultMessage:"Trusted applications"}),content:i.a.createElement(i.a.Fragment,null,i.a.createElement(_.EuiSpacer,null),i.a.createElement(FM,null))}]),[]),o=Object(n.useMemo)((()=>{let e=s[0];return t?e=s[0]:a&&(e=s[1]),e}),[t,a,s]),c=Object(n.useCallback)((t=>{const a="settings"===t.id?Object(I.j)(r):Object(I.l)(r);e.push(a)}),[e,r]);return i.a.createElement(_.EuiTabbedContent,{tabs:s,selectedTab:o,size:"l",onTabClick:c})}));BM.displayName="PolicyTabs";const zM=L()(_.EuiButtonEmpty).withConfig({displayName:"EuiButtonEmptyStyled",componentId:"sc-mu7mbz-0"})(["margin-bottom:",";.euiIcon{width:",";height:",";}.text{font-size:",";margin-inline-start:",";}"],(({theme:e})=>e.eui.paddingSizes.s),(({theme:e})=>e.eui.euiIconSizes.small),(({theme:e})=>e.eui.euiIconSizes.small),(({theme:e})=>e.eui.euiFontSizeXS),(({theme:e})=>e.eui.paddingSizes.xs)),HM=Object(n.memo)((({backButtonLabel:e,backButtonUrl:t,onBackButtonNavigateTo:a,...n})=>{const r=Object(Bm.a)(...a);return i.a.createElement(zM,F()({"data-test-subj":"backToOrigin"},n,{flush:"left",size:"xs",iconType:"arrowLeft",href:t,onClick:r,textProps:{className:"text"}}),e||i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.list.backButton",defaultMessage:"Back"}))}));HM.displayName="BackToExternalAppButton";const UM=i.a.memo((()=>{var e,t,a,r,s,c;const u=Object(fe.a)("trustedAppsByPolicyEnabled"),{state:d={}}=Object(l.useLocation)(),{getAppUrl:p}=Object(m.d)(),f=Object(YC.b)(JC.b),g=Object(YC.b)(JC.J),b=Object(YC.b)(JC.a),h=null!==(e=null==g?void 0:g.name)&&void 0!==e?e:"",y=null!==(t=null==g?void 0:g.description)&&void 0!==t?t:void 0,v=Object(n.useMemo)((()=>{if(null!=d&&d.backLink)return{onBackButtonNavigateTo:d.backLink.navigateTo,backButtonLabel:d.backLink.label,backButtonUrl:d.backLink.href};const e=Object(I.g)({name:"endpointList"});return{backButtonLabel:S.i18n.translate("xpack.securitySolution.endpoint.policy.details.backToListTitle",{defaultMessage:"Back to endpoint hosts"}),backButtonUrl:p({path:e}),onBackButtonNavigateTo:[o.l,{path:e}]}}),[p,null==d?void 0:d.backLink]),E=i.a.createElement(XC,{total:null!==(a=null==b?void 0:b.total)&&void 0!==a?a:0,online:null!==(r=null==b?void 0:b.online)&&void 0!==r?r:0,offline:null!==(s=null==b?void 0:b.offline)&&void 0!==s?s:0,error:null!==(c=null==b?void 0:b.error)&&void 0!==c?c:0}),T=i.a.createElement(HM,F()({},v,{"data-test-subj":"policyDetailsBackLink"})),k=Object(n.useMemo)((()=>f?i.a.createElement(_.EuiPageTemplate,{template:"centeredContent"},i.a.createElement(_.EuiCallOut,{color:"danger",title:null==f?void 0:f.error},i.a.createElement("span",{"data-test-subj":"policyDetailsIdNotFoundMessage"},null==f?void 0:f.message))):g?u?i.a.createElement(BM,null):i.a.createElement(LM,null):i.a.createElement(_.EuiPageTemplate,{template:"centeredContent"},i.a.createElement(_.EuiLoadingSpinner,{className:"essentialAnimation",size:"xl","data-test-subj":"policyDetailsLoading"}))),[u,f,g]);return i.a.createElement(Qj,{"data-test-subj":"policyDetailsPage",title:h,subtitle:y,headerBackComponent:T,actions:f?void 0:E,restrictWidth:!0,hasBottomBorder:!u},k)}));UM.displayName="PolicyDetails";a(539);const $M=Object(n.memo)((()=>i.a.createElement(l.Switch,null,i.a.createElement(l.Route,{path:[FO.i,FO.k],exact:!0,component:UM}),i.a.createElement(l.Route,{path:FO.j,exact:!0,render:e=>i.a.createElement(l.Redirect,{to:Object(I.j)(e.match.params.policyId)})}),i.a.createElement(l.Route,{path:"*",component:ue.a}))));$M.displayName="PolicyContainer";var QM=a(254);function VM(e){return Object(b.useSelector)((t=>e(t[FO.o][FO.r])))}function WM(e){const t=VM(QM.k),a=Object(l.useHistory)();return Object(n.useCallback)(((...n)=>a.push(Object(I.m)({...t,...e(...n)}))),[a,t])}const GM=[32,40,64],KM=/[^0-9a-f]/i,YM=({os:e,value:t})=>{if(e===ij.f.WINDOWS){return/^[a-z]:(?:|\\\\[^<>:"'/\\|?*]+\\[^<>:"'/\\|?*]+|%\w+%|)[\\](?:[^<>:"'/\\|?*]+[\\/])*([^<>:"'/\\|?*])+$/i.test(t)}return/^(\/|(\/[\w\-]+)+|\/[\w\-]+\.[\w]+|(\/[\w-]+)+\/[\w\-]+\.[\w]+)$/i.test(t)},JM=e=>{const t=e[0],a=e.slice(-1),n=e.trim(),i=/\//.test(n);return 0!==e.length&&!(i||n.length!==e.length||"^"===t||"\\"===a||!ZM({path:e,isWindowsPath:!0}))},XM=e=>{const t=e[0],a=e.slice(-1),n=e.trim();return 0!==e.length&&!(n.length!==e.length||"/"!==t||"/"===a||e.length>1024==!0||!0===e.includes("//")||!ZM({path:e,isWindowsPath:!1}))},ZM=({path:e,isWindowsPath:t})=>{for(const a of e.split(t?"\\":"/"))if(!0===/[\*|\?]+/.test(a))return!0;return!1};var eA=a(308),tA=a(343),aA=a(299);const nA=S.i18n.translate("xpack.securitySolution.trustedapps.aboutInfo",{defaultMessage:"Add a trusted application to improve performance or alleviate conflicts with other applications running on your hosts."}),iA={[ij.b.HASH]:S.i18n.translate("xpack.securitySolution.trustedapps.logicalConditionBuilder.entry.field.hash",{defaultMessage:"Hash"}),[ij.b.PATH]:S.i18n.translate("xpack.securitySolution.trustedapps.logicalConditionBuilder.entry.field.path",{defaultMessage:"Path"}),[ij.b.SIGNER]:S.i18n.translate("xpack.securitySolution.trustedapps.logicalConditionBuilder.entry.field.signature",{defaultMessage:"Signature"})},rA={[ij.b.HASH]:S.i18n.translate("xpack.securitySolution.trustedapps.logicalConditionBuilder.entry.field.description.hash",{defaultMessage:"md5, sha1, or sha256"}),[ij.b.PATH]:S.i18n.translate("xpack.securitySolution.trustedapps.logicalConditionBuilder.entry.field.description.path",{defaultMessage:"The full path of the application"}),[ij.b.SIGNER]:S.i18n.translate("xpack.securitySolution.trustedapps.logicalConditionBuilder.entry.field.description.signature",{defaultMessage:"The signer of the application"})},sA={is:S.i18n.translate("xpack.securitySolution.trustedapps.card.operator.is",{defaultMessage:"is"}),matches:S.i18n.translate("xpack.securitySolution.trustedapps.card.operator.matches",{defaultMessage:"matches"})},oA={field:S.i18n.translate("xpack.securitySolution.trustedapps.trustedapp.entry.field",{defaultMessage:"Field"}),operator:S.i18n.translate("xpack.securitySolution.trustedapps.trustedapp.entry.operator",{defaultMessage:"Operator"}),value:S.i18n.translate("xpack.securitySolution.trustedapps.trustedapp.entry.value",{defaultMessage:"Value"})},lA=(S.i18n.translate("xpack.securitySolution.trustedapps.view.toggle.grid",{defaultMessage:"Grid view"}),S.i18n.translate("xpack.securitySolution.trustedapps.view.toggle.list",{defaultMessage:"List view"}),{[`duplicatedEntry.${ij.b.HASH}`]:S.i18n.translate("xpack.securitySolution.trustedapps.logicalConditionBuilder.entry.field.error.duplicated.hash",{defaultMessage:"Hash value can only be used once. Please enter a single valid hash."}),[`duplicatedEntry.${ij.b.PATH}`]:S.i18n.translate("xpack.securitySolution.trustedapps.logicalConditionBuilder.entry.field.error.duplicated.path",{defaultMessage:"Path value can only be used once. Please enter a single valid path."}),[`duplicatedEntry.${ij.b.SIGNER}`]:S.i18n.translate("xpack.securitySolution.trustedapps.logicalConditionBuilder.entry.field.error.duplicated.signature",{defaultMessage:"Signature value can only be used once. Please enter a single valid signature."}),[`invalidField.${ij.b.HASH}`]:S.i18n.translate("xpack.securitySolution.trustedapps.logicalConditionBuilder.entry.field.error.invalid.hash",{defaultMessage:"An invalid Hash was entered. Please enter in a valid Hash (md5, sha1, or sha256)."}),[`invalidField.${ij.b.PATH}`]:S.i18n.translate("xpack.securitySolution.trustedapps.logicalConditionBuilder.entry.field.error.invalid.path",{defaultMessage:"An invalid Path was entered. Please enter in a valid Path."}),[`invalidField.${ij.b.SIGNER}`]:S.i18n.translate("xpack.securitySolution.trustedapps.logicalConditionBuilder.entry.field.error.invalid.signature",{defaultMessage:"An invalid Signature was entered. Please enter in a valid Signature."})}),cA=S.i18n.translate("xpack.securitySolution.trustedapps.list.search.placeholder",{defaultMessage:"Search on the fields below: name, description, value"}),uA=({os:e,field:t,type:a})=>{if(t===ij.b.PATH)return e===ij.f.WINDOWS?"wildcard"===a?"C:\\sample\\*\\path.exe":"C:\\sample\\path.exe":"wildcard"===a?"/opt/*/app":"/opt/bin"},dA=Object(n.memo)((({showLabel:e,label:t="",children:a})=>e?i.a.createElement(_.EuiFormRow,{label:t,fullWidth:!0},a):i.a.createElement(i.a.Fragment,null,a)));dA.displayName="ConditionEntryCell";const pA=L.a.div.withConfig({displayName:"InputGroup",componentId:"sc-1yk4mi3-0"})(["display:grid;grid-template-columns:25% 25% 45% 5%;grid-template-areas:'field operator value remove';"]),mA=L.a.div.withConfig({displayName:"InputItem",componentId:"sc-1yk4mi3-1"})(["grid-area:",";align-self:center;margin:4px;vertical-align:baseline;"],(({gridArea:e})=>e)),fA=Object.keys(ij.g).map((e=>({dropdownDisplay:sA[e],inputDisplay:sA[e],value:"matches"===e?"wildcard":"match"}))),gA=Object(n.memo)((({os:e,entry:t,showLabels:a=!1,onRemove:r,onChange:s,isRemoveDisabled:o=!1,onVisited:l,"data-test-subj":c})=>{const u=Object(HO.a)(c),[d,p]=Object(n.useState)(!1),m=Object(n.useMemo)((()=>{const t=e=>i.a.createElement(i.a.Fragment,null,iA[e],i.a.createElement(_.EuiText,{size:"xs",color:"subdued"},rA[e]));return[{dropdownDisplay:t(ij.b.HASH),inputDisplay:iA[ij.b.HASH],value:ij.b.HASH},{dropdownDisplay:t(ij.b.PATH),inputDisplay:iA[ij.b.PATH],value:ij.b.PATH},...e===ij.f.WINDOWS?[{dropdownDisplay:t(ij.b.SIGNER),inputDisplay:iA[ij.b.SIGNER],value:ij.b.SIGNER}]:[]]}),[e]),f=Object(n.useCallback)((e=>s({...t,value:e.target.value},t)),[t,s]),g=Object(n.useCallback)((e=>s({...t,field:e},t)),[t,s]),b=Object(n.useCallback)((e=>s({...t,type:e},t)),[t,s]),h=Object(n.useCallback)((()=>r(t)),[t,r]),y=Object(n.useCallback)((()=>{l&&l(t),d||p(!0)}),[t,l,d]);return i.a.createElement(pA,{"data-test-subj":c},i.a.createElement(mA,{gridArea:"field"},i.a.createElement(dA,{showLabel:a,label:oA.field},i.a.createElement(_.EuiSuperSelect,{options:m,valueOfSelected:t.field,onChange:g,"data-test-subj":u("field")}))),i.a.createElement(mA,{gridArea:"operator"},i.a.createElement(dA,{showLabel:a,label:oA.operator},t.field===ij.b.PATH?i.a.createElement(_.EuiSuperSelect,{options:fA,onChange:b,valueOfSelected:t.type,"data-test-subj":u("operator")}):i.a.createElement(_.EuiFieldText,{name:"operator",value:sA.is,"data-test-subj":u("operator"),readOnly:!0}))),i.a.createElement(mA,{gridArea:"value"},i.a.createElement(dA,{showLabel:a,label:oA.value},i.a.createElement(_.EuiFieldText,{name:"value",value:t.value,placeholder:uA({os:e,field:t.field,type:t.type}),fullWidth:!0,required:d,onChange:f,onBlur:y,"data-test-subj":u("value")}))),i.a.createElement(mA,{gridArea:"remove"},i.a.createElement(dA,{showLabel:a,label:" "},i.a.createElement(_.EuiButtonIcon,{color:"danger",iconType:"trash",onClick:h,isDisabled:o,"aria-label":S.i18n.translate("xpack.securitySolution.trustedapps.logicalConditionBuilder.entry.removeLabel",{defaultMessage:"Remove Entry"}),"data-test-subj":u("remove")}))))}));gA.displayName="ConditionEntryInput";const bA=L()(_.EuiFlexGroup).withConfig({displayName:"ConditionGroupFlexGroup",componentId:"sc-7xprc5-0"})([".and-badge{padding-top:20px;padding-bottom:",";}.group-entries{margin-bottom:",";& > *{margin-bottom:",";&:last-child{margin-bottom:0;}}}.and-button{min-width:95px;}"],(({theme:e})=>`calc(${e.eui.euiButtonHeightSmall} + (${e.eui.paddingSizes.s} * 2) + 3px);`),(({theme:e})=>e.eui.paddingSizes.s),(({theme:e})=>e.eui.paddingSizes.s)),hA=Object(n.memo)((({os:e,entries:t,onEntryRemove:a,onEntryChange:n,onAndClicked:r,isAndDisabled:s,onVisited:o,"data-test-subj":l})=>{const c=Object(HO.a)(l);return i.a.createElement(bA,{gutterSize:"xs","data-test-subj":l},t.length>1&&i.a.createElement(_.EuiHideFor,{sizes:["xs","s"]},i.a.createElement(_.EuiFlexItem,{grow:!1,"data-test-subj":c("andConnector"),className:"and-badge"},i.a.createElement(CT.a,{type:"and",includeAntennas:!0}))),i.a.createElement(_.EuiFlexItem,{grow:1},i.a.createElement("div",{"data-test-subj":c("entries"),className:"group-entries"},t.map(((r,s)=>i.a.createElement(gA,{key:s,os:e,entry:r,showLabels:0===s,isRemoveDisabled:0===s&&t.length<=1,onRemove:a,onChange:n,onVisited:o,"data-test-subj":c(`entry${s}`)})))),i.a.createElement("div",null,i.a.createElement(_.EuiSpacer,{size:"s"}),i.a.createElement(_.EuiButton,{size:"s",iconType:"plusInCircle",onClick:r,"data-test-subj":c("AndButton"),isDisabled:s,className:"and-button"},i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.trustedapps.logicalConditionBuilder.group.andOperator",defaultMessage:"AND"})))))}));hA.displayName="ConditionGroup";const yA=Object(n.memo)((({entries:e,os:t,className:a,isAndDisabled:n=!1,onAndClicked:r,onEntryRemove:s,onEntryChange:o,onVisited:l,"data-test-subj":c})=>{const u=Object(HO.a)(c);return i.a.createElement("div",{"data-test-subj":c,className:a},i.a.createElement("div",null,0===e.length?i.a.createElement(vA,null):i.a.createElement(hA,{os:t,entries:e,onEntryRemove:s,onEntryChange:o,onAndClicked:r,isAndDisabled:n,onVisited:l,"data-test-subj":u("group1")})))}));yA.displayName="LogicalConditionBuilder";const vA=Object(n.memo)((()=>i.a.createElement(_.EuiPanel,{paddingSize:"l"},i.a.createElement(_.EuiText,{textAlign:"center",size:"s",color:"subdued"},i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.trustedapps.logicalConditionBuilder.noEntries",defaultMessage:"No conditions defined"})))));vA.displayName="NoEntries";const EA=()=>{},TA={bordered:!0,showIcons:!1},kA=L.a.div.withConfig({displayName:"EffectivePolicyFormContainer",componentId:"sc-1o447y1-0"})([".policy-name .euiSelectableListItem__text{text-decoration:none !important;color:"," !important;}"],(e=>e.theme.eui.euiTextColor)),xA=Object(n.memo)((({isGlobal:e,isPlatinumPlus:t,onChange:a,listProps:r,options:s,selected:o=[],"data-test-subj":l,...c})=>{const{getAppUrl:u}=Object(nb.b)(),d=Object(HO.a)(l),p=Object(n.useMemo)((()=>[{id:"globalPolicy",label:S.i18n.translate("xpack.securitySolution.endpoint.trustedAppsByPolicy.global",{defaultMessage:"Global"}),iconType:e?"checkInCircleFilled":"","data-test-subj":d("global")},{id:"perPolicy",label:S.i18n.translate("xpack.securitySolution.endpoint.trustedAppsByPolicy.perPolicy",{defaultMessage:"Per Policy"}),iconType:e?"":"checkInCircleFilled","data-test-subj":d("perPolicy")}]),[d,e]),m=Object(n.useMemo)((()=>{const a=new Set(o.map((e=>e.id)));return s.map((n=>({label:n.name,className:"policy-name",prepend:i.a.createElement(_.EuiCheckbox,{id:Object(_.htmlIdGenerator)()(),onChange:EA,checked:a.has(n.id),disabled:e||!t,"data-test-subj":`policy-${n.id}-checkbox`}),append:i.a.createElement(Wj.a,{href:u({path:Object(I.j)(n.id)}),appPath:Object(I.j)(n.id),target:"_blank"},i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.effectedPolicySelect.viewPolicyLinkLabel",defaultMessage:"View policy"})),policy:n,checked:a.has(n.id)?"on":void 0,disabled:e||!t,"data-test-subj":`policy-${n.id}`}))).sort((({label:e},{label:t})=>e.localeCompare(t)))}),[u,e,t,s,o]),f=Object(n.useCallback)((t=>{a({isGlobal:e,selected:t.filter((e=>e.checked)).map((e=>e.policy))})}),[e,a]),g=Object(n.useCallback)((e=>{a({isGlobal:"globalPolicy"===e,selected:o})}),[a,o]),b=Object(n.useCallback)(((e,t)=>i.a.createElement(i.a.Fragment,null,t,e)),[]);return i.a.createElement(kA,null,i.a.createElement(_.EuiText,{size:"xs"},i.a.createElement("h3",null,i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.trustedapps.policySelect.assignmentSectionTitle",defaultMessage:"Assignment"}))),i.a.createElement(_.EuiSpacer,{size:"xs"}),i.a.createElement(_.EuiFlexGroup,null,i.a.createElement(_.EuiFlexItem,{grow:2},i.a.createElement(_.EuiText,{size:"s"},i.a.createElement("p",null,S.i18n.translate("xpack.securitySolution.trustedApps.assignmentSectionDescription",{defaultMessage:"Assign this trusted application globally across all policies, or assign it to specific policies."})))),i.a.createElement(_.EuiFlexItem,{grow:1},i.a.createElement(_.EuiFormRow,{fullWidth:!0},i.a.createElement(_.EuiButtonGroup,{legend:"Global Policy Toggle",options:p,idSelected:e?"globalPolicy":"perPolicy",onChange:g,color:"primary",isFullWidth:!0})))),i.a.createElement(_.EuiSpacer,null),!e&&i.a.createElement(_.EuiFormRow,{fullWidth:!0},i.a.createElement(_.EuiSelectable,F()({},c,{options:m,listProps:r||TA,onChange:f,searchable:!0,"data-test-subj":d("policiesSelectable")}),b)))}));xA.displayName="EffectedPolicySelect";var SA=a(16);const wA=[ij.f.MAC,ij.f.WINDOWS,ij.f.LINUX],OA=(e,t,a,n)=>{e.result[t]||(e.result[t]={isInvalid:!1,errors:[],warnings:[]});const r="warnings"===a?i.a.createElement("div",null,n):n;e.result[t][a].push(r),e.result[t].isInvalid=!0},jA=e=>{let t=!0;const a={isValid:t,result:{}};return e.name.trim()||(t=!1,OA(a,"name","errors",S.i18n.translate("xpack.securitySolution.trustedapps.create.nameRequiredMsg",{defaultMessage:"Name is required"}))),e.os||(t=!1,OA(a,"os","errors",S.i18n.translate("xpack.securitySolution.trustedapps.create.osRequiredMsg",{defaultMessage:"Operating System is required"}))),e.entries.length?e.entries.forEach(((n,i)=>{const r=(({os:e,field:t,type:a,value:n})=>t!==ij.b.PATH||("wildcard"===a?e===ij.f.WINDOWS?JM(n):XM(n):YM({value:n,os:e})))({os:e.os,field:n.field,type:n.type,value:n.value});var s;n.field&&n.value.trim()?n.field===ij.b.HASH&&(s=n.value,!GM.includes(s.length)||KM.test(s))?(t=!1,OA(a,"entries","errors",S.i18n.translate("xpack.securitySolution.trustedapps.create.conditionFieldInvalidHashMsg",{defaultMessage:"[{row}] Invalid hash value",values:{row:i+1}}))):r?r&&!(({os:e,type:t,value:a})=>{if("wildcard"!==t)return!0;const n=e===ij.f.WINDOWS?"\\":"/",i=a.split(n).pop();return!!i&&1===(i.split("*").length||i.split("?").length)})({os:e.os,value:n.value,type:n.type})&&OA(a,"entries","warnings",S.i18n.translate("xpack.securitySolution.trustedapps.create.conditionFieldDegradedPerformanceMsg",{defaultMessage:"[{row}] A wildcard in the filename will affect the endpoint's performance",values:{row:i+1}})):OA(a,"entries","warnings",S.i18n.translate("xpack.securitySolution.trustedapps.create.conditionFieldInvalidPathMsg",{defaultMessage:"[{row}] Path may be formed incorrectly; verify value",values:{row:i+1}})):(t=!1,OA(a,"entries","errors",S.i18n.translate("xpack.securitySolution.trustedapps.create.conditionFieldValueRequiredMsg",{defaultMessage:"[{row}] Field entry must have a value",values:{row:i+1}})))})):(t=!1,OA(a,"entries","errors",S.i18n.translate("xpack.securitySolution.trustedapps.create.conditionRequiredMsg",{defaultMessage:"At least one Field definition is required"}))),a.isValid=t,a},CA=Object(n.memo)((({fullWidth:e,isEditMode:t,isDirty:a,wasByPolicy:r,onChange:s,trustedApp:o,policies:l={options:[]},...c})=>{var u,d,p,m,f,g,b;const h=o,y=c["data-test-subj"],v=Object(fe.a)("trustedAppsByPolicyEnabled"),E=Object(SA.b)().isPlatinumPlus(),T=Object(n.useMemo)((()=>Object(eA.a)(h.effectScope)),[h]),k=Object(n.useMemo)((()=>E||t&&(!T||r&&T&&a)),[t,T,a,E,r]),x=Object(n.useMemo)((()=>wA.map((e=>({value:e,inputDisplay:aA.c[e]})))),[]),[w,O]=Object(n.useState)({isGlobal:T,selected:[]}),[j,C]=Object(n.useState)((()=>jA(h))),[I,M]=Object(n.useState)({}),A=Object(HO.a)(y),q=Object(n.useCallback)((e=>{const t=jA(e);C(t),s({item:e,isValid:t.isValid})}),[s]),D=Object(n.useCallback)((()=>{h.os===ij.f.WINDOWS?q({...h,entries:[...h.entries,Object(tA.a)()].filter(eA.d)}):q({...h,entries:[...h.entries.filter(eA.b),Object(tA.a)()]})}),[q,h]),P=Object(n.useCallback)((({target:{name:e,value:t}})=>{q({...h,[e]:t})}),[q,h]),R=Object(n.useCallback)((({target:{name:e}})=>{M((t=>({...t,[e]:!0})))}),[]),N=Object(n.useCallback)((e=>{M((e=>({...e,os:!0})));const t={...h,entries:[],os:e};t.os!==ij.f.WINDOWS?(t.entries.push(...h.entries.filter((e=>Object(eA.b)(e)))),0===t.entries.length&&t.entries.push(Object(tA.a)())):t.entries.push(...h.entries),q(t)}),[q,h]),L=Object(n.useCallback)((e=>{q({...h,entries:h.entries.filter((t=>t!==e))})}),[q,h]),B=Object(n.useCallback)(((e,t)=>{h.os,ij.f.WINDOWS,q({...h,entries:h.entries.map((a=>a===t?e:a))})}),[q,h]),z=Object(n.useCallback)((()=>{M((e=>({...e,entries:!0})))}),[]),H=Object(n.useCallback)((e=>{let t;O((()=>e)),t=e.isGlobal?{type:"global"}:{type:"policy",policies:e.selected.map((e=>e.id))},q({...h,effectScope:t})}),[q,h]);return Object(n.useEffect)((()=>{C((e=>{const t=jA(h);return t.isValid!==e.isValid&&q(h),t}))}),[q,h]),Object(n.useEffect)((()=>{O((e=>{if(Object(eA.c)(h.effectScope)&&l.options.length>0){const t=[];for(const a of h.effectScope.policies)if(!e.selected.find((e=>e.id===a))){const e=l.options.find((e=>e.id===a));e&&t.push(e)}if(t.length)return{...e,selected:[...e.selected,...t]}}return e}))}),[l.options,h.effectScope]),i.a.createElement(_.EuiForm,F()({},c,{component:"div"}),i.a.createElement(_.EuiFormRow,{label:S.i18n.translate("xpack.securitySolution.trustedapps.create.name",{defaultMessage:"Name your trusted application"}),fullWidth:e,"data-test-subj":A("nameRow"),isInvalid:(null==I?void 0:I.name)&&(null===(u=j.result.name)||void 0===u?void 0:u.isInvalid),error:null===(d=j.result.name)||void 0===d?void 0:d.errors},i.a.createElement(_.EuiFieldText,{name:"name",value:h.name,onChange:P,onBlur:R,fullWidth:!0,required:null==I?void 0:I.name,maxLength:256,"data-test-subj":A("nameTextField")})),i.a.createElement(_.EuiFormRow,{label:S.i18n.translate("xpack.securitySolution.trustedapps.create.description",{defaultMessage:"Description"}),fullWidth:e,"data-test-subj":A("descriptionRow")},i.a.createElement(_.EuiTextArea,{name:"description",value:h.description,onChange:P,fullWidth:!0,compressed:v,maxLength:256,"data-test-subj":A("descriptionField")})),i.a.createElement(_.EuiHorizontalRule,null),i.a.createElement(_.EuiText,{size:"xs"},i.a.createElement("h3",null,S.i18n.translate("xpack.securitySolution.trustedApps.conditionsSectionTitle",{defaultMessage:"Conditions"}))),i.a.createElement(_.EuiSpacer,{size:"xs"}),i.a.createElement(_.EuiText,{size:"s"},i.a.createElement("p",null,S.i18n.translate("xpack.securitySolution.trustedApps.conditionsSectionDescription",{defaultMessage:"Select an operating system and add conditions. Availability of conditions may depend on your chosen OS."}))),i.a.createElement(_.EuiSpacer,{size:"m"}),i.a.createElement(_.EuiFormRow,{label:S.i18n.translate("xpack.securitySolution.trustedapps.create.os",{defaultMessage:"Select operating system"}),fullWidth:e,"data-test-subj":A("OsRow"),isInvalid:(null==I?void 0:I.os)&&(null===(p=j.result.os)||void 0===p?void 0:p.isInvalid),error:null===(m=j.result.os)||void 0===m?void 0:m.errors},i.a.createElement(_.EuiSuperSelect,{name:"os",options:x,valueOfSelected:h.os,onChange:N,fullWidth:!0,"data-test-subj":A("osSelectField")})),i.a.createElement(_.EuiFormRow,{fullWidth:e,"data-test-subj":A("conditionsRow"),isInvalid:(null==I?void 0:I.entries)&&(null===(f=j.result.entries)||void 0===f?void 0:f.isInvalid),error:null===(g=j.result.entries)||void 0===g?void 0:g.errors,helpText:null===(b=j.result.entries)||void 0===b?void 0:b.warnings},i.a.createElement(yA,{entries:h.entries,os:h.os,onAndClicked:D,onEntryRemove:L,onEntryChange:B,onVisited:z,"data-test-subj":A("conditionsBuilder")})),v&&k?i.a.createElement(i.a.Fragment,null,i.a.createElement(_.EuiHorizontalRule,null),i.a.createElement(_.EuiFormRow,{fullWidth:e,"data-test-subj":A("policySelection")},i.a.createElement(xA,{isGlobal:T,isPlatinumPlus:E,selected:w.selected,options:l.options,onChange:H,isLoading:null==l?void 0:l.isLoading,"data-test-subj":A("effectedPolicies")}))):null)}));CA.displayName="NewTrustedAppForm";const IA=Object(n.memo)((({onClose:e,...t})=>{const a=Object(b.useDispatch)(),r=Object(l.useHistory)(),s=Object(m.m)(),o=VM(QM.C),c=VM(QM.i),u=VM(QM.D),d=VM(QM.A),p=VM(QM.M),f=VM(QM.L),g=VM(QM.H),h=VM(QM.d),y=VM(QM.h)||Object(tA.b)(),v=VM(QM.k),E=Object(SA.b)().isPlatinumPlus(),T=Object(m.j)().services.docLinks,[k,x]=Object(n.useState)(!1),w=t["data-test-subj"],O=Object(n.useMemo)((()=>({options:f,isLoading:p})),[p,f]),j=Object(n.useMemo)((()=>{let e=c?lA[c.message.replace(/(\[(.*)\]\: )/,"")]||c.message:void 0;return c&&c.attributes&&"TrustedApps/PolicyNotFound"===c.attributes.type?O.options.forEach((t=>{var a;e=null===(a=e)||void 0===a?void 0:a.replace(t.id,t.name)})):c&&c.attributes&&"EndpointLicenseError"===c.attributes.type&&(e=S.i18n.translate("xpack.securitySolution.trustedapps.createTrustedAppFlyout.byPolicyLicenseError",{defaultMessage:"Your Kibana license has been downgraded. As such, individual policy configuration is no longer supported."})),e}),[c,O]),C=Object(HO.a)(w),M=Object(n.useCallback)((()=>{o||e()}),[e,o]),A=Object(n.useCallback)((()=>a({type:"trustedAppCreationDialogConfirmed"})),[a]),q=Object(n.useCallback)((e=>{a({type:"trustedAppCreationDialogFormStateUpdated",payload:{entry:e.item,isValid:e.isValid}}),!1===cf.a.isEqual(y,e.item)&&x(!0)}),[a,y]),D=Object(fe.a)("trustedAppsByPolicyEnabled"),[P,R]=Object(n.useState)(!Object(eA.a)(y.effectScope));Object(n.useEffect)((()=>{!k&&y.effectScope&&R(!Object(eA.a)(y.effectScope))}),[k,y.effectScope]);const N=Object(n.useMemo)((()=>Object(eA.a)(y.effectScope)),[y]),L=Object(n.useMemo)((()=>D&&!E&&g&&P&&(!N||k)),[D,E,g,N,k,P]);return Object(n.useEffect)((()=>{h&&(r.replace(Object(I.m)({...v,show:void 0,id:void 0})),s.addWarning(S.i18n.translate("xpack.securitySolution.trustedapps.createTrustedAppFlyout.notFoundToastMessage",{defaultMessage:"Unable to edit trusted application ({apiMsg})",values:{apiMsg:h.message}})))}),[r,v,s,h]),Object(n.useEffect)((()=>{u&&e()}),[e,u]),i.a.createElement(_.EuiFlyout,F()({onClose:M},t,{hideCloseButton:o}),i.a.createElement(_.EuiFlyoutHeader,{hasBorder:!0},i.a.createElement(_.EuiTitle,{size:"m"},i.a.createElement("h2",{"data-test-subj":C("headerTitle")},g?i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.trustedapps.createTrustedAppFlyout.editTitle",defaultMessage:"Edit trusted application"}):i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.trustedapps.createTrustedAppFlyout.createTitle",defaultMessage:"Add trusted application"})))),L&&i.a.createElement(_.EuiCallOut,{title:S.i18n.translate("xpack.securitySolution.trustedapps.createTrustedAppFlyout.expiredLicenseTitle",{defaultMessage:"Expired License"}),color:"warning",iconType:"help","data-test-subj":C("expired-license-callout")},i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.trustedapps.createTrustedAppFlyout.expiredLicenseMessage",defaultMessage:"Your Kibana license has been downgraded. Future policy configurations will now be globally assigned to all policies. For more information, see our "}),i.a.createElement(_.EuiLink,{target:"_blank",href:`${T.links.securitySolution.trustedApps}`},i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.trustedapps.docsLink",defaultMessage:"Trusted applications documentation."}))),i.a.createElement(_.EuiFlyoutBody,null,i.a.createElement(_.EuiText,{size:"xs"},i.a.createElement("h3",null,S.i18n.translate("xpack.securitySolution.trustedApps.detailsSectionTitle",{defaultMessage:"Details"}))),i.a.createElement(_.EuiSpacer,{size:"xs"}),!g&&i.a.createElement(i.a.Fragment,null,i.a.createElement(_.EuiText,{size:"s"},i.a.createElement("p",{"data-test-subj":C("about")},nA)),i.a.createElement(_.EuiSpacer,{size:"m"})),i.a.createElement(CA,{fullWidth:!0,onChange:q,isInvalid:!!c,isEditMode:g,isDirty:k,wasByPolicy:P,error:j,policies:O,trustedApp:y,"data-test-subj":C("createForm")})),i.a.createElement(_.EuiFlyoutFooter,null,i.a.createElement(_.EuiFlexGroup,{justifyContent:"spaceBetween"},i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(_.EuiButtonEmpty,{onClick:M,flush:"left",isDisabled:o,"data-test-subj":C("cancelButton")},i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.trustedapps.createTrustedAppFlyout.cancelButton",defaultMessage:"Cancel"}))),i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(_.EuiButton,{onClick:A,fill:!0,isDisabled:!d||o,isLoading:o,"data-test-subj":C("createButton")},g?i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.trustedapps.createTrustedAppFlyout.editSaveButton",defaultMessage:"Save"}):i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.trustedapps.createTrustedAppFlyout.createSaveButton",defaultMessage:"Add trusted application"}))))))}));IA.displayName="NewTrustedAppFlyout";const MA=L.a.div.withConfig({displayName:"RootWrapper",componentId:"sc-mn57ec-0"})([".trusted-app + .trusted-app{margin-top:",";}"],(({theme:e})=>e.eui.spacerSizes.l)),AA=S.i18n.translate("xpack.securitySolution.trustedapps.grid.policyDetailsLinkBackLabel",{defaultMessage:"Back to trusted applications"}),qA=S.i18n.translate("xpack.securitySolution.trustedapps.grid.cardAction.edit",{defaultMessage:"Edit trusted application"}),DA=S.i18n.translate("xpack.securitySolution.trustedapps.grid.cardAction.delete",{defaultMessage:"Delete trusted application"}),PA=Object(n.memo)((()=>{const e=Object(l.useHistory)(),t=Object(b.useDispatch)(),{getAppUrl:a}=Object(m.d)(),r=VM(QM.w),s=VM(QM.v),c=VM(QM.J),u=VM(QM.u),d=VM(QM.k),p=VM(QM.z),f=VM(QM.K),g=WM((({pageIndex:e,pageSize:t})=>({page_index:e,page_size:t}))),h=Object(n.useMemo)((()=>{const n={};for(const i of s){let r;"policy"===i.effectScope.type&&i.effectScope.policies.length&&(r=i.effectScope.policies.reduce(((e,t)=>{var n,i;const r=Object(I.m)({...d}),s=Object(I.j)(t),l={backLink:{label:AA,navigateTo:[o.l,{path:r}],href:a({path:r})},onCancelNavigateTo:[o.l,{path:r}]};return e[t]={navigateOptions:{path:s,state:l},href:a({path:s}),children:null!==(n=null===(i=p[t])||void 0===i?void 0:i.name)&&void 0!==n?n:t,target:"_blank"},e}),{})),n[i.id]={item:i,policies:r,loadingPoliciesList:f,hideComments:!0,"data-test-subj":"trustedAppCard",actions:[{icon:"controlsHorizontal",onClick:()=>{e.push(Object(I.m)({...d,show:"edit",id:i.id}))},"data-test-subj":"editTrustedAppAction",children:qA},{icon:"trash",onClick:()=>{t({type:"trustedAppDeletionDialogStarted",payload:{entry:i}})},"data-test-subj":"deleteTrustedAppAction",children:DA}]}}return n}),[t,a,e,s,d,p,f]),y=Object(n.useCallback)((e=>h[e.id]),[h]);return i.a.createElement(MA,null,i.a.createElement(CM,{items:s,onChange:g,ItemComponent:cM,itemComponentProps:y,loading:c,itemId:"id",error:u,pagination:r}))}));PA.displayName="TrustedAppsGrid";const RA=Object(n.memo)((e=>{const t=Object(n.useRef)(null),a=i.a.createElement(_.EuiButton,F()({buttonRef:t},e));return Object(n.useEffect)((()=>{t.current&&t.current.focus()}),[]),a}));RA.displayName="AutoFocusButton";const FA=Object(n.memo)((()=>{const e=Object(b.useDispatch)(),t=VM(QM.F),a=VM(QM.q),r=Object(n.useMemo)((()=>(e=>({title:i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.trustedapps.deletionDialog.title",defaultMessage:'Delete "{name}"',values:{name:i.a.createElement("b",{className:"eui-textBreakWord"},null==e?void 0:e.name)}}),calloutTitle:i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.trustedapps.deletionDialog.calloutTitle",defaultMessage:"Warning"}),calloutMessage:i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.trustedapps.deletionDialog.calloutMessage",defaultMessage:"Deleting this entry will remove it from {count} associated {count, plural, one {policy} other {policies}}.",values:{count:e&&Object(eA.c)(e.effectScope)?e.effectScope.policies.length:"all"}}),subMessage:i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.trustedapps.deletionDialog.subMessage",defaultMessage:"This action cannot be undone. Are you sure you wish to continue?"}),cancelButton:i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.trustedapps.deletionDialog.cancelButton",defaultMessage:"Cancel"}),confirmButton:i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.trustedapps.deletionDialog.confirmButton",defaultMessage:"Delete"})}))(a)),[a]),s=Object(n.useCallback)((()=>{e({type:"trustedAppDeletionDialogConfirmed"})}),[e]),o=Object(n.useCallback)((()=>{t||e({type:"trustedAppDeletionDialogClosed"})}),[e,t]);return VM(QM.E)?i.a.createElement(_.EuiModal,{onClose:o},i.a.createElement(_.EuiModalHeader,null,i.a.createElement(_.EuiModalHeaderTitle,null,r.title)),i.a.createElement(_.EuiModalBody,null,i.a.createElement(_.EuiCallOut,{title:r.calloutTitle,color:"danger",iconType:"alert"},i.a.createElement("p",null,r.calloutMessage)),i.a.createElement(_.EuiSpacer,{size:"m"}),i.a.createElement(_.EuiText,null,i.a.createElement("p",null,r.subMessage))),i.a.createElement(_.EuiModalFooter,null,i.a.createElement(_.EuiButtonEmpty,{onClick:o,isDisabled:t,"data-test-subj":"trustedAppDeletionCancel"},r.cancelButton),i.a.createElement(RA,{fill:!0,color:"danger",onClick:s,isLoading:t,"data-test-subj":"trustedAppDeletionConfirm"},r.confirmButton))):i.a.createElement(i.a.Fragment,null)}));FA.displayName="TrustedAppDeletionDialog";const _A=Object(n.memo)((()=>{const e=VM(QM.r),t=VM(QM.q),a=VM(QM.G),r=VM(QM.h),s=VM(QM.D),o=VM(QM.H),l=Object(m.m)(),[c]=Object(n.useState)(new WeakSet);var u,d;return e&&t&&l.addDanger((u=e,d=t,{title:S.i18n.translate("xpack.securitySolution.trustedapps.deletionError.title",{defaultMessage:"Removal failure"}),text:S.i18n.translate("xpack.securitySolution.trustedapps.deletionError.text",{defaultMessage:'Unable to remove "{name}" from the Trusted Applications list. Reason: {message}',values:{name:d.name,message:u.message}})})),a&&t&&l.addSuccess((e=>({title:S.i18n.translate("xpack.securitySolution.trustedapps.deletionSuccess.title",{defaultMessage:"Successfully removed"}),text:S.i18n.translate("xpack.securitySolution.trustedapps.deletionSuccess.text",{defaultMessage:'"{name}" has been removed from the Trusted Applications list.',values:{name:null==e?void 0:e.name}})}))(t)),s&&r&&!c.has(r)&&(c.add(r),l.addSuccess(o&&(e=>({title:S.i18n.translate("xpack.securitySolution.trustedapps.updateSuccess.title",{defaultMessage:"Success!"}),text:S.i18n.translate("xpack.securitySolution.trustedapps.createTrustedAppFlyout.updateSuccessToastTitle",{defaultMessage:'"{name}" has been updated.',values:{name:e.name}})}))(r)||(e=>({title:S.i18n.translate("xpack.securitySolution.trustedapps.creationSuccess.title",{defaultMessage:"Success!"}),text:S.i18n.translate("xpack.securitySolution.trustedapps.createTrustedAppFlyout.successToastTitle",{defaultMessage:'"{name}" has been added to the Trusted Applications list.',values:{name:e.name}})}))(r))),i.a.createElement(i.a.Fragment,null)}));_A.displayName="TrustedAppsNotifications";const NA=L()(_.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-q7ct80-0"})(["min-height:calc(100vh - 140px);"]),LA=Object(n.memo)((({children:e})=>i.a.createElement(NA,{direction:"column",alignItems:"center"},i.a.createElement(_.EuiPageTemplate,{template:"centeredContent"},e))));LA.displayName="ManagementEmptyStateWraper";const BA=Object(n.memo)((({onAdd:e,isAddDisabled:t=!1})=>i.a.createElement(LA,null,i.a.createElement(_.EuiEmptyPrompt,{"data-test-subj":"trustedAppEmptyState",iconType:"plusInCircle",title:i.a.createElement("h2",null,i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.trustedapps.listEmptyState.title",defaultMessage:"Add your first trusted application"})),body:i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.trustedapps.listEmptyState.message",defaultMessage:"Add a trusted application to improve performance or alleviate conflicts with other applications running on your hosts."}),actions:i.a.createElement(_.EuiButton,{fill:!0,isDisabled:t,onClick:e,"data-test-subj":"trustedAppsListAddButton"},i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.trustedapps.list.addButton",defaultMessage:"Add trusted application"}))}))));BA.displayName="EmptyState";const zA=Object(n.memo)((()=>{const e=Object(fe.a)("trustedAppsByPolicyEnabled"),t=Object(b.useDispatch)(),{state:a}=Object(l.useLocation)(),r=VM(QM.k),s=VM(QM.y),o=VM(QM.a),c=VM(QM.L),u=VM(QM.f),d=VM(QM.P),p=WM(((e,t,a)=>({filter:e,included_policies:t,excluded_policies:a}))),m=WM((()=>({show:"create",id:void 0}))),f=WM((()=>({show:void 0,id:void 0}))),g=Object(n.useCallback)(((e,a,n)=>{t({type:"trustedAppForceRefresh",payload:{forceRefresh:!0}}),p(e,a,n)}),[t,p]),h=!!r.show,y=Object(n.useCallback)((()=>u||o&&d),[d,u,o]),v=Object(n.useMemo)((()=>a&&a.onBackButtonNavigateTo?i.a.createElement(HM,a):null),[a]),E=i.a.createElement(_.EuiButton,{fill:!0,iconType:"plusInCircle",isDisabled:h,onClick:m,"data-test-subj":"trustedAppsListAddButton"},i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.trustedapps.list.addButton",defaultMessage:"Add trusted application"})),T=i.a.createElement(i.a.Fragment,null,i.a.createElement(FA,null),h&&i.a.createElement(IA,{onClose:f,size:"m","data-test-subj":"addTrustedAppFlyout"}),y()?i.a.createElement(i.a.Fragment,null,i.a.createElement(xM,{defaultValue:r.filter,onSearch:g,placeholder:cA,hasPolicyFilter:e,policyList:c,defaultExcludedPolicies:r.excluded_policies,defaultIncludedPolicies:r.included_policies}),i.a.createElement(_.EuiFlexGroup,{direction:"column",gutterSize:"none","data-test-subj":"trustedAppsListPageContent"},i.a.createElement(_.EuiSpacer,{size:"m"}),i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(_.EuiText,{color:"subdued",size:"xs","data-test-subj":"trustedAppsListViewCountLabel"},S.i18n.translate("xpack.securitySolution.trustedapps.list.totalCount",{defaultMessage:"Showing {totalItemsCount, plural, one {# trusted application} other {# trusted applications}}",values:{totalItemsCount:s}})),i.a.createElement(_.EuiSpacer,{size:"s"})),i.a.createElement(_.EuiFlexItem,null,i.a.createElement(PA,null)))):i.a.createElement(BA,{onAdd:m,isAddDisabled:h}));return i.a.createElement(Qj,{"data-test-subj":"trustedAppsListPage",title:i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.trustedapps.list.pageTitle",defaultMessage:"Trusted applications"}),headerBackComponent:v,subtitle:nA,actions:E,hideHeader:!y()},i.a.createElement(_A,null),o&&!d?i.a.createElement(_.EuiEmptyPrompt,{"data-test-subj":"trustedAppsListLoader",body:i.a.createElement(_.EuiLoadingSpinner,{className:"essentialAnimation",size:"xl"})}):T)}));function HA(){return i.a.createElement(l.Switch,null,i.a.createElement(l.Route,{path:FO.l,exact:!0,component:zA}),i.a.createElement(l.Route,{path:"*",component:ue.a}))}zA.displayName="TrustedAppsPage";const UA=L()(_.EuiEmptyPrompt).withConfig({displayName:"EmptyPrompt",componentId:"sc-1f37d2p-0"})(["",""],(()=>Object(N.css)(["max-width:100%;"]))),$A=Object(n.memo)((({onAdd:e,isAddDisabled:t=!1})=>i.a.createElement(LA,null,i.a.createElement(UA,{"data-test-subj":"eventFiltersEmpty",iconType:"plusInCircle",title:i.a.createElement("h2",null,i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.eventFilters.listEmpty.title",defaultMessage:"Add your first event filter"})),body:i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.eventFilters.listEmpty.message",defaultMessage:"Add an event filter to exclude high volume or unwanted events from being written to Elasticsearch."}),actions:i.a.createElement(_.EuiButton,{fill:!0,isDisabled:t,onClick:e,"data-test-subj":"eventFiltersListEmptyStateAddButton"},i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.eventFilters.listEmpty.addButton",defaultMessage:"Add event filter"}))}))));$A.displayName="EventFiltersListEmptyState";var QA=a(329),VA=a(801),WA=a(246),GA=a(660);const KA=Object(n.memo)((({onCancel:e,id:t,type:a="create"})=>{Object(QA.b)();const r=Object(b.useDispatch)(),s=Object(QA.c)(WA.h),o=Object(QA.c)(WA.u),l=Object(QA.c)(WA.v);Object(n.useEffect)((()=>{l&&(e(),r({type:"eventFiltersFormStateChanged",payload:{type:"UninitialisedResourceState"}}))}),[l,e,r]),Object(n.useEffect)((()=>(r("edit"===a&&t?{type:"eventFiltersInitFromId",payload:{id:t}}:{type:"eventFiltersInitForm",payload:{entry:Object(GA.a)()}}),()=>{r({type:"eventFiltersFormStateChanged",payload:{type:"UninitialisedResourceState"}})})),[]);const c=Object(n.useCallback)((()=>{o||e()}),[o,e]),u=Object(n.useMemo)((()=>i.a.createElement(_.EuiButton,{"data-test-subj":"add-exception-confirm-button",fill:!0,disabled:s||o,onClick:()=>r(t?{type:"eventFiltersUpdateStart"}:{type:"eventFiltersCreateStart"}),isLoading:o},t?i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.eventFilters.eventFiltersFlyout.actions.confirm.update",defaultMessage:"Update event filter"}):i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.eventFilters.eventFiltersFlyout.actions.confirm.create",defaultMessage:"Add event filter"}))),[s,o,t,r]);return i.a.createElement(_.EuiFlyout,{size:"l",onClose:c,"data-test-subj":"eventFiltersCreateEditFlyout"},i.a.createElement(_.EuiFlyoutHeader,{hasBorder:!0},i.a.createElement(_.EuiTitle,{size:"m"},i.a.createElement("h2",null,t?i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.eventFilters.eventFiltersFlyout.subtitle.update",defaultMessage:"Update event filter"}):i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.eventFilters.eventFiltersFlyout.subtitle.create",defaultMessage:"Add event filter"})))),i.a.createElement(_.EuiFlyoutBody,null,i.a.createElement(VA.a,{allowSelectOs:!0})),i.a.createElement(_.EuiFlyoutFooter,null,i.a.createElement(_.EuiFlexGroup,{justifyContent:"spaceBetween"},i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(_.EuiButtonEmpty,{"data-test-subj":"cancelExceptionAddButton",onClick:c},i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.eventFilters.eventFiltersFlyout.actions.cancel",defaultMessage:"Cancel"}))),i.a.createElement(_.EuiFlexItem,{grow:!1},u))))}));KA.displayName="EventFiltersFlyout";const YA=Object(n.memo)((()=>{const e=Object(b.useDispatch)(),t=Object(m.m)(),a=Object(QA.c)(WA.w),r=Object(QA.c)(WA.j),s=Object(QA.c)(WA.z),o=Object(QA.c)(WA.d),l=Object(n.useCallback)((()=>{e({type:"eventFilterDeletionReset"})}),[e]),c=Object(n.useCallback)((()=>{e({type:"eventFilterDeleteSubmit"})}),[e]);return Object(n.useEffect)((()=>{s&&(t.addSuccess(S.i18n.translate("xpack.securitySolution.eventFilters.deletionDialog.deleteSuccess",{defaultMessage:'"{name}" has been removed from the Event Filters list.',values:{name:null==r?void 0:r.name}})),e({type:"eventFilterDeletionReset"}))}),[e,null==r?void 0:r.name,t,s]),Object(n.useEffect)((()=>{o&&t.addDanger(S.i18n.translate("xpack.securitySolution.eventFilters.deletionDialog.deleteFailure",{defaultMessage:'Unable to remove "{name}" from the Event Filters list. Reason: {message}',values:{name:null==r?void 0:r.name,message:o.message}}))}),[o,null==r?void 0:r.name,t]),i.a.createElement(_.EuiModal,{onClose:l},i.a.createElement(_.EuiModalHeader,{"data-test-subj":"eventFilterDeleteModalHeader"},i.a.createElement(_.EuiModalHeaderTitle,null,i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.eventFilters.deletionDialog.title",defaultMessage:"Remove event filter"}))),i.a.createElement(_.EuiModalBody,{"data-test-subj":"eventFilterDeleteModalBody"},i.a.createElement(_.EuiText,null,i.a.createElement("p",null,i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.eventFilters.deletionDialog.mainMessage",defaultMessage:'You are removing event filter "{name}".',values:{name:i.a.createElement("b",{className:"eui-textBreakWord"},null==r?void 0:r.name)}})),i.a.createElement("p",null,i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.eventFilters.deletionDialog.subMessage",defaultMessage:"This action cannot be undone. Are you sure you wish to continue?"})))),i.a.createElement(_.EuiModalFooter,null,i.a.createElement(_.EuiButtonEmpty,{onClick:l,isDisabled:a,"data-test-subj":"eventFilterDeleteModalCancelButton"},i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.eventFilters.deletionDialog.cancelButton",defaultMessage:"Cancel"})),i.a.createElement(_.EuiButton,{fill:!0,color:"danger",onClick:c,isLoading:a,"data-test-subj":"eventFilterDeleteModalConfirmButton"},i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.eventFilters.deletionDialog.confirmButton",defaultMessage:"Remove event filter"}))))}));YA.displayName="EventFilterDeleteModal";var JA=a(464);const XA=L()(Qj).withConfig({displayName:"AdministrationListPage",componentId:"sc-6oj4b9-0"})([".event-filter-container > *{margin-bottom:",";&:last-child{margin-bottom:0;}}"],(({theme:e})=>e.eui.spacerSizes.l)),ZA=S.i18n.translate("xpack.securitySolution.eventFilters.list.cardAction.edit",{defaultMessage:"Edit event filter"}),eq=S.i18n.translate("xpack.securitySolution.eventFilters.list.cardAction.delete",{defaultMessage:"Delete event filter"}),tq=Object(n.memo)((()=>{const{state:e}=Object(l.useLocation)(),t=Object(l.useHistory)(),a=Object(b.useDispatch)(),r=Object(QA.c)(WA.a),s=Object(QA.c)(WA.f),o=Object(QA.c)(WA.m),c=Object(QA.c)(WA.t),u=Object(QA.c)(WA.q),d=Object(QA.c)(WA.l),p=Object(QA.c)(WA.k),m=Object(QA.c)(WA.c),f=Object(QA.c)(WA.o),g=Object(QA.c)(WA.y),h=Object(QA.a)(),y=!!m.show;Object(n.useEffect)((()=>{("edit"===m.show&&!m.id||"create"===m.show&&m.id)&&h({show:"create",id:void 0})}),[m,h]),Object(n.useEffect)((()=>{r&&!s&&(t.replace(Object(I.h)({...m,show:void 0,id:void 0})),a({type:"eventFiltersFormStateChanged",payload:{type:"UninitialisedResourceState"}}))}),[a,s,t,r,m,h]);const v=Object(n.useMemo)((()=>e&&e.onBackButtonNavigateTo?i.a.createElement(HM,e):null),[e]),E=Object(n.useCallback)((()=>h({show:"create",id:void 0})),[h]),T=Object(n.useCallback)((()=>h({show:void 0,id:void 0})),[h]),k=Object(n.useCallback)((({pageIndex:e,pageSize:t})=>{h({page_index:e,page_size:t})}),[h]),x=Object(n.useCallback)((e=>{a({type:"eventFiltersForceRefresh",payload:{forceRefresh:!0}}),h({filter:e})}),[h,a]),w=Object(n.useMemo)((()=>{const e={};for(const n of o){let i;e[n.id]={item:n,policies:i,hideDescription:!0,"data-test-subj":"eventFilterCard",actions:[{icon:"controlsHorizontal",onClick:()=>{t.push(Object(I.h)({...m,show:"edit",id:n.id}))},"data-test-subj":"editEventFilterAction",children:ZA},{icon:"trash",onClick:()=>{a({type:"eventFilterForDeletion",payload:n})},"data-test-subj":"deleteEventFilterAction",children:eq}]}}return e}),[a,t,o,m]),O=Object(n.useCallback)((e=>w[e.id]),[w]);return i.a.createElement(XA,{headerBackComponent:v,title:i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.eventFilters.list.pageTitle",defaultMessage:"Event filters"}),subtitle:JA.a,actions:f&&i.a.createElement(_.EuiButton,{fill:!0,iconType:"plusInCircle",isDisabled:y,onClick:E,"data-test-subj":"eventFiltersPageAddButton"},i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.eventFilters.list.pageAddButton",defaultMessage:"Add event filter"})),hideHeader:!f},y&&i.a.createElement(KA,{onCancel:T,id:m.id,type:m.show}),g&&i.a.createElement(YA,null),f&&i.a.createElement(i.a.Fragment,null,i.a.createElement(xM,{defaultValue:m.filter,onSearch:x,placeholder:S.i18n.translate("xpack.securitySolution.eventFilter.search.placeholder",{defaultMessage:"Search on the fields below: name, comments, value"})}),i.a.createElement(_.EuiSpacer,{size:"m"}),i.a.createElement(_.EuiText,{color:"subdued",size:"xs","data-test-subj":"eventFiltersCountLabel"},i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.eventFilters.list.totalCount",defaultMessage:"Showing {total, plural, one {# event filter} other {# event filters}}",values:{total:c}})),i.a.createElement(_.EuiSpacer,{size:"s"})),i.a.createElement(CM,{items:o,ItemComponent:cM,itemComponentProps:O,onChange:k,error:null==p?void 0:p.message,loading:d,pagination:u,contentClassName:"event-filter-container","data-test-subj":"eventFiltersContent",noItemsMessage:!f&&i.a.createElement($A,{onAdd:E,isAddDisabled:y})}))}));tq.displayName="EventFiltersListPage";const aq=()=>i.a.createElement(l.Switch,null,i.a.createElement(l.Route,{path:FO.f,exact:!0,component:tq}),i.a.createElement(l.Route,{path:"*",component:ue.a}));var nq=a(322),iq=a(369);const rq=L()(_.EuiEmptyPrompt).withConfig({displayName:"EmptyPrompt",componentId:"sc-46sx6s-0"})(["",""],(()=>Object(N.css)(["max-width:100%;"]))),sq=Object(n.memo)((({onAdd:e})=>i.a.createElement(LA,null,i.a.createElement(rq,{"data-test-subj":"hostIsolationExceptionsEmpty",iconType:"plusInCircle",title:i.a.createElement("h2",null,i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.hostIsolationExceptions.listEmpty.title",defaultMessage:"Add your first Host isolation exception"})),body:i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.hostIsolationExceptions.listEmpty.message",defaultMessage:"Add a Host isolation exception to allow isolated hosts to communicate with specific IPs."}),actions:i.a.createElement(_.EuiButton,{fill:!0,onClick:e,"data-test-subj":"hostIsolationExceptionsEmptyStateAddButton"},i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.hostIsolationExceptions.listEmpty.addButton",defaultMessage:"Add Host isolation exception"}))}))));sq.displayName="HostIsolationExceptionsEmptyState";const oq=Object(n.memo)((()=>{const e=Object(b.useDispatch)(),t=Object(m.m)(),a=Object(iq.c)(nq.l),r=Object(iq.c)(nq.f),s=Object(iq.c)(nq.m),o=Object(iq.c)(nq.c),l=Object(n.useCallback)((()=>{e({type:"hostIsolationExceptionsMarkToDelete",payload:void 0})}),[e]),c=Object(n.useCallback)((()=>{e({type:"hostIsolationExceptionsSubmitDelete"})}),[e]);return Object(n.useEffect)((()=>{s&&(t.addSuccess(S.i18n.translate("xpack.securitySolution.hostIsolationExceptions.deletionDialog.deleteSuccess",{defaultMessage:'"{name}" has been removed from the Host isolation exceptions list.',values:{name:null==r?void 0:r.name}})),e({type:"hostIsolationExceptionsMarkToDelete",payload:void 0}))}),[e,null==r?void 0:r.name,t,s]),Object(n.useEffect)((()=>{o&&t.addDanger(S.i18n.translate("xpack.securitySolution.hostIsolationExceptions.deletionDialog.deleteFailure",{defaultMessage:'Unable to remove "{name}" from the Host isolation exceptions list. Reason: {message}',values:{name:null==r?void 0:r.name,message:o.message}}))}),[o,null==r?void 0:r.name,t]),i.a.createElement(_.EuiModal,{onClose:l},i.a.createElement(_.EuiModalHeader,{"data-test-subj":"hostIsolationExceptionsDeleteModalHeader"},i.a.createElement(_.EuiModalHeaderTitle,null,i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.hostIsolationExceptions.deletionDialog.title",defaultMessage:"Delete Host isolation exception"}))),i.a.createElement(_.EuiModalBody,{"data-test-subj":"hostIsolationExceptionsFilterDeleteModalBody"},i.a.createElement(_.EuiText,null,i.a.createElement("p",null,i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.hostIsolationExceptions.deletionDialog.subtitle",defaultMessage:'You are deleting exception "{name}".',values:{name:i.a.createElement("b",{className:"eui-textBreakWord"},null==r?void 0:r.name)}})),i.a.createElement("p",null,i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.hostIsolationExceptions.deletionDialog.confirmation",defaultMessage:"This action cannot be undone. Are you sure you wish to continue?"})))),i.a.createElement(_.EuiModalFooter,null,i.a.createElement(_.EuiButtonEmpty,{onClick:l,isDisabled:a,"data-test-subj":"hostIsolationExceptionsDeleteModalCancelButton"},i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.hostIsolationExceptions.deletionDialog.cancel",defaultMessage:"Cancel"})),i.a.createElement(_.EuiButton,{fill:!0,color:"danger",onClick:c,isLoading:a,"data-test-subj":"hostIsolationExceptionsDeleteModalConfirmButton"},i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.hostIsolationExceptions.deletionDialog.confirmButton",defaultMessage:"Remove exception"}))))}));oq.displayName="HostIsolationExceptionDeleteModal";var lq=a(220);const cq=S.i18n.translate("xpack.securitySolution.hostIsolationExceptions.form.name.placeholder",{defaultMessage:"Host isolation exception name"}),uq=S.i18n.translate("xpack.securitySolution.hostIsolationExceptions.form.name.label",{defaultMessage:"Name your host isolation exceptions"}),dq=S.i18n.translate("xpack.securitySolution.hostIsolationExceptions.form.name.error",{defaultMessage:"The name can't be empty"}),pq=S.i18n.translate("xpack.securitySolution.hostIsolationExceptions.form.description.placeholder",{defaultMessage:"Describe your host isolation exception"}),mq=S.i18n.translate("xpack.securitySolution.hostIsolationExceptions.form.description.label",{defaultMessage:"Description"}),fq=S.i18n.translate("xpack.securitySolution.hostIsolationExceptions.form.ip.placeholder",{defaultMessage:"Ex 0.0.0.0/24"}),gq=S.i18n.translate("xpack.securitySolution.hostIsolationExceptions.form.ip.label",{defaultMessage:"Enter IP Address"}),bq=S.i18n.translate("xpack.securitySolution.hostIsolationExceptions.form.ip.error",{defaultMessage:"The ip is invalid. Only IPv4 with optional CIDR is supported"}),hq=S.i18n.translate("xpack.securitySolution.hostIsolationExceptions.list.action.delete",{defaultMessage:"Delete Exception"}),yq=S.i18n.translate("xpack.securitySolution.hostIsolationExceptions.list.action.edit",{defaultMessage:"Edit Exception"});var vq=a(1352),Eq=a.n(vq);const Tq=Object(n.memo)((({exception:e,onError:t,onChange:a})=>{const r=e.entries[0],[s,o]=Object(n.useState)(!1),[l,c]=Object(n.useState)(!1),[u,d]=Object(n.useState)(!e.name),[p,m]=Object(n.useState)(!r.value);Object(n.useEffect)((()=>{t(u||p)}),[u,p,t]);const f=Object(n.useCallback)((t=>{const n=t.target.value;n.trim()?(d(!1),a({...e,name:n})):d(!0)}),[e,a]),g=Object(n.useCallback)((t=>{const n=t.target.value;!function(e){if(/^([0-9]{1,3}\.){3}[0-9]{1,3}(\/([0-9]|[1-2][0-9]|3[0-2]))?$/.test(e))try{return Eq.a.IPv4.parseCIDR(e),!0}catch(t){return Eq.a.IPv4.isValid(e)}return!1}(n)?m(!0):(m(!1),a({...e,entries:[{field:"destination.ip",operator:"included",type:"match",value:n}]}))}),[e,a]),b=Object(n.useCallback)((t=>{a({...e,description:t.target.value})}),[e,a]),h=Object(n.useMemo)((()=>{var t;return i.a.createElement(_.EuiFormRow,{label:uq,fullWidth:!0,isInvalid:u&&s,error:dq},i.a.createElement(_.EuiFieldText,{id:"eventFiltersFormInputName",placeholder:cq,defaultValue:null!==(t=e.name)&&void 0!==t?t:"",onChange:f,fullWidth:!0,"aria-label":cq,required:s,maxLength:256,"data-test-subj":"hostIsolationExceptions-form-name-input",onBlur:()=>!s&&o(!0)}))}),[u,s,e.name,f]),y=Object(n.useMemo)((()=>{var t,a,n;return i.a.createElement(_.EuiFormRow,{label:gq,fullWidth:!0,isInvalid:p&&l,error:bq},i.a.createElement(_.EuiFieldText,{id:"eventFiltersFormInputName",placeholder:fq,defaultValue:null!==(t=null===(a=e.entries)||void 0===a||null===(n=a[0])||void 0===n?void 0:n.value)&&void 0!==t?t:"",onChange:g,fullWidth:!0,"aria-label":fq,required:l,maxLength:256,"data-test-subj":"hostIsolationExceptions-form-ip-input",onBlur:()=>!l&&c(!0)}))}),[p,l,e.entries,g]),v=Object(n.useMemo)((()=>{var t;return i.a.createElement(_.EuiFormRow,{label:mq,fullWidth:!0},i.a.createElement(_.EuiTextArea,{id:"eventFiltersFormInputName",placeholder:pq,defaultValue:null!==(t=e.description)&&void 0!==t?t:"",onChange:b,fullWidth:!0,"data-test-subj":"hostIsolationExceptions-form-description-input","aria-label":pq,maxLength:256}))}),[e.description,b]);return i.a.createElement(_.EuiForm,{component:"div"},i.a.createElement(_.EuiTitle,{size:"xs"},i.a.createElement("h2",null,i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.hostIsolationExceptions.form.title",defaultMessage:"Details"}))),i.a.createElement(_.EuiText,{size:"s"},i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.hostIsolationExceptions.form.description",defaultMessage:"Allows isolated hosts to connect to these IP addresses. Only accepts IPv4 with optional CIDR."})),i.a.createElement(_.EuiSpacer,{size:"m"}),h,v,i.a.createElement(_.EuiSpacer,{size:"m"}),i.a.createElement(_.EuiHorizontalRule,null),i.a.createElement(_.EuiTitle,{size:"xs"},i.a.createElement("h2",null,i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.hostIsolationExceptions.form.conditions.title",defaultMessage:"Conditions"}))),i.a.createElement(_.EuiText,{size:"s"},i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.hostIsolationExceptions.form.conditions.subtitle",defaultMessage:"Host Isolation exceptions will apply to all operating systems."})),i.a.createElement(_.EuiSpacer,{size:"m"}),y)}));Tq.displayName="HostIsolationExceptionsForm";const kq=Object(n.memo)((()=>{const e=Object(b.useDispatch)(),t=Object(m.m)(),a=Object(iq.c)(nq.b),r=Object(iq.c)((e=>Object(lq.e)(e.form.status))),s=Object(iq.c)((e=>Object(lq.d)(e.form.status))),o=Object(iq.c)(nq.e),c=Object(iq.c)(nq.d),u=Object(iq.b)(),d=Object(l.useHistory)(),[p,f]=Object(n.useState)(!0),[g,h]=Object(n.useState)(void 0),y=Object(n.useCallback)((()=>u({show:void 0,id:void 0})),[u]);Object(n.useEffect)((()=>{if("create"===a.show&&void 0===g)h({comments:[],description:"",entries:[{field:"destination.ip",operator:"included",type:"match",value:""}],item_id:void 0,list_id:ei.e,name:"",namespace_type:"agnostic",os_types:["windows","linux","macos"],tags:["policy:all"],type:"simple"});else if("edit"===a.show){if(!a.id)return void y();c&&a.id===c.id?void 0===g&&h(c):e({type:"hostIsolationExceptionsMarkToEdit",payload:{id:a.id}})}}),[e,g,c,a.id,a.show,y]),Object(n.useEffect)((()=>{var a;s&&null!=g&&g.name&&(y(),e({type:"hostIsolationExceptionsFormStateChanged",payload:{type:"UninitialisedResourceState"}}),null!=g&&g.item_id?t.addSuccess((a=g.name,S.i18n.translate("xpack.securitySolution.hostIsolationExceptions.form.editingSuccessToastTitle",{defaultMessage:'"{name}" has been updated.',values:{name:a}}))):t.addSuccess((e=>S.i18n.translate("xpack.securitySolution.hostIsolationExceptions.form.creationSuccessToastTitle",{defaultMessage:'"{name}" has been added to the host isolation exceptions list.',values:{name:e}}))(g.name)))}),[s,e,null==g?void 0:g.item_id,null==g?void 0:g.name,y,t]),Object(n.useEffect)((()=>{var n;!o||"edit"!==a.show||null!=g&&g.item_id||(t.addWarning((n=o,S.i18n.translate("xpack.securitySolution.hostIsolationExceptions.form.failedToastTitle.get",{defaultMessage:'Unable to edit exception: "{error}"',values:{error:n.message}}))),d.replace(Object(I.i)(Object(lf.omit)(a,["show","id"]))),e({type:"hostIsolationExceptionsFormStateChanged",payload:{type:"UninitialisedResourceState"}}))}),[o,e,null==g?void 0:g.item_id,d,a,t]),Object(n.useEffect)((()=>{var a,n;o&&(null!=g&&g.item_id?t.addDanger((n=o,S.i18n.translate("xpack.securitySolution.hostIsolationExceptions.form.failedToastTitle.update",{defaultMessage:'There was an error updating the exception: "{error}"',values:{error:n.message}}))):t.addDanger((a=o,S.i18n.translate("xpack.securitySolution.hostIsolationExceptions.form.failedToastTitle.create",{defaultMessage:'There was an error creating the exception: "{error}"',values:{error:a.message}}))),e({type:"hostIsolationExceptionsFormStateChanged",payload:{type:"UninitialisedResourceState"}}))}),[o,e,null==g?void 0:g.item_id,t]);const v=Object(n.useCallback)((()=>{r||y()}),[r,y]),E=Object(n.useCallback)((()=>{null!=g&&g.item_id?e({type:"hostIsolationExceptionsSubmitEdit",payload:g}):e({type:"hostIsolationExceptionsCreateEntry",payload:g})}),[e,g]),T=Object(n.useMemo)((()=>i.a.createElement(_.EuiButton,{"data-test-subj":"add-exception-confirm-button",fill:!0,disabled:p||r,onClick:E,isLoading:r},null!=g&&g.item_id?i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.hostIsolationExceptions.flyout.editButton",defaultMessage:"Edit host isolation exception"}):i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.hostIsolationExceptions.flyout.createButton",defaultMessage:"Add host isolation exception"}))),[p,r,E,null==g?void 0:g.item_id]);return g?i.a.createElement(_.EuiFlyout,{size:"m",onClose:v,"data-test-subj":"hostIsolationExceptionsCreateEditFlyout"},i.a.createElement(_.EuiFlyoutHeader,{hasBorder:!0},i.a.createElement(_.EuiTitle,{size:"m"},null!=g&&g.item_id?i.a.createElement("h2",null,i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.hostIsolationExceptions.flyout.editTitle",defaultMessage:"Edit host isolation exception"})):i.a.createElement("h2",null,i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.hostIsolationExceptions.flyout.title",defaultMessage:"Add host isolation exception"})))),i.a.createElement(_.EuiFlyoutBody,null,i.a.createElement(Tq,{onChange:h,exception:g,onError:f})),i.a.createElement(_.EuiFlyoutFooter,null,i.a.createElement(_.EuiFlexGroup,{justifyContent:"spaceBetween"},i.a.createElement(_.EuiFlexItem,{grow:!1},i.a.createElement(_.EuiButtonEmpty,{"data-test-subj":"add-exception-cancel-button",onClick:v},i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.hostIsolationExceptions.flyout.cancel",defaultMessage:"Cancel"}))),i.a.createElement(_.EuiFlexItem,{grow:!1},T)))):i.a.createElement(un.a,{size:"xl"})}));kq.displayName="HostIsolationExceptionsFormFlyout";var xq=a(429);const Sq=()=>{const e=Object(iq.c)(nq.i),t=Object(iq.c)(nq.k),a=Object(iq.c)(nq.j),r=Object(iq.c)(nq.h),s=Object(iq.c)(nq.g),{state:o}=Object(l.useLocation)(),c=Object(iq.c)(nq.b),u=Object(b.useDispatch)(),d=Object(iq.c)(nq.f),p=Object(iq.b)(),m=Object(l.useHistory)(),f=Object(xq.a)(),g=f.canIsolateHost&&!!c.show,h=!!c.filter||e.length>0;Object(n.useEffect)((()=>{r||0!==e.length||f.canIsolateHost||m.replace(Object(I.g)({name:"endpointList"}))}),[m,r,e.length,f.canIsolateHost]);const y=Object(n.useCallback)((e=>{p({filter:e})}),[p]);const v=Object(n.useCallback)((({pageIndex:e,pageSize:t})=>{p({page_index:e,page_size:t})}),[p]),E=Object(n.useMemo)((()=>o&&o.onBackButtonNavigateTo?i.a.createElement(HM,o):null),[o]),T=Object(n.useCallback)((()=>p({show:"create",id:void 0})),[p]);return i.a.createElement(Qj,{headerBackComponent:E,title:i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.hostIsolationExceptions.list.pageTitle",defaultMessage:"Host isolation exceptions"}),subtitle:i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.hostIsolationExceptions.list.pageSubTitle",defaultMessage:"Add a Host isolation exception to allow isolated hosts to communicate with specific IPs."}),actions:f.canIsolateHost&&h?i.a.createElement(_.EuiButton,{fill:!0,iconType:"plusInCircle",isDisabled:g,onClick:T,"data-test-subj":"hostIsolationExceptionsListAddButton"},i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.hostIsolationExceptions.list.addButton",defaultMessage:"Add Host isolation exception"})):[],hideHeader:!h},g&&i.a.createElement(kq,null),d?i.a.createElement(oq,null):null,h?i.a.createElement(i.a.Fragment,null,i.a.createElement(xM,{defaultValue:c.filter,onSearch:y,placeholder:S.i18n.translate("xpack.securitySolution.hostIsolationExceptions.search.placeholder",{defaultMessage:"Search on the fields below: name, description, ip"})}),i.a.createElement(_.EuiSpacer,{size:"m"}),i.a.createElement(_.EuiText,{color:"subdued",size:"xs","data-test-subj":"hostIsolationExceptions-totalCount"},i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.hostIsolationExceptions.list.totalCount",defaultMessage:"Showing {total, plural, one {# exception} other {# exceptions}}",values:{total:t}})),i.a.createElement(_.EuiSpacer,{size:"s"})):null,i.a.createElement(CM,{items:e,ItemComponent:cM,itemComponentProps:function(e){const t={icon:"controlsHorizontal",onClick:()=>{p({show:"edit",id:e.id})},"data-test-subj":"editHostIsolationException",children:yq},a={icon:"trash",onClick:()=>{u({type:"hostIsolationExceptionsMarkToDelete",payload:e})},"data-test-subj":"deleteHostIsolationException",children:hq};return{item:e,"data-test-subj":"hostIsolationExceptionsCard",actions:f.canIsolateHost?[t,a]:[a]}},onChange:v,error:null==s?void 0:s.message,loading:r,pagination:a,contentClassName:"host-isolation-exceptions-container","data-test-subj":"hostIsolationExceptionsContent",noItemsMessage:!h&&i.a.createElement(sq,{onAdd:T})}))};Sq.displayName="HostIsolationExceptionsList";const wq=Object(n.memo)((()=>i.a.createElement(l.Switch,null,i.a.createElement(l.Route,{path:FO.g,exact:!0,component:Sq}),i.a.createElement(l.Route,{path:"*",component:ue.a}))));wq.displayName="HostIsolationExceptionsContainer";const Oq=Object(n.memo)((()=>i.a.createElement(i.a.Fragment,null,i.a.createElement(_.EuiEmptyPrompt,{iconType:"alert",iconColor:"danger",titleSize:"l","data-test-subj":"noIngestPermissions",title:i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.endpointManagemnet.noPermissionsText",defaultMessage:"You do not have the required Kibana permissions to use Elastic Security Administration"}),body:i.a.createElement(_.EuiText,{color:"subdued"},i.a.createElement(oa.FormattedMessage,{id:"xpack.securitySolution.endpointManagement.noPermissionsSubText",defaultMessage:"It looks like Fleet is disabled. Fleet must be enabled to use this feature. If you do not have permissions to enable Fleet, contact your Kibana administrator."}))}),i.a.createElement(u.a,{pageName:o.Kb.administration}))));Oq.displayName="NoPermissions";const jq=()=>i.a.createElement(r.TrackApplicationView,{viewId:o.Kb.endpoints},i.a.createElement(KC,null)),Cq=()=>i.a.createElement(r.TrackApplicationView,{viewId:o.Kb.policies},i.a.createElement($M,null)),Iq=()=>i.a.createElement(r.TrackApplicationView,{viewId:o.Kb.trustedApps},i.a.createElement(HA,null)),Mq=()=>i.a.createElement(r.TrackApplicationView,{viewId:o.Kb.eventFilters},i.a.createElement(aq,null)),Aq=()=>i.a.createElement(r.TrackApplicationView,{viewId:o.Kb.hostIsolationExceptions},i.a.createElement(u.a,{pageName:o.Kb.administration}),i.a.createElement(wq,null)),qq=Object(n.memo)((()=>{const{loading:e,canAccessEndpointManagement:t}=Object(Rt.b)().endpointPrivileges;return e?i.a.createElement(_.EuiLoadingSpinner,null):t?i.a.createElement(l.Switch,null,i.a.createElement(l.Route,{path:FO.e,component:jq}),i.a.createElement(l.Route,{path:FO.h,component:Cq}),i.a.createElement(l.Route,{path:FO.l,component:Iq}),i.a.createElement(l.Route,{path:FO.f,component:Mq}),i.a.createElement(l.Route,{path:FO.g,component:Aq}),i.a.createElement(l.Route,{path:o.tb,exact:!0},i.a.createElement(l.Redirect,{to:Object(I.g)({name:"endpointList"})})),i.a.createElement(l.Route,{path:"*",component:ue.a})):i.a.createElement(l.Route,{path:"*",component:Oq})}));qq.displayName="ManagementContainer";var Dq=a(746);const Pq=[{path:o.tb,render:()=>i.a.createElement(Dq.a,null,i.a.createElement(qq,null))}];var Rq=a(754),Fq=a(761);const _q={Detections:class detections_Detections{setup(){}start(e){return{storageTimelines:{timelineById:Object(ce.b)(e,on)},routes:sn}}},Cases:class cases_Cases{setup(){}start(){return{routes:le}}},Exceptions:class exceptions_Exceptions{setup(){}start(e){return{storageTimelines:{timelineById:Object(ce.b)(e,on)},routes:Li}}},Hosts:class public_hosts_Hosts{setup(){}start(e){return{routes:ko,storageTimelines:{timelineById:Object(ce.b)(e,xo)},store:{initialState:{hosts:go.e},reducer:{hosts:go.c}}}}},Network:class public_network_Network{setup(){}start(e){return{routes:Lu,storageTimelines:{timelineById:Object(ce.b)(e,[h.q.networkPageExternalAlerts])},store:{initialState:{network:kc.a},reducer:{network:kc.d}}}}},Ueba:class public_ueba_Ueba{setup(){}start(e){return{routes:Zd,storageTimelines:{timelineById:Object(ce.b)(e,[h.q.uebaPageExternalAlerts])},store:{initialState:{ueba:Uu.a},reducer:{ueba:Uu.d}}}}},Overview:class overview_Overview{setup(){}start(){return{routes:If}}},Rules:class rules_Rules{setup(){}start(e){return{storageTimelines:{timelineById:Object(ce.b)(e,on)},routes:IO}}},Timelines:class timelines_Timelines{setup(){}start(){return{routes:AO,store:{initialState:{timeline:PO},reducer:{timeline:RO}}}}},Management:class management_Management{setup(){}start(e,t){return{routes:Pq,store:{initialState:{management:{}},reducer:{management:Rq.a},middleware:Object(Fq.a)(e,t)}}}}}}])]);