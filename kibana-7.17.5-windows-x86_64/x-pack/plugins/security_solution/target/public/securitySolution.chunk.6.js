/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.securitySolution_bundle_jsonpfunction=window.securitySolution_bundle_jsonpfunction||[]).push([[6],{1353:function(t,e,a){const i=a(651);t.exports=(t,e,a)=>i(t,e,a)>=0},153:function(t,e,a){"use strict";a.r(e),a.d(e,"listData",(function(){return g})),a.d(e,"pageIndex",(function(){return b})),a.d(e,"pageSize",(function(){return f})),a.d(e,"totalHits",(function(){return h})),a.d(e,"listLoading",(function(){return v})),a.d(e,"listError",(function(){return O})),a.d(e,"detailsData",(function(){return j})),a.d(e,"detailsLoading",(function(){return m})),a.d(e,"detailsError",(function(){return S})),a.d(e,"policyItems",(function(){return D})),a.d(e,"policyItemsLoading",(function(){return E})),a.d(e,"selectedPolicyId",(function(){return R})),a.d(e,"endpointPackageInfo",(function(){return L})),a.d(e,"getIsEndpointPackageInfoUninitialized",(function(){return A})),a.d(e,"isAutoRefreshEnabled",(function(){return P})),a.d(e,"autoRefreshInterval",(function(){return C})),a.d(e,"policyVersionInfo",(function(){return w})),a.d(e,"areEndpointsEnrolling",(function(){return I})),a.d(e,"agentsWithEndpointsTotalError",(function(){return _})),a.d(e,"endpointsTotalError",(function(){return x})),a.d(e,"endpointPackageVersion",(function(){return F})),a.d(e,"patterns",(function(){return T})),a.d(e,"patternsError",(function(){return k})),a.d(e,"policyResponseTimestamp",(function(){return q})),a.d(e,"policyResponseAppliedRevision",(function(){return z})),a.d(e,"policyResponseConfigurations",(function(){return N})),a.d(e,"policyResponseFailedOrWarningActionCount",(function(){return V})),a.d(e,"policyResponseActions",(function(){return M})),a.d(e,"policyResponseLoading",(function(){return H})),a.d(e,"policyResponseError",(function(){return $})),a.d(e,"isOnEndpointPage",(function(){return W})),a.d(e,"uiQueryParams",(function(){return B})),a.d(e,"hasSelectedEndpoint",(function(){return Q})),a.d(e,"showView",(function(){return G})),a.d(e,"selectedAgent",(function(){return J})),a.d(e,"hostStatusInfo",(function(){return K})),a.d(e,"policyResponseStatus",(function(){return Y})),a.d(e,"nonExistingPolicies",(function(){return X})),a.d(e,"agentPolicies",(function(){return Z})),a.d(e,"endpointsExist",(function(){return tt})),a.d(e,"searchBarQuery",(function(){return et})),a.d(e,"getCurrentIsolationRequestState",(function(){return at})),a.d(e,"getIsIsolationRequestPending",(function(){return it})),a.d(e,"getWasIsolationRequestSuccessful",(function(){return nt})),a.d(e,"getIsolationRequestError",(function(){return ot})),a.d(e,"getIsOnEndpointDetailsActivityLog",(function(){return st})),a.d(e,"getActivityLogDataPaging",(function(){return rt})),a.d(e,"getActivityLogData",(function(){return ct})),a.d(e,"getLastLoadedActivityLogData",(function(){return dt})),a.d(e,"getActivityLogUninitialized",(function(){return pt})),a.d(e,"getActivityLogRequestLoading",(function(){return lt})),a.d(e,"getActivityLogRequestLoaded",(function(){return ut})),a.d(e,"getActivityLogIterableData",(function(){return yt})),a.d(e,"getActivityLogError",(function(){return gt})),a.d(e,"getActivityLogIsUninitializedOrHasSubsequentAPIError",(function(){return bt})),a.d(e,"getIsEndpointHostIsolated",(function(){return ft})),a.d(e,"getEndpointPendingActionsState",(function(){return ht})),a.d(e,"getEndpointHostIsolationStatusPropsCallback",(function(){return vt})),a.d(e,"getMetadataTransformStats",(function(){return Ot})),a.d(e,"metadataTransformStats",(function(){return jt})),a.d(e,"isMetadataTransformStatsLoading",(function(){return mt}));var i=a(219),n=a.n(i),o=a(112),s=a(21),r=a(68),c=a(107),d=a(101),p=a(106),l=a(181),u=a(209),y=a(695);const g=t=>t.hosts,b=t=>t.pageIndex,f=t=>t.pageSize,h=t=>t.total,v=t=>t.loading,O=t=>t.error,j=t=>t.endpointDetails.hostDetails.details,m=t=>t.endpointDetails.hostDetails.detailsLoading,S=t=>t.endpointDetails.hostDetails.detailsError,D=t=>t.policyItems,E=t=>t.policyItemsLoading,R=t=>t.selectedPolicyId,L=t=>t.endpointPackageInfo,A=Object(o.createSelector)(L,(t=>Object(l.i)(t))),P=t=>t.isAutoRefreshEnabled,C=t=>t.autoRefreshInterval,w=t=>t.policyVersionInfo,I=t=>t.agentsWithEndpointsTotal>t.endpointsTotal,_=t=>t.agentsWithEndpointsTotalError,x=t=>t.endpointsTotalError,F=Object(o.createSelector)(L,(t=>Object(l.g)(t)?t.data.version:void 0)),T=t=>t.patterns,k=t=>t.patternsError,U=t=>t.policyResponse&&t.policyResponse.Endpoint.policy.applied,q=t=>t.policyResponse&&t.policyResponse["@timestamp"],z=t=>{var e;return String((null===(e=t.policyResponse)||void 0===e?void 0:e.Endpoint.policy.applied.endpoint_policy_version)||"")},N=Object(o.createSelector)(U,(t=>{var e;return null==t||null===(e=t.response)||void 0===e?void 0:e.configurations})),V=Object(o.createSelector)(U,(t=>{var e;const a=new Map;return void 0!==(null==t||null===(e=t.response)||void 0===e?void 0:e.configurations)&&void 0!==(null==t?void 0:t.actions)&&Object.entries(t.response.configurations).map((([e,i])=>{let n=0;for(const e of i.concerned_actions){var o;const a=null===(o=t.actions.find((t=>t.name===e)))||void 0===o?void 0:o.status;a!==c.d.failure&&a!==c.d.warning||(n+=1)}return a.set(e,n)})),a})),M=Object(o.createSelector)(U,(t=>null==t?void 0:t.actions)),H=t=>t.policyResponseLoading,$=t=>t.policyResponseError,W=t=>{var e,a;return null!==Object(s.matchPath)(null!==(e=null===(a=t.location)||void 0===a?void 0:a.pathname)&&void 0!==e?e:"",{path:p.e,exact:!0})},B=Object(o.createSelector)((t=>t.location),(t=>{const e={page_index:String(p.b),page_size:String(p.c)};if(t){const a=n.a.parse(t.search.slice(1)),i=Object(d.c)(a),o=["selected_endpoint","show","admin_query"],s=["policy_response","details","isolate","unisolate","activity_log"];for(const t of o){const i="string"==typeof a[t]?a[t]:Array.isArray(a[t])?a[t][a[t].length-1]:void 0;void 0!==i&&("show"===t?s.includes(i)&&(e[t]=i):e[t]=i)}e.page_size=String(i.page_size),e.page_index=String(i.page_index)}return e})),Q=Object(o.createSelector)(B,(({selected_endpoint:t})=>void 0!==t)),G=Object(o.createSelector)(B,(t=>{var e;return null!==(e=t.show)&&void 0!==e?e:"details"})),J=t=>{var e;const a=t.hosts,{selected_endpoint:i}=B(t);return(null===(e=a.find((t=>t.metadata.agent.id===i)))||void 0===e?void 0:e.metadata.elastic.agent.id)||""},K=Object(o.createSelector)((t=>t.hostStatus),(t=>t||c.e.UNHEALTHY)),Y=Object(o.createSelector)((t=>t.policyResponse),(t=>{var e,a,i;return t&&(null==t||null===(e=t.Endpoint)||void 0===e||null===(a=e.policy)||void 0===a||null===(i=a.applied)||void 0===i?void 0:i.status)||""})),X=t=>t.nonExistingPolicies,Z=t=>t.agentPolicies,tt=t=>t.endpointsExist,et=Object(o.createSelector)(B,(({admin_query:t})=>{const e={query:"",language:"kuery"};if(t){const a=Object(r.decode)(t);a&&"string"==typeof a.query&&(e.query=a.query),!a||"string"!=typeof a.language||"kuery"!==a.language&&"lucene"!==a.language||(e.language=a.language)}return e})),at=t=>t.isolationRequestState,it=Object(o.createSelector)(at,(t=>Object(l.h)(t))),nt=Object(o.createSelector)(at,(t=>Object(l.g)(t))),ot=Object(o.createSelector)(at,(t=>{if(Object(l.f)(t))return t.error})),st=Object(o.createSelector)(B,(t=>t.show===y.b.activityLog)),rt=t=>t.endpointDetails.activityLog.paging,ct=t=>t.endpointDetails.activityLog.logData,dt=Object(o.createSelector)(ct,(t=>{var e;return null===(e=Object(l.e)(t))||void 0===e?void 0:e.data})),pt=Object(o.createSelector)(ct,(t=>Object(l.i)(t))),lt=Object(o.createSelector)(ct,(t=>Object(l.h)(t))),ut=Object(o.createSelector)(ct,(t=>Object(l.g)(t))),yt=Object(o.createSelector)(ct,(t=>Object(l.g)(t)?t.data.data:[])),gt=Object(o.createSelector)(ct,(t=>{if(Object(l.f)(t))return t.error})),bt=Object(o.createSelector)(pt,dt,gt,((t,e,a)=>t||!a&&!(null==e||!e.data.length))),ft=Object(o.createSelector)(j,(t=>t&&Object(u.b)(t)||!1)),ht=t=>t.endpointPendingActions,vt=Object(o.createSelector)(ht,(t=>e=>{let a=0,i=0;if(Object(l.g)(t)){const s=t.data.get(e.elastic.agent.id);var n,o;if(s)a=null!==(n=null==s?void 0:s.isolate)&&void 0!==n?n:0,i=null!==(o=null==s?void 0:s.unisolate)&&void 0!==o?o:0}return{isIsolated:Object(u.b)(e),pendingIsolate:a,pendingUnIsolate:i}})),Ot=t=>t.metadataTransformStats,jt=t=>Object(l.g)(t.metadataTransformStats)?t.metadataTransformStats.data:[],mt=t=>Object(l.h)(t.metadataTransformStats)},170:function(t,e,a){"use strict";a.d(e,"b",(function(){return c})),a.d(e,"a",(function(){return h}));var i=a(91),n=a(9),o=a.n(n),s=a(106),r=(a(90),a(70));function c(t){return Object(i.useSelector)((function(e){return t(e[s.o][s.m])}))}var d=a(57),p=a(3),l=a(101),u=a(153),y=a(148),g=a(209),b=a(16),f=a(649);const h=t=>{const e=Object(b.b)().isPlatinumPlus(),{getAppUrl:a}=Object(y.b)(),i=c(u.agentPolicies),s=c(u.uiQueryParams);return Object(n.useMemo)((()=>{if(t){const n=Object(g.b)(t),c=t.agent.id,u=t.Endpoint.policy.applied.id,y=t.host.hostname,b=t.elastic.agent.id,h=Object(f.a)({osName:t.host.os.name,version:t.agent.version,capabilities:t.Endpoint.capabilities}),{show:v,selected_endpoint:O,...j}=s,m=Object(l.f)({name:"endpointIsolate",...j,selected_endpoint:c}),S=Object(l.f)({name:"endpointUnIsolate",...j,selected_endpoint:c}),D=[];return n?D.push({"data-test-subj":"unIsolateLink",icon:"logoSecurity",key:"unIsolateHost",navigateAppId:p.l,navigateOptions:{path:S},href:a({path:S}),children:o.a.createElement(d.FormattedMessage,{id:"xpack.securitySolution.endpoint.actions.unIsolateHost",defaultMessage:"Release host"})}):e&&h&&D.push({"data-test-subj":"isolateLink",icon:"logoSecurity",key:"isolateHost",navigateAppId:p.l,navigateOptions:{path:m},href:a({path:m}),children:o.a.createElement(d.FormattedMessage,{id:"xpack.securitySolution.endpoint.actions.isolateHost",defaultMessage:"Isolate host"})}),[...D,{"data-test-subj":"hostLink",icon:"logoSecurity",key:"hostDetailsLink",navigateAppId:p.l,navigateOptions:{path:`/hosts/${y}`},href:a({path:`/hosts/${y}`}),children:o.a.createElement(d.FormattedMessage,{id:"xpack.securitySolution.endpoint.actions.hostDetails",defaultMessage:"View host details"})},{icon:"gear",key:"agentConfigLink","data-test-subj":"agentPolicyLink",navigateAppId:"fleet",navigateOptions:{path:`${r.pagePathGetters.policy_details({policyId:i[u]})[1]}`},href:`${a({appId:"fleet"})}${r.pagePathGetters.policy_details({policyId:i[u]})[1]}`,disabled:void 0===i[u],children:o.a.createElement(d.FormattedMessage,{id:"xpack.securitySolution.endpoint.actions.agentPolicy",defaultMessage:"View agent policy"})},{icon:"gear",key:"agentDetailsLink","data-test-subj":"agentDetailsLink",navigateAppId:"fleet",navigateOptions:{path:`${r.pagePathGetters.agent_details({agentId:b})[1]}`},href:`${a({appId:"fleet"})}${r.pagePathGetters.agent_details({agentId:b})[1]}`,children:o.a.createElement(d.FormattedMessage,{id:"xpack.securitySolution.endpoint.actions.agentDetails",defaultMessage:"View agent details"})},{icon:"gear",key:"agentPolicyReassignLink","data-test-subj":"agentPolicyReassignLink",navigateAppId:"fleet",navigateOptions:{path:`${r.pagePathGetters.agent_details({agentId:b})[1]}?openReassignFlyout=true`},href:`${a({appId:"fleet"})}${r.pagePathGetters.agent_details({agentId:b})[1]}?openReassignFlyout=true`,children:o.a.createElement(d.FormattedMessage,{id:"xpack.securitySolution.endpoint.actions.agentPolicyReassign",defaultMessage:"Reassign agent policy"})}]}return[]}),[s,t,i,a,e])}},254:function(t,e,a){"use strict";a.d(e,"N",(function(){return s})),a.d(e,"x",(function(){return r})),a.d(e,"t",(function(){return c})),a.d(e,"v",(function(){return d})),a.d(e,"o",(function(){return p})),a.d(e,"p",(function(){return l})),a.d(e,"m",(function(){return u})),a.d(e,"n",(function(){return y})),a.d(e,"l",(function(){return g})),a.d(e,"y",(function(){return b})),a.d(e,"w",(function(){return f})),a.d(e,"k",(function(){return h})),a.d(e,"u",(function(){return v})),a.d(e,"J",(function(){return O})),a.d(e,"E",(function(){return j})),a.d(e,"F",(function(){return m})),a.d(e,"G",(function(){return S})),a.d(e,"r",(function(){return D})),a.d(e,"s",(function(){return E})),a.d(e,"q",(function(){return R})),a.d(e,"B",(function(){return L})),a.d(e,"j",(function(){return A})),a.d(e,"h",(function(){return P})),a.d(e,"A",(function(){return C})),a.d(e,"C",(function(){return w})),a.d(e,"D",(function(){return I})),a.d(e,"i",(function(){return _})),a.d(e,"g",(function(){return x})),a.d(e,"a",(function(){return F})),a.d(e,"f",(function(){return T})),a.d(e,"P",(function(){return k})),a.d(e,"Q",(function(){return U})),a.d(e,"O",(function(){return q})),a.d(e,"M",(function(){return z})),a.d(e,"L",(function(){return N})),a.d(e,"K",(function(){return V})),a.d(e,"z",(function(){return M})),a.d(e,"H",(function(){return H})),a.d(e,"b",(function(){return $})),a.d(e,"c",(function(){return W})),a.d(e,"I",(function(){return B})),a.d(e,"d",(function(){return Q})),a.d(e,"e",(function(){return G}));var i=a(112),n=a(106),o=a(787);const s=t=>{const e=t.listView.freshDataTimestamp,a=t.listView.listResourceState,i=t.location,n=t.forceRefresh;return Boolean(t.active)&&(n||Object(o.f)(a,(t=>t.pageIndex===i.page_index&&t.pageSize===i.page_size&&t.timestamp>=e)))},r=t=>t.listView.listResourceState,c=t=>Object(o.b)(t.listView.listResourceState),d=t=>{var e;return(null===(e=Object(o.b)(t.listView.listResourceState))||void 0===e?void 0:e.data.items)||[]},p=t=>t.location.page_index,l=t=>t.location.page_size,u=t=>t.location.filter,y=t=>t.location.included_policies,g=t=>t.location.excluded_policies,b=t=>{var e;return(null===(e=Object(o.b)(t.listView.listResourceState))||void 0===e?void 0:e.data.totalItemsCount)||0},f=t=>{const e=Object(o.b)(t.listView.listResourceState);return{pageIndex:t.location.page_index,pageSize:t.location.page_size,totalItemCount:(null==e?void 0:e.data.totalItemsCount)||0,pageSizeOptions:[...n.d]}},h=t=>t.location,v=t=>{var e;return null===(e=Object(o.a)(t.listView.listResourceState))||void 0===e?void 0:e.message},O=t=>Object(o.e)(t.listView.listResourceState),j=t=>void 0!==t.deletionDialog.entry,m=t=>Object(o.e)(t.deletionDialog.submissionResourceState),S=t=>Object(o.d)(t.deletionDialog.submissionResourceState),D=t=>{const e=t.deletionDialog.submissionResourceState;return Object(o.c)(e)?e.error:void 0},E=t=>t.deletionDialog.submissionResourceState,R=t=>t.deletionDialog.entry,L=t=>!!t.location.show,A=t=>t.creationDialog.submissionResourceState,P=t=>{var e;return null===(e=t.creationDialog.formState)||void 0===e?void 0:e.entry},C=t=>{var e;return(null===(e=t.creationDialog.formState)||void 0===e?void 0:e.isValid)||!1},w=t=>Object(o.e)(t.creationDialog.submissionResourceState),I=t=>Object(o.d)(t.creationDialog.submissionResourceState),_=t=>{const e=t.creationDialog.submissionResourceState;return Object(o.c)(e)?e.error:void 0},x=t=>t.entriesExist,F=Object(i.createSelector)(x,(t=>!Object(o.d)(t))),T=Object(i.createSelector)(x,(t=>Object(o.d)(t)&&t.data)),k=Object(i.createSelector)(x,(t=>{var e;return Object(o.e)(t)&&!(null===(e=Object(o.b)(t))||void 0===e||!e.data)})),U=t=>t.active,q=t=>t.policies,z=Object(i.createSelector)(q,(t=>Object(o.e)(t))),N=Object(i.createSelector)(q,(t=>Object(o.d)(t)?t.data.items:[])),V=Object(i.createSelector)(q,(t=>Object(o.e)(t))),M=Object(i.createSelector)(N,(t=>t.reduce(((t,e)=>(t[e.id]=e,t)),{}))),H=Object(i.createSelector)(h,(({show:t})=>"edit"===t)),$=Object(i.createSelector)(h,(({id:t})=>t)),W=t=>t.creationDialog.editItem,B=Object(i.createSelector)(W,(t=>!!t&&Object(o.e)(t))),Q=Object(i.createSelector)(W,(t=>t&&Object(o.a)(t))),G=Object(i.createSelector)(W,(t=>{if(t&&Object(o.d)(t))return t.data}))},334:function(t,e,a){"use strict";a.d(e,"a",(function(){return o}));var i=a(9),n=a(21);const o=(t,e)=>{const a=Object(n.useHistory)();return Object(i.useCallback)((i=>{try{e&&e(i)}catch(t){throw i.preventDefault(),t}i.defaultPrevented||0===i.button&&(i.currentTarget instanceof HTMLAnchorElement&&""!==i.currentTarget.target&&"_self"!==i.currentTarget.target||i.metaKey||i.altKey||i.ctrlKey||i.shiftKey||(i.preventDefault(),Array.isArray(t)?a.push(...t):a.push(t)))}),[a,e,t])}},343:function(t,e,a){"use strict";a.d(e,"a",(function(){return o})),a.d(e,"b",(function(){return s})),a.d(e,"d",(function(){return r})),a.d(e,"c",(function(){return c})),a.d(e,"e",(function(){return d}));var i=a(107),n=a(106);const o=()=>({field:i.b.HASH,operator:"included",type:"match",value:""}),s=()=>({name:"",os:i.f.WINDOWS,entries:[o()],description:"",effectScope:{type:"global"}}),r=()=>({confirmed:!1,submissionResourceState:{type:"UninitialisedResourceState"}}),c=()=>({confirmed:!1,submissionResourceState:{type:"UninitialisedResourceState"}}),d=()=>({entriesExist:{type:"UninitialisedResourceState"},listView:{listResourceState:{type:"UninitialisedResourceState"},freshDataTimestamp:Date.now()},deletionDialog:r(),creationDialog:c(),policies:{type:"UninitialisedResourceState"},location:{page_index:n.b,page_size:n.c,show:void 0,id:void 0,view_type:"grid",filter:"",included_policies:"",excluded_policies:""},active:!1,forceRefresh:!1})},409:function(t,e,a){"use strict";a.d(e,"b",(function(){return n})),a.d(e,"a",(function(){return s}));var i=a(19);const n=(t,e)=>{if(!t)return"";return`(${e.map((e=>`exception-list-agnostic.attributes.${e}:(*${t.trim().replace(/([\)\(\<\>\}\{\"\:\\])/gm,"\\$&").replace(/\s/gm,"*")}*)`)).join(" OR ")})`},o=t=>"global"===t?'exception-list-agnostic.attributes.tags:"policy:all"':"unassigned"===t?"(not exception-list-agnostic.attributes.tags:*)":`exception-list-agnostic.attributes.tags:"policy:${t}"`,s=(t,e)=>{if(Object(i.isEmpty)(t)&&Object(i.isEmpty)(e))return"";const a=t?t.split(","):void 0,n=e?e.split(","):void 0,s=a?a.map(o).join(" OR "):"",r=n?n.map((t=>`not ${o(t)}`)).join(" AND "):"",c=[];return s&&c.push(s),r&&c.push(r),`(${c.join(" AND ")})`}},487:function(t,e,a){"use strict";a.d(e,"b",(function(){return r})),a.d(e,"a",(function(){return c}));var i=a(212),n=a.n(i),o=a(61),s=a.n(o);const r=(t,e)=>null!=e&&!(t.id===e.endpoint.id&&e.agent.configured.id===e.agent.applied.id&&t.version>=e.agent.applied.revision&&t.version>=e.agent.configured.revision&&t.endpoint_policy_version>=e.endpoint.revision),c=({startDate:t,endDate:e})=>{const a=s()(n.a.parse(t)),i=s()(n.a.parse(e));return!(!a.isValid()||!i.isValid())&&a.isAfter(i)}},521:function(t,e,a){"use strict";a.d(e,"a",(function(){return EventFiltersHttpService}));var i=a(7),n=a.n(i),o=a(137),s=a(286);class EventFiltersHttpService{constructor(t){n()(this,"listHasBeenCreated",void 0),this.http=t,this.listHasBeenCreated=!1}async createEndpointEventList(){try{await this.http.post(s.e,{body:JSON.stringify(s.b)}),this.listHasBeenCreated=!0}catch(t){if(409!==t.response.status)throw t;this.listHasBeenCreated=!0}}async httpWrapper(){return this.listHasBeenCreated||await this.createEndpointEventList(),this.http}async getList({perPage:t,page:e,sortField:a,sortOrder:i,filter:n}={}){return(await this.httpWrapper()).get(`${s.d}/_find`,{query:{page:e,per_page:t,sort_field:a,sort_order:i,list_id:[o.b],namespace_type:["agnostic"],filter:n}})}async addEventFilters(t){return(await this.httpWrapper()).post(s.d,{body:JSON.stringify(t)})}async getOne(t){return(await this.httpWrapper()).get(s.d,{query:{id:t,namespace_type:"agnostic"}})}async updateOne(t){return(await this.httpWrapper()).put(s.d,{body:JSON.stringify(t)})}async deleteOne(t){return(await this.httpWrapper()).delete(s.d,{query:{id:t,namespace_type:"agnostic"}})}async getSummary(){return(await this.httpWrapper()).get(`${s.e}/summary`,{query:{list_id:o.b,namespace_type:"agnostic"}})}}},695:function(t,e,a){"use strict";a.d(e,"b",(function(){return d})),a.d(e,"a",(function(){return l}));var i=a(9),n=a.n(i),o=a(55),s=a(696),r=a(334),c=a(90);let d;!function(t){t.overview="details",t.activityLog="activity_log"}(d||(d={}));const p=Object(i.memo)((({tab:t,isSelected:e})=>{const{getAppUrl:a}=Object(c.d)(),i=Object(r.a)(t.route);return n.a.createElement(o.EuiTab,{href:a({path:t.route}),onClick:i,isSelected:e,key:t.id,"data-test-subj":t.id},t.name)}));p.displayName="EndpointDetailsTab";const l=Object(i.memo)((({hostname:t,show:e,tabs:a})=>{const r=Object(i.useMemo)((()=>a.find((t=>t.id===e))),[a,e]),c=a.map((t=>n.a.createElement(p,{key:t.id,tab:t,isSelected:t.id===(null==r?void 0:r.id)})));return n.a.createElement(n.a.Fragment,null,n.a.createElement(s.a,{hostname:t,hasBorder:!0},n.a.createElement(o.EuiSpacer,{size:"s"}),n.a.createElement(o.EuiTabs,{style:{marginBottom:"-25px"}},c)),n.a.createElement(o.EuiFlyoutBody,{"data-test-subj":"endpointDetailsFlyoutBody"},null==r?void 0:r.content))}));l.displayName="EndpointDetailsFlyoutTabs"},696:function(t,e,a){"use strict";a.d(e,"a",(function(){return c}));var i=a(9),n=a.n(i),o=a(55),s=a(170),r=a(153);const c=Object(i.memo)((({hasBorder:t=!1,hostname:e,children:a})=>{const i=Object(s.b)(r.detailsLoading);return n.a.createElement(o.EuiFlyoutHeader,{hasBorder:t},i?n.a.createElement(o.EuiLoadingContent,{lines:1}):n.a.createElement(o.EuiToolTip,{content:e,anchorClassName:"eui-textTruncate"},n.a.createElement(o.EuiTitle,null,n.a.createElement("h2",{style:{overflow:"hidden",textOverflow:"ellipsis"},"data-test-subj":"endpointDetailsFlyoutTitle"},e))),a)}));c.displayName="EndpointDetailsFlyoutHeader"},746:function(t,e,a){"use strict";a.d(e,"a",(function(){return r}));var i=a(9),n=a.n(i),o=a(91),s=a(16);const r=Object(i.memo)((({children:t})=>{const e=Object(o.useDispatch)();return Object(i.useEffect)((()=>{var t;const a=null===(t=s.a.getLicenseInformation$())||void 0===t?void 0:t.subscribe((t=>{e({type:"licenseChanged",payload:t})}));return()=>null==a?void 0:a.unsubscribe()}),[e]),n.a.createElement(n.a.Fragment,null,t)}));r.displayName="CurrentLicense"},747:function(t,e,a){"use strict";a.d(e,"a",(function(){return i}));const i=["name","description","item_id","entries.value","entries.entries.value"]},754:function(t,e,a){"use strict";a.d(e,"a",(function(){return D}));var i=a(210),n=a(755),o=a(106),s=a(153),r=a(181);const c=()=>({hosts:[],pageSize:10,pageIndex:0,total:0,loading:!1,error:void 0,endpointDetails:{activityLog:{paging:{disabled:!1,page:1,pageSize:50,startDate:"now-1d",endDate:"now",isInvalidDateRange:!1,autoRefreshOptions:{enabled:!1,duration:o.a},recentlyUsedDateRanges:[]},logData:Object(r.d)()},hostDetails:{details:void 0,detailsLoading:!1,detailsError:void 0}},policyResponse:void 0,policyResponseLoading:!1,policyResponseError:void 0,location:void 0,policyItems:[],selectedPolicyId:void 0,policyItemsLoading:!1,endpointPackageInfo:Object(r.d)(),nonExistingPolicies:{},agentPolicies:{},endpointsExist:!0,patterns:[],patternsError:void 0,isAutoRefreshEnabled:!0,autoRefreshInterval:o.a,agentsWithEndpointsTotal:0,agentsWithEndpointsTotalError:void 0,endpointsTotal:0,endpointsTotalError:void 0,policyVersionInfo:void 0,hostStatus:void 0,isolationRequestState:Object(r.d)(),endpointPendingActions:Object(r.b)(new Map),metadataTransformStats:Object(r.d)()}),d=(t,e)=>({...t,isolationRequestState:e.payload});var p=a(343),l=a(219),u=a(21),y=a(101),g=a(254);const b=(t,e)=>{if(a=e.payload,null!==Object(u.matchPath)(null!==(i=a.pathname)&&void 0!==i?i:"",{path:o.l,exact:!0})){return{...t,active:!0,location:Object(y.e)(Object(l.parse)(e.payload.search.slice(1)))}}return Object(p.e)();var a,i},f=()=>({entries:[],form:{entry:void 0,hasNameError:!1,hasItemsError:!1,hasOSError:!1,newComment:"",submissionResourceState:Object(r.d)()},location:{page_index:o.b,page_size:o.c,filter:""},listPage:{active:!1,forceRefresh:!1,data:Object(r.d)(),dataExist:Object(r.d)(),deletion:{item:void 0,status:Object(r.d)()}}});var h=a(220),v=a(246);const O=(t,e)=>{if(a=e.payload,null!==Object(u.matchPath)(null!==(i=a.pathname)&&void 0!==i?i:"",{path:o.f,exact:!0})){const a=Object(y.a)(Object(l.parse)(e.payload.search.slice(1)));return{...t,location:a,listPage:{...t.listPage,active:!0}}}if(t.listPage.active){const{listPage:e}=f();return{...t,listPage:e}}return t;var a,i},j=()=>({entries:Object(r.d)(),location:{page_index:o.b,page_size:o.c,filter:""},form:{entry:void 0,status:Object(r.d)()},deletion:{item:void 0,status:Object(r.d)()}}),m=(t,e)=>{if(a=e.payload,null!==Object(u.matchPath)(null!==(i=a.pathname)&&void 0!==i?i:"",{path:o.g,exact:!0})){const a=Object(y.b)(Object(l.parse)(e.payload.search.slice(1)));return{...t,location:a}}var a,i;return t},S=i.combineReducers,D=(o.q,Object(n.a)(),o.m,c(),o.r,Object(p.e)(),o.n,f(),o.p,j(),S({[o.q]:n.c,[o.m]:(t=c(),e)=>{if("serverReturnedEndpointList"===e.type){const{hosts:a,total:i,request_page_size:n,request_page_index:o,policy_info:s}=e.payload;return{...t,hosts:a,total:i,pageSize:n,pageIndex:o,policyVersionInfo:s,loading:!1,error:void 0}}if("serverFailedToReturnEndpointList"===e.type)return{...t,error:e.payload,loading:!1};if("serverReturnedEndpointNonExistingPolicies"===e.type)return{...t,nonExistingPolicies:{...t.nonExistingPolicies,...e.payload}};if("serverReturnedEndpointAgentPolicies"===e.type)return{...t,agentPolicies:{...t.agentPolicies,...e.payload}};if("serverReturnedMetadataPatterns"===e.type)return{...t,patterns:e.payload,patternsError:void 0};if("serverFailedToReturnMetadataPatterns"===e.type)return{...t,patternsError:e.payload};if("serverReturnedEndpointDetails"===e.type)return{...t,endpointDetails:{...t.endpointDetails,hostDetails:{...t.endpointDetails.hostDetails,details:e.payload.metadata,detailsLoading:!1,detailsError:void 0}},policyVersionInfo:e.payload.policy_info,hostStatus:e.payload.host_status};if("serverFailedToReturnEndpointDetails"===e.type)return{...t,endpointDetails:{...t.endpointDetails,hostDetails:{...t.endpointDetails.hostDetails,detailsError:e.payload,detailsLoading:!1}}};if("endpointDetailsActivityLogUpdatePaging"===e.type||"endpointDetailsActivityLogUpdateIsInvalidDateRange"===e.type||"userUpdatedActivityLogRefreshOptions"===e.type)return{...t,endpointDetails:{...t.endpointDetails,activityLog:{...t.endpointDetails.activityLog,paging:{...t.endpointDetails.activityLog.paging,...e.payload}}}};if("userUpdatedActivityLogRecentlyUsedDateRanges"===e.type)return{...t,endpointDetails:{...t.endpointDetails,activityLog:{...t.endpointDetails.activityLog,paging:{...t.endpointDetails.activityLog.paging,recentlyUsedDateRanges:e.payload}}}};if("endpointDetailsActivityLogChanged"===e.type)return((t,e)=>{const a="LoadedResourceState"===e.payload.type?{...t.endpointDetails.activityLog,paging:{...t.endpointDetails.activityLog.paging,page:e.payload.data.page,pageSize:e.payload.data.pageSize,startDate:e.payload.data.startDate,endDate:e.payload.data.endDate}}:{...t.endpointDetails.activityLog};return{...t,endpointDetails:{...t.endpointDetails,activityLog:{...a,logData:e.payload}}}})(t,e);if("endpointPendingActionsStateChanged"===e.type)return((t,e)=>Object(s.isOnEndpointPage)(t)?{...t,endpointPendingActions:e.payload}:t)(t,e);if("serverReturnedPoliciesForOnboarding"===e.type)return{...t,policyItems:e.payload.policyItems,policyItemsLoading:!1};if("serverFailedToReturnPoliciesForOnboarding"===e.type)return{...t,error:e.payload,policyItemsLoading:!1};if("serverReturnedEndpointPolicyResponse"===e.type)return{...t,policyResponse:e.payload.policy_response,policyResponseLoading:!1,policyResponseError:void 0};if("serverFailedToReturnEndpointPolicyResponse"===e.type)return{...t,policyResponseError:e.payload,policyResponseLoading:!1};if("userSelectedEndpointPolicy"===e.type)return{...t,selectedPolicyId:e.payload.selectedPolicyId,policyResponseLoading:!1};if("serverCancelledEndpointListLoading"===e.type)return{...t,loading:!1};if("serverCancelledPolicyItemsLoading"===e.type)return{...t,policyItemsLoading:!1};if("endpointPackageInfoStateChanged"===e.type)return((t,e)=>({...t,endpointPackageInfo:e.payload}))(t,e);if("serverReturnedEndpointExistValue"===e.type)return{...t,endpointsExist:e.payload};if("serverReturnedAgenstWithEndpointsTotal"===e.type)return{...t,agentsWithEndpointsTotal:e.payload,agentsWithEndpointsTotalError:void 0};if("serverFailedToReturnAgenstWithEndpointsTotal"===e.type)return{...t,agentsWithEndpointsTotalError:e.payload};if("serverReturnedEndpointsTotal"===e.type)return{...t,endpointsTotal:e.payload,endpointsTotalError:void 0};if("serverFailedToReturnEndpointsTotal"===e.type)return{...t,endpointsTotalError:e.payload};var a,i;if("userUpdatedEndpointListRefreshOptions"===e.type)return{...t,isAutoRefreshEnabled:null!==(a=e.payload.isAutoRefreshEnabled)&&void 0!==a?a:t.isAutoRefreshEnabled,autoRefreshInterval:null!==(i=e.payload.autoRefreshInterval)&&void 0!==i?i:t.autoRefreshInterval};if("endpointIsolationRequestStateChange"===e.type)return d(t,e);if("userChangedUrl"===e.type){const a={...t,location:e.payload},i=Object(s.isOnEndpointPage)(a)&&!Object(s.hasSelectedEndpoint)(a),n=Object(s.isOnEndpointPage)(t)&&!Object(s.hasSelectedEndpoint)(t),c=Object(s.isOnEndpointPage)(a)&&Object(s.hasSelectedEndpoint)(a),d=Object(s.isOnEndpointPage)(t)&&Object(s.hasSelectedEndpoint)(t),p=Object(s.isOnEndpointPage)(t)&&Object(s.hasSelectedEndpoint)(t)&&Object(s.getIsOnEndpointDetailsActivityLog)(t),l=Object(s.isOnEndpointPage)(a)&&Object(s.hasSelectedEndpoint)(a)&&Object(s.getIsOnEndpointDetailsActivityLog)(a)||p&&Object(s.uiQueryParams)(t).selected_endpoint===Object(s.uiQueryParams)(a).selected_endpoint,u={location:e.payload,error:void 0,policyResponseError:void 0},y={logData:Object(r.d)(),paging:{disabled:!1,isInvalidDateRange:!1,page:1,pageSize:50,startDate:"now-1d",endDate:"now",autoRefreshOptions:{enabled:!1,duration:o.a},recentlyUsedDateRanges:[]}};if("isolate"===Object(s.uiQueryParams)(a).show||Object(r.i)(Object(s.getCurrentIsolationRequestState)(a))||(u.isolationRequestState=Object(r.d)()),i){if(!n)return{...t,...u,endpointDetails:{...t.endpointDetails,activityLog:{...y,paging:{...y.paging,startDate:t.endpointDetails.activityLog.paging.startDate,endDate:t.endpointDetails.activityLog.paging.endDate,recentlyUsedDateRanges:t.endpointDetails.activityLog.paging.recentlyUsedDateRanges}},hostDetails:{...t.endpointDetails.hostDetails,detailsError:void 0}},loading:!0,policyItemsLoading:!0}}else if(c)return d||n?{...t,...u,endpointDetails:{...t.endpointDetails,activityLog:{...y,paging:{...y.paging,startDate:t.endpointDetails.activityLog.paging.startDate,endDate:t.endpointDetails.activityLog.paging.endDate,recentlyUsedDateRanges:t.endpointDetails.activityLog.paging.recentlyUsedDateRanges}},hostDetails:{...t.endpointDetails.hostDetails,detailsLoading:!l,detailsError:void 0}},detailsLoading:!0,policyResponseLoading:!0}:{...t,...u,endpointDetails:{...t.endpointDetails,activityLog:{...y,paging:{...y.paging,startDate:t.endpointDetails.activityLog.paging.startDate,endDate:t.endpointDetails.activityLog.paging.endDate,recentlyUsedDateRanges:t.endpointDetails.activityLog.paging.recentlyUsedDateRanges}},hostDetails:{...t.endpointDetails.hostDetails,detailsLoading:!0,detailsError:void 0}},loading:!0,policyResponseLoading:!0,policyItemsLoading:!0};return{...t,...u,endpointDetails:{...t.endpointDetails,activityLog:{...y,paging:{...y.paging,startDate:t.endpointDetails.activityLog.paging.startDate,endDate:t.endpointDetails.activityLog.paging.endDate,recentlyUsedDateRanges:t.endpointDetails.activityLog.paging.recentlyUsedDateRanges}},hostDetails:{...t.endpointDetails.hostDetails,detailsError:void 0}},endpointsExist:!0}}return"metadataTransformStatsChanged"===e.type?((t,e)=>({...t,metadataTransformStats:e.payload}))(t,e):t},[o.r]:(t=Object(p.e)(),e)=>{switch(e.type){case"trustedAppsListDataOutdated":return((t,e)=>({...t,listView:{...t.listView,freshDataTimestamp:Date.now()}}))(t);case"trustedAppsListResourceStateChanged":return((t,e)=>({...t,listView:{...t.listView,listResourceState:e.payload.newState}}))(t,e);case"trustedAppDeletionSubmissionResourceStateChanged":return((t,e)=>({...t,deletionDialog:{...t.deletionDialog,submissionResourceState:e.payload.newState}}))(t,e);case"trustedAppDeletionDialogStarted":return((t,e)=>({...t,deletionDialog:{...Object(p.d)(),...e.payload}}))(t,e);case"trustedAppDeletionDialogConfirmed":return(t=>({...t,deletionDialog:{...t.deletionDialog,confirmed:!0}}))(t);case"trustedAppDeletionDialogClosed":return(t=>({...t,deletionDialog:Object(p.d)()}))(t);case"trustedAppCreationSubmissionResourceStateChanged":return((t,e)=>({...t,creationDialog:{...t.creationDialog,submissionResourceState:e.payload.newState}}))(t,e);case"trustedAppCreationDialogStarted":return((t,e)=>({...t,creationDialog:{...Object(p.c)(),formState:{...e.payload,isValid:!1}}}))(t,e);case"trustedAppCreationDialogFormStateUpdated":return((t,e)=>({...t,creationDialog:{...t.creationDialog,formState:{...e.payload}}}))(t,e);case"trustedAppCreationEditItemStateChanged":return((t,e)=>({...t,creationDialog:{...t.creationDialog,editItem:e.payload}}))(t,e);case"trustedAppCreationDialogConfirmed":return(t=>({...t,creationDialog:{...t.creationDialog,confirmed:!0}}))(t);case"trustedAppCreationDialogClosed":return(t=>({...t,creationDialog:Object(p.c)()}))(t);case"userChangedUrl":return b(t,e);case"trustedAppsExistStateChanged":return((t,{payload:e})=>Object(g.g)(t)!==e?{...t,entriesExist:e}:t)(t,e);case"trustedAppsPoliciesStateChanged":return((t,{payload:e})=>Object(g.Q)(t)?{...t,policies:e}:t)(t,e);case"trustedAppForceRefresh":return((t,{payload:e})=>({...t,forceRefresh:e.forceRefresh}))(t,e)}return t},[o.n]:(t=f(),e)=>{switch(e.type){case"eventFiltersInitForm":return((t,e)=>{var a;return{...t,form:{...t.form,entry:e.payload.entry,hasNameError:!e.payload.entry.name,hasOSError:!(null!==(a=e.payload.entry.os_types)&&void 0!==a&&a.length),newComment:"",submissionResourceState:{type:"UninitialisedResourceState"}}}})(t,e);case"eventFiltersChangeForm":return((t,e)=>({...t,form:{...t.form,entry:void 0!==e.payload.entry?e.payload.entry:t.form.entry,hasItemsError:void 0!==e.payload.hasItemsError?e.payload.hasItemsError:t.form.hasItemsError,hasNameError:void 0!==e.payload.hasNameError?e.payload.hasNameError:t.form.hasNameError,hasOSError:void 0!==e.payload.hasOSError?e.payload.hasOSError:t.form.hasOSError,newComment:void 0!==e.payload.newComment?e.payload.newComment:t.form.newComment}}))(t,e);case"eventFiltersFormStateChanged":return((t,e)=>({...t,form:{...t.form,entry:Object(h.h)(e.payload)?void 0:t.form.entry,newComment:Object(h.h)(e.payload)?"":t.form.newComment,submissionResourceState:e.payload}}))(t,e);case"eventFiltersCreateSuccess":case"eventFiltersUpdateSuccess":return((t,e)=>({...t,listPage:Object(v.p)(t)?{...t.listPage,forceRefresh:!0}:t.listPage}))(t);case"userChangedUrl":return O(t,e);case"eventFiltersForceRefresh":return((t,e)=>({...t,listPage:{...t.listPage,forceRefresh:e.payload.forceRefresh}}))(t,e)}if(Object(v.p)(t))switch(e.type){case"eventFiltersListPageDataChanged":return((t,e)=>({...t,listPage:{...t.listPage,forceRefresh:!1,data:e.payload}}))(t,e);case"eventFiltersListPageDataExistsChanged":return((t,e)=>({...t,listPage:{...t.listPage,dataExist:e.payload}}))(t,e);case"eventFilterForDeletion":return((t,e)=>({...t,listPage:{...t.listPage,deletion:{...t.listPage.deletion,item:e.payload}}}))(t,e);case"eventFilterDeletionReset":return(t=>({...t,listPage:{...t.listPage,deletion:f().listPage.deletion}}))(t);case"eventFilterDeleteStatusChanged":return((t,e)=>({...t,listPage:{...t.listPage,forceRefresh:!!Object(h.d)(e.payload)||t.listPage.forceRefresh,deletion:{...t.listPage.deletion,status:e.payload}}}))(t,e)}return t},[o.p]:(t=j(),e)=>{switch(e.type){case"hostIsolationExceptionsCreateEntry":return{...t,form:{entry:e.payload,status:Object(r.d)()}};case"hostIsolationExceptionsFormStateChanged":return{...t,form:{...t.form,status:e.payload}};case"hostIsolationExceptionsFormEntryChanged":return{...t,form:{...t.form,entry:e.payload}};case"hostIsolationExceptionsPageDataChanged":return{...t,entries:e.payload};case"userChangedUrl":return m(t,e);case"hostIsolationExceptionsMarkToDelete":return{...t,deletion:{item:e.payload,status:Object(r.d)()}};case"hostIsolationExceptionsDeleteStatusChanged":return{...t,deletion:{...t.deletion,status:e.payload}}}return t}}))},755:function(t,e,a){"use strict";a.d(e,"b",(function(){return v})),a.d(e,"c",(function(){return L})),a.d(e,"a",(function(){return S}));var i=a(19),n=a(136),o=a(181),s=a(409),r=a(747);const c=async(t,e,a)=>{const c=t.getState(),d=Object(n.L)(c);t.dispatch({type:"policyArtifactsAssignableListPageDataChanged",payload:Object(o.c)({previousState:Object(o.d)()})});try{const c=[`(not exception-list-agnostic.attributes.tags:"policy:${d}") AND (not exception-list-agnostic.attributes.tags:"policy:all")`];if(a){const t=Object(s.b)(a,r.a)||void 0;t&&c.push(t)}const p=await e.getTrustedAppsList({page:1,per_page:100,kuery:c.join(" AND ")});t.dispatch({type:"policyArtifactsAssignableListPageDataChanged",payload:Object(o.b)(p)}),Object(i.isEmpty)(p.data)&&(async(t,e)=>{const a=t.getState(),s=Object(n.L)(a);t.dispatch({type:"policyArtifactsAssignableListExistDataChanged",payload:Object(o.c)({previousState:Object(o.d)()})});try{const a=await e.getTrustedAppsList({page:1,per_page:100,kuery:`(not exception-list-agnostic.attributes.tags:"policy:${s}") AND (not exception-list-agnostic.attributes.tags:"policy:all")`});t.dispatch({type:"policyArtifactsAssignableListExistDataChanged",payload:Object(o.b)(!Object(i.isEmpty)(a.data))})}catch(e){var r;t.dispatch({type:"policyArtifactsAssignableListExistDataChanged",payload:Object(o.a)(null!==(r=e.body)&&void 0!==r?r:e)})}})(t,e)}catch(e){var p;t.dispatch({type:"policyArtifactsAssignableListPageDataChanged",payload:Object(o.a)(null!==(p=e.body)&&void 0!==p?p:e)})}},d=async(t,e,a)=>{const i=t.getState(),s=Object(n.L)(i);t.dispatch({type:"policyArtifactsUpdateTrustedAppsChanged",payload:Object(o.c)({previousState:Object(o.d)()})});try{const i=await e.assignPolicyToTrustedApps(s,a);t.dispatch({type:"policyArtifactsUpdateTrustedAppsChanged",payload:Object(o.b)(i)}),t.dispatch({type:"policyDetailsTrustedAppsForceListDataRefresh"})}catch(e){var r;t.dispatch({type:"policyArtifactsUpdateTrustedAppsChanged",payload:Object(o.a)(null!==(r=e.body)&&void 0!==r?r:e)})}},p=async({trustedAppsService:t},{getState:e,dispatch:a},s=!1)=>{const r=e();if(!Object(n.G)(r)&&(s||Object(n.d)(r))){a({type:"assignedTrustedAppsListStateChanged",payload:Object(o.c)(Object(n.k)(r))});try{const s=Object(n.m)(r),c=Object(n.L)(r),d=await t.getTrustedAppsList({page:s.page_index+1,per_page:s.page_size,kuery:`((exception-list-agnostic.attributes.tags:"policy:${c}") OR (exception-list-agnostic.attributes.tags:"policy:all"))${s.filter?` AND (${s.filter})`:""}`});a({type:"assignedTrustedAppsListStateChanged",payload:Object(o.b)({location:s,artifacts:d})}),d.total||await(async(t,e)=>{const a=t.getState();if(!Object(n.n)(a)){t.dispatch({type:"policyArtifactsDeosAnyTrustedAppExists",payload:Object(o.c)({previousState:Object(o.d)()})});try{const a=await e.getTrustedAppsList({page:1,per_page:100});t.dispatch({type:"policyArtifactsDeosAnyTrustedAppExists",payload:Object(o.b)(!Object(i.isEmpty)(a.data))})}catch(e){var s;t.dispatch({type:"policyArtifactsDeosAnyTrustedAppExists",payload:Object(o.a)(null!==(s=e.body)&&void 0!==s?s:e)})}}})({getState:e,dispatch:a},t)}catch(t){a({type:"assignedTrustedAppsListStateChanged",payload:Object(o.a)(t,Object(n.p)(e()))})}}},l=async({trustedAppsService:t},{getState:e,dispatch:a})=>{const i=e(),s=Object(n.v)(i),r=Object(o.h)(s),c=!Object(o.i)(s);if(!r&&!c){a({type:"policyDetailsListOfAllPoliciesStateChanged",payload:Object(o.c)(s)});try{const e=await t.getPolicyList({query:{page:1,perPage:1e3}});a({type:"policyDetailsListOfAllPoliciesStateChanged",payload:Object(o.b)(e)})}catch(t){a({type:"policyDetailsListOfAllPoliciesStateChanged",payload:Object(o.a)(t.body||t)})}}},u=async({trustedAppsService:t},{getState:e,dispatch:a},i)=>{const s=e();if(!Object(n.u)(s)){a({type:"policyDetailsTrustedAppsRemoveListStateChanged",payload:Object(o.c)(Object(n.l)(s))});try{var r;const e=null===(r=Object(n.H)(s))||void 0===r?void 0:r.id;if(!e)throw new Error("current policy id not found");const c=await t.removePolicyFromTrustedApps(e,i);a({type:"policyDetailsTrustedAppsRemoveListStateChanged",payload:Object(o.b)({artifacts:i,response:c})}),a({type:"policyDetailsTrustedAppsForceListDataRefresh"})}catch(t){a({type:"policyDetailsTrustedAppsRemoveListStateChanged",payload:Object(o.a)(t.body||t)})}}};var y=a(407),g=a(418),b=a(344),f=a(786);var h=a(345);const v=t=>e=>a=>async i=>{a(i);const o=new h.a(t.http),s={coreStart:t,trustedAppsService:o};(async({coreStart:t},{dispatch:e,getState:a},i)=>{const n=t.http,o=a();if("userChangedUrl"===i.type&&Object(g.i)(o)&&Object(g.f)(o)){const t=Object(g.m)(o);let a;try{a=(await Object(b.f)(n,t)).item,""===a.inputs[0].config.policy.value.windows.popup.malware.message&&(a.inputs[0].config.policy.value.windows.popup.malware.message=y.a,a.inputs[0].config.policy.value.mac.popup.malware.message=y.a,a.inputs[0].config.policy.value.linux.popup.malware.message=y.a),""===a.inputs[0].config.policy.value.windows.popup.ransomware.message&&(a.inputs[0].config.policy.value.windows.popup.ransomware.message=y.a),""===a.inputs[0].config.policy.value.windows.popup.memory_protection.message&&(a.inputs[0].config.policy.value.windows.popup.memory_protection.message=y.b),""===a.inputs[0].config.policy.value.mac.popup.memory_protection.message&&(a.inputs[0].config.policy.value.mac.popup.memory_protection.message=y.b),""===a.inputs[0].config.policy.value.linux.popup.memory_protection.message&&(a.inputs[0].config.policy.value.linux.popup.memory_protection.message=y.b),""===a.inputs[0].config.policy.value.windows.popup.behavior_protection.message&&(a.inputs[0].config.policy.value.windows.popup.behavior_protection.message=y.b),""===a.inputs[0].config.policy.value.mac.popup.behavior_protection.message&&(a.inputs[0].config.policy.value.mac.popup.behavior_protection.message=y.b),""===a.inputs[0].config.policy.value.linux.popup.behavior_protection.message&&(a.inputs[0].config.policy.value.linux.popup.behavior_protection.message=y.b)}catch(t){return void e({type:"serverFailedToReturnPolicyDetailsData",payload:t.body||t})}if(e({type:"serverReturnedPolicyDetailsData",payload:{policyItem:a}}),a.policy_id){const{results:t}=await Object(b.d)(n,a.policy_id);e({type:"serverReturnedPolicyDetailsAgentSummaryData",payload:{agentStatusSummary:t}})}}else if("userClickedPolicyDetailsSaveButton"===i.type){const{id:t}=Object(g.k)(o),a=Object(g.l)(o);let i;try{i=await Object(b.g)(n,t,a).catch((e=>e.response&&409===e.response.status?Object(b.f)(n,t).then((e=>{const i=e.item;return i.inputs[0].config.policy=a.inputs[0].config.policy,Object(b.g)(n,t,Object(f.a)(i))})):Promise.reject(e)))}catch(t){return void e({type:"serverReturnedPolicyDetailsUpdateFailure",payload:{success:!1,error:t.body||t}})}e({type:"serverReturnedUpdatedPolicyDetailsData",payload:{policyItem:i.item,updateStatus:{success:!0}}})}})(s,e,i),(async(t,e,a)=>{const i=e.getState();if(!Object(n.F)(i))return;const{trustedAppsService:o}=t;switch(a.type){case"userChangedUrl":p(t,e),l(t,e),"userChangedUrl"===a.type&&"list"===Object(n.j)(i).show&&await c(e,o);break;case"policyDetailsTrustedAppsForceListDataRefresh":p(t,e,!0);break;case"policyArtifactsUpdateTrustedApps":"list"===Object(n.j)(i).show&&"assign"===a.payload.action?await d(e,o,a.payload.artifacts):"remove"===a.payload.action&&u(t,e,a.payload.artifacts);break;case"policyArtifactsAssignableListPageDataFilter":"list"===Object(n.j)(i).show&&await c(e,o,a.payload.filter)}})(s,e,i)};var O=a(219),j=a(101),m=a(106);const S=()=>({policyItem:void 0,isLoading:!1,agentStatusSummary:{error:0,events:0,offline:0,online:0,total:0,other:0},artifacts:{location:{page_index:m.b,page_size:m.c,show:void 0,filter:""},assignableList:Object(o.d)(),trustedAppsToUpdate:Object(o.d)(),assignableListEntriesExist:Object(o.d)(),doesAnyTrustedAppExists:Object(o.d)(),assignedList:Object(o.d)(),policies:Object(o.d)(),removeList:Object(o.d)()}}),D=(t,e)=>({...t,inputs:t.inputs.map((t=>({...t,config:t.config&&{...t.config,policy:{...t.config.policy,value:e}}})))}),E=(t=S(),e)=>{if("serverReturnedPolicyDetailsData"===e.type||"serverReturnedUpdatedPolicyDetailsData"===e.type)return{...t,...e.payload,isLoading:!1};if("serverFailedToReturnPolicyDetailsData"===e.type)return{...t,isLoading:!1,apiError:e.payload};if("serverReturnedPolicyDetailsAgentSummaryData"===e.type)return{...t,...e.payload};if("serverReturnedPolicyDetailsUpdateFailure"===e.type)return{...t,isLoading:!1,updateStatus:e.payload};if("userClickedPolicyDetailsSaveButton"===e.type)return{...t,isLoading:!0,updateApiError:void 0};if("licenseChanged"===e.type)return{...t,license:e.payload};if("userChangedUrl"===e.type){const a={...t,location:e.payload,artifacts:{...t.artifacts,location:Object(j.d)(Object(O.parse)(e.payload.search.slice(1)))}},i=Object(g.f)(a),n=Object(g.f)(t),o=Object(g.g)(a);return i?n?a:{...a,isLoading:!0}:{...S(),location:e.payload,license:o}}if("userChangedPolicyConfig"===e.type){if(!t.policyItem)return t;const a={...t,policyItem:{...t.policyItem}},i={...Object(g.c)(t)};return a.policyItem.inputs[0].config.policy.value=i,Object.entries(e.payload.policyConfig).forEach((([t,e])=>{i[t]={...i[t],...e}})),a}if("userChangedAntivirusRegistration"===e.type){if(t.policyItem){const a=Object(g.c)(t);return{...t,policyItem:D(t.policyItem,{...a,windows:{...a.windows,antivirus_registration:{enabled:e.payload.enabled}}})}}return t}return t},R=(t=S(),e)=>Object(n.F)(t)?"policyArtifactsAssignableListPageDataChanged"===e.type?{...t,artifacts:{...t.artifacts,assignableList:e.payload}}:"policyArtifactsUpdateTrustedAppsChanged"===e.type?{...t,artifacts:{...t.artifacts,trustedAppsToUpdate:e.payload}}:"policyArtifactsAssignableListExistDataChanged"===e.type?{...t,artifacts:{...t.artifacts,assignableListEntriesExist:e.payload}}:"policyArtifactsDeosAnyTrustedAppExists"===e.type?{...t,artifacts:{...null==t?void 0:t.artifacts,doesAnyTrustedAppExists:e.payload}}:"assignedTrustedAppsListStateChanged"===e.type?{...t,artifacts:{...null==t?void 0:t.artifacts,assignedList:e.payload}}:"policyDetailsListOfAllPoliciesStateChanged"===e.type?{...t,artifacts:{...t.artifacts,policies:e.payload}}:"policyDetailsTrustedAppsRemoveListStateChanged"===e.type?{...t,artifacts:{...t.artifacts,removeList:e.payload}}:"policyDetailsArtifactsResetRemove"===e.type?{...t,artifacts:{...t.artifacts,removeList:S().artifacts.removeList}}:t:Object(o.i)(Object(n.k)(t))?t:{...t,artifacts:S().artifacts},L=(t=S(),e)=>[E,R].reduce(((t,a)=>a(t,e)),t)},761:function(t,e,a){"use strict";a.d(e,"a",(function(){return at}));var i=a(110),n=a(106),o=a(755),s=a(1353),r=a.n(s),c=a(153),d=a(344),p=a(65),l=a(26),u=a(181),y=a(574),g=a(317),b=a(785),f=a(487),h=a(3);const v=console.error,O=(t,e)=>{async function a(t){var a;const i=null!==(a=Object(c.endpointPackageVersion)(t))&&void 0!==a?a:"",n=i.includes("-")?i.substring(0,i.indexOf("-")):i,o=r()(n,"1.2.0")?l.h:l.p,{indexPatterns:s}=e.data;return[{title:o,fields:await s.getFieldsForWildcard({pattern:o})}]}return e=>i=>async n=>{i(n);const{getState:o,dispatch:s}=e;if(await async function(t,e,a){if(!Object(c.getIsEndpointPackageInfoUninitialized)(t))return;e({type:"endpointPackageInfoStateChanged",payload:Object(u.c)(Object(c.endpointPackageInfo)(t))});try{const t=await Object(d.b)(a.http);e({type:"endpointPackageInfoStateChanged",payload:Object(u.b)(t)})}catch(t){v(t),e({type:"endpointPackageInfoStateChanged",payload:Object(u.a)(t)})}}(o(),s,t),"userChangedUrl"!==n.type&&"appRequestedEndpointList"!==n.type||!Object(c.isOnEndpointPage)(o())||Object(c.hasSelectedEndpoint)(o())||await async function({store:t,coreStart:e,fetchIndexPatterns:a}){const{getState:i,dispatch:n}=t,{page_index:o,page_size:s}=Object(c.uiQueryParams)(i());let r;try{const a=Object(c.searchBarQuery)(i());r=await e.http.post(l.e,{body:JSON.stringify({paging_properties:[{page_index:o},{page_size:s}],filters:{kql:a.query}})}),r.request_page_index=Number(o),n({type:"serverReturnedEndpointList",payload:r}),D(t);try{n({type:"serverReturnedEndpointsTotal",payload:await m(e.http)})}catch(t){n({type:"serverFailedToReturnEndpointsTotal",payload:t})}try{n({type:"serverReturnedAgenstWithEndpointsTotal",payload:(await Object(d.e)(e.http)).total})}catch(t){n({type:"serverFailedToReturnAgenstWithEndpointsTotal",payload:t})}R({http:e.http,hosts:r.hosts,store:t})}catch(t){n({type:"serverFailedToReturnEndpointList",payload:t})}if(0===Object(c.patterns)(i()).length)try{const t=await a(i());void 0!==t&&n({type:"serverReturnedMetadataPatterns",payload:t})}catch(t){n({type:"serverFailedToReturnMetadataPatterns",payload:t})}if(r&&0===r.hosts.length){const t=e.http;if(await(async t=>{try{return await m(t)>0}catch(t){v("error while trying to check if endpoints exist"),v(t)}return!1})(t))return;n({type:"serverReturnedEndpointExistValue",payload:!1});try{n({type:"serverReturnedPoliciesForOnboarding",payload:{policyItems:(await Object(d.c)(t,{query:{perPage:50,page:1}})).items}})}catch(t){var p;n({type:"serverFailedToReturnPoliciesForOnboarding",payload:null!==(p=t.body)&&void 0!==p?p:t})}}else n({type:"serverCancelledPolicyItemsLoading"}),n({type:"serverReturnedEndpointExistValue",payload:!0})}({coreStart:t,store:e,fetchIndexPatterns:a}),"userChangedUrl"===n.type&&Object(c.hasSelectedEndpoint)(o())){const{selected_endpoint:a}=Object(c.uiQueryParams)(o());await async function({coreStart:t,selectedEndpoint:e,store:a}){const{getState:i,dispatch:n}=a;if(n({type:"serverCancelledPolicyItemsLoading"}),0===Object(c.listData)(i()).length){const{page_index:e,page_size:o}=Object(c.uiQueryParams)(i());try{const i=await t.http.post(l.e,{body:JSON.stringify({paging_properties:[{page_index:e},{page_size:o}]})});i.request_page_index=Number(e),n({type:"serverReturnedEndpointList",payload:i}),R({http:t.http,hosts:i.hosts,store:a})}catch(t){n({type:"serverFailedToReturnEndpointList",payload:t})}}else n({type:"serverCancelledEndpointListLoading"});if(void 0===e)return;await E({store:a,coreStart:t,selectedEndpoint:e})}({store:e,coreStart:t,selectedEndpoint:a})}return"endpointDetailsLoad"===n.type&&await E({store:e,coreStart:t,selectedEndpoint:n.payload.endpointId}),"userChangedUrl"===n.type&&!0===Object(c.hasSelectedEndpoint)(o())&&Object(c.getIsOnEndpointDetailsActivityLog)(o())&&Object(c.getActivityLogIsUninitializedOrHasSubsequentAPIError)(o())&&await async function({store:t,coreStart:e}){const{getState:a,dispatch:i}=t;i({type:"endpointDetailsActivityLogChanged",payload:Object(u.c)(Object(c.getActivityLogData)(a()))});try{const{page:t,pageSize:n,startDate:o,endDate:s}=Object(c.getActivityLogDataPaging)(a()),r=Object(g.a)(l.c,{agent_id:Object(c.selectedAgent)(a())}),d=await e.http.get(r,{query:{page:t,page_size:n,start_date:o,end_date:s}});i({type:"endpointDetailsActivityLogChanged",payload:Object(u.b)(d)})}catch(t){var n;i({type:"endpointDetailsActivityLogChanged",payload:Object(u.a)(null!==(n=t.body)&&void 0!==n?n:t)})}}({store:e,coreStart:t}),"endpointDetailsActivityLogUpdatePaging"===n.type&&!Object(c.getActivityLogError)(o())&&Object(c.hasSelectedEndpoint)(o())&&await async function({store:t,coreStart:e}){const{getState:a,dispatch:i}=t;try{const{disabled:t,page:n,pageSize:o,startDate:s,endDate:r}=Object(c.getActivityLogDataPaging)(a());if(t)return;if(Object(f.a)({startDate:s,endDate:r}))return void i({type:"endpointDetailsActivityLogUpdateIsInvalidDateRange",payload:{isInvalidDateRange:!0}});i({type:"endpointDetailsActivityLogUpdateIsInvalidDateRange",payload:{isInvalidDateRange:!1}}),i({type:"endpointDetailsActivityLogChanged",payload:Object(u.c)(Object(c.getActivityLogData)(a()))});const d=Object(g.a)(l.c,{agent_id:Object(c.selectedAgent)(a())}),p=await e.http.get(d,{query:{page:n,page_size:o,start_date:s,end_date:r}}),y=Object(c.getLastLoadedActivityLogData)(a());if(void 0!==y){const t=[...new Set([...y.data,...p.data])].sort(((t,e)=>new Date(e.item.data["@timestamp"])>new Date(t.item.data["@timestamp"])?1:-1)),e={page:p.page,pageSize:p.pageSize,startDate:p.startDate,endDate:p.endDate,data:1===p.page?p.data:t};i({type:"endpointDetailsActivityLogChanged",payload:Object(u.b)(e)}),p.data.length||i({type:"endpointDetailsActivityLogUpdatePaging",payload:{disabled:!0,page:p.page>1?p.page-1:1,pageSize:p.pageSize,startDate:p.startDate,endDate:p.endDate}})}else i({type:"endpointDetailsActivityLogChanged",payload:Object(u.b)(p)})}catch(t){var n;i({type:"endpointDetailsActivityLogChanged",payload:Object(u.a)(null!==(n=t.body)&&void 0!==n?n:t)})}}({store:e,coreStart:t}),"endpointIsolationRequest"===n.type?S(e,n):"loadMetadataTransformStats"===n.type?async function(t,e){const{getState:a,dispatch:i}=e;if(!t||!a||!i)return;const n=a();if(Object(c.isMetadataTransformStatsLoading)(n))return;i({type:"metadataTransformStatsChanged",payload:Object(u.c)(Object(c.getMetadataTransformStats)(n))});try{const e=await t.get(h.ub);i({type:"metadataTransformStatsChanged",payload:Object(u.b)(e.transforms)})}catch(t){i({type:"metadataTransformStatsChanged",payload:Object(u.a)(t)})}}(t.http,e):void 0}},j=async(t,e,a)=>{if(0===e.length)return;const i=[...new Set(e.reduce(((t,e)=>{const i=e.metadata.Endpoint.policy.applied.id;return a[i]||t.push(i),t}),[]))];if(0===i.length)return;const n=(await Object(d.a)(t,{query:{kuery:`${p.AGENT_POLICY_SAVED_OBJECT_TYPE}.package_policies: (${i.join(" or ")})`}})).items.reduce(((t,e)=>(e.package_policies.forEach((a=>{t.packagePolicy[a]=!0,t.agentPolicy[a]=e.id})),t)),{packagePolicy:{},agentPolicy:{}}),o=i.reduce(((t,e)=>n.packagePolicy[e]?(t.agentPolicy[e]=n.agentPolicy[e],t):(t.packagePolicy[e]=!0,t)),{packagePolicy:{},agentPolicy:{}});return 0!==Object.keys(o.packagePolicy).length||0!==Object.keys(o.agentPolicy).length?o:void 0},m=async t=>{try{return(await t.post(l.e,{body:JSON.stringify({paging_properties:[{page_index:0},{page_size:1}]})})).total}catch(t){v("error while trying to check for total endpoints"),v(t)}return 0},S=async({getState:t,dispatch:e},a)=>{const i=t();if(!Object(c.getIsIsolationRequestPending)(i)){e({type:"endpointIsolationRequestStateChange",payload:Object(u.c)(Object(c.getCurrentIsolationRequestState)(i))});try{let t;t="unisolate"===a.payload.type?await Object(y.b)(a.payload.data):await Object(y.a)(a.payload.data),e({type:"endpointIsolationRequestStateChange",payload:Object(u.b)(t)})}catch(t){var n;e({type:"endpointIsolationRequestStateChange",payload:Object(u.a)(null!==(n=t.body)&&void 0!==n?n:t)})}}};const D=async({getState:t,dispatch:e})=>{const a=t(),i=Object(c.detailsData)(a),n=Object(c.listData)(a),o=new Set;i&&o.add(i.elastic.agent.id);for(const t of n)o.add(t.metadata.elastic.agent.id);if(0!==o.size)try{const{data:t}=await Object(b.a)(Array.from(o)),a=new Map;for(const e of t)a.set(e.agent_id,e.pending_actions);e({type:"endpointPendingActionsStateChanged",payload:Object(u.b)(a)})}catch(t){v(t)}};async function E({selectedEndpoint:t,store:e,coreStart:a}){const{getState:i,dispatch:n}=e;try{const e=await a.http.get(Object(g.a)(l.d,{id:t}));n({type:"serverReturnedEndpointDetails",payload:e});try{const t=await j(a.http,[e],Object(c.nonExistingPolicies)(i()));void 0!==t&&n({type:"serverReturnedEndpointNonExistingPolicies",payload:t.packagePolicy}),void 0!==(null==t?void 0:t.agentPolicy)&&n({type:"serverReturnedEndpointAgentPolicies",payload:t.agentPolicy})}catch(t){v(t)}}catch(t){n({type:"serverFailedToReturnEndpointDetails",payload:t})}D(e);try{n({type:"serverReturnedEndpointPolicyResponse",payload:await a.http.get(l.b,{query:{agentId:t}})})}catch(t){n({type:"serverFailedToReturnEndpointPolicyResponse",payload:t})}}async function R({store:t,hosts:e,http:a}){const{getState:i,dispatch:n}=t;try{const t=await j(a,e,Object(c.nonExistingPolicies)(i()));void 0!==(null==t?void 0:t.packagePolicy)&&n({type:"serverReturnedEndpointNonExistingPolicies",payload:t.packagePolicy}),void 0!==(null==t?void 0:t.agentPolicy)&&n({type:"serverReturnedEndpointAgentPolicies",payload:t.agentPolicy})}catch(t){v(t)}}var L=a(2),A=a(345),P=a(787),C=a(343),w=a(254),I=a(409),_=a(410),x=a(747);const F=t=>({type:"trustedAppsListResourceStateChanged",payload:{newState:t}}),T=t=>({type:"trustedAppCreationSubmissionResourceStateChanged",payload:{newState:t}}),k=t=>({type:"trustedAppDeletionSubmissionResourceStateChanged",payload:{newState:t}}),U=t=>e=>a=>async i=>{a(i),"userChangedUrl"!==i.type&&"trustedAppsListDataOutdated"!==i.type||(await(async(t,e)=>{if(Object(w.N)(t.getState())){t.dispatch({type:"trustedAppForceRefresh",payload:{forceRefresh:!1}}),t.dispatch(F({type:"LoadingResourceState",previousState:Object(w.x)(t.getState())}));try{const a=Object(w.o)(t.getState()),i=Object(w.p)(t.getState()),n=Object(w.m)(t.getState()),o=Object(w.n)(t.getState()),s=Object(w.l)(t.getState()),r=[],c=Object(I.b)(n,x.a)||void 0;c&&r.push(c);const d=Object(I.a)(o,s)||void 0;d&&r.push(d);const p=await e.getTrustedAppsList({page:a+1,per_page:i,kuery:r.join(" AND ")||void 0});t.dispatch(F({type:"LoadedResourceState",data:{items:p.data,pageIndex:a,pageSize:i,totalItemsCount:p.total,timestamp:Date.now(),filter:n,includedPolicies:o,excludedPolicies:s}}))}catch(e){t.dispatch(F({type:"FailedResourceState",error:e.body,lastLoadedState:Object(w.t)(t.getState())}))}}})(e,t),await(async(t,e)=>{const a=t.getState(),i=Object(w.g)(a);if(Object(w.Q)(a)&&!Object(P.e)(i)){const n=Object(w.y)(a),o=Object(w.f)(a);if(!Object(P.d)(i)||0===n&&o||n>0&&!o){let a;t.dispatch({type:"trustedAppsExistStateChanged",payload:{type:"LoadingResourceState",previousState:i}});try{const{total:t}=await e.getTrustedAppsList({page:1,per_page:1});a=t>0}catch(t){a=!0}t.dispatch({type:"trustedAppsExistStateChanged",payload:{type:"LoadedResourceState",data:a}})}}})(e,t)),"userChangedUrl"===i.type&&((t=>{const e=Object(w.h)(t.getState()),a=Object(w.B)(t.getState());a&&!e?t.dispatch({type:"trustedAppCreationDialogStarted",payload:{entry:Object(C.b)()}}):!a&&e&&t.dispatch({type:"trustedAppCreationDialogClosed"})})(e),(async({getState:t,dispatch:e},a)=>{const i=t(),n=Object(w.O)(i),o=Object(P.e)(n),s=Object(w.Q)(i),r=Object(w.B)(i),c=Object(P.h)(n);if(s&&(r&&!o||c)){e({type:"trustedAppsPoliciesStateChanged",payload:{type:"LoadingResourceState",previousState:n}});try{e({type:"trustedAppsPoliciesStateChanged",payload:{type:"LoadedResourceState",data:await a.getPolicyList({query:{page:1,perPage:1e3}})}})}catch(a){e({type:"trustedAppsPoliciesStateChanged",payload:{type:"FailedResourceState",error:a.body||a,lastLoadedState:Object(P.b)(Object(w.O)(t()))}})}}})(e,t),(async({getState:t,dispatch:e},a)=>{const i=t(),n=Object(w.Q)(i),o=Object(w.H)(i),s=Object(w.I)(i),r=Object(w.b)(i);if(n&&o&&!s){if(!r){const t=L.i18n.translate("xpack.securitySolution.trustedapps.middleware.editIdMissing",{defaultMessage:"No id provided"});return void e({type:"trustedAppCreationEditItemStateChanged",payload:{type:"FailedResourceState",error:Object.assign(new Error(t),{statusCode:404,error:t})}})}let t=Object(w.e)(i);if(t&&t.id===r)return;t=Object(w.v)(i).find((t=>t.id===r));try{t||(e({type:"trustedAppCreationEditItemStateChanged",payload:{type:"LoadingResourceState",previousState:Object(w.c)(i)}}),t=(await a.getTrustedApp({id:r})).data),e({type:"trustedAppCreationEditItemStateChanged",payload:{type:"LoadedResourceState",data:t}}),e({type:"trustedAppCreationDialogFormStateUpdated",payload:{entry:Object(_.a)(t),isValid:!0}})}catch(t){e({type:"trustedAppCreationEditItemStateChanged",payload:{type:"FailedResourceState",error:t}})}}})(e,t)),"trustedAppCreationDialogConfirmed"===i.type&&await(async(t,e)=>{const a=t.getState(),i=Object(w.j)(a),n=Object(w.A)(a),o=Object(w.h)(a),s=Object(w.H)(a);if(Object(P.g)(i)&&void 0!==o&&n){t.dispatch(T({type:"LoadingResourceState",previousState:i}));try{let i;i=s?(await e.updateTrustedApp({id:Object(w.b)(a)},o)).data:(await e.createTrustedApp(o)).data,t.dispatch(T({type:"LoadedResourceState",data:i})),t.dispatch({type:"trustedAppsListDataOutdated"})}catch(e){t.dispatch(T({type:"FailedResourceState",error:e.body,lastLoadedState:Object(P.b)(i)}))}}})(e,t),"trustedAppDeletionDialogConfirmed"===i.type&&await(async(t,e)=>{const a=Object(w.s)(t.getState()),i=Object(w.q)(t.getState());if(Object(P.g)(a)&&void 0!==i){t.dispatch(k({type:"LoadingResourceState",previousState:a}));try{await e.deleteTrustedApp({id:i.id}),t.dispatch(k({type:"LoadedResourceState",data:null})),t.dispatch({type:"trustedAppDeletionDialogClosed"}),t.dispatch({type:"trustedAppsListDataOutdated"})}catch(e){t.dispatch(k({type:"FailedResourceState",error:e.body,lastLoadedState:Object(P.b)(a)}))}}})(e,t)},q=t=>U(new A.a(t.http));var z=a(207),N=a(521),V=a(246),M=a(286);const H=(t,e)=>{if(e){t.comments||(t.comments=[]);const a=e.trim();a&&t.comments.push({comment:a})}return t},$=async(t,e)=>{const{dispatch:a,getState:i}=t,n=i();if(!Object(V.l)(n)&&Object(V.x)(n)){a({type:"eventFiltersListPageDataChanged",payload:{type:"LoadingResourceState",previousState:Object(V.b)(n)}});const{page_size:i,page_index:s,filter:r}=Object(V.c)(n),c={page:s+1,perPage:i,sortField:"created_at",sortOrder:"desc",filter:Object(I.b)(r,M.f)||void 0};try{const i=await e.getList(c);a({type:"eventFiltersListPageDataChanged",payload:Object(u.b)({query:{...c,filter:r},content:i})}),0===i.total?await(async({dispatch:t,getState:e},a)=>{t({type:"eventFiltersListPageDataExistsChanged",payload:Object(u.c)(Object(V.n)(e()))});try{const e=await a.getList({perPage:1,page:1});t({type:"eventFiltersListPageDataExistsChanged",payload:Object(u.b)(Boolean(e.total))})}catch(e){var i;t({type:"eventFiltersListPageDataExistsChanged",payload:Object(u.a)(null!==(i=e.body)&&void 0!==i?i:e)})}})(t,e):a({type:"eventFiltersListPageDataExistsChanged",payload:{type:"LoadedResourceState",data:Boolean(i.total)}})}catch(t){var o;a({type:"eventFiltersListPageDataChanged",payload:Object(u.a)(null!==(o=t.body)&&void 0!==o?o:t)})}}},W=t=>e=>a=>async i=>{a(i),"eventFiltersCreateStart"===i.type?await(async(t,e)=>{const a=t.getState().form.submissionResourceState;try{const a=Object(V.f)(t.getState());if(!a)return;t.dispatch({type:"eventFiltersFormStateChanged",payload:Object(u.c)({type:"UninitialisedResourceState"})});const i=Object(z.a)(a),n=H(i,Object(V.r)(t.getState())),o=await e.addEventFilters(n);t.dispatch({type:"eventFiltersCreateSuccess"}),t.dispatch({type:"eventFiltersFormStateChanged",payload:{type:"LoadedResourceState",data:o}})}catch(e){t.dispatch({type:"eventFiltersFormStateChanged",payload:{type:"FailedResourceState",error:e.body||e,lastLoadedState:Object(u.e)(a)}})}})(e,t):"eventFiltersInitFromId"===i.type?await(async(t,e,a)=>{const i=Object(V.s)(t.getState());try{const i=await e.getOne(a);t.dispatch({type:"eventFiltersInitForm",payload:{entry:i}})}catch(e){t.dispatch({type:"eventFiltersFormStateChanged",payload:{type:"FailedResourceState",error:e.body||e,lastLoadedState:Object(u.e)(i)}})}})(e,t,i.payload.id):"eventFiltersUpdateStart"===i.type&&await(async(t,e)=>{const a=Object(V.s)(t.getState());try{var i;const a=Object(V.f)(t.getState());if(!a)return;t.dispatch({type:"eventFiltersFormStateChanged",payload:{type:"LoadingResourceState",previousState:{type:"UninitialisedResourceState"}}});const n=Object(z.b)(a),o=H(n,Object(V.r)(t.getState()));["created_at","created_by","created_at","created_by","list_id","tie_breaker_id","updated_at","updated_by"].forEach((t=>{delete o[t]})),o.comments=null===(i=o.comments)||void 0===i?void 0:i.map((t=>({comment:t.comment,id:t.id})));const s=await e.updateOne(o);t.dispatch({type:"eventFiltersUpdateSuccess"}),t.dispatch({type:"eventFiltersFormStateChanged",payload:Object(u.b)(s)})}catch(e){var n;t.dispatch({type:"eventFiltersFormStateChanged",payload:Object(u.a)(null!==(n=e.body)&&void 0!==n?n:e,Object(u.e)(a))})}})(e,t),Object(V.p)(e.getState())&&("userChangedUrl"===i.type||"eventFiltersCreateSuccess"===i.type||"eventFiltersUpdateSuccess"===i.type||"eventFilterDeleteStatusChanged"===i.type?$(e,t):"eventFilterDeleteSubmit"===i.type&&(async({getState:t,dispatch:e},a)=>{var i;const n=t();if(Object(V.w)(n))return;const o=null===(i=Object(V.j)(n))||void 0===i?void 0:i.id;if(o){e({type:"eventFilterDeleteStatusChanged",payload:Object(u.c)(Object(V.e)(n).status)});try{const t=await a.deleteOne(o);e({type:"eventFilterDeleteStatusChanged",payload:Object(u.b)(t)})}catch(t){var s;e({type:"eventFilterDeleteStatusChanged",payload:Object(u.a)(null!==(s=t.body)&&void 0!==s?s:t)})}}})(e,t))},B=t=>W(new N.a(t.http));var Q=a(21),G=a(486),J=a(538),K=a(322);const Y=["name","description","entries.value"];function X(t){return Z(t)}const Z=t=>e=>a=>async i=>{var o,s;a(i),"userChangedUrl"===i.type&&(o=i.payload,null!==Object(Q.matchPath)(null!==(s=o.pathname)&&void 0!==s?s:"",{path:n.g,exact:!0}))&&tt(e,t.http),"hostIsolationExceptionsCreateEntry"===i.type&&async function(t,e){const{dispatch:a}=t,i=Object(z.a)(t.getState().form.entry);a({type:"hostIsolationExceptionsFormStateChanged",payload:{type:"LoadingResourceState",previousState:i}});try{const t=await Object(J.a)({http:e,exception:i});a({type:"hostIsolationExceptionsFormStateChanged",payload:Object(G.b)(t)})}catch(t){var n;a({type:"hostIsolationExceptionsFormStateChanged",payload:Object(G.a)(null!==(n=t.body)&&void 0!==n?n:t)})}}(e,t.http),"hostIsolationExceptionsSubmitDelete"===i.type&&async function(t,e){const{dispatch:a}=t,i=Object(K.f)(t.getState());if(void 0===i)return;try{a({type:"hostIsolationExceptionsDeleteStatusChanged",payload:{type:"LoadingResourceState",previousState:t.getState().deletion.status}}),await Object(J.b)(e,i.id),a({type:"hostIsolationExceptionsDeleteStatusChanged",payload:Object(G.b)(i)}),tt(t,e)}catch(t){var n;a({type:"hostIsolationExceptionsDeleteStatusChanged",payload:Object(G.a)(null!==(n=t.body)&&void 0!==n?n:t)})}}(e,t.http),"hostIsolationExceptionsMarkToEdit"===i.type&&async function(t,e,a){const{dispatch:i}=t;try{i({type:"hostIsolationExceptionsFormEntryChanged",payload:await Object(J.e)(e,a)})}catch(t){var n;i({type:"hostIsolationExceptionsFormStateChanged",payload:Object(G.a)(null!==(n=t.body)&&void 0!==n?n:t)})}}(e,t.http,i.payload.id),"hostIsolationExceptionsSubmitEdit"===i.type&&async function(t,e,a){const{dispatch:i}=t;i({type:"hostIsolationExceptionsFormStateChanged",payload:Object(G.c)(Object(G.b)(a))});try{const t=Object(z.b)(a);["created_at","created_by","created_at","created_by","list_id","tie_breaker_id","updated_at","updated_by"].forEach((e=>{delete t[e]}));const n=await Object(J.f)(e,t);i({type:"hostIsolationExceptionsFormStateChanged",payload:Object(G.b)(n)}),i({type:"hostIsolationExceptionsFormEntryChanged",payload:void 0})}catch(t){var n;i({type:"hostIsolationExceptionsFormStateChanged",payload:Object(G.a)(null!==(n=t.body)&&void 0!==n?n:t)})}}(e,t.http,i.payload)};async function tt(t,e){const{dispatch:a}=t;try{const{page_size:i,page_index:n,filter:o}=Object(K.b)(t.getState()),s={http:e,page:n+1,perPage:i,filter:Object(I.b)(o,Y)||void 0};a({type:"hostIsolationExceptionsPageDataChanged",payload:{type:"LoadingResourceState",previousState:Object(K.a)(t.getState())}});const r=await Object(J.c)(s);a({type:"hostIsolationExceptionsPageDataChanged",payload:Object(G.b)(r)})}catch(t){var i;a({type:"hostIsolationExceptionsPageDataChanged",payload:Object(G.a)(null!==(i=t.body)&&void 0!==i?i:t)})}}const et=t=>e=>e[n.o][t],at=(t,e)=>[Object(i.g)(et(n.q),Object(o.b)(t,e)),Object(i.g)(et(n.m),O(t,e)),Object(i.g)(et(n.r),q(t)),Object(i.g)(et(n.n),B(t)),Object(i.g)(et(n.p),X(t))]},787:function(t,e,a){"use strict";a.d(e,"h",(function(){return i.h})),a.d(e,"e",(function(){return i.e})),a.d(e,"d",(function(){return i.d})),a.d(e,"c",(function(){return i.c})),a.d(e,"g",(function(){return i.g})),a.d(e,"b",(function(){return i.b})),a.d(e,"a",(function(){return i.a})),a.d(e,"f",(function(){return i.f}));var i=a(220)}}]);