/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.securitySolution_bundle_jsonpfunction=window.securitySolution_bundle_jsonpfunction||[]).push([[16],{101:function(e,t,n){"use strict";n.d(t,"g",(function(){return d})),n.d(t,"f",(function(){return p})),n.d(t,"j",(function(){return m})),n.d(t,"l",(function(){return f})),n.d(t,"c",(function(){return w})),n.d(t,"e",(function(){return j})),n.d(t,"m",(function(){return I})),n.d(t,"d",(function(){return O})),n.d(t,"k",(function(){return _})),n.d(t,"a",(function(){return N})),n.d(t,"h",(function(){return $})),n.d(t,"b",(function(){return k})),n.d(t,"i",(function(){return F}));var i=n(19),a=n(21),r=n(219),o=n.n(r),s=n(106),c=n(285),u=n(190);const l=e=>o.a.stringify(e),d=(e,t)=>{const{name:n,...r}=e,o=l(r),d=`${o&&!Object(i.isEmpty)(t)?"&":""}${null!=t?t:""}`;return"endpointList"===n?`${Object(a.generatePath)(s.e,{tabName:c.a.endpoints})}${Object(u.a)(`${o?`${o}${d}`:d}`)}`:`${Object(u.a)(`${o?`${o}${d}`:d}`)}`},p=(e,t)=>{const{name:n,show:r,...o}=e,d={...o};switch(e.name){case"endpointDetails":d.show="details";break;case"endpointIsolate":d.show="isolate";break;case"endpointUnIsolate":d.show="unisolate";break;case"endpointPolicyResponse":d.show="policy_response";break;case"endpointActivityLog":d.show="activity_log"}const p=l(d),m=`${p&&!Object(i.isEmpty)(t)?"&":""}${null!=t?t:""}`;return`${Object(a.generatePath)(s.e,{tabName:c.a.endpoints})}${Object(u.a)(`${p?`${p}${m}`:m}`)}`},m=(e,t)=>`${Object(a.generatePath)(s.i,{tabName:c.a.policies,policyId:e})}${Object(u.a)(t)}`,f=(e,t)=>`${Object(a.generatePath)(s.k,{tabName:c.a.policies,policyId:e})}${Object(u.a)(t)}`,g=(e,t)=>void 0===e||e===t,y=(e,t)=>{const n=e[t];return Array.isArray(n)?n[n.length-1]:n},b=e=>{const t=Number(y(e,"page_index"));return!Number.isFinite(t)||t<0?s.b:t},E=e=>{const t=Number(y(e,"page_size"));return s.d.includes(t)?t:s.c},h=e=>y(e,"filter")||"",x=e=>y(e,"included_policies")||"",S=e=>y(e,"excluded_policies")||"",w=e=>({page_index:b(e),page_size:E(e),filter:h(e)}),v=e=>({...w(e),included_policies:x(e),excluded_policies:S(e)}),j=e=>{const t=y(e,"show");return{...v(e),view_type:"list"===y(e,"view_type")?"list":"grid",show:t&&["edit","create"].includes(t)?t:void 0,id:y(e,"id")}},I=e=>`${Object(a.generatePath)(s.l,{tabName:c.a.trustedApps})}${Object(u.a)(o.a.stringify((e=>e?{...g(e.page_index,s.b)?{}:{page_index:e.page_index},...g(e.page_size,s.c)?{}:{page_size:e.page_size},...g(e.view_type,"grid")?{}:{view_type:e.view_type},...g(e.show,void 0)?{}:{show:e.show},...g(e.id,void 0)?{}:{id:e.id},...g(e.filter,"")?"":{filter:e.filter},...g(e.included_policies,"")?"":{included_policies:e.included_policies},...g(e.excluded_policies,"")?"":{excluded_policies:e.excluded_policies}}:{})(e)))}`,O=e=>{const t=y(e,"show");return{...w(e),show:t&&"list"===t?t:void 0}},_=(e,t)=>`${Object(a.generatePath)(s.k,{tabName:c.a.policies,policyId:e})}${Object(u.a)(o.a.stringify((e=>e?{...g(e.page_index,s.b)?{}:{page_index:e.page_index},...g(e.page_size,s.c)?{}:{page_size:e.page_size},...g(e.show,void 0)?{}:{show:e.show},...g(e.filter,"")?"":{filter:e.filter}}:{})(t)))}`,N=e=>{const t=y(e,"show");return{...w(e),show:t&&["edit","create"].includes(t)?t:void 0,id:y(e,"id")}},$=e=>`${Object(a.generatePath)(s.f,{tabName:c.a.eventFilters})}${Object(u.a)(o.a.stringify((e=>e?{...g(e.page_index,s.b)?{}:{page_index:e.page_index},...g(e.page_size,s.c)?{}:{page_size:e.page_size},...g(e.show,void 0)?{}:{show:e.show},...g(e.id,void 0)?{}:{id:e.id},...g(e.filter,"")?"":{filter:e.filter}}:{})(e)))}`,k=e=>{const t=y(e,"show");return{...w(e),show:t&&["edit","create"].includes(t)?t:void 0,id:y(e,"id")}},F=e=>`${Object(a.generatePath)(s.g,{tabName:c.a.hostIsolationExceptions})}${Object(u.a)(o.a.stringify((e=>e?{...g(e.page_index,s.b)?{}:{page_index:e.page_index},...g(e.page_size,s.c)?{}:{page_size:e.page_size},...g(e.show,void 0)?{}:{show:e.show},...g(e.id,void 0)?{}:{id:e.id},...g(e.filter,"")?"":{filter:e.filter}}:{})(e)))}`},106:function(e,t,n){"use strict";n.d(t,"e",(function(){return r})),n.d(t,"h",(function(){return o})),n.d(t,"i",(function(){return s})),n.d(t,"k",(function(){return c})),n.d(t,"j",(function(){return u})),n.d(t,"l",(function(){return l})),n.d(t,"f",(function(){return d})),n.d(t,"g",(function(){return p})),n.d(t,"o",(function(){return m})),n.d(t,"q",(function(){return f})),n.d(t,"m",(function(){return g})),n.d(t,"r",(function(){return y})),n.d(t,"n",(function(){return b})),n.d(t,"p",(function(){return E})),n.d(t,"d",(function(){return h})),n.d(t,"b",(function(){return x})),n.d(t,"c",(function(){return S})),n.d(t,"a",(function(){return w}));var i=n(3),a=n(285);const r=`${i.tb}/:tabName(${a.a.endpoints})`,o=`${i.tb}/:tabName(${a.a.policies})`,s=`${i.tb}/:tabName(${a.a.policies})/:policyId/settings`,c=`${i.tb}/:tabName(${a.a.policies})/:policyId/trustedApps`,u=`${i.tb}/:tabName(${a.a.policies})/:policyId`,l=`${i.tb}/:tabName(${a.a.trustedApps})`,d=`${i.tb}/:tabName(${a.a.eventFilters})`,p=`${i.tb}/:tabName(${a.a.hostIsolationExceptions})`,m="management",f="policyDetails",g="endpoints",y="trustedApps",b="eventFilters",E="hostIsolationExceptions",h=[10,20,50],x=0,S=10,w=1e4},107:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"f",(function(){return a})),n.d(t,"b",(function(){return r})),n.d(t,"g",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"e",(function(){return c})),n.d(t,"h",(function(){return u})),n.d(t,"d",(function(){return l}));const i={ACTION:"action",RESPONSE:"response",FLEET_ACTION:"fleetAction",FLEET_RESPONSE:"fleetResponse"};let a,r,o,s,c,u,l;!function(e){e.LINUX="linux",e.MAC="macos",e.WINDOWS="windows"}(a||(a={})),function(e){e.HASH="process.hash.*",e.PATH="process.executable.caseless",e.SIGNER="process.Ext.code_signature"}(r||(r={})),function(e){e.is="is",e.matches="matches"}(o||(o={})),function(e){e.enrolled="enrolled",e.unenrolled="unenrolled"}(s||(s={})),function(e){e.UNHEALTHY="unhealthy",e.HEALTHY="healthy",e.OFFLINE="offline",e.UPDATING="updating",e.INACTIVE="inactive",e.UNENROLLED="unenrolled"}(c||(c={})),function(e){e.detect="detect",e.prevent="prevent",e.off="off"}(u||(u={})),function(e){e.success="success",e.failure="failure",e.warning="warning",e.unsupported="unsupported"}(l||(l={}))},116:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n(91),a=n(35);const r=Object(a.b)(),o=e=>Object(i.useSelector)((({app:{enableExperimental:t}})=>{if(!t||!(e in t))throw new Error(`Invalid enable value ${e}. Allowed values are: ${r.join(", ")}`);return t[e]}))},1355:function(e,t,n){"use strict";n.r(t),n.d(t,"EndpointPolicyEditExtension",(function(){return h}));var i=n(9),a=n.n(i),r=n(55),o=n(2),s=n(57),c=n(91),u=n(70),l=n(116),d=n(65),p=n(148),m=n(101),f=n(749),g=n(146),y=n(136),b=n(522),E=n(348);const h=Object(i.memo)((({policy:e,onChange:t})=>a.a.createElement(a.a.Fragment,null,a.a.createElement(r.EuiSpacer,{size:"m"}),a.a.createElement(x,{policyId:e.id,onChange:t}))));h.displayName="EndpointPolicyEditExtension";const x=Object(i.memo)((({policyId:e,onChange:t})=>{const n=Object(c.useDispatch)(),h=Object(g.b)(y.K),x=Object(g.b)(y.J),S=Object(g.b)(y.b),{getAppUrl:w}=Object(p.b)(),[,v]=Object(i.useState)(h),j=Object(l.a)("trustedAppsByPolicyEnabled");Object(i.useEffect)((()=>(n({type:"userChangedUrl",payload:{hash:"",pathname:Object(m.j)(e,""),search:""}}),()=>{n({type:"userChangedUrl",payload:{hash:"",pathname:"/",search:""}})})),[n,e]),Object(i.useEffect)((()=>{v((e=>e===h?e:(h&&t({isValid:!0,updatedPolicy:{inputs:h.inputs}}),h)))}),[t,h]);const I=Object(i.useMemo)((()=>Object(m.l)(e)),[e]),O=Object(i.useMemo)((()=>{const t=`#${u.pagePathGetters.integration_policy_edit({packagePolicyId:e})[1]}`;return{backLink:{label:o.i18n.translate("xpack.securitySolution.endpoint.fleetCustomExtension.artifacts.backButtonLabel",{defaultMessage:"Back to Fleet integration policy"}),navigateTo:[d.INTEGRATIONS_PLUGIN_ID,{path:t}],href:w({appId:d.INTEGRATIONS_PLUGIN_ID,path:t})}}}),[w,e]),_=Object(i.useMemo)((()=>a.a.createElement(E.a,{href:w({path:I}),appPath:I,appState:O,"data-test-subj":"linkToTrustedApps",size:"m"},a.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.fleetCustomExtension.manageTrustedAppLinkLabel",defaultMessage:"Manage trusted applications"}))),[w,I,O]);return a.a.createElement("div",{"data-test-subj":"endpointIntegrationPolicyForm"},j?a.a.createElement(a.a.Fragment,null,a.a.createElement("div",null,a.a.createElement(r.EuiText,null,a.a.createElement("h5",null,a.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyDetails.artifacts.title",defaultMessage:"Artifacts"}))),a.a.createElement(r.EuiSpacer,{size:"s"}),a.a.createElement(b.a,{policyId:e,cardSize:"m",customLink:_})),a.a.createElement(r.EuiSpacer,{size:"l"}),a.a.createElement("div",null,a.a.createElement(r.EuiText,null,a.a.createElement("h5",null,a.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyDetails.settings.title",defaultMessage:"Policy settings"}))),a.a.createElement(r.EuiSpacer,{size:"s"}),S?a.a.createElement(r.EuiCallOut,{title:a.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyDetails.loadError",defaultMessage:"Failed to load endpoint policy settings"}),iconType:"alert",color:"warning","data-test-subj":"endpiontPolicySettingsLoadingError"},S.message):x?a.a.createElement(f.a,null):a.a.createElement(r.EuiLoadingSpinner,{size:"l",className:"essentialAnimation"}))):a.a.createElement(f.a,null))}));x.displayName="WrappedPolicyDetailsForm"},190:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(19);const a=e=>Object(i.isEmpty)(e)?"":`${null!=e&&e.startsWith("?")?e:`?${e}`}`},219:function(e,t,n){"use strict";t.decode=t.parse=n(443),t.encode=t.stringify=n(444)},220:function(e,t,n){"use strict";n.d(t,"h",(function(){return i})),n.d(t,"e",(function(){return a})),n.d(t,"d",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"g",(function(){return s})),n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return u})),n.d(t,"f",(function(){return l}));const i=e=>"UninitialisedResourceState"===e.type,a=e=>"LoadingResourceState"===e.type,r=e=>"LoadedResourceState"===e.type,o=e=>"FailedResourceState"===e.type,s=e=>i(e)||r(e)||o(e),c=e=>r(e)?e:a(e)?c(e.previousState):o(e)?e.lastLoadedState:void 0,u=e=>o(e)?e.error:void 0,l=(e,t)=>i(e)||r(e)&&!t(e.data)||o(e)&&(!e.lastLoadedState||!t(e.lastLoadedState.data))},285:function(e,t,n){"use strict";let i;n.d(t,"a",(function(){return i})),function(e){e.endpoints="endpoints",e.policies="policy",e.trustedApps="trusted_apps",e.eventFilters="event_filters",e.hostIsolationExceptions="host_isolation_exceptions"}(i||(i={}))},299:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"d",(function(){return o})),n.d(t,"e",(function(){return s})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return u}));var i=n(2),a=n(107);const r=i.i18n.translate("xpack.securitySolution.endpointsTab",{defaultMessage:"Endpoints"}),o=i.i18n.translate("xpack.securitySolution.policiesTab",{defaultMessage:"Policies"}),s=i.i18n.translate("xpack.securitySolution.trustedAppsTab",{defaultMessage:"Trusted applications"}),c=i.i18n.translate("xpack.securitySolution.eventFiltersTab",{defaultMessage:"Event filters"}),u=(i.i18n.translate("xpack.securitySolution.administration.list.beta",{defaultMessage:"Beta"}),{[a.f.WINDOWS]:i.i18n.translate("xpack.securitySolution.administration.os.windows",{defaultMessage:"Windows"}),[a.f.MAC]:i.i18n.translate("xpack.securitySolution.administration.os.macos",{defaultMessage:"Mac"}),[a.f.LINUX]:i.i18n.translate("xpack.securitySolution.administration.os.linux",{defaultMessage:"Linux"})})},317:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));const i=(e,t)=>Object.keys(t).reduce(((e,n)=>e.replace(new RegExp(`{${n}}`,"g"),String(t[n]))),e)},346:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var i=n(9),a=n.n(i),r=n(55),o=n(2),s=n(56),c=n.n(s);const u=["windows","macos","linux","total"],l={windows:o.i18n.translate("xpack.securitySolution.endpoint.fleetCustomExtension.exceptionItemsSummary.windows",{defaultMessage:"Windows"}),linux:o.i18n.translate("xpack.securitySolution.endpoint.fleetCustomExtension.exceptionItemsSummary.linux",{defaultMessage:"Linux"}),macos:o.i18n.translate("xpack.securitySolution.endpoint.fleetCustomExtension.exceptionItemsSummary.macos",{defaultMessage:"Mac"}),total:o.i18n.translate("xpack.securitySolution.endpoint.fleetCustomExtension.exceptionItemsSummary.total",{defaultMessage:"Total"})},d=(c()(r.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGridGroup",componentId:"sc-1pq2evz-0"})(["display:grid;min-width:240px;grid-template-columns:50% 50%;"]),c()(r.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-1pq2evz-1"})(["font-size:",";font-weight:",";"],(({isSmall:e,theme:t})=>e?t.eui.euiFontSizeXS:"innherit"),(({isSmall:e})=>e?"1px":"innherit"))),p={fontWeight:"bold"},m=Object(i.memo)((({stats:e,isSmall:t=!1})=>{const n=Object(i.useCallback)((n=>{var i;return"total"!==n&&t?null:a.a.createElement(r.EuiFlexItem,{key:n},a.a.createElement(f,{value:null!==(i=null==e?void 0:e[n])&&void 0!==i?i:0,color:"total"!==n||t?"default":"primary",key:n,isSmall:t},l[n]))}),[e,t]);return a.a.createElement(r.EuiFlexGroup,{alignItems:"center",justifyContent:t?"flexStart":"spaceAround",gutterSize:t?"s":"l"},u.map((e=>n(e))))}));m.displayName="ExceptionItemsSummary";const f=Object(i.memo)((({children:e,value:t,color:n,isSmall:i=!1,...o})=>a.a.createElement(r.EuiText,{className:"eui-displayInlineBlock",size:i?"xs":"s"},a.a.createElement(d,{justifyContent:i?"flexStart":"center",direction:i?"rowReverse":"row",alignItems:"center",gutterSize:i?"xs":"l",isSmall:i},i?null:a.a.createElement(r.EuiFlexItem,{grow:!1,style:"primary"===n?p:void 0},e),a.a.createElement(r.EuiFlexItem,{grow:!1},a.a.createElement(r.EuiBadge,{color:n},t))))));f.displayName="SummaryState"},347:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return c}));var i=n(56),a=n.n(i),r=n(55);const o=a()(r.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGridGroup",componentId:"sc-iti06b-0"})(["display:grid;grid-template-columns:33% 45% 22%;grid-template-areas:'title summary link';"]),s=a()(r.EuiFlexItem).withConfig({displayName:"StyledEuiFlexGridItem",componentId:"sc-iti06b-1"})(["grid-area:",";align-items:",";margin:0px;padding:12px;"],(({gridarea:e})=>e),(({alignitems:e})=>null!=e?e:"center")),c=a()(r.EuiFlexItem).withConfig({displayName:"StyledEuiFlexItem",componentId:"sc-iti06b-2"})(["flex-direction:row-reverse;"])},348:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n(56),a=n.n(i),r=n(9),o=n.n(r),s=n(55),c=n(225);const u=a.a.span.withConfig({displayName:"LinkLabel",componentId:"sc-1ril6c5-0"})(["display:inline-block;padding-right:",";font-size:",";"],(e=>e.theme.eui.paddingSizes.s),(({size:e,theme:t})=>"m"===e?t.eui.euiFontSizeXS:"innherit")),l=Object(r.memo)((({children:e,size:t="l",...n})=>o.a.createElement(c.a,n,o.a.createElement(u,{size:t},e),o.a.createElement(s.EuiIcon,{type:"m"===t?"arrowRight":"popout"}))));l.displayName="LinkWithIcon"},443:function(e,t,n){"use strict";function i(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,n,r){t=t||"&",n=n||"=";var o={};if("string"!=typeof e||0===e.length)return o;var s=/\+/g;e=e.split(t);var c=1e3;r&&"number"==typeof r.maxKeys&&(c=r.maxKeys);var u=e.length;c>0&&u>c&&(u=c);for(var l=0;l<u;++l){var d,p,m,f,g=e[l].replace(s,"%20"),y=g.indexOf(n);y>=0?(d=g.substr(0,y),p=g.substr(y+1)):(d=g,p=""),m=decodeURIComponent(d),f=decodeURIComponent(p),i(o,m)?a(o[m])?o[m].push(f):o[m]=[o[m],f]:o[m]=f}return o};var a=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},444:function(e,t,n){"use strict";var i=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,n,s){return t=t||"&",n=n||"=",null===e&&(e=void 0),"object"==typeof e?r(o(e),(function(o){var s=encodeURIComponent(i(o))+n;return a(e[o])?r(e[o],(function(e){return s+encodeURIComponent(i(e))})).join(t):s+encodeURIComponent(i(e[o]))})).join(t):s?encodeURIComponent(i(s))+n+encodeURIComponent(i(e)):""};var a=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function r(e,t){if(e.map)return e.map(t);for(var n=[],i=0;i<e.length;i++)n.push(t(e[i],i));return n}var o=Object.keys||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t}},522:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var i=n(9),a=n.n(i),r=n(55),o=n(2),s=n(57),c=n(90),u=n(346),l=n(345),d=n(347);const p=Object(i.memo)((({customLink:e,policyId:t,cardSize:n="l"})=>{const{services:{http:p}}=Object(c.j)(),m=Object(c.m)(),[f,g]=Object(i.useState)(),y=Object(i.useMemo)((()=>new l.a(p)),[p]),b=Object(i.useRef)();Object(i.useEffect)((()=>{b.current=!0;return(async()=>{try{const e=await y.getTrustedAppsSummary({kuery:t?`(exception-list-agnostic.attributes.tags:"policy:${t}" OR exception-list-agnostic.attributes.tags:"policy:all")`:void 0});b&&g(e)}catch(e){b.current&&m.addDanger(o.i18n.translate("xpack.securitySolution.endpoint.fleetCustomExtension.trustedAppsSummaryError",{defaultMessage:'There was an error trying to fetch trusted apps stats: "{error}"',values:{error:e}}))}})(),()=>{b.current=!1}}),[m,y,t]);const E=()=>a.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.fleetCustomExtension.trustedAppsLabel",defaultMessage:"Trusted applications"}),h=Object(i.useMemo)((()=>"m"===n?a.a.createElement(r.EuiFlexGroup,{alignItems:"baseline",justifyContent:"flexStart",gutterSize:"s",direction:"row",responsive:!1},a.a.createElement(r.EuiFlexItem,{grow:!1},a.a.createElement(r.EuiText,null,a.a.createElement("h5",null,E()))),a.a.createElement(r.EuiFlexItem,{grow:!1},a.a.createElement(u.a,{stats:f,isSmall:!0})),a.a.createElement(d.c,{grow:1},e)):a.a.createElement(d.a,{alignItems:"baseline",justifyContent:"center"},a.a.createElement(d.b,{gridarea:"title",alignitems:"flex-start"},a.a.createElement(r.EuiText,null,a.a.createElement("h4",null,E()))),a.a.createElement(d.b,{gridarea:"summary",alignitems:"center"},a.a.createElement(u.a,{stats:f,isSmall:!1})),a.a.createElement(d.b,{gridarea:"link",alignitems:"flex-end"},e))),[n,e,f]);return a.a.createElement(r.EuiPanel,{hasShadow:!1,paddingSize:"l",hasBorder:!0,"data-test-subj":"fleetTrustedAppsCard"},h)}));p.displayName="FleetTrustedAppsCard"}}]);