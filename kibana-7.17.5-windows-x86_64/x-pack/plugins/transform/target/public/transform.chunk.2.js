/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.transform_bundle_jsonpfunction=window.transform_bundle_jsonpfunction||[]).push([[2],{101:function(e,t,s){"use strict";const a=s(102),r=s(103),n=s(104);function o(e){if("string"!=typeof e||1!==e.length)throw new TypeError("arrayFormatSeparator must be single character string")}function i(e,t){return t.encode?t.strict?a(e):encodeURIComponent(e):e}function l(e,t){return t.decode?r(e):e}function c(e){return Array.isArray(e)?e.sort():"object"==typeof e?c(Object.keys(e)).sort(((e,t)=>Number(e)-Number(t))).map((t=>e[t])):e}function d(e){const t=e.indexOf("#");return-1!==t&&(e=e.slice(0,t)),e}function u(e){const t=(e=d(e)).indexOf("?");return-1===t?"":e.slice(t+1)}function m(e,t){return t.parseNumbers&&!Number.isNaN(Number(e))&&"string"==typeof e&&""!==e.trim()?e=Number(e):!t.parseBooleans||null===e||"true"!==e.toLowerCase()&&"false"!==e.toLowerCase()||(e="true"===e.toLowerCase()),e}function f(e,t){o((t=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},t)).arrayFormatSeparator);const s=function(e){let t;switch(e.arrayFormat){case"index":return(e,s,a)=>{t=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),t?(void 0===a[e]&&(a[e]={}),a[e][t[1]]=s):a[e]=s};case"bracket":return(e,s,a)=>{t=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),t?void 0!==a[e]?a[e]=[].concat(a[e],s):a[e]=[s]:a[e]=s};case"comma":case"separator":return(t,s,a)=>{const r="string"==typeof s&&s.split("").indexOf(e.arrayFormatSeparator)>-1?s.split(e.arrayFormatSeparator).map((t=>l(t,e))):null===s?s:l(s,e);a[t]=r};default:return(e,t,s)=>{void 0!==s[e]?s[e]=[].concat(s[e],t):s[e]=t}}}(t),a=Object.create(null);if("string"!=typeof e)return a;if(!(e=e.trim().replace(/^[?#&]/,"")))return a;for(const r of e.split("&")){let[e,o]=n(t.decode?r.replace(/\+/g," "):r,"=");o=void 0===o?null:["comma","separator"].includes(t.arrayFormat)?o:l(o,t),s(l(e,t),o,a)}for(const e of Object.keys(a)){const s=a[e];if("object"==typeof s&&null!==s)for(const e of Object.keys(s))s[e]=m(s[e],t);else a[e]=m(s,t)}return!1===t.sort?a:(!0===t.sort?Object.keys(a).sort():Object.keys(a).sort(t.sort)).reduce(((e,t)=>{const s=a[t];return Boolean(s)&&"object"==typeof s&&!Array.isArray(s)?e[t]=c(s):e[t]=s,e}),Object.create(null))}t.extract=u,t.parse=f,t.stringify=(e,t)=>{if(!e)return"";o((t=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},t)).arrayFormatSeparator);const s=s=>t.skipNull&&null==e[s]||t.skipEmptyString&&""===e[s],a=function(e){switch(e.arrayFormat){case"index":return t=>(s,a)=>{const r=s.length;return void 0===a||e.skipNull&&null===a||e.skipEmptyString&&""===a?s:null===a?[...s,[i(t,e),"[",r,"]"].join("")]:[...s,[i(t,e),"[",i(r,e),"]=",i(a,e)].join("")]};case"bracket":return t=>(s,a)=>void 0===a||e.skipNull&&null===a||e.skipEmptyString&&""===a?s:null===a?[...s,[i(t,e),"[]"].join("")]:[...s,[i(t,e),"[]=",i(a,e)].join("")];case"comma":case"separator":return t=>(s,a)=>null==a||0===a.length?s:0===s.length?[[i(t,e),"=",i(a,e)].join("")]:[[s,i(a,e)].join(e.arrayFormatSeparator)];default:return t=>(s,a)=>void 0===a||e.skipNull&&null===a||e.skipEmptyString&&""===a?s:null===a?[...s,i(t,e)]:[...s,[i(t,e),"=",i(a,e)].join("")]}}(t),r={};for(const t of Object.keys(e))s(t)||(r[t]=e[t]);const n=Object.keys(r);return!1!==t.sort&&n.sort(t.sort),n.map((s=>{const r=e[s];return void 0===r?"":null===r?i(s,t):Array.isArray(r)?r.reduce(a(s),[]).join("&"):i(s,t)+"="+i(r,t)})).filter((e=>e.length>0)).join("&")},t.parseUrl=(e,t)=>{t=Object.assign({decode:!0},t);const[s,a]=n(e,"#");return Object.assign({url:s.split("?")[0]||"",query:f(u(e),t)},t&&t.parseFragmentIdentifier&&a?{fragmentIdentifier:l(a,t)}:{})},t.stringifyUrl=(e,s)=>{s=Object.assign({encode:!0,strict:!0},s);const a=d(e.url).split("?")[0]||"",r=t.extract(e.url),n=t.parse(r,{sort:!1}),o=Object.assign(n,e.query);let l=t.stringify(o,s);l&&(l=`?${l}`);let c=function(e){let t="";const s=e.indexOf("#");return-1!==s&&(t=e.slice(s)),t}(e.url);return e.fragmentIdentifier&&(c=`#${i(e.fragmentIdentifier,s)}`),`${a}${l}${c}`}},102:function(e,t,s){"use strict";e.exports=e=>encodeURIComponent(e).replace(/[!'()*]/g,(e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`))},103:function(e,t,s){"use strict";var a="%[a-f0-9]{2}",r=new RegExp(a,"gi"),n=new RegExp("("+a+")+","gi");function o(e,t){try{return decodeURIComponent(e.join(""))}catch(e){}if(1===e.length)return e;t=t||1;var s=e.slice(0,t),a=e.slice(t);return Array.prototype.concat.call([],o(s),o(a))}function i(e){try{return decodeURIComponent(e)}catch(a){for(var t=e.match(r),s=1;s<t.length;s++)t=(e=o(t,s).join("")).match(r);return e}}e.exports=function(e){if("string"!=typeof e)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof e+"`");try{return e=e.replace(/\+/g," "),decodeURIComponent(e)}catch(t){return function(e){for(var t={"%FE%FF":"��","%FF%FE":"��"},s=n.exec(e);s;){try{t[s[0]]=decodeURIComponent(s[0])}catch(e){var a=i(s[0]);a!==s[0]&&(t[s[0]]=a)}s=n.exec(e)}t["%C2"]="�";for(var r=Object.keys(t),o=0;o<r.length;o++){var l=r[o];e=e.replace(new RegExp(l,"g"),t[l])}return e}(e)}}},104:function(e,t,s){"use strict";e.exports=(e,t)=>{if("string"!=typeof e||"string"!=typeof t)throw new TypeError("Expected the arguments to be of type `string`");if(""===t)return[e];const s=e.indexOf(t);return-1===s?[e]:[e.slice(0,s),e.slice(s+t.length)]}},105:function(e,t,s){"use strict";s.r(t),s.d(t,"mountManagementSection",(function(){return wt}));var a=s(35),r=s(59),n=s(66),o=s.n(n),i=s(0);const l=new class text_TextService{constructor(){o()(this,"breadcrumbs",{})}init(){this.breadcrumbs={home:i.i18n.translate("xpack.transform.home.breadcrumbTitle",{defaultMessage:"Transforms"}),cloneTransform:i.i18n.translate("xpack.transform.cloneTransform.breadcrumbTitle",{defaultMessage:"Clone transform"}),createTransform:i.i18n.translate("xpack.transform.createTransform.breadcrumbTitle",{defaultMessage:"Create transform"})}}getSizeNotationHelpText(){return i.i18n.translate("xpack.transform.transformForm.sizeNotationPlaceholder",{defaultMessage:"Examples: {example1}, {example2}, {example3}, {example4}",values:{example1:"1g",example2:"10mb",example3:"5k",example4:"1024B"}})}};let c;!function(e){e.HOME="home",e.CLONE_TRANSFORM="cloneTransform",e.CREATE_TRANSFORM="createTransform"}(c||(c={}));const d=new class breadcrumb_BreadcrumbService{constructor(){o()(this,"breadcrumbs",{home:[],cloneTransform:[],createTransform:[]}),o()(this,"setBreadcrumbsHandler",void 0)}setup(e){this.setBreadcrumbsHandler=e,this.breadcrumbs.home=[{text:l.breadcrumbs.home,href:"/"}],this.breadcrumbs.cloneTransform=[...this.breadcrumbs.home,{text:l.breadcrumbs.cloneTransform}],this.breadcrumbs.createTransform=[...this.breadcrumbs.home,{text:l.breadcrumbs.createTransform}]}setBreadcrumbs(e){if(!this.setBreadcrumbsHandler)throw new Error("BreadcrumbService#setup() must be called first!");const t=this.breadcrumbs[e]?[...this.breadcrumbs[e]]:[...this.breadcrumbs.home],s=t.pop();t.push({...s,href:void 0}),this.setBreadcrumbsHandler(t)}};const u=new class doc_title_DocTitleService{constructor(){o()(this,"changeDocTitle",(()=>{}))}init(e){this.changeDocTitle=e}setTitle(e){e&&"home"!==e?l.breadcrumbs[e]&&this.changeDocTitle(`${l.breadcrumbs[e]} - ${l.breadcrumbs.home}`):this.changeDocTitle(`${l.breadcrumbs.home}`)}};var m=s(4),f=s.n(m),b=s(36),j=s(31),p=s(20),g=s(21),x=s(22),O=s(5),h=s(54),v=s(67),T=s(45);function y(e){return Object(T.b)(e,["hasAllPrivileges","missingPrivileges"])&&"boolean"==typeof e.hasAllPrivileges&&"object"==typeof e.missingPrivileges&&null!==e.missingPrivileges}const k=e=>t=>{const[s,a]=t;return!(!y(e)||e.missingPrivileges[s])||(!(!y(e)||0!==e.missingPrivileges[s].length)||"*"!==a&&(y(e)&&!e.missingPrivileges[s].includes(a)))};function M(e){let t="";switch(e){case"canCreateTransform":t=i.i18n.translate("xpack.transform.capability.noPermission.createTransformTooltip",{defaultMessage:"You do not have permission to create transforms."});break;case"canCreateTransformAlerts":t=i.i18n.translate("xpack.transform.capability.noPermission.canCreateTransformAlertsTooltip",{defaultMessage:"You do not have permission to create transform alert rules."});break;case"canStartStopTransform":t=i.i18n.translate("xpack.transform.capability.noPermission.startOrStopTransformTooltip",{defaultMessage:"You do not have permission to start or stop transforms."});break;case"canDeleteTransform":t=i.i18n.translate("xpack.transform.capability.noPermission.deleteTransformTooltip",{defaultMessage:"You do not have permission to delete transforms."});break;case"noTransformNodes":t=i.i18n.translate("xpack.transform.capability.noPermission.noTransformNodesTooltip",{defaultMessage:"There are no transform nodes available."})}return i.i18n.translate("xpack.transform.capability.pleaseContactAdministratorTooltip",{defaultMessage:"{message} Please contact your administrator.",values:{message:t}})}var E=s(53),S=s(19);const F={canGetTransform:!1,canDeleteTransform:!1,canPreviewTransform:!1,canCreateTransform:!1,canStartStopTransform:!1,canCreateTransformAlerts:!1,canUseTransformAlerts:!1},P={isLoading:!0,apiError:null,privileges:{hasAllPrivileges:!1,missingPrivileges:{}},capabilities:F},C=Object(m.createContext)({...P}),I=({privilegesEndpoint:e,children:t})=>{const{isLoading:s,error:a,data:r}=Object(E.e)({path:e,method:"get"}),n={isLoading:s,privileges:s?{...P.privileges}:r,capabilities:{...F},apiError:a||null},o=k(n.privileges);return n.capabilities.canGetTransform=o(["cluster","cluster:monitor/transform/get"])&&o(["cluster","cluster:monitor/transform/stats/get"]),n.capabilities.canCreateTransform=o(["cluster","cluster:admin/transform/put"]),n.capabilities.canDeleteTransform=o(["cluster","cluster:admin/transform/delete"]),n.capabilities.canPreviewTransform=o(["cluster","cluster:admin/transform/preview"]),n.capabilities.canStartStopTransform=o(["cluster","cluster:admin/transform/start"])&&o(["cluster","cluster:admin/transform/start_task"])&&o(["cluster","cluster:admin/transform/stop"]),n.capabilities.canCreateTransformAlerts=n.capabilities.canCreateTransform,n.capabilities.canUseTransformAlerts=n.capabilities.canGetTransform,Object(S.jsx)(C.Provider,{value:{...n}},t)},A=({title:e,message:t})=>Object(S.jsx)(p.EuiEmptyPrompt,{iconType:"securityApp",title:Object(S.jsx)("h2",null,e),body:Object(S.jsx)("p",null,t)}),L=({privileges:e,children:t})=>{const{isLoading:s,privileges:a}=Object(m.useContext)(C),r=(n=e,Array.isArray(n)?n:[n]).map((e=>{const[t,s]=e.split(".");if(!s)throw new Error('Required privilege must have the format "section.privilege"');return[t,s]}));var n;const o=k(a);return t({isLoading:s,hasPrivileges:!s&&r.every(o),privilegesMissing:r.reduce(((e,[t,s])=>{if("*"===s)e[t]=a.missingPrivileges[t]||[];else if(a.missingPrivileges[t]&&a.missingPrivileges[t].includes(s)){const a=e[t]||[];e[t]=[...a,s]}return e}),{})})},D=({missingPrivileges:e,privilegesCount:t})=>Object(S.jsx)(p.EuiFlexGroup,{justifyContent:"spaceAround"},Object(S.jsx)(p.EuiFlexItem,{grow:!1},Object(S.jsx)(p.EuiPageContent,{verticalPosition:"center",horizontalPosition:"center",color:"danger"},Object(S.jsx)(A,{title:Object(S.jsx)(g.FormattedMessage,{id:"xpack.transform.app.deniedPrivilegeTitle",defaultMessage:"You're missing cluster privileges"}),message:Object(S.jsx)(g.FormattedMessage,{id:"xpack.transform.app.deniedPrivilegeDescription",defaultMessage:"To use this section of Transforms, you must have {privilegesCount, plural, one {this cluster privilege} other {these cluster privileges}}: {missingPrivileges}.",values:{missingPrivileges:e,privilegesCount:t}})})))),w=({children:e,privileges:t})=>Object(S.jsx)(L,{privileges:t},(({isLoading:t,hasPrivileges:s,privilegesMissing:a})=>t?Object(S.jsx)(h.b,null,Object(S.jsx)(g.FormattedMessage,{id:"xpack.transform.app.checkingPrivilegesDescription",defaultMessage:"Checking privileges…"})):s?Object(S.jsx)(f.a.Fragment,null,e):Object(S.jsx)(D,{missingPrivileges:a.cluster.join(", "),privilegesCount:a.cluster.length})));var N=s(101),B=s(48),R=s(47),_=s(51),z=s(68),V=s(44),U=s(28),q=s(43);let $,H,G=[],J=null;function Y(e,t){return $=t,e.find({type:"index-pattern",fields:["id","title","type","fields"],perPage:1e4}).then((s=>(G=s.savedObjects,null===H&&(H=()=>new Promise(((s,a)=>{Y(e,t).then((e=>{s(e)})).catch((e=>{a(e)}))}))),G)))}function W(e){var t;return null===(t=G.find((t=>{var s;return(null==t||null===(s=t.attributes)||void 0===s?void 0:s.title)===e})))||void 0===t?void 0:t.id}const K=e=>{const[t,s]=Object(m.useState)(e),[a,n]=Object(m.useState)(),o=Object(V.a)(),l=o.data.indexPatterns,c=o.uiSettings,d=o.savedObjects.client,[u,f]=Object(m.useState)(void 0);async function b(e){let t,s;await Y(d,l);try{t=await function(e,t){return $=e,J=$.get(t),J}(l,e)}catch(e){}try{var a,u;if(s=await Object(r.c)(e,{search:o.data.search,savedObjectsClient:o.savedObjects.client,spaces:o.spaces}),null!==(a=s)&&void 0!==a&&null!==(u=a.sharingSavedObjectProps)&&void 0!==u&&u.errorJSON)return void n(await Object(r.d)(s))}catch(e){}Object(z.a)(t)||void 0!==s?(f(function(e,t,s){let a={query:"",language:"lucene"},r={bool:{must:[q.z]}};if(!Object(z.a)(e)&&null!==t&&void 0!==t.id){const n=t.searchSource;e=n.getField("index"),a=n.getField("query");const o=n.getField("filter"),i=o.length?o:[],l=U.esQuery.getEsQueryConfig(s);r=U.esQuery.buildEsQuery(e,[a],i,l)}if(!Object(z.a)(e))throw new Error("Index Pattern is not defined.");return{indexPattern:e,savedSearch:t,query:a,combinedQuery:r}}(t,s,c)),n(void 0)):n(i.i18n.translate("xpack.transform.searchItems.errorInitializationTitle",{defaultMessage:"An error occurred initializing the Kibana index pattern or saved search."}))}return Object(m.useEffect)((()=>{void 0!==t&&b(t)}),[t]),{error:a,getIndexPatternIdByTitle:W,loadIndexPatterns:Y,searchItems:u,setSavedObjectId:s}};var Q=s(65);const Z=({match:e,location:t})=>{const{indexPatternId:s}=Object(N.parse)(t.search,{sort:!1});Object(m.useEffect)((()=>{d.setBreadcrumbs(c.CLONE_TRANSFORM),u.setTitle("createTransform")}),[]);const a=Object(R.a)(),{esTransform:r}=Object(_.a)(),n=e.params.transformId,[o,l]=Object(m.useState)(),[b,j]=Object(m.useState)(),[x,h]=Object(m.useState)(!1),{error:v,searchItems:T,setSavedObjectId:y}=K(void 0);Object(m.useEffect)((()=>{(async()=>{if(void 0!==v)return l(void 0),j(v),void h(!0);const e=await a.getTransform(n);if(Object(B.g)(e))return l(void 0),j(e.message),void h(!0);try{if(void 0===s)throw new Error(i.i18n.translate("xpack.transform.clone.fetchErrorPromptText",{defaultMessage:"Could not fetch the Kibana index pattern ID."}));y(s),l(e.transforms[0]),j(void 0),h(!0)}catch(e){l(void 0),void 0!==e.message?j(e.message):j(JSON.stringify(e,null,2)),h(!0)}})()}),[]);const k=Object(S.jsx)(p.EuiButtonEmpty,{href:r,target:"_blank",iconType:"help","data-test-subj":"documentationLink"},Object(S.jsx)(g.FormattedMessage,{id:"xpack.transform.transformsWizard.transformDocsLinkText",defaultMessage:"Transform docs"}));return Object(S.jsx)(w,{privileges:O.c},Object(S.jsx)(p.EuiPageHeader,{pageTitle:Object(S.jsx)(g.FormattedMessage,{id:"xpack.transform.transformsWizard.cloneTransformTitle",defaultMessage:"Clone transform"}),rightSideItems:[k],bottomBorder:!0}),Object(S.jsx)(p.EuiSpacer,{size:"l"}),Object(S.jsx)(p.EuiPageContentBody,{"data-test-subj":"transformPageCloneTransform"},void 0!==b&&Object(S.jsx)(f.a.Fragment,null,Object(S.jsx)(p.EuiCallOut,{title:i.i18n.translate("xpack.transform.clone.errorPromptTitle",{defaultMessage:"An error occurred getting the transform configuration."}),color:"danger",iconType:"alert"},Object(S.jsx)("pre",null,JSON.stringify(b))),Object(S.jsx)(p.EuiSpacer,{size:"l"})),void 0!==T&&!0===x&&void 0!==o&&Object(S.jsx)(Q.b,{cloneConfig:o,searchItems:T})))},X=({match:e})=>{Object(m.useEffect)((()=>{d.setBreadcrumbs(c.CREATE_TRANSFORM),u.setTitle("createTransform")}),[]);const{esTransform:t}=Object(_.a)(),{error:s,searchItems:a}=K(e.params.savedObjectId),r=Object(S.jsx)(p.EuiButtonEmpty,{href:t,target:"_blank",iconType:"help","data-test-subj":"documentationLink"},Object(S.jsx)(g.FormattedMessage,{id:"xpack.transform.transformsWizard.transformDocsLinkText",defaultMessage:"Transform docs"}));return Object(S.jsx)(w,{privileges:O.c},Object(S.jsx)(p.EuiPageHeader,{pageTitle:Object(S.jsx)(g.FormattedMessage,{id:"xpack.transform.transformsWizard.createTransformTitle",defaultMessage:"Create transform"}),rightSideItems:[r],bottomBorder:!0}),Object(S.jsx)(p.EuiSpacer,{size:"l"}),Object(S.jsx)(p.EuiPageContentBody,{"data-test-subj":"transformPageCreateTransform"},void 0!==s&&Object(S.jsx)(f.a.Fragment,null,Object(S.jsx)(p.EuiCallOut,{title:s,color:"danger",iconType:"alert"}),Object(S.jsx)(p.EuiSpacer,{size:"l"})),void 0!==a&&Object(S.jsx)(Q.b,{searchItems:a})))};var ee=s(82);var te=s(40);const se=({onSearchSelected:e})=>{const{uiSettings:t,savedObjects:s}=Object(V.a)();return Object(S.jsx)(f.a.Fragment,null,Object(S.jsx)(p.EuiModalHeader,null,Object(S.jsx)(p.EuiModalHeaderTitle,null,Object(S.jsx)(g.FormattedMessage,{id:"xpack.transform.newTransform.newTransformTitle",defaultMessage:"New transform"})," ","/"," ",Object(S.jsx)(g.FormattedMessage,{id:"xpack.transform.newTransform.chooseSourceTitle",defaultMessage:"Choose a source"}))),Object(S.jsx)(p.EuiModalBody,null,Object(S.jsx)(te.SavedObjectFinderUi,{key:"searchSavedObjectFinder",onChoose:e,showFilter:!0,noItemsMessage:i.i18n.translate("xpack.transform.newTransform.searchSelection.notFoundLabel",{defaultMessage:"No matching indices or saved searches found."}),savedObjectMetaData:[{type:"search",getIconForSavedObject:()=>"search",name:i.i18n.translate("xpack.transform.newTransform.searchSelection.savedObjectType.search",{defaultMessage:"Saved search"})},{type:"index-pattern",getIconForSavedObject:()=>"indexPatternApp",name:i.i18n.translate("xpack.transform.newTransform.searchSelection.savedObjectType.indexPattern",{defaultMessage:"Index pattern"})}],fixedPageSize:8,uiSettings:t,savedObjects:s})))},ae=({onClick:e,transformNodes:t})=>{const{capabilities:s}=Object(m.useContext)(C),a=!s.canCreateTransform||!s.canPreviewTransform||!s.canStartStopTransform||0===t,r=Object(S.jsx)(p.EuiButton,{disabled:a,fill:!0,onClick:e,iconType:"plusInCircle","data-test-subj":"transformButtonCreate"},Object(S.jsx)(g.FormattedMessage,{id:"xpack.transform.transformList.createTransformButton",defaultMessage:"Create a transform"}));return a?Object(S.jsx)(p.EuiToolTip,{position:"top",content:M(t>0?"canCreateTransform":"noTransformNodes")},r):r},re=({onClick:e,isLoading:t})=>Object(S.jsx)(p.EuiButton,{color:"secondary",iconType:"refresh","data-test-subj":"transformRefreshTransformListButton"+(t?" loading":" loaded"),onClick:e,isLoading:t},Object(S.jsx)(g.FormattedMessage,{id:"xpack.transform.transformList.refreshButtonLabel",defaultMessage:"Reload"})),ne=i.i18n.translate("xpack.transform.transformList.deleteActionNameText",{defaultMessage:"Delete"}),oe=e=>![O.k.STOPPED,O.k.FAILED].includes(e.stats.state),ie=(e,t)=>{const s=e.some(oe);return!0===t||s},le=({canDeleteTransform:e,disabled:t,isBulkAction:s})=>{const a=i.i18n.translate("xpack.transform.transformList.deleteBulkActionDisabledToolTipContent",{defaultMessage:"One or more selected transforms must be stopped in order to be deleted."}),r=i.i18n.translate("xpack.transform.transformList.deleteActionDisabledToolTipContent",{defaultMessage:"Stop the transform in order to delete it."});if(t||!e){let e;return e=t?s?a:r:M("canDeleteTransform"),Object(S.jsx)(p.EuiToolTip,{position:"top",content:e},Object(S.jsx)(f.a.Fragment,null,ne))}return Object(S.jsx)(f.a.Fragment,null,ne)},ce=e=>{const{canDeleteTransform:t}=Object(m.useContext)(C).capabilities,s=Object(E.c)(),[a,r]=Object(m.useState)(!1),[n,o]=Object(m.useState)([]),i=n.length>1,l=Object(m.useMemo)((()=>n.some((e=>e.stats.state===O.k.FAILED))),[n]),{userCanDeleteIndex:c,deleteDestIndex:d,indexPatternExists:u,deleteIndexPattern:f,toggleDeleteIndex:b,toggleDeleteIndexPattern:j}=Object(E.b)(n),p=e=>{Array.isArray(e)&&(o(e),r(!0))};return{action:Object(m.useMemo)((()=>({name:s=>Object(S.jsx)(le,{canDeleteTransform:t,disabled:ie([s],e),isBulkAction:!1}),enabled:s=>!ie([s],e)&&t,description:ne,icon:"trash",type:"icon",onClick:e=>p([e]),"data-test-subj":"transformActionDelete"})),[t,e]),closeModal:()=>r(!1),deleteAndCloseModal:()=>{r(!1);const e=c&&d,t=c&&u&&f,a=i?l:n[0]&&n[0]&&n[0].stats.state===O.k.FAILED;s({transformsInfo:n.map((e=>({id:e.config.id,state:e.stats.state}))),deleteDestIndex:e,deleteDestIndexPattern:t,forceDelete:a})},deleteDestIndex:d,deleteIndexPattern:f,indexPatternExists:u,isModalVisible:a,items:n,openModal:p,shouldForceDelete:l,toggleDeleteIndex:b,toggleDeleteIndexPattern:j,userCanDeleteIndex:c}},de=({closeModal:e,deleteAndCloseModal:t,deleteDestIndex:s,deleteIndexPattern:a,indexPatternExists:r,items:n,shouldForceDelete:o,toggleDeleteIndex:l,toggleDeleteIndexPattern:c,userCanDeleteIndex:d})=>{const u=n.length>1,m=i.i18n.translate("xpack.transform.transformList.bulkDeleteModalTitle",{defaultMessage:"Delete {count} {count, plural, one {transform} other {transforms}}?",values:{count:n.length}}),b=i.i18n.translate("xpack.transform.transformList.deleteModalTitle",{defaultMessage:"Delete {transformId}?",values:{transformId:n[0]&&n[0].config.id}}),j=Object(S.jsx)(f.a.Fragment,null,Object(S.jsx)(p.EuiFlexGroup,{direction:"column",gutterSize:"none"},Object(S.jsx)(p.EuiFlexItem,null,Object(S.jsx)(p.EuiSwitch,{"data-test-subj":"transformBulkDeleteIndexSwitch",label:i.i18n.translate("xpack.transform.actionDeleteTransform.bulkDeleteDestinationIndexTitle",{defaultMessage:"Delete destination indices"}),checked:s,onChange:l})),Object(S.jsx)(p.EuiSpacer,{size:"s"}),Object(S.jsx)(p.EuiFlexItem,null,Object(S.jsx)(p.EuiSwitch,{"data-test-subj":"transformBulkDeleteIndexPatternSwitch",label:i.i18n.translate("xpack.transform.actionDeleteTransform.bulkDeleteDestIndexPatternTitle",{defaultMessage:"Delete destination index patterns"}),checked:a,onChange:c})))),g=Object(S.jsx)(f.a.Fragment,null,Object(S.jsx)(p.EuiFlexGroup,{direction:"column",gutterSize:"none"},Object(S.jsx)(p.EuiFlexItem,null,d&&Object(S.jsx)(p.EuiSwitch,{"data-test-subj":"transformDeleteIndexSwitch",label:i.i18n.translate("xpack.transform.actionDeleteTransform.deleteDestinationIndexTitle",{defaultMessage:"Delete destination index {destinationIndex}",values:{destinationIndex:n[0]&&n[0].config.dest.index}}),checked:s,onChange:l})),d&&r&&Object(S.jsx)(p.EuiFlexItem,null,Object(S.jsx)(p.EuiSpacer,{size:"s"}),Object(S.jsx)(p.EuiSwitch,{"data-test-subj":"transformDeleteIndexPatternSwitch",label:i.i18n.translate("xpack.transform.actionDeleteTransform.deleteDestIndexPatternTitle",{defaultMessage:"Delete index pattern {destinationIndex}",values:{destinationIndex:n[0]&&n[0].config.dest.index}}),checked:a,onChange:c}))));return Object(S.jsx)(p.EuiConfirmModal,{"data-test-subj":"transformDeleteModal",title:!0===u?m:b,onCancel:e,onConfirm:t,cancelButtonText:i.i18n.translate("xpack.transform.transformList.deleteModalCancelButton",{defaultMessage:"Cancel"}),confirmButtonText:i.i18n.translate("xpack.transform.transformList.deleteModalDeleteButton",{defaultMessage:"Delete"}),defaultFocusedButton:p.EUI_MODAL_CONFIRM_BUTTON,buttonColor:"danger"},u?j:g)},ue=i.i18n.translate("xpack.transform.transformList.startActionNameText",{defaultMessage:"Start"}),me=(e,t,s)=>{const a=e.some((e=>Object(q.p)(e))),r=e.some((e=>e.stats.state===O.k.STARTED));return!t||a||r||0===e.length||0===s},fe=({items:e,forceDisable:t,transformNodes:s})=>{const{canStartStopTransform:a}=Object(m.useContext)(C).capabilities,r=e.length>1,n=e.some((e=>Object(q.p)(e))),o=e.some((e=>e.stats.state===O.k.STARTED));let l,c;!0===r?(l=i.i18n.translate("xpack.transform.transformList.startedTransformBulkToolTip",{defaultMessage:"One or more transforms are already started."}),c=i.i18n.translate("xpack.transform.transformList.completeBatchTransformBulkActionToolTip",{defaultMessage:"One or more transforms are completed batch transforms and cannot be restarted."})):(l=i.i18n.translate("xpack.transform.transformList.startedTransformToolTip",{defaultMessage:"{transformId} is already started.",values:{transformId:e[0]&&e[0].config.id}}),c=i.i18n.translate("xpack.transform.transformList.completeBatchTransformToolTip",{defaultMessage:"{transformId} is a completed batch transform and cannot be restarted.",values:{transformId:e[0]&&e[0].config.id}}));const d=me(e,a,s);let u;return d&&e.length>0&&(a?n?u=c:o&&(u=l):u=M("canStartStopTransform")),!0!==t&&!d||void 0===u?Object(S.jsx)(f.a.Fragment,null,ue):Object(S.jsx)(p.EuiToolTip,{position:"top",content:u},Object(S.jsx)(f.a.Fragment,null,ue))},be=(e,t)=>{const{canStartStopTransform:s}=Object(m.useContext)(C).capabilities,a=Object(E.f)(),[r,n]=Object(m.useState)(!1),[o,i]=Object(m.useState)([]),l=e=>{Array.isArray(e)&&(i(e),n(!0))};return{action:Object(m.useMemo)((()=>({name:s=>Object(S.jsx)(fe,{items:[s],forceDisable:e,transformNodes:t}),available:e=>e.stats.state===O.k.STOPPED,enabled:e=>!me([e],s,t),description:ue,icon:"play",type:"icon",onClick:e=>l([e]),"data-test-subj":"transformActionStart"})),[s,e,t]),closeModal:()=>n(!1),isModalVisible:r,items:o,openModal:l,startAndCloseModal:()=>{n(!1),a(o.map((e=>({id:e.id}))))}}},je=({closeModal:e,items:t,startAndCloseModal:s})=>{const a=t.length>1,r=i.i18n.translate("xpack.transform.transformList.bulkStartModalTitle",{defaultMessage:"Start {count} {count, plural, one {transform} other {transforms}}?",values:{count:t&&t.length}}),n=i.i18n.translate("xpack.transform.transformList.startModalTitle",{defaultMessage:"Start {transformId}?",values:{transformId:t[0]&&t[0].config.id}});return Object(S.jsx)(p.EuiConfirmModal,{"data-test-subj":"transformStartModal",title:!0===a?r:n,onCancel:e,onConfirm:s,cancelButtonText:i.i18n.translate("xpack.transform.transformList.startModalCancelButton",{defaultMessage:"Cancel"}),confirmButtonText:i.i18n.translate("xpack.transform.transformList.startModalStartButton",{defaultMessage:"Start"}),defaultFocusedButton:p.EUI_MODAL_CONFIRM_BUTTON,buttonColor:"primary"},Object(S.jsx)("p",null,i.i18n.translate("xpack.transform.transformList.startModalBody",{defaultMessage:"A transform increases search and indexing load in your cluster. If excessive load is experienced, stop the transform."})))},pe=i.i18n.translate("xpack.transform.transformList.stopActionNameText",{defaultMessage:"Stop"}),ge=({items:e,forceDisable:t})=>{const s=e.length>1,{canStartStopTransform:a}=Object(m.useContext)(C).capabilities,r=e.some((e=>e.stats.state===O.k.STOPPED));let n;return n=!0===s?i.i18n.translate("xpack.transform.transformList.stoppedTransformBulkToolTip",{defaultMessage:"One or more transforms are already stopped."}):i.i18n.translate("xpack.transform.transformList.stoppedTransformToolTip",{defaultMessage:"{transformId} is already stopped.",values:{transformId:e[0]&&e[0].config.id}}),!a||r?Object(S.jsx)(p.EuiToolTip,{position:"top",content:a?n:M("canStartStopTransform")},Object(S.jsx)(f.a.Fragment,null,pe)):Object(S.jsx)(f.a.Fragment,null,pe)},xe=e=>{const{canStartStopTransform:t}=Object(m.useContext)(C).capabilities,s=Object(E.g)(),a=Object(m.useCallback)((e=>s([{id:e.id,state:e.stats.state}])),[s]);return{action:Object(m.useMemo)((()=>({name:t=>Object(S.jsx)(ge,{items:[t],forceDisable:e}),available:e=>e.stats.state!==O.k.STOPPED,enabled:s=>!((e,t,s)=>{const a=e.some((e=>e.stats.state===O.k.STOPPED));return!0===s||!t||!0===a})([s],t,e),description:pe,icon:"stop",type:"icon",onClick:a,"data-test-subj":"transformActionStop"})),[t,e,a])}};var Oe=s(58);const he=i.i18n.translate("xpack.transform.transformList.cloneActionNameText",{defaultMessage:"Clone"}),ve=({disabled:e})=>e?Object(S.jsx)(p.EuiToolTip,{position:"top",content:M("canStartStopTransform")},Object(S.jsx)(f.a.Fragment,null,he)):Object(S.jsx)(f.a.Fragment,null,he);var Te=s(27);const ye=i.i18n.translate("xpack.transform.transformList.discoverActionNameText",{defaultMessage:"View in Discover"}),ke=({indexPatternExists:e,items:t})=>{const s=t.length>1,a=t[0],r=a.stats.state===O.k.STOPPED,n=Object(q.m)(a),o=void 0===a.config.sync,l=r&&void 0===n&&!0===o;let c;return!0===s?c=i.i18n.translate("xpack.transform.transformList.discoverTransformBulkToolTip",{defaultMessage:"Links to Discover are not supported as a bulk action."}):e?l&&(c=i.i18n.translate("xpack.transform.transformList.discoverTransformToolTip",{defaultMessage:"The transform needs to be started before it's available in Discover."})):c=i.i18n.translate("xpack.transform.transformList.discoverTransformNoIndexPatternToolTip",{defaultMessage:"A Kibana index pattern is required for the destination index to be viewable in Discover"}),void 0!==c?Object(S.jsx)(p.EuiToolTip,{position:"top",content:c},Object(S.jsx)("span",{"data-test-subj":"transformDiscoverActionNameText disabled"},ye)):Object(S.jsx)("span",{"data-test-subj":"transformDiscoverActionNameText enabled"},ye)},Me=e=>Array.isArray(e.config.dest.index)?e.config.dest.index.join(","):e.config.dest.index,Ee=e=>{var t;const s=Object(V.a)(),a=s.savedObjects.client,r=s.data.indexPatterns,{getUrlGenerator:n}=s.share.urlGenerators,o=!(null===(t=s.application.capabilities.discover)||void 0===t||!t.show),{getIndexPatternIdByTitle:i,loadIndexPatterns:l}=K(void 0),[c,d]=Object(m.useState)(!1);Object(m.useEffect)((()=>{!async function(){await l(a,r),d(!0)}()}),[r,l,a]);const u=Object(m.useCallback)((async e=>{let t;try{t=n(Te.DISCOVER_APP_URL_GENERATOR)}catch(e){return}const a=Me(e),r={indexPatternId:i(a)},o=await t.createUrl(r);s.application.navigateToApp("discover",{path:o})}),[s.application,i,n]),f=Object(m.useCallback)((e=>{const t=Me(e);return void 0!==i(t)}),[i]);return{action:Object(m.useMemo)((()=>({name:e=>Object(S.jsx)(ke,{items:[e],indexPatternExists:f(e)}),available:()=>o,enabled:t=>c&&!((e,t,s)=>{if(1!==e.length)return!0;const a=e[0],r=a.stats.state===O.k.STOPPED,n=Object(q.m)(a),o=void 0===a.config.sync;return!0===t||!1===s||!0==(!0===r&&void 0===n&&!0===o)})([t],e,f(t)),description:ye,icon:"visTable",type:"icon",onClick:u,"data-test-subj":"transformActionDiscover"})),[e,f,c,o,u])}};var Se=s(50),Fe=s(52);const Pe=()=>{const{esTransformUpdate:e}=Object(_.a)();return Object(S.jsx)(p.EuiCallOut,null,Object(S.jsx)(p.EuiFlexGroup,null,Object(S.jsx)(p.EuiFlexItem,{grow:!1},Object(S.jsx)(p.EuiIcon,{type:"help"})),Object(S.jsx)(p.EuiFlexItem,null,Object(S.jsx)(p.EuiTextColor,{color:"subdued"},i.i18n.translate("xpack.transform.transformList.editFlyoutCalloutText",{defaultMessage:"This form allows you to update a transform. The list of properties that you can update is a subset of the list that you can define when you create a transform."})),Object(S.jsx)(p.EuiLink,{href:e,target:"_BLANK"},i.i18n.translate("xpack.transform.transformList.editFlyoutCalloutDocs",{defaultMessage:"View docs"})))))},Ce=({dataTestSubj:e,errorMessages:t,helpText:s,label:a,onChange:r,placeholder:n,value:o})=>Object(S.jsx)(p.EuiFormRow,{label:a,helpText:s,isInvalid:t.length>0,error:t},Object(S.jsx)(p.EuiFieldText,{"data-test-subj":e,placeholder:n,isInvalid:t.length>0,value:o,onChange:e=>r(e.target.value),"aria-label":a}));var Ie=s(24);const Ae=({editTransformFlyout:[e,t],indexPatternId:s})=>{const a=e.formFields,[r,n]=Object(m.useState)([]),o=Object(V.a)().data.indexPatterns;Object(m.useEffect)((function(){let e=!1;if(void 0!==s)return o.get(s).then((t=>{if(t){const s=t.fields.filter((e=>e.type===Ie.KBN_FIELD_TYPES.DATE)).map((e=>e.name)).sort();e||n(s)}})),()=>{e=!0}}),[s,o]);const l=Object(m.useMemo)((()=>Array.isArray(r)?r.map((e=>({text:e,value:e}))):[]),[r]);return Object(S.jsx)(p.EuiForm,null,Object(S.jsx)(Ce,{dataTestSubj:"transformEditFlyoutDescriptionInput",errorMessages:a.description.errorMessages,label:i.i18n.translate("xpack.transform.transformList.editFlyoutFormDescriptionLabel",{defaultMessage:"Description"}),onChange:e=>t({field:"description",value:e}),value:a.description.value}),Object(S.jsx)(Ce,{dataTestSubj:"transformEditFlyoutFrequencyInput",errorMessages:a.frequency.errorMessages,helpText:i.i18n.translate("xpack.transform.transformList.editFlyoutFormFrequencyHelpText",{defaultMessage:"The interval between checks for changes in the source indices when the transform is running continuously. Also determines the retry interval in the event of transient failures while the transform is searching or indexing. The minimum value is 1s and the maximum is 1h."}),label:i.i18n.translate("xpack.transform.transformList.editFlyoutFormFrequencyLabel",{defaultMessage:"Frequency"}),onChange:e=>t({field:"frequency",value:e}),placeholder:i.i18n.translate("xpack.transform.transformList.editFlyoutFormFrequencyPlaceholderText",{defaultMessage:"Default: {defaultValue}",values:{defaultValue:a.frequency.defaultValue}}),value:a.frequency.value}),Object(S.jsx)(p.EuiSpacer,{size:"l"}),Object(S.jsx)(p.EuiAccordion,{"data-test-subj":"transformEditAccordionDestination",id:"transformEditAccordionDestination",buttonContent:i.i18n.translate("xpack.transform.transformList.editFlyoutFormDestinationButtonContent",{defaultMessage:"Destination configuration"}),paddingSize:"s"},Object(S.jsx)("div",{"data-test-subj":"transformEditAccordionDestinationContent"},Object(S.jsx)(Ce,{dataTestSubj:"transformEditFlyoutDestinationIndexInput",errorMessages:a.destinationIndex.errorMessages,label:i.i18n.translate("xpack.transform.transformList.editFlyoutFormDestinationIndexLabel",{defaultMessage:"Destination index"}),onChange:e=>t({field:"destinationIndex",value:e}),value:a.destinationIndex.value}),Object(S.jsx)(Ce,{dataTestSubj:"transformEditFlyoutDestinationPipelineInput",errorMessages:a.destinationPipeline.errorMessages,label:i.i18n.translate("xpack.transform.transformList.editFlyoutFormDestinationPipelineLabel",{defaultMessage:"Pipeline"}),onChange:e=>t({field:"destinationPipeline",value:e}),value:a.destinationPipeline.value}))),Object(S.jsx)(p.EuiSpacer,{size:"l"}),Object(S.jsx)(p.EuiAccordion,{"data-test-subj":"transformEditAccordionRetentionPolicy",id:"transformEditAccordionRetentionPolicy",buttonContent:i.i18n.translate("xpack.transform.transformList.editFlyoutFormRetentionPolicyButtonContent",{defaultMessage:"Retention policy"}),paddingSize:"s"},Object(S.jsx)("div",{"data-test-subj":"transformEditAccordionRetentionPolicyContent"},s?Object(S.jsx)(p.EuiFormRow,{label:i.i18n.translate("xpack.transform.transformList.editFlyoutFormRetentionPolicyFieldLabel",{defaultMessage:"Field"}),isInvalid:a.retentionPolicyField.errorMessages.length>0,error:a.retentionPolicyField.errorMessages,helpText:i.i18n.translate("xpack.transform.transformList.editFlyoutFormRetentionPolicyDateFieldHelpText",{defaultMessage:"Select the date field that can be used to identify out of date documents in the destination index."})},Object(S.jsx)(p.EuiSelect,{"aria-label":i.i18n.translate("xpack.transform.transformList.editFlyoutFormRetentionPolicyFieldSelectAriaLabel",{defaultMessage:"Date field to set retention policy"}),"data-test-subj":"transformEditFlyoutRetentionPolicyFieldSelect",options:l,value:a.retentionPolicyField.value,onChange:e=>t({field:"retentionPolicyField",value:e.target.value}),hasNoInitialSelection:!l.map((e=>e.text)).includes(a.retentionPolicyField.value)})):Object(S.jsx)(Ce,{dataTestSubj:"transformEditFlyoutRetentionPolicyFieldInput",errorMessages:a.retentionPolicyField.errorMessages,label:i.i18n.translate("xpack.transform.transformList.editFlyoutFormRetentionPolicyFieldLabel",{defaultMessage:"Field"}),onChange:e=>t({field:"retentionPolicyField",value:e}),value:a.retentionPolicyField.value}),Object(S.jsx)(Ce,{dataTestSubj:"transformEditFlyoutRetentionPolicyMaxAgeInput",errorMessages:a.retentionPolicyMaxAge.errorMessages,label:i.i18n.translate("xpack.transform.transformList.editFlyoutFormRetentionMaxAgeFieldLabel",{defaultMessage:"Max age"}),onChange:e=>t({field:"retentionPolicyMaxAge",value:e}),value:a.retentionPolicyMaxAge.value}))),Object(S.jsx)(p.EuiSpacer,{size:"l"}),Object(S.jsx)(p.EuiAccordion,{"data-test-subj":"transformEditAccordionAdvancedSettings",id:"transformEditAccordionAdvancedSettings",buttonContent:i.i18n.translate("xpack.transform.transformList.editFlyoutFormAdvancedSettingsButtonContent",{defaultMessage:"Advanced settings"}),paddingSize:"s"},Object(S.jsx)("div",{"data-test-subj":"transformEditAccordionAdvancedSettingsContent"},Object(S.jsx)(Ce,{dataTestSubj:"transformEditFlyoutDocsPerSecondInput",errorMessages:a.docsPerSecond.errorMessages,helpText:i.i18n.translate("xpack.transform.transformList.editFlyoutFormDocsPerSecondHelptext",{defaultMessage:"To enable throttling, set a limit of documents to input per second."}),label:i.i18n.translate("xpack.transform.transformList.editFlyoutFormDocsPerSecondLabel",{defaultMessage:"Documents per second"}),onChange:e=>t({field:"docsPerSecond",value:e}),value:a.docsPerSecond.value}),Object(S.jsx)(Ce,{dataTestSubj:"transformEditFlyoutMaxPageSearchSizeInput",errorMessages:a.maxPageSearchSize.errorMessages,helpText:i.i18n.translate("xpack.transform.transformList.editFlyoutFormMaxPageSearchSizeHelptext",{defaultMessage:"Defines the initial page size to use for the composite aggregation for each checkpoint."}),label:i.i18n.translate("xpack.transform.transformList.editFlyoutFormMaxPageSearchSizeLabel",{defaultMessage:"Maximum page search size"}),onChange:e=>t({field:"maxPageSearchSize",value:e}),value:a.maxPageSearchSize.value,placeholder:i.i18n.translate("xpack.transform.transformList.editFlyoutFormMaxPageSearchSizePlaceholderText",{defaultMessage:"Default: {defaultValue}",values:{defaultValue:a.maxPageSearchSize.defaultValue}})}))))};var Le=s(23),De=s(78),we=s(83);const Ne=i.i18n.translate("xpack.transform.transformList.editFlyoutFormNumberNotValidErrorMessage",{defaultMessage:"Value needs to be an integer above zero."}),Be=e=>!isNaN(e)&&Number.isInteger(+e)&&+e>0&&!(e+"").includes(".")?[]:[Ne],Re=i.i18n.translate("xpack.transform.transformList.editFlyoutFormNumberRange10To10000NotValidErrorMessage",{defaultMessage:"Value needs to be an integer between 10 and 10000."}),_e=i.i18n.translate("xpack.transform.transformList.editFlyoutFormRequiredErrorMessage",{defaultMessage:"Required field."}),ze=i.i18n.translate("xpack.transform.transformList.editFlyoutFormStringNotValidErrorMessage",{defaultMessage:"Value needs to be of type string."});function Ve(e,t){if("string"!=typeof e||null===e)return[ze];const s=e.match(/[a-z]+|[^a-z]+/gi);if(null===s||Array.isArray(s)&&2!==s.length)return[Ue];const a=+s[0],r=s[1];return isNaN(a)||!Number.isInteger(a)||0===a?[Ue]:{number:a,timeUnit:r}}const Ue=i.i18n.translate("xpack.transform.transformList.editFlyoutFormFrequencyNotValidErrorMessage",{defaultMessage:"The frequency value is not valid."}),qe=i.i18n.translate("xpack.transform.transformList.editFlyoutFormRetentionPolicyMaxAgeNotValidErrorMessage",{defaultMessage:"Invalid max age format. Minimum of 60s required."}),$e={string:(e,t=!0)=>"string"!=typeof e?[ze]:0!==e.length||t?[]:[_e],frequency:e=>{const t=Ve(e);return Array.isArray(t)?t:Object(we.b)(t)?[]:[Ue]},integerAboveZero:Be,integerRange10To10000:e=>0===Be(e).length&&+e>=10&&+e<=1e4?[]:[Re],retentionPolicyMaxAge:e=>{const t=Ve(e);return Array.isArray(t)?t:Object(we.c)(t)?[]:[qe]}},He=(e,t,s,a)=>{const r=void 0!==(null==a?void 0:a.defaultValue)?a.defaultValue:"",n=Object(De.a)(s,t,void 0);return{formFieldName:e,configFieldName:t,defaultValue:r,dependsOn:[],errorMessages:[],isNullable:!1,isOptional:!0,validator:"string",value:null!=n?n.toString():"",valueParser:e=>e,...void 0!==a?{...a}:{}}},Ge=(e,t,s,a=!1)=>{const r=s[e],n=r.isNullable?null:r.defaultValue,o=""!==r.value?r.valueParser(r.value):n,i=Object(De.a)(t,r.configFieldName,n),l=!1===a?r.dependsOn.reduce(((e,a)=>Object(Le.merge)({...e},Ge(a,t,s,!0))),{}):{};return o===r.defaultValue&&r.isOptional?o!==i?l:{}:o!==i||a?Object(De.b)(l,r.configFieldName,o):{}},Je=e=>({formFields:{description:He("description","description",e),frequency:He("frequency","frequency",e,{defaultValue:"1m",validator:"frequency"}),destinationIndex:He("destinationIndex","dest.index",e,{dependsOn:["destinationPipeline"],isOptional:!1}),destinationPipeline:He("destinationPipeline","dest.pipeline",e,{dependsOn:["destinationIndex"]}),docsPerSecond:He("docsPerSecond","settings.docs_per_second",e,{isNullable:!0,validator:"integerAboveZero",valueParser:e=>""===e?null:+e}),maxPageSearchSize:He("maxPageSearchSize","settings.max_page_search_size",e,{defaultValue:"500",validator:"integerRange10To10000",valueParser:e=>+e}),retentionPolicyField:He("retentionPolicyField","retention_policy.time.field",e,{dependsOn:["retentionPolicyMaxAge"],isNullable:!1,isOptional:!0}),retentionPolicyMaxAge:He("retentionPolicyMaxAge","retention_policy.time.max_age",e,{dependsOn:["retentionPolicyField"],isNullable:!1,isOptional:!0,validator:"retentionPolicyMaxAge"})},isFormTouched:!1,isFormValid:!0}),Ye=(e,t)=>({...e,errorMessages:e.isOptional&&"string"==typeof t&&0===t.length?[]:$e[e.validator](t,e.isOptional),value:t}),We=e=>Object(m.useReducer)((e=>{const t=Je(e),s=Object.values(t.formFields).map((e=>e.value));return(e,{field:t,value:a})=>{const r={...e.formFields,[t]:Ye(e.formFields[t],a)};return{...e,formFields:r,isFormTouched:!Object(Le.isEqual)(s,Object.values(r).map((e=>e.value))),isFormValid:(n=r,Object.keys(n).reduce(((e,t)=>e&&0===n[t].errorMessages.length),!0))};var n}})(e),Je(e)),Ke=({closeFlyout:e,config:t,indexPatternId:s})=>{const a=Object(R.a)(),r=Object(V.b)(),[n,o]=We(t),[l,c]=Object(m.useState)(void 0);const d=!n.isFormValid||!n.isFormTouched;return Object(S.jsx)(p.EuiFlyout,{onClose:e,hideCloseButton:!0,"aria-labelledby":"transformEditFlyoutTitle","data-test-subj":"transformEditFlyout"},Object(S.jsx)(p.EuiFlyoutHeader,{hasBorder:!0},Object(S.jsx)(p.EuiTitle,{size:"m"},Object(S.jsx)("h2",{id:"transformEditFlyoutTitle"},i.i18n.translate("xpack.transform.transformList.editFlyoutTitle",{defaultMessage:"Edit {transformId}",values:{transformId:t.id}})))),Object(S.jsx)(p.EuiFlyoutBody,{banner:Object(S.jsx)(Pe,null)},Object(S.jsx)(Ae,{editTransformFlyout:[n,o],indexPatternId:s}),void 0!==l&&Object(S.jsx)(f.a.Fragment,null,Object(S.jsx)(p.EuiSpacer,{size:"m"}),Object(S.jsx)(p.EuiCallOut,{title:i.i18n.translate("xpack.transform.transformList.editTransformGenericErrorMessage",{defaultMessage:"An error occurred calling the API endpoint to update transforms."}),color:"danger",iconType:"alert"},Object(S.jsx)("p",null,l)))),Object(S.jsx)(p.EuiFlyoutFooter,null,Object(S.jsx)(p.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(S.jsx)(p.EuiFlexItem,{grow:!1},Object(S.jsx)(p.EuiButtonEmpty,{iconType:"cross",onClick:e,flush:"left"},i.i18n.translate("xpack.transform.transformList.editFlyoutCancelButtonText",{defaultMessage:"Cancel"}))),Object(S.jsx)(p.EuiFlexItem,{grow:!1},Object(S.jsx)(p.EuiButton,{"data-test-subj":"transformEditFlyoutUpdateButton",onClick:async function(){c(void 0);const s=((e,t)=>Object.keys(t).reduce(((s,a)=>Object(Le.merge)({...s},Ge(a,e,t))),{}))(t,n.formFields),o=t.id,l=await a.updateTransform(o,s);Object(Se.l)(l)?(r.addSuccess(i.i18n.translate("xpack.transform.transformList.editTransformSuccessMessage",{defaultMessage:"Transform {transformId} updated.",values:{transformId:o}})),e(),q.C.next(q.c.REFRESH)):c(Object(Fe.a)(l))},fill:!0,isDisabled:d},i.i18n.translate("xpack.transform.transformList.editFlyoutUpdateButtonText",{defaultMessage:"Update"}))))))},Qe=i.i18n.translate("xpack.transform.transformList.editActionNameText",{defaultMessage:"Edit"}),Ze=()=>{const{canCreateTransform:e}=Object(m.useContext)(C).capabilities;return e?Object(S.jsx)(f.a.Fragment,null,Qe):Object(S.jsx)(p.EuiToolTip,{position:"top",content:M("canStartStopTransform")},Object(S.jsx)(f.a.Fragment,null,Qe))},Xe=i.i18n.translate("xpack.transform.transformList.createAlertRuleNameText",{defaultMessage:"Create alert rule"}),et=({disabled:e})=>e?Object(S.jsx)(p.EuiToolTip,{position:"top",content:M("canCreateTransformAlerts")},Object(S.jsx)(f.a.Fragment,null,Xe)):Object(S.jsx)(f.a.Fragment,null,Xe);var tt=s(64);const st=({forceDisable:e,transformNodes:t})=>{const s=((e,t)=>{const s=Object(j.useHistory)(),a=Object(V.a)(),r=a.savedObjects.client,n=a.data.indexPatterns,o=Object(V.b)(),{getIndexPatternIdByTitle:l,loadIndexPatterns:c}=K(void 0),{canCreateTransform:d}=Object(m.useContext)(C).capabilities,u=Object(m.useCallback)((async e=>{try{await c(r,n);const t=Array.isArray(e.config.source.index)?e.config.source.index.join(","):e.config.source.index,a=l(t);void 0===a?o.addDanger(i.i18n.translate("xpack.transform.clone.noIndexPatternErrorPromptText",{defaultMessage:"Unable to clone the transform {transformId}. No index pattern exists for {indexPattern}.",values:{indexPattern:t,transformId:e.id}})):s.push(`/${v.a.CLONE_TRANSFORM}/${e.id}?indexPatternId=${a}`)}catch(e){o.addError(e,{title:i.i18n.translate("xpack.transform.clone.errorPromptText",{defaultMessage:"An error occurred checking if source index pattern exists"})})}}),[s,r,n,o,c,l]);return{action:Object(m.useMemo)((()=>({name:e=>Object(S.jsx)(ve,{disabled:!d}),enabled:()=>d&&!e&&t>0,description:he,icon:"copy",type:"icon",onClick:u,"data-test-subj":"transformActionClone"})),[d,e,u,t])}})(e,t),a=ce(e),r=Ee(e),n=((e,t)=>{const{canCreateTransform:s}=Object(m.useContext)(C).capabilities,[a,r]=Object(m.useState)(),[n,o]=Object(m.useState)(!1),[l,c]=Object(m.useState)(),{getIndexPatternIdByTitle:d}=K(void 0),u=Object(V.b)(),f=Object(V.a)().data.indexPatterns,b=Object(m.useCallback)((async e=>{try{const t=Array.isArray(e.config.source.index)?e.config.source.index.join(","):e.config.source.index,s=d(t);void 0===s&&u.addWarning(i.i18n.translate("xpack.transform.edit.noIndexPatternErrorPromptText",{defaultMessage:"Unable to get index pattern the transform {transformId}. No index pattern exists for {indexPattern}.",values:{indexPattern:t,transformId:e.id}})),c(s),r(e.config),o(!0)}catch(e){u.addError(e,{title:i.i18n.translate("xpack.transform.edit.errorPromptText",{defaultMessage:"An error occurred checking if source index pattern exists"})})}}),[f,u,d]);return{action:Object(m.useMemo)((()=>({name:()=>Object(S.jsx)(Ze,null),enabled:()=>s&&!e&&t>0,description:Qe,icon:"pencil",type:"icon",onClick:e=>b(e),"data-test-subj":"transformActionEdit"})),[s,b,e,t]),config:a,closeFlyout:()=>o(!1),isFlyoutVisible:n,indexPatternId:l}})(e,t),o=be(e,t),l=xe(e),c=(e=>{const{canCreateTransformAlerts:t}=Object(m.useContext)(C).capabilities,{setCreateAlertRule:s}=Object(tt.e)(),a=Object(m.useCallback)((e=>{s(e.id)}),[s]);return{action:Object(m.useMemo)((()=>({name:e=>Object(S.jsx)(et,{disabled:!t}),available:e=>Object(Oe.a)(e.config),enabled:()=>t&&!e,description:Xe,type:"icon",icon:"bell",onClick:a,"data-test-subj":"transformActionCreateAlertRule"})),[t,e,a])}})(e);return{modals:Object(S.jsx)(f.a.Fragment,null,o.isModalVisible&&Object(S.jsx)(je,o),n.config&&n.isFlyoutVisible&&Object(S.jsx)(Ke,{closeFlyout:n.closeFlyout,config:n.config,indexPatternId:n.indexPatternId}),a.isModalVisible&&Object(S.jsx)(de,a)),actions:[r.action,c.action,o.action,l.action,n.action,s.action,a.action]}},at={aborting:"warning",failed:"danger",indexing:"primary",started:"primary",stopped:"hollow",stopping:"hollow",waiting:"hollow"},rt=(e,t)=>{const s=at[e];return e===O.k.FAILED&&void 0!==t?Object(S.jsx)(p.EuiToolTip,{content:t},Object(S.jsx)(p.EuiBadge,{className:"transform__TaskStateBadge",color:s},e)):Object(S.jsx)(p.EuiBadge,{className:"transform__TaskStateBadge",color:s},e)},nt=(e,t,s,a)=>{const{actions:r,modals:n}=st({forceDisable:a.length>0,transformNodes:s});return{columns:[{name:Object(S.jsx)(p.EuiScreenReaderOnly,null,Object(S.jsx)("p",null,Object(S.jsx)(g.FormattedMessage,{id:"xpack.transform.transformList.showDetailsColumn.screenReaderDescription",defaultMessage:"This column contains clickable controls for showing more details on each transform"}))),align:p.RIGHT_ALIGNMENT,width:"40px",isExpander:!0,render:s=>Object(S.jsx)(p.EuiButtonIcon,{onClick:()=>function(s){const a=e.indexOf(s.config.id);-1!==a?(e.splice(a,1),t([...e])):e.push(s.config.id),t([...e])}(s),"aria-label":e.includes(s.config.id)?i.i18n.translate("xpack.transform.transformList.rowCollapse",{defaultMessage:"Hide details for {transformId}",values:{transformId:s.config.id}}):i.i18n.translate("xpack.transform.transformList.rowExpand",{defaultMessage:"Show details for {transformId}",values:{transformId:s.config.id}}),iconType:e.includes(s.config.id)?"arrowUp":"arrowDown","data-test-subj":"transformListRowDetailsToggle"})},{field:q.d.ID,"data-test-subj":"transformListColumnId",name:"ID",sortable:!0,truncateText:!0,scope:"row"},{id:"alertRule",name:Object(S.jsx)(p.EuiScreenReaderOnly,null,Object(S.jsx)("p",null,Object(S.jsx)(g.FormattedMessage,{id:"xpack.transform.transformList.alertingRules.screenReaderDescription",defaultMessage:"This column displays an icon when there are alert rules associated with a transform"}))),width:"30px",render:e=>Array.isArray(e.alerting_rules)?Object(S.jsx)(p.EuiToolTip,{position:"bottom",content:Object(S.jsx)(g.FormattedMessage,{id:"xpack.transform.transformList.alertingRules.tooltipContent",defaultMessage:"Transform has {rulesCount} associated alert {rulesCount, plural, one { rule} other { rules}}",values:{rulesCount:e.alerting_rules.length}})},Object(S.jsx)(p.EuiIcon,{type:"bell"})):Object(S.jsx)("span",null)},{field:q.d.DESCRIPTION,"data-test-subj":"transformListColumnDescription",name:i.i18n.translate("xpack.transform.description",{defaultMessage:"Description"}),sortable:!0,truncateText:!0},{name:i.i18n.translate("xpack.transform.type",{defaultMessage:"Type"}),"data-test-subj":"transformListColumnType",sortable:e=>e.mode,truncateText:!0,render(e){let t=i.i18n.translate("xpack.transform.type.unknown",{defaultMessage:"unknown"});return!0===Object(Oe.c)(e.config)&&(t=i.i18n.translate("xpack.transform.type.pivot",{defaultMessage:"pivot"})),!0===Object(Oe.b)(e.config)&&(t=i.i18n.translate("xpack.transform.type.latest",{defaultMessage:"latest"})),Object(S.jsx)(p.EuiBadge,{color:"hollow"},t)},width:"100px"},{name:i.i18n.translate("xpack.transform.status",{defaultMessage:"Status"}),"data-test-subj":"transformListColumnStatus",sortable:e=>e.stats.state,truncateText:!0,render:e=>rt(e.stats.state,e.stats.reason),width:"100px"},{name:i.i18n.translate("xpack.transform.mode",{defaultMessage:"Mode"}),"data-test-subj":"transformListColumnMode",sortable:e=>e.mode,truncateText:!0,render(e){const t=e.mode;return Object(S.jsx)(p.EuiBadge,{color:"hollow"},t)},width:"100px"},{name:i.i18n.translate("xpack.transform.progress",{defaultMessage:"Progress"}),"data-test-subj":"transformListColumnProgress",sortable:e=>Object(q.m)(e)||0,truncateText:!0,render(e){const t=Object(q.m)(e),s=void 0===e.config.sync;return void 0===t&&!0===s?null:Object(S.jsx)(p.EuiFlexGroup,{alignItems:"center",gutterSize:"xs"},s&&Object(S.jsx)(m.Fragment,null,Object(S.jsx)(p.EuiFlexItem,{style:{width:"40px"},grow:!1},Object(S.jsx)(p.EuiProgress,{value:t,max:100,color:"primary",size:"m","data-test-subj":"transformListProgress"},t,"%")),Object(S.jsx)(p.EuiFlexItem,{style:{width:"35px"},grow:!1},Object(S.jsx)(p.EuiText,{size:"xs"},`${t}%`))),!s&&Object(S.jsx)(m.Fragment,null,Object(S.jsx)(p.EuiFlexItem,{style:{width:"40px"},grow:!1},e.stats.state!==O.k.STOPPED&&e.stats.state!==O.k.WAITING&&e.stats.state!==O.k.FAILED&&Object(S.jsx)(p.EuiProgress,{color:"primary",size:"m"}),(e.stats.state===O.k.STOPPED||e.stats.state===O.k.WAITING||e.stats.state===O.k.FAILED)&&Object(S.jsx)(p.EuiProgress,{value:0,max:100,color:"primary",size:"m"})),Object(S.jsx)(p.EuiFlexItem,{style:{width:"35px"},grow:!1}," ")))},width:"100px"},{name:i.i18n.translate("xpack.transform.tableActionLabel",{defaultMessage:"Actions"}),actions:r,width:"80px"}],modals:n}};var ot=s(34),it=s.n(ot);const lt=({section:e})=>0===e.items.length?null:Object(S.jsx)(p.EuiPanel,null,Object(S.jsx)(p.EuiTitle,{size:"xs"},Object(S.jsx)("span",null,e.title)),Object(S.jsx)(p.EuiDescriptionList,{compressed:!0,type:"column",listItems:e.items})),ct=({sections:e})=>Object(S.jsx)("div",{"data-test-subj":"transformDetailsTabContent"},Object(S.jsx)(p.EuiFlexGroup,null,Object(S.jsx)(p.EuiFlexItem,{style:{width:"50%"}},e.filter((e=>"left"===e.position)).map((e=>Object(S.jsx)(m.Fragment,{key:e.title},Object(S.jsx)(p.EuiSpacer,{size:"s"}),Object(S.jsx)(lt,{section:e}))))),Object(S.jsx)(p.EuiFlexItem,{style:{width:"50%"}},e.filter((e=>"right"===e.position)).map((e=>Object(S.jsx)(m.Fragment,{key:e.title},Object(S.jsx)(p.EuiSpacer,{size:"s"}),Object(S.jsx)(lt,{section:e}))))))),dt=({json:e})=>Object(S.jsx)("div",{"data-test-subj":"transformJsonTabContent"},Object(S.jsx)(p.EuiFlexGroup,null,Object(S.jsx)(p.EuiFlexItem,null,Object(S.jsx)(p.EuiSpacer,{size:"s"}),Object(S.jsx)(p.EuiCodeBlock,{"aria-label":i.i18n.translate("xpack.transform.transformList.transformDetails.expandedRowJsonPane",{defaultMessage:"JSON of transform configuration"}),fontSize:"s",language:"json",paddingSize:"s",style:{width:"100%"},isCopyable:!0},"value=",JSON.stringify(e,null,2))),Object(S.jsx)(p.EuiFlexItem,{grow:!1}," ")));var ut=s(41),mt=s(42);const[ft,bt,jt]=["info","warning","error"],pt=({message:e,showTooltip:t=!1})=>{if(void 0===e)return Object(S.jsx)("span",null);let s="primary";const a="alert";return e.level===ft?s="primary":e.level===bt?s="warning":e.level===jt&&(s="danger"),t?Object(S.jsx)(p.EuiToolTip,{position:"bottom",content:e.text},Object(S.jsx)(p.EuiIcon,{type:a,color:s})):Object(S.jsx)(p.EuiIcon,{type:a,color:s})},gt=({transformId:e})=>{const[t,s]=Object(m.useState)([]),[a,r]=Object(m.useState)(!1),[n,o]=Object(m.useState)(""),[l,c]=Object(m.useState)(0),[d,u]=Object(m.useState)(10),f=Object(R.a)();Object(q.D)({onRefresh:(()=>{let t=0;return async function a(){if(t++,t>1)return;r(!0);const n=await f.getTransformAuditMessages(e);if(!Object(Se.g)(n))return r(!1),void o(i.i18n.translate("xpack.transform.transformList.transformDetails.messagesPane.errorMessage",{defaultMessage:"Messages could not be loaded"}));r(!1),s(n),t--,t>0&&(t=0,a())}})()});const b=[{name:"",render:e=>Object(S.jsx)(pt,{message:e}),width:`${mt.euiLightVars.euiSizeXL}px`},{name:i.i18n.translate("xpack.transform.transformList.transformDetails.messagesPane.timeLabel",{defaultMessage:"Time"}),render:e=>Object(ut.formatDate)(e.timestamp,"YYYY-MM-DD HH:mm:ss")},{field:"node_name",name:i.i18n.translate("xpack.transform.transformList.transformDetails.messagesPane.nodeLabel",{defaultMessage:"Node"})},{field:"message",name:i.i18n.translate("xpack.transform.transformList.transformDetails.messagesPane.messageLabel",{defaultMessage:"Message"}),width:"50%"}],{pageOfMessages:j,totalItemCount:g}=(({index:e,size:s})=>{const a=t,r=a.length,n=e*s;return{pageOfMessages:a.slice(n,n+s),totalItemCount:r}})({index:l,size:d}),x={pageIndex:l,pageSize:d,totalItemCount:g,pageSizeOptions:[10,20,50],hidePerPageOptions:!1};return Object(S.jsx)("div",{"data-test-subj":"transformMessagesTabContent"},Object(S.jsx)(p.EuiSpacer,{size:"s"}),Object(S.jsx)(p.EuiBasicTable,{className:"transform__TransformTable__messagesPaneTable",items:j,columns:b,compressed:!0,loading:a,error:n,pagination:x,onChange:({page:e={index:0,size:10}})=>{const{index:t,size:s}=e;c(t),u(s)}}))};var xt=s(81),Ot=s.n(xt),ht=s(73),vt=s(84);const Tt=({transformConfig:e})=>{const{ml:{DataGrid:t}}=Object(V.a)(),s=Object(V.b)(),{searchQuery:a,validationStatus:r,previewRequest:n,runtimeMappings:o}=Object(m.useMemo)((()=>Object(vt.d)(Object(vt.f)({}),e)),[e]),i=Object(m.useMemo)((()=>Object(q.j)(a)),[a]),l=Array.isArray(e.source.index)?e.source.index.join(","):e.source.index,c=Object(ht.a)(l,i,r,n,o);return Object(S.jsx)(t,Ot()({},c,{dataTestSubj:"transformPivotPreview",toastNotifications:s}))};const yt=({item:e,onAlertEdit:t})=>{var s,a,r;const{ml:{formatHumanReadableDateTimeSeconds:n}}=Object(V.a)(),o={...e.stats};delete o.stats,delete o.checkpointing;const l=[];l.push({title:"ID",description:e.id},{title:"state",description:e.stats.state}),void 0!==e.stats.node&&l.push({title:"node.name",description:e.stats.node.name});const c={title:"State",items:l,position:"right"},d={title:"General",items:[{title:"transform_id",description:e.id},{title:"transform_version",description:e.config.version},{title:"description",description:null!==(s=e.config.description)&&void 0!==s?s:""},{title:"create_time",description:null!==(a=n(1e3*it()(e.config.create_time).unix()))&&void 0!==a?a:""},{title:"source_index",description:Array.isArray(e.config.source.index)?e.config.source.index[0]:e.config.source.index},{title:"destination_index",description:Array.isArray(e.config.dest.index)?e.config.dest.index[0]:e.config.dest.index}],position:"left"},u=[];void 0!==e.stats.checkpointing.last&&(u.push({title:"last.checkpoint",description:e.stats.checkpointing.last.checkpoint}),void 0!==e.stats.checkpointing.last.timestamp_millis&&(u.push({title:"last.timestamp",description:n(e.stats.checkpointing.last.timestamp_millis)}),u.push({title:"last.timestamp_millis",description:e.stats.checkpointing.last.timestamp_millis}))),void 0!==e.stats.checkpointing.next&&(u.push({title:"next.checkpoint",description:e.stats.checkpointing.next.checkpoint}),void 0!==e.stats.checkpointing.next.checkpoint_progress&&(u.push({title:"next.checkpoint_progress.total_docs",description:e.stats.checkpointing.next.checkpoint_progress.total_docs}),u.push({title:"next.checkpoint_progress.docs_remaining",description:e.stats.checkpointing.next.checkpoint_progress.docs_remaining}),u.push({title:"next.checkpoint_progress.percent_complete",description:e.stats.checkpointing.next.checkpoint_progress.percent_complete})));const m=null===(r=e.alerting_rules)||void 0===r?void 0:r.map((e=>({title:Object(S.jsx)(p.EuiButtonEmpty,{iconType:"documentEdit",iconSide:"left",onClick:()=>{t(e)},flush:"left",size:"xs",iconSize:"s"},e.name),description:e.executionStatus.status}))),f={title:"Checkpointing",items:u,position:"right"},b={title:i.i18n.translate("xpack.transform.transformList.transformDetails.alertRulesTitle",{defaultMessage:"Alert rules"}),items:m,position:"right"},j={title:"Stats",items:Object.entries(e.stats.stats).map((e=>{return{title:e[0].toString(),description:(t=e[1],"object"==typeof t?JSON.stringify(t):t.toString())};var t})),position:"left"},g=function(e){let t=0,s=0;if(0===e.length)return t;for(let a=0;a<e.length;a++)s=e.charCodeAt(a),t=(t<<5)-t+s,t|=0;return t<0?-2*t:t}(e.id),x=[{id:`transform-details-tab-${g}`,"data-test-subj":"transformDetailsTab",name:i.i18n.translate("xpack.transform.transformList.transformDetails.tabs.transformDetailsLabel",{defaultMessage:"Details"}),content:Object(S.jsx)(ct,{sections:[d,c,f,...b.items?[b]:[]]})},{id:`transform-stats-tab-${g}`,"data-test-subj":"transformStatsTab",name:i.i18n.translate("xpack.transform.transformList.transformDetails.tabs.transformStatsLabel",{defaultMessage:"Stats"}),content:Object(S.jsx)(ct,{sections:[j]})},{id:`transform-json-tab-${g}`,"data-test-subj":"transformJsonTab",name:"JSON",content:Object(S.jsx)(dt,{json:e.config})},{id:`transform-messages-tab-${g}`,"data-test-subj":"transformMessagesTab",name:i.i18n.translate("xpack.transform.transformList.transformDetails.tabs.transformMessagesLabel",{defaultMessage:"Messages"}),content:Object(S.jsx)(gt,{transformId:e.id})},{id:`transform-preview-tab-${g}`,"data-test-subj":"transformPreviewTab",name:i.i18n.translate("xpack.transform.transformList.transformDetails.tabs.transformPreviewLabel",{defaultMessage:"Preview"}),content:Object(S.jsx)(Tt,{transformConfig:e.config})}];return Object(S.jsx)(p.EuiTabbedContent,{size:"s",tabs:x,initialSelectedTab:x[0],onTabClick:()=>{},expand:!1,style:{width:"100%"},"data-test-subj":"transformExpandedRowTabbedContent"})},kt=[{type:"field_value_selection",field:"state.state",name:i.i18n.translate("xpack.transform.statusFilter",{defaultMessage:"Status"}),multiSelect:"or",options:Object.values(O.k).map((e=>({value:e,name:e,view:rt(e)})))},{type:"field_value_selection",field:"mode",name:i.i18n.translate("xpack.transform.modeFilter",{defaultMessage:"Mode"}),multiSelect:!1,options:Object.values(O.i).map((e=>({value:e,name:e,view:Object(S.jsx)(p.EuiBadge,{className:"transform__TaskModeBadge",color:"hollow"},e)})))}];function Mt(e,t){return"string"==typeof e&&"string"==typeof t&&null===e.toLowerCase().match(t.toLowerCase())==!1}const Et=[10,25,50];const St=({onCreateTransform:e,transformNodes:t,transforms:s,transformsLoading:a})=>{const[r,n]=Object(m.useState)(!1),{refresh:o}=Object(q.D)({isLoading:n}),{setEditAlertRule:l}=Object(tt.e)(),[c,d]=Object(m.useState)(!1),[u,f]=Object(m.useState)([]),[b,j]=Object(m.useState)([]),[g,x]=Object(m.useState)([]),[h,v]=Object(m.useState)(!1),T=be(!1,t),y=ce(!1),[k,M]=Object(m.useState)(void 0),F=Object(E.g)(),{capabilities:P}=Object(m.useContext)(C),I=!P.canCreateTransform||!P.canPreviewTransform||!P.canStartStopTransform,{sorting:A,pagination:L,onTableChange:D}=function(e,t){const[s,a]=Object(m.useState)({pageIndex:0,pageSize:10,totalItemCount:0,hidePerPageOptions:!1,sortField:e,sortDirection:"asc"}),{pageIndex:r,pageSize:n,sortField:o,sortDirection:i}=s;return{onTableChange:({page:t={index:0,size:10},sort:r={field:e,direction:"asc"}})=>{const{index:n,size:o}=t,{field:i,direction:l}=r;a({...s,pageIndex:n,pageSize:o,sortField:i,sortDirection:l})},pagination:{pageIndex:r,pageSize:n,totalItemCount:t.length,pageSizeOptions:Et},sorting:{sort:{field:o,direction:i}}}}(q.d.ID,s),{columns:w,modals:N}=nt(b,j,t,g);if(0===s.length&&0===t)return null;if(0===s.length)return Object(S.jsx)(p.EuiFlexGroup,{justifyContent:"spaceAround"},Object(S.jsx)(p.EuiFlexItem,{grow:!1},Object(S.jsx)(p.EuiSpacer,{size:"l"}),Object(S.jsx)(p.EuiPageContent,{verticalPosition:"center",horizontalPosition:"center",color:"subdued"},Object(S.jsx)(p.EuiEmptyPrompt,{title:Object(S.jsx)("h2",null,i.i18n.translate("xpack.transform.list.emptyPromptTitle",{defaultMessage:"No transforms found"})),actions:[Object(S.jsx)(p.EuiButton,{color:"primary",fill:!0,onClick:e,isDisabled:I,"data-test-subj":"transformCreateFirstButton"},i.i18n.translate("xpack.transform.list.emptyPromptButtonText",{defaultMessage:"Create your first transform"}))],"data-test-subj":"transformNoTransformsFound"}))));const B=function(e,t,s){return e.reduce(((e,a)=>{const r=t.find((e=>e.config.id===a));return void 0!==r&&(e[a]=Object(S.jsx)(yt,{item:r,onAlertEdit:s})),e}),{})}(b,s,l),R=[Object(S.jsx)("div",{key:"startAction",className:"transform__BulkActionItem"},Object(S.jsx)(p.EuiButtonEmpty,{onClick:()=>T.openModal(g)},Object(S.jsx)(fe,{items:g,transformNodes:t}))),Object(S.jsx)("div",{key:"stopAction",className:"transform__BulkActionItem"},Object(S.jsx)(p.EuiButtonEmpty,{onClick:()=>F(g.map((e=>({id:e.id,state:e.stats.state}))))},Object(S.jsx)(ge,{items:g}))),Object(S.jsx)("div",{key:"deleteAction",className:"transform__BulkActionItem"},Object(S.jsx)(p.EuiButtonEmpty,{onClick:()=>y.openModal(g)},Object(S.jsx)(le,{canDeleteTransform:P.canDeleteTransform,disabled:ie(g,!1),isBulkAction:!0})))],_=Object(S.jsx)(p.EuiFlexGroup,{gutterSize:"m",justifyContent:"spaceAround"},Object(S.jsx)(p.EuiFlexItem,null,Object(S.jsx)(re,{onClick:o,isLoading:r})),Object(S.jsx)(p.EuiFlexItem,null,Object(S.jsx)(ae,{onClick:e,transformNodes:t}))),z={toolsLeft:g.length>0?(()=>{const e=Object(S.jsx)(p.EuiButtonIcon,{size:"s",iconType:"gear",color:"text",onClick:()=>{v(!0)},"aria-label":i.i18n.translate("xpack.transform.multiTransformActionsMenu.managementActionsAriaLabel",{defaultMessage:"Management actions"})}),t=Object(S.jsx)(p.EuiPopover,{key:"bulkActionIcon",id:"transformBulkActionsMenu",button:e,isOpen:h,closePopover:()=>v(!1),panelPaddingSize:"s",anchorPosition:"rightUp"},R);return[Object(S.jsx)(p.EuiTitle,{key:"selectedText",size:"s"},Object(S.jsx)("h3",null,i.i18n.translate("xpack.transform.multiTransformActionsMenu.transformsCount",{defaultMessage:"{count} {count, plural, one {transform} other {transforms}} selected",values:{count:g.length}}))),Object(S.jsx)("div",{key:"bulkActionsBorder",className:"transform__BulkActionsBorder"}),t]})():void 0,toolsRight:_,onChange:({query:e,error:t})=>{if(t)M(t.message);else{let t=[];if(e&&void 0!==e.ast&&void 0!==e.ast.clauses&&(t=e.ast.clauses),t.length>0){d(!0);const e=((e,t)=>{const s=e.reduce(((e,t)=>(e[t.id]={transform:t,count:0},e)),{});return t.forEach((t=>{const a="must"===t.match;let r=[];r="term"===t.type?!0===a?e.filter((e=>Mt(e.id,t.value)===a||Mt(e.config.description,t.value)===a)):e.filter((e=>Mt(e.id,t.value)===a&&Mt(e.config.description,t.value)===a)):Array.isArray(t.value)?e.filter((e=>t.value.includes(e.stats.state))):e.filter((e=>{if("mode"===t.field)return e.mode===t.value;if("type"===t.field){if(t.value===O.g.PIVOT)return Object(Oe.c)(e.config);if(t.value===O.g.LATEST)return Object(Oe.b)(e.config)}return!1})),r.forEach((e=>s[e.id].count++))})),Object.values(s).filter((e=>(e&&e.count)>=t.length)).map((e=>e.transform))})(s,t);f(e)}else d(!1);M(void 0)}},box:{incremental:!0},filters:kt},V={onSelectionChange:e=>x(e)};return Object(S.jsx)("div",{"data-test-subj":"transformListTableContainer"},T.isModalVisible&&Object(S.jsx)(je,T),y.isModalVisible&&Object(S.jsx)(de,y),N,Object(S.jsx)(p.EuiInMemoryTable,{allowNeutralSort:!1,className:"transform__TransformTable",columns:w,error:k,hasActions:!1,isExpandable:!0,isSelectable:!1,items:c?u:s,itemId:q.d.ID,itemIdToExpandedRowMap:B,loading:r||a,onTableChange:D,pagination:L,rowProps:e=>({"data-test-subj":`transformListRow row-${e.id}`}),selection:V,sorting:A,search:z,"data-test-subj":"transformListTable "+(r||a?"loading":"loaded")}))},Ft=({stat:e})=>Object(S.jsx)("span",{className:"transformStat"},Object(S.jsx)("span",null,e.label),": ",Object(S.jsx)("strong",null,e.value)),Pt=({stats:e,dataTestSub:t})=>{const s=Object.keys(e).map((t=>e[t]));return Object(S.jsx)("div",{className:"transformStatsBar","data-test-subj":t},s.filter((e=>e.show)).map((e=>Object(S.jsx)(Ft,{key:e.label,stat:e}))))};const Ct=({transformNodes:e,transformsList:t})=>{const{esNodeRoles:s}=Object(_.a)(),a=function(e,t){const s={total:{label:i.i18n.translate("xpack.transform.statsBar.totalTransformsLabel",{defaultMessage:"Total transforms"}),value:0,show:!0},batch:{label:i.i18n.translate("xpack.transform.statsBar.batchTransformsLabel",{defaultMessage:"Batch"}),value:0,show:!0},continuous:{label:i.i18n.translate("xpack.transform.statsBar.continuousTransformsLabel",{defaultMessage:"Continuous"}),value:0,show:!0},failed:{label:i.i18n.translate("xpack.transform.statsBar.failedTransformsLabel",{defaultMessage:"Failed"}),value:0,show:!1},started:{label:i.i18n.translate("xpack.transform.statsBar.startedTransformsLabel",{defaultMessage:"Started"}),value:0,show:!0},nodes:{label:i.i18n.translate("xpack.transform.statsBar.transformNodesLabel",{defaultMessage:"Nodes"}),value:e,show:!0}};if(void 0===t)return s;let a=0,r=0;return t.forEach((e=>{e.mode===O.i.CONTINUOUS?s.continuous.value++:e.mode===O.i.BATCH&&s.batch.value++,e.stats.state===O.k.FAILED?a++:e.stats.state===O.k.STARTED&&r++})),s.total.value=t.length,s.started.value=r,0!==a?(s.failed.value=a,s.failed.show=!0):s.failed.show=!1,s}(e,t);return Object(S.jsx)(f.a.Fragment,null,Object(S.jsx)(Pt,{stats:a,dataTestSub:"transformStatsBar"}),0===e&&Object(S.jsx)(f.a.Fragment,null,Object(S.jsx)(p.EuiSpacer,{size:"m"}),Object(S.jsx)(p.EuiCallOut,{title:Object(S.jsx)(g.FormattedMessage,{id:"xpack.transform.transformNodes.noTransformNodesCallOutTitle",defaultMessage:"There are no transform nodes available."}),color:"warning",iconType:"alert"},Object(S.jsx)("p",null,Object(S.jsx)(g.FormattedMessage,{id:"xpack.transform.transformNodes.noTransformNodesCallOutBody",defaultMessage:"You will not be able to create or run transforms. {learnMoreLink}",values:{learnMoreLink:Object(S.jsx)(p.EuiLink,{href:s,target:"_blank"},Object(S.jsx)(g.FormattedMessage,{id:"xpack.transform.transformNodes.noTransformNodesLearnMoreLinkText",defaultMessage:"Learn more"}))}})))))},It=()=>{const{esTransform:e}=Object(_.a)(),[t,s]=Object(m.useState)(!1),[a,r]=Object(m.useState)(!1),[n,o]=Object(m.useState)(!1),[i,l]=Object(m.useState)([]),[c,d]=Object(m.useState)(0),[u,b]=Object(m.useState)(void 0),j=Object(E.d)(l,d,b,r,n);Object(q.D)({isLoading:s,onRefresh:()=>j(!0)}),(e=>{const{refresh:t}=Object(q.D)();Object(m.useEffect)((()=>{const e=setInterval(t,O.e);return()=>{clearInterval(e)}}),[])})();const[x,h]=Object(m.useState)(!1),[v,T]=Object(m.useState)(null);if(null!==v)return Object(S.jsx)(ee.a,{savedObjectId:v});const y=Object(S.jsx)(p.EuiButtonEmpty,{href:e,target:"_blank",iconType:"help","data-test-subj":"documentationLink"},Object(S.jsx)(g.FormattedMessage,{id:"xpack.transform.transformList.transformDocsLinkText",defaultMessage:"Transform docs"}));return Object(S.jsx)(f.a.Fragment,null,Object(S.jsx)(p.EuiPageHeader,{pageTitle:Object(S.jsx)("span",{"data-test-subj":"transformAppTitle"},Object(S.jsx)(g.FormattedMessage,{id:"xpack.transform.transformList.transformTitle",defaultMessage:"Transforms"})),description:Object(S.jsx)(g.FormattedMessage,{id:"xpack.transform.transformList.transformDescription",defaultMessage:"Use transforms to pivot existing Elasticsearch indices into summarized entity-centric indices or to create an indexed view of the latest documents for fast access."}),rightSideItems:[y],bottomBorder:!0}),Object(S.jsx)(p.EuiSpacer,{size:"l"}),Object(S.jsx)(p.EuiPageContentBody,{"data-test-subj":"transformPageTransformList"},!a&&Object(S.jsx)(p.EuiLoadingContent,{lines:2}),a&&Object(S.jsx)(f.a.Fragment,null,Object(S.jsx)(Ct,{transformNodes:c,transformsList:i}),Object(S.jsx)(p.EuiSpacer,{size:"s"}),void 0!==u&&Object(S.jsx)(p.EuiFlexGroup,{justifyContent:"spaceAround"},Object(S.jsx)(p.EuiFlexItem,{grow:!1},Object(S.jsx)(p.EuiSpacer,{size:"l"}),Object(S.jsx)(p.EuiPageContent,{verticalPosition:"center",horizontalPosition:"center",color:"danger"},Object(S.jsx)(p.EuiEmptyPrompt,{iconType:"alert",title:Object(S.jsx)("h2",null,Object(S.jsx)(g.FormattedMessage,{id:"xpack.transform.list.errorPromptTitle",defaultMessage:"An error occurred getting the transform list"})),body:Object(S.jsx)("p",null,Object(S.jsx)("pre",null,JSON.stringify(u))),actions:[]})))),void 0===u&&Object(S.jsx)(tt.a.Provider,{value:Object(tt.d)()},Object(S.jsx)(St,{onCreateTransform:()=>h(!0),transformNodes:c,transforms:i,transformsLoading:t}),Object(S.jsx)(tt.c,null)))),x&&Object(S.jsx)(p.EuiModal,{onClose:()=>h(!1),className:"transformCreateTransformSearchDialog","data-test-subj":"transformSelectSourceModal"},Object(S.jsx)(se,{onSearchSelected:(e,t)=>{T(e)}})))},At=()=>(Object(m.useEffect)((()=>{d.setBreadcrumbs(c.HOME),u.setTitle("home")}),[]),Object(S.jsx)(w,{privileges:O.d},Object(S.jsx)(It,null))),Lt=({history:e})=>{const{apiError:t}=Object(m.useContext)(C);return null!==t?Object(S.jsx)(h.a,{title:Object(S.jsx)(g.FormattedMessage,{id:"xpack.transform.app.checkingPrivilegesErrorMessage",defaultMessage:"Error fetching user privileges from the server"}),error:t}):Object(S.jsx)(j.Router,{history:e},Object(S.jsx)(j.Switch,null,Object(S.jsx)(j.Route,{path:`/${v.a.CLONE_TRANSFORM}/:transformId`,component:Z}),Object(S.jsx)(j.Route,{path:`/${v.a.CREATE_TRANSFORM}/:savedObjectId`,component:X}),Object(S.jsx)(j.Route,{path:"/",component:At})))},Dt=new a.Storage(window.localStorage);async function wt(e,t){const{element:s,setBreadcrumbs:a,history:n}=t,{http:o,notifications:i,getStartServices:c}=e,m=await c(),[f,j]=m,{application:g,chrome:h,docLinks:v,i18n:T,overlays:y,savedObjects:k,uiSettings:M}=f,{data:E,share:F,spaces:P,triggersActionsUi:C}=j,{docTitle:A}=h;l.init(),u.init(A.change),d.setup(a);const L=((e,t)=>{const s=t.i18n.Context;return Object(b.render)(Object(S.jsx)(p.EuiErrorBoundary,null,Object(S.jsx)(x.KibanaContextProvider,{services:t},Object(S.jsx)(I,{privilegesEndpoint:`${O.b}privileges`},Object(S.jsx)(s,null,Object(S.jsx)(Lt,{history:t.history}))))),e),()=>{Object(b.unmountComponentAtNode)(e)}})(s,{application:g,chrome:h,data:E,docLinks:v,http:o,i18n:T,notifications:i,overlays:y,savedObjects:k,storage:Dt,uiSettings:M,history:n,savedObjectsPlugin:j.savedObjects,share:F,spaces:P,ml:await Object(r.b)(),triggersActionsUi:C});return()=>{A.reset(),L()}}},66:function(e,t,s){e.exports=s(29)(1074)}}]);