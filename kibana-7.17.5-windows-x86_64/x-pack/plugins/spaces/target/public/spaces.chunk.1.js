/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.spaces_bundle_jsonpfunction=window.spaces_bundle_jsonpfunction||[]).push([[1],Array(34).concat([function(e,t,s){"use strict";var o,a=function(){return void 0===o&&(o=Boolean(window&&document&&document.all&&!window.atob)),o},n=function(){var e={};return function(t){if(void 0===e[t]){var s=document.querySelector(t);if(window.HTMLIFrameElement&&s instanceof window.HTMLIFrameElement)try{s=s.contentDocument.head}catch(e){s=null}e[t]=s}return e[t]}}(),i=[];function c(e){for(var t=-1,s=0;s<i.length;s++)if(i[s].identifier===e){t=s;break}return t}function r(e,t){for(var s={},o=[],a=0;a<e.length;a++){var n=e[a],r=t.base?n[0]+t.base:n[0],l=s[r]||0,p="".concat(r," ").concat(l);s[r]=l+1;var u=c(p),d={css:n[1],media:n[2],sourceMap:n[3]};-1!==u?(i[u].references++,i[u].updater(d)):i.push({identifier:p,updater:m(d,t),references:1}),o.push(p)}return o}function l(e){var t=document.createElement("style"),o=e.attributes||{};if(void 0===o.nonce){var a=s.nc;a&&(o.nonce=a)}if(Object.keys(o).forEach((function(e){t.setAttribute(e,o[e])})),"function"==typeof e.insert)e.insert(t);else{var i=n(e.insert||"head");if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(t)}return t}var p,u=(p=[],function(e,t){return p[e]=t,p.filter(Boolean).join("\n")});function d(e,t,s,o){var a=s?"":o.media?"@media ".concat(o.media," {").concat(o.css,"}"):o.css;if(e.styleSheet)e.styleSheet.cssText=u(t,a);else{var n=document.createTextNode(a),i=e.childNodes;i[t]&&e.removeChild(i[t]),i.length?e.insertBefore(n,i[t]):e.appendChild(n)}}function g(e,t,s){var o=s.css,a=s.media,n=s.sourceMap;if(a?e.setAttribute("media",a):e.removeAttribute("media"),n&&"undefined"!=typeof btoa&&(o+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(n))))," */")),e.styleSheet)e.styleSheet.cssText=o;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(o))}}var j=null,b=0;function m(e,t){var s,o,a;if(t.singleton){var n=b++;s=j||(j=l(t)),o=d.bind(null,s,n,!1),a=d.bind(null,s,n,!0)}else s=l(t),o=g.bind(null,s,t),a=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(s)};return o(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;o(e=t)}else a()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=a());var s=r(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var o=0;o<s.length;o++){var a=c(s[o]);i[a].references--}for(var n=r(e,t),l=0;l<s.length;l++){var p=c(s[l]);0===i[p].references&&(i[p].updater(),i.splice(p,1))}s=n}}}},function(e,t,s){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var s=function(e,t){var s=e[1]||"",o=e[3];if(!o)return s;if(t&&"function"==typeof btoa){var a=(i=o,c=btoa(unescape(encodeURIComponent(JSON.stringify(i)))),r="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(c),"/*# ".concat(r," */")),n=o.sources.map((function(e){return"/*# sourceURL=".concat(o.sourceRoot||"").concat(e," */")}));return[s].concat(n).concat([a]).join("\n")}var i,c,r;return[s].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(s,"}"):s})).join("")},t.i=function(e,s,o){"string"==typeof e&&(e=[[null,e,""]]);var a={};if(o)for(var n=0;n<this.length;n++){var i=this[n][0];null!=i&&(a[i]=!0)}for(var c=0;c<e.length;c++){var r=[].concat(e[c]);o&&a[r[0]]||(s&&(r[2]?r[2]="".concat(s," and ").concat(r[2]):r[2]=s),t.push(r))}},t}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,s){switch(window.__kbnThemeTag__){case"v7dark":return s(91);case"v7light":return s(93);case"v8dark":return s(95);case"v8light":return s(97)}},function(e,t,s){var o=s(34),a=s(92);"string"==typeof(a=a.__esModule?a.default:a)&&(a=[[e.i,a,""]]);var n={insert:"head",singleton:!1};o(a,n);e.exports=a.locals||{}},function(e,t,s){(t=s(35)(!1)).push([e.i,".spcCopyToSpace__spacesList{margin-top:4px}\n",""]),e.exports=t},function(e,t,s){var o=s(34),a=s(94);"string"==typeof(a=a.__esModule?a.default:a)&&(a=[[e.i,a,""]]);var n={insert:"head",singleton:!1};o(a,n);e.exports=a.locals||{}},function(e,t,s){(t=s(35)(!1)).push([e.i,".spcCopyToSpace__spacesList{margin-top:4px}\n",""]),e.exports=t},function(e,t,s){var o=s(34),a=s(96);"string"==typeof(a=a.__esModule?a.default:a)&&(a=[[e.i,a,""]]);var n={insert:"head",singleton:!1};o(a,n);e.exports=a.locals||{}},function(e,t,s){(t=s(35)(!1)).push([e.i,".spcCopyToSpace__spacesList{margin-top:4px}\n",""]),e.exports=t},function(e,t,s){var o=s(34),a=s(98);"string"==typeof(a=a.__esModule?a.default:a)&&(a=[[e.i,a,""]]);var n={insert:"head",singleton:!1};o(a,n);e.exports=a.locals||{}},function(e,t,s){(t=s(35)(!1)).push([e.i,".spcCopyToSpace__spacesList{margin-top:4px}\n",""]),e.exports=t},function(e,t,s){switch(window.__kbnThemeTag__){case"v7dark":return s(100);case"v7light":return s(102);case"v8dark":return s(104);case"v8light":return s(106)}},function(e,t,s){var o=s(34),a=s(101);"string"==typeof(a=a.__esModule?a.default:a)&&(a=[[e.i,a,""]]);var n={insert:"head",singleton:!1};o(a,n);e.exports=a.locals||{}},function(e,t,s){(t=s(35)(!1)).push([e.i,".spcCopyToSpaceResult{padding-bottom:8px;border-bottom:1px solid #343741}\n",""]),e.exports=t},function(e,t,s){var o=s(34),a=s(103);"string"==typeof(a=a.__esModule?a.default:a)&&(a=[[e.i,a,""]]);var n={insert:"head",singleton:!1};o(a,n);e.exports=a.locals||{}},function(e,t,s){(t=s(35)(!1)).push([e.i,".spcCopyToSpaceResult{padding-bottom:8px;border-bottom:1px solid #D3DAE6}\n",""]),e.exports=t},function(e,t,s){var o=s(34),a=s(105);"string"==typeof(a=a.__esModule?a.default:a)&&(a=[[e.i,a,""]]);var n={insert:"head",singleton:!1};o(a,n);e.exports=a.locals||{}},function(e,t,s){(t=s(35)(!1)).push([e.i,".spcCopyToSpaceResult{padding-bottom:8px;border-bottom:1px solid #343741}\n",""]),e.exports=t},function(e,t,s){var o=s(34),a=s(107);"string"==typeof(a=a.__esModule?a.default:a)&&(a=[[e.i,a,""]]);var n={insert:"head",singleton:!1};o(a,n);e.exports=a.locals||{}},function(e,t,s){(t=s(35)(!1)).push([e.i,".spcCopyToSpaceResult{padding-bottom:8px;border-bottom:1px solid #D3DAE6}\n",""]),e.exports=t},function(e,t,s){switch(window.__kbnThemeTag__){case"v7dark":return s(109);case"v7light":return s(111);case"v8dark":return s(113);case"v8light":return s(115)}},function(e,t,s){var o=s(34),a=s(110);"string"==typeof(a=a.__esModule?a.default:a)&&(a=[[e.i,a,""]]);var n={insert:"head",singleton:!1};o(a,n);e.exports=a.locals||{}},function(e,t,s){(t=s(35)(!1)).push([e.i,".spcCopyToSpace__summaryCountBadge{margin-left:4px}.spcCopyToSpace__missingReferencesIcon{margin-left:4px}\n",""]),e.exports=t},function(e,t,s){var o=s(34),a=s(112);"string"==typeof(a=a.__esModule?a.default:a)&&(a=[[e.i,a,""]]);var n={insert:"head",singleton:!1};o(a,n);e.exports=a.locals||{}},function(e,t,s){(t=s(35)(!1)).push([e.i,".spcCopyToSpace__summaryCountBadge{margin-left:4px}.spcCopyToSpace__missingReferencesIcon{margin-left:4px}\n",""]),e.exports=t},function(e,t,s){var o=s(34),a=s(114);"string"==typeof(a=a.__esModule?a.default:a)&&(a=[[e.i,a,""]]);var n={insert:"head",singleton:!1};o(a,n);e.exports=a.locals||{}},function(e,t,s){(t=s(35)(!1)).push([e.i,".spcCopyToSpace__summaryCountBadge{margin-left:4px}.spcCopyToSpace__missingReferencesIcon{margin-left:4px}\n",""]),e.exports=t},function(e,t,s){var o=s(34),a=s(116);"string"==typeof(a=a.__esModule?a.default:a)&&(a=[[e.i,a,""]]);var n={insert:"head",singleton:!1};o(a,n);e.exports=a.locals||{}},function(e,t,s){(t=s(35)(!1)).push([e.i,".spcCopyToSpace__summaryCountBadge{margin-left:4px}.spcCopyToSpace__missingReferencesIcon{margin-left:4px}\n",""]),e.exports=t},function(e,t,s){switch(window.__kbnThemeTag__){case"v7dark":return s(118);case"v7light":return s(120);case"v8dark":return s(122);case"v8light":return s(124)}},function(e,t,s){var o=s(34),a=s(119);"string"==typeof(a=a.__esModule?a.default:a)&&(a=[[e.i,a,""]]);var n={insert:"head",singleton:!1};o(a,n);e.exports=a.locals||{}},function(e,t,s){(t=s(35)(!1)).push([e.i,".spcCopyToSpace__resolveAllConflictsLink{font-size:14px;margin-right:8px}\n",""]),e.exports=t},function(e,t,s){var o=s(34),a=s(121);"string"==typeof(a=a.__esModule?a.default:a)&&(a=[[e.i,a,""]]);var n={insert:"head",singleton:!1};o(a,n);e.exports=a.locals||{}},function(e,t,s){(t=s(35)(!1)).push([e.i,".spcCopyToSpace__resolveAllConflictsLink{font-size:14px;margin-right:8px}\n",""]),e.exports=t},function(e,t,s){var o=s(34),a=s(123);"string"==typeof(a=a.__esModule?a.default:a)&&(a=[[e.i,a,""]]);var n={insert:"head",singleton:!1};o(a,n);e.exports=a.locals||{}},function(e,t,s){(t=s(35)(!1)).push([e.i,".spcCopyToSpace__resolveAllConflictsLink{font-size:14px;margin-right:8px}\n",""]),e.exports=t},function(e,t,s){var o=s(34),a=s(125);"string"==typeof(a=a.__esModule?a.default:a)&&(a=[[e.i,a,""]]);var n={insert:"head",singleton:!1};o(a,n);e.exports=a.locals||{}},function(e,t,s){(t=s(35)(!1)).push([e.i,".spcCopyToSpace__resolveAllConflictsLink{font-size:14px;margin-right:8px}\n",""]),e.exports=t},function(e,t,s){switch(window.__kbnThemeTag__){case"v7dark":return s(127);case"v7light":return s(129);case"v8dark":return s(131);case"v8light":return s(133)}},function(e,t,s){var o=s(34),a=s(128);"string"==typeof(a=a.__esModule?a.default:a)&&(a=[[e.i,a,""]]);var n={insert:"head",singleton:!1};o(a,n);e.exports=a.locals||{}},function(e,t,s){(t=s(35)(!1)).push([e.i,".spcCopyToSpaceResultDetails{margin-top:8px;padding-left:24px}.spcCopyToSpaceResultDetails__row{margin-bottom:4px}.spcCopyToSpaceResultDetails__savedObjectName{min-width:0}.spcCopyToSpaceResultDetails__selectControl{margin-left:24px}.spcCopyToSpaceResultDetails__selectControl__childWrapper{visibility:hidden;opacity:0;height:0;overflow:hidden;transform:translatez(0);transition:height 250ms cubic-bezier(0.694, 0.0482, 0.335, 1),opacity 250ms cubic-bezier(0.694, 0.0482, 0.335, 1)}.spcCopyToSpaceResultDetails__selectControl.spcCopyToSpaceResultDetails__selectControl-isOpen .spcCopyToSpaceResultDetails__selectControl__childWrapper{visibility:visible;opacity:1;height:auto}\n",""]),e.exports=t},function(e,t,s){var o=s(34),a=s(130);"string"==typeof(a=a.__esModule?a.default:a)&&(a=[[e.i,a,""]]);var n={insert:"head",singleton:!1};o(a,n);e.exports=a.locals||{}},function(e,t,s){(t=s(35)(!1)).push([e.i,".spcCopyToSpaceResultDetails{margin-top:8px;padding-left:24px}.spcCopyToSpaceResultDetails__row{margin-bottom:4px}.spcCopyToSpaceResultDetails__savedObjectName{min-width:0}.spcCopyToSpaceResultDetails__selectControl{margin-left:24px}.spcCopyToSpaceResultDetails__selectControl__childWrapper{visibility:hidden;opacity:0;height:0;overflow:hidden;transform:translatez(0);transition:height 250ms cubic-bezier(0.694, 0.0482, 0.335, 1),opacity 250ms cubic-bezier(0.694, 0.0482, 0.335, 1)}.spcCopyToSpaceResultDetails__selectControl.spcCopyToSpaceResultDetails__selectControl-isOpen .spcCopyToSpaceResultDetails__selectControl__childWrapper{visibility:visible;opacity:1;height:auto}\n",""]),e.exports=t},function(e,t,s){var o=s(34),a=s(132);"string"==typeof(a=a.__esModule?a.default:a)&&(a=[[e.i,a,""]]);var n={insert:"head",singleton:!1};o(a,n);e.exports=a.locals||{}},function(e,t,s){(t=s(35)(!1)).push([e.i,".spcCopyToSpaceResultDetails{margin-top:8px;padding-left:24px}.spcCopyToSpaceResultDetails__row{margin-bottom:4px}.spcCopyToSpaceResultDetails__savedObjectName{min-width:0}.spcCopyToSpaceResultDetails__selectControl{margin-left:24px}.spcCopyToSpaceResultDetails__selectControl__childWrapper{visibility:hidden;opacity:0;height:0;overflow:hidden;transform:translatez(0);transition:height 250ms cubic-bezier(0.694, 0.0482, 0.335, 1),opacity 250ms cubic-bezier(0.694, 0.0482, 0.335, 1)}.spcCopyToSpaceResultDetails__selectControl.spcCopyToSpaceResultDetails__selectControl-isOpen .spcCopyToSpaceResultDetails__selectControl__childWrapper{visibility:visible;opacity:1;height:auto}\n",""]),e.exports=t},function(e,t,s){var o=s(34),a=s(134);"string"==typeof(a=a.__esModule?a.default:a)&&(a=[[e.i,a,""]]);var n={insert:"head",singleton:!1};o(a,n);e.exports=a.locals||{}},function(e,t,s){(t=s(35)(!1)).push([e.i,".spcCopyToSpaceResultDetails{margin-top:8px;padding-left:24px}.spcCopyToSpaceResultDetails__row{margin-bottom:4px}.spcCopyToSpaceResultDetails__savedObjectName{min-width:0}.spcCopyToSpaceResultDetails__selectControl{margin-left:24px}.spcCopyToSpaceResultDetails__selectControl__childWrapper{visibility:hidden;opacity:0;height:0;overflow:hidden;transform:translatez(0);transition:height 250ms cubic-bezier(0.694, 0.0482, 0.335, 1),opacity 250ms cubic-bezier(0.694, 0.0482, 0.335, 1)}.spcCopyToSpaceResultDetails__selectControl.spcCopyToSpaceResultDetails__selectControl-isOpen .spcCopyToSpaceResultDetails__selectControl__childWrapper{visibility:visible;opacity:1;height:auto}\n",""]),e.exports=t},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,s){"use strict";s.r(t),s.d(t,"CopyToSpaceFlyoutInternal",(function(){return J}));var o=s(2),a=s(17),n=s(1),i=s.n(n),c=s(3),r=s(10),l=s(12);function p(e){const{success:t,errors:s=[],successResults:o=[]}=e;return{success:t,failedImports:s.map((({error:e,...t})=>({obj:t,error:e}))),successfulImports:o}}const u=e=>"conflict"===e.error.type||"ambiguous_conflict"===e.error.type,d=e=>"missing_references"===e.error.type,g=(e,t)=>e.type>t.type?1:e.type<t.type?-1:0;function j(e,t){var s,o,a,n,i;const c=null!==(s=null==t?void 0:t.failedImports.filter(u))&&void 0!==s?s:[],r=null!==(o=null==t?void 0:t.failedImports.filter(d))&&void 0!==o?o:[],l=null!==(a=null==t?void 0:t.failedImports.filter((e=>{return!u(t=e)&&!d(t);var t})))&&void 0!==a?a:[],p=({type:e,id:s})=>{const o=c.find((({obj:t})=>t.type===e&&t.id===s)),a=r.find((({obj:t})=>t.type===e&&t.id===s));return{conflict:o,hasMissingReferences:void 0!==a,hasUnresolvableErrors:l.some((({obj:t})=>t.type===e&&t.id===s)),overwrite:!o&&(a?!0===a.obj.overwrite:!0===(null==t?void 0:t.successfulImports.some((t=>t.type===e&&t.id===s&&t.overwrite))))}},j=new Map;j.set(`${e.type}:${e.id}`,{type:e.type,id:e.id,name:e.title,icon:e.icon,...p(e)});const b=e=>{e.forEach((e=>{const{type:t,id:s,meta:o}=e;j.set(`${t}:${s}`,{type:t,id:s,name:o.title||`${t} [id=${s}]`,icon:o.icon||"apps",...p(e)})}))};b((null!==(n=null==t?void 0:t.failedImports)&&void 0!==n?n:[]).map((({obj:e})=>e)).sort(g));if(b((null!==(i=null==t?void 0:t.successfulImports)&&void 0!==i?i:[]).sort(g)),void 0===t)return{processing:!0,objects:Array.from(j.values())};const m=Boolean(t&&0===t.failedImports.length);if(m)return{successful:m,hasConflicts:!1,objects:Array.from(j.values()),hasMissingReferences:!1,hasUnresolvableErrors:!1,processing:!1};const f=c.length>0,x=r.length>0,y=l.length>0;return{successful:m,hasConflicts:f,objects:Array.from(j.values()),hasMissingReferences:x,hasUnresolvableErrors:y,processing:!1}}var b=s(0);const m=({error:{type:e}})=>["conflict","ambiguous_conflict","missing_references"].includes(e),f=e=>!m(e),x=e=>{const{copyInProgress:t,conflictResolutionInProgress:s,initialCopyFinished:a,copyResult:i,retries:l}=e;let p={successCount:0,pendingCount:0,skippedCount:0,errorCount:0};i&&(p=Object.entries(i).reduce(((e,t)=>{const[s,o]=t;let a=0,n=0,i=0,c=0;if(!0===o.success)a=o.successfulImports.length;else{const e=o.failedImports.filter(m).reduce(((e,{obj:{type:t,id:s}})=>e.add(`${t}:${s}`)),new Set);n=(l[s]||[]).length,i=e.size+o.successfulImports.length-n,c=o.failedImports.filter(f).length}return{loading:!1,successCount:e.successCount+a,pendingCount:e.pendingCount+n,skippedCount:e.skippedCount+i,errorCount:e.errorCount+c}}),p));const u=()=>{let n;if(a){const t=p.pendingCount>0?Object(b.jsx)(r.FormattedMessage,{id:"xpack.spaces.management.copyToSpace.finishPendingOverwritesCopyToSpacesButton",defaultMessage:"Copy {overwriteCount} objects",values:{overwriteCount:p.pendingCount}}):Object(b.jsx)(r.FormattedMessage,{id:"xpack.spaces.management.copyToSpace.finishCopyToSpacesButton",defaultMessage:"Finish"});n=Object(b.jsx)(o.EuiButton,{fill:!0,isLoading:s,"aria-live":"assertive","aria-label":s?c.i18n.translate("xpack.spaces.management.copyToSpace.inProgressButtonLabel",{defaultMessage:"Copy is in progress. Please wait."}):c.i18n.translate("xpack.spaces.management.copyToSpace.finishedButtonLabel",{defaultMessage:"Copy finished."}),onClick:()=>e.onCopyFinish(),"data-test-subj":"cts-finish-button"},t)}else n=Object(b.jsx)(o.EuiButton,{fill:!0,isLoading:t,onClick:()=>e.onCopyStart(),"data-test-subj":"cts-initiate-button",disabled:0===e.numberOfSelectedSpaces||t},e.numberOfSelectedSpaces>0?Object(b.jsx)(r.FormattedMessage,{id:"xpack.spaces.management.copyToSpace.copyToSpacesButton",defaultMessage:"Copy to {spaceCount} {spaceCount, plural, one {space} other {spaces}}",values:{spaceCount:e.numberOfSelectedSpaces}}):Object(b.jsx)(r.FormattedMessage,{id:"xpack.spaces.management.copyToSpace.disabledCopyToSpacesButton",defaultMessage:"Copy"}));return Object(b.jsx)(o.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(b.jsx)(o.EuiFlexItem,{grow:!1},Object(b.jsx)(o.EuiButtonEmpty,{onClick:()=>e.onClose(),"data-test-subj":"cts-cancel-button",disabled:t&&!a||s||p.successCount>0},Object(b.jsx)(r.FormattedMessage,{id:"xpack.spaces.management.copyToSpace.cancelButton",defaultMessage:"Cancel"}))),Object(b.jsx)(o.EuiFlexItem,{grow:!1},n))};return t?Object(b.jsx)(n.Fragment,null,Object(b.jsx)(o.EuiFlexGroup,null,Object(b.jsx)(o.EuiFlexItem,null,Object(b.jsx)(o.EuiStat,{"data-test-subj":"cts-summary-success-count",title:p.successCount,titleSize:"s",titleColor:a?"secondary":"subdued",isLoading:!a,textAlign:"center",description:Object(b.jsx)(r.FormattedMessage,{id:"xpack.spaces.management.copyToSpaceFlyoutFooter.successCount",defaultMessage:"Copied"})})),Object(b.jsx)(o.EuiFlexItem,null,Object(b.jsx)(o.EuiStat,{"data-test-subj":"cts-summary-pending-count",title:p.pendingCount,titleSize:"s",titleColor:p.pendingCount>0?"primary":"subdued",isLoading:!a,textAlign:"center",description:Object(b.jsx)(r.FormattedMessage,{id:"xpack.spaces.management.copyToSpaceFlyoutFooter.pendingCount",defaultMessage:"Pending"})})),Object(b.jsx)(o.EuiFlexItem,null,Object(b.jsx)(o.EuiStat,{"data-test-subj":"cts-summary-skipped-count",title:p.skippedCount,titleSize:"s",titleColor:p.skippedCount>0?"primary":"subdued",isLoading:!a,textAlign:"center",description:Object(b.jsx)(r.FormattedMessage,{id:"xpack.spaces.management.copyToSpaceFlyoutFooter.skippedCount",defaultMessage:"Skipped"})})),Object(b.jsx)(o.EuiFlexItem,null,Object(b.jsx)(o.EuiStat,{"data-test-subj":"cts-summary-error-count",title:p.errorCount,titleSize:"s",titleColor:p.errorCount>0?"danger":"subdued",isLoading:!a,textAlign:"center",description:Object(b.jsx)(r.FormattedMessage,{id:"xpack.spaces.management.copyToSpaceFlyoutFooter.errorCount",defaultMessage:"Errors"})}))),Object(b.jsx)(o.EuiHorizontalRule,null),u()):u()},y={id:"createNewCopiesDisabled",text:c.i18n.translate("xpack.spaces.management.copyToSpace.copyModeControl.createNewCopies.disabledTitle",{defaultMessage:"Check for existing objects"}),tooltip:c.i18n.translate("xpack.spaces.management.copyToSpace.copyModeControl.createNewCopies.disabledText",{defaultMessage:"Check if objects were previously copied or imported into the space."})},h={id:"createNewCopiesEnabled",text:c.i18n.translate("xpack.spaces.management.copyToSpace.copyModeControl.createNewCopies.enabledTitle",{defaultMessage:"Create new objects with random IDs"}),tooltip:c.i18n.translate("xpack.spaces.management.copyToSpace.copyModeControl.createNewCopies.enabledText",{defaultMessage:"Use this option to create one or more copies of the object in the same space."})},C={id:"overwriteEnabled",label:c.i18n.translate("xpack.spaces.management.copyToSpace.copyModeControl.overwrite.enabledLabel",{defaultMessage:"Automatically overwrite conflicts"})},v={id:"overwriteDisabled",label:c.i18n.translate("xpack.spaces.management.copyToSpace.copyModeControl.overwrite.disabledLabel",{defaultMessage:"Request action on conflict"})},O={id:"includeRelated",text:c.i18n.translate("xpack.spaces.management.copyToSpace.copyModeControl.includeRelated.title",{defaultMessage:"Include related objects"}),tooltip:c.i18n.translate("xpack.spaces.management.copyToSpace.copyModeControl.includeRelated.text",{defaultMessage:"Copy this object and its related objects. For dashboards, related visualizations, index patterns, and saved searches are also copied."})},S=c.i18n.translate("xpack.spaces.management.copyToSpace.copyModeControl.copyOptionsTitle",{defaultMessage:"Copy options"}),_=c.i18n.translate("xpack.spaces.management.copyToSpace.copyModeControl.relationshipOptionsTitle",{defaultMessage:"Relationship"}),T=({text:e,tooltip:t})=>Object(b.jsx)(o.EuiFlexGroup,null,Object(b.jsx)(o.EuiFlexItem,null,Object(b.jsx)(o.EuiText,null,e)),Object(b.jsx)(o.EuiFlexItem,{grow:!1},Object(b.jsx)(o.EuiIconTip,{content:t,position:"left",type:"iInCircle"}))),w=({initialValues:e,updateSelection:t})=>{const[s,a]=Object(n.useState)(e.createNewCopies),[c,r]=Object(n.useState)(e.overwrite),l=e=>{void 0!==e.createNewCopies?a(e.createNewCopies):void 0!==e.overwrite&&r(e.overwrite),t({createNewCopies:s,overwrite:c,...e})};return Object(b.jsx)(i.a.Fragment,null,Object(b.jsx)(o.EuiFormFieldset,{legend:{children:Object(b.jsx)(o.EuiTitle,{size:"xs"},Object(b.jsx)("span",null,S))}},Object(b.jsx)(o.EuiCheckableCard,{id:h.id,label:T(h),checked:s,onChange:()=>l({createNewCopies:!0})}),Object(b.jsx)(o.EuiSpacer,{size:"s"}),Object(b.jsx)(o.EuiCheckableCard,{id:y.id,label:T(y),checked:!s,onChange:()=>l({createNewCopies:!1})},Object(b.jsx)(o.EuiRadioGroup,{options:[C,v],idSelected:c?C.id:v.id,onChange:e=>l({overwrite:e===C.id}),disabled:s,"data-test-subj":"cts-copyModeControl-overwriteRadioGroup"}))),Object(b.jsx)(o.EuiSpacer,{size:"m"}),Object(b.jsx)(o.EuiFormFieldset,{legend:{children:Object(b.jsx)(o.EuiTitle,{size:"xs"},Object(b.jsx)("span",null,_))}},Object(b.jsx)(o.EuiCheckableCard,{id:O.id,label:T(O),checkableType:"checkbox",checked:!0,onChange:()=>{},disabled:!0})))};s(90);var M=s(14),E=s(5);const R=Object(n.lazy)((()=>Object(E.a)().then((e=>({default:e}))))),k=e=>{if(0===e.spaces.length)return Object(b.jsx)(o.EuiLoadingSpinner,null);const t=Object(b.jsx)(o.EuiIconTip,{content:Object(b.jsx)(r.FormattedMessage,{id:"xpack.spaces.management.copyToSpace.selectSpacesControl.disabledTooltip",defaultMessage:"The object already exists in this space."}),position:"left",type:"iInCircle"}),s=e.spaces.map((s=>{const o=e.disabledSpaceIds.has(s.id);return{label:s.name,prepend:Object(b.jsx)(R,{space:s,size:"s"}),append:o?t:null,checked:e.selectedSpaceIds.includes(s.id)?"on":void 0,disabled:o,"data-space-id":s.id,"data-test-subj":`cts-space-selector-row-${s.id}`}}));return Object(b.jsx)(n.Suspense,{fallback:Object(b.jsx)(o.EuiLoadingSpinner,null)},Object(b.jsx)(o.EuiSelectable,{options:s,onChange:t=>function(t){if(e.disabled)return;const s=t.filter((e=>e.checked)).map((e=>e["data-space-id"]));e.onChange(s)}(t),listProps:{bordered:!0,rowHeight:40,className:"spcCopyToSpace__spacesList","data-test-subj":"cts-form-space-selector"},searchable:s.length>M.SPACE_SEARCH_COUNT_THRESHOLD},((e,t)=>Object(b.jsx)(i.a.Fragment,null,t,e))))},I=e=>{const{savedObjectTarget:t,spaces:s,onUpdate:a,copyOptions:n}=e,i=e=>e?new Set:t.namespaces.reduce(((e,t)=>e.add(t)),new Set);return Object(b.jsx)("div",{"data-test-subj":"copy-to-space-form"},Object(b.jsx)(w,{initialValues:n,updateSelection:e=>(({createNewCopies:e,overwrite:t})=>{const s=i(e),o=n.selectedSpaceIds.filter((e=>!s.has(e)));a({...n,createNewCopies:e,overwrite:t,selectedSpaceIds:o})})(e)}),Object(b.jsx)(o.EuiSpacer,{size:"m"}),Object(b.jsx)(o.EuiFormRow,{label:Object(b.jsx)(o.EuiTitle,{size:"xs"},Object(b.jsx)("span",null,Object(b.jsx)(r.FormattedMessage,{id:"xpack.spaces.management.copyToSpace.selectSpacesLabel",defaultMessage:"Select spaces"}))),fullWidth:!0},Object(b.jsx)(k,{spaces:s,selectedSpaceIds:n.selectedSpaceIds,disabledSpaceIds:i(n.createNewCopies),onChange:e=>{return t=e,a({...n,selectedSpaceIds:t});var t}})))};s(99),s(108);var F=s(4),D=s.n(F);s(117);const z=[{id:"overwrite",text:c.i18n.translate("xpack.spaces.management.copyToSpace.overwriteAllConflictsText",{defaultMessage:"Overwrite all"})},{id:"skip",text:c.i18n.translate("xpack.spaces.management.copyToSpace.skipAllConflictsText",{defaultMessage:"Skip all"})}];class resolve_all_conflicts_ResolveAllConflicts extends n.Component{constructor(...e){super(...e),D()(this,"state",{isPopoverOpen:!1}),D()(this,"onSelect",(e=>{const{summarizedCopyResult:t,retries:s,onRetriesChange:o,onDestinationMapChange:a}=this.props,n="overwrite"===e;if(n){const e=s.filter((e=>!0===e.overwrite)),a=t.objects.reduce(((t,{type:s,id:o,conflict:a})=>{if(a&&!e.some((e=>e.type===s&&e.id===o))){const{error:e}=a,i="conflict"===e.type?e.destinationId:e.destinations[0].id;return[...t,{type:s,id:o,overwrite:n,...i&&{destinationId:i}}]}return t}),new Array);o([...s,...a])}else{const e=t.objects.reduce(((e,{type:t,id:s,conflict:o})=>o?e.add(`${t}:${s}`):e),new Set);o(s.filter((({type:t,id:s})=>!e.has(`${t}:${s}`)))),a(void 0)}this.setState({isPopoverOpen:!1})})),D()(this,"onButtonClick",(()=>{this.setState({isPopoverOpen:!this.state.isPopoverOpen})})),D()(this,"closePopover",(()=>{this.setState({isPopoverOpen:!1})}))}render(){const e=Object(b.jsx)(o.EuiLink,{onClick:this.onButtonClick,className:"spcCopyToSpace__resolveAllConflictsLink"},Object(b.jsx)(r.FormattedMessage,{id:"xpack.spaces.management.copyToSpace.resolveAllConflictsLink",defaultMessage:"(resolve all)"})),t=z.map((e=>Object(b.jsx)(o.EuiContextMenuItem,{"data-test-subj":`cts-resolve-all-conflicts-${e.id}`,key:e.id,onClick:()=>{this.onSelect(e.id)}},e.text)));return Object(b.jsx)(o.EuiPopover,{id:"resolveAllConflictsVisibilityPopover",button:e,isOpen:this.state.isPopoverOpen,closePopover:this.closePopover,panelPaddingSize:"none",anchorPosition:"downLeft"},Object(b.jsx)(o.EuiContextMenuPanel,{items:t}))}}const L=e=>{const{summarizedCopyResult:t}=e;return Object(b.jsx)(n.Fragment,null,(e=>{const{space:t,summarizedCopyResult:s,conflictResolutionInProgress:a,retries:i,onRetriesChange:c,onDestinationMapChange:l}=e,p=e=>`cts-summary-indicator-${e}-${t.id}`;if(s.processing||a)return Object(b.jsx)(o.EuiLoadingSpinner,{"data-test-subj":p("loading")});const{successful:u,hasUnresolvableErrors:d,hasMissingReferences:g,hasConflicts:j}=s;if(u)return Object(b.jsx)(o.EuiIconTip,{type:"checkInCircleFilled",color:"success",iconProps:{"data-test-subj":p("success")},content:Object(b.jsx)(r.FormattedMessage,{id:"xpack.spaces.management.copyToSpace.copyStatusSummary.successMessage",defaultMessage:"Copy to the {space} space was successful.",values:{space:t.name}})});if(d)return Object(b.jsx)(o.EuiIconTip,{type:"alert",color:"danger",iconProps:{"data-test-subj":p("failed")},content:Object(b.jsx)(r.FormattedMessage,{id:"xpack.spaces.management.copyToSpace.copyStatusSummary.failedMessage",defaultMessage:"Copy to the {space} space failed. Expand this section for details.",values:{space:t.name}})});const m=g?Object(b.jsx)("span",{className:"spcCopyToSpace__missingReferencesIcon"},Object(b.jsx)(o.EuiIconTip,{type:"link",color:"warning",iconProps:{"data-test-subj":p("missingReferences")},content:Object(b.jsx)(r.FormattedMessage,{id:"xpack.spaces.management.copyToSpace.copyStatusSummary.missingReferencesMessage",defaultMessage:"Missing references detected in the {space} space. Expand this section for details.",values:{space:t.name}})})):null;return j?Object(b.jsx)(n.Fragment,null,Object(b.jsx)(resolve_all_conflicts_ResolveAllConflicts,{summarizedCopyResult:s,retries:i,onRetriesChange:c,onDestinationMapChange:l}),Object(b.jsx)(o.EuiIconTip,{type:"alert",color:"warning",iconProps:{"data-test-subj":p("conflicts")},content:Object(b.jsx)(r.FormattedMessage,{id:"xpack.spaces.management.copyToSpace.copyStatusSummary.conflictsMessage",defaultMessage:"Conflicts detected in the {space} space. Expand this section to resolve.",values:{space:t.name}})}),m):m})(e),Object(b.jsx)(o.EuiBadge,{color:"#DDD",className:"spcCopyToSpace__summaryCountBadge"},t.objects.length))};s(126);var N=s(33),P=s.n(N);const A=e=>{const{summarizedCopyResult:t,conflictResolutionInProgress:s,pendingObjectRetry:a}=e;if(t.processing||s)return Object(b.jsx)(o.EuiLoadingSpinner,null);const i=t.objects.find((t=>t.type===e.object.type&&t.id===e.object.id)),{conflict:c,hasMissingReferences:l,hasUnresolvableErrors:p,overwrite:u}=i,d=c&&!(null!=a&&a.overwrite),g=!l&&!p&&!d;if(g&&!a){const e=u?Object(b.jsx)(r.FormattedMessage,{id:"xpack.spaces.management.copyToSpace.copyStatus.successAutomaticOverwriteMessage",defaultMessage:"Object was overwritten."}):Object(b.jsx)(r.FormattedMessage,{id:"xpack.spaces.management.copyToSpace.copyStatus.successMessage",defaultMessage:"Object was copied."});return Object(b.jsx)(o.EuiIconTip,{type:"checkInCircleFilled",color:"success",content:e})}if(g&&a){const e=u?Object(b.jsx)(r.FormattedMessage,{id:"xpack.spaces.management.copyToSpace.copyStatus.pendingAutomaticOverwriteMessage",defaultMessage:"Object will be overwritten."}):null!=a&&a.overwrite?Object(b.jsx)(r.FormattedMessage,{id:"xpack.spaces.management.copyToSpace.copyStatus.pendingOverwriteMessage",defaultMessage:"Object will be overwritten. Disable 'Overwrite' to skip."}):Object(b.jsx)(r.FormattedMessage,{id:"xpack.spaces.management.copyToSpace.copyStatus.pendingMessage",defaultMessage:"Object will be copied."});return Object(b.jsx)(o.EuiIconTip,{type:"check",color:"warning",content:e})}if(p)return Object(b.jsx)(o.EuiIconTip,{type:"alert",color:"danger","data-test-subj":`cts-object-result-error-${i.id}`,content:Object(b.jsx)(r.FormattedMessage,{id:"xpack.spaces.management.copyToSpace.copyStatus.unresolvableErrorMessage",defaultMessage:"An error occurred copying this object."})});if(d)switch(c.error.type){case"conflict":return Object(b.jsx)(o.EuiIconTip,{type:"alert",color:"warning",content:Object(b.jsx)(n.Fragment,null,Object(b.jsx)(r.FormattedMessage,{id:"xpack.spaces.management.copyToSpace.copyStatus.conflictMessage",defaultMessage:"This conflicts with an existing object. Enable ‘Overwrite’ to replace it."}))});case"ambiguous_conflict":return Object(b.jsx)(o.EuiIconTip,{type:"alert",color:"warning",content:Object(b.jsx)(n.Fragment,null,Object(b.jsx)(r.FormattedMessage,{id:"xpack.spaces.management.copyToSpace.copyStatus.ambiguousConflictMessage",defaultMessage:"This conflicts with multiple existing objects. Enable ‘Overwrite’ to replace one."}))})}return l?Object(b.jsx)(o.EuiIconTip,{type:"link",color:"warning","data-test-subj":`cts-object-result-missing-references-${i.id}`,content:u?Object(b.jsx)(r.FormattedMessage,{id:"xpack.spaces.management.copyToSpace.copyStatus.missingReferencesAutomaticOverwriteMessage",defaultMessage:"Object will be overwritten, but one or more references are missing."}):c?Object(b.jsx)(r.FormattedMessage,{id:"xpack.spaces.management.copyToSpace.copyStatus.missingReferencesOverwriteMessage",defaultMessage:"Object will be overwritten, but one or more references are missing. Disable 'Overwrite' to skip."}):Object(b.jsx)(r.FormattedMessage,{id:"xpack.spaces.management.copyToSpace.copyStatus.missingReferencesMessage",defaultMessage:"Object will be copied, but one or more references are missing."})}):null};function $(e){switch(e){case"index-pattern":case"index-patterns":case"indexPatterns":return"index patterns";default:return e}}const B=e=>"ambiguous_conflict"===e.type,G=e=>{const{destinationMap:t,onDestinationMapChange:s,summarizedCopyResult:a}=e,{objects:i}=a;return Object(b.jsx)("div",{className:"spcCopyToSpaceResultDetails"},i.map(((a,i)=>{const{type:r,id:l,name:p,icon:u,conflict:d}=a,g=e.retries.find((e=>e.type===r&&e.id===l)),j=Boolean(null==g?void 0:g.overwrite),m={show:d&&!e.conflictResolutionInProgress,label:c.i18n.translate("xpack.spaces.management.copyToSpace.copyDetail.overwriteSwitch",{defaultMessage:"Overwrite?"}),onChange:({target:{checked:o}})=>{const a=e.retries.filter((e=>e.type!==r||e.id!==l)),{error:n}=d;if(o){const s=B(n)?t.get(`${r}:${l}`):n.destinationId,o={type:r,id:l,overwrite:!0,...s&&{destinationId:s}};e.onRetriesChange([...a,o])}else if(e.onRetriesChange(a),B(n)){const e=n.destinations[0].id;s(new Map(t.set(`${r}:${l}`,e)))}}},f={options:null!=d&&d.error&&B(d.error)?d.error.destinations.map((e=>{var t;const s=null!==(t=e.title)&&void 0!==t?t:`${r} [id=${e.id}]`,a=e.updatedAt?P()(e.updatedAt).fromNow():"never";return{value:e.id,inputDisplay:e.id,dropdownDisplay:Object(b.jsx)(n.Fragment,null,Object(b.jsx)("strong",null,s),Object(b.jsx)(o.EuiText,{size:"s",color:"subdued"},Object(b.jsx)("p",{className:"euiTextColor--subdued"},"ID: ",e.id,Object(b.jsx)("br",null),"Last updated: ",a)))}})):[],onChange:o=>{s(new Map(t.set(`${r}:${l}`,o)));const a=e.retries.filter((e=>e.type!==r||e.id!==l)),n={type:r,id:l,overwrite:!0,destinationId:o};e.onRetriesChange([...a,n])}},x=f.options.length>0&&j?" spcCopyToSpaceResultDetails__selectControl-isOpen":"";return Object(b.jsx)(n.Fragment,{key:i},Object(b.jsx)(o.EuiFlexGroup,{responsive:!1,key:i,alignItems:"center",gutterSize:"s",className:"spcCopyToSpaceResultDetails__row"},Object(b.jsx)(o.EuiFlexItem,{grow:!1},Object(b.jsx)(o.EuiToolTip,{position:"top",content:$(r)},Object(b.jsx)(o.EuiIcon,{"aria-label":$(r),type:u,size:"s"}))),Object(b.jsx)(o.EuiFlexItem,{grow:5,className:"spcCopyToSpaceResultDetails__savedObjectName"},Object(b.jsx)(o.EuiText,{size:"s"},Object(b.jsx)("p",{className:"eui-textTruncate",title:p},p))),m.show&&Object(b.jsx)(o.EuiFlexItem,{grow:!1},Object(b.jsx)(o.EuiSwitch,{label:m.label,compressed:!0,checked:j,onChange:m.onChange,"data-test-subj":`cts-overwrite-conflict-${r}:${l}`})),Object(b.jsx)(o.EuiFlexItem,{className:"spcCopyToSpaceResultDetails__statusIndicator",grow:!1},Object(b.jsx)("div",{className:"eui-textRight"},Object(b.jsx)(A,{summarizedCopyResult:e.summarizedCopyResult,object:a,pendingObjectRetry:g,conflictResolutionInProgress:e.conflictResolutionInProgress&&j})))),Object(b.jsx)("div",{className:"spcCopyToSpaceResultDetails__selectControl"+x},Object(b.jsx)("div",{className:"spcCopyToSpaceResultDetails__selectControl__childWrapper"},Object(b.jsx)(o.EuiSuperSelect,{options:f.options,valueOfSelected:t.get(`${r}:${l}`),onChange:f.onChange,prepend:c.i18n.translate("xpack.spaces.management.copyToSpace.copyDetail.selectControlLabel",{defaultMessage:"Object ID"}),hasDividers:!0,fullWidth:!0,compressed:!0}))))})))},U=Object(n.lazy)((()=>Object(E.a)().then((e=>({default:e}))))),W=e=>e.reduce(((e,{type:t,id:s,conflict:o})=>("ambiguous_conflict"===(null==o?void 0:o.error.type)&&e.set(`${t}:${s}`,o.error.destinations[0].id),e)),new Map),H=e=>{const{space:t}=e;return Object(b.jsx)(o.EuiAccordion,{id:`copyToSpace-${t.id}`,"data-test-subj":`cts-space-result-${t.id}`,className:"spcCopyToSpaceResult",buttonContent:Object(b.jsx)(o.EuiFlexGroup,{responsive:!1},Object(b.jsx)(o.EuiFlexItem,{grow:!1},Object(b.jsx)(n.Suspense,{fallback:Object(b.jsx)(o.EuiLoadingSpinner,null)},Object(b.jsx)(U,{space:t,size:"s"}))),Object(b.jsx)(o.EuiFlexItem,null,Object(b.jsx)(o.EuiText,null,t.name))),extraAction:Object(b.jsx)(o.EuiLoadingSpinner,null)},Object(b.jsx)(o.EuiSpacer,{size:"s"}),Object(b.jsx)(o.EuiLoadingSpinner,null))},V=e=>{const{space:t,summarizedCopyResult:s,retries:a,onRetriesChange:i,conflictResolutionInProgress:c}=e,{objects:r}=s,l=a.some((e=>e.overwrite)),[p,u]=Object(n.useState)(W(r)),d=e=>{u(e||W(r))};return Object(b.jsx)(o.EuiAccordion,{id:`copyToSpace-${t.id}`,"data-test-subj":`cts-space-result-${t.id}`,className:"spcCopyToSpaceResult",buttonContent:Object(b.jsx)(o.EuiFlexGroup,{responsive:!1},Object(b.jsx)(o.EuiFlexItem,{grow:!1},Object(b.jsx)(n.Suspense,{fallback:Object(b.jsx)(o.EuiLoadingSpinner,null)},Object(b.jsx)(U,{space:t,size:"s"}))),Object(b.jsx)(o.EuiFlexItem,null,Object(b.jsx)(o.EuiText,null,t.name))),extraAction:Object(b.jsx)(L,{space:t,retries:a,onRetriesChange:i,onDestinationMapChange:d,summarizedCopyResult:s,conflictResolutionInProgress:c&&l})},Object(b.jsx)(o.EuiSpacer,{size:"s"}),Object(b.jsx)(G,{summarizedCopyResult:s,space:t,retries:a,onRetriesChange:i,destinationMap:p,onDestinationMapChange:d,conflictResolutionInProgress:c&&l}))},q=e=>Object(b.jsx)("div",{"data-test-subj":"copy-to-space-processing"},(({createNewCopies:e,overwrite:t,includeRelated:s})=>{const a=e?Object(b.jsx)(r.FormattedMessage,{id:"xpack.spaces.management.copyToSpace.createNewCopiesLabel",defaultMessage:"Create new objects with random IDs"}):Object(b.jsx)(r.FormattedMessage,{id:"xpack.spaces.management.copyToSpace.dontCreateNewCopiesLabel",defaultMessage:"Check for existing objects"});return Object(b.jsx)(o.EuiListGroup,{className:"spcCopyToSpaceOptionsView",flush:!0},Object(b.jsx)(o.EuiListGroupItem,{iconType:"copy",label:a}),!e&&Object(b.jsx)(o.EuiListGroupItem,{iconType:t?"check":"cross",label:Object(b.jsx)(r.FormattedMessage,{id:"xpack.spaces.management.copyToSpace.overwriteLabel",defaultMessage:"Automatically overwrite conflicts"})}),Object(b.jsx)(o.EuiListGroupItem,{iconType:s?"check":"cross",label:Object(b.jsx)(r.FormattedMessage,{id:"xpack.spaces.management.copyToSpace.includeRelatedLabel",defaultMessage:"Include related saved objects"})}))})(e.copyOptions),Object(b.jsx)(o.EuiHorizontalRule,{margin:"m"}),Object(b.jsx)(o.EuiText,{size:"s"},Object(b.jsx)("h5",null,Object(b.jsx)(r.FormattedMessage,{id:"xpack.spaces.management.copyToSpace.copyResultsLabel",defaultMessage:"Results"}))),Object(b.jsx)(o.EuiSpacer,{size:"m"}),e.copyOptions.selectedSpaceIds.map((t=>{const s=e.spaces.find((e=>e.id===t)),a=e.copyResult[s.id],i=j(e.savedObjectTarget,a);return Object(b.jsx)(n.Fragment,{key:t},i.processing?Object(b.jsx)(H,{space:s}):Object(b.jsx)(V,{space:s,summarizedCopyResult:i,retries:e.retries[s.id]||[],onRetriesChange:t=>{return o=s.id,a=t,void e.onRetriesChange({...e.retries,[o]:a});var o,a},conflictResolutionInProgress:e.conflictResolutionInProgress}),Object(b.jsx)(o.EuiSpacer,{size:"s"}))}))),J=e=>{const{spacesManager:t,spacesDataPromise:s,services:i}=Object(l.b)(),{notifications:u}=i,d=u.toasts,{onClose:g=(()=>null),savedObjectTarget:j}=e,m=Object(n.useMemo)((()=>({type:j.type,id:j.id,namespaces:j.namespaces,icon:j.icon||"apps",title:j.title||`${j.type} [id=${j.id}]`})),[j]),[f,y]=Object(n.useState)({includeRelated:true,createNewCopies:true,overwrite:true,selectedSpaceIds:[]}),[{isLoading:h,spaces:C},v]=Object(n.useState)({isLoading:!0,spaces:[]});Object(n.useEffect)((()=>{s.then((({spacesMap:e})=>{v({isLoading:!1,spaces:[...e.values()].filter((({isActiveSpace:e,isAuthorizedForPurpose:t})=>!e&&t("copySavedObjectsIntoSpace")))})})).catch((e=>{d.addError(e,{title:c.i18n.translate("xpack.spaces.management.copyToSpace.spacesLoadErrorTitle",{defaultMessage:"Error loading available spaces"})})}))}),[s,d]);const[O,S]=Object(n.useState)(!1),[_,T]=Object(n.useState)(!1),[w,M]=Object(n.useState)({}),[E,R]=Object(n.useState)({}),k=Object.values(w).length>0,F=e=>{R(e)};return Object(b.jsx)(o.EuiFlyout,{onClose:g,maxWidth:600,"data-test-subj":"copy-to-space-flyout"},Object(b.jsx)(o.EuiFlyoutHeader,{hasBorder:!0},Object(b.jsx)(o.EuiFlexGroup,{alignItems:"center",gutterSize:"m"},Object(b.jsx)(o.EuiFlexItem,{grow:!1},Object(b.jsx)(o.EuiIcon,{size:"m",type:"copy"})),Object(b.jsx)(o.EuiFlexItem,null,Object(b.jsx)(o.EuiTitle,{size:"m"},Object(b.jsx)("h2",null,Object(b.jsx)(r.FormattedMessage,{id:"xpack.spaces.management.copyToSpaceFlyoutHeader",defaultMessage:"Copy to space"})))))),Object(b.jsx)(o.EuiFlyoutBody,null,Object(b.jsx)(o.EuiFlexGroup,{alignItems:"center",gutterSize:"m"},Object(b.jsx)(o.EuiFlexItem,{grow:!1},Object(b.jsx)(o.EuiIcon,{type:m.icon})),Object(b.jsx)(o.EuiFlexItem,null,Object(b.jsx)(o.EuiText,null,Object(b.jsx)("p",null,m.title)))),Object(b.jsx)(o.EuiHorizontalRule,{margin:"m"}),h?Object(b.jsx)(o.EuiLoadingSpinner,null):0===C.length?Object(b.jsx)(o.EuiEmptyPrompt,{body:Object(b.jsx)("p",null,Object(b.jsx)(r.FormattedMessage,{id:"xpack.spaces.management.copyToSpace.noSpacesBody",defaultMessage:"There are no eligible spaces to copy into."})),title:Object(b.jsx)("h3",null,Object(b.jsx)(r.FormattedMessage,{id:"xpack.spaces.management.copyToSpace.noSpacesTitle",defaultMessage:"No spaces available"}))}):O?Object(b.jsx)(q,{savedObjectTarget:m,copyInProgress:O,conflictResolutionInProgress:_,copyResult:w,spaces:C,copyOptions:f,retries:E,onRetriesChange:F}):Object(b.jsx)(I,{savedObjectTarget:m,spaces:C,copyOptions:f,onUpdate:y})),Object(b.jsx)(o.EuiFlyoutFooter,null,Object(b.jsx)(x,{copyInProgress:O,conflictResolutionInProgress:_,initialCopyFinished:k,copyResult:w,numberOfSelectedSpaces:f.selectedSpaceIds.length,retries:E,onClose:g,onCopyStart:async function(){S(!0),M({});try{const e=await t.copySavedObjects([{type:m.type,id:m.id}],f.selectedSpaceIds,f.includeRelated,f.createNewCopies,f.overwrite),s=Object(a.mapValues)(e,p);M(s);const o=e=>{const{failedImports:t,successfulImports:s}=e;if(!t.length)return[];const o=t.filter((({error:e})=>"missing_references"!==e.type)).reduce(((e,{obj:{type:t,id:s}})=>e.add(`${t}:${s}`)),new Set),a=t.filter((({obj:{type:e,id:t},error:s})=>"missing_references"===s.type&&!o.has(`${e}:${t}`)));return[...s.map((({type:e,id:t,overwrite:s,destinationId:o,createNewCopy:a})=>({type:e,id:t,overwrite:!0===s,destinationId:o,createNewCopy:a}))),...a.map((({obj:{type:e,id:t}})=>({type:e,id:t,overwrite:!1,ignoreMissingReferences:!0})))]},n=Object(a.mapValues)(s,o);R(n)}catch(e){S(!1),d.addError(e,{title:c.i18n.translate("xpack.spaces.management.copyToSpace.copyErrorTitle",{defaultMessage:"Error copying saved object"})})}},onCopyFinish:async function(){if(Object.values(E).some((e=>e.length))){T(!0);try{await t.resolveCopySavedObjectsErrors([{type:m.type,id:m.id}],E,f.includeRelated,f.createNewCopies),d.addSuccess(c.i18n.translate("xpack.spaces.management.copyToSpace.resolveCopySuccessTitle",{defaultMessage:"Copy successful"})),g()}catch(e){S(!1),d.addError(e,{title:c.i18n.translate("xpack.spaces.management.copyToSpace.resolveCopyErrorTitle",{defaultMessage:"Error resolving saved object conflicts"})})}}else g()}})))}}])]);