/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.ml_bundle_jsonpfunction=window.ml_bundle_jsonpfunction||[]).push([[6,22,23],Array(72).concat([function(e,t,a){"use strict";a.d(t,"d",(function(){return d})),a.d(t,"c",(function(){return u})),a.d(t,"a",(function(){return p})),a.d(t,"b",(function(){return m})),a.d(t,"e",(function(){return b})),a.d(t,"f",(function(){return h}));var i=a(2),n=a(91),s=a(193),r=a(67),o=a(269);function l(){return new Promise(((e,t)=>{r.ml.checkMlCapabilities().then((t=>{!0===t.upgradeInProgress&&Object(o.b)(!0),e(t)})).catch((()=>{t()}))}))}let c=Object(s.d)();function d(){return new Promise(((e,t)=>{new Promise(((e,t)=>{r.ml.checkManageMLCapabilities().then((t=>{!0===t.upgradeInProgress&&Object(o.b)(!0),e(t)})).catch((()=>{t()}))})).then((({capabilities:a,isPlatinumOrTrialLicense:i,mlFeatureEnabledInSpace:n})=>{c=a;return!0===Object.values(c).every((e=>!0===e))&&!0===i?e({mlFeatureEnabledInSpace:n}):t({capabilities:a,isPlatinumOrTrialLicense:i,mlFeatureEnabledInSpace:n})})).catch((e=>t()))}))}function u(e){return new Promise(((t,a)=>{l().then((async({capabilities:i,isPlatinumOrTrialLicense:n})=>(c=i,c.canGetJobs||!1===n?t(c):(await e(),a())))).catch((async t=>(await e(),a())))}))}function p(e){return new Promise(((t,a)=>{l().then((async({capabilities:i,isPlatinumOrTrialLicense:n})=>(c=i,c.canCreateJob||!1===n?t(c):(await e(),a())))).catch((async t=>(await e(),a())))}))}function m(e){return new Promise(((t,a)=>{l().then((async({capabilities:i})=>(c=i,c.canFindFileStructure?t(c):(await e(),a())))).catch((async t=>(await e(),a())))}))}function b(e){const t=Object(n.c)();return!0===c[e]&&!0!==t}function h(e){let t="";return Object(n.c)()?t=i.i18n.translate("xpack.ml.privilege.licenseHasExpiredTooltip",{defaultMessage:"Your license has expired."}):"canCreateJob"===e?t=i.i18n.translate("xpack.ml.privilege.noPermission.createMLJobsTooltip",{defaultMessage:"You do not have permission to create Machine Learning jobs."}):"canStartStopDatafeed"===e?t=i.i18n.translate("xpack.ml.privilege.noPermission.startOrStopDatafeedsTooltip",{defaultMessage:"You do not have permission to start or stop datafeeds."}):"canUpdateJob"===e?t=i.i18n.translate("xpack.ml.privilege.noPermission.editJobsTooltip",{defaultMessage:"You do not have permission to edit jobs."}):"canDeleteJob"===e?t=i.i18n.translate("xpack.ml.privilege.noPermission.deleteJobsTooltip",{defaultMessage:"You do not have permission to delete jobs."}):"canCreateCalendar"===e?t=i.i18n.translate("xpack.ml.privilege.noPermission.createCalendarsTooltip",{defaultMessage:"You do not have permission to create calendars."}):"canDeleteCalendar"===e?t=i.i18n.translate("xpack.ml.privilege.noPermission.deleteCalendarsTooltip",{defaultMessage:"You do not have permission to delete calendars."}):"canForecastJob"===e&&(t=i.i18n.translate("xpack.ml.privilege.noPermission.runForecastsTooltip",{defaultMessage:"You do not have permission to run forecasts."})),i.i18n.translate("xpack.ml.privilege.pleaseContactAdministratorTooltip",{defaultMessage:"{message} Please contact your administrator.",values:{message:t}})}},,,,,,,,function(e,t,a){var i;try{i={cloneDeep:a(527),constant:a(289),defaults:a(528),each:a(290),filter:a(294),find:a(529),flatten:a(533),forEach:a(291),forIn:a(534),has:a(304),isUndefined:a(307),last:a(535),map:a(308),mapValues:a(536),max:a(537),merge:a(539),min:a(551),minBy:a(552),now:a(553),pick:a(555),range:a(560),reduce:a(310),sortBy:a(561),uniqueId:a(567),values:a(315),zipObject:a(569)}}catch(e){}i||(i=window._),e.exports=i},,,function(e,t,a){"use strict";a.d(t,"f",(function(){return o})),a.d(t,"c",(function(){return l})),a.d(t,"d",(function(){return c})),a.d(t,"e",(function(){return d})),a.d(t,"b",(function(){return u})),a.d(t,"a",(function(){return p}));var i=a(67);let n={anomaly_detectors:{},datafeeds:{}},s={};const r={cloudId:null,isCloud:!1,deploymentId:null};async function o(){try{const e=await i.ml.mlInfo();return n=e.defaults,s=e.limits,r.cloudId=e.cloudId||null,r.isCloud=void 0!==e.cloudId,r.deploymentId=e.cloudId?p(e.cloudId):null,{defaults:n,limits:s,cloudId:r}}catch(e){return{defaults:n,limits:s,cloudId:r}}}function l(){return n}function c(){return s}function d(){return r.isCloud}function u(){return r.deploymentId}function p(e){const t=e.replace(/^(.+)?:/,"");try{const e=atob(t).match(/^.+\$(.+)(?=\$)/);return null!==e&&2===e.length?e[1]:null}catch(e){return null}}},function(e,t,a){"use strict";a.d(t,"j",(function(){return u})),a.d(t,"g",(function(){return p})),a.d(t,"h",(function(){return m})),a.d(t,"f",(function(){return b})),a.d(t,"k",(function(){return f})),a.d(t,"e",(function(){return j})),a.d(t,"d",(function(){return x})),a.d(t,"l",(function(){return v})),a.d(t,"m",(function(){return y})),a.d(t,"a",(function(){return O})),a.d(t,"b",(function(){return E})),a.d(t,"i",(function(){return w})),a.d(t,"c",(function(){return _}));var i=a(2),n=a(89),s=a(86),r=a(119),o=a(43),l=a(112),c=a(79),d=a(77);function u(e,t,a,i=!1){const o=i?function(e,t){return h(e.analysis_config.detectors)}(e):function(e,t){let a=e.analysis_config.detectors;const i=f(e,t);if(void 0!==t.aggregations&&e.analysis_config.detectors[0].function===s.b.NON_ZERO_COUNT&&!1===i){var n,r,o,c,d;const e=null==t||null===(n=t.aggregations)||void 0===n||null===(r=n.buckets)||void 0===r||null===(o=r.aggregations)||void 0===o||null===(c=o.dc_region)||void 0===c||null===(d=c.cardinality)||void 0===d?void 0:d.field;void 0!==e&&(a=[{function:s.b.DISTINCT_COUNT,field_name:e}])}else a=h(a),a=a.map((e=>{switch(e.function){case s.b.NON_ZERO_COUNT:return{...e,field_name:l.a,function:s.b.COUNT};case s.b.HIGH_NON_ZERO_COUNT:return{...e,field_name:l.a,function:s.b.HIGH_COUNT};case s.b.LOW_NON_ZERO_COUNT:return{...e,field_name:l.a,function:s.b.LOW_COUNT};case s.b.NON_NULL_SUM:return{...e,function:s.b.SUM};case s.b.HIGH_NON_NULL_SUM:return{...e,function:s.b.HIGH_SUM};case s.b.LOW_NON_NULL_SUM:return{...e,function:s.b.LOW_SUM};default:return e}}));return a}(e,t),c=(e=>t=>{let a=n.b.getFieldById(t);return null===a&&(t===r.b?a=l.c:e.length&&(a=e.find((e=>e.id===t))||null)),a})(a);return o.map((e=>{var t,a,i;let s=null,r=null,o=null,l=null;return void 0!==e.field_name&&(s=c(e.field_name)),void 0!==e.by_field_name&&(r=c(e.by_field_name)),void 0!==e.over_field_name&&(o=c(e.over_field_name)),void 0!==e.partition_field_name&&(l=c(e.partition_field_name)),{agg:n.b.getAggById(e.function),field:s,byField:r,overField:o,partitionField:l,excludeFrequent:null!==(t=e.exclude_frequent)&&void 0!==t?t:null,description:null!==(a=e.detector_description)&&void 0!==a?a:null,useNull:null!==(i=e.use_null)&&void 0!==i?i:null}}))}function p(e,t){return[...e.filter((e=>e.id!==l.a)).map((e=>({label:e.name}))),...t.filter((t=>!1===e.some((e=>e.id===t.id)))).map((e=>({label:e.id})))].sort(((e,t)=>e.label.localeCompare(t.label)))}function m(e){return null===e?[]:[{label:r.b}]}function b(e){return e?[{label:r.a}]:[{label:r.d}]}function h(e){return e.map((e=>{switch(e.function){case s.b.COUNT:case s.b.HIGH_COUNT:case s.b.LOW_COUNT:case s.b.NON_ZERO_COUNT:case s.b.HIGH_NON_ZERO_COUNT:case s.b.LOW_NON_ZERO_COUNT:case s.b.RARE:case s.b.FREQ_RARE:case s.b.TIME_OF_DAY:case s.b.TIME_OF_WEEK:return{...e,field_name:l.a};default:return e}}))}function f(e,t){var a,i,n,r,o;const l=e.analysis_config.detectors;if(void 0===(null==t||null===(a=t.aggregations)||void 0===a||null===(i=a.buckets)||void 0===i||null===(n=i.aggregations)||void 0===n||null===(r=n.dc_region)||void 0===r||null===(o=r.cardinality)||void 0===o?void 0:o.field))for(const e of l)if(s.c.includes(e.function))return!0;return!1}function g(e,t=!1,a=!1){var i;c.a.tempJobCloningObjects.job=e.jobConfig,c.a.tempJobCloningObjects.datafeed=e.datafeedConfig,c.a.tempJobCloningObjects.createdBy=null!==(i=e.createdBy)&&void 0!==i?i:void 0,c.a.tempJobCloningObjects.skipTimeRangeStep=t,!0===a&&(c.a.tempJobCloningObjects.start=e.start,c.a.tempJobCloningObjects.end=e.end),c.a.tempJobCloningObjects.calendars=e.calendars}function j(e,t){e.createdBy=d.a.MULTI_METRIC,e.modelPlot=!1,g(e,!0,!0),t(`jobs/new_job/${d.f.MULTI_METRIC}`,!0)}function x(e,t){e.createdBy=null,g(e,!0,!0),t(`jobs/new_job/${d.f.ADVANCED}`,!0)}function v(e,t){e.createdBy=null,g(e,!0,!1),t("/jobs/new_job")}function y(e,t){e.jobId="",g(e,!0,!0),t("/jobs/new_job")}function O(e,t){null!==e&&g(e,!1,!1),t("/jobs")}function E(e){return!1===e.some((e=>null===e.agg.dslName))}function w(e){switch(e.type){case d.f.SINGLE_METRIC:return i.i18n.translate("xpack.ml.newJob.wizard.jobCreatorTitle.singleMetric",{defaultMessage:"Single metric"});case d.f.MULTI_METRIC:return i.i18n.translate("xpack.ml.newJob.wizard.jobCreatorTitle.multiMetric",{defaultMessage:"Multi-metric"});case d.f.POPULATION:return i.i18n.translate("xpack.ml.newJob.wizard.jobCreatorTitle.population",{defaultMessage:"Population"});case d.f.ADVANCED:return i.i18n.translate("xpack.ml.newJob.wizard.jobCreatorTitle.advanced",{defaultMessage:"Advanced"});case d.f.CATEGORIZATION:return i.i18n.translate("xpack.ml.newJob.wizard.jobCreatorTitle.categorization",{defaultMessage:"Categorization"});case d.f.RARE:return i.i18n.translate("xpack.ml.newJob.wizard.jobCreatorTitle.rare",{defaultMessage:"Rare"});default:return""}}function _(e,t){for(const a in e)null!==e[a]&&"object"==typeof e[a]&&("aggregations"!==a&&"aggs"!==a||Object.keys(e[a]).forEach((e=>{"aggregations"!==e&&"aggs"!==e&&t.push({id:e,name:e,type:o.ES_FIELD_TYPES.KEYWORD,aggregatable:!0})})),_(e[a],t))}},function(e,t,a){"use strict";a.d(t,"a",(function(){return o})),a.d(t,"c",(function(){return l})),a.d(t,"e",(function(){return c})),a.d(t,"b",(function(){return d})),a.d(t,"d",(function(){return u})),a.d(t,"f",(function(){return p}));var i=a(67);let n=0,s=0,r=!1;async function o(e){try{const{count:e,lazyNodeCount:t}=await l();if(!(e>0||t>0))throw Error("Cannot load count of ML nodes");Promise.resolve()}catch(t){console.error(t),await e(),Promise.reject()}}async function l(){try{const e=await i.ml.mlNodeCount();return n=e.count,s=e.lazyNodeCount,r=!0,e}catch(e){return n=0,403===e.statusCode&&(r=!1),{count:0,lazyNodeCount:0}}}function c(){return 0!==n||0!==s}function d(){return 0!==n}function u(){return 0!==s}function p(){return r}},,,,function(e,t,a){"use strict";a.d(t,"a",(function(){return d})),a.d(t,"b",(function(){return u}));var i=a(4),n=a.n(i),s=a(112),r=a(43),o=a(67),l=a(264);const c=[r.ES_FIELD_TYPES.TEXT,r.ES_FIELD_TYPES.KEYWORD,r.ES_FIELD_TYPES.IP];class NewJobCapsService extends l.a{constructor(...e){super(...e),n()(this,"_catFields",[]),n()(this,"_dateFields",[]),n()(this,"_includeEventRateField",!0),n()(this,"_removeTextFields",!0)}get catFields(){return this._catFields}get dateFields(){return this._dateFields}get categoryFields(){return d(this._fields)}async initializeFromIndexPattern(e,t=!0,a=!0){try{this._includeEventRateField=t,this._removeTextFields=a;const i=await o.ml.jobs.newJobCaps(e.title,"rollup"===e.type),{fields:n,aggs:c}=function(e,t){const a=e[t],i=[],n=[],s={},r={};void 0!==a&&(a.aggs.forEach((e=>{const t={...e,...void 0!==e.fieldIds?{fields:[]}:{}};s[t.id]=t,n.push(t)})),a.fields.forEach((e=>{const t={...e,aggs:[]};void 0!==t.aggIds&&(r[t.id]=t.aggIds),i.push(t)})),i.forEach((e=>{r[e.id].forEach((t=>{!function(e,t){void 0===t.fields&&(t.fields=[]);void 0===e.aggs&&(e.aggs=[]);t.fields.push(e),e.aggs.push(t)}(e,s[t])}))})));return i.forEach((e=>delete e.aggIds)),n.forEach((e=>delete e.fieldIds)),{fields:i,aggs:n}}(i,e.title);!0===this._includeEventRateField&&function(e,t){const a={id:s.a,name:"Event rate",type:r.ES_FIELD_TYPES.INTEGER,aggregatable:!0,aggs:[]};e.forEach((e=>{void 0!==a.aggs&&void 0===e.fields&&(e.fields=[a],a.aggs.push(e))})),t.splice(0,0,a)}(c,n);const{fieldsPreferringKeyword:d,fieldsPreferringText:u}=Object(l.b)(n),p=u.filter((e=>e.type===r.ES_FIELD_TYPES.KEYWORD||e.type===r.ES_FIELD_TYPES.TEXT)),m=u.filter((e=>e.type===r.ES_FIELD_TYPES.DATE)),b=this._removeTextFields?d:n;this._fields=b,this._catFields=p,this._dateFields=m,this._aggs=c}catch(e){console.error("Unable to load new job capabilities",e)}}}function d(e){return e.filter((e=>c.includes(e.type)))}const u=new NewJobCapsService},function(e,t,a){"use strict";a.d(t,"f",(function(){return F})),a.d(t,"c",(function(){return I})),a.d(t,"d",(function(){return D})),a.d(t,"a",(function(){return A})),a.d(t,"b",(function(){return L})),a.d(t,"e",(function(){return R})),a.d(t,"g",(function(){return P}));var i=a(4),n=a.n(i),s=a(23),r=a(8),o=a(86),l=a(43),c=a(174),d=a(138),u=a(79),p=a(67),m=a(95);const b=250;class job_runner_JobRunner{constructor(e){n()(this,"_jobId",void 0),n()(this,"_datafeedId",void 0),n()(this,"_start",0),n()(this,"_end",0),n()(this,"_datafeedState",m.a.STOPPED),n()(this,"_refreshInterval",b),n()(this,"_progress$",void 0),n()(this,"_percentageComplete",0),n()(this,"_stopRefreshPoll",void 0),n()(this,"_subscribers",void 0),n()(this,"_datafeedStartTime",0),n()(this,"_performRefreshRateAdjustment",!1),n()(this,"_jobAssignedToNode",!1),n()(this,"_jobAssignedToNode$",void 0),this._jobId=e.jobId,this._datafeedId=e.datafeedId,this._start=e.start,this._end=e.end,this._percentageComplete=0,this._stopRefreshPoll=e.stopAllRefreshPolls,this._progress$=new s.BehaviorSubject(this._percentageComplete),this._jobAssignedToNode$=new s.BehaviorSubject(this._jobAssignedToNode),this._subscribers=e.subscribers}get datafeedState(){return this._datafeedState}set refreshInterval(e){this._refreshInterval=e}resetInterval(){this._refreshInterval=b}async openJob(){try{const{node:e}=await u.a.openJob(this._jobId);this._jobAssignedToNode=void 0!==e&&e.length>0,this._jobAssignedToNode$.next(this._jobAssignedToNode)}catch(e){throw e}}async _startDatafeed(e,t,a){try{this._datafeedStartTime=Date.now();const i=!0===a?this._subscribers.map((e=>this._progress$.subscribe(e))):[];await this.openJob();const{started:n}=await u.a.startDatafeed(this._datafeedId,this._jobId,e,t);this._datafeedState=m.a.STARTED,this._percentageComplete=0;const s=async()=>{const{isRunning:e,progress:t,isJobClosed:a}=await this.getProgress(),n=100!==t||!0!==e&&!1!==a?t:t-1;this._adjustRefreshInterval(n),this._percentageComplete=n,this._progress$.next(this._percentageComplete),!0!==e&&!1!==a||!1!==this._stopRefreshPoll.stop?(this._progress$.next(100),i.forEach((e=>e.unsubscribe()))):setTimeout((async()=>{!1===this._stopRefreshPoll.stop&&await s()}),this._refreshInterval)},r=async()=>{this._jobAssignedToNode=await this._isJobAssigned(),this._jobAssignedToNode$.next(this._jobAssignedToNode),!0===this._jobAssignedToNode?await s():setTimeout((async()=>{!1===this._stopRefreshPoll.stop&&await r()}),2e3)};return!0===a&&(!0===this._jobAssignedToNode?await s():await r()),n}catch(e){throw e}}_adjustRefreshInterval(e){if(!1===this._performRefreshRateAdjustment){if(!(Date.now()-this._datafeedStartTime>2e3))return;this._performRefreshRateAdjustment=!0}const t=e-this._percentageComplete;0!==t&&(this._refreshInterval=Math.floor(this._refreshInterval*(2/t)),this._refreshInterval<b&&(this._refreshInterval=b))}async _isJobAssigned(){const{jobs:e}=await p.ml.getJobStats({jobId:this._jobId});return e.length>0&&void 0!==e[0].node}async startDatafeed(){return await this._startDatafeed(this._start,this._end,!0)}async startDatafeedInRealTime(e){const t=e?this._end:this._start;return await this._startDatafeed(t,void 0,!1)}async getProgress(){return await p.ml.jobs.getLookBackProgress(this._jobId,this._start,this._end)}subscribeToProgress(e){this._progress$.subscribe(e)}async isRunning(){const{isRunning:e}=await this.getProgress();return e}isJobAssignedToNode(){return this._jobAssignedToNode}subscribeToJobAssignment(e){return this._jobAssignedToNode$.subscribe(e)}}var h=a(77),f=a(84),g=a(5);function j(e,t){if(!Object(g.b)(t,["runtime_mappings"])||!Object(g.b)(t.runtime_mappings))return{runtime_mappings:{},discarded_mappings:{}};const a=function(e,t){var a;const i=new Set;e.analysis_config.detectors.forEach((e=>{void 0!==e.field_name&&i.add(e.field_name),void 0!==e.by_field_name&&i.add(e.by_field_name),void 0!==e.over_field_name&&i.add(e.over_field_name),void 0!==e.partition_field_name&&i.add(e.partition_field_name)})),void 0!==e.analysis_config.categorization_field_name&&i.add(e.analysis_config.categorization_field_name);void 0!==e.analysis_config.summary_count_field_name&&i.add(e.analysis_config.summary_count_field_name);void 0!==e.analysis_config.influencers&&e.analysis_config.influencers.forEach((e=>i.add(e)));const n=null!==(a=t.aggregations)&&void 0!==a?a:t.aggs;void 0!==n&&x(n).forEach((e=>i.add(e)));const s=t.query;void 0!==s&&v(s).forEach((e=>i.add(e)));return[...i]}(e,t),{runtimeMappings:i,discardedMappings:n}=(s=t.runtime_mappings,{runtimeMappings:(r=a).reduce(((e,t)=>(void 0!==s[t]&&(e[t]=s[t]),e)),{}),discardedMappings:Object.keys(s).reduce(((e,t)=>(!1===r.includes(t)&&void 0!==s[t]&&(e[t]=s[t]),e)),{})});var s,r;return{runtime_mappings:i,discarded_mappings:n}}function x(e){const t=[];return Object.entries(e).forEach((([e,a])=>{Object(g.b)(a)?t.push(...x(a)):"string"==typeof a&&"field"===e&&t.push(a)})),t}function v(e){const t=[];return Object.entries(e).forEach((([e,a])=>{Object(g.b)(a)?(t.push(e),t.push(...v(a))):"string"==typeof a?t.push(a):t.push(e)})),t}var y=a(26),O=a(272),E=a(198);class job_creator_JobCreator{constructor(e,t,a){n()(this,"_type",h.f.SINGLE_METRIC),n()(this,"_indexPattern",void 0),n()(this,"_savedSearch",void 0),n()(this,"_indexPatternTitle",""),n()(this,"_job_config",void 0),n()(this,"_calendars",void 0),n()(this,"_datafeed_config",void 0),n()(this,"_detectors",void 0),n()(this,"_influencers",void 0),n()(this,"_bucketSpanMs",0),n()(this,"_useDedicatedIndex",!1),n()(this,"_start",0),n()(this,"_end",0),n()(this,"_subscribers",[]),n()(this,"_aggs",[]),n()(this,"_fields",[]),n()(this,"_scriptFields",[]),n()(this,"_runtimeFields",[]),n()(this,"_runtimeMappings",null),n()(this,"_filterRuntimeMappingsOnSave",!0),n()(this,"_aggregationFields",[]),n()(this,"_sparseData",!1),n()(this,"_stopAllRefreshPolls",{stop:!1}),n()(this,"_wizardInitialized$",new s.BehaviorSubject(!1)),n()(this,"wizardInitialized$",this._wizardInitialized$.asObservable()),this._indexPattern=e,this._savedSearch=t,this._indexPatternTitle=e.title,this._job_config=Object(d.c)(),this._calendars=[],this._datafeed_config=Object(d.b)(this._indexPatternTitle),this._detectors=this._job_config.analysis_config.detectors,this._influencers=this._job_config.analysis_config.influencers,"string"==typeof e.timeFieldName&&(this._job_config.data_description.time_field=e.timeFieldName),this._extractRuntimeMappings(),this._datafeed_config.query=a}get type(){return this._type}get indexPatternTitle(){return this._indexPatternTitle}_addDetector(e,t,a){this._detectors.push(e),this._aggs.push(t),this._fields.push(a),this._updateSparseDataDetectors()}_editDetector(e,t,a,i){void 0!==this._detectors[i]&&(this._detectors[i]=e,this._aggs[i]=t,this._fields[i]=a,this._updateSparseDataDetectors())}_removeDetector(e){this._detectors.splice(e,1),this._aggs.splice(e,1),this._fields.splice(e,1)}removeAllDetectors(){this._detectors.length=0,this._aggs.length=0,this._fields.length=0}get detectors(){return this._detectors}get aggregationsInDetectors(){return this._aggs}getAggregation(e){const t=this._aggs[e];return void 0!==t?t:null}get aggregations(){return this._aggs}getField(e){const t=this._fields[e];return void 0!==t?t:null}get fields(){return this._fields}set bucketSpan(e){this._job_config.analysis_config.bucket_span=e,this._setBucketSpanMs(e)}get bucketSpan(){return this._job_config.analysis_config.bucket_span}_setBucketSpanMs(e){const t=Object(y.a)(e,!0);this._bucketSpanMs=null===t?0:t.asMilliseconds()}get bucketSpanMs(){return this._bucketSpanMs}addInfluencer(e){!1===this._influencers.includes(e)&&this._influencers.push(e)}removeInfluencer(e){const t=this._influencers.indexOf(e);-1!==t&&this._influencers.splice(t,1)}removeAllInfluencers(){this._influencers.length=0}get influencers(){return this._influencers}set jobId(e){this._job_config.job_id=e,this._datafeed_config.job_id=e,this._datafeed_config.datafeed_id=`datafeed-${e}`,this._useDedicatedIndex&&(this._job_config.results_index_name=e)}get jobId(){return this._job_config.job_id}get datafeedId(){return this._datafeed_config.datafeed_id}set description(e){this._job_config.description=e}get description(){var e;return null!==(e=this._job_config.description)&&void 0!==e?e:""}get groups(){var e;return null!==(e=this._job_config.groups)&&void 0!==e?e:[]}set groups(e){this._job_config.groups=e}get calendars(){return this._calendars}set calendars(e){this._calendars=e}_initModelPlotConfig(){void 0===this._job_config.model_plot_config&&(this._job_config.model_plot_config={enabled:!1}),void 0!==this._job_config.model_plot_config&&void 0===this._job_config.model_plot_config.enabled&&(this._job_config.model_plot_config.enabled=!1),void 0!==this._job_config.model_plot_config&&void 0===this._job_config.model_plot_config.annotations_enabled&&(this._job_config.model_plot_config.annotations_enabled=!1)}set modelPlot(e){this._initModelPlotConfig(),this._job_config.model_plot_config.enabled=e}get modelPlot(){return void 0!==this._job_config.model_plot_config&&!0===this._job_config.model_plot_config.enabled}set modelChangeAnnotations(e){this._initModelPlotConfig(),this._job_config.model_plot_config.annotations_enabled=e}get modelChangeAnnotations(){var e;return!0===(null===(e=this._job_config.model_plot_config)||void 0===e?void 0:e.annotations_enabled)}set useDedicatedIndex(e){this._useDedicatedIndex=e,e?this._job_config.results_index_name=this._job_config.job_id:delete this._job_config.results_index_name}get useDedicatedIndex(){return this._useDedicatedIndex}set modelMemoryLimit(e){null!==e?this._job_config.analysis_limits={model_memory_limit:e}:delete this._job_config.analysis_limits}get modelMemoryLimit(){return this._job_config.analysis_limits&&void 0!==this._job_config.analysis_limits.model_memory_limit?this._job_config.analysis_limits.model_memory_limit:null}set summaryCountFieldName(e){null!==e?this._job_config.analysis_config.summary_count_field_name=e:delete this._job_config.analysis_config.summary_count_field_name}get summaryCountFieldName(){return this._job_config.analysis_config.summary_count_field_name||null}set categorizationFieldName(e){null!==e?this._job_config.analysis_config.categorization_field_name=e:delete this._job_config.analysis_config.categorization_field_name}get categorizationFieldName(){return this._job_config.analysis_config.categorization_field_name||null}addCategorizationFilter(e){void 0===this._job_config.analysis_config.categorization_filters&&(this._job_config.analysis_config.categorization_filters=[]);const t=this._job_config.analysis_config.categorization_filters;!1===t.includes(e)&&t.push(e)}removeCategorizationFilter(e){const t=this._job_config.analysis_config.categorization_filters;if(void 0!==t){const a=t.indexOf(e);-1!==a&&t.splice(a,1),0===t.length&&this.removeCategorizationFilters()}}removeCategorizationFilters(){delete this._job_config.analysis_config.categorization_filters}get categorizationFilters(){return this._job_config.analysis_config.categorization_filters||null}get timeFieldName(){return this._job_config.data_description.time_field}set timeFieldName(e){this._job_config.data_description.time_field=e}get sparseData(){return this._sparseData}set sparseData(e){this._sparseData=e,this._updateSparseDataDetectors()}_updateSparseDataDetectors(){this._detectors.forEach(((e,t)=>{if(void 0!==this._aggs[t])switch(this._aggs[t].id){case o.b.COUNT:e.function=this._sparseData?o.b.NON_ZERO_COUNT:o.b.COUNT;break;case o.b.HIGH_COUNT:e.function=this._sparseData?o.b.HIGH_NON_ZERO_COUNT:o.b.HIGH_COUNT;break;case o.b.LOW_COUNT:e.function=this._sparseData?o.b.LOW_NON_ZERO_COUNT:o.b.LOW_COUNT;break;case o.b.SUM:e.function=this._sparseData?o.b.NON_NULL_SUM:o.b.SUM;break;case o.b.HIGH_SUM:e.function=this._sparseData?o.b.HIGH_NON_NULL_SUM:o.b.HIGH_SUM;break;case o.b.LOW_SUM:e.function=this._sparseData?o.b.LOW_NON_NULL_SUM:o.b.LOW_SUM}}))}async _updateCalendars(){if(0!==this._calendars.length)for(const e of this._calendars)await O.a.assignNewJobId(e,this.jobId)}setTimeRange(e,t){this._start=e,this._end=t}get start(){return this._start}get end(){return this._end}get query(){return this._datafeed_config.query}set query(e){this._datafeed_config.query=e}get queryDelay(){return this._datafeed_config.query_delay||null}set queryDelay(e){null!==e?this._datafeed_config.query_delay=e:delete this._datafeed_config.query_delay}get frequency(){return this._datafeed_config.frequency||null}set frequency(e){null!==e?this._datafeed_config.frequency=e:delete this._datafeed_config.frequency}get scrollSize(){return this._datafeed_config.scroll_size||null}set scrollSize(e){null!==e?this._datafeed_config.scroll_size=e:delete this._datafeed_config.scroll_size}get indices(){return this._datafeed_config.indices}set indices(e){this._datafeed_config.indices=e}get scriptFields(){return this._scriptFields}get runtimeMappings(){return this._runtimeMappings}get runtimeFields(){return this._runtimeFields}get aggregationFields(){return this._aggregationFields}get additionalFields(){return[...this._scriptFields,...this._runtimeFields,...this._aggregationFields]}get subscribers(){return this._subscribers}async createAndStartJob(){try{await this.createJob(),await this.createDatafeed();return await this.startDatafeed()}catch(e){throw e}}async createJob(){try{const{success:e,resp:t}=await u.a.saveNewJob(this._job_config);if(await this._updateCalendars(),!0===e)return t;throw t}catch(e){throw e}}async createDatafeed(){try{const e=this._getDatafeedWithFilteredRuntimeMappings();return await u.a.saveNewDatafeed(e,this._job_config.job_id)}catch(e){throw e}}async startDatafeed(){const e=new job_runner_JobRunner(this);return await e.startDatafeed(),e}_getDatafeedWithFilteredRuntimeMappings(){if(!1===this._filterRuntimeMappingsOnSave)return this._datafeed_config;const{runtime_mappings:e}=j(this._job_config,this._datafeed_config);return{...this._datafeed_config,runtime_mappings:Object.keys(e).length>0?e:void 0}}subscribeToProgress(e){this._subscribers.push(e)}get jobConfig(){return this._job_config}get datafeedConfig(){return this._datafeed_config}get stopAllRefreshPolls(){return this._stopAllRefreshPolls}forceStopRefreshPolls(){this._stopAllRefreshPolls.stop=!0}_setCustomSetting(e,t){null===t?void 0!==this._job_config.custom_settings&&void 0!==this._job_config.custom_settings[e]&&(delete this._job_config.custom_settings[e],0===Object.keys(this._job_config.custom_settings).length&&delete this._job_config.custom_settings):void 0===this._job_config.custom_settings?this._job_config.custom_settings={[e]:t}:this._job_config.custom_settings[e]=t}_getCustomSetting(e){return void 0!==this._job_config.custom_settings&&void 0!==this._job_config.custom_settings[e]?this._job_config.custom_settings[e]:null}set createdBy(e){this._setCustomSetting("created_by",e)}get createdBy(){return this._getCustomSetting("created_by")}set customUrls(e){this._setCustomSetting("custom_urls",e)}get customUrls(){return this._getCustomSetting("custom_urls")}get formattedJobJson(){return JSON.stringify(this._job_config,null,2)}get formattedDatafeedJson(){return JSON.stringify(this._datafeed_config,null,2)}set filterRuntimeMappingsOnSave(e){this._filterRuntimeMappingsOnSave=e}get filterRuntimeMappingsOnSave(){return this._filterRuntimeMappingsOnSave}_initPerPartitionCategorization(){var e,t;void 0===this._job_config.analysis_config.per_partition_categorization&&(this._job_config.analysis_config.per_partition_categorization={}),void 0===(null===(e=this._job_config.analysis_config.per_partition_categorization)||void 0===e?void 0:e.enabled)&&(this._job_config.analysis_config.per_partition_categorization.enabled=!1),void 0===(null===(t=this._job_config.analysis_config.per_partition_categorization)||void 0===t?void 0:t.stop_on_warn)&&(this._job_config.analysis_config.per_partition_categorization.stop_on_warn=!1)}get perPartitionCategorization(){var e;return!0===(null===(e=this._job_config.analysis_config.per_partition_categorization)||void 0===e?void 0:e.enabled)}set perPartitionCategorization(e){this._initPerPartitionCategorization(),this._job_config.analysis_config.per_partition_categorization.enabled=e}get perPartitionStopOnWarn(){var e;return!0===(null===(e=this._job_config.analysis_config.per_partition_categorization)||void 0===e?void 0:e.stop_on_warn)}set perPartitionStopOnWarn(e){this._initPerPartitionCategorization(),this._job_config.analysis_config.per_partition_categorization.stop_on_warn=e}_extractRuntimeMappings(){const e=this._indexPattern.toSpec().runtimeFieldMap;void 0!==e&&(void 0===this._datafeed_config.runtime_mappings&&(this._datafeed_config.runtime_mappings={}),Object.entries(e).forEach((([e,t])=>{this._datafeed_config.runtime_mappings[e]=t}))),this._populateRuntimeFields()}_populateRuntimeFields(){var e;if(this._runtimeFields=[],this._runtimeMappings=null!==(e=this._datafeed_config.runtime_mappings)&&void 0!==e?e:null,null!==this._runtimeMappings){const e=Object.entries(this._runtimeMappings).map((([e,t])=>({id:e,name:e,type:t.type,aggregatable:!0,aggs:[],runtimeField:t}))),t=Object(r.cloneDeep)([...o.d,...o.e]);this._runtimeFields=Object(c.a)(e,t,{}).fields}}_populateScriptFields(){this._scriptFields=[],void 0!==this._datafeed_config.script_fields&&(this._scriptFields=Object.keys(this._datafeed_config.script_fields).map((e=>({id:e,name:e,type:l.ES_FIELD_TYPES.KEYWORD,aggregatable:!0}))))}_overrideConfigs(e,t){this._job_config=e,this._datafeed_config=t,this._detectors=this._job_config.analysis_config.detectors,this._influencers=this._job_config.analysis_config.influencers,void 0===this._job_config.groups&&(this._job_config.groups=[]),void 0!==this._job_config.analysis_config.influencers&&this._job_config.analysis_config.influencers.forEach((e=>this.addInfluencer(e))),void 0!==this._job_config.results_index_name&&this._job_config.results_index_name!==h.g&&(this.useDedicatedIndex=!0),this._populateScriptFields(),this._populateRuntimeFields(),this._aggregationFields=[];const a=Object(E.b)(this._datafeed_config);if(void 0!==a){const e=Object(g.a)(a);if(void 0!==e&&void 0!==a[e]){const t=a[e];Object(f.c)(t,this._aggregationFields)}}}}class single_metric_job_creator_SingleMetricJobCreator extends job_creator_JobCreator{constructor(e,t,a){super(e,t,a),n()(this,"_type",h.f.SINGLE_METRIC),this.createdBy=h.a.SINGLE_METRIC,this._wizardInitialized$.next(!0)}setDetector(e,t){const a=Object(d.a)(e,t);0===this._detectors.length?this._addDetector(a,e,t):this._editDetector(a,e,t,0),this._createDatafeedAggregations()}set bucketSpan(e){this._job_config.analysis_config.bucket_span=e,this._setBucketSpanMs(e),this._createDatafeedAggregations()}get bucketSpan(){return this._job_config.analysis_config.bucket_span}_createDatafeedAggregations(){if(this._detectors.length&&"string"==typeof this._job_config.analysis_config.bucket_span&&this._aggs.length>0){delete this._job_config.analysis_config.summary_count_field_name,delete this._datafeed_config.aggregations;const e=this._aggs[0].dslName,t=this._job_config.data_description.time_field,a=Object(y.a)(this._job_config.analysis_config.bucket_span,!0);if(null===a)return;const i=1e3*a.asSeconds();let n=null;switch(e){case o.a.COUNT:this._job_config.analysis_config.summary_count_field_name="doc_count",this._datafeed_config.aggregations={buckets:{date_histogram:{field:t,fixed_interval:`${i}ms`},aggregations:{[t]:{max:{field:t}}}}};break;case o.a.AVG:case o.a.SUM:case o.a.MIN:case o.a.MAX:if(n=this._fields[0],null!==n){const a=n.name;this._job_config.analysis_config.summary_count_field_name="doc_count",this._datafeed_config.aggregations={buckets:{date_histogram:{field:t,fixed_interval:.1*i+"ms"},aggregations:{[a]:{[e]:{field:a}},[t]:{max:{field:t}}}}}}break;case o.a.CARDINALITY:if(n=this._fields[0],null!==n){const a=n.name;this._job_config.analysis_config.summary_count_field_name=`dc_${a}`,this._datafeed_config.aggregations={buckets:{date_histogram:{field:t,fixed_interval:`${i}ms`},aggregations:{[t]:{max:{field:t}},[this._job_config.analysis_config.summary_count_field_name]:{[e]:{field:a}}}}};const s=this._detectors[0];s.function=o.b.NON_ZERO_COUNT,s.detector_description=`${e} (${a})`,delete s.field_name}}}}get aggFieldPair(){return 0===this._aggs.length?null:{agg:this._aggs[0],field:this._fields[0]}}cloneFromExistingJob(e,t){this._overrideConfigs(e,t),this.createdBy=h.a.SINGLE_METRIC,this._sparseData=Object(f.k)(e,t);const a=Object(f.j)(e,t,this.additionalFields,!1);this.removeAllDetectors();const i=a[0];a.length&&null!==i.agg&&null!==i.field&&this.setDetector(i.agg,i.field)}}class multi_metric_job_creator_MultiMetricJobCreator extends job_creator_JobCreator{constructor(e,t,a){super(e,t,a),n()(this,"_splitField",null),n()(this,"_type",h.f.MULTI_METRIC),this.createdBy=h.a.MULTI_METRIC,this._wizardInitialized$.next(!0)}setSplitField(e){if(this._splitField=e,null===this._splitField)this.removeSplitField();else for(let e=0;e<this._detectors.length;e++)this._detectors[e].partition_field_name=this._splitField.id}removeSplitField(){this._detectors.forEach((e=>{delete e.partition_field_name}))}get splitField(){return this._splitField}addDetector(e,t){const a=this._createDetector(e,t);this._addDetector(a,e,t)}editDetector(e,t,a){const i=this._createDetector(e,t);this._editDetector(i,e,t,a)}_createDetector(e,t){const a=Object(d.a)(e,t);return null!==this._splitField&&(a.partition_field_name=this._splitField.id),a}removeDetector(e){this._removeDetector(e)}get aggFieldPairs(){return this.detectors.map(((e,t)=>({field:this._fields[t],agg:this._aggs[t]})))}cloneFromExistingJob(e,t){this._overrideConfigs(e,t),this.createdBy=h.a.MULTI_METRIC,this._sparseData=Object(f.k)(e,t);const a=Object(f.j)(e,t,this.additionalFields,!1);void 0!==t.aggregations&&(delete t.aggregations,delete e.analysis_config.summary_count_field_name),this.removeAllDetectors(),a.forEach(((e,t)=>{const i=a[t];null!==i.agg&&null!==i.field&&this.addDetector(i.agg,i.field)})),a.length&&null!==a[0].partitionField&&this.setSplitField(a[0].partitionField)}}class population_job_creator_PopulationJobCreator extends job_creator_JobCreator{constructor(e,t,a){super(e,t,a),n()(this,"_populatonField",null),n()(this,"_byFields",[]),n()(this,"_type",h.f.POPULATION),this.createdBy=h.a.POPULATION,this._wizardInitialized$.next(!0)}setByField(e,t){null===e?this.removeByField(t):void 0!==this._detectors[t]&&(this._byFields[t]=e,this._detectors[t].by_field_name=e.id)}removeByField(e){void 0!==this._detectors[e]&&(this._byFields[e]=null,delete this._detectors[e].by_field_name)}getByField(e){return void 0===this._byFields[e]?null:this._byFields[e]}setPopulationField(e){if(this._populatonField=e,null===this._populatonField)this.removePopulationField();else for(let e=0;e<this._detectors.length;e++)this._detectors[e].over_field_name=this._populatonField.id}removePopulationField(){this._detectors.forEach((e=>{delete e.over_field_name}))}get populationField(){return this._populatonField}addDetector(e,t){const a=this._createDetector(e,t);this._addDetector(a,e,t),this._byFields.push(null)}editDetector(e,t,a){const i=this._createDetector(e,t),n=this._byFields[a];null!=n&&(i.by_field_name=n.id),this._editDetector(i,e,t,a)}_createDetector(e,t){const a=Object(d.a)(e,t);return null!==this._populatonField&&(a.over_field_name=this._populatonField.id),a}removeDetector(e){this._removeDetector(e),this._byFields.splice(e,1)}get aggFieldPairs(){return this.detectors.map(((e,t)=>({field:this._fields[t],agg:this._aggs[t],by:{field:this._byFields[t],value:null}})))}cloneFromExistingJob(e,t){this._overrideConfigs(e,t),this.createdBy=h.a.POPULATION;const a=Object(f.j)(e,t,this.additionalFields,!1);this.removeAllDetectors(),a.length&&null!==a[0].overField&&this.setPopulationField(a[0].overField),a.forEach(((e,t)=>{const i=a[t];null!==i.agg&&null!==i.field&&(this.addDetector(i.agg,i.field),null!==i.byField&&this.setByField(i.byField,t))}))}}var w=a(134);class advanced_job_creator_AdvancedJobCreator extends job_creator_JobCreator{constructor(e,t,a){super(e,t,a),n()(this,"_type",h.f.ADVANCED),n()(this,"_richDetectors",[]),n()(this,"_queryString",void 0),this._queryString=JSON.stringify(this._datafeed_config.query),this._wizardInitialized$.next(!0)}addDetector(e,t,a,i,n,s,r,o){const{detector:l,richDetector:c}=this._createDetector(e,t,a,i,n,s,r,null,o);this._addDetector(l,e,t),this._richDetectors.push(c)}editDetector(e,t,a,i,n,s,r,o,l){const c=void 0!==this._detectors[o]&&this._detectors[o].custom_rules||null,{detector:d,richDetector:u}=this._createDetector(e,t,a,i,n,s,r,c,l);this._editDetector(d,e,t,o),void 0!==this._richDetectors[o]&&(this._richDetectors[o]=u)}_createDetector(e,t,a,i,n,s,r,o,l){const c=Object(d.a)(e,t);null!==a&&(c.by_field_name=a.id),null!==i&&(c.over_field_name=i.id),null!==n&&(c.partition_field_name=n.id),null!==s&&(c.exclude_frequent=s),null!==r&&(c.detector_description=r),null!==o&&(c.custom_rules=o),null!==l&&(c.use_null=l);return{detector:c,richDetector:{agg:e,field:t,byField:a,overField:i,partitionField:n,excludeFrequent:s,description:r,customRules:o,useNull:l}}}removeDetector(e){this._removeDetector(e),this._richDetectors.splice(e,1)}get richDetectors(){return this._richDetectors}get queryString(){return this._queryString}set queryString(e){this._queryString=e}get isValidQueryString(){return Object(w.c)(this._queryString)}async autoSetTimeRange(){const{start:e,end:t}=await p.ml.getTimeFieldRange({index:this._indexPatternTitle,timeFieldName:this.timeFieldName,query:this.query,runtimeMappings:this.datafeedConfig.runtime_mappings,indicesOptions:this.datafeedConfig.indices_options});this.setTimeRange(e.epoch,t.epoch)}cloneFromExistingJob(e,t){this._overrideConfigs(e,t);const a=Object(f.j)(e,t,this.additionalFields,!0),i=this._detectors.map((e=>e.custom_rules));this.removeAllDetectors(),this._richDetectors.length=0,a.forEach(((e,t)=>{const i=a[t];null!==i.agg&&null!==i.field&&this.addDetector(i.agg,i.field,i.byField,i.overField,i.partitionField,i.excludeFrequent,i.description,i.useNull)})),i.forEach(((e,t)=>{void 0!==e&&(this._detectors[t].custom_rules=e)}))}}var _=a(112),S=a(144),M=a(279),k=a(351),C=a(83),T=a(87);class categorization_job_creator_CategorizationJobCreator extends job_creator_JobCreator{constructor(e,t,a){super(e,t,a),n()(this,"_type",h.f.CATEGORIZATION),n()(this,"_createCountDetector",(()=>{})),n()(this,"_createRareDetector",(()=>{})),n()(this,"_examplesLoader",void 0),n()(this,"_categoryFieldExamples",[]),n()(this,"_validationChecks",[]),n()(this,"_overallValidStatus",S.a.INVALID),n()(this,"_detectorType",o.b.COUNT),n()(this,"_categorizationAnalyzer",{}),n()(this,"_defaultCategorizationAnalyzer",void 0),n()(this,"_partitionFieldName",null),n()(this,"_ccsVersionFailure",!1),this.createdBy=h.a.CATEGORIZATION,this._examplesLoader=new k.a(this,e,a);const{anomaly_detectors:i}=Object(C.c)();this._defaultCategorizationAnalyzer=i.categorization_analyzer||{}}setDefaultDetectorProperties(e,t,a){if(null===e||null===t||null===a)throw Error("event_rate field or count or rare aggregations missing");this._createCountDetector=()=>{this._createDetector(e,a)},this._createRareDetector=()=>{this._createDetector(t,a)}}_createDetector(e,t){const a=Object(d.a)(e,t);a.by_field_name=_.c.id,this.perPartitionCategorization&&null!==this.categorizationPerPartitionField&&(a.partition_field_name=this.categorizationPerPartitionField),this._addDetector(a,e,_.c)}setDetectorType(e){this._detectorType=e,this.removeAllDetectors(),e===o.b.COUNT?(this._createCountDetector(),this.bucketSpan=h.b):(this._createRareDetector(),this.bucketSpan=h.e,this.modelPlot=!1)}set categorizationFieldName(e){null!==e?(this._job_config.analysis_config.categorization_field_name=e,this.setDetectorType(this._detectorType),this.addInfluencer(_.c.id)):(delete this._job_config.analysis_config.categorization_field_name,this._categoryFieldExamples=[],this._validationChecks=[],this._overallValidStatus=S.a.INVALID)}get categorizationFieldName(){return this._job_config.analysis_config.categorization_field_name||null}async loadCategorizationFieldExamples(){const{examples:e,sampleSize:t,overallValidStatus:a,validationChecks:i}=await this._examplesLoader.loadExamples();return this._categoryFieldExamples=e,this._validationChecks=i,this._overallValidStatus=a,this._ccsVersionFailure=this._checkCcsFailure(e,a,i),!0===this._ccsVersionFailure&&(this._overallValidStatus=S.a.VALID),this._wizardInitialized$.next(!0),{examples:e,sampleSize:t,overallValidStatus:a,validationChecks:i,ccsVersionFailure:this._ccsVersionFailure}}_checkCcsFailure(e,t,a){var i;return 0===e.length&&t===S.a.INVALID&&(null===(i=a[0])||void 0===i?void 0:i.id)===M.a.NO_EXAMPLES&&Object(T.g)(this.indexPatternTitle)}get categoryFieldExamples(){return this._categoryFieldExamples}get validationChecks(){return this._validationChecks}get overallValidStatus(){return this._overallValidStatus}get selectedDetectorType(){return this._detectorType}set categorizationAnalyzer(e){this._categorizationAnalyzer=e,Object(r.isEqual)(this._categorizationAnalyzer,this._defaultCategorizationAnalyzer)?delete this._job_config.analysis_config.categorization_analyzer:this._job_config.analysis_config.categorization_analyzer=e}get categorizationAnalyzer(){return this._categorizationAnalyzer}get categorizationPerPartitionField(){return this._partitionFieldName}set categorizationPerPartitionField(e){null===e?(this._detectors.forEach((e=>{delete e.partition_field_name})),null!==this._partitionFieldName&&this.removeInfluencer(this._partitionFieldName),this._partitionFieldName=null):this._partitionFieldName!==e&&(null!==this._partitionFieldName&&this.removeInfluencer(this._partitionFieldName),this.addInfluencer(e),this._partitionFieldName=e,this._detectors.forEach((t=>{t.partition_field_name=e})))}get perPartitionCategorization(){var e;return!0===(null===(e=this._job_config.analysis_config.per_partition_categorization)||void 0===e?void 0:e.enabled)}set perPartitionCategorization(e){this._initPerPartitionCategorization(),this._job_config.analysis_config.per_partition_categorization.enabled=e,!1===e&&(this.categorizationPerPartitionField=null)}cloneFromExistingJob(e,t){this._overrideConfigs(e,t),this.createdBy=h.a.CATEGORIZATION;const a=Object(f.j)(e,t,this.additionalFields,!1)[0];if(void 0!==a&&null!==a.agg&&null!==a.field){const t=a.agg.id===o.b.COUNT?o.b.COUNT:o.b.RARE,i=e.analysis_config.bucket_span;this.setDetectorType(t),null!==a.partitionField&&(this.categorizationPerPartitionField=a.partitionField.id),this.bucketSpan=i}}}class rare_job_creator_RareJobCreator extends job_creator_JobCreator{constructor(e,t,a){super(e,t,a),n()(this,"_rareField",null),n()(this,"_populationField",null),n()(this,"_splitField",null),n()(this,"_type",h.f.RARE),n()(this,"_rareInPopulation",!1),n()(this,"_frequentlyRare",!1),n()(this,"_rareAgg",void 0),n()(this,"_freqRareAgg",void 0),this.createdBy=h.a.RARE,this._wizardInitialized$.next(!0),this._rareAgg={},this._freqRareAgg={}}setDefaultDetectorProperties(e,t){if(null===e||null===t)throw Error("rare or freq_rare aggregations missing");this._rareAgg=e,this._freqRareAgg=t}setRareField(e){if(this._rareField=e,null===e)return this.removePopulationField(),this.removeSplitField(),this._removeDetector(0),this._detectors.length=0,void(this._fields.length=0);const t=this._frequentlyRare?this._freqRareAgg:this._rareAgg,a={function:t.id};0===this._detectors.length?this._addDetector(a,t,e):this._editDetector(a,t,e,0),this._detectors[0].by_field_name=e.id}get rareField(){return this._rareField}get rareInPopulation(){return this._rareInPopulation}set rareInPopulation(e){this._rareInPopulation=e,!1===e&&this.removePopulationField()}get frequentlyRare(){return this._frequentlyRare}set frequentlyRare(e){if(this._frequentlyRare=e,this._detectors.length){const t=e?this._freqRareAgg:this._rareAgg;this._detectors[0].function=t.id,this._aggs[0]=t}}setPopulationField(e){if(this._populationField=e,null===this._populationField)this.removePopulationField();else for(let e=0;e<this._detectors.length;e++)this._detectors[e].over_field_name=this._populationField.id}removePopulationField(){this._populationField=null,this._detectors.forEach((e=>{delete e.over_field_name}))}get populationField(){return this._populationField}setSplitField(e){if(this._splitField=e,null===this._splitField)this.removeSplitField();else for(let e=0;e<this._detectors.length;e++)this._detectors[e].partition_field_name=this._splitField.id}removeSplitField(){this._detectors.forEach((e=>{delete e.partition_field_name}))}get splitField(){return this._splitField}cloneFromExistingJob(e,t){this._overrideConfigs(e,t),this.createdBy=h.a.RARE,this._sparseData=Object(f.k)(e,t);const a=Object(f.j)(e,t,this.additionalFields,!1);var i;(this.removeSplitField(),this.removePopulationField(),this.removeAllDetectors(),a.length)&&(this.setRareField(a[0].byField),this.frequentlyRare=(null===(i=a[0].agg)||void 0===i?void 0:i.id)===o.b.FREQ_RARE,null!==a[0].overField&&(this.setPopulationField(a[0].overField),this.rareInPopulation=!0),null!==a[0].partitionField&&this.setSplitField(a[0].partitionField))}}function F(e){return e.type===h.f.SINGLE_METRIC}function I(e){return e.type===h.f.MULTI_METRIC}function D(e){return e.type===h.f.POPULATION}function A(e){return e.type===h.f.ADVANCED}function L(e){return e.type===h.f.CATEGORIZATION}function R(e){return e.type===h.f.RARE}const P=e=>(t,a,i)=>{let n;switch(e){case h.f.SINGLE_METRIC:n=single_metric_job_creator_SingleMetricJobCreator;break;case h.f.MULTI_METRIC:n=multi_metric_job_creator_MultiMetricJobCreator;break;case h.f.POPULATION:n=population_job_creator_PopulationJobCreator;break;case h.f.ADVANCED:n=advanced_job_creator_AdvancedJobCreator;break;case h.f.CATEGORIZATION:n=categorization_job_creator_CategorizationJobCreator;break;case h.f.RARE:n=rare_job_creator_RareJobCreator;break;default:n=single_metric_job_creator_SingleMetricJobCreator}return new n(t,a,i)}},function(e,t,a){"use strict";a.d(t,"a",(function(){return h})),a.d(t,"b",(function(){return b})),a.d(t,"c",(function(){return f})),a.d(t,"d",(function(){return g})),a.d(t,"e",(function(){return m}));var i=a(14),n=(a(15),a(2)),s=a(40),r=a(42),o=a(22),l=a(11);let c;function d(){if(void 0===c){const e=n.i18n.translate("xpack.ml.checkLicense.licenseHasExpiredMessage",{defaultMessage:"Your Machine Learning license has expired."}),t=Object(o.g)();c=t.banners.add(Object(r.toMountPoint)(Object(l.jsx)(s.EuiCallOut,{iconType:"iInCircle",color:"warning",title:e})))}}class ml_client_license_MlClientLicense extends i.a{fullLicenseResolver(){return!1===this.isMlEnabled()||!1===this.isMinimumLicense()?u():!1===this.isFullLicense()?(window.location.href="#/datavisualizer",Promise.reject()):(this.hasLicenseExpired()&&d(),Promise.resolve())}basicLicenseResolver(){return!1===this.isMlEnabled()||!1===this.isMinimumLicense()?u():(this.hasLicenseExpired()&&d(),Promise.resolve())}}function u(){return window.location.href="/",Promise.reject()}let p=null;function m(e,t){return p=new ml_client_license_MlClientLicense,p.setup(e.license$,t),p}async function b(){return null===p?(console.error("ML Licensing not initialized"),Promise.reject()):p.fullLicenseResolver()}async function h(){return null===p?(console.error("ML Licensing not initialized"),Promise.reject()):p.basicLicenseResolver()}function f(){return null!==p&&p.hasLicenseExpired()}function g(){return null!==p&&p.isFullLicense()}},,,,function(e,t,a){"use strict";let i,n,s;a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return n})),a.d(t,"c",(function(){return s})),function(e){e.STARTED="started",e.STARTING="starting",e.STOPPED="stopped",e.STOPPING="stopping",e.DELETED="deleted"}(i||(i={})),function(e){e.FAILED="failed",e.FINISHED="finished",e.SCHEDULED="scheduled",e.STARTED="started"}(n||(n={})),function(e){e.CLOSED="closed",e.CLOSING="closing",e.FAILED="failed",e.OPENED="opened",e.OPENING="opening",e.DELETED="deleted"}(s||(s={}))},,,function(e,t,a){"use strict";a.d(t,"a",(function(){return m}));var i=a(15),n=a(91),s=a(40),r=a(2),o=a(66),l=a(81),c=a(6),d=(a(405),a(11));const u={overview:{testSubject:"mlMainTab overview",name:r.i18n.translate("xpack.ml.overviewTabLabel",{defaultMessage:"Overview"})},anomaly_detection:{testSubject:"mlMainTab anomalyDetection",name:r.i18n.translate("xpack.ml.anomalyDetectionTabLabel",{defaultMessage:"Anomaly Detection"}),pathId:"jobs"},data_frame_analytics:{testSubject:"mlMainTab dataFrameAnalytics",name:r.i18n.translate("xpack.ml.dataFrameAnalyticsTabLabel",{defaultMessage:"Data Frame Analytics"})},datavisualizer:{testSubject:"mlMainTab dataVisualizer",name:r.i18n.translate("xpack.ml.dataVisualizerTabLabel",{defaultMessage:"Data Visualizer"})},settings:{testSubject:"mlMainTab settings",name:r.i18n.translate("xpack.ml.settingsTabLabel",{defaultMessage:"Settings"})},"access-denied":{testSubject:"mlMainTab overview",name:r.i18n.translate("xpack.ml.accessDeniedTabLabel",{defaultMessage:"Access Denied"})}},p=({tabId:e,disableLinks:t})=>{const{services:{chrome:{docTitle:a}}}=Object(o.b)(),[n]=Object(l.c)("_g"),[p,m]=Object(i.useState)(e);const b=function(e){return[{id:"overview",name:r.i18n.translate("xpack.ml.navMenu.overviewTabLinkText",{defaultMessage:"Overview"}),disabled:e},{id:"anomaly_detection",name:r.i18n.translate("xpack.ml.navMenu.anomalyDetectionTabLinkText",{defaultMessage:"Anomaly Detection"}),disabled:e},{id:"data_frame_analytics",name:r.i18n.translate("xpack.ml.navMenu.dataFrameAnalyticsTabLinkText",{defaultMessage:"Data Frame Analytics"}),disabled:e},{id:"datavisualizer",name:r.i18n.translate("xpack.ml.navMenu.dataVisualizerTabLinkText",{defaultMessage:"Data Visualizer"}),disabled:!1},{id:"settings",name:r.i18n.translate("xpack.ml.navMenu.settingsTabLinkText",{defaultMessage:"Settings"}),disabled:e}]}(t),h=Object(o.d)(),f=Object(o.e)();return Object(i.useEffect)((()=>{a.change([u[p].name,c.a])}),[p]),Object(d.jsx)(s.EuiPageHeader,{paddingSize:"m",className:"mlMainTabs",bottomBorder:!0,tabs:b.map((e=>{const{id:t,disabled:a}=e,i=u[t].testSubject,s=u[t].pathId||t;return{label:e.name,disabled:a,onClick:()=>{!function(e){m(e)}(t),(async e=>{const t=void 0!==(null==n?void 0:n.refreshInterval)?{globalState:{refreshInterval:n.refreshInterval}}:void 0,a=await h.getUrl({page:e,pageState:t});await f(a,!1)})(s)},"data-test-subj":i+(t===p?" selected":""),isSelected:t===p}}))})},m=({tabId:e})=>{const t=!1===Object(n.d)();return Object(d.jsx)(p,{tabId:e,disableLinks:t})}},,,,function(e,t,a){"use strict";var i=a(80),n=a(113).Graph;function s(e,t,a,n){var s;do{s=i.uniqueId(n)}while(e.hasNode(s));return a.dummy=t,e.setNode(s,a),s}function r(e){return i.max(i.map(e.nodes(),(function(t){var a=e.node(t).rank;if(!i.isUndefined(a))return a})))}e.exports={addDummyNode:s,simplify:function(e){var t=(new n).setGraph(e.graph());return i.forEach(e.nodes(),(function(a){t.setNode(a,e.node(a))})),i.forEach(e.edges(),(function(a){var i=t.edge(a.v,a.w)||{weight:0,minlen:1},n=e.edge(a);t.setEdge(a.v,a.w,{weight:i.weight+n.weight,minlen:Math.max(i.minlen,n.minlen)})})),t},asNonCompoundGraph:function(e){var t=new n({multigraph:e.isMultigraph()}).setGraph(e.graph());return i.forEach(e.nodes(),(function(a){e.children(a).length||t.setNode(a,e.node(a))})),i.forEach(e.edges(),(function(a){t.setEdge(a,e.edge(a))})),t},successorWeights:function(e){var t=i.map(e.nodes(),(function(t){var a={};return i.forEach(e.outEdges(t),(function(t){a[t.w]=(a[t.w]||0)+e.edge(t).weight})),a}));return i.zipObject(e.nodes(),t)},predecessorWeights:function(e){var t=i.map(e.nodes(),(function(t){var a={};return i.forEach(e.inEdges(t),(function(t){a[t.v]=(a[t.v]||0)+e.edge(t).weight})),a}));return i.zipObject(e.nodes(),t)},intersectRect:function(e,t){var a,i,n=e.x,s=e.y,r=t.x-n,o=t.y-s,l=e.width/2,c=e.height/2;if(!r&&!o)throw new Error("Not possible to find intersection inside of the rectangle");Math.abs(o)*l>Math.abs(r)*c?(o<0&&(c=-c),a=c*r/o,i=c):(r<0&&(l=-l),a=l,i=l*o/r);return{x:n+a,y:s+i}},buildLayerMatrix:function(e){var t=i.map(i.range(r(e)+1),(function(){return[]}));return i.forEach(e.nodes(),(function(a){var n=e.node(a),s=n.rank;i.isUndefined(s)||(t[s][n.order]=a)})),t},normalizeRanks:function(e){var t=i.min(i.map(e.nodes(),(function(t){return e.node(t).rank})));i.forEach(e.nodes(),(function(a){var n=e.node(a);i.has(n,"rank")&&(n.rank-=t)}))},removeEmptyRanks:function(e){var t=i.min(i.map(e.nodes(),(function(t){return e.node(t).rank}))),a=[];i.forEach(e.nodes(),(function(i){var n=e.node(i).rank-t;a[n]||(a[n]=[]),a[n].push(i)}));var n=0,s=e.graph().nodeRankFactor;i.forEach(a,(function(t,a){i.isUndefined(t)&&a%s!=0?--n:n&&i.forEach(t,(function(t){e.node(t).rank+=n}))}))},addBorderNode:function(e,t,a,i){var n={width:0,height:0};arguments.length>=4&&(n.rank=a,n.order=i);return s(e,"border",n,t)},maxRank:r,partition:function(e,t){var a={lhs:[],rhs:[]};return i.forEach(e,(function(e){t(e)?a.lhs.push(e):a.rhs.push(e)})),a},time:function(e,t){var a=i.now();try{return t()}finally{console.log(e+" time: "+(i.now()-a)+"ms")}},notime:function(e,t){return t()}}},,function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var i=a(15),n=a.n(i),s=a(2),r=a(66);const o=n.a.memo((({docLink:e})=>{const{chrome:t}=Object(r.b)().services;return Object(i.useEffect)((()=>{t.setHelpExtension({appName:s.i18n.translate("xpack.ml.chrome.help.appName",{defaultMessage:"Machine Learning"}),links:[{href:e,linkType:"documentation"}]})}),[]),null}));o.displayName="HelpMenu"},,,,,function(e,t,a){(function(e){var i=a(157).format_value,n=t.schema={},s=t.properties={CALSCALE:{type:"TEXT"},METHOD:{type:"TEXT"},PRODID:{type:"TEXT"},VERSION:{type:"TEXT"},ATTACH:{type:"URI"},CATEGORIES:{type:"TEXT",list:!0},CLASS:{type:"TEXT"},COMMENT:{type:"TEXT"},DESCRIPTION:{type:"TEXT"},GEO:{type:"FLOAT",list:!0},LOCATION:{type:"TEXT"},"PERCENT-COMPLETE":{type:"INTEGER"},PRIORITY:{type:"INTEGER"},RESOURCES:{type:"TEXT"},STATUS:{type:"TEXT"},SUMMARY:{type:"TEXT"},COMPLETED:{type:"DATE-TIME"},DTEND:{type:"DATE-TIME"},DUE:{type:"DATE-TIME"},DTSTART:{type:"DATE-TIME"},DURATION:{type:"DURATION"},FREEBUSY:{type:"PERIOD"},TRANSP:{type:"TEXT"},TZID:{type:"TEXT"},TZNAME:{type:"TEXT"},TZOFFSETFROM:{type:"UTC-OFFSET"},TZOFFSETTO:{type:"UTC-OFFSET"},TZURL:{type:"URI"},ATTENDEE:{type:"CAL-ADDRESS"},CONTACT:{type:"TEXT"},ORGANIZER:{type:"CAL-ADDRESS"},"RECURRENCE-ID":{type:"DATE-TIME"},"RELATED-TO":{type:"TEXT"},URL:{type:"URI"},UID:{type:"TEXT"},EXDATE:{type:"DATE-TIME",list:!0},RDATE:{type:"DATE-TIME",list:!0},RRULE:{type:"RECUR"},ACTION:{type:"TEXT"},REPEAT:{type:"INTEGER"},TRIGGER:{type:"DURATION"},CREATED:{type:"DATE-TIME"},DTSTAMP:{type:"DATE-TIME"},"LAST-MODIFIED":{type:"DATE-TIME"},SEQUENCE:{type:"INTEGER"},"REQUEST-STATUS":{type:"TEXT"}},r=t.CalendarObject=function(e,t){this.calendar=e,this.element=t,this.components={},this.properties={}};r.create=function(e,t){var a=(n[e]||{}).factory;return void 0!==a?new a(t):new r(t,e)},r.prototype.clone=function(){var e=r.create(this.element,this.calendar);for(var t in this.properties)e.addProperties(this.properties[t]);for(var a=this.getComponents(),i=0;i<a.length;++i)e.addComponent(a[i]);return e},r.prototype.addProperties=function(e){e.forEach(this.addProperty.bind(this))},r.prototype.addProperty=function(e,t,a){if(e instanceof o)e=e.clone();else{if(void 0===t)return;e=new o(e,t,a)}return this.properties[e.name]=this.properties[e.name]||[],this.properties[e.name].push(e),e},r.prototype.setProperty=function(e,t,a){this.removeProperty(e instanceof o?e.name:e),this.addProperty(e,t,a)},r.prototype.addComponent=function(e){if(!(e instanceof r)){var t=(n[e]||{}).factory;e=void 0!==t?new t(this.calendar):new r(this.calendar,e)}return e.calendar&&e.calendar!==this.calendar&&(e=e.clone()),this.components[e.element]=this.components[e.element]||[],this.components[e.element].push(e),e.calendar=this.calendar,e},r.prototype.addComponents=function(e){e.forEach(this.addComponent.bind(this))},r.prototype.getComponents=function(e){if(void 0===e){var t=[];for(var a in this.components)t=t.concat(this.components[a]);return t}return this.components[e]||[]},r.prototype.getProperty=function(e,t){return(this.properties[e]||[])[t||0]},r.prototype.getProperties=function(e){return this.properties[e]||[]},r.prototype.getPropertyValue=function(e,t){return(this.getProperty(e,t)||{}).value},r.prototype.removeProperty=function(e){delete this.properties[e]},r.prototype.validate=function(){var e=this,t=n[e.element];for(var a in t&&t.required_properties&&t.required_properties.forEach((function(t){if(!e.getPropertyValue(t))throw new Error(t+" is a required property of "+e.element)})),e.components)e.components[a].forEach((function(e){e.validate()}))},r.prototype.toString=function(){var e;if("VCALENDAR"==this.element)e=this.format();else{var t=new(a(178).iCalendar);t.addComponent(this),e=t.format()}return e.push(""),e.join("\r\n")},r.prototype.format=function(){var e=["BEGIN:"+this.element];for(var t in this.properties)this.properties[t].forEach((function(t){e.push.apply(e,t.format())}));for(var a in this.components)for(a=this.components[a],t=0;t<a.length;++t)e.push.apply(e,a[t].format());return e.push("END:"+this.element),e};var o=t.CalendarProperty=function(e,t,a){var i=s[e];this.type=i&&i.type?i.type:"TEXT",this.name=e,this.value=t,this.parameters=a||{}};o.prototype.clone=function(){var e=new o(this.name,this.value);for(var t in e.type=this.type,this.parameters)e.parameters[t]=this.parameters[t];return e},o.prototype.getParameter=function(e){return this.parameters[e]},o.prototype.setParameter=function(e,t){this.parameters[e]=t},o.prototype.format=function(){var t=[];for(var a in this.parameters)t.push(a+"="+this.parameters[a]);t.length&&(t=";"+t.join(";"));for(var n,s=new e(this.name+t+":"+i(this.type,this.value,this.parameters)),r=0,o=[];;){for(r+(n=75)>=s.length&&(n=s.length-r);128==(192&s[r+n]);)n--;if(o.push(s.toString("utf8",r,r+n)),r+n>=s.length)break;s[r+=n-1]=32}return o}}).call(this,a(176).Buffer)},function(e,t,a){var i;try{i={clone:a(473),constant:a(289),each:a(290),filter:a(294),has:a(304),isArray:a(114),isEmpty:a(488),isFunction:a(222),isUndefined:a(307),keys:a(159),map:a(308),reduce:a(310),size:a(492),transform:a(498),union:a(501),values:a(315)}}catch(e){}i||(i=window._),e.exports=i},,,function(e,t,a){var i;try{i=a(471)}catch(e){}i||(i=window.graphlib),e.exports=i},function(e,t,a){e.exports=a(20)(193)},,,function(e,t,a){"use strict";a.d(t,"d",(function(){return o})),a.d(t,"a",(function(){return l})),a.d(t,"c",(function(){return c})),a.d(t,"b",(function(){return d}));var i=a(51),n=a(90),s=a(99),r=a(166);function o(){const e=Object(r.a)().get("theme:darkMode")?i.euiDarkVars:i.euiLightVars;return{LINE_COLOR:e.euiColorPrimary,MODEL_COLOR:e.euiColorPrimary,EVENT_RATE_COLOR:e.euiColorPrimary,EVENT_RATE_COLOR_WITH_ANOMALIES:e.euiColorLightShade}}const l={width:"100%",height:"300px",cols:1,intervalMs:0},c={line:{strokeWidth:2,visible:!0,opacity:1},border:{visible:!1,strokeWidth:0},point:{visible:!1,radius:2,strokeWidth:4,opacity:.5},area:{opacity:.25,visible:!1}};function d(e,t){const a={...l,intervalMs:t.getInterval().asMilliseconds()};if(Object(n.d)(e)){const e=Object(s.c)();e.setInterval("auto"),e.setBounds(t.getBounds()),a.intervalMs=e.getInterval().asMilliseconds()}return a.intervalMs<e.bucketSpanMs&&(a.intervalMs=e.bucketSpanMs),(Object(n.c)(e)||Object(n.d)(e))&&(e.aggFieldPairs.length>2&&Object(n.c)(e)?(a.cols=3,a.height="150px",a.intervalMs=3*a.intervalMs):e.aggFieldPairs.length>1&&(a.cols=2,a.height="200px",a.intervalMs=2*a.intervalMs)),a}},function(e,t,a){"use strict";a.d(t,"a",(function(){return c})),a.d(t,"b",(function(){return d})),a.d(t,"c",(function(){return u})),a.d(t,"e",(function(){return p})),a.d(t,"f",(function(){return m})),a.d(t,"d",(function(){return b}));var i=a(72),n=a(154),s=a(18),r=a(70),o=a(96),l=a(82);let c;!function(e){e.regression="100mb",e.outlier_detection="50mb",e.classification="100mb"}(c||(c={}));const d=0,u="--",p=()=>({advancedEditorMessages:[],advancedEditorRawString:"",disableSwitchToForm:!1,form:{alpha:void 0,computeFeatureInfluence:"true",createIndexPattern:!0,classAssignmentObjective:void 0,dependentVariable:"",description:"",destinationIndex:"",destinationIndexNameExists:!1,destinationIndexNameEmpty:!0,destinationIndexNameValid:!1,destinationIndexPatternTitleExists:!1,earlyStoppingEnabled:void 0,downsampleFactor:void 0,eta:void 0,etaGrowthRatePerTree:void 0,featureBagFraction:void 0,featureInfluenceThreshold:void 0,featureProcessors:void 0,gamma:void 0,includes:[],jobId:"",jobIdExists:!1,jobIdEmpty:!0,jobIdInvalidMaxLength:!1,jobIdValid:!1,jobType:void 0,jobConfigQuery:r.l,jobConfigQueryString:void 0,jobConfigQueryLanguage:void 0,lambda:void 0,lossFunction:void 0,lossFunctionParameter:void 0,loadingFieldOptions:!1,maxNumThreads:1,maxOptimizationRoundsPerHyperparameter:void 0,maxTrees:void 0,method:void 0,modelMemoryLimit:void 0,modelMemoryLimitUnitValid:!0,modelMemoryLimitValidationResult:null,nNeighbors:void 0,numTopFeatureImportanceValues:d,numTopFeatureImportanceValuesValid:!0,numTopClasses:-1,outlierFraction:void 0,predictionFieldName:void 0,previousJobType:null,requiredFieldsError:void 0,randomizeSeed:void 0,resultsField:void 0,runtimeMappings:void 0,runtimeMappingsUpdated:!1,previousRuntimeMapping:void 0,softTreeDepthLimit:void 0,softTreeDepthTolerance:void 0,sourceIndex:"",sourceIndexNameEmpty:!0,sourceIndexNameValid:!1,sourceIndexContainsNumericalFields:!0,sourceIndexFieldsCheckFailed:!1,standardizationEnabled:"true",trainingPercent:80,useEstimatedMml:!0},jobConfig:{},disabled:!Object(n.c)()||!Object(i.e)("canCreateDataFrameAnalytics")||!Object(i.e)("canStartStopDataFrameAnalytics"),indexPatternsMap:{},isAdvancedEditorEnabled:!1,isAdvancedEditorValidJson:!0,hasSwitchedToEditor:!1,isJobCreated:!1,isJobStarted:!1,isValid:!1,jobIds:[],requestMessages:[],estimatedModelMemoryLimit:""}),m=e=>{const t={description:e.description,source:{index:e.sourceIndex.includes(",")?e.sourceIndex.split(",").map((e=>e.trim())):e.sourceIndex,query:e.jobConfigQuery,...Object(s.b)(e.runtimeMappings)?{runtime_mappings:e.runtimeMappings}:{}},dest:{index:e.destinationIndex},analyzed_fields:{includes:e.includes},analysis:{outlier_detection:{}},model_memory_limit:e.modelMemoryLimit};void 0!==e.maxNumThreads&&(t.max_num_threads=e.maxNumThreads);const a="string"==typeof(null==e?void 0:e.resultsField)&&""===(null==e?void 0:e.resultsField.trim());if(t.dest&&!a&&(t.dest.results_field=e.resultsField),e.jobType===l.a.REGRESSION||e.jobType===l.a.CLASSIFICATION){let a={dependent_variable:e.dependentVariable,num_top_feature_importance_values:e.numTopFeatureImportanceValues,training_percent:e.trainingPercent};a=Object.assign(a,e.alpha&&{alpha:e.alpha},e.eta&&{eta:e.eta},e.etaGrowthRatePerTree&&{eta_growth_rate_per_tree:e.etaGrowthRatePerTree},e.downsampleFactor&&{downsample_factor:e.downsampleFactor},e.featureBagFraction&&{feature_bag_fraction:e.featureBagFraction},e.featureProcessors&&{feature_processors:e.featureProcessors},e.gamma&&{gamma:e.gamma},e.lambda&&{lambda:e.lambda},e.lossFunction&&{loss_function:e.lossFunction},e.lossFunctionParameter&&{loss_function_parameter:e.lossFunctionParameter},e.maxOptimizationRoundsPerHyperparameter&&{max_optimization_rounds_per_hyperparameter:e.maxOptimizationRoundsPerHyperparameter},e.maxTrees&&{max_trees:e.maxTrees},e.randomizeSeed&&{randomize_seed:e.randomizeSeed},void 0!==e.earlyStoppingEnabled&&{early_stopping_enabled:e.earlyStoppingEnabled},e.predictionFieldName&&{prediction_field_name:e.predictionFieldName},e.randomizeSeed&&{randomize_seed:e.randomizeSeed},e.softTreeDepthLimit&&{soft_tree_depth_limit:e.softTreeDepthLimit},e.softTreeDepthTolerance&&{soft_tree_depth_tolerance:e.softTreeDepthTolerance}),t.analysis={[e.jobType]:a}}if(void 0!==(null==t?void 0:t.analysis)&&Object(o.f)(null==t?void 0:t.analysis)&&(void 0!==e.numTopClasses&&(t.analysis.classification.num_top_classes=e.numTopClasses),void 0!==e.classAssignmentObjective&&(t.analysis.classification.class_assignment_objective=e.classAssignmentObjective)),e.jobType===l.a.OUTLIER_DETECTION){const a=Object.assign({},void 0!==e.computeFeatureInfluence&&{compute_feature_influence:e.computeFeatureInfluence},e.method&&{method:e.method},e.nNeighbors&&{n_neighbors:e.nNeighbors},e.outlierFraction&&{outlier_fraction:e.outlierFraction},e.featureInfluenceThreshold&&{feature_influence_threshold:e.featureInfluenceThreshold},void 0!==e.standardizationEnabled&&{standardization_enabled:e.standardizationEnabled});t.analysis.outlier_detection=a}return t};function b(e,t=!0){var a,i,n;const s=Object(r.m)(e.analysis),o={jobType:s,description:null!==(a=e.description)&&void 0!==a?a:"",resultsField:e.dest.results_field,sourceIndex:Array.isArray(e.source.index)?e.source.index.join(","):e.source.index,runtimeMappings:e.source.runtime_mappings,modelMemoryLimit:e.model_memory_limit,maxNumThreads:e.max_num_threads,includes:null!==(i=null===(n=e.analyzed_fields)||void 0===n?void 0:n.includes)&&void 0!==i?i:[],jobConfigQuery:e.source.query||r.l};var l;!1===t&&(o.destinationIndex=null!==(l=null==e?void 0:e.dest.index)&&void 0!==l?l:"");const c=e.analysis[s];for(const e in c)if(c.hasOwnProperty(e)){o[e.replace(/_([a-z])/g,(function(e){return e[1].toUpperCase()}))]=c[e]}return o}},,,,,function(e,t,a){var i=a(478),n=a(481),s=a(182),r=a(114),o=a(485);e.exports=function(e){return"function"==typeof e?e:null==e?s:"object"==typeof e?r(e)?n(e[0],e[1]):i(e):o(e)}},,,function(e,t,a){"use strict";a.d(t,"k",(function(){return h})),a.d(t,"i",(function(){return g})),a.d(t,"j",(function(){return j})),a.d(t,"g",(function(){return x})),a.d(t,"h",(function(){return v})),a.d(t,"f",(function(){return y})),a.d(t,"m",(function(){return O})),a.d(t,"b",(function(){return w})),a.d(t,"c",(function(){return _})),a.d(t,"l",(function(){return S})),a.d(t,"d",(function(){return M})),a.d(t,"e",(function(){return k})),a.d(t,"a",(function(){return F}));var i=a(8),n=a(2),s=a(79),r=a(73),o=a(22),l=a(67),c=a(88),d=a(95),u=a(271),p=a(26),m=a(272),b=a(5);function h(e){return new Promise(((t,a)=>{l.ml.jobs.jobs([e]).then((a=>{if(!a.length)throw new Error(`Could not find job ${e}`);t(a[0])})).catch((e=>{a(e)}))}))}function f(e){return new Promise(((t,a)=>{l.ml.jobs.jobForCloning(e).then((a=>{if(!a)throw new Error(`Could not find job ${e}`);t(a)})).catch((e=>{a(e)}))}))}function g(e){return e.some((e=>e.datafeedState===d.a.STOPPED&&e.jobState!==d.c.CLOSING))}function j(e){return e.some((e=>e.datafeedState===d.a.STARTED||e.datafeedState===d.a.STARTING))}function x(e){return e.some((e=>e.datafeedState===d.a.STOPPED&&e.jobState!==d.c.CLOSED&&e.jobState!==d.c.CLOSING))}function v(e){return e.some((e=>{var t;return e.jobState===d.c.CLOSED||(null===(t=e.blocked)||void 0===t?void 0:t.reason)===u.a.RESET}))}function y(e,t,a,i=(()=>{})){const r=e.filter((e=>e.hasDatafeed)).map((e=>e.datafeedId));s.a.forceStartDatafeeds(r,t,a).then((e=>{E(e,d.a.STARTED),i()})).catch((e=>{Object(o.k)().addDanger(n.i18n.translate("xpack.ml.jobsList.startJobErrorMessage",{defaultMessage:"Jobs failed to start"}),e),i()}))}function O(e,t=(()=>{})){const a=e.filter((e=>e.hasDatafeed)).map((e=>e.datafeedId));s.a.stopDatafeeds(a).then((e=>{E(e,d.a.STOPPED),t()})).catch((e=>{Object(o.k)().addDanger(n.i18n.translate("xpack.ml.jobsList.stopJobErrorMessage",{defaultMessage:"Jobs failed to stop"}),e),t()}))}function E(e,t){const a=[],i=[];for(const n in e)!0===e[n][t]||!1===e[n][t]&&409===e[n].error.statusCode&&t===d.a.STARTED?a.push(n):i.push({id:n,result:e[n]});let s="",l="";t===d.a.STARTED?(s=n.i18n.translate("xpack.ml.jobsList.startActionStatusText",{defaultMessage:"start"}),l=n.i18n.translate("xpack.ml.jobsList.startedActionStatusText",{defaultMessage:"started"})):t===d.a.STOPPED?(s=n.i18n.translate("xpack.ml.jobsList.stopActionStatusText",{defaultMessage:"stop"}),l=n.i18n.translate("xpack.ml.jobsList.stoppedActionStatusText",{defaultMessage:"stopped"})):t===d.a.DELETED?(s=n.i18n.translate("xpack.ml.jobsList.deleteActionStatusText",{defaultMessage:"delete"}),l=n.i18n.translate("xpack.ml.jobsList.deletedActionStatusText",{defaultMessage:"deleted"})):t===d.c.CLOSED?(s=n.i18n.translate("xpack.ml.jobsList.closeActionStatusText",{defaultMessage:"close"}),l=n.i18n.translate("xpack.ml.jobsList.closedActionStatusText",{defaultMessage:"closed"})):t===u.a.RESET&&(s=n.i18n.translate("xpack.ml.jobsList.resetActionStatusText",{defaultMessage:"reset"}),l=n.i18n.translate("xpack.ml.jobsList.resetActionStatusText",{defaultMessage:"reset"}));const c=Object(o.k)();c.addSuccess(n.i18n.translate("xpack.ml.jobsList.actionExecuteSuccessfullyNotificationMessage",{defaultMessage:"{successesJobsCount, plural, one{{successJob}} other{# jobs}} {actionTextPT} successfully",values:{successesJobsCount:a.length,successJob:a[0],actionTextPT:l}})),i.length>0&&i.forEach((e=>{Object(r.b)(c).displayErrorToast(e.result.error,n.i18n.translate("xpack.ml.jobsList.actionFailedNotificationMessage",{defaultMessage:"{failureId} failed to {actionText}",values:{failureId:e.id,actionText:s}}))}))}async function w(e){try{var t;const[{job:i,datafeed:n},r]=await Promise.all([f(e),h(e)]);var a;if(void 0!==i&&void 0!==(null==r||null===(t=r.custom_settings)||void 0===t?void 0:t.created_by)){if(s.a.tempJobCloningObjects.createdBy=null==r||null===(a=r.custom_settings)||void 0===a?void 0:a.created_by,s.a.tempJobCloningObjects.job=i,void 0!==r.data_counts.earliest_record_timestamp&&void 0!==r.data_counts.latest_record_timestamp&&void 0!==r.data_counts.latest_bucket_timestamp){let e=r.data_counts.earliest_record_timestamp,t=r.data_counts.latest_record_timestamp;if(void 0!==r.datafeed_config.aggregations){const a=Object(p.a)(r.analysis_config.bucket_span).asMilliseconds();e=Math.floor(r.data_counts.earliest_record_timestamp/a)*a,t=r.data_counts.latest_bucket_timestamp+2*a-1}s.a.tempJobCloningObjects.start=e,s.a.tempJobCloningObjects.end=t}}else s.a.tempJobCloningObjects.job=i,s.a.tempJobCloningObjects.createdBy=void 0;void 0!==n&&(s.a.tempJobCloningObjects.datafeed=n),r.calendars&&(s.a.tempJobCloningObjects.calendars=await m.a.fetchCalendarsByIds(r.calendars)),window.location.href="#/jobs/new_job"}catch(t){Object(r.a)().displayErrorToast(t,n.i18n.translate("xpack.ml.jobsList.cloneJobErrorMessage",{defaultMessage:"Could not clone {jobId}. Job could not be found",values:{jobId:e}}))}}function _(e,t=(()=>{})){const a=e.map((e=>e.id));s.a.closeJobs(a).then((e=>{E(e,d.c.CLOSED),t()})).catch((e=>{Object(r.a)().displayErrorToast(e,n.i18n.translate("xpack.ml.jobsList.closeJobErrorMessage",{defaultMessage:"Jobs failed to close"})),t()}))}function S(e,t=(()=>{})){s.a.resetJobs(e).then((e=>{E(e,u.a.RESET),t()})).catch((e=>{Object(r.a)().displayErrorToast(e,n.i18n.translate("xpack.ml.jobsList.resetJobErrorMessage",{defaultMessage:"Jobs failed to reset"})),t()}))}function M(e,t=(()=>{})){const a=e.map((e=>e.id));s.a.deleteJobs(a).then((e=>{E(e,d.c.DELETED),t()})).catch((e=>{Object(r.a)().displayErrorToast(e,n.i18n.translate("xpack.ml.jobsList.deleteJobErrorMessage",{defaultMessage:"Jobs failed to delete"})),t()}))}function k(e,t){if(0===t.length)return e;const a=e.reduce(((e,t)=>(e[t.id]={job:t,count:0},e)),{});t.forEach((t=>{const i="must"===t.match;let n=[];"term"===t.type?n=!0===i?e.filter((e=>Object(c.f)(e.id,t.value)===i||Object(c.f)(e.description,t.value)===i||Object(c.f)(e.memory_status,t.value)===i)):e.filter((e=>Object(c.f)(e.id,t.value)===i&&Object(c.f)(e.description,t.value)===i&&Object(c.f)(e.memory_status,t.value)===i)):Array.isArray(t.value)?"id"===t.field?n=e.filter((e=>t.value.indexOf(C(e,t.field))>=0)):"groups"===t.field?n=e.filter((e=>C(e,t.field).some((e=>t.value.indexOf(e)>=0)))):"job_tags"===t.field&&(n=T(e,t.value)):n="job_tags"===t.field?n=T(e,[t.value]):e.filter((e=>C(e,t.field)===t.value)),n.forEach((e=>a[e.id].count++))}));const n=[];return Object(i.each)(a,(e=>{e.count>=t.length&&n.push(e.job)})),n}function C(e,t){return e[{job_state:"jobState",datafeed_state:"datafeedState",groups:"groups",id:"id",job_tags:"jobTags"}[t]]}function T(e,t){return e.filter((e=>{const a=C(e,"job_tags");return Object.entries(a).map((e=>e.join(":"))).find((e=>t.some((t=>t===e))))}))}function F(){const e=s.a.tempJobCloningObjects.job,t=s.a.tempJobCloningObjects.datafeed;if(void 0!==e){s.a.tempJobCloningObjects.job=void 0,s.a.tempJobCloningObjects.datafeed=void 0,s.a.tempJobCloningObjects.createdBy=void 0;const a=Object(b.b)(t),i=a?t.datafeed_id:"";return{id:e.job_id,hasDatafeed:a,latestTimestampSortValue:0,datafeedId:i}}}},,,,function(e,t,a){"use strict";a.d(t,"a",(function(){return o})),a.d(t,"b",(function(){return r}));a(15);var i=a(40),n=a(170),s=a(11);const r={TEXT:"text",JSON:"json",XJSON:new n.a},o=({value:e,height:t="500px",width:a="100%",mode:o=r.JSON,readOnly:l=!1,syntaxChecking:c=!0,theme:d="textmate",onChange:u=(()=>{})})=>(o===r.XJSON&&(e=Object(n.c)(e)),Object(s.jsx)(i.EuiCodeEditor,{value:e,width:a,height:t,mode:o,readOnly:l,wrapEnabled:!0,showPrintMargin:!1,theme:d,editorProps:{$blockScrolling:!0},setOptions:{useWorker:c,tabSize:2,useSoftTabs:!0},onChange:u}))},,,,,,function(e,t,a){"use strict";a.d(t,"b",(function(){return o})),a.d(t,"c",(function(){return l})),a.d(t,"a",(function(){return AnnotationUpdatesService}));var i=a(4),n=a.n(i),s=a(23),r=a(25);new s.BehaviorSubject(null);const o=new s.BehaviorSubject(Date.now()),l=()=>o.next(Date.now());class AnnotationUpdatesService{constructor(){n()(this,"_annotation$",new s.BehaviorSubject(null))}update$(){return this._annotation$.asObservable()}isAnnotationInitialized$(){return this._annotation$.asObservable().pipe(Object(r.distinctUntilChanged)(((e,t)=>null!==e&&null!==t)))}setValue(e){this._annotation$.next(e)}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var i=a(15),n=a(136);const s=Object(i.createContext)(new n.a)},function(e,t,a){"use strict";a.d(t,"c",(function(){return s})),a.d(t,"b",(function(){return r})),a.d(t,"a",(function(){return o}));var i=a(112),n=a(74);function s(){return{job_id:"",description:"",groups:[],analysis_config:{bucket_span:"",detectors:[],influencers:[]},data_description:{time_field:""}}}function r(e){return{datafeed_id:"",job_id:"",indices:Object(n.t)(e),query:{}}}function o(e,t){const a={function:e.id};return t.id!==i.a&&(a.field_name=t.id),a}},function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"a",(function(){return o}));var i=a(2),n=a(27),s=a(83);function r(e,t,a,r){const l=Object(s.d)();if(e.contains("job_id_empty"))t.jobId.valid=!1;else if(e.contains("job_id_invalid")){t.jobId.valid=!1;const e=i.i18n.translate("xpack.ml.newJob.wizard.validateJob.jobNameAllowedCharactersDescription",{defaultMessage:"Job ID can contain lowercase alphanumeric (a-z and 0-9), hyphens or underscores; must start and end with an alphanumeric character"});t.jobId.message=e}else if(e.contains("job_id_invalid_max_length"))t.jobId.valid=!1,t.jobId.message=i.i18n.translate("xpack.ml.newJob.wizard.validateJob.jobIdInvalidMaxLengthErrorMessage",{defaultMessage:"Job ID must be no more than {maxLength, plural, one {# character} other {# characters}} long.",values:{maxLength:n.b}});else if(e.contains("job_id_already_exists")){t.jobId.valid=!1;const e=i.i18n.translate("xpack.ml.newJob.wizard.validateJob.jobNameAlreadyExists",{defaultMessage:"Job ID already exists. A job ID cannot be the same as an existing job or group."});t.jobId.message=e}if(e.contains("job_group_id_invalid")){t.groupIds.valid=!1;const e=i.i18n.translate("xpack.ml.newJob.wizard.validateJob.jobGroupAllowedCharactersDescription",{defaultMessage:"Job group names can contain lowercase alphanumeric (a-z and 0-9), hyphens or underscores; must start and end with an alphanumeric character"});t.groupIds.message=e}else if(e.contains("job_group_id_invalid_max_length"))t.groupIds.valid=!1,t.groupIds.message=i.i18n.translate("xpack.ml.newJob.wizard.validateJob.jobGroupMaxLengthDescription",{defaultMessage:"Job group name must be no more than {maxLength, plural, one {# character} other {# characters}} long.",values:{maxLength:n.b}});else if(e.contains("job_group_id_already_exists")){t.groupIds.valid=!1;const e=i.i18n.translate("xpack.ml.newJob.wizard.validateJob.groupNameAlreadyExists",{defaultMessage:"Group ID already exists. A group ID cannot be the same as an existing job or group."});t.groupIds.message=e}if(e.contains("model_memory_limit_units_invalid")){t.modelMemoryLimit.valid=!1;const e=`${n.a.slice(0,n.a.length-1).join(", ")} or ${[...n.a].pop()}`,a=i.i18n.translate("xpack.ml.newJob.wizard.validateJob.modelMemoryLimitUnitsInvalidErrorMessage",{defaultMessage:"Model memory limit data unit unrecognized. It must be {str}",values:{str:e}});t.modelMemoryLimit.message=a}if(e.contains("model_memory_limit_invalid")){t.modelMemoryLimit.valid=!1;const e=(l.max_model_memory_limit||"").toUpperCase(),a=i.i18n.translate("xpack.ml.newJob.wizard.validateJob.modelMemoryLimitRangeInvalidErrorMessage",{defaultMessage:"Model memory limit cannot be higher than the maximum value of {maxModelMemoryLimit}",values:{maxModelMemoryLimit:e}});t.modelMemoryLimit.message=a}if(e.contains("detectors_duplicates")){t.duplicateDetectors.valid=!1;const e=i.i18n.translate("xpack.ml.newJob.wizard.validateJob.duplicatedDetectorsErrorMessage",{defaultMessage:"Duplicate detectors were found."});t.duplicateDetectors.message=e}if(e.contains("categorizer_detector_missing_per_partition_field")){t.categorizerMissingPerPartition.valid=!1;const e=i.i18n.translate("xpack.ml.newJob.wizard.validateJob.categorizerMissingPerPartitionFieldMessage",{defaultMessage:'Partition field must be set for detectors that reference "mlcategory" when per-partition categorization is enabled.'});t.categorizerMissingPerPartition.message=e}if(e.contains("categorizer_varying_per_partition_fields")){t.categorizerVaryingPerPartitionField.valid=!1;const e=i.i18n.translate("xpack.ml.newJob.wizard.validateJob.categorizerVaryingPerPartitionFieldNamesMessage",{defaultMessage:'Detectors with keyword "mlcategory" cannot have different partition_field_name when per-partition categorization is enabled.'});t.categorizerVaryingPerPartitionField.message=e}if(e.contains("bucket_span_empty")){t.bucketSpan.valid=!1;const e=i.i18n.translate("xpack.ml.newJob.wizard.validateJob.bucketSpanMustBeSetErrorMessage",{defaultMessage:"Bucket span must be set"});t.bucketSpan.message=e}else e.contains("bucket_span_invalid")&&(t.bucketSpan.valid=!1,t.bucketSpan.message=o(a.analysis_config.bucket_span));if(e.contains("query_empty")){t.query.valid=!1;const e=i.i18n.translate("xpack.ml.newJob.wizard.validateJob.queryCannotBeEmpty",{defaultMessage:"Datafeed query cannot be empty."});t.query.message=e}else if(e.contains("query_invalid")){t.query.valid=!1;const e=i.i18n.translate("xpack.ml.newJob.wizard.validateJob.queryIsInvalidEsQuery",{defaultMessage:"Datafeed query must be a valid elasticsearch query."});t.query.message=e}e.contains("query_delay_invalid")&&(t.queryDelay.valid=!1,t.queryDelay.message=o(r.query_delay)),e.contains("frequency_invalid")&&(t.frequency.valid=!1,t.frequency.message=o(r.frequency)),e.contains("missing_summary_count_field_name")&&(t.summaryCountField.valid=!1,t.summaryCountField.message=i.i18n.translate("xpack.ml.newJob.wizard.validateJob.summaryCountFieldMissing",{defaultMessage:"Required field as the datafeed uses aggregations."}))}function o(e){return i.i18n.translate("xpack.ml.newJob.wizard.validateJob.frequencyInvalidTimeIntervalFormatErrorMessage",{defaultMessage:"{value} is not a valid time interval format e.g. {thirtySeconds}, {tenMinutes}, {oneHour}, {sevenDays}. It also needs to be higher than zero.",values:{value:e,thirtySeconds:"30s",tenMinutes:"10m",oneHour:"1h",sevenDays:"7d"}})}},,,,function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var i=a(51),n=a(10);const s=[i.euiDarkVars.euiColorVis0,i.euiDarkVars.euiColorVis1,i.euiDarkVars.euiColorVis2,i.euiDarkVars.euiColorVis3,i.euiDarkVars.euiColorVis4,i.euiDarkVars.euiColorVis5,i.euiDarkVars.euiColorVis6,i.euiDarkVars.euiColorVis7,i.euiDarkVars.euiColorVis8,i.euiDarkVars.euiColorVis9,i.euiDarkVars.euiColorDarkShade,i.euiDarkVars.euiColorPrimary],r={};function o(e){if(void 0===r[e]){const t=Object(n.d)(e),a=s[t%s.length];return r[e]=a,a}return r[e]}},function(e,t,a){"use strict";a.d(t,"b",(function(){return s})),a.d(t,"a",(function(){return r})),a.d(t,"c",(function(){return o}));var i=a(2),n=a(279);const s=5;let r;!function(e){e.VALID="valid",e.PARTIALLY_VALID="partially_valid",e.INVALID="invalid"}(r||(r={}));const o={[n.a.NO_EXAMPLES]:i.i18n.translate("xpack.ml.models.jobService.categorization.messages.validNoDataFound",{defaultMessage:"Examples  were successfully loaded."}),[n.a.FAILED_TO_TOKENIZE]:i.i18n.translate("xpack.ml.models.jobService.categorization.messages.validFailureToGetTokens",{defaultMessage:"The examples loaded were tokenized successfully."}),[n.a.TOKEN_COUNT]:i.i18n.translate("xpack.ml.models.jobService.categorization.messages.validTokenLength",{defaultMessage:"More than {tokenCount} tokens per example were found in over {percentage}% of the examples loaded.",values:{percentage:Math.floor(75),tokenCount:3}}),[n.a.MEDIAN_LINE_LENGTH]:i.i18n.translate("xpack.ml.models.jobService.categorization.messages.validMedianLineLength",{defaultMessage:"The median line length of the examples loaded was less than {medianCharCount} characters.",values:{medianCharCount:400}}),[n.a.NULL_VALUES]:i.i18n.translate("xpack.ml.models.jobService.categorization.messages.validNullValues",{defaultMessage:"Less than {percentage}% of the examples loaded were null.",values:{percentage:Math.floor(25)}}),[n.a.TOO_MANY_TOKENS]:i.i18n.translate("xpack.ml.models.jobService.categorization.messages.validTooManyTokens",{defaultMessage:"Less than 10000 tokens were found in total in the examples loaded."}),[n.a.INSUFFICIENT_PRIVILEGES]:i.i18n.translate("xpack.ml.models.jobService.categorization.messages.validUserPrivileges",{defaultMessage:"The user has sufficient privileges to perform the checks."})}},function(e,t,a){"use strict";a.d(t,"e",(function(){return d})),a.d(t,"a",(function(){return u})),a.d(t,"d",(function(){return p})),a.d(t,"b",(function(){return h})),a.d(t,"c",(function(){return f}));var i=a(8),n=a(21),s=a.n(n),r=a(53),o=a.n(r),l=a(26),c=a(88);function d(e,t,a,i){const n=e.url_value,r=a[i],o="time_range"in e&&e.time_range?Object(l.a)(e.time_range):null,c={...a};if(n.includes("$earliest$")){const e=s()(r);null!==o?e.subtract(o):e.subtract(t,"s"),c.earliest=e.toISOString()}if(n.includes("$latest$")){const e=s()(r).add(t,"s");null!==o?e.add(o):e.add(t,"s"),c.latest=e.toISOString()}return u(e,c)}function u(e,t){if(!0===m(e))return function(e,t){const a=e.url_value,n=a.includes("language:lucene"),s=n?c.c:b,r=Object(i.flow)(encodeURIComponent),l=e=>{const a=Object(i.flow)(n?e=>e:s,r);return e.replace(/\$([^?&$\'"]+)\$(\/)?/g,((e,n,s="")=>{let r=Object(i.get)(t,n);return r=Array.isArray(r)?r[0]:r,void 0===r?"":a(r)+s}))};return Object(i.flow)(decodeURIComponent,(e=>e.replace("$earliest$",t.earliest).replace("$latest$",t.latest)),(e=>{const a=Object(i.flow)(s,r),n=((e,t)=>(a,n,s,r)=>{let o=2e3-a.length-s.length;const l=n.split(/\sand\s/i).map((e=>(e=>{let t="";for(let a=0;a<e.length;a++)if("$"===e[a]){let i=a;for(let t=i;t>-1;t--)if(":"===e[t]){i=t;break}t=e.slice(0,i).trim();let n=e.slice(i,e.length);const s=n.indexOf("$"),r=n.lastIndexOf("$");if(n=n.slice(s,r+1),n===`$${t}$`)break}return t})(String(e).replace(/\\/g,"")))),d=[],u=" AND ";e:for(let a=0;a<l.length;a++){const n=l[a],s=r?`"${l[a]}"`:Object(c.c)(n);let u=Object(i.get)(e,n)||null;if(null===u)continue;u=Array.isArray(u)?u:[u];let p="";for(let e=0;e<u.length;e++){const a=`${e>0?" OR ":""}${s}:"${t(u[e])}"`;if(o<a.length){p.length>0&&d.push(e>0?`(${p})`:p);break e}p+=a,o-=p.length}p.length>0&&d.push(u.length>1?`(${p})`:p)}return d.join(u)})(t,a),d=e.match(/(.+)(\(.*\blanguage:(?:lucene|kuery)\b.*?\))(.+)/);if(null!==d&&void 0!==d[2]){const[,e,t,a]=d,i=t.indexOf("language:kuery")>-1,s=o.a.decode(t);if(null!==(u=s)&&"object"==typeof u&&s.hasOwnProperty("query")){const[t,r]=[e,a].map(l),c=n(t,s.query,r,i);return`${t}${o.a.encode({...s,query:c})}${r}`}}var u;return e.replace(/(.+&kuery=)(.*?)[^!](&.+)/,((t,a,i,s)=>{const[r,o]=[a,s].map(l);return`${r}${n(r,i,o,e.indexOf("language:kuery")>-1)}${o}`}))}),l)(a)}(e,t);return Object(c.e)(e.url_value,t,!1)}function p(e,t,a){if(!1===/^(?:[a-z]+:)?\/\//i.test(t.url_value))"/"!==e.charAt(0)&&(e=`${a}${m(t)?"/app/":"/"}${e}`),window.open(e,"_blank");else{const t=window.open(e,"_blank","noopener,noreferrer");null!=t&&(t.opener=null)}}function m(e){const t=e.url_value;return t.startsWith("discover#/")||t.startsWith("dashboards#/")||t.startsWith("apm#/")||t.startsWith("metrics/")||t.startsWith("security/")||t.startsWith("siem#/")}function b(e){return String(e).replace(/\"/g,'\\"')}function h(e,t){let a=void 0!==e&&e.trim().length>0;if(!0===a&&void 0!==t){a=!t.map((e=>e.url_name)).includes(e)}return a}function f(e){if(void 0===e||0===e.length||"auto"===e)return!0;return null!==Object(l.a)(e)}},function(e,t,a){"use strict";a.d(t,"d",(function(){return h})),a.d(t,"c",(function(){return f})),a.d(t,"b",(function(){return g})),a.d(t,"e",(function(){return j})),a.d(t,"a",(function(){return x}));var i=a(40),n=a(15),s=a.n(n),r=a(8),o=a(2),l=a(75),c=a(70),d=a(82),u=a(66),p=a(358),m=a(24),b=a(11);function h(e,t=(e=>({allow_lazy_start:{optional:!0,defaultValue:!1},description:{optional:!0,formKey:"description"},analysis:{...Object(c.v)(e.analysis)?{classification:{dependent_variable:{optional:!1,formKey:"dependentVariable"},training_percent:{optional:!0,formKey:"trainingPercent"},eta:{optional:!0,formKey:"eta"},feature_bag_fraction:{optional:!0,formKey:"featureBagFraction"},max_trees:{optional:!0,formKey:"maxTrees"},gamma:{optional:!0,formKey:"gamma"},lambda:{optional:!0,formKey:"lambda"},num_top_classes:{optional:!0,defaultValue:2,formKey:"numTopClasses"},prediction_field_name:{optional:!0,defaultValue:`${e.analysis.classification.dependent_variable}_prediction`,formKey:"predictionFieldName"},randomize_seed:{optional:!0,ignore:!0,formKey:"randomizeSeed"},num_top_feature_importance_values:{optional:!0,defaultValue:p.a,formKey:"numTopFeatureImportanceValues"},class_assignment_objective:{optional:!0,defaultValue:"maximize_minimum_recall"},early_stopping_enabled:{optional:!0,ignore:!0},alpha:{optional:!0,formKey:"alpha"},downsample_factor:{optional:!0,formKey:"downsampleFactor"},eta_growth_rate_per_tree:{optional:!0,formKey:"etaGrowthRatePerTree"},feature_processors:{optional:!0},max_optimization_rounds_per_hyperparameter:{optional:!0,formKey:"maxOptimizationRoundsPerHyperparameter"},soft_tree_depth_limit:{optional:!0,formKey:"softTreeDepthLimit"},soft_tree_depth_tolerance:{optional:!0,formKey:"softTreeDepthTolerance"}}}:{},...Object(l.r)(e.analysis)?{outlier_detection:{standardization_enabled:{defaultValue:!0,optional:!0,formKey:"standardizationEnabled"},compute_feature_influence:{defaultValue:!0,optional:!0,formKey:"computeFeatureInfluence"},outlier_fraction:{defaultValue:.05,optional:!0,formKey:"outlierFraction"},feature_influence_threshold:{optional:!0,formKey:"featureInfluenceThreshold"},method:{optional:!0,formKey:"method"},n_neighbors:{optional:!0,formKey:"nNeighbors"}}}:{},...Object(c.y)(e.analysis)?{regression:{dependent_variable:{optional:!1,formKey:"dependentVariable"},training_percent:{optional:!0,formKey:"trainingPercent"},eta:{optional:!0,formKey:"eta"},feature_bag_fraction:{optional:!0,formKey:"featureBagFraction"},max_trees:{optional:!0,formKey:"maxTrees"},gamma:{optional:!0,formKey:"gamma"},lambda:{optional:!0,formKey:"lambda"},prediction_field_name:{optional:!0,defaultValue:`${e.analysis.regression.dependent_variable}_prediction`,formKey:"predictionFieldName"},num_top_feature_importance_values:{optional:!0,defaultValue:p.a,formKey:"numTopFeatureImportanceValues"},randomize_seed:{optional:!0,ignore:!0,formKey:"randomizeSeed"},loss_function:{optional:!0,defaultValue:"mse"},loss_function_parameter:{optional:!0},feature_processors:{optional:!0},early_stopping_enabled:{optional:!0,ignore:!0},alpha:{optional:!0,formKey:"alpha"},downsample_factor:{optional:!0,formKey:"downsampleFactor"},eta_growth_rate_per_tree:{optional:!0,formKey:"etaGrowthRatePerTree"},max_optimization_rounds_per_hyperparameter:{optional:!0,formKey:"maxOptimizationRoundsPerHyperparameter"},soft_tree_depth_limit:{optional:!0,formKey:"softTreeDepthLimit"},soft_tree_depth_tolerance:{optional:!0,formKey:"softTreeDepthTolerance"}}}:{}},analyzed_fields:{excludes:{optional:!0,defaultValue:[]},includes:{optional:!0,formKey:"includes",defaultValue:[]}},source:{index:{formKey:"sourceIndex",optional:!1},query:{optional:!0,defaultValue:{match_all:{}}},runtime_mappings:{optional:!0,formKey:"runtimeMappings",defaultValue:void 0},_source:{optional:!0}},dest:{index:{optional:!1,formKey:"destinationIndex"},results_field:{optional:!0,formKey:"resultsField",defaultValue:d.d}},model_memory_limit:{optional:!0,formKey:"modelMemoryLimit"},max_num_threads:{optional:!0,formKey:"maxNumThreads"}}))(e)){for(const a in e)if(e.hasOwnProperty(a)){const i=e[a],n=t[a];if(!n)return console.info(`Property "${a}" is unknown.`),!0;if(n.hasOwnProperty("optional")){if(void 0===n.formKey&&!0!==n.ignore&&!Object(r.isEqual)(n.defaultValue,i))return console.info(`Property "${a}" is not supported by the form or has a different value to the default.`),!0}else if(h(i,n))return!0}return!1}function f({id:e,...t}){return Object(r.cloneDeep)({...t,dest:{...t.dest,index:""}})}const g=o.i18n.translate("xpack.ml.dataframe.analyticsList.cloneActionNameText",{defaultMessage:"Clone"}),j=()=>{const{services:{notifications:{toasts:e},data:{dataViews:t}}}=Object(u.b)(),a=Object(u.e)();return async i=>{const n=Array.isArray(i.config.source.index)?i.config.source.index.join(","):i.config.source.index;let s;try{const a=(await t.find(n)).find((({title:e})=>e===n));void 0!==a?s=a.id:e.addDanger(o.i18n.translate("xpack.ml.dataframe.analyticsList.noSourceIndexPatternForClone",{defaultMessage:"Unable to clone the analytics job. No index pattern exists for index {indexPattern}.",values:{indexPattern:n}}))}catch(t){const a=Object(m.b)(t);e.addDanger(o.i18n.translate("xpack.ml.dataframe.analyticsList.fetchSourceIndexPatternForCloneErrorMessage",{defaultMessage:"An error occurred checking if index pattern {indexPattern} exists: {error}",values:{indexPattern:n,error:a}}))}s&&await a(`/data_frame_analytics/new_job?index=${encodeURIComponent(s)}&jobId=${i.config.id}`)}},x=({isDisabled:e})=>e?Object(b.jsx)(i.EuiToolTip,{position:"top",content:o.i18n.translate("xpack.ml.dataframe.analyticsList.cloneActionPermissionTooltip",{defaultMessage:"You do not have permission to clone analytics jobs."})},Object(b.jsx)(s.a.Fragment,null,g)):Object(b.jsx)(s.a.Fragment,null,g)},function(e,t,a){e.exports=a(20)(899)},,function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));a(15);var i=a(40),n=a(11);const s=()=>Object(n.jsx)(i.EuiText,{textAlign:"center"},Object(n.jsx)(i.EuiSpacer,{size:"l"}),Object(n.jsx)(i.EuiLoadingSpinner,{size:"l"}),Object(n.jsx)(i.EuiSpacer,{size:"l"}))},,function(e,t,a){"use strict";a.d(t,"a",(function(){return c})),a.d(t,"b",(function(){return d}));var i=a(15),n=a.n(i),s=a(40),r=a(41),o=a(154),l=a(11);const c=({jobCount:e})=>!1===Object(o.b)()||0===e?null:Object(l.jsx)(n.a.Fragment,null,Object(l.jsx)(s.EuiCallOut,{title:Object(l.jsx)(r.FormattedMessage,{id:"xpack.ml.jobsAwaitingNodeWarning.title",defaultMessage:"Awaiting machine learning node"}),color:"primary",iconType:"iInCircle"},Object(l.jsx)("div",null,Object(l.jsx)(r.FormattedMessage,{id:"xpack.ml.jobsAwaitingNodeWarning.noMLNodesAvailableDescription",defaultMessage:"There {jobCount, plural, one {is} other {are}} {jobCount, plural, one {# job} other {# jobs}} waiting for machine learning nodes to start.",values:{jobCount:e}}))),Object(l.jsx)(s.EuiSpacer,{size:"m"})),d=()=>!1===Object(o.b)()?null:Object(l.jsx)(n.a.Fragment,null,Object(l.jsx)(s.EuiCallOut,{title:Object(l.jsx)(r.FormattedMessage,{id:"xpack.ml.jobsAwaitingNodeWarning.title",defaultMessage:"Awaiting machine learning node"}),color:"primary",iconType:"iInCircle"},Object(l.jsx)("div",null,Object(l.jsx)(r.FormattedMessage,{id:"xpack.ml.newJobAwaitingNodeWarning.noMLNodesAvailableDescription",defaultMessage:"There are currently no nodes that can run the job, therefore it will remain in OPENING state until an appropriate node becomes available."}))),Object(l.jsx)(s.EuiSpacer,{size:"m"}));a(33)},,,function(e,t,a){"use strict";var i=a(85);a.d(t,"a",(function(){return i.c})),a.d(t,"c",(function(){return i.e})),a.d(t,"b",(function(){return i.d})),a.d(t,"d",(function(){return i.f}))},function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"c",(function(){return n})),a.d(t,"b",(function(){return s})),a.d(t,"d",(function(){return r}));const i=3e4,n=1e3,s=2e3,r=1e3},function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var i=a(8),n=a(25),s=a(67);const r={getForecastsSummary:function(e,t,a,i){return new Promise(((n,r)=>{const o={success:!0,forecasts:[]},l=[{term:{result_type:"model_forecast_request_stats"}},{term:{job_id:e.job_id}},{range:{timestamp:{gte:a,format:"epoch_millis"}}}];t&&l.push(t),s.ml.results.anomalySearch({size:i,body:{query:{bool:{filter:l}},sort:[{forecast_create_timestamp:{order:"desc"}}]}},[e.job_id]).then((e=>{e.hits.total.value>0&&(o.forecasts=e.hits.hits.map((e=>e._source))),n(o)})).catch((e=>{r(e)}))}))},getForecastDateRange:function(e,t){return new Promise(((a,n)=>{const r={success:!0,earliest:null,latest:null},o=[{query_string:{query:"result_type:model_forecast",analyze_wildcard:!0}},{term:{job_id:e.job_id}},{term:{forecast_id:t}}];s.ml.results.anomalySearch({size:0,body:{query:{bool:{filter:o}},aggs:{earliest:{min:{field:"timestamp"}},latest:{max:{field:"timestamp"}}}}},[e.job_id]).then((e=>{r.earliest=Object(i.get)(e,"aggregations.earliest.value",null),r.latest=Object(i.get)(e,"aggregations.latest.value",null),null===r.earliest||null===r.latest?n(e):a(r)})).catch((e=>{n(e)}))}))},getForecastData:function(e,t,a,r,o,l,c,d){const u=[],p=e.analysis_config.detectors[t];if(void 0!==p.partition_field_name){const e=Object(i.find)(r,{fieldName:p.partition_field_name});void 0!==e&&u.push({fieldName:"partition_field_name",fieldValue:e.fieldName},{fieldName:"partition_field_value",fieldValue:e.fieldValue})}if(void 0!==p.over_field_name){const e=Object(i.find)(r,{fieldName:p.over_field_name});void 0!==e&&u.push({fieldName:"over_field_name",fieldValue:e.fieldName},{fieldName:"over_field_value",fieldValue:e.fieldValue})}if(void 0!==p.by_field_name){const e=Object(i.find)(r,{fieldName:p.by_field_name});void 0!==e&&u.push({fieldName:"by_field_name",fieldValue:e.fieldName},{fieldName:"by_field_value",fieldValue:e.fieldValue})}const m={success:!0,results:{}},b=[{query_string:{query:"result_type:model_forecast",analyze_wildcard:!0}},{term:{job_id:e.job_id}},{term:{forecast_id:a}},{term:{detector_index:t}},{range:{timestamp:{gte:o,lte:l,format:"epoch_millis"}}}];Object(i.each)(u,(e=>{b.push({term:{[e.fieldName]:e.fieldValue}})}));const h=void 0===d?{avg:"avg",max:"max",min:"min"}:{avg:d.avg,max:d.max,min:d.min};return s.ml.results.anomalySearch$({size:0,body:{query:{bool:{filter:b}},aggs:{times:{date_histogram:{field:"timestamp",fixed_interval:`${c}ms`,min_doc_count:1},aggs:{prediction:{[h.avg]:{field:"forecast_prediction"}},forecastUpper:{[h.max]:{field:"forecast_upper"}},forecastLower:{[h.min]:{field:"forecast_lower"}}}}}}},[e.job_id]).pipe(Object(n.map)((e=>{const t=Object(i.get)(e,["aggregations","times","buckets"],[]);return Object(i.each)(t,(e=>{const t=e.key;m.results[t]={prediction:Object(i.get)(e,["prediction","value"]),forecastUpper:Object(i.get)(e,["forecastUpper","value"]),forecastLower:Object(i.get)(e,["forecastLower","value"])}})),m})))},runForecast:function(e,t){return console.log("ML forecast service run forecast with duration:",t),new Promise(((a,i)=>{s.ml.forecast({jobId:e,duration:t}).then((e=>{a(e)})).catch((e=>{i(e)}))}))},getForecastRequestStats:function(e,t){return new Promise(((a,i)=>{const n={success:!0,stats:{}},r=[{query_string:{query:"result_type:model_forecast_request_stats",analyze_wildcard:!0}},{term:{job_id:e.job_id}},{term:{forecast_id:t}}];s.ml.results.anomalySearch({size:1,body:{query:{bool:{filter:r}}}},[e.job_id]).then((e=>{e.hits.total.value>0&&(n.stats=e.hits.hits[0]._source),a(n)})).catch((e=>{i(e)}))}))}}},function(e,t,a){(function(e){var i=a(177).RRule;function n(e,t){t=t||2;var a=e<0;a&&(e*=-1),e=e.toString();return(a?"-":"")+"000000000000000000".substr(0,t-e.length)+e}var s={BINARY:{format:function(e){return e.toString("base64")},parse:function(t){return new e(t,"base64")}},BOOLEAN:{format:function(e){return e?"TRUE":"FALSE"},parse:function(e){return"TRUE"==e.toUpperCase()}},"CAL-ADDRESS":{format:function(e){var t=e.toString();return 0!=t.lastIndexOf("mailto:")&&(t="mailto:"+t),t}},DATE:{format:function(e){return e instanceof Date||(e=new Date(e)),e.getFullYear()+n(e.getMonth()+1)+n(e.getDate())},parse:function(e){var t=new Date(parseInt(e.substr(0,4),10),parseInt(e.substr(4,2),10)-1,parseInt(e.substr(6,2),10),0,0,0);return t.date_only=!0,t}},"DATE-TIME":{format:function(e,t){return e instanceof Date||(e=new Date(e)),e.date_only||"DATE"===t.VALUE?r("DATE",e):e.getUTCFullYear()+n(e.getUTCMonth()+1)+n(e.getUTCDate())+"T"+r("TIME",e)},parse:function(e,t,a){if("DATE"===t.VALUE||e.length<=8)return s.DATE.parse(e);var i=t.TZID,n=[parseInt(e.substr(0,4),10),parseInt(e.substr(4,2),10),parseInt(e.substr(6,2),10),parseInt(e.substr(9,2),10),parseInt(e.substr(11,2),10),parseInt(e.substr(13,2),10)],r=e.length>15&&"Z"===e[15];if(void 0!==i){var o=a.timezone(i);if(!o)throw new Error("Unable to load TZ data for "+i);return o.fromLocalTime(n)}return n[1]-=1,r?new Date(Date.UTC.apply(null,n)):new Date(n[0],n[1],n[2],n[3],n[4],n[5])}},DURATION:{format:function(e){var t=e<0;t&&(e*=-1);var a=Math.floor(e/604800);e-=60*a*60*24*7;var i=Math.floor(e/86400);e-=60*i*60*24;var n=Math.floor(e/3600);e-=60*n*60;var s=Math.floor(e/60),r=e-=60*s,o=["P"];return t&&o.unshift("-"),a&&o.push(a+"W"),i&&o.push(i+"D"),(n||s||r)&&o.push("T"),n&&o.push(n+"H"),s&&o.push(s+"M"),r&&o.push(r+"S"),o.join("")},parse:function(e){for(var t=/(-)?P(\d+W)?(\d+D)?(?:T(\d+H)?(\d+M)?(\d+S)?)?/.exec(e).slice(1),a=[-1,604800,86400,3600,60,1],i=0,n=1;n<t.length;++n)void 0!==t[n]&&(i+=parseInt(t[n],10)*a[n]);return void 0!==t[0]&&(i*=a[0]),i}},FLOAT:{format:function(e){return e.toString()}},INTEGER:{format:function(e){return e.toString()}},PERIOD:{format:function(e){return r("DATE-TIME",e[0])+"/"+r(e[1]instanceof Date?"DATE-TIME":"DURATION",e[1])}},RECUR:{format:function(e){return(e instanceof i?e:new i(e)).toString()},parse:function(e){return i.parse(e)}},TEXT:{format:function(e){return(e||"").toString().replace(/([\\,;])/g,"\\$1").replace(/\n/g,"\\n")},parse:function(e){return e.replace(/\\([\\,;])/g,"$1").replace(/\\[nN]/g,"\n")}},TIME:{format:function(e){return e instanceof Date||(e=new Date(e)),n(e.getUTCHours())+n(e.getUTCMinutes())+n(e.getUTCSeconds())+"Z"},parse:function(e){return e.length>6&&"Z"===e[6]?new Date(Date.UTC(0,0,0,parseInt(e.substr(0,2),10),parseInt(e.substr(2,2),10),parseInt(e.substr(4,2),10))):new Date(0,0,0,parseInt(e.substr(0,2),10),parseInt(e.substr(2,2),10),parseInt(e.substr(4,2),10))}},URI:{format:function(e){return e.toString()}},"UTC-OFFSET":{format:function(e){var t=e<0;return t&&(e*=-1),(t?"-":"+")+n(e,4)}}},r=t.format_value=function(e,t,a){if(void 0===t)return"";var i=s[e||"TEXT"];if(void 0===i)throw Error("Invalid iCalendar datatype: "+e);return Array.isArray(t)&&"PERIOD"!==e||"PERIOD"===e&&t[0]&&Array.isArray(t[0])?t.map((function(e){return i.format(e,a||{})})).join(","):i.format(t,a||{})},o=t.parse_value=function(e,t,a,i,n){if(n)return t.split(",").map((function(t){return o(e,t,a,i)}));var r=s[e||"TEXT"];if(void 0===r)throw Error("Invalid iCalendar datatype: "+e);var l=(a=a||{}).VALUE&&s[a.VALUE];return l&&(r=l),r.parse?r.parse(t,a,i):t}}).call(this,a(176).Buffer)},function(e,t,a){(function(e){var i=Object.getOwnPropertyDescriptors||function(e){for(var t=Object.keys(e),a={},i=0;i<t.length;i++)a[t[i]]=Object.getOwnPropertyDescriptor(e,t[i]);return a},n=/%[sdj%]/g;t.format=function(e){if(!g(e)){for(var t=[],a=0;a<arguments.length;a++)t.push(o(arguments[a]));return t.join(" ")}a=1;for(var i=arguments,s=i.length,r=String(e).replace(n,(function(e){if("%%"===e)return"%";if(a>=s)return e;switch(e){case"%s":return String(i[a++]);case"%d":return Number(i[a++]);case"%j":try{return JSON.stringify(i[a++])}catch(e){return"[Circular]"}default:return e}})),l=i[a];a<s;l=i[++a])h(l)||!v(l)?r+=" "+l:r+=" "+o(l);return r},t.deprecate=function(a,i){if(void 0!==e&&!0===e.noDeprecation)return a;if(void 0===e)return function(){return t.deprecate(a,i).apply(this,arguments)};var n=!1;return function(){if(!n){if(e.throwDeprecation)throw new Error(i);e.traceDeprecation?console.trace(i):console.error(i),n=!0}return a.apply(this,arguments)}};var s,r={};function o(e,a){var i={seen:[],stylize:c};return arguments.length>=3&&(i.depth=arguments[2]),arguments.length>=4&&(i.colors=arguments[3]),b(a)?i.showHidden=a:a&&t._extend(i,a),j(i.showHidden)&&(i.showHidden=!1),j(i.depth)&&(i.depth=2),j(i.colors)&&(i.colors=!1),j(i.customInspect)&&(i.customInspect=!0),i.colors&&(i.stylize=l),d(i,e,i.depth)}function l(e,t){var a=o.styles[t];return a?"["+o.colors[a][0]+"m"+e+"["+o.colors[a][1]+"m":e}function c(e,t){return e}function d(e,a,i){if(e.customInspect&&a&&E(a.inspect)&&a.inspect!==t.inspect&&(!a.constructor||a.constructor.prototype!==a)){var n=a.inspect(i,e);return g(n)||(n=d(e,n,i)),n}var s=function(e,t){if(j(t))return e.stylize("undefined","undefined");if(g(t)){var a="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(a,"string")}if(f(t))return e.stylize(""+t,"number");if(b(t))return e.stylize(""+t,"boolean");if(h(t))return e.stylize("null","null")}(e,a);if(s)return s;var r=Object.keys(a),o=function(e){var t={};return e.forEach((function(e,a){t[e]=!0})),t}(r);if(e.showHidden&&(r=Object.getOwnPropertyNames(a)),O(a)&&(r.indexOf("message")>=0||r.indexOf("description")>=0))return u(a);if(0===r.length){if(E(a)){var l=a.name?": "+a.name:"";return e.stylize("[Function"+l+"]","special")}if(x(a))return e.stylize(RegExp.prototype.toString.call(a),"regexp");if(y(a))return e.stylize(Date.prototype.toString.call(a),"date");if(O(a))return u(a)}var c,v="",w=!1,_=["{","}"];(m(a)&&(w=!0,_=["[","]"]),E(a))&&(v=" [Function"+(a.name?": "+a.name:"")+"]");return x(a)&&(v=" "+RegExp.prototype.toString.call(a)),y(a)&&(v=" "+Date.prototype.toUTCString.call(a)),O(a)&&(v=" "+u(a)),0!==r.length||w&&0!=a.length?i<0?x(a)?e.stylize(RegExp.prototype.toString.call(a),"regexp"):e.stylize("[Object]","special"):(e.seen.push(a),c=w?function(e,t,a,i,n){for(var s=[],r=0,o=t.length;r<o;++r)k(t,String(r))?s.push(p(e,t,a,i,String(r),!0)):s.push("");return n.forEach((function(n){n.match(/^\d+$/)||s.push(p(e,t,a,i,n,!0))})),s}(e,a,i,o,r):r.map((function(t){return p(e,a,i,o,t,w)})),e.seen.pop(),function(e,t,a){if(e.reduce((function(e,t){return t.indexOf("\n")>=0&&0,e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60)return a[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+a[1];return a[0]+t+" "+e.join(", ")+" "+a[1]}(c,v,_)):_[0]+v+_[1]}function u(e){return"["+Error.prototype.toString.call(e)+"]"}function p(e,t,a,i,n,s){var r,o,l;if((l=Object.getOwnPropertyDescriptor(t,n)||{value:t[n]}).get?o=l.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):l.set&&(o=e.stylize("[Setter]","special")),k(i,n)||(r="["+n+"]"),o||(e.seen.indexOf(l.value)<0?(o=h(a)?d(e,l.value,null):d(e,l.value,a-1)).indexOf("\n")>-1&&(o=s?o.split("\n").map((function(e){return"  "+e})).join("\n").substr(2):"\n"+o.split("\n").map((function(e){return"   "+e})).join("\n")):o=e.stylize("[Circular]","special")),j(r)){if(s&&n.match(/^\d+$/))return o;(r=JSON.stringify(""+n)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(r=r.substr(1,r.length-2),r=e.stylize(r,"name")):(r=r.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),r=e.stylize(r,"string"))}return r+": "+o}function m(e){return Array.isArray(e)}function b(e){return"boolean"==typeof e}function h(e){return null===e}function f(e){return"number"==typeof e}function g(e){return"string"==typeof e}function j(e){return void 0===e}function x(e){return v(e)&&"[object RegExp]"===w(e)}function v(e){return"object"==typeof e&&null!==e}function y(e){return v(e)&&"[object Date]"===w(e)}function O(e){return v(e)&&("[object Error]"===w(e)||e instanceof Error)}function E(e){return"function"==typeof e}function w(e){return Object.prototype.toString.call(e)}function _(e){return e<10?"0"+e.toString(10):e.toString(10)}t.debuglog=function(a){if(j(s)&&(s=Object({IS_KIBANA_DISTRIBUTABLE:"true"}).NODE_DEBUG||""),a=a.toUpperCase(),!r[a])if(new RegExp("\\b"+a+"\\b","i").test(s)){var i=e.pid;r[a]=function(){var e=t.format.apply(t,arguments);console.error("%s %d: %s",a,i,e)}}else r[a]=function(){};return r[a]},t.inspect=o,o.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},o.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.isArray=m,t.isBoolean=b,t.isNull=h,t.isNullOrUndefined=function(e){return null==e},t.isNumber=f,t.isString=g,t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=j,t.isRegExp=x,t.isObject=v,t.isDate=y,t.isError=O,t.isFunction=E,t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=a(441);var S=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function M(){var e=new Date,t=[_(e.getHours()),_(e.getMinutes()),_(e.getSeconds())].join(":");return[e.getDate(),S[e.getMonth()],t].join(" ")}function k(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.log=function(){console.log("%s - %s",M(),t.format.apply(t,arguments))},t.inherits=a(442),t._extend=function(e,t){if(!t||!v(t))return e;for(var a=Object.keys(t),i=a.length;i--;)e[a[i]]=t[a[i]];return e};var C="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function T(e,t){if(!e){var a=new Error("Promise was rejected with a falsy value");a.reason=e,e=a}return t(e)}t.promisify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');if(C&&e[C]){var t;if("function"!=typeof(t=e[C]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(t,C,{value:t,enumerable:!1,writable:!1,configurable:!0}),t}function t(){for(var t,a,i=new Promise((function(e,i){t=e,a=i})),n=[],s=0;s<arguments.length;s++)n.push(arguments[s]);n.push((function(e,i){e?a(e):t(i)}));try{e.apply(this,n)}catch(e){a(e)}return i}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),C&&Object.defineProperty(t,C,{value:t,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(t,i(e))},t.promisify.custom=C,t.callbackify=function(t){if("function"!=typeof t)throw new TypeError('The "original" argument must be of type Function');function a(){for(var a=[],i=0;i<arguments.length;i++)a.push(arguments[i]);var n=a.pop();if("function"!=typeof n)throw new TypeError("The last argument must be of type Function");var s=this,r=function(){return n.apply(s,arguments)};t.apply(this,a).then((function(t){e.nextTick(r,null,t)}),(function(t){e.nextTick(T,t,r)}))}return Object.setPrototypeOf(a,Object.getPrototypeOf(t)),Object.defineProperties(a,i(t)),a}}).call(this,a(197))},function(e,t,a){e.exports=a(20)(894)},function(e,t,a){e.exports=a(20)(230)},,,function(e,t,a){"use strict";a.d(t,"d",(function(){return i.a})),a.d(t,"b",(function(){return c})),a.d(t,"c",(function(){return d})),a.d(t,"a",(function(){return u})),a.d(t,"e",(function(){return p})),a.d(t,"f",(function(){return b}));var i=a(153),n=a(2),s=a(24),r=a(67),o=a(75),l=a(94);const c=async(e,t,a)=>{try{Object(l.f)(t.state)&&await r.ml.dataFrameAnalytics.stopDataFrameAnalytics(e.id,!0),await r.ml.dataFrameAnalytics.deleteDataFrameAnalytics(e.id),a.displaySuccessToast(n.i18n.translate("xpack.ml.dataframe.analyticsList.deleteAnalyticsSuccessMessage",{defaultMessage:"Request to delete data frame analytics job {analyticsId} acknowledged.",values:{analyticsId:e.id}}))}catch(t){a.displayErrorToast(t,n.i18n.translate("xpack.ml.dataframe.analyticsList.deleteAnalyticsErrorMessage",{defaultMessage:"An error occurred deleting the data frame analytics job {analyticsId}",values:{analyticsId:e.id}}))}o.u.next(o.e.REFRESH)},d=async(e,t,a,i,c)=>{const d=Array.isArray(e.dest.index)?e.dest.index[0]:e.dest.index;try{var u,p,m,b,h,f;Object(l.f)(t.state)&&await r.ml.dataFrameAnalytics.stopDataFrameAnalytics(e.id,!0);const o=await r.ml.dataFrameAnalytics.deleteDataFrameAnalyticsAndDestIndex(e.id,a,i);if(null!==(u=o.analyticsJobDeleted)&&void 0!==u&&u.success&&c.displaySuccessToast(n.i18n.translate("xpack.ml.dataframe.analyticsList.deleteAnalyticsSuccessMessage",{defaultMessage:"Request to delete data frame analytics job {analyticsId} acknowledged.",values:{analyticsId:e.id}})),null!==(p=o.analyticsJobDeleted)&&void 0!==p&&p.error&&c.displayErrorToast(o.analyticsJobDeleted.error,n.i18n.translate("xpack.ml.dataframe.analyticsList.deleteAnalyticsErrorMessage",{defaultMessage:"An error occurred deleting the data frame analytics job {analyticsId}",values:{analyticsId:e.id}})),null!==(m=o.destIndexDeleted)&&void 0!==m&&m.success&&c.displaySuccessToast(n.i18n.translate("xpack.ml.dataframe.analyticsList.deleteAnalyticsWithIndexSuccessMessage",{defaultMessage:"Request to delete destination index {destinationIndex} acknowledged.",values:{destinationIndex:d}})),null!==(b=o.destIndexDeleted)&&void 0!==b&&b.error&&c.displayErrorToast(o.destIndexDeleted.error,n.i18n.translate("xpack.ml.dataframe.analyticsList.deleteAnalyticsWithIndexErrorMessage",{defaultMessage:"An error occurred deleting destination index {destinationIndex}",values:{destinationIndex:d}})),null!==(h=o.destIndexPatternDeleted)&&void 0!==h&&h.success&&c.displaySuccessToast(n.i18n.translate("xpack.ml.dataframe.analyticsList.deleteAnalyticsWithIndexPatternSuccessMessage",{defaultMessage:"Request to delete index pattern {destinationIndex} acknowledged.",values:{destinationIndex:d}})),null!==(f=o.destIndexPatternDeleted)&&void 0!==f&&f.error){const e=Object(s.b)(o.destIndexPatternDeleted.error);c.displayDangerToast(n.i18n.translate("xpack.ml.dataframe.analyticsList.deleteAnalyticsWithIndexPatternErrorMessage",{defaultMessage:"An error occurred deleting index pattern {destinationIndex}: {error}",values:{destinationIndex:d,error:e}}))}}catch(t){c.displayErrorToast(t,n.i18n.translate("xpack.ml.dataframe.analyticsList.deleteAnalyticsErrorMessage",{defaultMessage:"An error occurred deleting the data frame analytics job {analyticsId}",values:{analyticsId:e.id}}))}o.u.next(o.e.REFRESH)},u=async(e,t)=>{try{const t=await r.ml.hasPrivileges({index:[{names:[e],privileges:["delete_index"]}]});return!!t&&(!0===t.securityDisabled||!0===t.has_all_requested)}catch(a){const i=Object(s.b)(a);t.displayDangerToast(n.i18n.translate("xpack.ml.dataframe.analyticsList.deleteAnalyticsPrivilegeErrorMessage",{defaultMessage:"User does not have permission to delete index {indexName}: {error}",values:{indexName:e,error:i}}))}},p=async(e,t)=>{try{await r.ml.dataFrameAnalytics.startDataFrameAnalytics(e.config.id),t.displaySuccessToast(n.i18n.translate("xpack.ml.dataframe.analyticsList.startAnalyticsSuccessMessage",{defaultMessage:"Request to start data frame analytics {analyticsId} acknowledged.",values:{analyticsId:e.config.id}}))}catch(e){t.displayErrorToast(e,n.i18n.translate("xpack.ml.dataframe.analyticsList.startAnalyticsErrorTitle",{defaultMessage:"Error starting job"}))}o.u.next(o.e.REFRESH)};var m=a(22);const b=async e=>{const t=Object(m.k)();try{await r.ml.dataFrameAnalytics.stopDataFrameAnalytics(e.config.id,Object(l.f)(e.stats.state)),t.addSuccess(n.i18n.translate("xpack.ml.dataframe.analyticsList.stopAnalyticsSuccessMessage",{defaultMessage:"Request to stop data frame analytics {analyticsId} acknowledged.",values:{analyticsId:e.config.id}}))}catch(a){t.addDanger(n.i18n.translate("xpack.ml.dataframe.analyticsList.stopAnalyticsErrorMessage",{defaultMessage:"An error occurred stopping the data frame analytics {analyticsId}: {error}",values:{analyticsId:e.config.id,error:JSON.stringify(a)}}))}o.u.next(o.e.REFRESH)}},function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));a(15);var i=a(11);const n=({stat:e})=>Object(i.jsx)("span",{className:"stat"},Object(i.jsx)("span",null,e.label),": ",Object(i.jsx)("strong",null,e.value)),s=({stats:e,dataTestSub:t})=>{const a=Object.keys(e).map((t=>e[t]));return Object(i.jsx)("div",{className:"mlStatsBar","data-test-subj":t},a.filter((e=>e.show)).map((e=>Object(i.jsx)(n,{key:e.label,stat:e}))))}},,,,,,function(e,t,a){"use strict";a.d(t,"b",(function(){return s})),a.d(t,"c",(function(){return r}));var i=a(59),n=a(209);a.d(t,"a",(function(){return n.XJsonMode}));const{collapseLiteralStrings:s,expandLiteralStrings:r}=i.XJson},function(e,t,a){e.exports=a(20)(1270)},,function(e,t,a){"use strict";let i;a.d(t,"d",(function(){return i})),a.d(t,"c",(function(){return n})),a.d(t,"b",(function(){return s})),a.d(t,"a",(function(){return r})),function(e){e.ANNOTATION="annotation",e.COMMENT="comment"}(i||(i={}));const n=1e3,s="user",r="delayed_data"},function(e,t,a){"use strict";a.d(t,"a",(function(){return r})),a.d(t,"b",(function(){return l}));var i=a(112),n=a(28),s=a(86);function r(e,t,a){const r=function(e){return e.filter((e=>e.type===n.ES_FIELD_TYPES.KEYWORD))}(e),l=function(e){return e.filter((e=>e.type===n.ES_FIELD_TYPES.TEXT))}(e),c=function(e){return e.filter((e=>e.type===n.ES_FIELD_TYPES.LONG||e.type===n.ES_FIELD_TYPES.UNSIGNED_LONG||e.type===n.ES_FIELD_TYPES.INTEGER||e.type===n.ES_FIELD_TYPES.SHORT||e.type===n.ES_FIELD_TYPES.BYTE||e.type===n.ES_FIELD_TYPES.DOUBLE||e.type===n.ES_FIELD_TYPES.FLOAT||e.type===n.ES_FIELD_TYPES.HALF_FLOAT||e.type===n.ES_FIELD_TYPES.SCALED_FLOAT))}(e),d=function(e){return e.filter((e=>e.type===n.ES_FIELD_TYPES.IP))}(e),u=function(e){return e.filter((e=>e.type===n.ES_FIELD_TYPES.GEO_POINT||e.type===n.ES_FIELD_TYPES.GEO_SHAPE))}(e),p=Object.keys(a).length>0,m=function(e,t){return function(a,i){(!1===e||t[a.id]&&t[a.id].find((e=>e.agg===i.dslName)))&&(void 0!==a.aggs&&a.aggs.push(i),void 0!==i.fields&&i.fields.push(a))}}(p,a);return t.forEach((e=>{if(e.type===i.b&&void 0!==e.fields)switch(e.id){case s.b.LAT_LONG:u.forEach((t=>m(t,e)));break;case s.b.INFO_CONTENT:case s.b.HIGH_INFO_CONTENT:case s.b.LOW_INFO_CONTENT:l.forEach((t=>m(t,e)));case s.b.DISTINCT_COUNT:case s.b.HIGH_DISTINCT_COUNT:case s.b.LOW_DISTINCT_COUNT:r.forEach((t=>m(t,e))),d.forEach((t=>m(t,e)));default:c.forEach((t=>{m(t,e)}))}})),{aggs:t,fields:p?o(e):e}}function o(e){return e.filter((e=>e.aggs&&(e.aggs.length>0||0===e.aggs.length&&e.type===n.ES_FIELD_TYPES.DATE)))}function l(e){if(0===e.length)return e;let t;return e[0].id===i.a&&([t]=e.splice(0,1)),e.sort(((e,t)=>e.name.localeCompare(t.name))),void 0!==t&&e.splice(0,0,t),e}},function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));const i="_all"},function(e,t,a){"use strict";(function(e){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
var i=a(438),n=a(439),s=a(440);function r(){return l.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function o(e,t){if(r()<t)throw new RangeError("Invalid typed array length");return l.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=l.prototype:(null===e&&(e=new l(t)),e.length=t),e}function l(e,t,a){if(!(l.TYPED_ARRAY_SUPPORT||this instanceof l))return new l(e,t,a);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return u(this,e)}return c(this,e,t,a)}function c(e,t,a,i){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,a,i){if(t.byteLength,a<0||t.byteLength<a)throw new RangeError("'offset' is out of bounds");if(t.byteLength<a+(i||0))throw new RangeError("'length' is out of bounds");t=void 0===a&&void 0===i?new Uint8Array(t):void 0===i?new Uint8Array(t,a):new Uint8Array(t,a,i);l.TYPED_ARRAY_SUPPORT?(e=t).__proto__=l.prototype:e=p(e,t);return e}(e,t,a,i):"string"==typeof t?function(e,t,a){"string"==typeof a&&""!==a||(a="utf8");if(!l.isEncoding(a))throw new TypeError('"encoding" must be a valid string encoding');var i=0|b(t,a),n=(e=o(e,i)).write(t,a);n!==i&&(e=e.slice(0,n));return e}(e,t,a):function(e,t){if(l.isBuffer(t)){var a=0|m(t.length);return 0===(e=o(e,a)).length||t.copy(e,0,0,a),e}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(i=t.length)!=i?o(e,0):p(e,t);if("Buffer"===t.type&&s(t.data))return p(e,t.data)}var i;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function d(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function u(e,t){if(d(t),e=o(e,t<0?0:0|m(t)),!l.TYPED_ARRAY_SUPPORT)for(var a=0;a<t;++a)e[a]=0;return e}function p(e,t){var a=t.length<0?0:0|m(t.length);e=o(e,a);for(var i=0;i<a;i+=1)e[i]=255&t[i];return e}function m(e){if(e>=r())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+r().toString(16)+" bytes");return 0|e}function b(e,t){if(l.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var a=e.length;if(0===a)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return a;case"utf8":case"utf-8":case void 0:return J(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*a;case"hex":return a>>>1;case"base64":return V(e).length;default:if(i)return J(e).length;t=(""+t).toLowerCase(),i=!0}}function h(e,t,a){var i=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===a||a>this.length)&&(a=this.length),a<=0)return"";if((a>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return T(this,t,a);case"utf8":case"utf-8":return S(this,t,a);case"ascii":return k(this,t,a);case"latin1":case"binary":return C(this,t,a);case"base64":return _(this,t,a);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return F(this,t,a);default:if(i)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),i=!0}}function f(e,t,a){var i=e[t];e[t]=e[a],e[a]=i}function g(e,t,a,i,n){if(0===e.length)return-1;if("string"==typeof a?(i=a,a=0):a>2147483647?a=2147483647:a<-2147483648&&(a=-2147483648),a=+a,isNaN(a)&&(a=n?0:e.length-1),a<0&&(a=e.length+a),a>=e.length){if(n)return-1;a=e.length-1}else if(a<0){if(!n)return-1;a=0}if("string"==typeof t&&(t=l.from(t,i)),l.isBuffer(t))return 0===t.length?-1:j(e,t,a,i,n);if("number"==typeof t)return t&=255,l.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?n?Uint8Array.prototype.indexOf.call(e,t,a):Uint8Array.prototype.lastIndexOf.call(e,t,a):j(e,[t],a,i,n);throw new TypeError("val must be string, number or Buffer")}function j(e,t,a,i,n){var s,r=1,o=e.length,l=t.length;if(void 0!==i&&("ucs2"===(i=String(i).toLowerCase())||"ucs-2"===i||"utf16le"===i||"utf-16le"===i)){if(e.length<2||t.length<2)return-1;r=2,o/=2,l/=2,a/=2}function c(e,t){return 1===r?e[t]:e.readUInt16BE(t*r)}if(n){var d=-1;for(s=a;s<o;s++)if(c(e,s)===c(t,-1===d?0:s-d)){if(-1===d&&(d=s),s-d+1===l)return d*r}else-1!==d&&(s-=s-d),d=-1}else for(a+l>o&&(a=o-l),s=a;s>=0;s--){for(var u=!0,p=0;p<l;p++)if(c(e,s+p)!==c(t,p)){u=!1;break}if(u)return s}return-1}function x(e,t,a,i){a=Number(a)||0;var n=e.length-a;i?(i=Number(i))>n&&(i=n):i=n;var s=t.length;if(s%2!=0)throw new TypeError("Invalid hex string");i>s/2&&(i=s/2);for(var r=0;r<i;++r){var o=parseInt(t.substr(2*r,2),16);if(isNaN(o))return r;e[a+r]=o}return r}function v(e,t,a,i){return U(J(t,e.length-a),e,a,i)}function y(e,t,a,i){return U(function(e){for(var t=[],a=0;a<e.length;++a)t.push(255&e.charCodeAt(a));return t}(t),e,a,i)}function O(e,t,a,i){return y(e,t,a,i)}function E(e,t,a,i){return U(V(t),e,a,i)}function w(e,t,a,i){return U(function(e,t){for(var a,i,n,s=[],r=0;r<e.length&&!((t-=2)<0);++r)i=(a=e.charCodeAt(r))>>8,n=a%256,s.push(n),s.push(i);return s}(t,e.length-a),e,a,i)}function _(e,t,a){return 0===t&&a===e.length?i.fromByteArray(e):i.fromByteArray(e.slice(t,a))}function S(e,t,a){a=Math.min(e.length,a);for(var i=[],n=t;n<a;){var s,r,o,l,c=e[n],d=null,u=c>239?4:c>223?3:c>191?2:1;if(n+u<=a)switch(u){case 1:c<128&&(d=c);break;case 2:128==(192&(s=e[n+1]))&&(l=(31&c)<<6|63&s)>127&&(d=l);break;case 3:s=e[n+1],r=e[n+2],128==(192&s)&&128==(192&r)&&(l=(15&c)<<12|(63&s)<<6|63&r)>2047&&(l<55296||l>57343)&&(d=l);break;case 4:s=e[n+1],r=e[n+2],o=e[n+3],128==(192&s)&&128==(192&r)&&128==(192&o)&&(l=(15&c)<<18|(63&s)<<12|(63&r)<<6|63&o)>65535&&l<1114112&&(d=l)}null===d?(d=65533,u=1):d>65535&&(d-=65536,i.push(d>>>10&1023|55296),d=56320|1023&d),i.push(d),n+=u}return function(e){var t=e.length;if(t<=M)return String.fromCharCode.apply(String,e);var a="",i=0;for(;i<t;)a+=String.fromCharCode.apply(String,e.slice(i,i+=M));return a}(i)}t.Buffer=l,t.SlowBuffer=function(e){+e!=e&&(e=0);return l.alloc(+e)},t.INSPECT_MAX_BYTES=50,l.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=r(),l.poolSize=8192,l._augment=function(e){return e.__proto__=l.prototype,e},l.from=function(e,t,a){return c(null,e,t,a)},l.TYPED_ARRAY_SUPPORT&&(l.prototype.__proto__=Uint8Array.prototype,l.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&l[Symbol.species]===l&&Object.defineProperty(l,Symbol.species,{value:null,configurable:!0})),l.alloc=function(e,t,a){return function(e,t,a,i){return d(t),t<=0?o(e,t):void 0!==a?"string"==typeof i?o(e,t).fill(a,i):o(e,t).fill(a):o(e,t)}(null,e,t,a)},l.allocUnsafe=function(e){return u(null,e)},l.allocUnsafeSlow=function(e){return u(null,e)},l.isBuffer=function(e){return!(null==e||!e._isBuffer)},l.compare=function(e,t){if(!l.isBuffer(e)||!l.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var a=e.length,i=t.length,n=0,s=Math.min(a,i);n<s;++n)if(e[n]!==t[n]){a=e[n],i=t[n];break}return a<i?-1:i<a?1:0},l.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(e,t){if(!s(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return l.alloc(0);var a;if(void 0===t)for(t=0,a=0;a<e.length;++a)t+=e[a].length;var i=l.allocUnsafe(t),n=0;for(a=0;a<e.length;++a){var r=e[a];if(!l.isBuffer(r))throw new TypeError('"list" argument must be an Array of Buffers');r.copy(i,n),n+=r.length}return i},l.byteLength=b,l.prototype._isBuffer=!0,l.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)f(this,t,t+1);return this},l.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)f(this,t,t+3),f(this,t+1,t+2);return this},l.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)f(this,t,t+7),f(this,t+1,t+6),f(this,t+2,t+5),f(this,t+3,t+4);return this},l.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?S(this,0,e):h.apply(this,arguments)},l.prototype.equals=function(e){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===l.compare(this,e)},l.prototype.inspect=function(){var e="",a=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,a).match(/.{2}/g).join(" "),this.length>a&&(e+=" ... ")),"<Buffer "+e+">"},l.prototype.compare=function(e,t,a,i,n){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===a&&(a=e?e.length:0),void 0===i&&(i=0),void 0===n&&(n=this.length),t<0||a>e.length||i<0||n>this.length)throw new RangeError("out of range index");if(i>=n&&t>=a)return 0;if(i>=n)return-1;if(t>=a)return 1;if(this===e)return 0;for(var s=(n>>>=0)-(i>>>=0),r=(a>>>=0)-(t>>>=0),o=Math.min(s,r),c=this.slice(i,n),d=e.slice(t,a),u=0;u<o;++u)if(c[u]!==d[u]){s=c[u],r=d[u];break}return s<r?-1:r<s?1:0},l.prototype.includes=function(e,t,a){return-1!==this.indexOf(e,t,a)},l.prototype.indexOf=function(e,t,a){return g(this,e,t,a,!0)},l.prototype.lastIndexOf=function(e,t,a){return g(this,e,t,a,!1)},l.prototype.write=function(e,t,a,i){if(void 0===t)i="utf8",a=this.length,t=0;else if(void 0===a&&"string"==typeof t)i=t,a=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(a)?(a|=0,void 0===i&&(i="utf8")):(i=a,a=void 0)}var n=this.length-t;if((void 0===a||a>n)&&(a=n),e.length>0&&(a<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");for(var s=!1;;)switch(i){case"hex":return x(this,e,t,a);case"utf8":case"utf-8":return v(this,e,t,a);case"ascii":return y(this,e,t,a);case"latin1":case"binary":return O(this,e,t,a);case"base64":return E(this,e,t,a);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return w(this,e,t,a);default:if(s)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),s=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var M=4096;function k(e,t,a){var i="";a=Math.min(e.length,a);for(var n=t;n<a;++n)i+=String.fromCharCode(127&e[n]);return i}function C(e,t,a){var i="";a=Math.min(e.length,a);for(var n=t;n<a;++n)i+=String.fromCharCode(e[n]);return i}function T(e,t,a){var i=e.length;(!t||t<0)&&(t=0),(!a||a<0||a>i)&&(a=i);for(var n="",s=t;s<a;++s)n+=B(e[s]);return n}function F(e,t,a){for(var i=e.slice(t,a),n="",s=0;s<i.length;s+=2)n+=String.fromCharCode(i[s]+256*i[s+1]);return n}function I(e,t,a){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>a)throw new RangeError("Trying to access beyond buffer length")}function D(e,t,a,i,n,s){if(!l.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>n||t<s)throw new RangeError('"value" argument is out of bounds');if(a+i>e.length)throw new RangeError("Index out of range")}function A(e,t,a,i){t<0&&(t=65535+t+1);for(var n=0,s=Math.min(e.length-a,2);n<s;++n)e[a+n]=(t&255<<8*(i?n:1-n))>>>8*(i?n:1-n)}function L(e,t,a,i){t<0&&(t=4294967295+t+1);for(var n=0,s=Math.min(e.length-a,4);n<s;++n)e[a+n]=t>>>8*(i?n:3-n)&255}function R(e,t,a,i,n,s){if(a+i>e.length)throw new RangeError("Index out of range");if(a<0)throw new RangeError("Index out of range")}function P(e,t,a,i,s){return s||R(e,0,a,4),n.write(e,t,a,i,23,4),a+4}function N(e,t,a,i,s){return s||R(e,0,a,8),n.write(e,t,a,i,52,8),a+8}l.prototype.slice=function(e,t){var a,i=this.length;if((e=~~e)<0?(e+=i)<0&&(e=0):e>i&&(e=i),(t=void 0===t?i:~~t)<0?(t+=i)<0&&(t=0):t>i&&(t=i),t<e&&(t=e),l.TYPED_ARRAY_SUPPORT)(a=this.subarray(e,t)).__proto__=l.prototype;else{var n=t-e;a=new l(n,void 0);for(var s=0;s<n;++s)a[s]=this[s+e]}return a},l.prototype.readUIntLE=function(e,t,a){e|=0,t|=0,a||I(e,t,this.length);for(var i=this[e],n=1,s=0;++s<t&&(n*=256);)i+=this[e+s]*n;return i},l.prototype.readUIntBE=function(e,t,a){e|=0,t|=0,a||I(e,t,this.length);for(var i=this[e+--t],n=1;t>0&&(n*=256);)i+=this[e+--t]*n;return i},l.prototype.readUInt8=function(e,t){return t||I(e,1,this.length),this[e]},l.prototype.readUInt16LE=function(e,t){return t||I(e,2,this.length),this[e]|this[e+1]<<8},l.prototype.readUInt16BE=function(e,t){return t||I(e,2,this.length),this[e]<<8|this[e+1]},l.prototype.readUInt32LE=function(e,t){return t||I(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},l.prototype.readUInt32BE=function(e,t){return t||I(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},l.prototype.readIntLE=function(e,t,a){e|=0,t|=0,a||I(e,t,this.length);for(var i=this[e],n=1,s=0;++s<t&&(n*=256);)i+=this[e+s]*n;return i>=(n*=128)&&(i-=Math.pow(2,8*t)),i},l.prototype.readIntBE=function(e,t,a){e|=0,t|=0,a||I(e,t,this.length);for(var i=t,n=1,s=this[e+--i];i>0&&(n*=256);)s+=this[e+--i]*n;return s>=(n*=128)&&(s-=Math.pow(2,8*t)),s},l.prototype.readInt8=function(e,t){return t||I(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},l.prototype.readInt16LE=function(e,t){t||I(e,2,this.length);var a=this[e]|this[e+1]<<8;return 32768&a?4294901760|a:a},l.prototype.readInt16BE=function(e,t){t||I(e,2,this.length);var a=this[e+1]|this[e]<<8;return 32768&a?4294901760|a:a},l.prototype.readInt32LE=function(e,t){return t||I(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},l.prototype.readInt32BE=function(e,t){return t||I(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},l.prototype.readFloatLE=function(e,t){return t||I(e,4,this.length),n.read(this,e,!0,23,4)},l.prototype.readFloatBE=function(e,t){return t||I(e,4,this.length),n.read(this,e,!1,23,4)},l.prototype.readDoubleLE=function(e,t){return t||I(e,8,this.length),n.read(this,e,!0,52,8)},l.prototype.readDoubleBE=function(e,t){return t||I(e,8,this.length),n.read(this,e,!1,52,8)},l.prototype.writeUIntLE=function(e,t,a,i){(e=+e,t|=0,a|=0,i)||D(this,e,t,a,Math.pow(2,8*a)-1,0);var n=1,s=0;for(this[t]=255&e;++s<a&&(n*=256);)this[t+s]=e/n&255;return t+a},l.prototype.writeUIntBE=function(e,t,a,i){(e=+e,t|=0,a|=0,i)||D(this,e,t,a,Math.pow(2,8*a)-1,0);var n=a-1,s=1;for(this[t+n]=255&e;--n>=0&&(s*=256);)this[t+n]=e/s&255;return t+a},l.prototype.writeUInt8=function(e,t,a){return e=+e,t|=0,a||D(this,e,t,1,255,0),l.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},l.prototype.writeUInt16LE=function(e,t,a){return e=+e,t|=0,a||D(this,e,t,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):A(this,e,t,!0),t+2},l.prototype.writeUInt16BE=function(e,t,a){return e=+e,t|=0,a||D(this,e,t,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):A(this,e,t,!1),t+2},l.prototype.writeUInt32LE=function(e,t,a){return e=+e,t|=0,a||D(this,e,t,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):L(this,e,t,!0),t+4},l.prototype.writeUInt32BE=function(e,t,a){return e=+e,t|=0,a||D(this,e,t,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):L(this,e,t,!1),t+4},l.prototype.writeIntLE=function(e,t,a,i){if(e=+e,t|=0,!i){var n=Math.pow(2,8*a-1);D(this,e,t,a,n-1,-n)}var s=0,r=1,o=0;for(this[t]=255&e;++s<a&&(r*=256);)e<0&&0===o&&0!==this[t+s-1]&&(o=1),this[t+s]=(e/r>>0)-o&255;return t+a},l.prototype.writeIntBE=function(e,t,a,i){if(e=+e,t|=0,!i){var n=Math.pow(2,8*a-1);D(this,e,t,a,n-1,-n)}var s=a-1,r=1,o=0;for(this[t+s]=255&e;--s>=0&&(r*=256);)e<0&&0===o&&0!==this[t+s+1]&&(o=1),this[t+s]=(e/r>>0)-o&255;return t+a},l.prototype.writeInt8=function(e,t,a){return e=+e,t|=0,a||D(this,e,t,1,127,-128),l.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},l.prototype.writeInt16LE=function(e,t,a){return e=+e,t|=0,a||D(this,e,t,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):A(this,e,t,!0),t+2},l.prototype.writeInt16BE=function(e,t,a){return e=+e,t|=0,a||D(this,e,t,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):A(this,e,t,!1),t+2},l.prototype.writeInt32LE=function(e,t,a){return e=+e,t|=0,a||D(this,e,t,4,2147483647,-2147483648),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):L(this,e,t,!0),t+4},l.prototype.writeInt32BE=function(e,t,a){return e=+e,t|=0,a||D(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):L(this,e,t,!1),t+4},l.prototype.writeFloatLE=function(e,t,a){return P(this,e,t,!0,a)},l.prototype.writeFloatBE=function(e,t,a){return P(this,e,t,!1,a)},l.prototype.writeDoubleLE=function(e,t,a){return N(this,e,t,!0,a)},l.prototype.writeDoubleBE=function(e,t,a){return N(this,e,t,!1,a)},l.prototype.copy=function(e,t,a,i){if(a||(a=0),i||0===i||(i=this.length),t>=e.length&&(t=e.length),t||(t=0),i>0&&i<a&&(i=a),i===a)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(a<0||a>=this.length)throw new RangeError("sourceStart out of bounds");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-t<i-a&&(i=e.length-t+a);var n,s=i-a;if(this===e&&a<t&&t<i)for(n=s-1;n>=0;--n)e[n+t]=this[n+a];else if(s<1e3||!l.TYPED_ARRAY_SUPPORT)for(n=0;n<s;++n)e[n+t]=this[n+a];else Uint8Array.prototype.set.call(e,this.subarray(a,a+s),t);return s},l.prototype.fill=function(e,t,a,i){if("string"==typeof e){if("string"==typeof t?(i=t,t=0,a=this.length):"string"==typeof a&&(i=a,a=this.length),1===e.length){var n=e.charCodeAt(0);n<256&&(e=n)}if(void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!l.isEncoding(i))throw new TypeError("Unknown encoding: "+i)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<a)throw new RangeError("Out of range index");if(a<=t)return this;var s;if(t>>>=0,a=void 0===a?this.length:a>>>0,e||(e=0),"number"==typeof e)for(s=t;s<a;++s)this[s]=e;else{var r=l.isBuffer(e)?e:J(new l(e,i).toString()),o=r.length;for(s=0;s<a-t;++s)this[s+t]=r[s%o]}return this};var z=/[^+\/0-9A-Za-z-_]/g;function B(e){return e<16?"0"+e.toString(16):e.toString(16)}function J(e,t){var a;t=t||1/0;for(var i=e.length,n=null,s=[],r=0;r<i;++r){if((a=e.charCodeAt(r))>55295&&a<57344){if(!n){if(a>56319){(t-=3)>-1&&s.push(239,191,189);continue}if(r+1===i){(t-=3)>-1&&s.push(239,191,189);continue}n=a;continue}if(a<56320){(t-=3)>-1&&s.push(239,191,189),n=a;continue}a=65536+(n-55296<<10|a-56320)}else n&&(t-=3)>-1&&s.push(239,191,189);if(n=null,a<128){if((t-=1)<0)break;s.push(a)}else if(a<2048){if((t-=2)<0)break;s.push(a>>6|192,63&a|128)}else if(a<65536){if((t-=3)<0)break;s.push(a>>12|224,a>>6&63|128,63&a|128)}else{if(!(a<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;s.push(a>>18|240,a>>12&63|128,a>>6&63|128,63&a|128)}}return s}function V(e){return i.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(z,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function U(e,t,a,i){for(var n=0;n<i&&!(n+a>=t.length||n>=e.length);++n)t[n+a]=e[n];return n}}).call(this,a(121))},function(e,t,a){var i=a(157),n=["FREQ","INTERVAL","COUNT","UNTIL","BYDAY","BYMONTH","BYMONTHDAY"],s=["SU","MO","TU","WE","TH","FR","SA"];function r(e){return Array.isArray(e)?(e=e.slice(0))[1]--:e=[e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()],new Date(Date.UTC.apply(null,e))}function o(e){return new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds())}function l(e){return e<0?Math.ceil(e):Math.floor(e)}function c(e){return e.getUTCFullYear()}function d(e){return e.getUTCMonth()+1}function u(e){return e.getUTCDate()}function p(e){return e.getUTCHours()}function m(e){return e.getUTCMinutes()}function b(e){return e.getUTCSeconds()}function h(e){return e.getUTCMilliseconds()}function f(e,t){return e.setUTCMonth(t-1),e}function g(e,t){return e.setUTCDate(t),e}function j(e,t){return e.setUTCHours(t),e}function x(e,t){return e.setUTCMinutes(t),e}function v(e,t){return e.setUTCSeconds(t),e}function y(e,t){return e.setUTCMilliseconds(t),e}function O(e,t){return function(e,t){return e.setUTCFullYear(t),e}(e,c(e)+t)}function E(e,t){return f(e,d(e)+t)}function w(e,t){return g(e,u(e)+t)}function _(e){return e.getUTCDay()}function S(e,t){return(t-e)/864e5}var M=t.RRule=function(e,t,a){for(var i in t instanceof Date&&(t={DTSTART:t,DTEND:a}),t=t||{},this.start=t.DTSTART?r(t.DTSTART):null,this.end=t.DTEND?r(t.DTEND):null,this.exceptions=t.EXDATE||[],"string"==typeof e&&(e=M.parse(e)),this.rule={},e||{}){if(-1==n.indexOf(i))throw new Error(i+" is not currently supported!");this.rule[i]=k[i]?k[i].parse(e[i]):e[i]}};M.parse=function(e){for(var t=e.split(/=|;/),a={},i=0;i<t.length;i+=2)a[t[i]]=t[i+1];return a},M.prototype.setFrequency=function(e){this.rule.FREQ=e},M.prototype.valueOf=function(){return this.rule},M.prototype.toString=function(){var e=["FREQ="+this.rule.FREQ];for(var t in this.rule)"FREQ"!=t&&e.push(t+"="+((k[t]||{}).format?k[t].format(this.rule[t]):this.rule[t]));return e.join(";")},M.prototype.next=function(e){if((!(e=e&&r(e))||e<this.start)&&(e=new Date(this.start.valueOf()-1)),this.until&&e>this.until)return null;var t=C[this.rule.FREQ];if(!t)throw new Error(this.rule.FREQ+" recurrence is not supported");e:for(;;){for(var a=t.next(this.rule,this.start,e),i=o(a),n=0;n<this.exceptions.length;n++){var s=this.exceptions[n];if(s.valueOf()==i.valueOf()||s.date_only&&c(r(s))==c(i)&&d(r(s))==d(i)&&u(r(s))==u(i)){e=a;continue e}}break}return this.until&&a>this.until||this.rule.COUNT&&null!==this.count_end&&(void 0===this.count_end&&(this.count_end=null,this.count_end=this.nextOccurences(this.rule.COUNT).pop()),a>r(this.count_end))||this.rule.UNTIL&&a>r(this.rule.UNTIL)?null:o(a)},M.prototype.nextOccurences=function(e,t){1===arguments.length&&(t=e,e=void 0);var a=[];if(t instanceof Date)for(;(e=this.next(e))&&e<=t;)a.push(e);else for(;t--&&null!==e;)(e=this.next(e))&&a.push(e);return a};var k={INTERVAL:{parse:function(e){return parseInt(e,10)}},UNTIL:{parse:function(e){return e instanceof Date?e:i.parse_value("DATE-TIME",e)},format:function(e){return i.format_value("DATE-TIME",e)}},FREQ:{parse:function(e){return e}},BYMONTH:{parse:function(e){return"number"==typeof e?[e]:e.split(",").map((function(e){return parseInt(e,10)}))},format:function(e){return e.join(",")}},BYDAY:{parse:function(e){var t=e.split(",").map((function(e){var t=e.match(/([+-]?\d)?(SU|MO|TU|WE|TH|FR|SA)/);return[parseInt(t[1],10)||0,s.indexOf(t[2])]}));return t.sort((function(e,t){return e[0]==t[0]?e[1]-t[1]:e[0]-t[0]})),t},format:function(e){return e.map((function(e){return(e[0]||"")+s[e[1]]})).join(",")}},EXDATE:{parse:function(e){return e.split(",").map((function(e){return 8==e.length?i.parse_value("DATE",e):i.parse_value("DATE-TIME",e)}))},format:function(e){return e.map((function(e){return i.format_value(e.date_only?"DATE":"DATE-TIME",e)})).join(",")}}};k.BYMONTHDAY=k.BYMONTH,k.COUNT=k.INTERVAL;var C={DAILY:{next:function(e,t,a){var i=new Date(a);j(i,p(t)),x(i,m(t)),v(i,b(t)),y(i,h(t));var n=e.INTERVAL||1,s=l(S(i,t))%n;s&&w(i,n-s);for(var r=0;r<2&&!((i=A(e.BYDAY,i,a)).valueOf()>a.valueOf());++r)w(i,n);return i}},WEEKLY:{next:function(e,t,a){var i=new Date(a);j(i,p(t)),x(i,m(t)),v(i,b(t)),y(i,h(t));var n=e.INTERVAL||1,s=l(S(t,i)/7)%n;for(s&&w(i,7*(n-s));i=A(e.BYDAY,i,a),e.BYDAY&&e.BYDAY.length||(startDayOfWeek=_(t),nextDayOfWeek=_(i),nextDayOfWeek>startDayOfWeek?w(i,startDayOfWeek-nextDayOfWeek):startDayOfWeek>nextDayOfWeek&&w(i,startDayOfWeek-nextDayOfWeek-7)),!(i.valueOf()>a.valueOf()&&F(e.BYMONTH,i));)w(i,7*n);return i}},MONTHLY:{next:function(e,t,a){var i=new Date(a);j(i,p(t)),x(i,m(t)),v(i,b(t)),y(i,h(t));var n=e.INTERVAL||1,s=d(i)-d(t)+12*(c(i)-c(t));s%n&&E(i,n-s%n);for(var r=0;r<2&&(r&&g(i,1),i=A(e.BYDAY,i,a),i=D(e.BYMONTHDAY,i,a),e.BYDAY&&e.BYDAY.length||e.BYMONTHDAY&&e.BYMONTHDAY.length||g(i,u(t)),!(i.valueOf()>a.valueOf()));++r)E(i,n);return i}},YEARLY:{next:function(e,t,a){var i=new Date(a);j(i,p(t)),x(i,m(t)),v(i,b(t)),y(i,h(t));var n=e.INTERVAL||1,s=(c(a)-c(t))%n;s&&O(i,n-s);for(var r=0;r<2&&(i=I(e.BYMONTH,i),i=D(e.BYMONTHDAY,i,a),i=A(e.BYDAY,i,a),e.BYMONTH&&e.BYMONTH.length||f(i,d(t)),e.BYDAY&&e.BYDAY.length||e.BYMONTHDAY&&e.BYMONTHDAY.length||g(i,u(t)),!(i.valueOf()>a.valueOf()));++r)g(f(O(i,n),1),1);return i}}};function T(e){return e.sort((function(e,t){return null===e&&null===t?0:null===e?1:null===t?-1:e.valueOf()-t.valueOf()}))}function F(e,t){return!e||!e.length||-1!==e.indexOf(d(t))}function I(e,t){if(!e||!e.length)return t;var a=e.map((function(e){var a=e-d(t);a<0&&(a+=12);var i=E(new Date(t),a);return g(i,1),i}));return T(a).shift()||t}function D(e,t,a){if(!e||!e.length)return t;var i=e.map((function(e){var i=g(new Date(t),e);return i.valueOf()<=a.valueOf()?null:i}));return T(i).shift()||t}function A(e,t,a){if(!e||!e.length)return t;var i=e.map((function(e){(r=e[1]-_(t))<0&&(r+=7);var i=w(new Date(t),r);if(e[0]>0){var n=0|(u(i)-1)/7+1;if(n>e[0])return null;w(i,7*(e[0]-n))}else if(e[0]<0){for(var s=new Date(i),r=[];d(s)===d(i);)r.push(u(s)),w(s,7);g(i,r.reverse()[-e[0]-1])}return i.valueOf()<=a.valueOf()?null:i}));return T(i).shift()||t}},function(e,t,a){a(212);var i=a(158),n=a(109).CalendarObject,s=(a(109).CalendarProperty,a(109).schema),r=t.iCalendar=function(e){n.call(this,this,"VCALENDAR"),this.calendar=this,e||(this.addProperty("VERSION","2.0"),this.addProperty("PRODID",a(282).PRODID))};i.inherits(r,n),r.prototype.events=function(){return this.components.VEVENT||[]},r.prototype.timezone=function(e){for(var t=0;t<this.components.VTIMEZONE.length;++t){var a=this.components.VTIMEZONE[t];if(a.getPropertyValue("TZID")==e)return a}},s.VCALENDAR={factory:r,valid_properties:[],required_properties:["PRODID","VERSION"],valid_children:["VEVENT"],required_children:[]},s.VTODO={required_properties:["DTSTAMP","UID"]},s.VJOURNAL={required_properties:["DTSTAMP","UID"]},s.VFREEBUSY={required_properties:["DTSTAMP","UID"]},s.VALARM={required_properties:["ACTION","TRIGGER"]}},function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var i=a(2),n=a(70),s=a(94);const r=i.i18n.translate("xpack.ml.dataframe.analyticsList.viewActionUnknownJobTypeToolTipContent",{defaultMessage:"There is no results page available for this type of data frame analytics job."}),o=i.i18n.translate("xpack.ml.dataframe.analyticsList.viewActionJobNotStartedToolTipContent",{defaultMessage:"The data frame analytics job did not start. There is no results page available."}),l=i.i18n.translate("xpack.ml.dataframe.analyticsList.viewActionJobNotFinishedToolTipContent",{defaultMessage:"The data frame analytics job is not finished. There is no results page available."}),c=i.i18n.translate("xpack.ml.dataframe.analyticsList.viewActionJobFailedToolTipContent",{defaultMessage:"The data frame analytics job failed. There is no results page available."});function d(e){const t={disabled:!1},a=Object(s.d)(e.stats),i=Object(s.f)(e.stats.state),d=1===a.currentPhase&&0===a.progress,u=Object(s.i)(e.stats.state)&&a.currentPhase===a.totalPhases&&100===a.progress,p=!Object(n.y)(e.config.analysis)&&!Object(n.x)(e.config.analysis)&&!Object(n.v)(e.config.analysis);return(!u||i||p)&&(t.disabled=!0,p?t.tooltipContent=r:i?t.tooltipContent=c:d?t.tooltipContent=o:u||(t.tooltipContent=l)),t}},function(e,t,a){var i=a(215),n=a(475)(i);e.exports=n},function(e,t,a){e.exports=a(20)(1245)},function(e,t,a){e.exports=a(20)(890)},function(e,t,a){"use strict";var i=a(80);e.exports={longestPath:function(e){var t={};i.forEach(e.sources(),(function a(n){var s=e.node(n);if(i.has(t,n))return s.rank;t[n]=!0;var r=i.min(i.map(e.outEdges(n),(function(t){return a(t.w)-e.edge(t).minlen})));return r!==Number.POSITIVE_INFINITY&&null!=r||(r=0),s.rank=r}))},slack:function(e,t){return e.node(t.w).rank-e.node(t.v).rank-e.edge(t).minlen}}},,,,function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a(47),n=a(15),s=i.__importDefault(a(240));t.default=function(e,t,a){void 0===t&&(t=0),void 0===a&&(a=[]);var i=s.default(e,t),r=i[0],o=i[1],l=i[2];return n.useEffect(l,a),[r,o]}},,function(e,t,a){"use strict";a.d(t,"b",(function(){return h})),a.d(t,"a",(function(){return f}));var i=a(15),n=a(40),s=a(2),r=(a(639),a(81)),o=a(127),l=a(191),c=a(11);function d({limit:e,maps:t,onLinkClick:a,selectedIds:i,showAllBarBadges:r}){const o=[],d=[];for(let e=0;e<i.length;e++){const a=i[e];void 0!==t.groupsMap[a]&&(d.push(a),o.push(Object(c.jsx)(n.EuiFlexItem,{grow:!1,key:a},Object(c.jsx)(l.a,{id:a,isGroup:!0,numJobs:t.groupsMap[a].length}))))}for(let e=0;e<i.length;e++){const a=i[e];if(void 0===t.groupsMap[a]){if(!1!==(t.jobsMap[a]||[]).some((e=>d.includes(e))))continue;o.push(Object(c.jsx)(n.EuiFlexItem,{grow:!1,key:a},Object(c.jsx)(l.a,{id:a})))}}if(r||o.length<=e)return o.length>e&&o.push(Object(c.jsx)(n.EuiLink,{key:"more-badges-bar-link",onClick:a},Object(c.jsx)(n.EuiText,{grow:!1,size:"xs"},s.i18n.translate("xpack.ml.jobSelector.hideBarBadges",{defaultMessage:"Hide"})))),o;{const t=o.length-e;return o.splice(e),o.push(Object(c.jsx)(n.EuiLink,{key:"more-badges-bar-link",onClick:a},Object(c.jsx)(n.EuiText,{grow:!1,size:"xs"},s.i18n.translate("xpack.ml.jobSelector.showBarBadges",{defaultMessage:"And {overFlow} more",values:{overFlow:t}})))),o}}d.propTypes={limit:o.PropTypes.number,maps:o.PropTypes.shape({jobsMap:o.PropTypes.object,groupsMap:o.PropTypes.object}),onLinkClick:o.PropTypes.func,selectedIds:o.PropTypes.array,showAllBarBadges:o.PropTypes.bool};var u=a(250),p=a(330),m=a(331);function b(e,t,a){if(a)return e;const i=[],n=[];return t.forEach((e=>{i.push(e.groupId),n.push(...e.jobIds)})),e.forEach((e=>{!1===n.includes(e)&&i.push(e)})),i}function h(e){const t={};return e.length&&e.forEach((e=>{t[e.groupId]=e.jobIds})),t}function f({dateFormatTz:e,singleSelection:t,timeseriesOnly:a}){var o,l,f,g;const[j,x]=Object(r.c)("_g"),[v,y]=Object(p.a)(m.a,!0),O=null!==(o=null==j||null===(l=j.ml)||void 0===l?void 0:l.jobIds)&&void 0!==o?o:[],E=null!==(f=null==j||null===(g=j.ml)||void 0===g?void 0:g.groups)&&void 0!==f?f:[],[w,_]=Object(i.useState)({groupsMap:h(E),jobsMap:{}}),[S,M]=Object(i.useState)(b(O,E,t)),[k,C]=Object(i.useState)(!1),[T,F]=Object(i.useState)(!1);function I(){F(!1)}function D(){F(!0)}Object(i.useEffect)((()=>{M(b(O,E,t))}),[JSON.stringify([O,E])]);const A=Object(i.useCallback)((({newSelection:e,jobIds:t,groups:a,time:i})=>{M(e),x({ml:{jobIds:t,groups:a},...void 0!==i?{time:i}:{}}),I()}),[x,M]);return Object(c.jsx)("div",{className:"mlJobSelectorBar"},S.length>0&&Object(c.jsx)(n.EuiFlexGroup,{responsive:!1,gutterSize:"xs",alignItems:"center"},Object(c.jsx)(n.EuiFlexItem,{grow:!1},Object(c.jsx)(n.EuiFlexGroup,{wrap:!0,responsive:!1,gutterSize:"xs",alignItems:"center","data-test-subj":"mlJobSelectionBadges"},Object(c.jsx)(d,{limit:u.a,maps:w,onLinkClick:()=>C(!k),selectedIds:S,showAllBarBadges:k}))),Object(c.jsx)(n.EuiFlexItem,{grow:!1},Object(c.jsx)(n.EuiButtonEmpty,{size:"xs",iconType:"pencil",onClick:D,"data-test-subj":"mlButtonEditJobSelection"},s.i18n.translate("xpack.ml.jobSelector.jobSelectionButton",{defaultMessage:"Edit job selection"})))),function(){if(T)return Object(c.jsx)(n.EuiFlyout,{onClose:I,"data-test-subj":"mlFlyoutJobSelector","aria-labelledby":"jobSelectorFlyout"},Object(c.jsx)(u.b,{dateFormatTz:e,timeseriesOnly:a,singleSelection:t,selectedIds:S,onSelectionConfirmed:A,onJobsFetched:_,onFlyoutClose:I,maps:w,applyTimeRangeConfig:v,onTimeRangeConfigChange:y}))}())}},function(e,t,a){"use strict";a.d(t,"a",(function(){return m}));var i=a(15),n=a(23),s=a(8),r=a(40),o=a(28),l=a(204),c=a(81),d=a(66),u=a(11);function p(e){l.a.next({lastRefresh:Date.now(),timeRange:e})}const m=()=>{var e;const{services:t}=Object(d.b)(),a=t.uiSettings,{timefilter:l,history:m}=t.data.query.timefilter,[b,h]=Object(c.c)("_g"),f=(g=m,function(){var e,t;return null!==(e=null===(t=g.get())||void 0===t?void 0:t.map((({from:e,to:t})=>({start:e,end:t}))))&&void 0!==e?e:[]});var g;const j=null!==(e=null==b?void 0:b.refreshInterval)&&void 0!==e?e:l.getRefreshInterval(),x=Object(i.useCallback)(Object(s.debounce)((e=>{h("refreshInterval",e,!0)}),200),[h]),[v,y]=Object(i.useState)(l.getTime()),[O,E]=Object(i.useState)(f()),[w,_]=Object(i.useState)(l.isAutoRefreshSelectorEnabled()),[S,M]=Object(i.useState)(l.isTimeRangeSelectorEnabled()),k=a.get("dateFormat"),C=a.get(o.UI_SETTINGS.TIMEPICKER_QUICK_RANGES),T=Object(i.useMemo)((()=>C.map((({from:e,to:t,display:a})=>({start:e,end:t,label:a})))),[C]);Object(i.useEffect)((()=>{const e=new n.Subscription,t=l.getRefreshIntervalUpdate$();void 0!==t&&e.add(t.subscribe((e=>{x(l.getRefreshInterval())})));const a=l.getTimeUpdate$();void 0!==a&&e.add(a.subscribe((e=>{y(l.getTime())})));const i=l.getEnabledUpdated$();return void 0!==i&&e.add(i.subscribe((e=>{_(l.isAutoRefreshSelectorEnabled()),M(l.isTimeRangeSelectorEnabled())}))),function(){e.unsubscribe()}}),[]);const F=j.pause||!j.pause&&!j.value;return w||S?Object(u.jsx)("div",{className:"mlNavigationMenu__datePickerWrapper"},Object(u.jsx)(r.EuiSuperDatePicker,{start:v.from,end:v.to,isPaused:F,isAutoRefreshOnly:!S,refreshInterval:j.value,onTimeChange:function({start:e,end:t}){const a={from:e,to:t};l.setTime(a),y(a),E(f())},onRefresh:p,onRefreshChange:function({isPaused:e,refreshInterval:t}){x({pause:e,value:t})},recentlyUsedRanges:O,dateFormat:k,commonlyUsedRanges:T})):null}},function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var i=a(71),n=a.n(i),s=(a(15),a(40)),r=a(2),o=a(143),l=a(11);const c=({icon:e,id:t,isGroup:a=!1,numJobs:i,removeId:c})=>{let d,u={color:a?Object(o.a)(t):"hollow"};return!0===e&&c&&(u={...u,iconType:"cross",iconSide:"right",onClick:()=>c(t),onClickAriaLabel:"Remove id"}),void 0!==i&&(d=r.i18n.translate("xpack.ml.jobSelector.selectedGroupJobs",{defaultMessage:"({jobsCount, plural, one {# job} other {# jobs}})",values:{jobsCount:i}})),Object(l.jsx)(s.EuiBadge,n()({key:`${t}-id`,"data-test-subj":`mlJobSelectionBadge ${t}`},u),`${t}${d||""}`)}},function(e,t,a){"use strict";a.d(t,"a",(function(){return h}));var i=a(15),n=a.n(i),s=a(44),r=a(277),o=a(117),l=a(262),c=a(280),d=a(40),u=a(76),p=a(116),m=a(11);const b=({overlayKey:e,start:t,end:a,color:i,showMarker:r=!0})=>{const{euiTheme:o}=Object(p.e)();return Object(m.jsx)(n.a.Fragment,null,Object(m.jsx)(s.RectAnnotation,{id:`rect_annotation_${e}`,zIndex:1,hideTooltips:!0,dataValues:[{coordinates:{x0:t,x1:a}}],style:{fill:i,strokeWidth:0}}),Object(m.jsx)(s.LineAnnotation,{id:"annotation_1",domainType:s.AnnotationDomainType.XDomain,dataValues:[{dataValue:t}],style:{line:{strokeWidth:1,stroke:"#343741",opacity:0}},markerPosition:s.Position.Bottom,hideTooltips:!0,marker:r?Object(m.jsx)(d.EuiIcon,{type:"arrowUp"}):void 0,markerBody:r?Object(m.jsx)("div",{style:{fontWeight:"normal",color:o.euiTextColor}},Object(u.d)(t)):void 0}))},h=({eventRateChartData:e,anomalyData:t,height:a,width:i,showAxis:n,loading:d=!1,fadeChart:u,overlayRanges:p,onBrushEnd:h})=>{const{EVENT_RATE_COLOR_WITH_ANOMALIES:f,EVENT_RATE_COLOR:g}=Object(o.d)(),j=u?f:g;return Object(m.jsx)("div",{style:{width:i,height:a},"data-test-subj":"mlEventRateChart "+(e.length?"withData":"empty")},Object(m.jsx)(l.a,{height:a,hasData:e.length>0,loading:d},Object(m.jsx)(s.Chart,null,!0===n&&Object(m.jsx)(r.a,null),Object(m.jsx)(s.Settings,{tooltip:s.TooltipType.None,onBrushEnd:h,theme:{scales:{histogramPadding:.2}}}),p&&p.map(((e,t)=>Object(m.jsx)(b,{key:t,overlayKey:t,start:e.start,end:e.end,color:e.color,showMarker:e.showMarker}))),Object(m.jsx)(c.a,{anomalyData:t}),Object(m.jsx)(s.HistogramBarSeries,{id:"event_rate",xScaleType:s.ScaleType.Time,yScaleType:s.ScaleType.Linear,xAccessor:"time",yAccessors:["value"],data:e,color:j}))))}},,,,,,,,,,,,function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var i=a(23);const n=new i.Subject},function(e,t,a){"use strict";a.d(t,"b",(function(){return p})),a.d(t,"a",(function(){return m}));var i=a(71),n=a.n(i),s=(a(15),a(98)),r=a(347),o=a(81),l=a(0),c=a(104),d=a(66),u=a(11);const p=()=>({pageIndex:0,pageSize:10,sortField:"id",sortDirection:"asc"}),m=e=>{const[t,a]=Object(o.b)(l.b.ANOMALY_DETECTION_JOBS_MANAGE,p()),{services:{docLinks:i}}=Object(d.b)(),m=i.links.ml.anomalyDetection;return Object(u.jsx)("div",{"data-test-subj":"mlPageJobManagement"},Object(u.jsx)(s.a,{tabId:"anomaly_detection"}),Object(u.jsx)(r.a,n()({},e,{jobsViewState:t,onJobsViewStateUpdate:a})),Object(u.jsx)(c.a,{docLink:m}))}},function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var i=a(15),n=a(66),s=a(207),r=a(79);const o=()=>{const{services:{http:{basePath:e}}}=Object(n.b)(),t=Object(n.h)().get(s.b),a=Object(n.h)().get(s.a);return{createLinkWithUserDefaults:Object(i.useCallback)(((i,n)=>{const s=r.a.createResultsUrlForJobs(n,i,!0===t&&void 0!==a?a:void 0);return`${e.get()}/app/ml/${s}`}),[e])}}},function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return n}));const i="ml:anomalyDetection:results:enableTimeDefaults",n="ml:anomalyDetection:results:timeDefaults"},function(e,t,a){"use strict";a.d(t,"c",(function(){return d})),a.d(t,"b",(function(){return u})),a.d(t,"a",(function(){return p}));var i=a(15),n=a.n(i),s=a(40),r=a(66),o=a(111),l=a(6),c=a(11);const d=({initialAlert:e,jobIds:t,onCloseFlyout:a,onSave:s})=>{const{services:{triggersActionsUi:d}}=Object(r.b)(),u=Object(i.useMemo)((()=>{if(!d)return;const i={onClose:()=>{a()},onSave:async()=>{s&&s()}};return e?d.getEditAlertFlyout({...i,initialAlert:e}):d.getAddAlertFlyout({...i,consumer:l.e,canChangeTrigger:!1,alertTypeId:o.d.ANOMALY_DETECTION,metadata:{},initialValues:{params:{jobSelection:{jobIds:t}}}})}),[d,null==e?void 0:e.id,t]);return Object(c.jsx)(n.a.Fragment,null,u)},u=({setShowFunction:e,unsetShowFunction:t,onSave:a})=>{const[n,s]=Object(i.useState)(!1),[r,o]=Object(i.useState)(),l=Object(i.useCallback)((e=>{o(e),s(!0)}),[]);return Object(i.useEffect)((()=>(e(l),()=>{t()})),[]),n&&r?Object(c.jsx)(d,{jobIds:r,onCloseFlyout:()=>s(!1),onSave:()=>{s(!1),a()}}):null},p=({initialAlert:e,onSave:t})=>{const[a,r]=Object(i.useState)(!1);return Object(c.jsx)(n.a.Fragment,null,Object(c.jsx)(s.EuiButtonEmpty,{size:"xs",onClick:r.bind(null,!a)},e.name),a?Object(c.jsx)(d,{initialAlert:e,onCloseFlyout:r.bind(null,!1),onSave:()=>{r(!1),t()}}):null)}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"ElasticsearchSqlHighlightRules",{enumerable:!0,get:function(){return i.ElasticsearchSqlHighlightRules}}),Object.defineProperty(t,"ScriptHighlightRules",{enumerable:!0,get:function(){return i.ScriptHighlightRules}}),Object.defineProperty(t,"XJsonHighlightRules",{enumerable:!0,get:function(){return i.XJsonHighlightRules}}),Object.defineProperty(t,"XJsonMode",{enumerable:!0,get:function(){return i.XJsonMode}}),Object.defineProperty(t,"addXJsonToRules",{enumerable:!0,get:function(){return i.addXJsonToRules}}),Object.defineProperty(t,"installXJsonMode",{enumerable:!0,get:function(){return i.installXJsonMode}});var i=a(273)},function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var i=a(23);const n={rowMouseenter$:new i.Subject,rowMouseleave$:new i.Subject}},function(e,t,a){"use strict";function i(e,t){if(e.length!==t.length)return!1;for(var a=0;a<e.length;a++)if(e[a]!==t[a])return!1;return!0}e.exports=function(e,t){var a;void 0===t&&(t=i);var n,s=[],r=!1;return function(){for(var i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];return r&&a===this&&t(i,s)||(n=e.apply(this,i),r=!0,a=this,s=i),n}}},function(e,t,a){"use strict";(function(t){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
function i(e,t){if(e===t)return 0;for(var a=e.length,i=t.length,n=0,s=Math.min(a,i);n<s;++n)if(e[n]!==t[n]){a=e[n],i=t[n];break}return a<i?-1:i<a?1:0}function n(e){return t.Buffer&&"function"==typeof t.Buffer.isBuffer?t.Buffer.isBuffer(e):!(null==e||!e._isBuffer)}var s=a(158),r=Object.prototype.hasOwnProperty,o=Array.prototype.slice,l="foo"===function(){}.name;function c(e){return Object.prototype.toString.call(e)}function d(e){return!n(e)&&("function"==typeof t.ArrayBuffer&&("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):!!e&&(e instanceof DataView||!!(e.buffer&&e.buffer instanceof ArrayBuffer))))}var u=e.exports=g,p=/\s*function\s+([^\(\s]*)\s*/;function m(e){if(s.isFunction(e)){if(l)return e.name;var t=e.toString().match(p);return t&&t[1]}}function b(e,t){return"string"==typeof e?e.length<t?e:e.slice(0,t):e}function h(e){if(l||!s.isFunction(e))return s.inspect(e);var t=m(e);return"[Function"+(t?": "+t:"")+"]"}function f(e,t,a,i,n){throw new u.AssertionError({message:a,actual:e,expected:t,operator:i,stackStartFunction:n})}function g(e,t){e||f(e,!0,t,"==",u.ok)}function j(e,t,a,r){if(e===t)return!0;if(n(e)&&n(t))return 0===i(e,t);if(s.isDate(e)&&s.isDate(t))return e.getTime()===t.getTime();if(s.isRegExp(e)&&s.isRegExp(t))return e.source===t.source&&e.global===t.global&&e.multiline===t.multiline&&e.lastIndex===t.lastIndex&&e.ignoreCase===t.ignoreCase;if(null!==e&&"object"==typeof e||null!==t&&"object"==typeof t){if(d(e)&&d(t)&&c(e)===c(t)&&!(e instanceof Float32Array||e instanceof Float64Array))return 0===i(new Uint8Array(e.buffer),new Uint8Array(t.buffer));if(n(e)!==n(t))return!1;var l=(r=r||{actual:[],expected:[]}).actual.indexOf(e);return-1!==l&&l===r.expected.indexOf(t)||(r.actual.push(e),r.expected.push(t),function(e,t,a,i){if(null==e||null==t)return!1;if(s.isPrimitive(e)||s.isPrimitive(t))return e===t;if(a&&Object.getPrototypeOf(e)!==Object.getPrototypeOf(t))return!1;var n=x(e),r=x(t);if(n&&!r||!n&&r)return!1;if(n)return j(e=o.call(e),t=o.call(t),a);var l,c,d=O(e),u=O(t);if(d.length!==u.length)return!1;for(d.sort(),u.sort(),c=d.length-1;c>=0;c--)if(d[c]!==u[c])return!1;for(c=d.length-1;c>=0;c--)if(!j(e[l=d[c]],t[l],a,i))return!1;return!0}(e,t,a,r))}return a?e===t:e==t}function x(e){return"[object Arguments]"==Object.prototype.toString.call(e)}function v(e,t){if(!e||!t)return!1;if("[object RegExp]"==Object.prototype.toString.call(t))return t.test(e);try{if(e instanceof t)return!0}catch(e){}return!Error.isPrototypeOf(t)&&!0===t.call({},e)}function y(e,t,a,i){var n;if("function"!=typeof t)throw new TypeError('"block" argument must be a function');"string"==typeof a&&(i=a,a=null),n=function(e){var t;try{e()}catch(e){t=e}return t}(t),i=(a&&a.name?" ("+a.name+").":".")+(i?" "+i:"."),e&&!n&&f(n,a,"Missing expected exception"+i);var r="string"==typeof i,o=!e&&n&&!a;if((!e&&s.isError(n)&&r&&v(n,a)||o)&&f(n,a,"Got unwanted exception"+i),e&&n&&a&&!v(n,a)||!e&&n)throw n}u.AssertionError=function(e){this.name="AssertionError",this.actual=e.actual,this.expected=e.expected,this.operator=e.operator,e.message?(this.message=e.message,this.generatedMessage=!1):(this.message=function(e){return b(h(e.actual),128)+" "+e.operator+" "+b(h(e.expected),128)}(this),this.generatedMessage=!0);var t=e.stackStartFunction||f;if(Error.captureStackTrace)Error.captureStackTrace(this,t);else{var a=new Error;if(a.stack){var i=a.stack,n=m(t),s=i.indexOf("\n"+n);if(s>=0){var r=i.indexOf("\n",s+1);i=i.substring(r+1)}this.stack=i}}},s.inherits(u.AssertionError,Error),u.fail=f,u.ok=g,u.equal=function(e,t,a){e!=t&&f(e,t,a,"==",u.equal)},u.notEqual=function(e,t,a){e==t&&f(e,t,a,"!=",u.notEqual)},u.deepEqual=function(e,t,a){j(e,t,!1)||f(e,t,a,"deepEqual",u.deepEqual)},u.deepStrictEqual=function(e,t,a){j(e,t,!0)||f(e,t,a,"deepStrictEqual",u.deepStrictEqual)},u.notDeepEqual=function(e,t,a){j(e,t,!1)&&f(e,t,a,"notDeepEqual",u.notDeepEqual)},u.notDeepStrictEqual=function e(t,a,i){j(t,a,!0)&&f(t,a,i,"notDeepStrictEqual",e)},u.strictEqual=function(e,t,a){e!==t&&f(e,t,a,"===",u.strictEqual)},u.notStrictEqual=function(e,t,a){e===t&&f(e,t,a,"!==",u.notStrictEqual)},u.throws=function(e,t,a){y(!0,e,t,a)},u.doesNotThrow=function(e,t,a){y(!1,e,t,a)},u.ifError=function(e){if(e)throw e};var O=Object.keys||function(e){var t=[];for(var a in e)r.call(e,a)&&t.push(a);return t}}).call(this,a(121))},function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var i=a(135),n=a.n(i),s=a(23),r=a(25),o=a(15),l=a(136),c=a(204),d=a(66);const u=()=>{const e=Object(d.g)(),t=Object(o.useMemo)((()=>Object(s.merge)(c.a,e.getTimeUpdate$().pipe(Object(r.map)((()=>{const{from:t,to:a}=e.getTime();return{lastRefresh:Date.now(),timeRange:{start:t,end:a}}}))),l.b.pipe(Object(r.map)((e=>({lastRefresh:e})))))),[]);return n()(t)}},function(e,t,a){"use strict";var i=a(110);e.exports=s;var n="\0";function s(e){this._isDirected=!i.has(e,"directed")||e.directed,this._isMultigraph=!!i.has(e,"multigraph")&&e.multigraph,this._isCompound=!!i.has(e,"compound")&&e.compound,this._label=void 0,this._defaultNodeLabelFn=i.constant(void 0),this._defaultEdgeLabelFn=i.constant(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children["\0"]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}function r(e,t){e[t]?e[t]++:e[t]=1}function o(e,t){--e[t]||delete e[t]}function l(e,t,a,n){var s=""+t,r=""+a;if(!e&&s>r){var o=s;s=r,r=o}return s+""+r+""+(i.isUndefined(n)?"\0":n)}function c(e,t,a,i){var n=""+t,s=""+a;if(!e&&n>s){var r=n;n=s,s=r}var o={v:n,w:s};return i&&(o.name=i),o}function d(e,t){return l(e,t.v,t.w,t.name)}s.prototype._nodeCount=0,s.prototype._edgeCount=0,s.prototype.isDirected=function(){return this._isDirected},s.prototype.isMultigraph=function(){return this._isMultigraph},s.prototype.isCompound=function(){return this._isCompound},s.prototype.setGraph=function(e){return this._label=e,this},s.prototype.graph=function(){return this._label},s.prototype.setDefaultNodeLabel=function(e){return i.isFunction(e)||(e=i.constant(e)),this._defaultNodeLabelFn=e,this},s.prototype.nodeCount=function(){return this._nodeCount},s.prototype.nodes=function(){return i.keys(this._nodes)},s.prototype.sources=function(){var e=this;return i.filter(this.nodes(),(function(t){return i.isEmpty(e._in[t])}))},s.prototype.sinks=function(){var e=this;return i.filter(this.nodes(),(function(t){return i.isEmpty(e._out[t])}))},s.prototype.setNodes=function(e,t){var a=arguments,n=this;return i.each(e,(function(e){a.length>1?n.setNode(e,t):n.setNode(e)})),this},s.prototype.setNode=function(e,t){return i.has(this._nodes,e)?(arguments.length>1&&(this._nodes[e]=t),this):(this._nodes[e]=arguments.length>1?t:this._defaultNodeLabelFn(e),this._isCompound&&(this._parent[e]=n,this._children[e]={},this._children["\0"][e]=!0),this._in[e]={},this._preds[e]={},this._out[e]={},this._sucs[e]={},++this._nodeCount,this)},s.prototype.node=function(e){return this._nodes[e]},s.prototype.hasNode=function(e){return i.has(this._nodes,e)},s.prototype.removeNode=function(e){var t=this;if(i.has(this._nodes,e)){var a=function(e){t.removeEdge(t._edgeObjs[e])};delete this._nodes[e],this._isCompound&&(this._removeFromParentsChildList(e),delete this._parent[e],i.each(this.children(e),(function(e){t.setParent(e)})),delete this._children[e]),i.each(i.keys(this._in[e]),a),delete this._in[e],delete this._preds[e],i.each(i.keys(this._out[e]),a),delete this._out[e],delete this._sucs[e],--this._nodeCount}return this},s.prototype.setParent=function(e,t){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(i.isUndefined(t))t=n;else{for(var a=t+="";!i.isUndefined(a);a=this.parent(a))if(a===e)throw new Error("Setting "+t+" as parent of "+e+" would create a cycle");this.setNode(t)}return this.setNode(e),this._removeFromParentsChildList(e),this._parent[e]=t,this._children[t][e]=!0,this},s.prototype._removeFromParentsChildList=function(e){delete this._children[this._parent[e]][e]},s.prototype.parent=function(e){if(this._isCompound){var t=this._parent[e];if(t!==n)return t}},s.prototype.children=function(e){if(i.isUndefined(e)&&(e=n),this._isCompound){var t=this._children[e];if(t)return i.keys(t)}else{if(e===n)return this.nodes();if(this.hasNode(e))return[]}},s.prototype.predecessors=function(e){var t=this._preds[e];if(t)return i.keys(t)},s.prototype.successors=function(e){var t=this._sucs[e];if(t)return i.keys(t)},s.prototype.neighbors=function(e){var t=this.predecessors(e);if(t)return i.union(t,this.successors(e))},s.prototype.isLeaf=function(e){return 0===(this.isDirected()?this.successors(e):this.neighbors(e)).length},s.prototype.filterNodes=function(e){var t=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});t.setGraph(this.graph());var a=this;i.each(this._nodes,(function(a,i){e(i)&&t.setNode(i,a)})),i.each(this._edgeObjs,(function(e){t.hasNode(e.v)&&t.hasNode(e.w)&&t.setEdge(e,a.edge(e))}));var n={};function s(e){var i=a.parent(e);return void 0===i||t.hasNode(i)?(n[e]=i,i):i in n?n[i]:s(i)}return this._isCompound&&i.each(t.nodes(),(function(e){t.setParent(e,s(e))})),t},s.prototype.setDefaultEdgeLabel=function(e){return i.isFunction(e)||(e=i.constant(e)),this._defaultEdgeLabelFn=e,this},s.prototype.edgeCount=function(){return this._edgeCount},s.prototype.edges=function(){return i.values(this._edgeObjs)},s.prototype.setPath=function(e,t){var a=this,n=arguments;return i.reduce(e,(function(e,i){return n.length>1?a.setEdge(e,i,t):a.setEdge(e,i),i})),this},s.prototype.setEdge=function(){var e,t,a,n,s=!1,o=arguments[0];"object"==typeof o&&null!==o&&"v"in o?(e=o.v,t=o.w,a=o.name,2===arguments.length&&(n=arguments[1],s=!0)):(e=o,t=arguments[1],a=arguments[3],arguments.length>2&&(n=arguments[2],s=!0)),e=""+e,t=""+t,i.isUndefined(a)||(a=""+a);var d=l(this._isDirected,e,t,a);if(i.has(this._edgeLabels,d))return s&&(this._edgeLabels[d]=n),this;if(!i.isUndefined(a)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(e),this.setNode(t),this._edgeLabels[d]=s?n:this._defaultEdgeLabelFn(e,t,a);var u=c(this._isDirected,e,t,a);return e=u.v,t=u.w,Object.freeze(u),this._edgeObjs[d]=u,r(this._preds[t],e),r(this._sucs[e],t),this._in[t][d]=u,this._out[e][d]=u,this._edgeCount++,this},s.prototype.edge=function(e,t,a){var i=1===arguments.length?d(this._isDirected,arguments[0]):l(this._isDirected,e,t,a);return this._edgeLabels[i]},s.prototype.hasEdge=function(e,t,a){var n=1===arguments.length?d(this._isDirected,arguments[0]):l(this._isDirected,e,t,a);return i.has(this._edgeLabels,n)},s.prototype.removeEdge=function(e,t,a){var i=1===arguments.length?d(this._isDirected,arguments[0]):l(this._isDirected,e,t,a),n=this._edgeObjs[i];return n&&(e=n.v,t=n.w,delete this._edgeLabels[i],delete this._edgeObjs[i],o(this._preds[t],e),o(this._sucs[e],t),delete this._in[t][i],delete this._out[e][i],this._edgeCount--),this},s.prototype.inEdges=function(e,t){var a=this._in[e];if(a){var n=i.values(a);return t?i.filter(n,(function(e){return e.v===t})):n}},s.prototype.outEdges=function(e,t){var a=this._out[e];if(a){var n=i.values(a);return t?i.filter(n,(function(e){return e.w===t})):n}},s.prototype.nodeEdges=function(e,t){var a=this.inEdges(e,t);if(a)return a.concat(this.outEdges(e,t))}},function(e,t,a){var i=a(216),n=a(159);e.exports=function(e,t){return e&&i(e,t,n)}},function(e,t,a){var i=a(474)();e.exports=i},function(e,t,a){e.exports=a(20)(893)},function(e,t,a){e.exports=a(20)(1251)},function(e,t,a){e.exports=a(20)(1243)},function(e,t,a){e.exports=a(20)(895)},function(e,t,a){e.exports=a(20)(1253)},function(e,t,a){e.exports=a(20)(522)},function(e,t,a){e.exports=a(20)(1244)},function(e,t,a){e.exports=a(20)(3045)},function(e,t,a){e.exports=a(20)(641)},function(e,t,a){var i=a(322);e.exports=function(e,t,a){for(var n=-1,s=e.length;++n<s;){var r=e[n],o=t(r);if(null!=o&&(void 0===l?o==o&&!i(o):a(o,l)))var l=o,c=r}return c}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a(15);t.default=function(e){i.useEffect(e,[])}},,,function(e,t,a){"use strict";a.d(t,"a",(function(){return l})),a.d(t,"b",(function(){return c})),a.d(t,"c",(function(){return d}));var i=a(2),n=a(21),s=a.n(n),r=a(106),o=a.n(r);function l(e){const t={},a={};return e.forEach((e=>{void 0!==e.groups&&e.groups.forEach((i=>{void 0===t[i]?(t[i]={id:i,jobIds:[e.job_id],timeRange:{to:e.timeRange.to,toMoment:null,from:e.timeRange.from,fromMoment:null,fromPx:e.timeRange.fromPx,toPx:e.timeRange.toPx,widthPx:null}},a[i]=[e.job_id]):(t[i].jobIds.push(e.job_id),a[i].push(e.job_id),(null===t[i].timeRange.to||e.timeRange.to>t[i].timeRange.to)&&(t[i].timeRange.to=e.timeRange.to,t[i].timeRange.toMoment=e.timeRange.toMoment),(null===t[i].timeRange.from||e.timeRange.from<t[i].timeRange.from)&&(t[i].timeRange.from=e.timeRange.from,t[i].timeRange.fromMoment=e.timeRange.fromMoment),(null===t[i].timeRange.toPx||e.timeRange.toPx>t[i].timeRange.toPx)&&(t[i].timeRange.toPx=e.timeRange.toPx),(null===t[i].timeRange.fromPx||e.timeRange.fromPx<t[i].timeRange.fromPx)&&(t[i].timeRange.fromPx=e.timeRange.fromPx))}))})),Object.keys(t).forEach((e=>{const a=t[e];a.timeRange.widthPx=a.timeRange.toPx-a.timeRange.fromPx,a.timeRange.toMoment=s()(a.timeRange.to),a.timeRange.fromMoment=s()(a.timeRange.from);const n=a.timeRange.fromMoment.format("MMM Do YYYY, HH:mm"),r=a.timeRange.toMoment.format("MMM Do YYYY, HH:mm");a.timeRange.label=i.i18n.translate("xpack.ml.jobSelectList.groupTimeRangeLabel",{defaultMessage:"{fromString} to {toString}",values:{fromString:n,toString:r}})})),{groups:Object.keys(t).map((e=>t[e])),groupsMap:a}}function c(e,t){if(e.length>0){const a=[];if(e.forEach((e=>{t.includes(e.job_id)&&(void 0!==e.timeRange.from&&a.push(e.timeRange.from),void 0!==e.timeRange.to&&a.push(e.timeRange.to))})),a.length){const e=o.a.extent(a);return{from:s()(e[0]).toISOString(),to:s()(e[1]).toISOString()}}}}function d(e,t,a){const n=e.filter((e=>void 0!==e.timeRange.to&&void 0!==e.timeRange.from)),r=Math.min(...n.map((e=>+e.timeRange.from))),l=Math.max(...n.map((e=>+e.timeRange.to))),c=o.a.scale.linear().domain([r,l]).range([1,a]);return e.forEach((e=>{if(void 0!==e.timeRange.to&&void 0!==e.timeRange.from){e.timeRange.fromPx=c(e.timeRange.from),e.timeRange.toPx=c(e.timeRange.to),e.timeRange.widthPx=e.timeRange.toPx-e.timeRange.fromPx,e.timeRange.widthPx<1&&(e.timeRange.widthPx=1),e.timeRange.toMoment=s()(e.timeRange.to).tz(t),e.timeRange.fromMoment=s()(e.timeRange.from).tz(t);const a=e.timeRange.fromMoment.format("MMM Do YYYY, HH:mm"),n=e.timeRange.toMoment.format("MMM Do YYYY, HH:mm");e.timeRange.label=i.i18n.translate("xpack.ml.jobSelector.jobTimeRangeLabel",{defaultMessage:"{fromString} to {toString}",values:{fromString:a,toString:n}})}else e.timeRange.widthPx=0,e.timeRange.fromPx=0,e.timeRange.toPx=0,e.timeRange.label=i.i18n.translate("xpack.ml.jobSelector.noResultsForJobLabel",{defaultMessage:"No results"})})),e}},,,,,,,function(e,t,a){"use strict";a.r(t),a.d(t,"AnomalyTimelineService",(function(){return AnomalyTimelineService}));var i=a(4),n=a.n(i),s=a(43),r=a(99),o=a(78),l=a(16);class AnomalyTimelineService{constructor(e,t,a){n()(this,"timeBuckets",void 0),n()(this,"_customTimeRange",void 0),this.timeFilter=e,this.mlResultsService=a,this.timeBuckets=new r.a({"histogram:maxBars":t.get(s.UI_SETTINGS.HISTOGRAM_MAX_BARS),"histogram:barTarget":t.get(s.UI_SETTINGS.HISTOGRAM_BAR_TARGET),dateFormat:t.get("dateFormat"),"dateFormat:scaled":t.get("dateFormat:scaled")}),this.timeFilter.enableTimeRangeSelector()}static isSwimlaneData(e){return Object(l.isPopulatedObject)(e,["interval","points","laneLabels"])}static isOverallSwimlaneData(e){return this.isSwimlaneData(e)&&Object(l.isPopulatedObject)(e,["earliest","latest"])&&1===e.laneLabels.length&&e.laneLabels[0]===o.g}setTimeRange(e){this._customTimeRange=e}getSwimlaneBucketInterval(e,t){const a=this.getTimeBounds();if(void 0===a)throw new Error("timeRangeSelectorEnabled has to be enabled");this.timeBuckets.setInterval("auto"),this.timeBuckets.setBounds(a);const i=this.timeBuckets.getInterval().asSeconds(),n=(a.max.valueOf()-a.min.valueOf())/1e3/i;Math.floor(t/n*100)/100<8&&this.timeBuckets.setInterval(2*i+"s");const s=e.reduce(((e,t)=>Math.max(e,t.bucketSpanSeconds)),0);return s>i&&(this.timeBuckets.setInterval(s+"s"),this.timeBuckets.setBounds(a)),this.timeBuckets.getInterval()}async loadOverallData(e,t,a,i){const n=null!=a?a:this.getSwimlaneBucketInterval(e,t);if(!e||!e.length)throw new Error("Explorer jobs collection is required");const s=this.getTimeBounds(),o=Object(r.b)(s,n,!1),l=e.map((e=>e.id)),c=Object(r.b)(s,n,!0),d=await this.mlResultsService.getOverallBucketScores(l,1,c.min.valueOf(),c.max.valueOf(),n.asSeconds()+"s",i);return this.processOverallResults(d.results,o,n.asSeconds())}async loadViewBySwimlane(e,t,a,i,n,s,l,c,d,u,p){const m=this.getTimeBounds();if(void 0===m)throw new Error("timeRangeSelectorEnabled has to be enabled");const b=null!=u?u:this.getSwimlaneBucketInterval(a,c),h=Object(r.b)(m,b,!1),f=a.map((e=>e.id)),g=b.asMilliseconds();let j;if(i===o.j){const t=void 0!==e&&e.length>0?e:f;j=await this.mlResultsService.getScoresByBucket(t,h.min.valueOf(),h.max.valueOf(),g,s,l,p)}else j=await this.mlResultsService.getInfluencerValueMaxScoreByTime(f,i,e,h.min.valueOf(),h.max.valueOf(),g,n,s,l,d,p);if(void 0===j)return;return this.processViewByResults(j.results,j.cardinality,e,t,i,b.asSeconds())}async loadViewByTopFieldValuesForSelectedTime(e,t,a,i,n,s,r,l,c,d){const u=a.map((e=>e.id));if(i!==o.j){const a=await this.mlResultsService.getTopInfluencers(u,e,t,n,s,r,c,d);if(void 0===a.influencers[i])return[];const o=[],l=a.influencers[i];return Array.isArray(l)&&l.forEach((e=>{e.maxAnomalyScore>0&&o.push(e.influencerFieldValue)})),o}{const i=await this.mlResultsService.getScoresByBucket(u,e,t,this.getSwimlaneBucketInterval(a,l).asMilliseconds(),s,r,n);return Object.keys(i.results)}}getTimeBounds(){return void 0!==this._customTimeRange?this.timeFilter.calculateBounds(this._customTimeRange):this.timeFilter.getBounds()}processOverallResults(e,t,a){const i=o.g,n={laneLabels:[i],points:[],interval:a,earliest:t.min.valueOf()/1e3,latest:t.max.valueOf()/1e3};return Object.entries(e).forEach((([e,t])=>{const a=+e/1e3;n.points.push({laneLabel:i,time:a,value:t}),n.earliest=Math.min(a,n.earliest),n.latest=Math.max(a+n.interval,n.latest)})),n}processViewByResults(e,t,a,i,n,s){const r={fieldName:n,points:[],laneLabels:[],interval:s,earliest:i.earliest,latest:i.latest,cardinality:t},o={};Object.entries(e).forEach((([e,t])=>{r.laneLabels.push(e),o[e]=0,Object.entries(t).forEach((([t,a])=>{const i=+t/1e3;r.points.push({laneLabel:e,time:i,value:a}),o[e]=Math.max(o[e],a)}))}));const l=a.length;return r.laneLabels=0===l?r.laneLabels.sort(((e,t)=>o[t]-o[e])):r.laneLabels.sort(((e,t)=>{let i=a.indexOf(e),n=a.indexOf(t);return i=i>-1?i:l,n=n>-1?n:l,i-n})),r}}},,,function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a(15);t.default=function(e,t){void 0===t&&(t=0);var a=i.useRef(!1),n=i.useRef(),s=i.useRef(e),r=i.useCallback((function(){return a.current}),[]),o=i.useCallback((function(){a.current=!1,n.current&&clearTimeout(n.current),n.current=setTimeout((function(){a.current=!0,s.current()}),t)}),[t]),l=i.useCallback((function(){a.current=null,n.current&&clearTimeout(n.current)}),[]);return i.useEffect((function(){s.current=e}),[e]),i.useEffect((function(){return o(),l}),[t]),[r,l,o]}},,,,,,,function(e,t,a){"use strict";a.r(t),a.d(t,"getMlGlobalServices",(function(){return $b})),a.d(t,"renderApp",(function(){return Xb}));var i={};a.r(i),a.d(i,"overviewRouteFactory",(function(){return B})),a.d(i,"appRootRouteFactory",(function(){return V})),a.d(i,"jobListRouteFactory",(function(){return Z})),a.d(i,"indexOrSearchRouteFactory",(function(){return de})),a.d(i,"dataVizIndexOrSearchRouteFactory",(function(){return ue})),a.d(i,"jobTypeRouteFactory",(function(){return Oe})),a.d(i,"newJobRouteFactory",(function(){return we})),a.d(i,"singleMetricRouteFactory",(function(){return Ns})),a.d(i,"multiMetricRouteFactory",(function(){return zs})),a.d(i,"populationRouteFactory",(function(){return Bs})),a.d(i,"advancedRouteFactory",(function(){return Js})),a.d(i,"categorizationRouteFactory",(function(){return Vs})),a.d(i,"rareRouteFactory",(function(){return Us})),a.d(i,"recognizeRouteFactory",(function(){return sr})),a.d(i,"checkViewOrCreateRouteFactory",(function(){return rr})),a.d(i,"selectorRouteFactory",(function(){return pr})),a.d(i,"indexBasedRouteFactory",(function(){return hr})),a.d(i,"fileBasedRouteFactory",(function(){return jr})),a.d(i,"settingsRouteFactory",(function(){return Er})),a.d(i,"calendarListRouteFactory",(function(){return zr})),a.d(i,"newCalendarRouteFactory",(function(){return Vr})),a.d(i,"editCalendarRouteFactory",(function(){return Ur})),a.d(i,"filterListRouteFactory",(function(){return so})),a.d(i,"newFilterListRouteFactory",(function(){return lo})),a.d(i,"editFilterListRouteFactory",(function(){return co})),a.d(i,"analyticsJobsListRouteFactory",(function(){return mo})),a.d(i,"analyticsJobExplorationRouteFactory",(function(){return lc})),a.d(i,"analyticsJobsCreationRouteFactory",(function(){return Td})),a.d(i,"modelsListRouteFactory",(function(){return Id})),a.d(i,"analyticsMapRouteFactory",(function(){return Ad})),a.d(i,"timeSeriesExplorerRouteFactory",(function(){return gm})),a.d(i,"explorerRouteFactory",(function(){return Db})),a.d(i,"accessDeniedRouteFactory",(function(){return Nb}));var n=a(15),s=a.n(n),r=(a(392),a(49)),o=a.n(r),l=a(3),c=a(42),d=a(22),u=a(91),p=a(62),m=a(6);function b(e){if(void 0===e){const e=(e,t)=>{};return{click:e,count:e}}return{click:(t,a)=>e.reportUiCounter(m.e,p.METRIC_TYPE.CLICK,t,a),count:(t,a)=>e.reportUiCounter(m.e,p.METRIC_TYPE.COUNT,t,a)}}var h=a(46),f=a(66),g=a(92),j=a(81),x=a(71),v=a.n(x),y=a(2),O=a(87),E=a(8),w=a(150),_=a(43),S=a(108);const M={bool:{must:[{match_all:{}}]}};function k(){return Object(E.cloneDeep)(M)}var C=a(101),T=a(0);const F=(e,t,a,i)=>{const s=Object(f.f)(),r=Object.keys(i),o=Object.values(i),l=r.reduce(((e,t)=>(e[t]={},e)),{}),[c,d]=Object(n.useState)(null),[u,p]=Object(n.useState)(l),m=Object(C.a)(T.b.ANOMALY_DETECTION_JOBS_MANAGE);return Object(n.useEffect)((()=>{(async()=>{try{(await Promise.all(o.map((e=>e())))).forEach(((e,t)=>l[r[t]]=e)),p(l)}catch(e){return}try{if(""===e)throw new Error(y.i18n.translate("xpack.ml.useResolver.errorIndexPatternIdEmptyString",{defaultMessage:"indexPatternId must not be empty string."}));let i={savedSearch:null,indexPattern:null};void 0!==t?i=await Object(O.a)(t):void 0!==e&&(i.indexPattern=await Object(O.b)(e));const{savedSearch:n,indexPattern:s}=i,{combinedQuery:r}=function(e,t,a){let i={query:"",language:"lucene"},n=k();if(null!==a){const s=Object(O.f)(a);i=s.query;const r=s.filter,o=Array.isArray(r)?r:[];if(i.language===S.c.KUERY){const e=Object(w.d)(i.query);""!==i.query&&(n=Object(w.f)(e,t));const a=Object(w.b)(o,t);!1===Array.isArray(n.bool.filter)&&(n.bool.filter=void 0===n.bool.filter?[]:[n.bool.filter]),!1===Array.isArray(n.bool.must_not)&&(n.bool.must_not=void 0===n.bool.must_not?[]:[n.bool.must_not]),n.bool.filter=[...n.bool.filter,...a.filter],n.bool.must_not=[...n.bool.must_not,...a.must_not]}else{const a=Object(_.getEsQueryConfig)(e);n=Object(w.a)(t,[i],o,a)}}return{query:i,combinedQuery:n}}(a,null!==s?s:void 0,n);d({combinedQuery:r,currentIndexPattern:s,currentSavedSearch:n,indexPatterns:Object(O.e)(),kibanaConfig:a})}catch(e){s.toasts.addError(new Error(e),{title:y.i18n.translate("xpack.ml.useResolver.errorTitle",{defaultMessage:"An error has occurred"})}),await m()}})()}),[]),{context:c,results:u}};var I=a(72),D=a(154),A=a(83);const L={ML_BREADCRUMB:Object.freeze({text:y.i18n.translate("xpack.ml.machineLearningBreadcrumbLabel",{defaultMessage:"Machine Learning"}),href:"/"}),SETTINGS_BREADCRUMB:Object.freeze({text:y.i18n.translate("xpack.ml.settingsBreadcrumbLabel",{defaultMessage:"Settings"}),href:"/settings"}),ANOMALY_DETECTION_BREADCRUMB:Object.freeze({text:y.i18n.translate("xpack.ml.anomalyDetectionBreadcrumbLabel",{defaultMessage:"Anomaly Detection"}),href:"/jobs"}),DATA_FRAME_ANALYTICS_BREADCRUMB:Object.freeze({text:y.i18n.translate("xpack.ml.dataFrameAnalyticsLabel",{defaultMessage:"Data Frame Analytics"}),href:"/data_frame_analytics"}),DATA_VISUALIZER_BREADCRUMB:Object.freeze({text:y.i18n.translate("xpack.ml.datavisualizerBreadcrumbLabel",{defaultMessage:"Data Visualizer"}),href:"/datavisualizer"}),CREATE_JOB_BREADCRUMB:Object.freeze({text:y.i18n.translate("xpack.ml.createJobsBreadcrumbLabel",{defaultMessage:"Create job"}),href:"/jobs/new_job"}),CALENDAR_MANAGEMENT_BREADCRUMB:Object.freeze({text:y.i18n.translate("xpack.ml.settings.breadcrumbs.calendarManagementLabel",{defaultMessage:"Calendar management"}),href:"/settings/calendars_list"}),FILTER_LISTS_BREADCRUMB:Object.freeze({text:y.i18n.translate("xpack.ml.settings.breadcrumbs.filterListsLabel",{defaultMessage:"Filter lists"}),href:"/settings/filter_lists"})},R=(e,t)=>a=>{a.preventDefault(),t(e)},P=(e,t,a)=>({text:L[e].text,href:`${a}/app/ml${L[e].href}`,onClick:R(L[e].href,t)});var N=a(11);const z=s.a.lazy((()=>a.e(24).then(a.bind(null,757)))),B=(e,t)=>({path:"/overview",render:(e,t)=>Object(N.jsx)(J,v()({},e,{deps:t})),breadcrumbs:[P("ML_BREADCRUMB",e,t),{text:y.i18n.translate("xpack.ml.overview.overviewLabel",{defaultMessage:"Overview"}),onClick:R("/overview",e)}]}),J=({deps:e})=>{const{redirectToMlAccessDeniedPage:t}=e,{context:a}=F(void 0,void 0,e.config,{checkFullLicense:u.b,checkGetJobsCapabilities:()=>Object(I.c)(t),getMlNodeCount:D.a,loadMlServerInfo:A.f});return Object(f.g)({timeRangeSelector:!1,autoRefreshSelector:!1}),Object(N.jsx)(Vb,{context:a},Object(N.jsx)(n.Suspense,{fallback:null},Object(N.jsx)(z,null)))},V=(e,t)=>({path:"/",render:()=>Object(N.jsx)(U,null),breadcrumbs:[]}),U=()=>Object(N.jsx)(h.Redirect,{to:"/overview"});var G=a(135),q=a.n(G),H=a(155),W=a(204),$=a(85);const Y=({indexPatterns:e,redirectToMlAccessDeniedPage:t})=>({checkFullLicense:u.b,getMlNodeCount:$.c,loadMlServerInfo:A.f,loadIndexPatterns:()=>Object(O.h)(e),checkGetJobsCapabilities:()=>Object(I.c)(t),loadSavedSearches:O.i});var X=a(205),Q=a(136),K=a(137);const Z=(e,t)=>({path:"/jobs",render:(e,t)=>Object(N.jsx)(ee,v()({},e,{deps:t})),breadcrumbs:[P("ML_BREADCRUMB",e,t),P("ANOMALY_DETECTION_BREADCRUMB",e,t),{text:y.i18n.translate("xpack.ml.anomalyDetection.jobManagementLabel",{defaultMessage:"Job Management"}),href:""}]}),ee=({deps:e})=>{var t,a,i,s,r;const{context:o}=F(void 0,void 0,e.config,Y(e)),l=Object(f.g)({timeRangeSelector:!1,autoRefreshSelector:!0}),[c,d]=Object(j.c)("_g"),u=q()(W.a),p=null!==(t=null==u?void 0:u.lastRefresh)&&void 0!==t?t:0,m=null!==(a=null==c||null===(i=c.refreshInterval)||void 0===i?void 0:i.value)&&void 0!==a?a:0,b=null===(s=null==c||null===(r=c.refreshInterval)||void 0===r?void 0:r.pause)||void 0===s||s,h=0===m||!0===b;Object(n.useEffect)((()=>{const e=0===m&&!0===b?{pause:!1,value:H.a}:{pause:b,value:m};d({refreshInterval:e},void 0,!0),l.setRefreshInterval(e)}),[]);const g=Object(n.useMemo)((()=>new Q.a),[]);return Object(N.jsx)(Vb,{context:o},Object(N.jsx)(K.a.Provider,{value:g},Object(N.jsx)(X.a,{blockRefresh:h,lastRefresh:p})))};var te=a(40),ae=a(41),ie=a(56);const ne=({nextStepPath:e})=>{const{uiSettings:t,savedObjects:a}=Object(f.b)().services,i=Object(f.e)();return Object(N.jsx)(te.EuiPage,{"data-test-subj":"mlPageSourceSelection"},Object(N.jsx)(te.EuiPageBody,{restrictWidth:1200},Object(N.jsx)(te.EuiPageHeader,null,Object(N.jsx)(te.EuiPageHeaderSection,null,Object(N.jsx)(te.EuiTitle,{size:"m"},Object(N.jsx)("h1",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.selectIndexPatternOrSavedSearch",defaultMessage:"Select index pattern or saved search"}))))),Object(N.jsx)(te.EuiPageContent,null,Object(N.jsx)(ie.SavedObjectFinderUi,{key:"searchSavedObjectFinder",onChoose:(t,a)=>{i(`${e}?${"index-pattern"===a?"index":"savedSearchId"}=${encodeURIComponent(t)}`)},showFilter:!0,noItemsMessage:y.i18n.translate("xpack.ml.newJob.wizard.searchSelection.notFoundLabel",{defaultMessage:"No matching indices or saved searches found."}),savedObjectMetaData:[{type:"search",getIconForSavedObject:()=>"search",name:y.i18n.translate("xpack.ml.newJob.wizard.searchSelection.savedObjectType.search",{defaultMessage:"Saved search"})},{type:"index-pattern",getIconForSavedObject:()=>"indexPatternApp",name:y.i18n.translate("xpack.ml.newJob.wizard.searchSelection.savedObjectType.indexPattern",{defaultMessage:"Index pattern"})}],fixedPageSize:20,uiSettings:t,savedObjects:a}))))};var se,re=a(79),oe=a(77);async function le(e,t,a){const{createdBy:i,job:n,datafeed:s}=re.a.tempJobCloningObjects;if(!n||!s)return Promise.resolve();try{await Object(O.h)(e);const n=function(e,t,a){let i="";switch(e){case oe.a.SINGLE_METRIC:i=oe.f.SINGLE_METRIC;break;case oe.a.MULTI_METRIC:i=oe.f.MULTI_METRIC;break;case oe.a.POPULATION:i=oe.f.POPULATION;break;case oe.a.CATEGORIZATION:i=oe.f.CATEGORIZATION;break;case oe.a.RARE:i=oe.f.RARE;break;default:i=oe.f.ADVANCED}const n=Object(O.c)(a.indices.join());return`jobs/new_job/${i}?index=${n}&_g=()`}(i,0,s);return await a(`${t}/app/ml/${n}`),Promise.reject()}catch(e){return Promise.resolve()}}!function(e){e[e.NEW_JOB=0]="NEW_JOB",e[e.DATAVISUALIZER=1]="DATAVISUALIZER"}(se||(se={}));const ce=(e,t)=>[P("ML_BREADCRUMB",e,t),P("ANOMALY_DETECTION_BREADCRUMB",e,t),{text:y.i18n.translate("xpack.ml.jobsBreadcrumbs.selectIndexOrSearchLabel",{defaultMessage:"Create job"}),href:""}],de=(e,t)=>({path:"/jobs/new_job/step/index_or_search",render:(e,t)=>Object(N.jsx)(pe,v()({},e,{nextStepPath:"/jobs/new_job/step/job_type",deps:t,mode:se.NEW_JOB})),breadcrumbs:ce(e,t)}),ue=(e,t)=>({path:"/datavisualizer_index_select",render:(e,t)=>Object(N.jsx)(pe,v()({},e,{nextStepPath:"/jobs/new_job/datavisualizer",deps:t,mode:se.DATAVISUALIZER})),breadcrumbs:ce(e,t)}),pe=({nextStepPath:e,deps:t,mode:a})=>{const{services:{http:{basePath:i},application:{navigateToUrl:n}}}=Object(f.b)(),{redirectToMlAccessDeniedPage:s}=t,r={...Y(t),preConfiguredJobRedirect:()=>le(t.indexPatterns,i.get(),n)},o={checkBasicLicense:u.a,loadIndexPatterns:()=>Object(O.h)(t.indexPatterns),checkGetJobsCapabilities:()=>Object(I.c)(s)},{context:l}=F(void 0,void 0,t.config,a===se.NEW_JOB?r:o);return Object(N.jsx)(Vb,{context:l},Object(N.jsx)(ne,{nextStepPath:e}))};var me=a(141);function be(e){return null!==e}const he=({icon:e,iconAreaLabel:t,title:a,description:i,onClick:n,href:s,isDisabled:r,"data-test-subj":o})=>{const l={...s?{href:s}:{},...n?{onClick:n}:{}};return Object(N.jsx)(te.EuiPanel,{style:{cursor:r?"not-allowed":void 0}},Object(N.jsx)(te.EuiLink,v()({style:{display:"block",pointerEvents:r?"none":void 0,background:"transparent",outline:"none"},"data-test-subj":o,color:"subdued"},l),Object(N.jsx)(te.EuiFlexGroup,{gutterSize:"l",responsive:!0},Object(N.jsx)(te.EuiFlexItem,{grow:!1,style:{paddingTop:"8px"}},"string"==typeof e?Object(N.jsx)(te.EuiIcon,{size:"xl",type:e,"aria-label":t}):e),Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(te.EuiTitle,{size:"s"},Object(N.jsx)("h3",null,a)),Object(N.jsx)(te.EuiText,{color:"subdued"},Object(N.jsx)("p",null,i))))))},fe=({config:e,indexPattern:t,savedSearch:a})=>{const{services:{http:{basePath:i}}}=Object(f.b)(),n=null===a?`index=${t.id}`:`savedSearchId=${a.id}`,s=`${i.get()}/app/ml/jobs/new_job/recognize?id=${e.id}&${n}`;let r=null;return r=e.logo&&e.logo.icon?Object(N.jsx)(te.EuiIcon,{type:e.logo.icon,size:"xl"}):e.logo&&e.logo.src?Object(N.jsx)("img",{alt:"",src:e.logo.src}):Object(N.jsx)("h3",{className:"euiTitle euiTitle--small"},e.id),Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(he,{"data-test-subj":`mlRecognizerCard ${e.id}`,href:s,title:e.title,description:e.description,icon:r}))};var ge=a(67);class data_recognizer_DataRecognizer extends n.Component{constructor(e){super(e),this.state={results:[]},this.indexPattern=e.indexPattern,this.savedSearch=e.savedSearch,this.className=e.className,this.results=e.results}componentDidMount(){ge.ml.recognizeIndex({indexPatternTitle:this.indexPattern.title}).then((e=>{e.sort(((e,t)=>e.title.localeCompare(t.title)));const t=e.map((e=>Object(N.jsx)(fe,{key:e.id,config:e,indexPattern:this.indexPattern,savedSearch:this.savedSearch})));"object"==typeof this.results&&(this.results.count=t.length,"function"==typeof this.results.onChange&&this.results.onChange()),this.setState({results:t})})).catch((e=>{console.error("Error attempting to recognize index",e)}))}render(){return Object(N.jsx)(s.a.Fragment,null,this.state.results)}}var je=a(172);const xe=Object(N.jsx)("svg",{width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Object(N.jsx)("path",{d:"M16 32C7.16344 32 0 24.8366 0 16C0 7.16344 7.16344 0 16 0C24.8366 0 32 7.16344 32 16H30C30 8.26801 23.732 2 16 2C8.26801 2 2 8.26801 2 16C2 23.732 8.26801 30 16 30V32Z",fill:"#343741"}),Object(N.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M17 15H23V17H17V23H15V17H9V15H15V9H17V15ZM32 30V32H20V30H32ZM32 22L20 22V24L32 24V22ZM32 26V28H20V26H32Z",fill:"#017D73"})),ve=Object(N.jsx)("svg",{width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Object(N.jsx)("path",{d:"M16 32C7.16344 32 0 24.8366 0 16C0 7.16344 7.16344 0 16 0C24.8366 0 32 7.16344 32 16H30C30 8.26801 23.732 2 16 2C8.26801 2 2 8.26801 2 16C2 23.732 8.26801 30 16 30V32Z",fill:"#343741"}),Object(N.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M17 15H23V17H17V23H15V17H9V15H15V9H17V15ZM32 30V32H20V30H32ZM32 22L20 22V24L32 24V22ZM32 26V28H20V26H32Z",fill:"#017D73"})),ye=()=>{const{services:{share:e}}=Object(f.b)(),t=Object(g.b)(),a=Object(f.e)(),i=Object(C.a)(T.b.ANOMALY_DETECTION_CREATE_JOB_SELECT_INDEX),[r,o]=Object(n.useState)(0),{currentSavedSearch:l,currentIndexPattern:c}=t,d=Object(O.j)(c),u=!d&&be(l)?y.i18n.translate("xpack.ml.newJob.wizard.jobType.indexPatternFromSavedSearchNotTimeBasedMessage",{defaultMessage:"{savedSearchTitle} uses index pattern {indexPatternTitle} which is not time based",values:{savedSearchTitle:l.attributes.title,indexPatternTitle:c.title}}):y.i18n.translate("xpack.ml.newJob.wizard.jobType.indexPatternNotTimeBasedMessage",{defaultMessage:"Index pattern {indexPatternTitle} is not time based",values:{indexPatternTitle:c.title}}),p=be(l)?y.i18n.translate("xpack.ml.newJob.wizard.jobType.savedSearchPageTitleLabel",{defaultMessage:"saved search {savedSearchTitle}",values:{savedSearchTitle:l.attributes.title}}):y.i18n.translate("xpack.ml.newJob.wizard.jobType.indexPatternPageTitleLabel",{defaultMessage:"index pattern {indexPatternTitle}",values:{indexPatternTitle:c.title}}),m={count:0,onChange(){o(m.count)}},b=()=>be(l)?`?savedSearchId=${l.id}`:`?index=${c.id}`,h=[{onClick:()=>a(`/jobs/new_job/single_metric${b()}`),icon:{type:"createSingleMetricJob",ariaLabel:y.i18n.translate("xpack.ml.newJob.wizard.jobType.singleMetricAriaLabel",{defaultMessage:"Single metric job"})},title:y.i18n.translate("xpack.ml.newJob.wizard.jobType.singleMetricTitle",{defaultMessage:"Single metric"}),description:y.i18n.translate("xpack.ml.newJob.wizard.jobType.singleMetricDescription",{defaultMessage:"Detect anomalies in a single time series."}),id:"mlJobTypeLinkSingleMetricJob"},{onClick:()=>a(`/jobs/new_job/multi_metric${b()}`),icon:{type:"createMultiMetricJob",ariaLabel:y.i18n.translate("xpack.ml.newJob.wizard.jobType.multiMetricAriaLabel",{defaultMessage:"Multi-metric job"})},title:y.i18n.translate("xpack.ml.newJob.wizard.jobType.multiMetricTitle",{defaultMessage:"Multi-metric"}),description:y.i18n.translate("xpack.ml.newJob.wizard.jobType.multiMetricDescription",{defaultMessage:"Detect anomalies with one or more metrics and optionally split the analysis."}),id:"mlJobTypeLinkMultiMetricJob"},{onClick:()=>a(`/jobs/new_job/population${b()}`),icon:{type:"createPopulationJob",ariaLabel:y.i18n.translate("xpack.ml.newJob.wizard.jobType.populationAriaLabel",{defaultMessage:"Population job"})},title:y.i18n.translate("xpack.ml.newJob.wizard.jobType.populationTitle",{defaultMessage:"Population"}),description:y.i18n.translate("xpack.ml.newJob.wizard.jobType.populationDescription",{defaultMessage:"Detect activity that is unusual compared to the behavior of the population."}),id:"mlJobTypeLinkPopulationJob"},{onClick:()=>a(`/jobs/new_job/advanced${b()}`),icon:{type:"createAdvancedJob",ariaLabel:y.i18n.translate("xpack.ml.newJob.wizard.jobType.advancedAriaLabel",{defaultMessage:"Advanced job"})},title:y.i18n.translate("xpack.ml.newJob.wizard.jobType.advancedTitle",{defaultMessage:"Advanced"}),description:y.i18n.translate("xpack.ml.newJob.wizard.jobType.advancedDescription",{defaultMessage:"Use the full range of options to create a job for more advanced use cases."}),id:"mlJobTypeLinkAdvancedJob"},{onClick:()=>a(`/jobs/new_job/categorization${b()}`),icon:{type:xe,ariaLabel:y.i18n.translate("xpack.ml.newJob.wizard.jobType.categorizationAriaLabel",{defaultMessage:"Categorization job"})},title:y.i18n.translate("xpack.ml.newJob.wizard.jobType.categorizationTitle",{defaultMessage:"Categorization"}),description:y.i18n.translate("xpack.ml.newJob.wizard.jobType.categorizationDescription",{defaultMessage:"Group log messages into categories and detect anomalies within them."}),id:"mlJobTypeLinkCategorizationJob"},{onClick:()=>a(`/jobs/new_job/rare${b()}`),icon:{type:ve,ariaLabel:y.i18n.translate("xpack.ml.newJob.wizard.jobType.rareAriaLabel",{defaultMessage:"Rare job"})},title:y.i18n.translate("xpack.ml.newJob.wizard.jobType.rareTitle",{defaultMessage:"Rare"}),description:y.i18n.translate("xpack.ml.newJob.wizard.jobType.rareDescription",{defaultMessage:"Detect rare values in time series data."}),id:"mlJobTypeLinkrareJob"}];return Object(N.jsx)(te.EuiPage,{"data-test-subj":"mlPageJobTypeSelection"},Object(N.jsx)(te.EuiPageBody,{restrictWidth:1200},Object(N.jsx)(te.EuiTitle,{size:"l"},Object(N.jsx)("h1",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobType.createJobFromTitle",defaultMessage:"Create a job from the {pageTitleLabel}",values:{pageTitleLabel:p}}))),Object(N.jsx)(te.EuiSpacer,null),!1===d&&Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(te.EuiCallOut,{title:u,color:"warning",iconType:"alert"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobType.howToRunAnomalyDetectionDescription",defaultMessage:"Anomaly detection can only be run over indices which are time based."}),Object(N.jsx)("br",null),Object(N.jsx)(te.EuiLink,{onClick:i},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobType.selectDifferentIndexLinkText",defaultMessage:"Select a different index"}))),Object(N.jsx)(te.EuiSpacer,{size:"xxl"})),Object(N.jsx)("div",{hidden:0===r},Object(N.jsx)(te.EuiTitle,{size:"s"},Object(N.jsx)("h2",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobType.useSuppliedConfigurationTitle",defaultMessage:"Use preconfigured jobs"}))),Object(N.jsx)(te.EuiSpacer,{size:"s"}),Object(N.jsx)(te.EuiText,null,Object(N.jsx)("p",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobType.useSuppliedConfigurationDescription",defaultMessage:"The fields in your data match known configurations. Create a set of preconfigured jobs."}))),Object(N.jsx)(te.EuiSpacer,{size:"m"}),Object(N.jsx)(te.EuiFlexGrid,{gutterSize:"l",columns:4},Object(N.jsx)(data_recognizer_DataRecognizer,{indexPattern:c,savedSearch:l,results:m})),Object(N.jsx)(te.EuiSpacer,{size:"xxl"})),Object(N.jsx)(te.EuiTitle,{size:"s"},Object(N.jsx)("h2",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobType.useWizardTitle",defaultMessage:"Use a wizard"}))),Object(N.jsx)(te.EuiSpacer,{size:"m"}),Object(N.jsx)(te.EuiFlexGrid,{gutterSize:"l",columns:4},h.map((({onClick:e,icon:t,title:a,description:i,id:n})=>Object(N.jsx)(te.EuiFlexItem,{key:n},Object(N.jsx)(he,{"data-test-subj":n,onClick:e,icon:t.type,iconAreaLabel:t.ariaLabel,title:a,description:i,isDisabled:!d}))))),Object(N.jsx)(te.EuiSpacer,{size:"xxl"}),Object(N.jsx)(te.EuiText,null,Object(N.jsx)(te.EuiTitle,{size:"s"},Object(N.jsx)("h3",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobType.learnMoreAboutDataTitle",defaultMessage:"Learn more about your data"}))),Object(N.jsx)("p",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobType.learnMoreAboutDataDescription",defaultMessage:"If you're not sure what type of job to create, first explore the fields and metrics in your data."}))),Object(N.jsx)(te.EuiSpacer,{size:"m"}),Object(N.jsx)(te.EuiFlexGrid,{gutterSize:"l",columns:4},Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(he,{icon:"dataVisualizer",iconAreaLabel:y.i18n.translate("xpack.ml.newJob.wizard.jobType.dataVisualizerAriaLabel",{defaultMessage:"Data Visualizer"}),title:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobType.dataVisualizerTitle",defaultMessage:"Data Visualizer"}),description:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobType.dataVisualizerDescription",defaultMessage:"Learn more about the characteristics of your data and identify the fields for analysis with machine learning."}),onClick:async()=>{const t=be(l)?l.attributes.title:c.title,i=e.url.locators.get(T.a),n=await i.getUrl({page:T.b.DATA_VISUALIZER_INDEX_VIEWER,pageState:{...null!=l&&l.id?{savedSearchId:l.id}:{index:c.id}}},{absolute:!0});Object(je.a)(T.b.DATA_VISUALIZER_INDEX_VIEWER,t,n),a(`/jobs/new_job/datavisualizer${b()}`)}})))))},Oe=(e,t)=>({path:"/jobs/new_job/step/job_type",render:(e,t)=>Object(N.jsx)(Ee,v()({},e,{deps:t})),breadcrumbs:[P("ML_BREADCRUMB",e,t),P("ANOMALY_DETECTION_BREADCRUMB",e,t),{text:y.i18n.translate("xpack.ml.jobsBreadcrumbs.selectJobType",{defaultMessage:"Create job"}),href:""}]}),Ee=({location:e,deps:t})=>{const{index:a,savedSearchId:i}=Object(me.parse)(e.search,{sort:!1}),{context:n}=F(a,i,t.config,Y(t));return Object(N.jsx)(Vb,{context:n},Object(N.jsx)(ye,null))},we=()=>({path:"/jobs/new_job",render:()=>Object(N.jsx)(_e,null),breadcrumbs:[]}),_e=()=>Object(N.jsx)(h.Redirect,{to:"/jobs/new_job/step/index_or_search"});var Se=a(23),Me=a(25),ke=a(4),Ce=a.n(ke),Te=a(74),Fe=a(90),Ie=a(139);let De;!function(e){e[e.ERROR=0]="ERROR",e[e.WARNING=1]="WARNING"}(De||(De={}));const Ae=y.i18n.translate("xpack.ml.newJob.wizard.validateJob.asyncJobNameAlreadyExists",{defaultMessage:"Job ID already exists. A job ID cannot be the same as an existing job or group."}),Le=y.i18n.translate("xpack.ml.newJob.wizard.validateJob.asyncGroupNameAlreadyExists",{defaultMessage:"Group ID already exists. A group ID cannot be the same as an existing group or job."});function Re(e){return e.pipe(Object(Me.map)((e=>e.jobId)),Object(Me.distinctUntilChanged)(((e,t)=>e===t)),Object(Me.switchMap)((e=>ge.ml.jobs.jobsExist$([e],!0))),Object(Me.map)((e=>{const t=Object.values(e),a=!1===(null==t?void 0:t[0].exists);return{jobIdExists:{valid:a,...a?{}:{message:Ae}}}})))}function Pe(e){return e.pipe(Object(Me.map)((e=>e.groups)),Object(Me.distinctUntilChanged)(((e,t)=>JSON.stringify(e)===JSON.stringify(t))),Object(Me.switchMap)((e=>ge.ml.jobs.jobsExist$(e,!0))),Object(Me.map)((e=>{const t=!1===Object.values(e).some((e=>!0===e.exists&&!1===e.isGroup));return{groupIdsExist:{valid:t,...t?{}:{message:Le}}}})))}var Ne=a(144);class job_validator_JobValidator{constructor(e){var t;Ce()(this,"_jobCreator",void 0),Ce()(this,"_validationSummary",void 0),Ce()(this,"_lastJobConfig",void 0),Ce()(this,"_lastDatafeedConfig",void 0),Ce()(this,"_validateTimeout",null),Ce()(this,"_asyncValidators$",[]),Ce()(this,"_asyncValidatorsResult$",void 0),Ce()(this,"_basicValidations",{jobId:{valid:!0},groupIds:{valid:!0},modelMemoryLimit:{valid:!0},bucketSpan:{valid:!0},duplicateDetectors:{valid:!0},query:{valid:!0},queryDelay:{valid:!0},frequency:{valid:!0},scrollSize:{valid:!0},categorizerMissingPerPartition:{valid:!0},categorizerVaryingPerPartitionField:{valid:!0},summaryCountField:{valid:!0}}),Ce()(this,"_advancedValidations",{categorizationFieldValid:{valid:!0}}),Ce()(this,"_validating",!1),Ce()(this,"_basicValidationResult$",new Se.ReplaySubject(2)),Ce()(this,"_jobCreatorSubject$",new Se.Subject),Ce()(this,"validationResult$",void 0),Ce()(this,"latestValidationResult",this._basicValidations),this._jobCreator=e,this._lastJobConfig=this._jobCreator.formattedJobJson,this._lastDatafeedConfig=this._jobCreator.formattedDatafeedJson,this._validationSummary={basic:!1,advanced:!1},this._asyncValidators$=[(t=this._jobCreatorSubject$,Object(Se.combineLatest)([t.pipe(Object(Me.pluck)("modelPlot")),t.pipe(Object(Me.filter)((e=>null==e?void 0:e.modelPlot)),Object(Me.map)((e=>({jobCreator:e,analysisConfigString:JSON.stringify(e.jobConfig.analysis_config,null,2)}))),Object(Me.distinctUntilChanged)(((e,t)=>e.analysisConfigString===t.analysisConfigString)),Object(Me.switchMap)((({jobCreator:e})=>ge.ml.validateCardinality$({...e.jobConfig,datafeed_config:e.datafeedConfig}).pipe(Object(Me.map)((e=>{for(const t of e)if(void 0!==t.modelPlotCardinality)return{highCardinality:{value:t.modelPlotCardinality,severity:De.WARNING}};return null}))))),Object(Me.startWith)(null))]).pipe(Object(Me.map)((([e,t])=>e?t:null)))),Re(this._jobCreatorSubject$),Pe(this._jobCreatorSubject$)],this._asyncValidatorsResult$=Object(Se.combineLatest)(this._asyncValidators$).pipe(Object(Me.map)((e=>e.reduce(((e,t)=>({...e,...t||{}})),{}))),Object(Me.startWith)({})),this.validationResult$=Object(Se.combineLatest)([this._basicValidationResult$,this._asyncValidatorsResult$]).pipe(Object(Me.map)((([e,t])=>({...e,...t}))),Object(Me.tap)((e=>{this.latestValidationResult=e})))}validate(e,t=!1){this._validating=!0;const a=this._jobCreator.formattedJobJson,i=this._jobCreator.formattedDatafeedJson;this._runAdvancedValidation(),t||a!==this._lastJobConfig||i!==this._lastDatafeedConfig?(null!==this._validateTimeout&&clearTimeout(this._validateTimeout),this._lastJobConfig=a,this._lastDatafeedConfig=i,this._validateTimeout=setTimeout((()=>{this._runBasicValidation(),this._jobCreatorSubject$.next(this._jobCreator),this._validating=!1,this._validateTimeout=null,e()}),500)):this._validating=null!==this._validateTimeout,e()}_resetBasicValidations(){this._validationSummary.basic=!0,Object.values(this._basicValidations).forEach((e=>{e.valid=!0,delete e.message}))}_runBasicValidation(){this._resetBasicValidations();const e=this._jobCreator.jobConfig,t=this._jobCreator.datafeedConfig,a=Object(A.d)(),i=Object(Te.e)(e,void 0,a);Object(Ie.b)(i,this._basicValidations,e,t);const n=Object(Te.c)(t);Object(Ie.b)(n,this._basicValidations,e,t);const s=Object(Te.d)(e,t);Object(Ie.b)(s,this._basicValidations,e,t),this._validationSummary.basic=this._isOverallBasicValid(),this._basicValidationResult$.next(this._basicValidations)}_runAdvancedValidation(){Object(Fe.b)(this._jobCreator)&&(this._advancedValidations.categorizationFieldValid.valid=this._jobCreator.overallValidStatus!==Ne.a.INVALID)}_isOverallBasicValid(){return!1===Object.values(this._basicValidations).some((e=>!1===e.valid))}get validationSummary(){return this._validationSummary}get bucketSpan(){return this._basicValidations.bucketSpan}get summaryCountField(){return this._basicValidations.summaryCountField}get duplicateDetectors(){return this._basicValidations.duplicateDetectors}get jobId(){return this._basicValidations.jobId}get groupIds(){return this._basicValidations.groupIds}get modelMemoryLimit(){return this._basicValidations.modelMemoryLimit}get query(){return this._basicValidations.query}get queryDelay(){return this._basicValidations.queryDelay}get frequency(){return this._basicValidations.frequency}get scrollSize(){return this._basicValidations.scrollSize}set advancedValid(e){this._validationSummary.advanced=e}get validating(){return this._validating}get categorizationField(){return this._advancedValidations.categorizationFieldValid.valid}set categorizationField(e){this._advancedValidations.categorizationFieldValid.valid=e}get categorizerMissingPerPartition(){return this._basicValidations.categorizerMissingPerPartition}get categorizerVaryingPerPartitionField(){return this._basicValidations.categorizerVaryingPerPartitionField}get isPickFieldsStepValid(){return this._jobCreator.detectors.length>0&&(this._jobCreator.type!==oe.f.ADVANCED||this._jobCreator.type===oe.f.ADVANCED&&this.modelMemoryLimit.valid)&&this.bucketSpan.valid&&this.duplicateDetectors.valid&&this.categorizerMissingPerPartition.valid&&this.categorizerVaryingPerPartitionField.valid&&this.summaryCountField.valid&&!this.validating&&(this._jobCreator.type!==oe.f.CATEGORIZATION||this._jobCreator.type===oe.f.CATEGORIZATION&&this.categorizationField)}get isModelMemoryEstimationPayloadValid(){return this._jobCreator.detectors.length>0&&this.bucketSpan.valid&&this.duplicateDetectors.valid&&(this._jobCreator.type!==oe.f.CATEGORIZATION||this._jobCreator.type===oe.f.CATEGORIZATION&&this.categorizationField)}}var ze=a(24);const Be=(e,t,a,i)=>{const{services:{notifications:s}}=Object(f.b)(),r=Object(n.useMemo)((()=>((e,t)=>{const a=new Se.Subject,i=new Se.Subject;return{get error$(){return i.asObservable()},get updates$(){return Object(Se.combineLatest)([e.wizardInitialized$.pipe(Object(Me.skipWhile)((e=>!1===e))),a]).pipe(Object(Me.map)((([,e])=>e)),Object(Me.debounceTime)(600),Object(Me.map)(E.cloneDeep),Object(Me.distinctUntilChanged)(E.isEqual),Object(Me.filter)((()=>t.isModelMemoryEstimationPayloadValid)),Object(Me.switchMap)((e=>ge.ml.calculateModelMemoryLimit$(e).pipe(Object(Me.pluck)("modelMemoryLimit"),Object(Me.catchError)((e=>(console.error("Model memory limit could not be calculated",e.body),i.next(e),Object(Se.of)(oe.c))))))))},update(e){a.next(e)}}})(e,t)),[]);Object(n.useEffect)((()=>{const t=new Se.Subscription;return t.add(r.updates$.pipe(Object(Me.startWith)(e.modelMemoryLimit),Object(Me.pairwise)()).subscribe((([t,i])=>{null!==e.modelMemoryLimit&&e.modelMemoryLimit!==t||(e.modelMemoryLimit=i,a())}))),t.add(r.error$.subscribe((e=>{s.toasts.addWarning({title:y.i18n.translate("xpack.ml.newJob.wizard.estimateModelMemoryError",{defaultMessage:"Model memory limit could not be calculated"}),text:Object(ze.b)(e)})}))),()=>{t.unsubscribe()}}),[]),Object(n.useEffect)((()=>{r.update({datafeedConfig:e.datafeedConfig,analysisConfig:e.jobConfig.analysis_config,indexPattern:e.indexPatternTitle,query:e.datafeedConfig.query,timeFieldName:e.jobConfig.data_description.time_field,earliestMs:e.start,latestMs:e.end})}),[i])};let Je;!function(e){e[e.TIME_RANGE=0]="TIME_RANGE",e[e.ADVANCED_CONFIGURE_DATAFEED=1]="ADVANCED_CONFIGURE_DATAFEED",e[e.PICK_FIELDS=2]="PICK_FIELDS",e[e.JOB_DETAILS=3]="JOB_DETAILS",e[e.VALIDATION=4]="VALIDATION",e[e.SUMMARY=5]="SUMMARY"}(Je||(Je={}));const Ve=Object(n.createContext)({jobCreatorUpdated:0,jobCreatorUpdate:()=>{},jobCreator:{},chartLoader:{},resultsLoader:{},chartInterval:{},jobValidator:{},jobValidatorUpdated:0,fields:[],aggs:[],existingJobsAndGroups:{}});var Ue=a(89),Ge=a(21),qe=a.n(Ge);const He=({previous:e,previousActive:t=!0,next:a,nextActive:i=!0,children:s})=>Object(N.jsx)(n.Fragment,null,Object(N.jsx)(te.EuiHorizontalRule,null),Object(N.jsx)(te.EuiFlexGroup,null,e&&Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(We,{previous:e,previousActive:t})),a&&Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)($e,{next:a,nextActive:i})),Object(N.jsx)(te.EuiFlexItem,{grow:!1},s),Object(N.jsx)(te.EuiFlexItem,null))),We=({previous:e,previousActive:t=!0})=>Object(N.jsx)(te.EuiButtonEmpty,{disabled:!t,onClick:e,iconType:"arrowLeft",iconSide:"left","data-test-subj":"mlJobWizardNavButtonPrevious"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.previousStepButton",defaultMessage:"Previous"})),$e=({next:e,nextActive:t=!0})=>Object(N.jsx)(te.EuiButton,{fill:!0,disabled:!t,onClick:e,iconSide:"right",iconType:"arrowRight","data-test-subj":"mlJobWizardNavButtonNext"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.nextStepButton",defaultMessage:"Next"}));var Ye=a(31),Xe=a.n(Ye),Qe=a(5);function Ke(){const e=Object(d.j)(),t=Xe.a.parse(e.getTime().from),a=Xe.a.parse(e.getTime().to),i=void 0!==t?t.valueOf():0;return{to:void 0!==a?a.valueOf():0,from:i}}const Ze=({indexPattern:e,query:t,disabled:a,callback:i})=>{async function n(e,t){const a=await async function(e,t){try{const a=Object(d.j)(),i=e.getComputedFields().runtimeFields,n=await ge.ml.getTimeFieldRange({index:e.title,timeFieldName:e.timeFieldName,query:t,...Object(Qe.b)(i)?{runtimeMappings:i}:{}});return a.setTime({from:qe()(n.start.epoch).toISOString(),to:qe()(n.end.epoch).toISOString()}),n}catch(e){return Object(d.k)().addDanger(y.i18n.translate("xpack.ml.fullTimeRangeSelector.errorSettingTimeRangeNotification",{defaultMessage:"An error occurred setting the time range."})),e}}(e,t);"function"==typeof i&&i(a)}return Object(N.jsx)(te.EuiButton,{isDisabled:a,onClick:()=>n(e,t),"data-test-subj":"mlButtonUseFullData"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.fullTimeRangeSelector.useFullDataButtonLabel",defaultMessage:"Use full {indexPatternTitle} data",values:{indexPatternTitle:e.title}}))};var et=a(192),tt=a(143);const at=Object(n.memo)((({children:e,validation:t})=>{const a=y.i18n.translate("xpack.ml.newJob.wizard.jobDetailsStep.jobGroupSelect.title",{defaultMessage:"Groups"});return Object(N.jsx)(te.EuiDescribedFormGroup,{title:Object(N.jsx)("h3",null,a),description:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobDetailsStep.jobGroupSelect.description",defaultMessage:" Optional grouping for jobs. New groups can be created or picked from the list of existing groups."})},Object(N.jsx)(te.EuiFormRow,{label:a,error:t.message,isInvalid:!1===t.valid},Object(N.jsx)(s.a.Fragment,null,e)))})),it=Object(n.memo)((({existingGroups:e,selectedGroups:t,onChange:a,validation:i})=>{const n=e.map((e=>({label:e,color:Object(tt.a)(e)}))),s=t.map((e=>({label:e,color:Object(tt.a)(e)})));function r(e){a(e.map((e=>e.label)))}return Object(N.jsx)(at,{validation:i},Object(N.jsx)(te.EuiComboBox,{placeholder:y.i18n.translate("xpack.ml.newJob.wizard.jobDetailsStep.jobGroupSelect.placeholder",{defaultMessage:"Select or create groups"}),options:n,selectedOptions:s,onChange:r,onCreateOption:function(e,t){const a=e.trim().toLowerCase();if(!a)return;const i={label:e,color:Object(tt.a)(e)};-1===t.findIndex((e=>e.label.trim().toLowerCase()===a))&&n.push(i),r([...s,i])},isClearable:!0,isInvalid:!i.valid,"data-test-subj":"mlJobWizardComboBoxJobGroups"}))})),nt=({setTimeRange:e,timeRange:t})=>{const a=Object(g.b)().kibanaConfig.get("dateFormat"),[i,s]=Object(n.useState)(qe()(t.start)),[r,o]=Object(n.useState)(qe()(t.end));return Object(n.useEffect)((()=>{void 0!==i&&void 0!==r&&e({start:i.valueOf(),end:r.valueOf()})}),[i,r]),Object(n.useEffect)((()=>{s(qe()(t.start)),o(qe()(t.end))}),[JSON.stringify(t)]),Object(N.jsx)(n.Fragment,null,Object(N.jsx)("div",{style:{minWidth:"512px"},"data-test-subj":"mlJobWizardDateRange"},Object(N.jsx)(te.EuiDatePickerRange,{fullWidth:!0,startDateControl:Object(N.jsx)(te.EuiDatePicker,{selected:i,onChange:function(e){s(e||void 0)},startDate:i,endDate:r,"aria-label":y.i18n.translate("xpack.ml.newJob.wizard.timeRangeStep.timeRangePicker.startDateLabel",{defaultMessage:"Start date"}),showTimeSelect:!0,dateFormat:a,maxDate:r}),endDateControl:Object(N.jsx)(te.EuiDatePicker,{selected:r,onChange:function(e){o(e||void 0)},startDate:i,endDate:r,"aria-label":y.i18n.translate("xpack.ml.newJob.wizard.timeRangeStep.timeRangePicker.endDateLabel",{defaultMessage:"End date"}),showTimeSelect:!0,dateFormat:a,minDate:i})})))},st=({setCurrentStep:e,isCurrentStep:t})=>{const{services:a}=Object(f.b)(),i=Object(g.b)(),{jobCreator:s,jobCreatorUpdate:r,jobCreatorUpdated:o,chartLoader:l,chartInterval:c}=Object(n.useContext)(Ve),[d,u]=Object(n.useState)({start:s.start,end:s.end}),[p,m]=Object(n.useState)([]),[b,h]=Object(n.useState)(!1);return Object(n.useEffect)((()=>{const{start:e,end:t}=d;s.setTimeRange(e,t),c.setBounds({min:qe()(e),max:qe()(t)});const{timefilter:i}=a.data.query.timefilter;i.setTime({from:qe()(e).toISOString(),to:qe()(t).toISOString()}),r(),async function(){h(!0);try{var e;const t=await l.loadEventRateChart(s.start,s.end,c.getInterval().asMilliseconds(),null!==(e=s.runtimeMappings)&&void 0!==e?e:void 0,s.datafeedConfig.indices_options);m(t)}catch(e){m([])}h(!1)}()}),[JSON.stringify(d)]),Object(n.useEffect)((()=>{u({start:s.start,end:s.end})}),[o]),Object(N.jsx)(n.Fragment,null,t&&Object(N.jsx)(n.Fragment,null,Object(N.jsx)(te.EuiFlexGroup,null,Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(nt,{setTimeRange:u,timeRange:d})),Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(Ze,{indexPattern:i.currentIndexPattern,query:i.combinedQuery,disabled:!1,callback:function(e){if(null!==e.start.epoch&&null!==e.end.epoch)u({start:e.start.epoch,end:e.end.epoch});else{const{toasts:e}=a.notifications;e.addDanger(y.i18n.translate("xpack.ml.newJob.wizard.timeRangeStep.fullTimeRangeError",{defaultMessage:"An error occurred obtaining the time range for the index"}))}}})),Object(N.jsx)(te.EuiFlexItem,null)),Object(N.jsx)(te.EuiSpacer,null),Object(N.jsx)(et.a,{eventRateChartData:p,height:"300px",width:"100%",showAxis:!0,loading:b}),Object(N.jsx)(He,{next:()=>e(s.type===oe.f.ADVANCED?Je.ADVANCED_CONFIGURE_DATAFEED:Je.PICK_FIELDS),nextActive:!0})))},rt=({fields:e,changeHandler:t,selectedOptions:a,removeOptions:i})=>{const{jobValidator:s,jobValidatorUpdated:r}=Object(n.useContext)(Ve),[o,l]=Object(n.useState)(s.duplicateDetectors),c=i.map(ot),d=e.map((e=>{const t={label:e.name,options:[]};return void 0!==e.aggs&&(t.options=e.aggs.filter((e=>null!==e.dslName)).map((t=>({label:`${t.title}(${e.name})`,agg:t,field:e}))).filter((e=>!1===c.includes(e.label)))),t}));return Object(n.useEffect)((()=>{l(s.duplicateDetectors)}),[r]),Object(N.jsx)(te.EuiFormRow,{error:o.message,isInvalid:!1===o.valid,"data-test-subj":"mlJobWizardAggSelection"},Object(N.jsx)(te.EuiComboBox,{singleSelection:{asPlainText:!0},options:d,selectedOptions:a,onChange:t,isClearable:!1,isInvalid:!1===o.valid}))};function ot(e){return`${e.agg.title}(${e.field.name})`}var lt=a(174),ct=a(44),dt=a(280),ut=a(117);const pt={...ut.c,area:{...ut.c.area,visible:!0},line:{...ut.c.line,strokeWidth:1,opacity:.4}},mt=({modelData:e})=>{const{MODEL_COLOR:t}=Object(ut.d)(),a=void 0===e?[]:e;return Object(N.jsx)(ct.AreaSeries,{id:"model",xScaleType:ct.ScaleType.Time,yScaleType:ct.ScaleType.Linear,xAccessor:"time",yAccessors:["modelUpper"],y0Accessors:["modelLower"],data:a,stackAccessors:["time"],curve:ct.CurveType.CURVE_MONOTONE_X,areaSeriesStyle:pt,color:t})},bt={...ut.c},ht=({chartData:e})=>{const{LINE_COLOR:t}=Object(ut.d)();return Object(N.jsx)(ct.LineSeries,{id:"line",xScaleType:ct.ScaleType.Time,yScaleType:ct.ScaleType.Linear,xAccessor:"time",yAccessors:["value"],data:e,curve:ct.CurveType.CURVE_MONOTONE_X,lineSeriesStyle:bt,color:t})},ft={...ut.c,line:{...ut.c.line,visible:!1},point:{...ut.c.point,visible:!0}},gt=({chartData:e})=>{const{LINE_COLOR:t}=Object(ut.d)();return Object(N.jsx)(ct.LineSeries,{id:"scatter",xScaleType:ct.ScaleType.Time,yScaleType:ct.ScaleType.Linear,xAccessor:"time",yAccessors:["value"],data:e,curve:ct.CurveType.CURVE_MONOTONE_X,lineSeriesStyle:ft,color:t})};var jt=a(277),xt=a(278),vt=a(262);let yt;!function(e){e[e.LINE=0]="LINE",e[e.SCATTER=1]="SCATTER"}(yt||(yt={}));const Ot=({chartType:e,chartData:t=[],modelData:a,anomalyData:i,height:n,width:s,loading:r=!1})=>{const o=e===yt.SCATTER?function(e){return e.reduce(((e,t)=>(e.push(...t.values.map((e=>({time:t.time,value:e.value})))),e)),[])}(t):t,l=Object(xt.a)(o);return Object(N.jsx)("div",{style:{width:s,height:n},"data-test-subj":`mlAnomalyChart ${yt[e]}`},Object(N.jsx)(vt.a,{height:n,hasData:o.length>0,loading:r},Object(N.jsx)(ct.Chart,null,Object(N.jsx)(ct.Settings,{xDomain:l,tooltip:ct.TooltipType.None}),Object(N.jsx)(jt.a,{chartData:o}),Object(N.jsx)(dt.a,{anomalyData:i}),Object(N.jsx)(mt,{modelData:a}),e===yt.LINE&&Object(N.jsx)(ht,{chartData:o}),e===yt.SCATTER&&Object(N.jsx)(gt,{chartData:o}))))};var Et=a(73);const wt=({setIsValid:e})=>{const{jobCreator:t,jobCreatorUpdate:a,jobCreatorUpdated:i,chartLoader:s,chartInterval:r}=Object(n.useContext)(Ve),o=t,l=Object(n.useMemo)((()=>Object(lt.b)([...Ue.b.fields,...o.runtimeFields])),[]),[c,d]=Object(n.useState)(null!==o.aggFieldPair?[{label:ot(o.aggFieldPair)}]:[]),[u,p]=Object(n.useState)(o.aggFieldPair),[m,b]=Object(n.useState)({}),[h,f]=Object(n.useState)(!1),[g,j]=Object(n.useState)(o.start),[x,v]=Object(n.useState)(o.end),[y,O]=Object(n.useState)(o.bucketSpanMs);async function E(){if(null!==u){f(!0);try{const e=Object(ut.b)(o,r),t=await s.loadLineCharts(o.start,o.end,[u],null,null,e.intervalMs,o.runtimeMappings,o.datafeedConfig.indices_options);void 0!==t[0]&&b(t)}catch(e){Object(Et.a)().displayErrorToast(e),b({})}f(!1)}}return Object(n.useEffect)((()=>{null!==u&&(o.setDetector(u.agg,u.field),a(),E(),e(null!==u))}),[u]),Object(n.useEffect)((()=>{o.start===g&&o.end===x||(j(o.start),v(o.end),E()),o.bucketSpanMs!==y&&(O(o.bucketSpanMs),E())}),[i]),Object(N.jsx)(n.Fragment,null,Object(N.jsx)(rt,{fields:l,changeHandler:function(e){if(d(e),e.length){const t=e[0];p(void 0!==t?{agg:t.agg,field:t.field}:null)}},selectedOptions:c,removeOptions:[]}),(void 0!==m[0]||!0===h)&&Object(N.jsx)(n.Fragment,null,Object(N.jsx)(Ot,{chartType:yt.LINE,chartData:m[0],modelData:[],anomalyData:[],height:"300px",width:"100%",loading:h})))},_t=()=>{const{jobCreator:e,chartLoader:t,resultsLoader:a,chartInterval:i}=Object(n.useContext)(Ve),s=e,[r,o]=Object(n.useState)({}),[l,c]=Object(n.useState)(!1),[d,u]=Object(n.useState)([]),[p,m]=Object(n.useState)([]);function b(e){const t=e.model[0];void 0!==t&&u(t);const a=e.anomalies[0];void 0!==a&&m(a)}return Object(n.useEffect)((()=>{const e=a.subscribeToResults(b);return async function(){if(null!==s.aggFieldPair){c(!0);try{const e=Object(ut.b)(s,i),a=await t.loadLineCharts(s.start,s.end,[s.aggFieldPair],null,null,e.intervalMs,s.runtimeMappings,s.datafeedConfig.indices_options);void 0!==a[0]&&o(a)}catch(e){Object(Et.a)().displayErrorToast(e),o({})}c(!1)}}(),()=>{e.unsubscribe()}}),[]),Object(N.jsx)(n.Fragment,null,(void 0!==r[0]||!0===l)&&Object(N.jsx)(n.Fragment,null,Object(N.jsx)(Ot,{chartType:yt.LINE,chartData:r[0],modelData:d,anomalyData:p,height:"300px",width:"100%",loading:l})))};var St=a(84);const Mt=({bucketSpan:e,setBucketSpan:t,isInvalid:a,disabled:i})=>Object(N.jsx)(te.EuiFieldText,{disabled:i,placeholder:y.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.bucketSpan.placeholder",{defaultMessage:"Bucket span"}),value:e,onChange:e=>t(e.target.value),isInvalid:a,"data-test-subj":"mlJobWizardInputBucketSpan"}),kt=Object(n.memo)((({children:e,validation:t})=>{const a=y.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.bucketSpan.title",{defaultMessage:"Bucket span"});return Object(N.jsx)(te.EuiDescribedFormGroup,{title:Object(N.jsx)("h3",null,a),description:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.bucketSpan.description",defaultMessage:"Set the interval for time series analysis, typically between 15m to 1h."})},Object(N.jsx)(te.EuiFormRow,{label:a,error:t.message,isInvalid:!1===t.valid},Object(N.jsx)(s.a.Fragment,null,e)))}));var Ct=a(119),Tt=a(112);let Ft;!function(e){e[e.NOT_RUNNING=0]="NOT_RUNNING",e[e.RUNNING=1]="RUNNING"}(Ft||(Ft={}));const It=({setEstimating:e})=>{const{jobCreator:t,jobCreatorUpdate:a}=Object(n.useContext)(Ve),{status:i,estimateBucketSpan:s}=function(){var e;const{jobCreator:t,jobCreatorUpdate:a}=Object(n.useContext)(Ve),i=Object(g.b)(),[s,r]=Object(n.useState)(Ft.NOT_RUNNING),o={aggTypes:t.aggregations.map((e=>e.dslName)),duration:{start:t.start,end:t.end},fields:t.fields.map((e=>e.id===Tt.a?null:e.id)),index:i.currentIndexPattern.title,query:i.combinedQuery,splitField:void 0,timeField:i.currentIndexPattern.timeFieldName,runtimeMappings:null!==(e=t.runtimeMappings)&&void 0!==e?e:void 0,indicesOptions:t.datafeedConfig.indices_options};if(Object(Fe.c)(t)&&null!==t.splitField)o.splitField=t.splitField.id;else if(Object(Fe.d)(t)&&null!==t.populationField)o.splitField=t.populationField.id;else if(Object(Fe.e)(t)){var l;o.fields=[null],t.populationField?o.splitField=t.populationField.id:o.splitField=null===(l=t.rareField)||void 0===l?void 0:l.id}else Object(Fe.a)(t)&&t.richDetectors.some((e=>null!==e.partitionField?(o.splitField=e.partitionField.id,!0):null!==e.overField?(o.splitField=e.overField.id,!0):null!==e.byField?(o.splitField=e.byField.id,!0):void 0));return{status:s,estimateBucketSpan:async function(){r(Ft.RUNNING);const{name:e,error:i,message:n}=await ge.ml.estimateBucketSpan(o);if(r(Ft.NOT_RUNNING),!0===i){const e=y.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.bucketSpanEstimator.errorTitle",{defaultMessage:"Bucket span could not be estimated"});Object(Et.a)().displayWarningToast({title:e,text:n})}else t.bucketSpan=e,a()}}}(),[r,o]=Object(n.useState)(0===t.detectors.length),[l,c]=Object(n.useState)(d());function d(){return Object(Fe.a)(t)&&t.detectors.some((e=>{if(e.partition_field_name===Ct.b||e.over_field_name===Ct.b||e.by_field_name===Ct.b)return!0}))}return Object(n.useEffect)((()=>{e(i===Ft.RUNNING)}),[i]),Object(n.useEffect)((()=>{o(0===t.detectors.length),c(d())}),[a]),Object(N.jsx)(te.EuiButton,{disabled:i===Ft.RUNNING||!0===r||!0===l,onClick:s},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.bucketSpanEstimatorButton",defaultMessage:"Estimate bucket span"}))},Dt=({setIsValid:e,hideEstimateButton:t=!1})=>{const{jobCreator:a,jobCreatorUpdate:i,jobCreatorUpdated:s,jobValidator:r,jobValidatorUpdated:o}=Object(n.useContext)(Ve),[l,c]=Object(n.useState)(a.bucketSpan),[d,u]=Object(n.useState)(r.bucketSpan),[p,m]=Object(n.useState)(!1);return Object(n.useEffect)((()=>{a.bucketSpan=l,i()}),[l]),Object(n.useEffect)((()=>{c(a.bucketSpan)}),[s]),Object(n.useEffect)((()=>{u(r.bucketSpan)}),[o]),Object(n.useEffect)((()=>{e(!1===p)}),[p]),Object(N.jsx)(kt,{validation:d},Object(N.jsx)(te.EuiFlexGroup,{gutterSize:"s"},Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(Mt,{setBucketSpan:c,bucketSpan:l,isInvalid:!1===d.valid,disabled:p})),!1===t&&Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(It,{setEstimating:m}))))},At=Object(n.memo)((({children:e})=>{const t=y.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.sparseData.title",{defaultMessage:"Sparse data"});return Object(N.jsx)(te.EuiDescribedFormGroup,{title:Object(N.jsx)("h3",null,t),description:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.sparseData.description",defaultMessage:"Select if you wish to ignore empty buckets from being considered anomalous. Available for count and sum analysis."})},Object(N.jsx)(te.EuiFormRow,{label:t},Object(N.jsx)(s.a.Fragment,null,e)))}));var Lt=a(86);const Rt=()=>{const{jobCreator:e,jobCreatorUpdated:t,jobCreatorUpdate:a}=Object(n.useContext)(Ve),[i,s]=Object(n.useState)(e.sparseData),[r,o]=Object(n.useState)(!1);return Object(n.useEffect)((()=>{e.sparseData=i,a()}),[i]),Object(n.useEffect)((()=>{const t=[Lt.a.COUNT,Lt.a.SUM],a=e.aggregations.some((e=>null!==e.dslName&&t.includes(e.dslName)));o(a),!1===a&&!0===i&&s(!1)}),[t]),Object(N.jsx)(At,null,Object(N.jsx)(te.EuiSwitch,{name:"switch",disabled:!1===r,checked:i,onChange:function(){s(!i)},"data-test-subj":"mlJobWizardSwitchSparseData",label:y.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.sparseData.title",{defaultMessage:"Sparse data"})}))},Pt=({setIsValid:e})=>{const{jobCreator:t}=Object(n.useContext)(Ve),a=Object(f.e)();return Object(N.jsx)(n.Fragment,null,Object(N.jsx)(te.EuiFlexGroup,{gutterSize:"xl"},Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(Dt,{setIsValid:e})),Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(Rt,null))),Object(N.jsx)(te.EuiFlexGroup,null,Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiButtonEmpty,{onClick:()=>{Object(St.e)(t,a)}},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.singleMetricView.convertToMultiMetricButton",defaultMessage:"Convert to multi-metric job"})))))},Nt=({isActive:e,setCanProceed:t})=>{const[a,i]=Object(n.useState)(!1),[s,r]=Object(n.useState)(!1);return Object(n.useEffect)((()=>{"function"==typeof t&&t(a&&s)}),[a,s]),Object(N.jsx)(n.Fragment,null,!1===e?Object(N.jsx)(_t,null):Object(N.jsx)(n.Fragment,null,Object(N.jsx)(wt,{setIsValid:i}),a&&Object(N.jsx)(n.Fragment,null,Object(N.jsx)(te.EuiHorizontalRule,{margin:"l"}),Object(N.jsx)(Pt,{setIsValid:r}))))},zt=({fields:e,detectorChangeHandler:t,selectedOptions:a,maxWidth:i,removeOptions:n})=>Object(N.jsx)(te.EuiFlexGroup,{style:{maxWidth:void 0!==i?i:560}},Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(te.EuiFormRow,{label:y.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.multiMetricView.addMetric",{defaultMessage:"Add metric"})},Object(N.jsx)(rt,{fields:e,changeHandler:t,selectedOptions:a,removeOptions:n})))),Bt=Object(n.memo)((({fieldValues:e,splitField:t,children:a,numberOfDetectors:i,jobType:r,animate:o=!1})=>{const l=[];return Object(N.jsx)(te.EuiFlexGroup,null,Object(N.jsx)(te.EuiFlexItem,{"data-test-subj":"mlDataSplit"},(0===e.length||0===i)&&Object(N.jsx)(s.a.Fragment,null,a),e.length>0&&i>0&&null!==t&&Object(N.jsx)(n.Fragment,null,r===oe.f.MULTI_METRIC&&Object(N.jsx)(n.Fragment,null,Object(N.jsx)("div",{style:{fontSize:"small"},"data-test-subj":`mlDataSplitTitle ${t.name}`},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.splitCards.dataSplitBy",defaultMessage:"Data split by {field}",values:{field:t.name}})),Object(N.jsx)(te.EuiSpacer,{size:"m"})),function(){l.length=0;const t=[...e];t.shift();let a=5;const i=t.map(((e,t)=>a+=10-t)).reverse();return!0===o&&setTimeout((()=>{l.forEach((e=>e.panel.style.marginBottom=`${e.marginBottom}px`))}),100),t.map(((e,a)=>{const n=-100+(a+1)*(10/t.length*1.6),s=i[a],r={height:"100px",marginBottom:"-100px",marginLeft:`${s}px`,marginRight:`${s}px`,...o?{transition:"margin 0.5s"}:{}};return Object(N.jsx)("div",{key:e,ref:e=>function(e,t){null!==e&&(!1===o&&(e.style.marginBottom=`${t}px`),l.push({panel:e,marginBottom:t}))}(e,n),style:r},Object(N.jsx)(te.EuiPanel,{paddingSize:"m",style:{paddingTop:"4px"},"data-test-subj":"mlSplitCard back"},Object(N.jsx)("div",{style:{fontWeight:"bold",fontSize:"small"},"data-test-subj":"mlSplitCardTitle"},e)))}))}(),Object(N.jsx)(te.EuiPanel,{paddingSize:"m",style:{paddingTop:"4px"},"data-test-subj":"mlSplitCard front"},Object(N.jsx)("div",{style:{fontWeight:"bold",fontSize:"small"},"data-test-subj":"mlSplitCardTitle"},e[0]),Object(N.jsx)(te.EuiHorizontalRule,{margin:"s"}),Object(N.jsx)(s.a.Fragment,null,a)))))}));function Jt(){const[e,t]=Object(n.useState)(!1);return Object(n.useEffect)((()=>{setTimeout((()=>{t(!0)}),1e3)}),[]),e}const Vt=({index:e,agg:t,field:a,byField:i,deleteDetector:n,children:s})=>{const r=!1===s&&void 0!==i?i.field:null;return Object(N.jsx)(te.EuiFlexGroup,{gutterSize:"s",justifyContent:"spaceBetween"},Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)("span",{style:{fontSize:"small"},"data-test-subj":"mlDetectorTitle"},function(e,t,a){const i=`${e.title}(${t.name})`;return null===a?i:y.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.detectorTitle.placeholder",{defaultMessage:"{title} split by {field}",values:{title:i,field:a.name}})}(t,a,r))),!1!==s&&Object(N.jsx)(te.EuiFlexItem,{style:{width:"100%",maxWidth:"400px"}},s),Object(N.jsx)(te.EuiFlexItem,{grow:!1},void 0!==n&&Object(N.jsx)(te.EuiButtonIcon,{color:"danger",onClick:()=>n(e),iconType:"cross",size:"s","aria-label":"Next"})))};const Ut=({aggFieldPairList:e,chartSettings:t,splitField:a,fieldValues:i,lineChartsData:s,modelData:r,anomalyData:o,deleteDetector:l,jobType:c,loading:d=!1})=>{const u=Jt();return Object(N.jsx)(Bt,{fieldValues:i,splitField:a,numberOfDetectors:e.length,jobType:c,animate:u},Object(N.jsx)(te.EuiFlexGrid,{columns:t.cols},e.map(((a,i)=>Object(N.jsx)(te.EuiFlexItem,{key:i,"data-test-subj":`mlDetector ${i}`},Object(N.jsx)(n.Fragment,null,Object(N.jsx)(Vt,{index:i,agg:e[i].agg,field:e[i].field,deleteDetector:l}),Object(N.jsx)(Ot,{chartType:yt.LINE,chartData:s[i],modelData:r[i],anomalyData:o[i],height:t.height,width:t.width,loading:d})))))))},Gt=({setIsValid:e})=>{const{jobCreator:t,jobCreatorUpdate:a,jobCreatorUpdated:i,chartLoader:s,chartInterval:r}=Object(n.useContext)(Ve),o=t,l=Object(n.useMemo)((()=>Object(lt.b)([...Ue.b.fields,...o.runtimeFields])),[]),[c,d]=Object(n.useState)([]),[u,p]=Object(n.useState)(o.aggFieldPairs),[m,b]=Object(n.useState)({}),[h,f]=Object(n.useState)(!1),[g,j]=Object(n.useState)(o.start),[x,v]=Object(n.useState)(o.end),[y,O]=Object(n.useState)(o.bucketSpanMs),[E,w]=Object(n.useState)(ut.a),[_,S]=Object(n.useState)(o.splitField),[M,k]=Object(n.useState)([]),[C,T]=Object(n.useState)(!1);async function F(){if(C&&u.length>0&&(null===_||null!==_&&M.length>0)){f(!0);try{const e=Object(ut.b)(o,r);w(e);const t=await s.loadLineCharts(o.start,o.end,u,o.splitField,M.length>0?M[0]:null,e.intervalMs,o.runtimeMappings,o.datafeedConfig.indices_options);b(t)}catch(e){Object(Et.a)().displayErrorToast(e),b([])}f(!1)}}return Object(n.useEffect)((()=>{T(!0)}),[]),Object(n.useEffect)((()=>{o.removeAllDetectors(),u.forEach((e=>{o.addDetector(e.agg,e.field)})),a(),F(),e(u.length>0)}),[u.length]),Object(n.useEffect)((()=>{o.start===g&&o.end===x||(j(o.start),v(o.end),F()),o.bucketSpanMs!==y&&(O(o.bucketSpanMs),F()),S(o.splitField)}),[i]),Object(n.useEffect)((()=>{null!==_?s.loadFieldExampleValues(_,o.runtimeMappings,o.datafeedConfig.indices_options).then(k).catch((e=>{Object(Et.a)().displayErrorToast(e)})):k([])}),[_]),Object(n.useEffect)((()=>{F()}),[M]),Object(N.jsx)(n.Fragment,null,Object(N.jsx)(Ut,{aggFieldPairList:u,chartSettings:E,splitField:_,fieldValues:M,lineChartsData:m,modelData:[],anomalyData:[],deleteDetector:function(e){u.splice(e,1),p([...u])},jobType:o.type,loading:h}),Object(N.jsx)(zt,{fields:l,detectorChangeHandler:function(e){!function(e){if(null!==e&&e.length){const t=e[0];if(void 0!==t){const e={agg:t.agg,field:t.field};p([...u,e]),d([])}else p([])}}(e)},selectedOptions:c,removeOptions:u}))},qt=()=>{const{jobCreator:e,chartLoader:t,resultsLoader:a,chartInterval:i}=Object(n.useContext)(Ve),s=e,[r,o]=Object(n.useState)({}),[l,c]=Object(n.useState)(!1),[d,u]=Object(n.useState)([]),[p,m]=Object(n.useState)([]),[b,h]=Object(n.useState)(ut.a),[f,g]=Object(n.useState)([]);function j(e){u(e.model),m(e.anomalies)}function x(){return s.aggFieldPairs.length>0&&(null===s.splitField||null!==s.splitField&&f.length>0)}return Object(n.useEffect)((()=>{const e=a.subscribeToResults(j);return(async()=>{if(null!==s.splitField)try{const e=await t.loadFieldExampleValues(s.splitField,s.runtimeMappings,s.datafeedConfig.indices_options);g(e)}catch(e){Object(Et.a)().displayErrorToast(e)}})(),()=>{e.unsubscribe()}}),[]),Object(n.useEffect)((()=>{x()&&async function(){if(x()){c(!0);try{const e=Object(ut.b)(s,i);h(e);const a=await t.loadLineCharts(s.start,s.end,s.aggFieldPairs,s.splitField,f.length>0?f[0]:null,e.intervalMs,s.runtimeMappings,s.datafeedConfig.indices_options);o(a)}catch(e){Object(Et.a)().displayErrorToast(e),o({})}c(!1)}}()}),[f]),Object(N.jsx)(n.Fragment,null,Object.keys(r).length&&Object(N.jsx)(Ut,{aggFieldPairList:s.aggFieldPairs,chartSettings:b,splitField:s.splitField,fieldValues:f,lineChartsData:r,modelData:d,anomalyData:p,deleteDetector:void 0,jobType:s.type,loading:l}))},Ht=({fields:e,changeHandler:t,selectedField:a,isClearable:i,testSubject:n,placeholder:s})=>{const r=e.map((e=>({label:e.name,field:e}))),o=[];return null!==a&&o.push({label:a.name,field:a}),Object(N.jsx)(te.EuiComboBox,{singleSelection:{asPlainText:!0},options:r,selectedOptions:o,onChange:function(e){const a=e[0];t(void 0!==a?a.field:null)},isClearable:i,placeholder:s,"data-test-subj":n})},Wt=Object(n.memo)((({children:e})=>{const t=y.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.splitField.title",{defaultMessage:"Split field"});return Object(N.jsx)(te.EuiDescribedFormGroup,{title:Object(N.jsx)("h3",null,t),description:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.splitField.description",defaultMessage:"Select a field to split analysis by. Each value of this field will be modeled independently."})},Object(N.jsx)(te.EuiFormRow,{label:t},Object(N.jsx)(s.a.Fragment,null,e)))})),$t=()=>{const{jobCreator:e,jobCreatorUpdate:t,jobCreatorUpdated:a}=Object(n.useContext)(Ve),i=e,s=Object(n.useMemo)((()=>Object(Ue.a)(i.runtimeFields)),[]),r=function(e,t,a){const[i,s]=Object(n.useState)(e);return Object(n.useEffect)((()=>{if(Object(Fe.c)(t))s(e);else{const a=t.rareField,i=t.populationField;s(null!==a||null!==i?e.filter((({name:e})=>e!==(null==a?void 0:a.name)&&e!==(null==i?void 0:i.name))):e)}}),[a]),i}(Object(n.useMemo)((()=>[...Ue.b.categoryFields,...s]),[]),i,a),[o,l]=Object(n.useState)(i.splitField);return Object(n.useEffect)((()=>{i.setSplitField(o),null!==o&&!1===i.influencers.includes(o.name)&&i.addInfluencer(o.name),t()}),[o]),Object(n.useEffect)((()=>{l(i.splitField)}),[a]),Object(N.jsx)(Wt,null,Object(N.jsx)(Ht,{fields:r,changeHandler:l,selectedField:o,isClearable:!0,testSubject:"mlMultiMetricSplitFieldSelect"}))};const Yt=({fields:e,changeHandler:t,selectedInfluencers:a})=>{const{jobCreator:i}=Object(n.useContext)(Ve),s=[...Object(St.g)(e,i.additionalFields),...Object(St.h)(i.categorizationFieldName)],r=a.map((e=>({label:e})));return Object(N.jsx)(te.EuiComboBox,{options:s,selectedOptions:r,onChange:function(e){t(e.map((e=>e.label)))},isClearable:!1,"data-test-subj":"mlInfluencerSelect"})},Xt=Object(n.memo)((({children:e})=>{const t=y.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.influencers.title",{defaultMessage:"Influencers"});return Object(N.jsx)(te.EuiDescribedFormGroup,{title:Object(N.jsx)("h3",null,t),description:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.influencers.description",defaultMessage:"Select which categorical fields have influence on the results. Who/what might you 'blame' for an anomaly? Recommend 1-3 influencers."})},Object(N.jsx)(te.EuiFormRow,{label:t},Object(N.jsx)(s.a.Fragment,null,e)))})),Qt=()=>{const{jobCreator:e,jobCreatorUpdate:t,jobCreatorUpdated:a}=Object(n.useContext)(Ve),i=e,{fields:s}=Ue.b,[r,o]=Object(n.useState)([...i.influencers]);return Object(n.useEffect)((()=>{i.removeAllInfluencers(),r.forEach((e=>i.addInfluencer(e))),t()}),[r.join()]),Object(n.useEffect)((()=>{o([...i.influencers])}),[a]),Object(N.jsx)(Xt,null,Object(N.jsx)(Yt,{fields:s,changeHandler:o,selectedInfluencers:r}))},Kt=({setIsValid:e})=>Object(N.jsx)(n.Fragment,null,Object(N.jsx)(te.EuiFlexGroup,{gutterSize:"xl"},Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)($t,null)),Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(Qt,null))),Object(N.jsx)(te.EuiFlexGroup,{gutterSize:"xl"},Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(Dt,{setIsValid:e})),Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(Rt,null)))),Zt=({isActive:e,setCanProceed:t})=>{const[a,i]=Object(n.useState)(!1),[s,r]=Object(n.useState)(!1);return Object(n.useEffect)((()=>{"function"==typeof t&&t(a&&s)}),[a,s]),Object(N.jsx)(n.Fragment,null,!1===e?Object(N.jsx)(qt,null):Object(N.jsx)(n.Fragment,null,Object(N.jsx)(Gt,{setIsValid:i}),a&&Object(N.jsx)(n.Fragment,null,Object(N.jsx)(te.EuiHorizontalRule,{margin:"l"}),Object(N.jsx)(Kt,{setIsValid:r}))))},ea=({fields:e,detectorChangeHandler:t,selectedOptions:a,maxWidth:i,removeOptions:n})=>Object(N.jsx)(te.EuiFlexGroup,{style:{maxWidth:void 0!==i?i:560}},Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(te.EuiFormRow,{label:y.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.populationView.addMetric",{defaultMessage:"Add metric"})},Object(N.jsx)(rt,{fields:e,changeHandler:t,selectedOptions:a,removeOptions:n})))),ta=Object(n.memo)((({children:e})=>{const t=y.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.populationField.title",{defaultMessage:"Population field"});return Object(N.jsx)(te.EuiDescribedFormGroup,{title:Object(N.jsx)("h3",null,t),description:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.populationField.description",defaultMessage:"All values in the selected field will be modeled together as a population. This analysis type is recommended for high cardinality data."})},Object(N.jsx)(te.EuiFormRow,{label:t},Object(N.jsx)(s.a.Fragment,null,e)))})),aa=()=>{const{jobCreator:e,jobCreatorUpdate:t,jobCreatorUpdated:a}=Object(n.useContext)(Ve),i=e,s=Object(n.useMemo)((()=>Object(Ue.a)(i.runtimeFields)),[]),r=function(e,t,a){const[i,s]=Object(n.useState)(e);return Object(n.useEffect)((()=>{if(Object(Fe.d)(t))s(e);else{const a=t.rareField,i=t.splitField;s(null!==a||null!==i?e.filter((({name:e})=>e!==(null==a?void 0:a.name)&&e!==(null==i?void 0:i.name))):e)}}),[a]),i}(Object(n.useMemo)((()=>[...Ue.b.categoryFields,...s]),[]),i,a),[o,l]=Object(n.useState)(i.populationField);return Object(n.useEffect)((()=>{i.setPopulationField(o),null!==o&&!1===i.influencers.includes(o.name)&&i.addInfluencer(o.name),t()}),[o]),Object(n.useEffect)((()=>{l(i.populationField)}),[a]),Object(N.jsx)(ta,null,Object(N.jsx)(Ht,{fields:r,changeHandler:l,selectedField:o,isClearable:!1,testSubject:"mlPopulationSplitFieldSelect"}))};const ia=({detectorIndex:e})=>{const{jobCreator:t,jobCreatorUpdate:a,jobCreatorUpdated:i}=Object(n.useContext)(Ve),s=t,r=Object(n.useMemo)((()=>Object(Ue.a)(s.runtimeFields)),[]),o=Object(n.useMemo)((()=>[...Ue.b.categoryFields,...r]),[]),[l,c]=Object(n.useState)(s.getByField(e)),d=function(e,t,a){const[i,s]=Object(n.useState)(e);return Object(n.useEffect)((()=>{const a=t.populationField;s(null!==a?e.filter((({name:e})=>e!==a.name)):e)}),[a]),i}(o,s,i);return Object(n.useEffect)((()=>{s.setByField(l,e),null!==l&&!1===s.influencers.includes(l.name)&&s.addInfluencer(l.name),a()}),[l]),Object(n.useEffect)((()=>{const t=s.getByField(e);c(t)}),[i]),Object(N.jsx)(Ht,{fields:d,changeHandler:c,selectedField:l,isClearable:!0,testSubject:"mlByFieldSelect",placeholder:y.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.populationField.placeholder",{defaultMessage:"Split data"})})};const na=({aggFieldPairList:e,chartSettings:t,splitField:a,lineChartsData:i,modelData:s,anomalyData:r,deleteDetector:o,jobType:l,fieldValuesPerDetector:c,loading:d=!1})=>{const u=Jt();return Object(N.jsx)(te.EuiFlexGrid,{columns:t.cols},e.map(((p,m)=>Object(N.jsx)(te.EuiFlexItem,{key:m,"data-test-subj":`mlDetector ${m}`},Object(N.jsx)(n.Fragment,null,Object(N.jsx)(te.EuiFlexGroup,null,Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(Vt,{index:m,agg:e[m].agg,field:e[m].field,byField:e[m].by,deleteDetector:o},void 0!==o&&Object(N.jsx)(ia,{detectorIndex:m})),l===oe.f.POPULATION&&Object(N.jsx)(te.EuiSpacer,{size:"s"}))),Object(N.jsx)(Bt,{fieldValues:c[m]||[],splitField:a,numberOfDetectors:e.length,jobType:l,animate:u},Object(N.jsx)(Ot,{chartType:yt.SCATTER,chartData:i[m],modelData:s[m],anomalyData:r[m],height:t.height,width:t.width,loading:d})))))))},sa=({setIsValid:e})=>{const{jobCreator:t,jobCreatorUpdate:a,jobCreatorUpdated:i,chartLoader:s,chartInterval:r}=Object(n.useContext)(Ve),o=t,l=Object(n.useMemo)((()=>Object(lt.b)([...Ue.b.fields,...o.runtimeFields])),[]),[c,d]=Object(n.useState)([]),[u,p]=Object(n.useState)(o.aggFieldPairs),[m,b]=Object(n.useState)({}),[h,f]=Object(n.useState)(!1),[g,j]=Object(n.useState)(o.start),[x,v]=Object(n.useState)(o.end),[y,O]=Object(n.useState)(o.bucketSpanMs),[E,w]=Object(n.useState)(ut.a),[_,S]=Object(n.useState)(o.populationField),[M,k]=Object(n.useState)({}),[C,T]=Object(n.useReducer)((e=>e+1),0),[F,I]=Object(n.useState)(!1),D=()=>T(0);async function A(){if(function(){let e=u.length>0;return u.forEach((t=>{void 0!==t.by&&null!==t.by.field&&(e=e&&null!==t.by.value)})),e}()){f(!0);try{const e=Object(ut.b)(o,r);w(e);const t=await s.loadPopulationCharts(o.start,o.end,u,o.populationField,e.intervalMs,o.runtimeMappings,o.datafeedConfig.indices_options);b(t)}catch(e){Object(Et.a)().displayErrorToast(e),b([])}f(!1)}}return Object(n.useEffect)((()=>{I(!0)}),[]),Object(n.useEffect)((()=>{o.removeAllDetectors(),u.forEach(((e,t)=>{o.addDetector(e.agg,e.field),void 0!==e.by&&o.setByField(e.by.field,t)})),a(),A(),e(u.length>0)}),[u.length]),Object(n.useEffect)((()=>{A()}),[JSON.stringify(M),_,F]),Object(n.useEffect)((()=>{o.start===g&&o.end===x||(j(o.start),v(o.end),A()),o.bucketSpanMs!==y&&(O(o.bucketSpanMs),A()),S(o.populationField);let e=!1;const t=[...u];t.forEach(((t,a)=>{const i=o.getByField(a);void 0!==t.by&&t.by.field!==i&&(t.by.field=i,e=!0)})),e&&(p(t),D())}),[i]),Object(n.useEffect)((()=>{!async function(){const e=[];u.forEach(((t,a)=>{void 0!==t.by&&null!==t.by.field&&e.push((async(e,t)=>({index:e,fields:await s.loadFieldExampleValues(t,o.runtimeMappings,o.datafeedConfig.indices_options)}))(a,t.by.field))}));const t=(await Promise.all(e)).reduce(((e,t)=>(e[t.index]=t.fields,e)),{}),a=u.map(((e,a)=>({...e,...void 0===e.by||null===e.by.field?{}:{by:{...e.by,value:t[a][0]}}})));p([...a]),k(t)}()}),[_,C]),Object(N.jsx)(n.Fragment,null,Object(N.jsx)(aa,null),null!==_&&Object(N.jsx)(te.EuiHorizontalRule,{margin:"l"}),null!==_&&Object(N.jsx)(na,{aggFieldPairList:u,chartSettings:E,splitField:_,lineChartsData:m,modelData:[],anomalyData:[],deleteDetector:function(e){u.splice(e,1),p([...u]),D()},jobType:o.type,fieldValuesPerDetector:M,loading:h}),null!==_&&Object(N.jsx)(ea,{fields:l,detectorChangeHandler:function(e){!function(e){if(null!==e&&e.length){const t=e[0];if(void 0!==t){const e={agg:t.agg,field:t.field,by:{field:null,value:null}};p([...u,e]),d([])}else p([])}}(e)},selectedOptions:c,removeOptions:[]}))},ra=()=>{const{jobCreator:e,chartLoader:t,resultsLoader:a,chartInterval:i}=Object(n.useContext)(Ve),s=e,[r,o]=Object(n.useState)(s.aggFieldPairs),[l,c]=Object(n.useState)({}),[d,u]=Object(n.useState)(!1),[p,m]=Object(n.useState)([]),[b,h]=Object(n.useState)([]),[f,g]=Object(n.useState)(ut.a),[j,x]=Object(n.useState)({});function v(e){m(e.model),h(e.anomalies)}function y(){let e=r.length>0;return r.forEach((t=>{void 0!==t.by&&null!==t.by.field&&(e=e&&null!==t.by.value)})),e}return Object(n.useEffect)((()=>{const e=a.subscribeToResults(v);return()=>{e.unsubscribe()}}),[]),Object(n.useEffect)((()=>{y()&&async function(){if(y()){u(!0);try{const e=Object(ut.b)(s,i);g(e);const a=await t.loadPopulationCharts(s.start,s.end,r,s.populationField,e.intervalMs,s.runtimeMappings,s.datafeedConfig.indices_options);c(a)}catch(e){Object(Et.a)().displayErrorToast(e),c({})}u(!1)}}()}),[JSON.stringify(j),s.populationField]),Object(n.useEffect)((()=>{!async function(){const e=[];r.forEach(((a,i)=>{void 0!==a.by&&null!==a.by.field&&e.push((async(e,a)=>({index:e,fields:await t.loadFieldExampleValues(a,s.runtimeMappings,s.datafeedConfig.indices_options)}))(i,a.by.field))}));const a=(await Promise.all(e)).reduce(((e,t)=>(e[t.index]=t.fields,e)),{}),i=r.map(((e,t)=>({...e,...void 0===e.by||null===e.by.field?{}:{by:{...e.by,value:a[t][0]}}})));o([...i]),x(a)}()}),[s.populationField]),Object(N.jsx)(n.Fragment,null,null!==s.populationField&&Object(N.jsx)(n.Fragment,null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.populationView.splitFieldTitle",defaultMessage:"Population split by {field}",values:{field:s.populationField.name}}),Object(N.jsx)(te.EuiSpacer,null),Object(N.jsx)(na,{aggFieldPairList:s.aggFieldPairs,chartSettings:f,splitField:s.populationField,lineChartsData:l,modelData:p,anomalyData:b,jobType:s.type,fieldValuesPerDetector:j,loading:d})))},oa=({setIsValid:e})=>Object(N.jsx)(n.Fragment,null,Object(N.jsx)(te.EuiFlexGroup,{gutterSize:"xl"},Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(Dt,{setIsValid:e})),Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(Qt,null)))),la=({isActive:e,setCanProceed:t})=>{const[a,i]=Object(n.useState)(!1),[s,r]=Object(n.useState)(!1);return Object(n.useEffect)((()=>{"function"==typeof t&&t(a&&s)}),[a,s]),Object(N.jsx)(n.Fragment,null,!1===e?Object(N.jsx)(ra,null):Object(N.jsx)(n.Fragment,null,Object(N.jsx)(sa,{setIsValid:i}),a&&Object(N.jsx)(n.Fragment,null,Object(N.jsx)(te.EuiHorizontalRule,{margin:"l"}),Object(N.jsx)(oa,{setIsValid:r}))))},ca=({onCreateClick:e,closeModal:t,saveEnabled:a,children:i})=>Object(N.jsx)(te.EuiModal,{onClose:t,maxWidth:1200,"data-test-subj":"mlCreateDetectorModal"},Object(N.jsx)(te.EuiModalHeader,null,Object(N.jsx)(te.EuiModalHeaderTitle,null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.advancedDetectorModal.title",defaultMessage:"Create detector"}))),Object(N.jsx)(te.EuiModalBody,null,i),Object(N.jsx)(te.EuiModalFooter,null,Object(N.jsx)(te.EuiButtonEmpty,{onClick:t,"data-test-subj":"mlCreateDetectorModalCancelButton"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.advancedDetectorModal.cancelButton",defaultMessage:"Cancel"})),Object(N.jsx)(te.EuiButton,{onClick:e,isDisabled:!1===a,fill:!0,"data-test-subj":"mlCreateDetectorModalSaveButton"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.advancedDetectorModal.saveButton",defaultMessage:"Save"}))));var da=a(88),ua=a(138);const pa=Object(n.memo)((({children:e})=>{const t=y.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.advancedDetectorModal.aggSelect.title",{defaultMessage:"Function"});return Object(N.jsx)(te.EuiDescribedFormGroup,{title:Object(N.jsx)("h3",null,t),description:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.advancedDetectorModal.aggSelect.description",defaultMessage:"Analysis functions to be performed e.g. sum, count."})},Object(N.jsx)(te.EuiFormRow,{label:t},Object(N.jsx)(s.a.Fragment,null,e)))})),ma=Object(n.memo)((({children:e})=>{const t=y.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.advancedDetectorModal.fieldSelect.title",{defaultMessage:"Field"});return Object(N.jsx)(te.EuiDescribedFormGroup,{title:Object(N.jsx)("h3",null,t),description:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.advancedDetectorModal.fieldSelect.description",defaultMessage:"Required for functions: sum, mean, median, max, min, info_content, distinct_count, lat_long."})},Object(N.jsx)(te.EuiFormRow,{label:t},Object(N.jsx)(s.a.Fragment,null,e)))})),ba=Object(n.memo)((({children:e})=>{const t=y.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.advancedDetectorModal.byFieldSelect.title",{defaultMessage:"By field"});return Object(N.jsx)(te.EuiDescribedFormGroup,{title:Object(N.jsx)("h3",null,t),description:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.advancedDetectorModal.byFieldSelect.description",defaultMessage:"Required for individual analysis where anomalies are detected compared to an entity's own past behavior."})},Object(N.jsx)(te.EuiFormRow,{label:t},Object(N.jsx)(s.a.Fragment,null,e)))})),ha=Object(n.memo)((({children:e})=>{const t=y.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.advancedDetectorModal.overFieldSelect.title",{defaultMessage:"Over field"});return Object(N.jsx)(te.EuiDescribedFormGroup,{title:Object(N.jsx)("h3",null,t),description:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.advancedDetectorModal.overFieldSelect.description",defaultMessage:"Required for population analysis where anomalies are detected compared to the behavior of the population."})},Object(N.jsx)(te.EuiFormRow,{label:t},Object(N.jsx)(s.a.Fragment,null,e)))})),fa=Object(n.memo)((({children:e})=>{const t=y.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.advancedDetectorModal.partitionFieldSelect.title",{defaultMessage:"Partition field"});return Object(N.jsx)(te.EuiDescribedFormGroup,{title:Object(N.jsx)("h3",null,t),description:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.advancedDetectorModal.partitionFieldSelect.description",defaultMessage:"Allows segmentation of modeling into logical groups."})},Object(N.jsx)(te.EuiFormRow,{label:t},Object(N.jsx)(s.a.Fragment,null,e)))})),ga=Object(n.memo)((({children:e})=>{const t=y.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.advancedDetectorModal.excludeFrequent.title",{defaultMessage:"Exclude frequent"});return Object(N.jsx)(te.EuiDescribedFormGroup,{title:Object(N.jsx)("h3",null,t),description:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.advancedDetectorModal.excludeFrequent.description",defaultMessage:"If set, it will automatically identify and exclude frequently occurring entities which may otherwise have dominated results."})},Object(N.jsx)(te.EuiFormRow,{label:t},Object(N.jsx)(s.a.Fragment,null,e)))})),ja=Object(n.memo)((({children:e})=>{const t=y.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.advancedDetectorModal.description.title",{defaultMessage:"Description"});return Object(N.jsx)(te.EuiDescribedFormGroup,{fullWidth:!0,title:Object(N.jsx)("h3",null,t),description:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.advancedDetectorModal.description.description",defaultMessage:"Override the default detector description with a meaningful description of what the detector is analyzing."})},Object(N.jsx)(te.EuiFormRow,{label:t,fullWidth:!0},Object(N.jsx)(s.a.Fragment,null,e)))})),xa={label:""},va=[{label:"all"},{label:"none"},{label:"by"},{label:"over"}],ya=({payload:e,fields:t,aggs:a,detectorChangeHandler:i,closeModal:s})=>{const{jobCreator:r}=Object(n.useContext)(Ve),o=r,[l,c]=Object(n.useState)(e.detector),[d,u]=Object(n.useState)(Oa(l.agg)),[p,m]=Object(n.useState)(Ea(l.field)),[b,h]=Object(n.useState)(Ea(l.byField)),[f,g]=Object(n.useState)(Ea(l.overField)),[j,x]=Object(n.useState)(Ea(l.partitionField)),[v,y]=Object(n.useState)(function(e){if(null===e)return xa;return{label:e}}(l.excludeFrequent)),[O,E]=Object(n.useState)(l.description||""),[w,_]=Object(n.useState)(!0),[S,M]=Object(n.useState)(!0),[k,C]=Object(n.useState)(!0),{descriptionPlaceholder:T,setDescriptionPlaceholder:F}=function(e){const[t,a]=Object(n.useState)(Sa(e));function i(e){a(Sa(e))}return{descriptionPlaceholder:t,setDescriptionPlaceholder:i}}(l),I=o.additionalFields.length>0,D=a.filter((e=>function(e,t){return void 0!==e.fields&&(t||e.fields.length)}(e,I))).map(Oa),{currentFieldOptions:A,setCurrentFieldOptions:L}=function(e,t,a){const[i,s]=Object(n.useState)(_a(e,t));return{currentFieldOptions:i,setCurrentFieldOptions:e=>s(_a(e,t))}}(l.agg,o.additionalFields),R=[...[...Object(St.g)(t,o.additionalFields)].sort(ka),...Object(St.h)(o.categorizationFieldName)].sort(ka),P=t.find((e=>e.id===Tt.a)),z=e=>t=>{e(t[0]||xa)};function B(e){return a.find((t=>t.id===e))||null}function J(e){return e===Tt.c.id?Tt.c:t.find((t=>t.id===e))||o.additionalFields.find((t=>t.id===e))||null}return Object(n.useEffect)((()=>{const e=B(d.label);let t=J(p.label);const a=J(b.label),i=J(f.label),n=J(j.label);null!==e?(L(e),wa(e)&&void 0!==P?(_(!0),m(xa),C(!1),t=P):(_(null!==t),C(!0)),M(null!==a||null!==i)):(_(!1),C(!1));const s={agg:e,field:t,byField:a,overField:i,partitionField:n,excludeFrequent:""!==v.label?v.label:null,description:""!==O?O:null,customRules:null,useNull:null};c(s),F(s)}),[d,p,b,f,j,v,O]),Object(n.useEffect)((()=>{const e=B(d.label);if(_(""!==d.label),null!==e){C(!1===wa(e));const t=J(b.label),a=J(f.label);M(null!==t||null!==a)}}),[]),Object(n.useEffect)((()=>{!1===S&&y(xa)}),[S]),Object(N.jsx)(ca,{onCreateClick:function(){i(l,e.index)},closeModal:s,saveEnabled:w&&(!1===k||!0===k&&""!==p.label)},Object(N.jsx)(n.Fragment,null,Object(N.jsx)(te.EuiFlexGroup,null,Object(N.jsx)(te.EuiFlexItem,{"data-test-subj":"mlAdvancedFunctionSelect"},Object(N.jsx)(pa,null,Object(N.jsx)(te.EuiComboBox,{singleSelection:{asPlainText:!0},options:D,selectedOptions:Ma(d,D),onChange:z(u),isClearable:!0}))),Object(N.jsx)(te.EuiFlexItem,{"data-test-subj":"mlAdvancedFieldSelect"},Object(N.jsx)(ma,null,Object(N.jsx)(te.EuiComboBox,{singleSelection:{asPlainText:!0},options:A,selectedOptions:Ma(p,A),onChange:z(m),isClearable:!0,isDisabled:!1===k})))),Object(N.jsx)(te.EuiHorizontalRule,{margin:"l"}),Object(N.jsx)(te.EuiFlexGrid,{columns:2},Object(N.jsx)(te.EuiFlexItem,{"data-test-subj":"mlAdvancedByFieldSelect"},Object(N.jsx)(ba,null,Object(N.jsx)(te.EuiComboBox,{singleSelection:{asPlainText:!0},options:R,selectedOptions:Ma(b,R),onChange:z(h),isClearable:!0,isDisabled:!1===w}))),Object(N.jsx)(te.EuiFlexItem,{"data-test-subj":"mlAdvancedOverFieldSelect"},Object(N.jsx)(ha,null,Object(N.jsx)(te.EuiComboBox,{singleSelection:{asPlainText:!0},options:R,selectedOptions:Ma(f,R),onChange:z(g),isClearable:!0,isDisabled:!1===w}))),Object(N.jsx)(te.EuiFlexItem,{"data-test-subj":"mlAdvancedPartitionFieldSelect"},Object(N.jsx)(fa,null,Object(N.jsx)(te.EuiComboBox,{singleSelection:{asPlainText:!0},options:R,selectedOptions:Ma(j,R),onChange:z(x),isClearable:!0,isDisabled:!1===w}))),Object(N.jsx)(te.EuiFlexItem,{"data-test-subj":"mlAdvancedExcludeFrequentSelect"},Object(N.jsx)(ga,null,Object(N.jsx)(te.EuiComboBox,{singleSelection:{asPlainText:!0},options:va,selectedOptions:Ma(v,va),onChange:z(y),isClearable:!0,isDisabled:!1===w||!1===S})))),Object(N.jsx)(te.EuiHorizontalRule,{margin:"l"}),Object(N.jsx)(te.EuiFlexGroup,null,Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(ja,null,Object(N.jsx)(te.EuiTextArea,{rows:2,fullWidth:!0,placeholder:T,value:O,onChange:e=>E(e.target.value),"data-test-subj":"mlAdvancedDetectorDescriptionInput"}))))))};function Oa(e){return null===e?xa:{label:e.id}}function Ea(e){return null===e?xa:{label:e.name}}function wa(e){return e.fields&&1===e.fields.length&&e.fields[0].id===Tt.a}function _a(e,t){return Object(St.g)(null!==e&&void 0!==e.fields?e.fields:[],t)}function Sa(e){if(null===e.agg||null===e.field)return"";const t=Object(ua.a)(e.agg,e.field);return t.by_field_name=e.byField?e.byField.id:void 0,t.over_field_name=e.overField?e.overField.id:void 0,t.partition_field_name=e.partitionField?e.partitionField.id:void 0,t.exclude_frequent=e.excludeFrequent?e.excludeFrequent:void 0,Object(da.b)(t)}function Ma(e,t){return 1===t.length&&t[0].label!==e.label||""===e.label?[]:[e]}function ka(e,t){return e.label.localeCompare(t.label)}const Ca=({payload:e,fields:t,aggs:a,detectorChangeHandler:i,closeModal:s,showModal:r})=>Object(N.jsx)(n.Fragment,null,Object(N.jsx)(te.EuiFlexGroup,{style:{maxWidth:560}},Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(te.EuiFormRow,null,Object(N.jsx)(te.EuiButton,{onClick:r,"data-test-subj":"mlAddDetectorButton"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.addDetectorButton",defaultMessage:"Add detector"}))))),null!==e&&Object(N.jsx)(ya,{payload:e,fields:t,aggs:a,detectorChangeHandler:i,closeModal:s})),Ta=({isActive:e,onEditJob:t,onDeleteJob:a})=>{const{jobCreator:i,jobCreatorUpdated:s,jobValidator:r,jobValidatorUpdated:o}=Object(n.useContext)(Ve),l=i,[c,d]=Object(n.useState)(l.detectors),[u,p]=Object(n.useState)(r.duplicateDetectors);Object(n.useEffect)((()=>{d(l.detectors)}),[s]),Object(n.useEffect)((()=>{r.duplicateDetectors.valid||p(r.duplicateDetectors),r.categorizerVaryingPerPartitionField.valid||p(r.categorizerVaryingPerPartitionField),r.categorizerMissingPerPartition.valid||p(r.categorizerMissingPerPartition)}),[o]);const m=({index:e})=>Object(N.jsx)(te.EuiFlexGroup,{gutterSize:"s"},Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(te.EuiButtonIcon,{color:"primary",onClick:()=>t(e),iconType:"pencil","aria-label":y.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.advancedDetectorList.editButton",{defaultMessage:"Edit"}),"data-test-subj":"mlAdvancedDetectorEditButton"})),Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(te.EuiButtonIcon,{color:"danger",onClick:()=>a(e),iconType:"trash","aria-label":y.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.advancedDetectorList.deleteButton",{defaultMessage:"Delete"}),"data-test-subj":"mlAdvancedDetectorDeleteButton"})));return Object(N.jsx)(n.Fragment,null,Object(N.jsx)(te.EuiTitle,{size:"xs"},Object(N.jsx)("h3",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.advancedDetectorList.title",defaultMessage:"Detectors"}))),Object(N.jsx)(Fa,{show:0===c.length}),Object(N.jsx)(te.EuiSpacer,{size:"m"}),Object(N.jsx)(te.EuiFlexGrid,{columns:3},c.map(((t,a)=>Object(N.jsx)(te.EuiFlexItem,{key:a,"data-test-subj":`mlAdvancedDetector ${a}`},Object(N.jsx)(te.EuiPanel,{paddingSize:"m"},Object(N.jsx)(te.EuiFlexGroup,null,Object(N.jsx)(te.EuiFlexItem,null,void 0!==t.detector_description?Object(N.jsx)("div",{style:{fontWeight:"bold"},"data-test-subj":"mlDetectorDescription"},t.detector_description):Object(N.jsx)(Da,{detector:t})),e&&Object(N.jsx)(te.EuiFlexItem,{grow:!1,style:{margin:"8px"}},Object(N.jsx)(m,{index:a}))),void 0!==t.detector_description&&Object(N.jsx)(n.Fragment,null,Object(N.jsx)(te.EuiHorizontalRule,{margin:"s"}),Object(N.jsx)(Da,{detector:t}))))))),Object(N.jsx)(Ia,{validation:u}))},Fa=({show:e})=>!1===e?null:Object(N.jsx)(n.Fragment,null,Object(N.jsx)(te.EuiSpacer,{size:"s"}),Object(N.jsx)(te.EuiCallOut,{title:y.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.noDetectorsCallout.title",{defaultMessage:"No detectors"}),iconType:"alert","data-test-subj":"mlAdvancedNoDetectorsMessage"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.noDetectorsCallout.message",defaultMessage:"At least one detector is needed to create a job."})),Object(N.jsx)(te.EuiSpacer,{size:"s"})),Ia=({validation:e})=>!0===e.valid?null:Object(N.jsx)(n.Fragment,null,Object(N.jsx)(te.EuiFormRow,{error:e.message,isInvalid:!1===e.valid},Object(N.jsx)(n.Fragment,null)),Object(N.jsx)(te.EuiSpacer,{size:"s"})),Da=({detector:e})=>Object(N.jsx)("div",{"data-test-subj":"mlDetectorIdentifier"},Object(da.b)(e)),Aa={agg:null,field:null,byField:null,overField:null,partitionField:null,excludeFrequent:null,description:null,customRules:null,useNull:null},La=({setIsValid:e})=>{const{jobCreator:t,jobCreatorUpdate:a,jobCreatorUpdated:i}=Object(n.useContext)(Ve),s=t,{fields:r,aggs:o}=Ue.b,[l,c]=Object(n.useState)(null);return Object(n.useEffect)((()=>{e(s.detectors.length>0)}),[i]),Object(N.jsx)(n.Fragment,null,Object(N.jsx)(Ta,{isActive:!0,onEditJob:function(e){const t=s.richDetectors[e];void 0!==t&&c({detector:t,index:e})},onDeleteJob:function(e){s.removeDetector(e),a()}}),Object(N.jsx)(Ca,{payload:l,fields:r,aggs:o,detectorChangeHandler:function(e,t){void 0===t?s.addDetector(e.agg,e.field,e.byField,e.overField,e.partitionField,e.excludeFrequent,e.description,e.useNull):s.editDetector(e.agg,e.field,e.byField,e.overField,e.partitionField,e.excludeFrequent,e.description,t,e.useNull),a(),c(null)},showModal:function(){c({detector:Aa})},closeModal:function(){c(null)}}))},Ra=()=>Object(N.jsx)(Ta,{isActive:!1,onEditJob:()=>{},onDeleteJob:()=>{}}),Pa=Object(n.memo)((({children:e,validation:t})=>{const a=y.i18n.translate("xpack.ml.newJob.wizard.jobDetailsStep.advancedSection.modelMemoryLimit.title",{defaultMessage:"Model memory limit"});return Object(N.jsx)(te.EuiDescribedFormGroup,{title:Object(N.jsx)("h3",null,a),description:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobDetailsStep.advancedSection.modelMemoryLimit.description",defaultMessage:"Set an approximate upper limit for the amount of memory that can be used by the analytical models."})},Object(N.jsx)(te.EuiFormRow,{label:a,error:t.message,isInvalid:!1===t.valid},Object(N.jsx)(s.a.Fragment,null,e)))})),Na=()=>{const{jobCreator:e,jobCreatorUpdate:t,jobCreatorUpdated:a,jobValidator:i,jobValidatorUpdated:s}=Object(n.useContext)(Ve),[r,o]=Object(n.useState)(i.modelMemoryLimit),[l,c]=Object(n.useState)(null===e.modelMemoryLimit?"":e.modelMemoryLimit),{anomaly_detectors:d}=Object(A.c)(),{model_memory_limit:u}=d;return Object(n.useEffect)((()=>{e.modelMemoryLimit=""===l?null:l,t()}),[l]),Object(n.useEffect)((()=>{c(null===e.modelMemoryLimit?"":e.modelMemoryLimit)}),[a]),Object(n.useEffect)((()=>{o(i.modelMemoryLimit)}),[s]),Object(N.jsx)(Pa,{validation:r},Object(N.jsx)(te.EuiFieldText,{value:l,placeholder:u,onChange:e=>c(e.target.value),isInvalid:!1===r.valid,"data-test-subj":"mlJobWizardInputModelMemoryLimit"}))},za=({setIsValid:e})=>Object(N.jsx)(n.Fragment,null,Object(N.jsx)(te.EuiFlexGroup,{gutterSize:"xl"},Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(Dt,{setIsValid:e})),Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(Qt,null))),Object(N.jsx)(te.EuiFlexGroup,{gutterSize:"xl"},Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(Na,null)),Object(N.jsx)(te.EuiFlexItem,null))),Ba=({fields:e,changeHandler:t,selectedField:a})=>{const{jobCreator:i}=Object(n.useContext)(Ve),s=[...Object(St.f)(i.aggregationFields.length>0),...Object(St.g)(e,i.additionalFields)],r=[];return null!==a&&r.push({label:a}),Object(N.jsx)(te.EuiComboBox,{singleSelection:{asPlainText:!0},options:s,selectedOptions:r,onChange:function(e){const a=e[0];t(void 0!==a?a.label:null)},isClearable:!0,"data-test-subj":"mlSummaryCountFieldNameSelect"})},Ja=Object(n.memo)((({children:e,validation:t})=>{const a=y.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.summaryCountField.title",{defaultMessage:"Summary count field"}),{services:{docLinks:i}}=Object(f.b)(),n=i.links.ml.aggregations;return Object(N.jsx)(te.EuiDescribedFormGroup,{title:Object(N.jsx)("h3",null,a),description:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.summaryCountField.description",defaultMessage:"If the input data is {aggregated}, specify the field that contains the document count.",values:{aggregated:Object(N.jsx)(te.EuiLink,{href:n,target:"_blank"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.summaryCountField.aggregatedText",defaultMessage:"aggregated"}))}})},Object(N.jsx)(te.EuiFormRow,{label:a,error:t.message,isInvalid:!1===t.valid},Object(N.jsx)(s.a.Fragment,null,e)))})),Va=()=>{const{jobCreator:e,jobCreatorUpdate:t,jobCreatorUpdated:a,jobValidator:i,jobValidatorUpdated:s}=Object(n.useContext)(Ve),r=e,{fields:o}=Ue.b,[l,c]=Object(n.useState)(r.summaryCountFieldName),[d,u]=Object(n.useState)(i.summaryCountField);return Object(n.useEffect)((()=>{u(i.summaryCountField)}),[s]),Object(n.useEffect)((()=>{r.summaryCountFieldName=l,t()}),[l]),Object(n.useEffect)((()=>{c(r.summaryCountFieldName)}),[a]),Object(N.jsx)(Ja,{validation:d},Object(N.jsx)(Ba,{fields:o,changeHandler:c,selectedField:l}))},Ua=({fields:e,changeHandler:t,selectedField:a})=>{const{jobCreator:i,jobCreatorUpdated:s}=Object(n.useContext)(Ve),r=Object(n.useMemo)((()=>[...Object(St.g)(e,i.additionalFields)]),[e,s]),o=Object(n.useMemo)((()=>{const e=[];return null!==a&&e.push({label:a}),e}),[a]),l=Object(n.useCallback)((e=>{var a;return t(null!==(a=e[0]&&e[0].label)&&void 0!==a?a:null)}),[t]);return Object(N.jsx)(te.EuiComboBox,{singleSelection:{asPlainText:!0},options:r,selectedOptions:o,onChange:l,isClearable:!0,"data-test-subj":"mlCategorizationFieldNameSelect"})},Ga=Object(n.memo)((({children:e,isOptional:t})=>{const a=y.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.categorizationField.title",{defaultMessage:"Categorization field"});return Object(N.jsx)(te.EuiDescribedFormGroup,{title:Object(N.jsx)("h3",null,a),description:Object(N.jsx)(s.a.Fragment,null,t?Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.categorizationFieldOptional.description",defaultMessage:"Optional, for use if analyzing unstructured log data. Using text data types is recommended."}):Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.categorizationField.description",defaultMessage:"Specifies which field will be categorized. Using text data types is recommended. Categorization works best on machine written log messages, typically logging written by a developer for the purpose of system troubleshooting."}))},Object(N.jsx)(te.EuiFormRow,{label:a},Object(N.jsx)(s.a.Fragment,null,e)))})),qa=()=>{const{jobCreator:e,jobCreatorUpdate:t,jobCreatorUpdated:a}=Object(n.useContext)(Ve),i=e,{catFields:s}=Ue.b,[r,o]=Object(n.useState)(i.categorizationFieldName),l=Object(Fe.b)(i);return Object(n.useEffect)((()=>{i.categorizationFieldName!==r&&(i.categorizationFieldName=r,t())}),[r]),Object(n.useEffect)((()=>{o(i.categorizationFieldName)}),[a]),Object(N.jsx)(Ga,{isOptional:!1===l},Object(N.jsx)(Ua,{fields:s,changeHandler:o,selectedField:r}))},Ha=Object(n.memo)((({children:e})=>{const t=y.i18n.translate("xpack.ml.newJob.wizard.perPartitionCategorization.enable.title",{defaultMessage:"Enable per-partition categorization"});return Object(N.jsx)(te.EuiDescribedFormGroup,{title:Object(N.jsx)("h3",null,t),description:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.perPartitionCategorization.enable.description",defaultMessage:"If per-partition categorization is enabled then categories are determined independently for each value of the partition field."})},Object(N.jsx)(s.a.Fragment,null,e))})),Wa=()=>{const{jobCreator:e,jobCreatorUpdate:t,jobCreatorUpdated:a}=Object(n.useContext)(Ve),i=e,[s,r]=Object(n.useState)(i.perPartitionCategorization),o=Object(n.useCallback)((()=>r(!s)),[s]);return Object(n.useEffect)((()=>{r(i.perPartitionCategorization)}),[a]),Object(n.useEffect)((()=>{!1===s&&(i.perPartitionStopOnWarn=!1),i.perPartitionCategorization=s,t()}),[s]),Object(N.jsx)(te.EuiSwitch,{name:"categorizationPerPartitionSwitch",disabled:!1,checked:s,onChange:o,"data-test-subj":"mlJobWizardSwitchCategorizationPerPartition",label:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.perPartitionCategorizationSwitchLabel",defaultMessage:"Enable per-partition categorization"})})},$a=()=>{const{jobCreator:e,jobCreatorUpdate:t,jobCreatorUpdated:a}=Object(n.useContext)(Ve),i=e,[s,r]=Object(n.useState)(i.perPartitionStopOnWarn),o=Object(n.useCallback)((()=>r(!s)),[s]);return Object(n.useEffect)((()=>{i.perPartitionStopOnWarn=s,t()}),[s]),Object(n.useEffect)((()=>{r(i.perPartitionStopOnWarn)}),[a]),Object(N.jsx)(te.EuiSwitch,{name:"categorizationPerPartitionStopOnWarnSwitch",disabled:!1,checked:s,onChange:o,"data-test-subj":"mlJobWizardSwitchCategorizationPerPartitionStopOnWarn",label:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.perPartitionCategorizationtopOnWarnSwitchLabel",defaultMessage:"Stop on warn"})})},Ya=({fields:e,changeHandler:t,selectedField:a})=>{const{jobCreator:i,jobCreatorUpdated:s}=Object(n.useContext)(Ve),r=Object(n.useMemo)((()=>[...Object(St.g)(e,i.additionalFields)]),[e,s]),o=Object(n.useMemo)((()=>{const e=[];return null!==a&&e.push({label:a}),e}),[a]),l=Object(n.useCallback)((e=>{var a;return t(null!==(a=e[0]&&e[0].label)&&void 0!==a?a:null)}),[t]);return Object(N.jsx)(te.EuiComboBox,{singleSelection:{asPlainText:!0},options:r,selectedOptions:o,onChange:l,isClearable:!0,"data-test-subj":"mlJobWizardCategorizationPerPartitionFieldNameSelect"})},Xa=({setEnablePerPartitionCategorization:e})=>{const{jobCreator:t,jobCreatorUpdate:a,jobCreatorUpdated:i}=Object(n.useContext)(Ve),s=t,[r,o]=Object(n.useState)(s.categorizationPerPartitionField),{categoryFields:l}=Ue.b,c=Object(n.useMemo)((()=>l.filter((e=>e.id!==s.categorizationFieldName))),[l,i]);return Object(n.useEffect)((()=>{s.categorizationPerPartitionField=r,a()}),[r]),Object(n.useEffect)((()=>{s.perPartitionCategorization&&null===s.categorizationPerPartitionField&&c.length>0&&(s.categorizationPerPartitionField=c[0].id),o(s.categorizationPerPartitionField),e(s.perPartitionCategorization)}),[i]),Object(N.jsx)(te.EuiFormRow,{label:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.extraStep.categorizationJob.categorizationPerPartitionFieldLabel",defaultMessage:"Partition field"})},Object(N.jsx)(Ya,{fields:c,changeHandler:o,selectedField:r||""}))},Qa=()=>{const{jobCreator:e,jobCreatorUpdated:t}=Object(n.useContext)(Ve),a=e,[i,r]=Object(n.useState)(!1);return Object(n.useEffect)((()=>{r(a.perPartitionCategorization)}),[t]),Object(N.jsx)(Ha,null,Object(N.jsx)(te.EuiFormRow,{label:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.extraStep.categorizationJob.perPartitionCategorizationLabel",defaultMessage:"Enable per-partition categorization"})},Object(N.jsx)(Wa,null)),i&&Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(te.EuiFormRow,{label:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.extraStep.categorizationJob.stopOnWarnLabel",defaultMessage:"Stop on warn"})},Object(N.jsx)($a,null))),Object(Fe.b)(a)&&i&&Object(N.jsx)(Xa,{setEnablePerPartitionCategorization:r}))},Ka=()=>{const{jobCreator:e}=Object(n.useContext)(Ve),t=Object(Fe.a)(e)&&null!==e.categorizationFieldName;return Object(N.jsx)(n.Fragment,null,Object(N.jsx)(te.EuiFlexGroup,{gutterSize:"xl"},Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(qa,null)),Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(Va,null))),t&&Object(N.jsx)(Qa,null))},Za=({isActive:e,setCanProceed:t})=>{const[a,i]=Object(n.useState)(!1),[s,r]=Object(n.useState)(!1);return Object(n.useEffect)((()=>{"function"==typeof t&&t(a&&s)}),[a,s]),Object(N.jsx)(n.Fragment,null,!1===e?Object(N.jsx)(Ra,null):Object(N.jsx)(n.Fragment,null,Object(N.jsx)(Ka,null),Object(N.jsx)(te.EuiHorizontalRule,{margin:"l"}),Object(N.jsx)(La,{setIsValid:i}),Object(N.jsx)(te.EuiHorizontalRule,{margin:"l"}),Object(N.jsx)(za,{setIsValid:r})))},ei=({onClick:e,isSelected:t})=>Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(te.EuiCard,{"data-test-subj":"mlJobWizardCategorizationDetectorCountCard"+(t?" selected":""),title:y.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.categorizationDetectorSelect.countCard.title",{defaultMessage:"Count"}),description:Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.categorizationDetectorSelect.countCard.description",defaultMessage:"Look for anomalies in the event rate of a particular category."})),selectable:{onClick:e,isSelected:t}})),ti=({onClick:e,isSelected:t})=>Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(te.EuiCard,{"data-test-subj":"mlJobWizardCategorizationDetectorRareCard"+(t?" selected":""),title:y.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.categorizationDetectorSelect.rareCard.title",{defaultMessage:"Rare"}),description:Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.categorizationDetectorSelect.rareCard.description",defaultMessage:"Look for categories that occur rarely in time."})),selectable:{onClick:e,isSelected:t}})),ai=()=>{const{jobCreator:e,jobCreatorUpdate:t,jobCreatorUpdated:a}=Object(n.useContext)(Ve),i=e,[r,o]=Object(n.useState)(i.selectedDetectorType);return Object(n.useEffect)((()=>{r!==i.selectedDetectorType&&(i.setDetectorType(r),t())}),[r]),Object(n.useEffect)((()=>{o(i.selectedDetectorType)}),[a]),Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(te.EuiTitle,{size:"xs"},Object(N.jsx)("h3",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.categorizationDetectorSelect.title",defaultMessage:"Categorization detector"}))),Object(N.jsx)(te.EuiSpacer,{size:"s"}),Object(N.jsx)(te.EuiFlexGroup,{gutterSize:"l",style:{maxWidth:"824px"}},Object(N.jsx)(ei,{onClick:function(){o(Lt.b.COUNT)},isSelected:r===Lt.b.COUNT}),Object(N.jsx)(ti,{onClick:function(){o(Lt.b.RARE)},isSelected:r===Lt.b.RARE})))},ii=({fieldExamples:e})=>{if(null===e||0===e.length)return null;const t=[{field:"example",name:y.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.categorizationFieldExamples.title",{defaultMessage:"Examples"}),render:e=>Object(N.jsx)(te.EuiCodeBlock,{fontSize:"s",paddingSize:"none",transparentBackground:!0,style:{maxHeight:"200px"}},e)}],a=e.map(((e,t)=>{const a=[];let i=0,n="",s=0;for(;s<e.text.length;){const r=e.tokens[i];r&&s===r.start_offset?(a.push(n),n="",a.push(Object(N.jsx)(ni,{key:`${t}${s}`},r.token)),s+=r.end_offset-r.start_offset,i++):(n+=e.text[s],s++)}return a.push(n),{example:a}}));return Object(N.jsx)(te.EuiBasicTable,{columns:t,items:a,"data-test-subj":"mlJobWizardCategorizationExamplesTable"})},ni=({children:e})=>Object(N.jsx)("span",{style:{backgroundColor:"#b0ccf7"}},e);var si=a(130),ri=a(134);const oi=()=>{const{jobCreator:e,jobCreatorUpdate:t}=Object(n.useContext)(Ve),a=e,[i,s]=Object(n.useState)(!1),[r,o]=Object(n.useState)(!1),[l,c]=Object(n.useState)(JSON.stringify(a.categorizationAnalyzer,null,2));function d(e){c(e);const t=Object(ri.c)(e);o(t)}return Object(n.useEffect)((()=>{!0===i&&c(JSON.stringify(a.categorizationAnalyzer,null,2))}),[i]),Object(N.jsx)(n.Fragment,null,Object(N.jsx)(li,{onClick:function(){o(!1),s(!i)}}),!0===i&&Object(N.jsx)(te.EuiFlyout,{onClose:()=>s(!1),hideCloseButton:!0,size:"m"},Object(N.jsx)(te.EuiFlyoutBody,null,Object(N.jsx)(ci,{onChange:d,title:y.i18n.translate("xpack.ml.newJob.wizard.categorizationAnalyzerFlyout.title",{defaultMessage:"Edit categorization analyzer JSON"}),value:l})),Object(N.jsx)(te.EuiFlyoutFooter,null,Object(N.jsx)(te.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiButtonEmpty,{iconType:"cross",onClick:()=>s(!1),flush:"left"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.categorizationAnalyzerFlyout.closeButton",defaultMessage:"Close"}))),Object(N.jsx)(te.EuiFlexItem,{grow:!0}),Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiButtonEmpty,{onClick:function(){const{anomaly_detectors:e}=Object(A.c)();d(JSON.stringify(e.categorization_analyzer,null,2))}},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.categorizationAnalyzerFlyout.useDefaultButton",defaultMessage:"Use default ML analyzer"}))),Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiButton,{onClick:function(){a.categorizationAnalyzer=JSON.parse(l),t(),s(!1)},fill:!0,isDisabled:!1===r},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.categorizationAnalyzerFlyout.saveButton",defaultMessage:"Save"})))))))},li=({onClick:e})=>Object(N.jsx)(te.EuiButtonEmpty,{onClick:e,flush:"left","data-test-subj":"mlJobWizardButtonPreviewJobJson"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.editCategorizationAnalyzerFlyoutButton",defaultMessage:"Edit categorization analyzer"})),ci=({title:e,value:t,onChange:a})=>Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(te.EuiTitle,{size:"s"},Object(N.jsx)("h5",null,e)),Object(N.jsx)(te.EuiSpacer,{size:"s"}),Object(N.jsx)(si.a,{value:t,height:"800px",readOnly:!1,onChange:a})),di=y.i18n.translate("xpack.ml.newJob.wizard.jobDetailsStep.allChecksButton",{defaultMessage:"View all checks performed"}),ui=({overallValidStatus:e,validationChecks:t,categorizationAnalyzer:a})=>{const i=Object(N.jsx)(pi,{categorizationAnalyzer:a});let n="success",s=y.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.categorizationFieldCalloutTitle.valid",{defaultMessage:"Selected category field is valid"});return e===Ne.a.INVALID?(n="danger",s=y.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.categorizationFieldCalloutTitle.invalid",{defaultMessage:"Selected category field is invalid"})):e===Ne.a.PARTIALLY_VALID&&(n="warning",s=y.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.categorizationFieldCalloutTitle.possiblyInvalid",{defaultMessage:"Selected category field is possibly invalid"})),Object(N.jsx)(te.EuiCallOut,{color:n,title:s,"data-test-subj":`mlJobWizardCategorizationExamplesCallout ${e}`},t.map(((e,t)=>Object(N.jsx)("div",{key:t},e.message))),Object(N.jsx)(te.EuiSpacer,{size:"s"}),i,Object(N.jsx)(te.EuiSpacer,{size:"s"}),Object(N.jsx)(te.EuiAccordion,{id:"all-checks",buttonContent:di},Object(N.jsx)(mi,{validationChecks:t})))},pi=({categorizationAnalyzer:e})=>{let t="";return void 0!==(null==e?void 0:e.tokenizer)?t=e.tokenizer:void 0!==(null==e?void 0:e.analyzer)&&(t=e.analyzer),Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)("div",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.categorizationFieldAnalyzer",defaultMessage:"Analyzer used: {analyzer}",values:{analyzer:t}})),Object(N.jsx)("div",null,Object(N.jsx)(oi,null)))},mi=({validationChecks:e})=>{const t=Object.keys(Ne.c).map(((t,a)=>{const i=e.find((e=>e.id===a));return void 0!==i&&(null==i?void 0:i.valid)!==Ne.a.VALID?{iconType:"cross",label:i.message,size:"s"}:{iconType:"check",label:Ne.c[a],size:"s"}}));return Object(N.jsx)(te.EuiListGroup,{listItems:t,maxWidth:!1})},bi=()=>Object(N.jsx)(te.EuiCallOut,{color:"warning",title:y.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.invalidCssVersionCallout.title",{defaultMessage:"The index pattern appears to be cross-cluster"})},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.invalidCssVersionCallout.mesage",defaultMessage:"No example categories could be found, this could be due to one of the clusters being an unsupported version."})),hi=({setIsValid:e})=>{const{jobCreator:t,jobCreatorUpdate:a,jobCreatorUpdated:i}=Object(n.useContext)(Ve),r=t,[o,l]=Object(n.useState)(!1),[c,d]=Object(n.useState)(!1),[u,p]=Object(n.useState)(r.start),[m,b]=Object(n.useState)(r.end),[h,f]=Object(n.useState)(JSON.stringify(r.categorizationAnalyzer)),[g,j]=Object(n.useState)(null),[x,v]=Object(n.useState)(Ne.a.INVALID),[y,O]=Object(n.useState)([]),[E,w]=Object(n.useState)(r.categorizationFieldName);async function _(){if(null!==E){l(!0);try{const{examples:e,overallValidStatus:t,validationChecks:a,ccsVersionFailure:i}=await r.loadCategorizationFieldExamples();j(e),v(t),O(a),d(i),l(!1)}catch(e){l(!1),j(null),O([]),v(Ne.a.INVALID),Object(Et.a)().displayErrorToast(e),d(!1)}}else j(null),O([]),v(Ne.a.INVALID),d(!1);e(null!==E)}return Object(n.useEffect)((()=>{r.categorizationFieldName!==E&&(r.categorizationFieldName=E,a()),_()}),[E]),Object(n.useEffect)((()=>{let e=!1;r.start===u&&r.end===m||(p(r.start),b(r.end),e=!0);const t=JSON.stringify(r.categorizationAnalyzer);t!==h&&(f(t),e=!0),e&&_(),r.categorizationFieldName!==E&&w(r.categorizationFieldName)}),[i]),Object(n.useEffect)((()=>{a()}),[x]),Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(ai,null),Object(N.jsx)(te.EuiHorizontalRule,null),Object(N.jsx)(qa,null),!0===o&&Object(N.jsx)(vt.a,{hasData:!1,loading:!0},Object(N.jsx)("div",null)),!1===c&&null!==g&&!1===o&&Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(ui,{overallValidStatus:x,validationChecks:y,categorizationAnalyzer:r.categorizationAnalyzer}),Object(N.jsx)(ii,{fieldExamples:g})),!0===c&&Object(N.jsx)(bi,null),Object(N.jsx)(te.EuiHorizontalRule,null),Object(N.jsx)(Qa,null))},fi=()=>{const{jobCreator:e,resultsLoader:t}=Object(n.useContext)(Ve),a=e,[i,r]=Object(n.useState)([]),[o,l]=Object(n.useState)(0);function c(e){!async function(){const e=await ge.ml.jobs.topCategories(a.jobId,Ne.b);r(e.categories.map((e=>{var t;return{count:e.count,example:null!==(t=e.category.examples)&&void 0!==t&&t.length?e.category.examples[0]:""}}))),l(e.total)}()}Object(n.useEffect)((()=>{const e=t.subscribeToResults(c);return()=>{e.unsubscribe()}}),[]);const d=[...a.modelPlot?[{field:"count",name:"count",width:"100px",render:e=>Object(N.jsx)(te.EuiText,{size:"s"},Object(N.jsx)("code",null,e))}]:[],{field:"example",name:"Example",render:e=>Object(N.jsx)(te.EuiText,{size:"s"},Object(N.jsx)("code",null,e))}];return Object(N.jsx)(s.a.Fragment,null,o>0&&Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)("div",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.categorizationTotalCategories",defaultMessage:"Total categories: {totalCategories}",values:{totalCategories:o}})),Object(N.jsx)(te.EuiBasicTable,{columns:d,items:i})))},gi=()=>{const{jobCreator:e,resultsLoader:t}=Object(n.useContext)(Ve),a=e,[i,r]=Object(n.useState)([]),[o,l]=Object(n.useState)(),c=Object(n.useMemo)((()=>[{field:"partitionName",name:y.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.stoppedPartitionsPreviewColumnName",{defaultMessage:"Stopped partition names"}),render:e=>Object(N.jsx)(te.EuiText,{size:"s"},Object(N.jsx)("code",null,e))}]),[]),d=Object(n.useCallback)((async()=>{try{const{jobs:e}=await ge.ml.results.getCategoryStoppedPartitions([a.jobId]);if(!Array.isArray(e)&&Array.isArray(e[a.jobId])&&e[a.jobId].length>0)return e[a.jobId]}catch(e){const t=Object(ze.c)(e);404!==t.statusCode&&l(t.message)}}),[a.jobId]);return Object(n.useEffect)((()=>{if(a.perPartitionCategorization&&a.perPartitionStopOnWarn){const e=t.results$.pipe(Object(Me.switchMap)((()=>Object(Se.from)(d()))),Object(Me.tap)((e=>{Array.isArray(e)&&r(e.slice(0,5).map((e=>({partitionName:e}))))})),Object(Me.takeWhile)((e=>!e||Array.isArray(e)&&e.length<=5))).subscribe();return()=>e.unsubscribe()}}),[]),Object(N.jsx)(s.a.Fragment,null,o&&Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(te.EuiSpacer,null),Object(N.jsx)(te.EuiCallOut,{color:"danger",size:"s",title:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.stoppedPartitionsErrorCallout",defaultMessage:"An error occurred while fetching list of stopped partitions."})})),Array.isArray(i)&&i.length>0&&Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(te.EuiSpacer,null),Object(N.jsx)("div",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.categorizationStoppedPartitionsTitle",defaultMessage:"Stopped partitions"})),Object(N.jsx)(te.EuiSpacer,{size:"s"}),Object(N.jsx)(te.EuiCallOut,{color:"warning",size:"s",title:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.stoppedPartitionsExistCallout",defaultMessage:"Per-partition categorization and stop_on_warn settings are enabled. Some partitions in job '{jobId}' are unsuitable for categorization and have been excluded from further categorization or anomaly detection analysis.",values:{jobId:a.jobId}})}),Object(N.jsx)(te.EuiBasicTable,{columns:c,items:i})))},ji=()=>{const{jobCreator:e,chartLoader:t,resultsLoader:a,chartInterval:i}=Object(n.useContext)(Ve),r=e,[o,l]=Object(n.useState)(!1),[c,d]=Object(n.useState)([]),[u,p]=Object(n.useState)([]),[m,b]=Object(n.useState)(!1);function h(e){const t=e.anomalies[0];void 0!==t&&d(t)}function f(e){b(e>0)}return Object(n.useEffect)((()=>{const e=a.subscribeToResults(h);return r.subscribeToProgress(f),async function(){l(!0);try{var e;const a=await t.loadEventRateChart(r.start,r.end,i.getInterval().asMilliseconds(),null!==(e=r.runtimeMappings)&&void 0!==e?e:void 0,r.datafeedConfig.indices_options);p(a)}catch(e){p([])}l(!1)}(),()=>{e.unsubscribe()}}),[]),Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(et.a,{eventRateChartData:u,anomalyData:c,height:"300px",width:"100%",showAxis:!0,loading:o,fadeChart:m}),Object(N.jsx)(fi,null),Object(N.jsx)(gi,null))},xi=({setIsValid:e})=>Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(te.EuiFlexGroup,{gutterSize:"xl"},Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(Dt,{setIsValid:e,hideEstimateButton:!0})))),vi=({isActive:e,setCanProceed:t})=>{const[a,i]=Object(n.useState)(!1),[r,o]=Object(n.useState)(!1);return Object(n.useEffect)((()=>{"function"==typeof t&&t(a&&r)}),[a,r]),!1===e?Object(N.jsx)(ji,null):Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(hi,{setIsValid:i}),a&&Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(te.EuiHorizontalRule,{margin:"l"}),Object(N.jsx)(xi,{setIsValid:o})))},yi=({fields:e,changeHandler:t,selectedField:a,testSubject:i,placeholder:n})=>{const s=e.map((e=>({label:e.name,field:e}))),r=[];return null!==a&&r.push({label:a.name,field:a}),Object(N.jsx)(te.EuiComboBox,{singleSelection:{asPlainText:!0},options:s,selectedOptions:r,onChange:function(e){const a=e[0];t(void 0!==a?a.field:null)},placeholder:n,"data-test-subj":i,isClearable:!1})},Oi=Object(n.memo)((({children:e})=>{const t=y.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.splitRareField.title",{defaultMessage:"Rare field"});return Object(N.jsx)(te.EuiDescribedFormGroup,{title:Object(N.jsx)("h3",null,t),description:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.rareField.description",defaultMessage:"Select a field in which to detect rare values."})},Object(N.jsx)(te.EuiFormRow,{label:t},Object(N.jsx)(s.a.Fragment,null,e)))})),Ei=()=>{const{jobCreator:e,jobCreatorUpdate:t,jobCreatorUpdated:a}=Object(n.useContext)(Ve),i=e,s=Object(n.useMemo)((()=>Object(Ue.a)(i.runtimeFields)),[]),r=function(e,t,a){const[i,s]=Object(n.useState)(e);return Object(n.useEffect)((()=>{const a=t.populationField,i=t.splitField;s(null!==a||null!==i?e.filter((({name:e})=>e!==(null==a?void 0:a.name)&&e!==(null==i?void 0:i.name))):e)}),[a]),i}(Object(n.useMemo)((()=>[...Ue.b.categoryFields,...s]),[]),i,a),[o,l]=Object(n.useState)(i.rareField);return Object(n.useEffect)((()=>{i.setRareField(o),null!==o&&!1===i.influencers.includes(o.name)&&i.addInfluencer(o.name),t()}),[o]),Object(n.useEffect)((()=>{l(i.rareField)}),[a]),Object(N.jsx)(Oi,null,Object(N.jsx)(yi,{fields:r,changeHandler:l,selectedField:o,testSubject:"mlRareFieldSelect"}))};const wi=({onClick:e,isSelected:t})=>Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(te.EuiCard,{"data-test-subj":"mlJobWizardCategorizationDetectorRareCard"+(t?" selected":""),title:y.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.rareDetectorSelect.rareCard.title",{defaultMessage:"Rare"}),description:Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.rareDetectorSelect.rareCard.description",defaultMessage:"Find rare values over time."})),selectable:{onClick:e,isSelected:t}})),_i=({onClick:e,isSelected:t})=>Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(te.EuiCard,{"data-test-subj":"mlJobWizardCategorizationDetectorRareCard"+(t?" selected":""),title:y.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.rareDetectorSelect.rarePopulationCard.title",{defaultMessage:"Rare in population"}),description:Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.rareDetectorSelect.rarePopulationCard.description",defaultMessage:"Find members of a population that have rare values over time."})),selectable:{onClick:e,isSelected:t}})),Si=({onClick:e,isSelected:t})=>Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(te.EuiCard,{"data-test-subj":"mlJobWizardCategorizationDetectorRareCard"+(t?" selected":""),title:y.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.rareDetectorSelect.freqRareCard.title",{defaultMessage:"Frequently rare in population"}),description:Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.rareDetectorSelect.freqRareCard.description",defaultMessage:"Find members of a population that frequently have rare values."})),selectable:{onClick:e,isSelected:t}})),Mi=({onChange:e})=>{const{jobCreator:t,jobCreatorUpdate:a}=Object(n.useContext)(Ve),i=t,[r,o]=Object(n.useState)(null);return Object(n.useEffect)((()=>{null!==i.rareField?null===i.populationField?o(Ii.RARE):o(i.frequentlyRare?Ii.FREQ_RARE_POPULATION:Ii.RARE_POPULATION):o(Ii.RARE)}),[]),Object(n.useEffect)((()=>{null!==r&&(e(r),r===Ii.RARE&&null!==i.populationField&&i.removePopulationField(),i.frequentlyRare=r===Ii.FREQ_RARE_POPULATION,a())}),[r]),Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(te.EuiTitle,{size:"xs"},Object(N.jsx)("h3",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.rareDetectorSelect.title",defaultMessage:"Rare detector"}))),Object(N.jsx)(te.EuiSpacer,{size:"s"}),Object(N.jsx)(te.EuiFlexGroup,{gutterSize:"l",style:{maxWidth:"824px"}},Object(N.jsx)(wi,{onClick:function(){o(Ii.RARE)},isSelected:r===Ii.RARE}),Object(N.jsx)(_i,{onClick:function(){o(Ii.RARE_POPULATION)},isSelected:r===Ii.RARE_POPULATION}),Object(N.jsx)(Si,{onClick:function(){o(Ii.FREQ_RARE_POPULATION)},isSelected:r===Ii.FREQ_RARE_POPULATION})))},ki=({detectorType:e})=>{const{jobCreator:t,jobCreatorUpdated:a}=Object(n.useContext)(Ve),i=t,[s,r]=Object(n.useState)(null);return Object(n.useEffect)((()=>{const t=function(e,t){var a,i;if(null===e.rareField)return null;const n=e.rareField.id,s=null===(a=e.populationField)||void 0===a?void 0:a.id,r=null===(i=e.splitField)||void 0===i?void 0:i.id,o=y.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.rareField.plainText.rareSummary",{defaultMessage:"Detects rare {rareFieldName} values.",values:{rareFieldName:n}}),l=y.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.rareField.plainText.rareSplitSummary",{defaultMessage:"For each {splitFieldName}, detects rare {rareFieldName} values.",values:{splitFieldName:r,rareFieldName:n}}),c=y.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.rareField.plainText.freqRarePopulationSummary",{defaultMessage:"Detects {populationFieldName} values that frequently have rare {rareFieldName} values relative to the population.",values:{populationFieldName:s,rareFieldName:n}}),d=y.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.rareField.plainText.freqRareSplitPopulationSummary",{defaultMessage:"For each {splitFieldName}, detects {populationFieldName} values that frequently have rare {rareFieldName} values relative to the population.",values:{splitFieldName:r,populationFieldName:s,rareFieldName:n}}),u=y.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.rareField.plainText.rarePopulationSummary",{defaultMessage:"Detects {populationFieldName} values that have rare {rareFieldName} values relative to the population.",values:{populationFieldName:s,rareFieldName:n}}),p=y.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.rareField.plainText.rareSplitPopulationSummary",{defaultMessage:"For each {splitFieldName}, detects {populationFieldName} values that have rare {rareFieldName} values relative to the population.",values:{splitFieldName:r,populationFieldName:s,rareFieldName:n}});if(t===Ii.RARE)return void 0!==r?l:o;if(t===Ii.FREQ_RARE_POPULATION)return void 0!==r?d:c;if(t===Ii.RARE_POPULATION)return void 0!==r?p:u;return null}(i,e);r(t)}),[a]),null===s?null:Object(N.jsx)(te.EuiCallOut,{title:y.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.rareField.plainText.calloutTitle",{defaultMessage:"Job summary"})},Object(N.jsx)("ul",null,Object(N.jsx)("li",null,s)))};const Ci=({setIsValid:e,rareDetectorType:t,setRareDetectorType:a})=>{const{jobCreator:i,jobCreatorUpdated:r}=Object(n.useContext)(Ve),o=i,[l,c]=Object(n.useState)(!1);return Object(n.useEffect)((()=>{let a=!1;null!==o.rareField&&(t===Ii.RARE||null!==o.populationField)&&(a=!0),e(a),c(a)}),[r]),Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(Mi,{onChange:a}),Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(te.EuiHorizontalRule,null),Object(N.jsx)(te.EuiFlexGroup,null,Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(Ei,null)),Object(N.jsx)(te.EuiFlexItem,null,t!==Ii.RARE&&Object(N.jsx)(aa,null))),l&&Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(te.EuiSpacer,{size:"m"}),Object(N.jsx)(ki,{detectorType:t}))))},Ti=()=>{const{jobCreator:e,chartLoader:t,resultsLoader:a,chartInterval:i,jobCreatorUpdated:r}=Object(n.useContext)(Ve),o=e,[l,c]=Object(n.useState)(!1),[d,u]=Object(n.useState)([]),[p,m]=Object(n.useState)([]),[b,h]=Object(n.useState)(!1),f=Object(n.useMemo)((()=>null!==o.rareField?null===o.populationField?Ii.RARE:o.frequentlyRare?Ii.FREQ_RARE_POPULATION:Ii.RARE_POPULATION:Ii.RARE),[r]);function g(e){const t=e.anomalies[0];void 0!==t&&u(t)}function j(e){h(e>0)}return Object(n.useEffect)((()=>{const e=a.subscribeToResults(g);return o.subscribeToProgress(j),async function(){c(!0);try{var e;const a=await t.loadEventRateChart(o.start,o.end,i.getInterval().asMilliseconds(),null!==(e=o.runtimeMappings)&&void 0!==e?e:void 0,o.datafeedConfig.indices_options);m(a)}catch(e){m([])}c(!1)}(),()=>{e.unsubscribe()}}),[]),Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(ki,{detectorType:f}),Object(N.jsx)(te.EuiSpacer,{size:"s"}),Object(N.jsx)(et.a,{eventRateChartData:p,anomalyData:d,height:"300px",width:"100%",showAxis:!0,loading:l,fadeChart:b}))},Fi=({setIsValid:e})=>Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(te.EuiFlexGroup,{gutterSize:"xl"},Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)($t,null)),Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(Qt,null))),Object(N.jsx)(te.EuiFlexGroup,{gutterSize:"xl"},Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(Dt,{setIsValid:e})),Object(N.jsx)(te.EuiFlexItem,null)));let Ii;!function(e){e[e.RARE=0]="RARE",e[e.RARE_POPULATION=1]="RARE_POPULATION",e[e.FREQ_RARE_POPULATION=2]="FREQ_RARE_POPULATION"}(Ii||(Ii={}));const Di=({isActive:e,setCanProceed:t})=>{const[a,i]=Object(n.useState)(!1),[r,o]=Object(n.useState)(!1),[l,c]=Object(n.useState)(Ii.RARE);return Object(n.useEffect)((()=>{"function"==typeof t&&t(a&&r)}),[a,r]),!1===e?Object(N.jsx)(Ti,null):Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(Ci,{setIsValid:i,rareDetectorType:l,setRareDetectorType:c}),a&&Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(te.EuiHorizontalRule,{margin:"l"}),Object(N.jsx)(Fi,{setIsValid:o})))};var Ai=a(170);const Li=({combinedJob:e,heightOffset:t=0})=>{const{jobs:{datafeedPreview:a}}=Object(f.a)(),i=Object(n.useMemo)((()=>window.innerHeight-230-t+"px"),[t]),[s,r]=Object(n.useState)(!1),[o,l]=Object(n.useState)(""),[c,d]=Object(n.useState)(!1),[u,p]=Object(n.useState)("");Object(n.useEffect)((()=>{try{null!==e&&(""===u?m():d(JSON.stringify(e)!==u))}catch(e){}}),[e]);const m=Object(n.useCallback)((async()=>{if(l(""),null!==e)if(r(!0),p(JSON.stringify(e)),e.datafeed_config&&e.datafeed_config.indices.length){try{const{datafeed_config:t,...i}=e;if(0===i.analysis_config.detectors.length)l(y.i18n.translate("xpack.ml.newJob.wizard.datafeedPreviewFlyout.noDetectors",{defaultMessage:"No detectors configured"}));else{const e=await a(void 0,i,t);l(JSON.stringify(e,null,2))}}catch(e){l(JSON.stringify(e,null,2))}r(!1),d(!1)}else{const e=y.i18n.translate("xpack.ml.newJob.wizard.datafeedPreviewFlyout.datafeedDoesNotExistLabel",{defaultMessage:"Datafeed does not exist"});l(e)}}),[e]);return Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(te.EuiFlexGroup,null,Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(te.EuiTitle,{size:"s"},Object(N.jsx)("h5",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.datafeedPreviewFlyout.title",defaultMessage:"Datafeed preview"})))),Object(N.jsx)(te.EuiFlexItem,{grow:!1},c&&Object(N.jsx)(te.EuiButton,{size:"s",onClick:m,iconType:"refresh"},"Refresh"))),Object(N.jsx)(te.EuiSpacer,{size:"s"}),!0===s?Object(N.jsx)(te.EuiFlexGroup,{justifyContent:"spaceAround"},Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiSpacer,{size:"xxl"}),Object(N.jsx)(te.EuiLoadingSpinner,{size:"l"}))):Object(N.jsx)(si.a,{value:o,height:i,readOnly:!0}))};let Ri;!function(e){e[e.HIDDEN=0]="HIDDEN",e[e.READONLY=1]="READONLY",e[e.EDITABLE=2]="EDITABLE"}(Ri||(Ri={}));let Pi;!function(e){e[e.HIDDEN=0]="HIDDEN",e[e.READONLY=1]="READONLY",e[e.EDITABLE=2]="EDITABLE"}(Pi||(Pi={}));const Ni=({isDisabled:e,jobEditorMode:t,datafeedEditorMode:a})=>{const{jobCreator:i,jobCreatorUpdate:r,jobCreatorUpdated:o}=Object(n.useContext)(Ve),{displayErrorToast:l}=Object(Et.c)(),[c,d]=Object(n.useState)(!1),[u,p]=Object(n.useState)(!1),[m,b]=Object(n.useState)(i.formattedJobJson),[h,f]=Object(n.useState)(i.formattedDatafeedJson),[g,j]=Object(n.useState)(!1),[x,v]=Object(n.useState)(null);Object(n.useEffect)((()=>{b(i.formattedJobJson),f(i.formattedDatafeedJson)}),[o]),Object(n.useEffect)((()=>{!0===c?(b(i.formattedJobJson),f(i.formattedDatafeedJson),v({...JSON.parse(i.formattedJobJson),datafeed_config:JSON.parse(i.formattedDatafeedJson)}),p(!1)):v(null)}),[c]);const O=t===Pi.EDITABLE||a===Pi.EDITABLE,E=t===Pi.READONLY&&a===Pi.READONLY;return Object(N.jsx)(n.Fragment,null,Object(N.jsx)(zi,{onClick:function(){j(!1),d(!c)},isDisabled:e,editJsonMode:O}),!0===c&&!1===e&&Object(N.jsx)(te.EuiFlyout,{onClose:()=>d(!1),hideCloseButton:!0,size:"l"},Object(N.jsx)(te.EuiFlyoutBody,null,Object(N.jsx)(te.EuiFlexGroup,null,t!==Pi.HIDDEN&&Object(N.jsx)(Bi,{editJson:t===Pi.EDITABLE,onChange:function(e){b(e);const t=Object(ri.c)(e);v(t?{...JSON.parse(e),datafeed_config:JSON.parse(h)}:null),j(t)},title:y.i18n.translate("xpack.ml.newJob.wizard.jsonFlyout.job.title",{defaultMessage:"Job configuration JSON"}),value:m,heightOffset:u?100:0}),a!==Pi.HIDDEN&&Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(Bi,{editJson:a===Pi.EDITABLE,onChange:function(e){f(e);const t=Object(Ai.b)(e);let a=Object(ri.c)(t);if(a){const e=JSON.parse(t),n=i.indices.sort();a=n.length===e.indices.length&&n.every(((t,a)=>t===e.indices[a])),p(!1===a),v({...JSON.parse(m),datafeed_config:e})}else p(!1),v(null);j(a)},title:y.i18n.translate("xpack.ml.newJob.wizard.jsonFlyout.datafeed.title",{defaultMessage:"Datafeed configuration JSON"}),value:h,heightOffset:u?100:0}),a===Pi.EDITABLE&&Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(Li,{combinedJob:x,heightOffset:u?100:0})))),u&&Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(te.EuiSpacer,null),Object(N.jsx)(te.EuiCallOut,{color:"warning",size:"s",title:y.i18n.translate("xpack.ml.newJob.wizard.jsonFlyout.indicesChange.calloutTitle",{defaultMessage:"Indices have changed"})},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.jsonFlyout.indicesChange.calloutText",defaultMessage:"You cannot alter the indices being used by the datafeed here. To select a different index pattern or saved search, go to step 1 of the wizard and select the Change index pattern option."})))),Object(N.jsx)(te.EuiFlyoutFooter,null,Object(N.jsx)(te.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiButtonEmpty,{iconType:"cross",onClick:()=>d(!1),flush:"left"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.jsonFlyout.closeButton",defaultMessage:"Close"}))),!1===E&&Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiButton,{onClick:async function(){const e=JSON.parse(m),t=JSON.parse(Object(Ai.b)(h));if(i.cloneFromExistingJob(e,t),Object(Fe.a)(i))try{await i.autoSetTimeRange()}catch(e){const t=y.i18n.translate("xpack.ml.newJob.wizard.jsonFlyout.autoSetJobCreatorTimeRange.error",{defaultMessage:"Error retrieving beginning and end times of index"});l(e,t)}r(),d(!1)},fill:!0,isDisabled:!1===g},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.jsonFlyout.saveButton",defaultMessage:"Save"})))))))},zi=({isDisabled:e,onClick:t,editJsonMode:a})=>{const i=y.i18n.translate("xpack.ml.newJob.wizard.previewJsonButton",{defaultMessage:"Preview JSON"}),n=y.i18n.translate("xpack.ml.newJob.wizard.editJsonButton",{defaultMessage:"Edit JSON"});return Object(N.jsx)(te.EuiButtonEmpty,{onClick:t,isDisabled:e,"data-test-subj":"mlJobWizardButtonPreviewJobJson"},a?n:i)},Bi=({title:e,value:t,editJson:a,onChange:i,heightOffset:s=0})=>{const r=Object(n.useMemo)((()=>window.innerHeight-230-s+"px"),[s]);return Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(te.EuiTitle,{size:"s"},Object(N.jsx)("h5",null,e)),Object(N.jsx)(te.EuiSpacer,{size:"s"}),Object(N.jsx)(si.a,{value:t,height:r,mode:si.b.XJSON,readOnly:!1===a,onChange:i}))},Ji=({setCurrentStep:e,isCurrentStep:t})=>{const{jobCreator:a,jobValidator:i,jobValidatorUpdated:s}=Object(n.useContext)(Ve),[r,o]=Object(n.useState)(!1),[l,c]=Object(n.useState)(!1);return Object(n.useEffect)((()=>{o(l&&i.isPickFieldsStepValid)}),[s,l]),Object(N.jsx)(n.Fragment,null,t&&Object(N.jsx)(n.Fragment,null,Object(Fe.f)(a)&&Object(N.jsx)(Nt,{isActive:t,setCanProceed:c}),Object(Fe.c)(a)&&Object(N.jsx)(Zt,{isActive:t,setCanProceed:c}),Object(Fe.d)(a)&&Object(N.jsx)(la,{isActive:t,setCanProceed:c}),Object(Fe.a)(a)&&Object(N.jsx)(Za,{isActive:t,setCanProceed:c}),Object(Fe.b)(a)&&Object(N.jsx)(vi,{isActive:t,setCanProceed:c}),Object(Fe.e)(a)&&Object(N.jsx)(Di,{isActive:t,setCanProceed:c}),Object(N.jsx)(He,{previous:()=>e(Object(Fe.a)(a)?Je.ADVANCED_CONFIGURE_DATAFEED:Je.TIME_RANGE),next:()=>e(Je.JOB_DETAILS),nextActive:r},Object(Fe.a)(a)&&Object(N.jsx)(Ni,{isDisabled:!1,jobEditorMode:Pi.EDITABLE,datafeedEditorMode:Pi.EDITABLE}))))},Vi=Object(n.memo)((({children:e,validation:t})=>{const a=y.i18n.translate("xpack.ml.newJob.wizard.jobDetailsStep.jobId.title",{defaultMessage:"Job ID"}),i=y.i18n.translate("xpack.ml.newJob.wizard.jobDetailsStep.jobId.description",{defaultMessage:'A unique identifier for the job. Spaces and the characters  / ? , " < > | * are not allowed'});return Object(N.jsx)(te.EuiDescribedFormGroup,{title:Object(N.jsx)("h3",null,a),description:i},Object(N.jsx)(te.EuiFormRow,{label:a,error:t.message,isInvalid:!1===t.valid},Object(N.jsx)(s.a.Fragment,null,e)))})),Ui=()=>{const{jobCreator:e,jobCreatorUpdate:t,jobValidator:a,jobValidatorUpdated:i}=Object(n.useContext)(Ve),[s,r]=Object(n.useState)(e.jobId),o=Object(n.useMemo)((()=>{var e,t,i;return{valid:!0===(""===s)||!0===a.jobId.valid&&!0===(null===(e=a.latestValidationResult.jobIdExists)||void 0===e?void 0:e.valid),message:null!==(t=a.jobId.message)&&void 0!==t?t:null===(i=a.latestValidationResult.jobIdExists)||void 0===i?void 0:i.message}}),[i]);return Object(n.useEffect)((()=>{e.jobId=s,t()}),[s]),Object(N.jsx)(Vi,{validation:o},Object(N.jsx)(te.EuiFieldText,{value:s,onChange:e=>r(e.target.value),isInvalid:!1===o.valid,"data-test-subj":"mlJobWizardInputJobId"}))},Gi=Object(n.memo)((({children:e})=>{const t=y.i18n.translate("xpack.ml.newJob.wizard.jobDetailsStep.jobDescription.title",{defaultMessage:"Job description"});return Object(N.jsx)(te.EuiDescribedFormGroup,{title:Object(N.jsx)("h3",null,t),description:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobDetailsStep.jobDescription.description",defaultMessage:"Optional descriptive text"})},Object(N.jsx)(te.EuiFormRow,{label:t},Object(N.jsx)(s.a.Fragment,null,e)))})),qi=()=>{const{jobCreator:e,jobCreatorUpdate:t}=Object(n.useContext)(Ve),[a,i]=Object(n.useState)(e.description);return Object(n.useEffect)((()=>{e.description=a,t()}),[a]),Object(N.jsx)(Gi,null,Object(N.jsx)(te.EuiTextArea,{value:a,onChange:e=>i(e.target.value),"data-test-subj":"mlJobWizardInputJobDescription"}))},Hi=()=>{const{jobCreator:e,jobCreatorUpdate:t,jobValidator:a,jobValidatorUpdated:i}=Object(n.useContext)(Ve),{existingJobsAndGroups:s}=Object(n.useContext)(Ve),[r,o]=Object(n.useState)(e.groups),l=Object(n.useMemo)((()=>{var e,t,i;return{valid:!0===a.groupIds.valid&&!0===(null===(e=a.latestValidationResult.groupIdsExist)||void 0===e?void 0:e.valid),message:null!==(t=a.groupIds.message)&&void 0!==t?t:null===(i=a.latestValidationResult.groupIdsExist)||void 0===i?void 0:i.message}}),[i]);Object(n.useEffect)((()=>{e.groups=r,t()}),[r.join()]);const c=s.groupIds.map((e=>({label:e,color:Object(tt.a)(e)}))),d=r.map((e=>({label:e,color:Object(tt.a)(e)})));return Object(N.jsx)(at,{validation:l},Object(N.jsx)(te.EuiComboBox,{placeholder:y.i18n.translate("xpack.ml.newJob.wizard.jobDetailsStep.jobGroupSelect.placeholder",{defaultMessage:"Select or create groups"}),options:c,selectedOptions:d,onChange:function(e){o(e.map((e=>e.label)))},onCreateOption:function(e,t){const a=e.trim().toLowerCase();if(!a)return;const i={label:e,color:Object(tt.a)(e)};-1===t.findIndex((e=>e.label.trim().toLowerCase()===a))&&c.push(i),o([...d,i].map((e=>e.label)))},isClearable:!0,isInvalid:!1===l.valid,"data-test-subj":"mlJobWizardComboBoxJobGroups"}))},Wi=Object(n.memo)((({children:e})=>{const t=y.i18n.translate("xpack.ml.newJob.wizard.jobDetailsStep.advancedSection.enableModelPlot.title",{defaultMessage:"Enable model plot"});return Object(N.jsx)(te.EuiDescribedFormGroup,{title:Object(N.jsx)("h3",null,t),description:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobDetailsStep.advancedSection.enableModelPlot.description",defaultMessage:"Select to store additional model information used for plotting model bounds. This will add overhead to the performance of the system and is not recommended for high cardinality data."})},Object(N.jsx)(te.EuiFormRow,{label:t},Object(N.jsx)(s.a.Fragment,null,e)))})),$i=()=>{const{jobCreator:e,jobValidator:t,jobValidatorUpdated:a}=Object(n.useContext)(Ve),[i,s]=Object(n.useState)(null);return Object(n.useEffect)((()=>{var e,a,i;const n=null!==(e=null===(a=t.latestValidationResult)||void 0===a||null===(i=a.highCardinality)||void 0===i?void 0:i.value)&&void 0!==e?e:null;s(n)}),[a]),e.modelPlot&&null!==i?Object(N.jsx)(te.EuiCallOut,{title:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobDetailsStep.advancedSection.mmlWarning.title",defaultMessage:"Proceed with caution!"}),color:"warning",iconType:"help"},Object(N.jsx)(te.EuiText,null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobDetailsStep.advancedSection.mmlWarning.message",defaultMessage:"Creating model plots is resource intensive and not recommended where the cardinality of the selected fields is greater than 100. Estimated cardinality for this job is {highCardinality}. If you enable model plot with this configuration we recommend you use a dedicated results index.",values:{highCardinality:i}}))):null},Yi=()=>{const{jobCreator:e,jobCreatorUpdate:t,jobCreatorUpdated:a}=Object(n.useContext)(Ve),[i,r]=Object(n.useState)(e.modelPlot),[o,l]=Object(n.useState)(!1);return Object(n.useEffect)((()=>{e.modelPlot=i,t()}),[i]),Object(n.useEffect)((()=>{const t=[Lt.b.RARE],a=Object(Fe.b)(e)&&e.aggregations.some((e=>t.includes(e.id)));l(!1===a)}),[a]),Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(Wi,null,Object(N.jsx)(te.EuiSwitch,{name:"switch",disabled:!1===o,checked:i,onChange:function(){r(!i)},"data-test-subj":"mlJobWizardSwitchModelPlot",label:y.i18n.translate("xpack.ml.newJob.wizard.jobDetailsStep.advancedSection.enableModelPlot.title",{defaultMessage:"Enable model plot"})})),Object(N.jsx)($i,null),Object(N.jsx)(te.EuiSpacer,null))},Xi=Object(n.memo)((({children:e})=>{const t=y.i18n.translate("xpack.ml.newJob.wizard.jobDetailsStep.advancedSection.enableModelPlotAnnotations.title",{defaultMessage:"Enable model change annotations"});return Object(N.jsx)(te.EuiDescribedFormGroup,{title:Object(N.jsx)("h3",null,t),description:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobDetailsStep.advancedSection.enableModelPlotAnnotations.description",defaultMessage:"Select to generate annotations when the model changes significantly. For example, when step changes, periodicity or trends are detected."})},Object(N.jsx)(te.EuiFormRow,{label:t},Object(N.jsx)(s.a.Fragment,null,e)))})),Qi=()=>{const{jobCreator:e,jobCreatorUpdate:t,jobCreatorUpdated:a}=Object(n.useContext)(Ve),[i,r]=Object(n.useState)(e.modelChangeAnnotations),[o,l]=Object(n.useState)(e.modelPlot&&!e.modelChangeAnnotations);return Object(n.useEffect)((()=>{e.modelChangeAnnotations=i,t()}),[i]),Object(n.useEffect)((()=>{l(e.modelPlot&&!i)}),[a,i]),Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(Xi,null,Object(N.jsx)(te.EuiSwitch,{name:"switch",checked:i,onChange:function(){r(!i)},"data-test-subj":"mlJobWizardSwitchAnnotations",label:y.i18n.translate("xpack.ml.newJob.wizard.jobDetailsStep.advancedSection.enableModelPlotAnnotations.title",{defaultMessage:"Enable model change annotations"})})),o&&Object(N.jsx)(te.EuiCallOut,{title:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobDetailsStep.advancedSection.annotationsSwitchCallout.title",defaultMessage:"If you enable model plot with this configuration, we recommend you also enable annotations."}),color:"primary",iconType:"help"}),Object(N.jsx)(te.EuiSpacer,null))},Ki=Object(n.memo)((({children:e})=>{const t=y.i18n.translate("xpack.ml.newJob.wizard.jobDetailsStep.advancedSection.useDedicatedIndex.title",{defaultMessage:"Use dedicated index"});return Object(N.jsx)(te.EuiDescribedFormGroup,{title:Object(N.jsx)("h3",null,t),description:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobDetailsStep.advancedSection.useDedicatedIndex.description",defaultMessage:"Store results in a separate index for this job."})},Object(N.jsx)(te.EuiFormRow,{label:t},Object(N.jsx)(s.a.Fragment,null,e)))})),Zi=()=>{const{jobCreator:e,jobCreatorUpdate:t}=Object(n.useContext)(Ve),[a,i]=Object(n.useState)(e.useDedicatedIndex);return Object(n.useEffect)((()=>{e.useDedicatedIndex=a,t()}),[a]),Object(N.jsx)(Ki,null,Object(N.jsx)(te.EuiSwitch,{name:"switch",checked:a,onChange:function(){i(!a)},"data-test-subj":"mlJobWizardSwitchUseDedicatedIndex",label:y.i18n.translate("xpack.ml.newJob.wizard.jobDetailsStep.advancedSection.useDedicatedIndex.title",{defaultMessage:"Use dedicated index"})}))},en=y.i18n.translate("xpack.ml.newJob.wizard.jobDetailsStep.advancedSectionButton",{defaultMessage:"Advanced"}),tn=({advancedExpanded:e,setAdvancedExpanded:t})=>{const{jobCreator:a}=Object(n.useContext)(Ve);return a.type===oe.f.ADVANCED?Object(N.jsx)(n.Fragment,null,Object(N.jsx)(te.EuiHorizontalRule,{margin:"xl"}),Object(N.jsx)(te.EuiFlexGroup,{gutterSize:"xl"},Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(Yi,null),Object(N.jsx)(Qi,null)),Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(Zi,null)))):Object(N.jsx)(n.Fragment,null,Object(N.jsx)(te.EuiSpacer,{size:"xl"}),Object(N.jsx)(te.EuiAccordion,{id:"advanced-section",buttonContent:en,onToggle:t,initialIsOpen:e,"data-test-subj":"mlJobWizardToggleAdvancedSection"},Object(N.jsx)(te.EuiSpacer,null),Object(N.jsx)(te.EuiFlexGroup,{gutterSize:"xl",style:{marginLeft:"0px",marginRight:"0px"},"data-test-subj":"mlJobWizardAdvancedSection"},Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(Yi,null),Object(N.jsx)(Qi,null),Object(N.jsx)(Na,null)),Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(Zi,null)))))},an=Object(n.memo)((({children:e})=>{const{services:{docLinks:t}}=Object(f.b)(),a=t.links.ml.calendars,i=y.i18n.translate("xpack.ml.newJob.wizard.jobDetailsStep.additionalSection.calendarsSelection.title",{defaultMessage:"Calendars"});return Object(N.jsx)(te.EuiDescribedFormGroup,{title:Object(N.jsx)("h3",null,i),description:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobDetailsStep.additionalSection.calendarsSelection.description",defaultMessage:"Contains a list of scheduled events that you want to ignore, such as planned system outages or public holidays. {learnMoreLink}",values:{learnMoreLink:Object(N.jsx)(te.EuiLink,{href:a,target:"_blank"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobDetailsStep.additionalSection.calendarsSelection.learnMoreLinkText",defaultMessage:"Learn more"}))}})},Object(N.jsx)(te.EuiFormRow,null,Object(N.jsx)(s.a.Fragment,null,e)))}));var nn=a(175);const sn=()=>{const{services:{application:{getUrlForApp:e}}}=Object(f.b)(),{jobCreator:t,jobCreatorUpdate:a}=Object(n.useContext)(Ve),[i,s]=Object(n.useState)(t.calendars),[r,o]=Object(n.useState)([]),[l,c]=Object(n.useState)([]),[d,u]=Object(n.useState)(!1);async function p(){u(!0);const e=(await ge.ml.calendars()).filter((e=>!1===e.job_ids.includes(nn.a)));c(e.map((e=>({label:e.calendar_id,value:e})))),o(i.map((e=>({label:e.calendar_id,value:e})))),u(!1)}Object(n.useEffect)((()=>{p()}),[]),Object(n.useEffect)((()=>{t.calendars=i,a()}),[i.join()]);const b={async:!0,options:l,selectedOptions:r,isLoading:d,onChange:e=>{o(e),s(e.map((e=>e.value)))}},h=e(m.e,{path:T.b.CALENDARS_MANAGE});return Object(N.jsx)(an,null,Object(N.jsx)(te.EuiFlexGroup,{gutterSize:"xs",alignItems:"center"},Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(te.EuiComboBox,v()({},b,{"data-test-subj":"mlJobWizardComboBoxCalendars"}))),Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiToolTip,{position:"right",content:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobDetailsStep.additionalSection.calendarsSelection.refreshCalendarsButtonLabel",defaultMessage:"Refresh calendars"})},Object(N.jsx)(te.EuiButtonIcon,{iconType:"refresh",color:"primary","aria-label":y.i18n.translate("xpack.ml.newJob.wizard.jobDetailsStep.additionalSection.calendarsSelection.refreshCalendarsButtonLabel",{defaultMessage:"Refresh calendars"}),onClick:p})))),Object(N.jsx)(te.EuiSpacer,{size:"xs"}),Object(N.jsx)(te.EuiText,{size:"s"},Object(N.jsx)(te.EuiLink,{href:h,target:"_blank",external:!0},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobDetailsStep.additionalSection.calendarsSelection.manageCalendarsButtonLabel",defaultMessage:"Manage calendars"}))))};var rn=a(251);const on=Object(n.memo)((({children:e})=>{const{services:{docLinks:t}}=Object(f.b)(),a=t.links.ml.customUrls,i=y.i18n.translate("xpack.ml.newJob.wizard.jobDetailsStep.additionalSection.customUrls.title",{defaultMessage:"Custom URLs"});return Object(N.jsx)(te.EuiDescribedFormGroup,{fullWidth:!0,className:"ml-custom-urls-selection",title:Object(N.jsx)("h3",null,i),description:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobDetailsStep.additionalSection.customUrlsSelection.description",defaultMessage:"Provide links from anomalies to Kibana dashboards, the Discovery page, or other web pages. {learnMoreLink}",values:{learnMoreLink:Object(N.jsx)(te.EuiLink,{href:a,target:"_blank"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobDetailsStep.additionalSection.customUrlsSelection.learnMoreLinkText",defaultMessage:"Learn more"}))}})},Object(N.jsx)(te.EuiFormRow,{fullWidth:!0},Object(N.jsx)(s.a.Fragment,null,e)))})),ln=()=>{var e;const{jobCreator:t,jobCreatorUpdate:a}=Object(n.useContext)(Ve),i={...t.jobConfig,datafeed_config:t.datafeedConfig};return Object(N.jsx)(on,null,Object(N.jsx)(rn.a,{job:i,jobCustomUrls:null!==(e=t.customUrls)&&void 0!==e?e:[],setCustomUrls:e=>{t.customUrls=e,a()},editMode:"modal"}))},cn=y.i18n.translate("xpack.ml.newJob.wizard.jobDetailsStep.additionalSectionButton",{defaultMessage:"Additional settings"}),dn=({additionalExpanded:e,setAdditionalExpanded:t})=>Object(N.jsx)(n.Fragment,null,Object(N.jsx)(te.EuiSpacer,null),Object(N.jsx)(te.EuiAccordion,{id:"additional-section",buttonContent:cn,onToggle:t,initialIsOpen:e,"data-test-subj":"mlJobWizardToggleAdditionalSettingsSection"},Object(N.jsx)("section",{"data-test-subj":"mlJobWizardAdditionalSettingsSection"},Object(N.jsx)(te.EuiSpacer,null),Object(N.jsx)(te.EuiFlexGroup,{gutterSize:"xl",style:{marginLeft:"0px",marginRight:"0px"}},Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(ln,null))),Object(N.jsx)(te.EuiFlexGroup,{gutterSize:"xl",style:{marginLeft:"0px",marginRight:"0px"}},Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(sn,null)),Object(N.jsx)(te.EuiFlexItem,null))))),un=({setCurrentStep:e,isCurrentStep:t,advancedExpanded:a,setAdvancedExpanded:i,additionalExpanded:s,setAdditionalExpanded:r})=>{const{jobCreator:o,jobValidator:l,jobValidatorUpdated:c}=Object(n.useContext)(Ve),[d,u]=Object(n.useState)(!1);return Object(n.useEffect)((()=>{var e,t;const a=l.jobId.valid&&l.modelMemoryLimit.valid&&l.groupIds.valid&&!0===(null===(e=l.latestValidationResult.jobIdExists)||void 0===e?void 0:e.valid)&&!0===(null===(t=l.latestValidationResult.groupIdsExist)||void 0===t?void 0:t.valid)&&!1===l.validating;u(a)}),[c]),Object(N.jsx)(n.Fragment,null,t&&Object(N.jsx)(n.Fragment,null,Object(N.jsx)(te.EuiFlexGroup,{gutterSize:"xl"},Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(Ui,null),Object(N.jsx)(Hi,null)),Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(qi,null))),Object(N.jsx)(dn,{additionalExpanded:s,setAdditionalExpanded:r}),Object(N.jsx)(tn,{advancedExpanded:a,setAdvancedExpanded:i}),Object(N.jsx)(He,{previous:()=>e(Je.PICK_FIELDS),next:()=>e(Je.VALIDATION),nextActive:d},Object(Fe.a)(o)&&Object(N.jsx)(Ni,{isDisabled:!1,jobEditorMode:Pi.EDITABLE,datafeedEditorMode:Pi.EDITABLE}))))};var pn=a(127),mn=a.n(pn),bn=a(27),hn=a(10);const fn=Object(E.once)((e=>({categorizer_detector_missing_per_partition_field:{status:bn.c.ERROR,text:y.i18n.translate("xpack.ml.models.jobValidation.messages.categorizerMissingPerPartitionFieldMessage",{defaultMessage:'Partition field must be set for detectors that reference "mlcategory" when per-partition categorization is enabled.'}),url:null==e?void 0:e.links.ml.anomalyDetectionConfiguringCategories},categorizer_varying_per_partition_fields:{status:bn.c.ERROR,text:y.i18n.translate("xpack.ml.models.jobValidation.messages.categorizerVaryingPerPartitionFieldNamesMessage",{defaultMessage:'Detectors with keyword "mlcategory" cannot have different partition_field_name when per-partition categorization is enabled. Found [{fields}].',values:{fields:'"{{fields}}"'}}),url:null==e?void 0:e.links.ml.anomalyDetectionConfiguringCategories},field_not_aggregatable:{status:bn.c.ERROR,text:y.i18n.translate("xpack.ml.models.jobValidation.messages.fieldNotAggregatableMessage",{defaultMessage:"Detector field {fieldName} is not an aggregatable field.",values:{fieldName:'"{{fieldName}}"'}}),url:null==e?void 0:e.links.ml.aggregrations},fields_not_aggregatable:{status:bn.c.ERROR,text:y.i18n.translate("xpack.ml.models.jobValidation.messages.fieldsNotAggregatableMessage",{defaultMessage:"One of the detector fields is not an aggregatable field."}),url:null==e?void 0:e.links.ml.aggregrations},cardinality_no_results:{status:bn.c.WARNING,heading:y.i18n.translate("xpack.ml.models.jobValidation.messages.cardinalityNoResultsHeading",{defaultMessage:"Field cardinality"}),text:y.i18n.translate("xpack.ml.models.jobValidation.messages.cardinalityNoResultsMessage",{defaultMessage:"Cardinality checks could not be run. The query to validate fields didn't return any documents."})},cardinality_field_not_exists:{status:bn.c.WARNING,heading:y.i18n.translate("xpack.ml.models.jobValidation.messages.cardinalityFieldNotExistsHeading",{defaultMessage:"Field cardinality"}),text:y.i18n.translate("xpack.ml.models.jobValidation.messages.cardinalityFieldNotExistsMessage",{defaultMessage:"Cardinality checks could not be run for field {fieldName}. The query to validate the field didn't return any documents.",values:{fieldName:'"{{fieldName}}"'}}),url:null==e?void 0:e.links.ml.aggregrations},cardinality_by_field:{status:bn.c.WARNING,text:y.i18n.translate("xpack.ml.models.jobValidation.messages.cardinalityByFieldMessage",{defaultMessage:"Cardinality of {fieldName} is above 1000 and might result in high memory usage.",values:{fieldName:'by_field "{{fieldName}}"'}}),url:null==e?void 0:e.links.ml.anomalyDetectionCardinality},cardinality_over_field_low:{status:bn.c.WARNING,text:y.i18n.translate("xpack.ml.models.jobValidation.messages.cardinalityOverFieldLowMessage",{defaultMessage:"Cardinality of {fieldName} is below 10 and might not be suitable for population analysis.",values:{fieldName:'over_field "{{fieldName}}"'}}),url:null==e?void 0:e.links.ml.anomalyDetectionCardinality},cardinality_over_field_high:{status:bn.c.WARNING,text:y.i18n.translate("xpack.ml.models.jobValidation.messages.cardinalityOverFieldHighMessage",{defaultMessage:"Cardinality of {fieldName} is above 1000000 and might result in high memory usage.",values:{fieldName:'over_field "{{fieldName}}"'}}),url:null==e?void 0:e.links.ml.anomalyDetectionCardinality},cardinality_partition_field:{status:bn.c.WARNING,text:y.i18n.translate("xpack.ml.models.jobValidation.messages.cardinalityPartitionFieldMessage",{defaultMessage:"Cardinality of {fieldName} is above 1000 and might result in high memory usage.",values:{fieldName:'partition_field "{{fieldName}}"'}}),url:null==e?void 0:e.links.ml.anomalyDetectionCardinality},cardinality_model_plot_high:{status:bn.c.WARNING,text:y.i18n.translate("xpack.ml.models.jobValidation.messages.cardinalityModelPlotHighMessage",{defaultMessage:"The estimated cardinality of {modelPlotCardinality} of fields relevant to creating model plots might result in resource intensive jobs.",values:{modelPlotCardinality:"{{modelPlotCardinality}}"}})},categorization_filters_valid:{status:bn.c.SUCCESS,text:y.i18n.translate("xpack.ml.models.jobValidation.messages.categorizationFiltersValidMessage",{defaultMessage:"Categorization filters checks passed."}),url:null==e?void 0:e.links.ml.anomalyDetectionConfiguringCategories},categorization_filters_invalid:{status:bn.c.ERROR,text:y.i18n.translate("xpack.ml.models.jobValidation.messages.categorizationFiltersInvalidMessage",{defaultMessage:"The categorization filters configuration is invalid. Make sure filters are valid regular expressions and {categorizationFieldName} is set.",values:{categorizationFieldName:'"categorization_field_name"'}}),url:null==e?void 0:e.links.ml.anomalyDetectionJobResourceAnalysisConfig},bucket_span_empty:{status:bn.c.ERROR,text:y.i18n.translate("xpack.ml.models.jobValidation.messages.bucketSpanEmptyMessage",{defaultMessage:"The bucket span field must be specified."}),url:null==e?void 0:e.links.ml.anomalyDetectionJobResourceAnalysisConfig},bucket_span_estimation_mismatch:{status:bn.c.INFO,heading:y.i18n.translate("xpack.ml.models.jobValidation.messages.bucketSpanEstimationMismatchHeading",{defaultMessage:"Bucket span"}),text:y.i18n.translate("xpack.ml.models.jobValidation.messages.bucketSpanEstimationMismatchMessage",{defaultMessage:"Current bucket span is {currentBucketSpan}, but bucket span estimation returned {estimateBucketSpan}.",values:{currentBucketSpan:'"{{currentBucketSpan}}"',estimateBucketSpan:'"{{estimateBucketSpan}}"'}}),url:null==e?void 0:e.links.ml.anomalyDetectionBucketSpan},bucket_span_high:{status:bn.c.INFO,heading:y.i18n.translate("xpack.ml.models.jobValidation.messages.bucketSpanHighHeading",{defaultMessage:"Bucket span"}),text:y.i18n.translate("xpack.ml.models.jobValidation.messages.bucketSpanHighMessage",{defaultMessage:"Bucket span is 1 day or more. Be aware that days are considered as UTC days, not local days."}),url:null==e?void 0:e.links.ml.anomalyDetectionBucketSpan},bucket_span_valid:{status:bn.c.SUCCESS,heading:y.i18n.translate("xpack.ml.models.jobValidation.messages.bucketSpanValidHeading",{defaultMessage:"Bucket span"}),text:y.i18n.translate("xpack.ml.models.jobValidation.messages.bucketSpanValidMessage",{defaultMessage:"Format of {bucketSpan} is valid.",values:{bucketSpan:'"{{bucketSpan}}"'}}),url:null==e?void 0:e.links.ml.anomalyDetectionJobResourceAnalysisConfig},bucket_span_invalid:{status:bn.c.ERROR,heading:y.i18n.translate("xpack.ml.models.jobValidation.messages.bucketSpanInvalidHeading",{defaultMessage:"Bucket span"}),text:y.i18n.translate("xpack.ml.models.jobValidation.messages.bucketSpanInvalidMessage",{defaultMessage:"The specified bucket span is not a valid time interval format e.g. 10m, 1h. It also needs to be higher than zero."}),url:null==e?void 0:e.links.ml.anomalyDetectionJobResourceAnalysisConfig},detectors_duplicates:{status:bn.c.ERROR,text:y.i18n.translate("xpack.ml.models.jobValidation.messages.detectorsDuplicatesMessage",{defaultMessage:"Duplicate detectors were found. Detectors having the same combined configuration for {functionParam}, {fieldNameParam}, {byFieldNameParam}, {overFieldNameParam} and {partitionFieldNameParam} are not allowed within the same job.",values:{functionParam:"'function'",fieldNameParam:"'field_name'",byFieldNameParam:"'by_field_name'",overFieldNameParam:"'over_field_name'",partitionFieldNameParam:"'partition_field_name'"}}),url:null==e?void 0:e.links.ml.anomalyDetectionDetectors},detectors_empty:{status:bn.c.ERROR,text:y.i18n.translate("xpack.ml.models.jobValidation.messages.detectorsEmptyMessage",{defaultMessage:"No detectors were found. At least one detector must be specified."}),url:null==e?void 0:e.links.ml.anomalyDetectionDetectors},detectors_function_empty:{status:bn.c.ERROR,text:y.i18n.translate("xpack.ml.models.jobValidation.messages.detectorsFunctionEmptyMessage",{defaultMessage:"One of the detector functions is empty."}),url:null==e?void 0:e.links.ml.anomalyDetectionDetectors},detectors_function_not_empty:{status:bn.c.SUCCESS,heading:y.i18n.translate("xpack.ml.models.jobValidation.messages.detectorsFunctionNotEmptyHeading",{defaultMessage:"Detector functions"}),text:y.i18n.translate("xpack.ml.models.jobValidation.messages.detectorsFunctionNotEmptyMessage",{defaultMessage:"Presence of detector functions validated in all detectors."}),url:null==e?void 0:e.links.ml.anomalyDetectionDetectors},index_fields_invalid:{status:bn.c.ERROR,text:y.i18n.translate("xpack.ml.models.jobValidation.messages.indexFieldsInvalidMessage",{defaultMessage:"Could not load fields from index."})},index_fields_valid:{status:bn.c.SUCCESS,text:y.i18n.translate("xpack.ml.models.jobValidation.messages.indexFieldsValidMessage",{defaultMessage:"Index fields are present in the datafeed."})},influencer_high:{status:bn.c.WARNING,text:y.i18n.translate("xpack.ml.models.jobValidation.messages.influencerHighMessage",{defaultMessage:"The job configuration includes more than 3 influencers. Consider using fewer influencers or creating multiple jobs."}),url:null==e?void 0:e.links.ml.anomalyDetectionInfluencers},influencer_low:{status:bn.c.WARNING,text:y.i18n.translate("xpack.ml.models.jobValidation.messages.influencerLowMessage",{defaultMessage:"No influencers have been configured. Picking an influencer is strongly recommended."}),url:null==e?void 0:e.links.ml.anomalyDetectionInfluencers},influencer_low_suggestion:{status:bn.c.WARNING,text:y.i18n.translate("xpack.ml.models.jobValidation.messages.influencerLowSuggestionMessage",{defaultMessage:"No influencers have been configured. Consider using {influencerSuggestion} as an influencer.",values:{influencerSuggestion:"{{influencerSuggestion}}"}}),url:null==e?void 0:e.links.ml.anomalyDetectionInfluencers},influencer_low_suggestions:{status:bn.c.WARNING,text:y.i18n.translate("xpack.ml.models.jobValidation.messages.influencerLowSuggestionsMessage",{defaultMessage:"No influencers have been configured. Consider using one or more of {influencerSuggestion}.",values:{influencerSuggestion:"{{influencerSuggestion}}"}}),url:null==e?void 0:e.links.ml.anomalyDetectionInfluencers},job_id_empty:{status:bn.c.ERROR,text:y.i18n.translate("xpack.ml.models.jobValidation.messages.jobIdEmptyMessage",{defaultMessage:"Job ID field must not be empty."}),url:null==e?void 0:e.links.ml.anomalyDetectionJobResource},job_id_invalid:{status:bn.c.ERROR,text:y.i18n.translate("xpack.ml.models.jobValidation.messages.jobIdInvalidMessage",{defaultMessage:"Job ID is invalid. It can contain lowercase alphanumeric (a-z and 0-9) characters, hyphens or underscores and must start and end with an alphanumeric character."}),url:null==e?void 0:e.links.ml.anomalyDetectionJobResource},job_id_invalid_max_length:{status:bn.c.ERROR,text:y.i18n.translate("xpack.ml.models.jobValidation.messages.jobIdInvalidMaxLengthErrorMessage",{defaultMessage:"Job ID must be no more than {maxLength, plural, one {# character} other {# characters}} long.",values:{maxLength:bn.b}}),url:null==e?void 0:e.links.ml.anomalyDetectionJobResource},job_id_valid:{status:bn.c.SUCCESS,heading:y.i18n.translate("xpack.ml.models.jobValidation.messages.jobIdValidHeading",{defaultMessage:"Job ID format is valid"}),text:y.i18n.translate("xpack.ml.models.jobValidation.messages.jobIdValidMessage",{defaultMessage:"Lowercase alphanumeric (a-z and 0-9) characters, hyphens or underscores, starts and ends with an alphanumeric character, and is no more than {maxLength, plural, one {# character} other {# characters}} long.",values:{maxLength:bn.b}}),url:null==e?void 0:e.links.ml.anomalyDetectionJobResource},job_group_id_invalid:{status:bn.c.ERROR,text:y.i18n.translate("xpack.ml.models.jobValidation.messages.jobGroupIdInvalidMessage",{defaultMessage:"One of the job group names is invalid. They can contain lowercase alphanumeric (a-z and 0-9) characters, hyphens or underscores and must start and end with an alphanumeric character."}),url:null==e?void 0:e.links.ml.anomalyDetectionJobResource},job_group_id_invalid_max_length:{status:bn.c.ERROR,text:y.i18n.translate("xpack.ml.models.jobValidation.messages.jobGroupIdInvalidMaxLengthErrorMessage",{defaultMessage:"Job group name must be no more than {maxLength, plural, one {# character} other {# characters}} long.",values:{maxLength:bn.b}}),url:null==e?void 0:e.links.ml.anomalyDetectionJobResource},job_group_id_valid:{status:bn.c.SUCCESS,heading:y.i18n.translate("xpack.ml.models.jobValidation.messages.jobGroupIdValidHeading",{defaultMessage:"Job group id formats are valid"}),text:y.i18n.translate("xpack.ml.models.jobValidation.messages.jobGroupIdValidMessage",{defaultMessage:"Lowercase alphanumeric (a-z and 0-9) characters, hyphens or underscores, starts and ends with an alphanumeric character, and is no more than {maxLength, plural, one {# character} other {# characters}} long.",values:{maxLength:bn.b}}),url:null==e?void 0:e.links.ml.anomalyDetectionJobResource},missing_summary_count_field_name:{status:bn.c.ERROR,text:y.i18n.translate("xpack.ml.models.jobValidation.messages.missingSummaryCountFieldNameMessage",{defaultMessage:"A job configured with a datafeed with aggregations must set summary_count_field_name; use doc_count or suitable alternative."})},skipped_extended_tests:{status:bn.c.WARNING,text:y.i18n.translate("xpack.ml.models.jobValidation.messages.skippedExtendedTestsMessage",{defaultMessage:"Skipped additional checks because the basic requirements of the job configuration were not met."})},success_cardinality:{status:bn.c.SUCCESS,heading:y.i18n.translate("xpack.ml.models.jobValidation.messages.successCardinalityHeading",{defaultMessage:"Cardinality"}),text:y.i18n.translate("xpack.ml.models.jobValidation.messages.successCardinalityMessage",{defaultMessage:"Cardinality of detector fields is within recommended bounds."}),url:null==e?void 0:e.links.ml.anomalyDetectionCardinality},success_bucket_span:{status:bn.c.SUCCESS,heading:y.i18n.translate("xpack.ml.models.jobValidation.messages.successBucketSpanHeading",{defaultMessage:"Bucket span"}),text:y.i18n.translate("xpack.ml.models.jobValidation.messages.successBucketSpanMessage",{defaultMessage:"Format of {bucketSpan} is valid and passed validation checks.",values:{bucketSpan:'"{{bucketSpan}}"'}}),url:null==e?void 0:e.links.ml.anomalyDetectionBucketSpan},success_influencers:{status:bn.c.SUCCESS,text:y.i18n.translate("xpack.ml.models.jobValidation.messages.successInfluencersMessage",{defaultMessage:"Influencer configuration passed the validation checks."}),url:null==e?void 0:e.links.ml.anomalyDetectionInfluencers},estimated_mml_greater_than_max_mml:{status:bn.c.WARNING,text:y.i18n.translate("xpack.ml.models.jobValidation.messages.estimatedMmlGreaterThanMaxMmlMessage",{defaultMessage:"The estimated model memory limit is greater than the max model memory limit configured for this cluster."})},mml_greater_than_effective_max_mml:{status:bn.c.WARNING,text:y.i18n.translate("xpack.ml.models.jobValidation.messages.mmlGreaterThanEffectiveMaxMmlMessage",{defaultMessage:"Job will not be able to run in the current cluster because model memory limit is higher than {effectiveMaxModelMemoryLimit}.",values:{effectiveMaxModelMemoryLimit:"{{effectiveMaxModelMemoryLimit}}"}})},mml_greater_than_max_mml:{status:bn.c.ERROR,text:y.i18n.translate("xpack.ml.models.jobValidation.messages.mmlGreaterThanMaxMmlMessage",{defaultMessage:"The model memory limit is greater than the max model memory limit configured for this cluster."})},mml_value_invalid:{status:bn.c.ERROR,text:y.i18n.translate("xpack.ml.models.jobValidation.messages.mmlValueInvalidMessage",{defaultMessage:"{mml} is not a valid value for model memory limit. The value needs to be at least 1MB and should be specified in bytes e.g. 10MB.",values:{mml:"{{mml}}"}}),url:null==e?void 0:e.links.ml.anomalyDetectionModelMemoryLimits},half_estimated_mml_greater_than_mml:{status:bn.c.WARNING,text:y.i18n.translate("xpack.ml.models.jobValidation.messages.halfEstimatedMmlGreaterThanMmlMessage",{defaultMessage:"The specified model memory limit is less than half of the estimated model memory limit and will likely hit the hard limit."}),url:null==e?void 0:e.links.ml.anomalyDetectionModelMemoryLimits},estimated_mml_greater_than_mml:{status:bn.c.INFO,text:y.i18n.translate("xpack.ml.models.jobValidation.messages.estimatedMmlGreaterThanMmlMessage",{defaultMessage:"The estimated model memory limit is greater than the model memory limit you have configured."}),url:null==e?void 0:e.links.ml.anomalyDetectionModelMemoryLimits},success_mml:{status:bn.c.SUCCESS,heading:y.i18n.translate("xpack.ml.models.jobValidation.messages.successMmlHeading",{defaultMessage:"Model memory limit"}),text:y.i18n.translate("xpack.ml.models.jobValidation.messages.successMmlMessage",{defaultMessage:"Valid and within the estimated model memory limit."}),url:null==e?void 0:e.links.ml.anomalyDetectionModelMemoryLimits},success_time_range:{status:bn.c.SUCCESS,heading:y.i18n.translate("xpack.ml.models.jobValidation.messages.successTimeRangeHeading",{defaultMessage:"Time range"}),text:y.i18n.translate("xpack.ml.models.jobValidation.messages.successTimeRangeMessage",{defaultMessage:"Valid and long enough to model patterns in the data."})},time_field_invalid:{status:bn.c.ERROR,text:y.i18n.translate("xpack.ml.models.jobValidation.messages.timeFieldInvalidMessage",{defaultMessage:"{timeField} cannot be used as the time field because it is not a field of type 'date' or 'date_nanos'.",values:{timeField:"'{{timeField}}'"}})},time_range_short:{status:bn.c.WARNING,heading:y.i18n.translate("xpack.ml.models.jobValidation.messages.timeRangeShortHeading",{defaultMessage:"Time range"}),text:y.i18n.translate("xpack.ml.models.jobValidation.messages.timeRangeShortMessage",{defaultMessage:"The selected or available time range might be too short. The recommended minimum time range should be at least {minTimeSpanReadable} and {bucketSpanCompareFactor} times the bucket span.",values:{minTimeSpanReadable:"{{minTimeSpanReadable}}",bucketSpanCompareFactor:"{{bucketSpanCompareFactor}}"}})},time_range_before_epoch:{status:bn.c.WARNING,heading:y.i18n.translate("xpack.ml.models.jobValidation.messages.timeRangeBeforeEpochHeading",{defaultMessage:"Time range"}),text:y.i18n.translate("xpack.ml.models.jobValidation.messages.timeRangeBeforeEpochMessage",{defaultMessage:"The selected or available time range contains data with timestamps before the UNIX epoch beginning. Timestamps before 01/01/1970 00:00:00 (UTC) are not supported for machine learning jobs."})},datafeed_preview_no_documents:{status:bn.c.WARNING,heading:y.i18n.translate("xpack.ml.models.jobValidation.messages.datafeedPreviewNoDocumentsHeading",{defaultMessage:"Datafeed preview"}),text:y.i18n.translate("xpack.ml.models.jobValidation.messages.datafeedPreviewNoDocumentsMessage",{defaultMessage:"Running the datafeed preview over the current job configuration produces no results. If the index contains no documents this warning can be ignored, otherwise the job may be misconfigured."})},datafeed_preview_failed:{status:bn.c.ERROR,text:y.i18n.translate("xpack.ml.models.jobValidation.messages.datafeedPreviewFailedMessage",{defaultMessage:"The datafeed preview failed. This may be due to an error in the job or datafeed configurations."})}}))),gn=e=>{switch(e){case bn.c.INFO:return"primary";case bn.c.ERROR:return"danger";default:return e}},jn=e=>{switch(e){case bn.c.INFO:return"iInCircle";case bn.c.ERROR:return"cross";case bn.c.SUCCESS:return"check";case bn.c.WARNING:return"alert";default:return e}},xn=({url:e})=>Object(N.jsx)(te.EuiLink,{href:e,target:"_BLANK"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.validateJob.learnMoreLinkText",defaultMessage:"Learn more"})),vn=({text:e,url:t})=>Object(N.jsx)(s.a.Fragment,null,e," ",t&&Object(N.jsx)(xn,{url:t})),yn=({heading:e,status:t,text:a,url:i})=>Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(te.EuiCallOut,{"data-test-subj":"mlValidationCallout",color:gn(t),size:"s",title:e||Object(N.jsx)(vn,{text:a,url:i}),iconType:t?jn(t):"questionInCircle"},e&&Object(N.jsx)(vn,{text:a,url:i})),Object(N.jsx)(te.EuiSpacer,{size:"m"})),On="questionInCircle",En=()=>({ui:{iconType:On,isLoading:!0,isModalVisible:!1},data:{messages:[],success:!1},title:""}),wn=({messages:e,idFilterList:t})=>{const a=e.filter((e=>!1===t.includes(e.id))).map(((e,t)=>Object(N.jsx)(yn,v()({key:`${e.id}_${t}`},e)))),i=Object(N.jsx)(yn,{text:y.i18n.translate("xpack.ml.validateJob.allPassed",{defaultMessage:"All validation checks passed successfully"}),status:bn.c.SUCCESS});return Object(N.jsx)(s.a.Fragment,null,a.length?a:i)},_n=()=>Object(N.jsx)(te.EuiFlexGroup,{justifyContent:"spaceAround",alignItems:"center"},Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiLoadingSpinner,{size:"xl"}))),Sn=({close:e,title:t,children:a})=>Object(N.jsx)(te.EuiModal,{onClose:e,style:{width:"800px"}},Object(N.jsx)(te.EuiModalHeader,null,Object(N.jsx)(te.EuiModalHeaderTitle,null,t)),Object(N.jsx)(te.EuiModalBody,null,a),Object(N.jsx)(te.EuiModalFooter,null,Object(N.jsx)(te.EuiButton,{onClick:e,size:"s",fill:!0},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.validateJob.modal.closeButtonLabel",defaultMessage:"Close"}))));Sn.propType={close:mn.a.func.isRequired,title:mn.a.string};class validate_job_view_ValidateJobUI extends n.Component{constructor(e){super(e),Ce()(this,"closeModal",(()=>{const e=En();e.ui.iconType=this.state.ui.iconType,this.setState(e)})),Ce()(this,"validate",(()=>{const e=this.props.getJobConfig(),t=this.props.getDuration,a="function"==typeof t?t():void 0,i=this.props.fields;if("object"==typeof e)if("object"==typeof a&&null!==a.start&&null!==a.end){let t=!0;this.props.ml.validateJob({duration:a,fields:i,job:e}).then((a=>{const i=((e,t)=>{const a=fn(t);return e.map((e=>{const t=e.id,i=a[t];return void 0!==i?(void 0!==i.heading&&(e.heading=Object(hn.c)(i.heading,e)),e.text=Object(hn.c)(i.text,e),void 0!==i.url&&(e.url=i.url),e.status=i.status):e.text=y.i18n.translate("xpack.ml.models.jobValidation.unknownMessageIdErrorMessage",{defaultMessage:"{messageId} (unknown message id)",values:{messageId:t}}),e}))})(a,Object(d.c)());t=!1;const n=i.some((e=>e.status===bn.c.ERROR));n&&i.push({id:"job_validation_includes_error",text:y.i18n.translate("xpack.ml.validateJob.jobValidationIncludesErrorText",{defaultMessage:"Job validation has failed, but you can still continue and create the job. Please be aware the job may encounter problems when running."}),status:bn.c.WARNING}),this.setState({...this.state,ui:{...this.state.ui,iconType:jn(Object(ri.b)(i)),isLoading:!1,isModalVisible:!0},data:{messages:i,success:!0},title:e.job_id}),"function"==typeof this.props.setIsValid&&this.props.setIsValid(!n)})).catch((e=>{const{toasts:t}=this.props.kibana.services.notifications;Object(Et.b)(t).displayErrorToast(e,y.i18n.translate("xpack.ml.jobService.validateJobErrorTitle",{defaultMessage:"Job Validation Error"}))}));setTimeout((()=>{t&&this.setState({...this.state,ui:{...this.state.ui,isLoading:!0,isModalVisible:!1}})}),250)}else this.setState({...this.state,ui:{...this.state.ui,iconType:jn(bn.c.WARNING),isLoading:!1,isModalVisible:!0},data:{messages:[{id:"job_validation_skipped",text:y.i18n.translate("xpack.ml.validateJob.jobValidationSkippedText",{defaultMessage:"Job validation could not be run because of insufficient sample data. Please be aware the job may encounter problems when running."}),status:bn.c.WARNING}],success:!0},title:e.job_id}),"function"==typeof this.props.setIsValid&&this.props.setIsValid(!0)})),this.state=En()}componentDidMount(){!0===this.props.embedded&&this.validate()}render(){const e=Object(d.c)().links.ml.anomalyDetectionJobTips,t=!1!==this.props.fill,a=!0===this.props.isCurrentJobConfig,i=!0===this.props.isDisabled,s=!0===this.props.embedded,r=this.props.idFilterList||[],o=this.state.ui.isLoading;return Object(N.jsx)(n.Fragment,null,!1===s?Object(N.jsx)("div",null,Object(N.jsx)(te.EuiButton,{onClick:this.validate,size:"s",fill:t,iconType:a?this.state.ui.iconType:On,iconSide:"right",isDisabled:i,isLoading:o},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.validateJob.validateJobButtonLabel",defaultMessage:"Validate Job"})),!i&&this.state.ui.isModalVisible&&Object(N.jsx)(Sn,{close:this.closeModal,title:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.validateJob.modal.validateJobTitle",defaultMessage:"Validate job {title}",values:{title:this.state.title}})},o?Object(N.jsx)(_n,null):Object(N.jsx)(wn,{messages:this.state.data.messages,idFilterList:r}),Object(N.jsx)(te.EuiText,null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.validateJob.modal.jobValidationDescriptionText",defaultMessage:"Job validation performs certain checks against job configurations and underlying source data and provides specific advice on how to adjust settings that are more likely to produce insightful results."})),Object(N.jsx)(te.EuiText,null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.validateJob.modal.linkToJobTipsText",defaultMessage:"For more information, see {mlJobTipsLink}.",values:{mlJobTipsLink:Object(N.jsx)(te.EuiLink,{href:e,target:"_blank"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.validateJob.modal.linkToJobTipsText.mlJobTipsLinkText",defaultMessage:"Machine Learning Job Tips"}))}})))):Object(N.jsx)(n.Fragment,null,o?Object(N.jsx)(_n,null):Object(N.jsx)(wn,{messages:this.state.data.messages,idFilterList:r})))}}const Mn=Object(c.withKibana)(validate_job_view_ValidateJobUI),kn=["job_id_valid","job_group_id_valid","detectors_function_not_empty","success_bucket_span"],Cn=({setCurrentStep:e,isCurrentStep:t})=>{const{jobCreator:a,jobCreatorUpdate:i,jobValidator:s}=Object(n.useContext)(Ve),[r,o]=Object(n.useState)(!1);return a.type===oe.f.ADVANCED&&kn.push("time_range_short","success_time_range"),Object(n.useEffect)((()=>{s.validate((()=>{}),!0),i()}),[]),Object(N.jsx)(n.Fragment,null,t&&Object(N.jsx)(n.Fragment,null,Object(N.jsx)(Mn,{getJobConfig:function(){return{...a.jobConfig,datafeed_config:a.datafeedConfig}},getDuration:function(){return{start:a.start,end:a.end}},ml:ge.ml,embedded:!0,setIsValid:function(e){s.advancedValid=e,o(e)},idFilterList:kn}),Object(N.jsx)(He,{previous:()=>e(Je.JOB_DETAILS),next:()=>e(Je.SUMMARY),nextActive:r})),!1===t&&Object(N.jsx)(n.Fragment,null))},Tn=y.i18n.translate("xpack.ml.newJob.wizard.summaryStep.trueLabel",{defaultMessage:"True"}),Fn=y.i18n.translate("xpack.ml.newJob.wizard.summaryStep.falseLabel",{defaultMessage:"False"}),In=y.i18n.translate("xpack.ml.newJob.wizard.summaryStep.defaultString",{defaultMessage:"default"}),Dn=()=>Object(N.jsx)(te.EuiTitle,{size:"s"},Object(N.jsx)("h3",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.summaryStep.jobConfig.title",defaultMessage:"Job configuration"}))),An=()=>Object(N.jsx)(te.EuiTitle,{size:"s"},Object(N.jsx)("h3",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.summaryStep.datafeedConfig.title",defaultMessage:"Datafeed configuration"}))),Ln=({children:e})=>Object(N.jsx)("span",{style:{fontStyle:"italic"}},e),Rn=()=>{const{jobCreator:e}=Object(n.useContext)(Ve),t=Object(g.b)().kibanaConfig.get("dateFormat"),{anomaly_detectors:a}=Object(A.c)(),i=Object(Fe.a)(e),s=a.model_memory_limit||"",r=null!==e.modelMemoryLimit?e.modelMemoryLimit:Object(N.jsx)(Ln,null,`${s} (${In})`),o=[{title:y.i18n.translate("xpack.ml.newJob.wizard.summaryStep.jobDetails.jobDetails.title",{defaultMessage:"Job ID"}),description:e.jobId},{title:y.i18n.translate("xpack.ml.newJob.wizard.summaryStep.jobDetails.jobDescription.title",{defaultMessage:"Job description"}),description:e.description.length>0?e.description:Object(N.jsx)(Ln,null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.summaryStep.jobDetails.jobDescription.placeholder",defaultMessage:"No description provided"}))},{title:y.i18n.translate("xpack.ml.newJob.wizard.summaryStep.jobDetails.groups.title",{defaultMessage:"Groups"}),description:e.groups.length>0?e.groups.join(", "):Object(N.jsx)(Ln,null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.summaryStep.jobDetails.groups.placeholder",defaultMessage:"No groups selected"}))}],l=[{title:y.i18n.translate("xpack.ml.newJob.wizard.summaryStep.jobDetails.bucketSpan.title",{defaultMessage:"Bucket span"}),description:e.bucketSpan}];Object(Fe.c)(e)&&l.push({title:y.i18n.translate("xpack.ml.newJob.wizard.summaryStep.jobDetails.splitField.title",{defaultMessage:"Split field"}),description:Object(Fe.c)(e)&&null!==e.splitField?e.splitField.name:Object(N.jsx)(Ln,null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.summaryStep.jobDetails.splitField.placeholder",defaultMessage:"No split field selected"}))}),Object(Fe.d)(e)&&l.push({title:y.i18n.translate("xpack.ml.newJob.wizard.summaryStep.jobDetails.populationField.title",{defaultMessage:"Population field"}),description:Object(Fe.d)(e)&&null!==e.populationField?e.populationField.name:Object(N.jsx)("span",{style:{fontStyle:null!==e.populationField?"inherit":"italic"}},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.summaryStep.jobDetails.populationField.placeholder",defaultMessage:"No population field selected"}))}),i&&null!==e.categorizationFieldName&&l.push({title:y.i18n.translate("xpack.ml.newJob.wizard.summaryStep.jobDetails.categorizationField.title",{defaultMessage:"Categorization field"}),description:e.categorizationFieldName}),i&&null!==e.summaryCountFieldName&&l.push({title:y.i18n.translate("xpack.ml.newJob.wizard.summaryStep.jobDetails.summaryCountField.title",{defaultMessage:"Summary count field"}),description:e.summaryCountFieldName}),l.push({title:y.i18n.translate("xpack.ml.newJob.wizard.summaryStep.jobDetails.influencers.title",{defaultMessage:"Influencers"}),description:e.influencers.length>0?e.influencers.join(", "):Object(N.jsx)(Ln,null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.summaryStep.jobDetails.influencers.placeholder",defaultMessage:"No influencers selected"}))});const c=[{title:y.i18n.translate("xpack.ml.newJob.wizard.summaryStep.jobDetails.enableModelPlot.title",{defaultMessage:"Enable model plot"}),description:e.modelPlot?Tn:Fn},{title:y.i18n.translate("xpack.ml.newJob.wizard.summaryStep.jobDetails.useDedicatedIndex.title",{defaultMessage:"Use dedicated index"}),description:e.useDedicatedIndex?Tn:Fn},{title:y.i18n.translate("xpack.ml.newJob.wizard.summaryStep.jobDetails.modelMemoryLimit.title",{defaultMessage:"Model memory limit"}),description:r}],d=[{title:y.i18n.translate("xpack.ml.newJob.wizard.summaryStep.timeRange.start.title",{defaultMessage:"Start"}),description:qe()(e.start).format(t)},{title:y.i18n.translate("xpack.ml.newJob.wizard.summaryStep.timeRange.end.title",{defaultMessage:"End"}),description:qe()(e.end).format(t)}];return Object(N.jsx)(te.EuiFlexGroup,null,Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(te.EuiDescriptionList,{compressed:!0,listItems:o})),Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(te.EuiDescriptionList,{compressed:!0,listItems:l})),Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(te.EuiDescriptionList,{compressed:!0,listItems:c})),!1===i&&Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(te.EuiDescriptionList,{compressed:!0,listItems:d})))},Pn=()=>{const{jobCreator:e}=Object(n.useContext)(Ve),{datafeeds:t}=Object(A.c)(),a=JSON.stringify(e.query,null,2),i=Object(Te.f)(e.bucketSpanMs/1e3),s=t.scroll_size||"",r=e.queryDelay||Object(N.jsx)(Ln,null,`${oe.d} (${In})`),o=e.frequency||Object(N.jsx)(Ln,null,`${i}s (${In})`),l=null!==e.scrollSize?`${e.scrollSize}`:Object(N.jsx)(Ln,null,`${s} (${In})`),c=[{title:y.i18n.translate("xpack.ml.newJob.wizard.summaryStep.datafeedDetails.timeField.title",{defaultMessage:"Time field"}),description:e.timeFieldName},{title:y.i18n.translate("xpack.ml.newJob.wizard.summaryStep.datafeedDetails.queryDelay.title",{defaultMessage:"Query delay"}),description:r},{title:y.i18n.translate("xpack.ml.newJob.wizard.summaryStep.datafeedDetails.frequency.title",{defaultMessage:"Frequency"}),description:o},{title:y.i18n.translate("xpack.ml.newJob.wizard.summaryStep.datafeedDetails.scrollSize.title",{defaultMessage:"Scroll size"}),description:l}],d=y.i18n.translate("xpack.ml.newJob.wizard.summaryStep.datafeedDetails.query.title",{defaultMessage:"Elasticsearch query"});return Object(N.jsx)(te.EuiFlexGroup,null,Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(te.EuiFormRow,{label:d,fullWidth:!0},Object(N.jsx)(si.a,{value:a,height:"200px",readOnly:!0}))),Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(te.EuiDescriptionList,{compressed:!0,listItems:c})))},Nn=()=>{const{jobCreator:e}=Object(n.useContext)(Ve);return Object(N.jsx)(n.Fragment,null,e.type===oe.f.SINGLE_METRIC&&Object(N.jsx)(Nt,{isActive:!1}),e.type===oe.f.MULTI_METRIC&&Object(N.jsx)(Zt,{isActive:!1}),e.type===oe.f.POPULATION&&Object(N.jsx)(la,{isActive:!1}),e.type===oe.f.ADVANCED&&Object(N.jsx)(Za,{isActive:!1}),e.type===oe.f.CATEGORIZATION&&Object(N.jsx)(vi,{isActive:!1}),e.type===oe.f.RARE&&Object(N.jsx)(Di,{isActive:!1}))},zn=({progress:e})=>e>0&&e<100?Object(N.jsx)(te.EuiProgress,{value:e,color:"primary",size:"xs",max:100}):null;var Bn=a(95),Jn=a(208);const Vn=({jobRunner:e})=>{const{services:{notifications:t}}=Object(f.b)(),{jobCreator:a}=Object(n.useContext)(Ve),[i,s]=Object(n.useState)(Bn.a.STOPPED),[r,o]=Object(n.useState)(!1);return Object(N.jsx)(n.Fragment,null,Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiButton,{isDisabled:i===Bn.a.STARTING||i===Bn.a.STARTED,onClick:async function(){const{toasts:i}=t;if(s(Bn.a.STARTING),null!==e)try{const t=await e.startDatafeedInRealTime(!0);s(!0===t?Bn.a.STARTED:Bn.a.STOPPED),i.addSuccess({title:y.i18n.translate("xpack.ml.newJob.wizard.summaryStep.postSaveOptions.startJobInRealTimeSuccess",{defaultMessage:"Job {jobId} started",values:{jobId:a.jobId}})})}catch(e){s(Bn.a.STOPPED),i.addDanger({title:y.i18n.translate("xpack.ml.newJob.wizard.summaryStep.postSaveOptions.startJobInRealTimeError",{defaultMessage:"Error starting job"}),text:Object(ze.b)(e)})}},"data-test-subj":"mlJobWizardButtonRunInRealTime"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.summaryStep.postSaveOptions.startJobInRealTime",defaultMessage:"Start job running in real time"}))),Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiButton,{isDisabled:i===Bn.a.STOPPED||i===Bn.a.STARTING,onClick:o.bind(null,!0),"data-test-subj":"mlJobWizardButtonCreateAlert"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.summaryStep.postSaveOptions.createAlert",defaultMessage:"Create alert rule"}))),i===Bn.a.STARTED&&r&&Object(N.jsx)(Jn.c,{jobIds:[a.jobId],onCloseFlyout:o.bind(null,!1)}))},Un=({startDatafeed:e,setStartDatafeed:t,disabled:a=!1})=>Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(te.EuiSpacer,null),Object(N.jsx)(te.EuiFormRow,{helpText:y.i18n.translate("xpack.ml.newJob.wizard.summaryStep.startDatafeedCheckboxHelpText",{defaultMessage:"If unselected, job can be started later from the jobs list."})},Object(N.jsx)(te.EuiSwitch,{"data-test-subj":"mlJobWizardStartDatafeedCheckbox",label:y.i18n.translate("xpack.ml.newJob.wizard.summaryStep.startDatafeedCheckbox",{defaultMessage:"Start immediately"}),checked:e,onChange:e=>t(e.target.checked),disabled:a})));var Gn=a(151);const qn=({setCurrentStep:e,isCurrentStep:t})=>{const{services:{notifications:a,http:{basePath:i}}}=Object(f.b)(),s=Object(f.e)(),{jobCreator:r,jobValidator:o,jobValidatorUpdated:l,resultsLoader:c}=Object(n.useContext)(Ve),[d,u]=Object(n.useState)(c.progress),[p,m]=Object(n.useState)(!1),[b,h]=Object(n.useState)(o.validationSummary.basic),[g,j]=Object(n.useState)(null),[x,v]=Object(n.useState)(!0),[O,E]=Object(n.useState)(!1),w=Object(Fe.a)(r),_=w?Pi.EDITABLE:Pi.READONLY;async function S(e=!0){try{await r.createJob(),await r.createDatafeed(),Object(St.a)(e?r:null,s)}catch(e){M(e)}}function M(e){const{displayErrorToast:t}=Object(Et.b)(a.toasts);t(e,y.i18n.translate("xpack.ml.newJob.wizard.summaryStep.createJobError",{defaultMessage:"Job creation error"})),m(!1)}Object(n.useEffect)((()=>{r.subscribeToProgress(u)}),[]),Object(n.useEffect)((()=>{let e=null;return null!==g&&(e=g.subscribeToJobAssignment((e=>E(!e)))),()=>{var t;null!==e&&(null===(t=e)||void 0===t||t.unsubscribe())}}),[g]);return Object(n.useEffect)((()=>{h(o.validationSummary.basic)}),[l]),Object(N.jsx)(n.Fragment,null,t&&Object(N.jsx)(n.Fragment,null,w&&Object(N.jsx)(Dn,null),Object(N.jsx)(Nn,null),Object(N.jsx)(te.EuiSpacer,{size:"m"}),Object(N.jsx)(zn,{progress:d}),Object(N.jsx)(te.EuiSpacer,{size:"m"}),Object(N.jsx)(Rn,null),!1===w&&Object(N.jsx)(Un,{startDatafeed:x,setStartDatafeed:v,disabled:p}),w&&Object(N.jsx)(n.Fragment,null,Object(N.jsx)(te.EuiHorizontalRule,null),Object(N.jsx)(An,null),Object(N.jsx)(te.EuiSpacer,{size:"m"}),Object(N.jsx)(Pn,null)),Object(N.jsx)(te.EuiHorizontalRule,null),O&&Object(N.jsx)(Gn.b,{jobType:"anomaly-detector"}),Object(N.jsx)(te.EuiFlexGroup,null,d<100&&Object(N.jsx)(n.Fragment,null,Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(We,{previous:()=>e(Je.VALIDATION),previousActive:!1===p&&!0===b})),Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiButton,{onClick:async function(){m(!0),w?await S():!0===x?await async function(){try{const e=await r.createAndStartJob();j(e)}catch(e){M(e)}}():await S(!1)},isDisabled:!0===p||!1===b,"data-test-subj":"mlJobWizardButtonCreateJob",fill:!0},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.summaryStep.createJobButton",defaultMessage:"Create job"})))),!1===p&&Object(N.jsx)(n.Fragment,null,Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(Ni,{isDisabled:d>0,jobEditorMode:_,datafeedEditorMode:_})),!1===w&&Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiButtonEmpty,{onClick:()=>{Object(St.d)(r,s)}},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.summaryStep.convertToAdvancedButton",defaultMessage:"Convert to advanced job"})))),d>0&&Object(N.jsx)(n.Fragment,null,Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiButton,{onClick:function(){const e=re.a.createResultsUrl([r.jobId],r.start,r.end,!0===Object(Fe.f)(r)?"timeseriesexplorer":"explorer");s(`${i.get()}/app/ml/${e}`)},"data-test-subj":"mlJobWizardButtonViewResults"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.summaryStep.viewResultsButton",defaultMessage:"View results"})))),100===d&&Object(N.jsx)(n.Fragment,null,Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiButton,{onClick:function(){Object(St.m)(r,s)},"data-test-subj":"mlJobWizardButtonResetJob"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.summaryStep.resetJobButton",defaultMessage:"Reset job"}))),Object(N.jsx)(Vn,{jobRunner:g})))))},Hn=Object(n.memo)((({children:e})=>{const t=y.i18n.translate("xpack.ml.newJob.wizard.datafeedStep.query.title",{defaultMessage:"Elasticsearch query"});return Object(N.jsx)(te.EuiFormRow,{label:t,describedByIds:["description"],fullWidth:!0},Object(N.jsx)(s.a.Fragment,null,e))})),Wn=({setIsValidQuery:e})=>{const{jobCreator:t,jobCreatorUpdate:a,jobCreatorUpdated:i}=Object(n.useContext)(Ve),s=t,[r,o]=Object(n.useState)(JSON.stringify(s.query,null,2));return Object(n.useEffect)((()=>{const t=Object(ri.c)(r);e(t),t&&(s.query=JSON.parse(r),a())}),[r]),Object(n.useEffect)((()=>{if(Object(ri.c)(r)){const e=JSON.parse(r),t=JSON.stringify(e,null,2),a=JSON.stringify(s.query,null,2);t!==a&&o(a)}}),[i]),Object(n.useEffect)((()=>{const t=Object(ri.c)(r);e(t)}),[]),Object(N.jsx)(Hn,null,Object(N.jsx)(si.a,{value:r,height:"400px",readOnly:!1,onChange:function(e){o(e)}}))},$n=Object(n.memo)((({children:e,validation:t})=>{const a=y.i18n.translate("xpack.ml.newJob.wizard.datafeedStep.queryDelay.title",{defaultMessage:"Query delay"});return Object(N.jsx)(te.EuiDescribedFormGroup,{title:Object(N.jsx)("h3",null,a),description:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.datafeedStep.queryDelay.description",defaultMessage:"Time delay in seconds, between current time and latest input data time."})},Object(N.jsx)(te.EuiFormRow,{label:a,error:t.message,isInvalid:!1===t.valid},Object(N.jsx)(s.a.Fragment,null,e)))}));function Yn(e){const[t,a]=Object(n.useState)(i(e));function i(e){return null===e?"":e}return{value:t,setValue:function(e){a(i(e))}}}const Xn=()=>{const{jobCreator:e,jobCreatorUpdate:t,jobValidator:a,jobValidatorUpdated:i}=Object(n.useContext)(Ve),[s,r]=Object(n.useState)(a.queryDelay),{value:o,setValue:l}=Yn(e.queryDelay);return Object(n.useEffect)((()=>{e.queryDelay=""===o?null:o,t()}),[o]),Object(n.useEffect)((()=>{l(null===e.queryDelay?"":e.queryDelay)}),[t]),Object(n.useEffect)((()=>{r(a.queryDelay)}),[i]),Object(N.jsx)($n,{validation:s},Object(N.jsx)(te.EuiFieldText,{value:o,placeholder:oe.d,onChange:e=>l(e.target.value),isInvalid:!1===s.valid,"data-test-subj":"mlJobWizardInputQueryDelay"}))},Qn=Object(n.memo)((({children:e,validation:t})=>{const a=y.i18n.translate("xpack.ml.newJob.wizard.datafeedStep.frequency.title",{defaultMessage:"Frequency"});return Object(N.jsx)(te.EuiDescribedFormGroup,{title:Object(N.jsx)("h3",null,a),description:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.datafeedStep.frequency.description",defaultMessage:"The interval between searches."})},Object(N.jsx)(te.EuiFormRow,{label:a,error:t.message,isInvalid:!1===t.valid},Object(N.jsx)(s.a.Fragment,null,e)))})),Kn=()=>{const{jobCreator:e,jobCreatorUpdate:t,jobCreatorUpdated:a,jobValidator:i,jobValidatorUpdated:s}=Object(n.useContext)(Ve),[r,o]=Object(n.useState)(i.frequency),{value:l,setValue:c}=Yn(e.frequency),[d,u]=Object(n.useState)(p());function p(){return`${Object(Te.f)(e.bucketSpanMs/1e3)}s`}return Object(n.useEffect)((()=>{e.frequency=""===l?null:l,t()}),[l]),Object(n.useEffect)((()=>{c(e.frequency);const t=p();u(t)}),[a]),Object(n.useEffect)((()=>{o(i.frequency)}),[s]),Object(N.jsx)(Qn,{validation:r},Object(N.jsx)(te.EuiFieldText,{value:l,placeholder:d,onChange:e=>c(e.target.value),isInvalid:!1===r.valid,"data-test-subj":"mlJobWizardInputFrequency"}))},Zn=Object(n.memo)((({children:e,validation:t})=>{const a=y.i18n.translate("xpack.ml.newJob.wizard.datafeedStep.scrollSize.title",{defaultMessage:"Scroll size"});return Object(N.jsx)(te.EuiDescribedFormGroup,{title:Object(N.jsx)("h3",null,a),description:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.datafeedStep.scrollSize.description",defaultMessage:"The maximum number of documents to return in each search request."})},Object(N.jsx)(te.EuiFormRow,{label:a,error:t.message,isInvalid:!1===t.valid},Object(N.jsx)(s.a.Fragment,null,e)))})),es=()=>{const{jobCreator:e,jobCreatorUpdate:t,jobValidator:a,jobValidatorUpdated:i}=Object(n.useContext)(Ve),[s,r]=Object(n.useState)(a.scrollSize),[o,l]=Object(n.useState)(null===e.scrollSize?"":`${e.scrollSize}`),{datafeeds:c}=Object(A.c)(),d=void 0!==c.scroll_size?`${c.scroll_size}`:"";return Object(n.useEffect)((()=>{e.scrollSize=""===o?null:+o,t()}),[o]),Object(n.useEffect)((()=>{l(null===e.scrollSize?"":`${e.scrollSize}`)}),[t]),Object(n.useEffect)((()=>{r(a.scrollSize)}),[i]),Object(N.jsx)(Zn,{validation:s},Object(N.jsx)(te.EuiFieldNumber,{min:0,placeholder:d,value:""===o?o:+o,onChange:e=>l(e.target.value),isInvalid:!1===s.valid,"data-test-subj":"mlJobWizardInputScrollSize"}))},ts=()=>{const{jobCreator:e,jobCreatorUpdate:t}=Object(n.useContext)(Ve),[a,i]=Object(n.useState)(!1),[r]=Object(n.useState)(JSON.stringify(k(),null,2)),o=()=>i(!1);return Object(N.jsx)(s.a.Fragment,null,a&&Object(N.jsx)(te.EuiConfirmModal,{title:y.i18n.translate("xpack.ml.newJob.wizard.datafeedStep.resetQueryConfirm.title",{defaultMessage:"Reset datafeed query"}),onCancel:o,onConfirm:function(){e.query=k(),t(),o()},cancelButtonText:y.i18n.translate("xpack.ml.newJob.wizard.datafeedStep.resetQueryConfirm.cancel",{defaultMessage:"Cancel"}),confirmButtonText:y.i18n.translate("xpack.ml.newJob.wizard.datafeedStep.resetQueryConfirm.confirm",{defaultMessage:"Confirm"}),defaultFocusedButton:"confirm"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.datafeedStep.resetQueryConfirm.description",defaultMessage:"Set the datafeed query to be the default."}),Object(N.jsx)(te.EuiSpacer,{size:"s"}),Object(N.jsx)(te.EuiCodeBlock,{language:"js",fontSize:"m",paddingSize:"s"},r)),Object(N.jsx)(te.EuiButtonEmpty,{size:"s",onClick:()=>i(!0)},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.datafeedStep.resetQueryButton",defaultMessage:"Reset datafeed query to default"})))},as=({fields:e,changeHandler:t,selectedField:a})=>{const{jobCreator:i}=Object(n.useContext)(Ve),s=Object(St.g)(e,i.additionalFields),r=[];return null!==a&&r.push({label:a}),Object(N.jsx)(te.EuiComboBox,{singleSelection:{asPlainText:!0},options:s,selectedOptions:r,onChange:function(e){const a=e[0];void 0!==a&&t(a.label)},isClearable:!1,"data-test-subj":"mlTimeFieldNameSelect"})},is=Object(n.memo)((({children:e})=>{const t=y.i18n.translate("xpack.ml.newJob.wizard.datafeedStep.timeField.title",{defaultMessage:"Time field"});return Object(N.jsx)(te.EuiDescribedFormGroup,{title:Object(N.jsx)("h3",null,t),description:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.datafeedStep.timeField.description",defaultMessage:"The default time field for the index pattern is automatically selected, but can be overridden."})},Object(N.jsx)(te.EuiFormRow,{label:t},Object(N.jsx)(s.a.Fragment,null,e)))})),ns=()=>{const{jobCreator:e,jobCreatorUpdate:t,jobCreatorUpdated:a}=Object(n.useContext)(Ve),i=e,{dateFields:s}=Ue.b,[r,o]=Object(n.useState)(i.timeFieldName);return Object(n.useEffect)((()=>{i.timeFieldName=r,t()}),[r]),Object(n.useEffect)((()=>{o(i.timeFieldName)}),[a]),Object(N.jsx)(is,null,Object(N.jsx)(as,{fields:s,changeHandler:o,selectedField:r}))},ss=Object(n.memo)((({children:e})=>{const t=y.i18n.translate("xpack.ml.newJob.wizard.datafeedStep.dataView.title",{defaultMessage:"Index pattern"});return Object(N.jsx)(te.EuiDescribedFormGroup,{title:Object(N.jsx)("h3",null,t),description:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.datafeedStep.dataView.description",defaultMessage:"The index pattern that is currently used for this job."})},Object(N.jsx)(te.EuiFormRow,null,Object(N.jsx)(s.a.Fragment,null,e)))}));var rs;!function(e){e[e.PICK_DATA_VIEW=0]="PICK_DATA_VIEW",e[e.VALIDATE=1]="VALIDATE"}(rs||(rs={}));const os=({onClose:e})=>{const{services:{savedObjects:t,uiSettings:a,data:{dataViews:i}}}=Object(f.b)(),r=Object(f.e)(),{validateDatafeedPreview:o}=Object(f.a)(),{jobCreator:l}=Object(n.useContext)(Ve),c=l,[d,u]=Object(n.useState)(!1),[p,m]=Object(n.useState)(rs.PICK_DATA_VIEW),[b,h]=Object(n.useState)(""),[g,j]=Object(n.useState)(""),[x,v]=Object(n.useState)(null);Object(n.useEffect)((function(){h(c.indexPatternTitle)}),[]),Object(n.useEffect)((function(){p===rs.PICK_DATA_VIEW&&v(null)}),[p]);const O=Object(n.useCallback)((async e=>{u(!0);const{title:t}=await i.get(e);j(t);const a=t.split(",");if(c.detectors.length){const e={...c.datafeedConfig,indices:a},t=await o({job:{...c.jobConfig,datafeed_config:e}});v(t)}u(!1)}),[i,o,c]),E=Object(n.useCallback)((()=>{const e=g.split(",");c.indices=e,Object(St.l)(c,r)}),[c,g,r]);return Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(te.EuiModal,{onClose:e,"data-test-subj":"mlJobMgmtImportJobsFlyout"},Object(N.jsx)(te.EuiModalHeader,null,Object(N.jsx)(te.EuiModalHeaderTitle,null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.datafeedStep.dataView.step0.title",defaultMessage:"Change index pattern"}))),Object(N.jsx)(te.EuiModalBody,null,p===rs.PICK_DATA_VIEW&&Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.datafeedStep.dataView.step1.title",defaultMessage:"Select new index pattern for the job"}),Object(N.jsx)(te.EuiSpacer,{size:"s"}),Object(N.jsx)(ie.SavedObjectFinderUi,{key:"searchSavedObjectFinder",onChoose:function(e){!1===d&&(m(rs.VALIDATE),O(e))},showFilter:!0,noItemsMessage:y.i18n.translate("xpack.ml.newJob.wizard.datafeedStep.dataView.step1.noMatchingError",{defaultMessage:"No matching indices or saved searches found."}),savedObjectMetaData:[{type:"index-pattern",getIconForSavedObject:()=>"indexPatternApp",name:y.i18n.translate("xpack.ml.newJob.wizard.datafeedStep.dataView.step1.dataView",{defaultMessage:"Index pattern"})}],fixedPageSize:8,uiSettings:a,savedObjects:t})),p===rs.VALIDATE&&Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.datafeedStep.dataView.step2.title",defaultMessage:"Changing {dv1} for {dv2}",values:{dv1:b,dv2:g}}),Object(N.jsx)(te.EuiSpacer,{size:"s"}),!0===d?Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(te.EuiLoadingSpinner,null),Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.datafeedStep.dataView.step2.validatingText",defaultMessage:"Checking index pattern and job compatibility"})):Object(N.jsx)(ls,{validationResponse:x,dataViewTitle:g}),Object(N.jsx)(te.EuiSpacer,{size:"s"}),Object(N.jsx)(te.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiButtonEmpty,{onClick:m.bind(null,rs.PICK_DATA_VIEW),isDisabled:d,flush:"left"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.datafeedStep.dataView.step2.backButton",defaultMessage:"Back"}))),Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiButton,{onClick:()=>E(),isDisabled:d,"data-test-subj":"mlJobsImportButton"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.datafeedStep.dataView.step2.ApplyButton",defaultMessage:"Apply"}))))))))},ls=({validationResponse:e,dataViewTitle:t})=>null===e?Object(N.jsx)(te.EuiCallOut,{title:y.i18n.translate("xpack.ml.newJob.wizard.datafeedStep.dataView.validation.noDetectors.title",{defaultMessage:"Index pattern valid"}),color:"primary"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.datafeedStep.dataView.validation.noDetectors.message",defaultMessage:"No detectors have been configured; this index pattern can be applied to the job."})):!0===e.valid?!0===e.documentsFound?Object(N.jsx)(te.EuiCallOut,{title:y.i18n.translate("xpack.ml.newJob.wizard.datafeedStep.dataView.validation.valid.title",{defaultMessage:"Index pattern valid"}),color:"primary"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.datafeedStep.dataView.validation.valid.message",defaultMessage:"This index pattern can be applied to this job."})):Object(N.jsx)(te.EuiCallOut,{title:y.i18n.translate("xpack.ml.newJob.wizard.datafeedStep.dataView.validation.possiblyInvalid.title",{defaultMessage:"Index pattern possibly invalid"}),color:"warning"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.datafeedStep.dataView.validation.possiblyInvalid.message",defaultMessage:"This index pattern produced no results when previewing the datafeed. There may be no documents in {dataViewTitle}.",values:{dataViewTitle:t}})):Object(N.jsx)(te.EuiCallOut,{title:y.i18n.translate("xpack.ml.newJob.wizard.datafeedStep.dataView.validation.invalid.title",{defaultMessage:"Index pattern invalid"}),color:"danger"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.datafeedStep.dataView.validation.invalid.message",defaultMessage:"This index pattern produced an error when attempting to preview the datafeed. The fields selected for this job might not exist in {dataViewTitle}.",values:{dataViewTitle:t}}),Object(N.jsx)(te.EuiSpacer,{size:"s"}),Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.datafeedStep.dataView.validation.invalid.reason",defaultMessage:"Reason:"}),Object(N.jsx)(te.EuiSpacer,{size:"s"}),e.error?Object(ze.b)(e.error):null),cs=({isDisabled:e})=>{const[t,a]=Object(n.useState)(!1);return Object(N.jsx)(s.a.Fragment,null,t&&Object(N.jsx)(os,{onClose:a.bind(null,!1)}),Object(N.jsx)(ss,null,Object(N.jsx)(te.EuiButtonEmpty,{onClick:a.bind(null,!0),isDisabled:e,"data-test-subj":"mlJobsImportButton"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.datafeedStep.dataView.changeDataView.button",defaultMessage:"Change index pattern"}))))},ds=({setCurrentStep:e,isCurrentStep:t})=>{const{jobValidator:a,jobValidatorUpdated:i}=Object(n.useContext)(Ve),[s,r]=Object(n.useState)(!1),[o,l]=Object(n.useState)(!1);return Object(n.useEffect)((()=>{const e=o&&a.queryDelay.valid&&a.frequency.valid&&a.scrollSize.valid&&!1===a.validating;r(e)}),[i,o]),Object(N.jsx)(n.Fragment,null,t&&Object(N.jsx)(n.Fragment,null,Object(N.jsx)(te.EuiFlexGroup,{gutterSize:"xl"},Object(N.jsx)(te.EuiFlexItem,{"data-test-subj":"mlAdvancedDatafeedQueryEditor"},Object(N.jsx)(Wn,{setIsValidQuery:l})),Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(Xn,null),Object(N.jsx)(Kn,null),Object(N.jsx)(es,null),Object(N.jsx)(ns,null),Object(N.jsx)(cs,{isDisabled:!1}))),Object(N.jsx)(ts,null),Object(N.jsx)(He,{next:()=>e(Je.PICK_FIELDS),nextActive:s},Object(N.jsx)(Ni,{isDisabled:!1,jobEditorMode:Pi.EDITABLE,datafeedEditorMode:Pi.EDITABLE}))))},us=({currentStep:e,setCurrentStep:t})=>{const a=Object(g.b)(),[i,s]=Object(n.useState)(!1),[r,o]=Object(n.useState)(!1);return Object(N.jsx)(n.Fragment,null,e===Je.TIME_RANGE&&Object(N.jsx)(n.Fragment,null,Object(N.jsx)(ps,{"data-test-subj":"mlJobWizardStepTitleTimeRange"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.stepComponentWrapper.timeRangeTitle",defaultMessage:"Time range"})),Object(N.jsx)(st,{isCurrentStep:e===Je.TIME_RANGE,setCurrentStep:t})),e===Je.ADVANCED_CONFIGURE_DATAFEED&&Object(N.jsx)(n.Fragment,null,Object(N.jsx)(ps,{"data-test-subj":"mlJobWizardStepTitleConfigureDatafeed"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.stepComponentWrapper.configureDatafeedTitle",defaultMessage:"Configure datafeed"})),Object(N.jsx)(ds,{isCurrentStep:e===Je.ADVANCED_CONFIGURE_DATAFEED,setCurrentStep:t})),e===Je.PICK_FIELDS&&Object(N.jsx)(n.Fragment,null,Object(N.jsx)(ps,{"data-test-subj":"mlJobWizardStepTitlePickFields"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.stepComponentWrapper.pickFieldsTitle",defaultMessage:"Pick fields"})),Object(N.jsx)(Ji,{isCurrentStep:e===Je.PICK_FIELDS,setCurrentStep:t})),e===Je.JOB_DETAILS&&Object(N.jsx)(n.Fragment,null,Object(N.jsx)(ps,{"data-test-subj":"mlJobWizardStepTitleJobDetails"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.stepComponentWrapper.jobDetailsTitle",defaultMessage:"Job details"})),Object(N.jsx)(un,{isCurrentStep:e===Je.JOB_DETAILS,setCurrentStep:t,advancedExpanded:i,setAdvancedExpanded:s,additionalExpanded:r,setAdditionalExpanded:o})),e===Je.VALIDATION&&Object(N.jsx)(n.Fragment,null,Object(N.jsx)(ps,{"data-test-subj":"mlJobWizardStepTitleValidation"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.wizard.stepComponentWrapper.validationTitle",defaultMessage:"Validation"})),Object(N.jsx)(Cn,{isCurrentStep:e===Je.VALIDATION,setCurrentStep:t})),e===Je.SUMMARY&&Object(N.jsx)(n.Fragment,null,Object(N.jsx)(ps,{"data-test-subj":"mlJobWizardStepTitleSummary"},null!==a.currentSavedSearch?y.i18n.translate("xpack.ml.newJob.wizard.stepComponentWrapper.summaryTitleSavedSearch",{defaultMessage:"New job from saved search {title}",values:{title:a.currentSavedSearch.attributes.title}}):void 0!==a.currentIndexPattern.id?y.i18n.translate("xpack.ml.newJob.wizard.stepComponentWrapper.summaryTitleIndexPattern",{defaultMessage:"New job from index pattern {title}",values:{title:a.currentIndexPattern.title}}):""),Object(N.jsx)(qn,{isCurrentStep:e===Je.SUMMARY,setCurrentStep:t})))},ps=({"data-test-subj":e,children:t})=>Object(N.jsx)(n.Fragment,null,Object(N.jsx)(te.EuiTitle,{size:"s"},Object(N.jsx)("h2",{"data-test-subj":e},t)),Object(N.jsx)(te.EuiSpacer,null)),ms=({currentStep:e,highestStep:t,setCurrentStep:a,disableSteps:i,jobType:n})=>{const s=[{title:y.i18n.translate("xpack.ml.newJob.wizard.step.timeRangeTitle",{defaultMessage:"Time range"}),...r(Je.TIME_RANGE)},{title:y.i18n.translate("xpack.ml.newJob.wizard.step.pickFieldsTitle",{defaultMessage:"Pick fields"}),...r(Je.PICK_FIELDS)},{title:y.i18n.translate("xpack.ml.newJob.wizard.step.jobDetailsTitle",{defaultMessage:"Job details"}),...r(Je.JOB_DETAILS)},{title:y.i18n.translate("xpack.ml.newJob.wizard.step.validationTitle",{defaultMessage:"Validation"}),...r(Je.VALIDATION)},{title:y.i18n.translate("xpack.ml.newJob.wizard.step.summaryTitle",{defaultMessage:"Summary"}),...r(Je.SUMMARY)}];function r(n){return{onClick:()=>function(e){e<=t&&a(e)}(n),isSelected:e===n,isComplete:e>n,disabled:i||t<n}}return n===oe.f.ADVANCED&&s.splice(0,1,{title:y.i18n.translate("xpack.ml.newJob.wizard.step.configureDatafeedTitle",{defaultMessage:"Configure datafeed"}),...r(Je.ADVANCED_CONFIGURE_DATAFEED)}),Object(N.jsx)(te.EuiStepsHorizontal,{steps:s,style:{backgroundColor:"inherit"}})},bs=({jobCreator:e,chartLoader:t,resultsLoader:a,chartInterval:i,jobValidator:s,existingJobsAndGroups:r,firstWizardStep:o=Je.TIME_RANGE})=>{const[l,c]=Object(n.useReducer)((e=>e+1),0),d=()=>c(l),[u,p]=Object(n.useReducer)((e=>e+1),0),m={jobCreatorUpdated:l,jobCreatorUpdate:d,jobCreator:e,chartLoader:t,resultsLoader:a,chartInterval:i,jobValidator:s,jobValidatorUpdated:u,fields:Ue.b.fields,aggs:Ue.b.aggs,existingJobsAndGroups:r},b=e.type===oe.f.ADVANCED?Je.ADVANCED_CONFIGURE_DATAFEED:Je.TIME_RANGE,[h,f]=Object(n.useState)(b),[g,j]=Object(n.useState)(b),[x,v]=Object(n.useState)(!1),[y,O]=Object(n.useState)(a.progress),[E,w]=Object(n.useState)(hs(e.jobConfig,e.datafeedConfig));return Object(n.useEffect)((()=>{const e=s.validationResult$.subscribe((()=>{p(u)}));return()=>e.unsubscribe()}),[]),Object(n.useEffect)((()=>{s.validate((()=>{p(u)}));const t=hs(e.jobConfig,e.datafeedConfig);t!==E&&(j(h),w(t))}),[l]),Object(n.useEffect)((()=>{e.subscribeToProgress(O),f(o)}),[]),Object(n.useEffect)((()=>{v(y>0)}),[y]),Object(n.useEffect)((()=>{h>=g&&j(h)}),[h]),Be(e,s,d,l),Object(N.jsx)(Ve.Provider,{value:m},Object(N.jsx)(ms,{currentStep:h,highestStep:g,setCurrentStep:f,disableSteps:x,jobType:e.type}),Object(N.jsx)(us,{currentStep:h,setCurrentStep:f}))};function hs(e,t){return JSON.stringify(e)+JSON.stringify(t)}var fs=a(211),gs=a.n(fs),js=a(129);const xs=(e,t)=>Object(E.isEqual)(e,t),vs=gs()(ge.ml.jobs.newJobLineChart,xs),ys=gs()(ge.ml.jobs.newJobPopulationsChart,xs),Os=gs()(js.mlResultsService.getEventRateData,xs),Es=gs()((function(e,t,a,i,n,s){return new Promise(((r,o)=>{ge.ml.esSearch({index:e,size:0,body:{query:i,aggs:{catFields:{terms:{field:t,size:a}}},...void 0!==n?{runtime_mappings:n}:{}},...null!=s?s:{}}).then((e=>{const t=Object(E.get)(e,["aggregations","catFields","buckets"],[]);r({success:!0,results:t.map((e=>e.key))})})).catch((e=>{o(e)}))}))}),xs);class chart_loader_ChartLoader{constructor(e,t){Ce()(this,"_indexPatternTitle",""),Ce()(this,"_timeFieldName",""),Ce()(this,"_query",{}),this._indexPatternTitle=e.title,this._query=t,"string"==typeof e.timeFieldName&&(this._timeFieldName=e.timeFieldName)}async loadLineCharts(e,t,a,i,n,s,r,o){if(""!==this._timeFieldName){if(!1===Object(St.b)(a))return{};const l=null!==i?i.name:null,c=a.map(ws);return(await vs(this._indexPatternTitle,this._timeFieldName,e,t,s,this._query,c,l,n,null!=r?r:void 0,o)).results}return{}}async loadPopulationCharts(e,t,a,i,n,s,r){if(""!==this._timeFieldName){if(!1===Object(St.b)(a))return{};const o=null!==i?i.name:"",l=a.map(ws);return(await ys(this._indexPatternTitle,this._timeFieldName,e,t,n,this._query,l,o,null!=s?s:void 0,r)).results}return{}}async loadEventRateChart(e,t,a,i,n){if(""!==this._timeFieldName){const s=await Os(this._indexPatternTitle,this._query,this._timeFieldName,e,t,3*a,i,n);if(void 0!==s.error)throw s.error;return Object.entries(s.results).map((([e,t])=>({time:+e,value:t})))}return[]}async loadFieldExampleValues(e,t,a){const{results:i}=await Es(this._indexPatternTitle,e.name,10,this._query,null!=t?t:void 0,a);return i}}function ws(e){const t=void 0!==e.by&&null!==e.by.field&&null!==e.by.value?{field:e.by.field.id,value:e.by.value}:{field:null,value:null};return{agg:e.agg.dslName||"",field:e.field.id,by:t}}var _s=a(351),Ss=a(99);const Ms=({existingJobsAndGroups:e,jobType:t})=>{const a=Object(g.b)(),i=Object(Fe.g)(t)(a.currentIndexPattern,a.currentSavedSearch,a.combinedQuery),{displayErrorToast:s}=Object(Et.c)(),{from:r,to:o}=Ke();i.setTimeRange(r,o);let l=t===oe.f.ADVANCED?Je.ADVANCED_CONFIGURE_DATAFEED:Je.TIME_RANGE,c=!1;if(void 0!==re.a.tempJobCloningObjects.job&&void 0!==re.a.tempJobCloningObjects.datafeed){const e=re.a.tempJobCloningObjects.job,a=re.a.cloneDatafeed(re.a.tempJobCloningObjects.datafeed);d(),i.cloneFromExistingJob(e,a),!1===re.a.tempJobCloningObjects.skipTimeRangeStep?i.jobId="":t!==oe.f.ADVANCED&&(l=Je.PICK_FIELDS),re.a.tempJobCloningObjects.skipTimeRangeStep=!1,re.a.tempJobCloningObjects.job=void 0,re.a.tempJobCloningObjects.datafeed=void 0,re.a.tempJobCloningObjects.createdBy=void 0,void 0!==re.a.tempJobCloningObjects.start&&void 0!==re.a.tempJobCloningObjects.end?(i.setTimeRange(re.a.tempJobCloningObjects.start,re.a.tempJobCloningObjects.end),re.a.tempJobCloningObjects.start=void 0,re.a.tempJobCloningObjects.end=void 0):c=Object(Fe.a)(i),re.a.tempJobCloningObjects.calendars&&(i.calendars=re.a.tempJobCloningObjects.calendars,re.a.tempJobCloningObjects.calendars=void 0)}else if(i.bucketSpan=oe.b,i.type!==oe.f.POPULATION&&i.type!==oe.f.ADVANCED&&i.type!==oe.f.CATEGORIZATION&&(i.modelMemoryLimit=oe.c),i.type===oe.f.SINGLE_METRIC&&(i.modelPlot=!0,i.modelChangeAnnotations=!0),null!==a.currentSavedSearch&&(i.createdBy=null),c=Object(Fe.a)(i),d(),Object(Fe.b)(i)){const{catFields:e}=Ue.b;1===e.length&&(i.categorizationFieldName=e[0].name)}function d(){if(Object(Fe.b)(i)){const e=Ue.b.getAggById("count"),t=Ue.b.getAggById("rare"),a=Ue.b.getFieldById(Tt.a);i.setDefaultDetectorProperties(e,t,a);const{anomaly_detectors:n}=Object(A.c)();i.categorizationAnalyzer=n.categorization_analyzer}else if(Object(Fe.e)(i)){const e=Ue.b.getAggById("rare"),t=Ue.b.getAggById("freq_rare");i.setDefaultDetectorProperties(e,t)}}c&&Object(Fe.a)(i)&&i.autoSetTimeRange().catch((e=>{const t=y.i18n.translate("xpack.ml.newJob.wizard.autoSetJobCreatorTimeRange.error",{defaultMessage:"Error retrieving beginning and end times of index"});s(e,t)}));const u=Object(Ss.c)();u.setBarTarget(600),u.setMaxBars(1200),u.setInterval("auto");const p=new chart_loader_ChartLoader(a.currentIndexPattern,a.combinedQuery),m=new job_validator_JobValidator(i),b=new _s.b(i,u,p);Object(n.useEffect)((()=>()=>{i.forceStopRefreshPolls()}));const h=Object(St.i)(i);return Object(N.jsx)(n.Fragment,null,Object(N.jsx)(te.EuiPage,{style:{backgroundColor:"inherit"},"data-test-subj":`mlPageJobWizard ${t}`},Object(N.jsx)(te.EuiPageBody,null,Object(N.jsx)(te.EuiPageContent,null,Object(N.jsx)(te.EuiPageContentHeader,null,Object(N.jsx)(te.EuiPageContentHeaderSection,null,Object(N.jsx)(te.EuiTitle,null,Object(N.jsx)("h1",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.page.createJob",defaultMessage:"Create job"}),": ",h)),Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.page.createJob.indexPatternTitle",defaultMessage:"Using index pattern {index}",values:{index:i.indexPatternTitle}}))),Object(N.jsx)(te.EuiPageContentBody,null,Object(N.jsx)(bs,{jobCreator:i,chartLoader:p,resultsLoader:b,chartInterval:u,jobValidator:m,existingJobsAndGroups:e,firstWizardStep:l}))))))};var ks=a(132);const Cs="anomaly-detector";function Ts(e,t,a,i){return new Promise((async(n,s)=>{try{const r=i===Cs?Ue.b:ks.a;if(void 0!==e){const t=await a.get(e);await r.initializeFromIndexPattern(t),n(r.newJobCaps)}else if(void 0!==t){const{indexPattern:e}=await Object(O.a)(t);if(null===e)return console.error("Cannot retrieve index pattern from saved search"),void s();await r.initializeFromIndexPattern(e),n(r.newJobCaps)}else s()}catch(e){s(e)}}))}const Fs=(e,t)=>[P("ML_BREADCRUMB",e,t),P("ANOMALY_DETECTION_BREADCRUMB",e,t),P("CREATE_JOB_BREADCRUMB",e,t)],Is=(e,t)=>[...Fs(e,t),{text:y.i18n.translate("xpack.ml.jobsBreadcrumbs.singleMetricLabel",{defaultMessage:"Single metric"}),href:""}],Ds=(e,t)=>[...Fs(e,t),{text:y.i18n.translate("xpack.ml.jobsBreadcrumbs.multiMetricLabel",{defaultMessage:"Multi-metric"}),href:""}],As=(e,t)=>[...Fs(e,t),{text:y.i18n.translate("xpack.ml.jobsBreadcrumbs.populationLabel",{defaultMessage:"Population"}),href:""}],Ls=(e,t)=>[...Fs(e,t),{text:y.i18n.translate("xpack.ml.jobsBreadcrumbs.advancedConfigurationLabel",{defaultMessage:"Advanced configuration"}),href:""}],Rs=(e,t)=>[...Fs(e,t),{text:y.i18n.translate("xpack.ml.jobsBreadcrumbs.categorizationLabel",{defaultMessage:"Categorization"}),href:""}],Ps=(e,t)=>[...Fs(e,t),{text:y.i18n.translate("xpack.ml.jobsBreadcrumbs.rareLabel",{defaultMessage:"Rare"}),href:""}],Ns=(e,t)=>({path:"/jobs/new_job/single_metric",render:(e,t)=>Object(N.jsx)(Gs,v()({},e,{jobType:oe.f.SINGLE_METRIC,deps:t})),breadcrumbs:Is(e,t)}),zs=(e,t)=>({path:"/jobs/new_job/multi_metric",render:(e,t)=>Object(N.jsx)(Gs,v()({},e,{jobType:oe.f.MULTI_METRIC,deps:t})),breadcrumbs:Ds(e,t)}),Bs=(e,t)=>({path:"/jobs/new_job/population",render:(e,t)=>Object(N.jsx)(Gs,v()({},e,{jobType:oe.f.POPULATION,deps:t})),breadcrumbs:As(e,t)}),Js=(e,t)=>({path:"/jobs/new_job/advanced",render:(e,t)=>Object(N.jsx)(Gs,v()({},e,{jobType:oe.f.ADVANCED,deps:t})),breadcrumbs:Ls(e,t)}),Vs=(e,t)=>({path:"/jobs/new_job/categorization",render:(e,t)=>Object(N.jsx)(Gs,v()({},e,{jobType:oe.f.CATEGORIZATION,deps:t})),breadcrumbs:Rs(e,t)}),Us=(e,t)=>({path:"/jobs/new_job/rare",render:(e,t)=>Object(N.jsx)(Gs,v()({},e,{jobType:oe.f.RARE,deps:t})),breadcrumbs:Ps(e,t)}),Gs=({location:e,jobType:t,deps:a})=>{const i=Object(C.a)(T.b.ANOMALY_DETECTION_JOBS_MANAGE),{index:n,savedSearchId:s}=Object(me.parse)(e.search,{sort:!1}),{context:r,results:o}=F(n,s,a.config,{...Y(a),privileges:()=>Object(I.a)(i),jobCaps:()=>Ts(n,s,a.indexPatterns,Cs),existingJobsAndGroups:re.a.getJobAndGroupIds});return Object(N.jsx)(Vb,{context:r},Object(N.jsx)(Ms,{jobType:t,existingJobsAndGroups:o.existingJobsAndGroups}))},qs=Object(n.memo)((({saveState:e,resultsUrl:t,onReset:a})=>e===ar.NOT_SAVED?null:Object(N.jsx)(s.a.Fragment,null,e===ar.SAVED&&Object(N.jsx)(te.EuiCallOut,{title:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.recognize.jobsCreatedTitle",defaultMessage:"Jobs created"}),color:"success",iconType:"checkInCircleFilled"}),e===ar.FAILED&&Object(N.jsx)(te.EuiCallOut,{title:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.simple.recognize.jobsCreationFailedTitle",defaultMessage:"Jobs creation failed"}),color:"danger",iconType:"alert"}),e===ar.PARTIAL_FAILURE&&Object(N.jsx)(te.EuiCallOut,{title:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.recognize.someJobsCreationFailedTitle",defaultMessage:"Some jobs failed to be created"}),color:"warning",iconType:"alert"}),Object(N.jsx)(te.EuiSpacer,{size:"l"}),Object(N.jsx)(te.EuiFlexGroup,{justifyContent:"flexEnd",alignItems:"center"},e!==ar.SAVING&&Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiButton,{color:"primary",fill:!1,"aria-label":y.i18n.translate("xpack.ml.newJob.recognize.jobsCreationFailed.resetButtonAriaLabel",{defaultMessage:"Reset"}),onClick:a},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.recognize.someJobsCreationFailed.resetButtonLabel",defaultMessage:"Reset"}))),(e===ar.SAVED||e===ar.PARTIAL_FAILURE)&&Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiButton,{color:"primary",fill:!0,href:t,"aria-label":y.i18n.translate("xpack.ml.newJob.recognize.viewResultsAriaLabel",{defaultMessage:"View results"})},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.recognize.viewResultsLinkText",defaultMessage:"View results"}))))))),Hs=Object(n.memo)((({objectType:e,kibanaObjects:t,isSaving:a})=>{const i={dashboard:y.i18n.translate("xpack.ml.newJob.recognize.dashboardsLabel",{defaultMessage:"Dashboards"}),search:y.i18n.translate("xpack.ml.newJob.recognize.searchesLabel",{defaultMessage:"Searches"}),visualization:y.i18n.translate("xpack.ml.newJob.recognize.visualizationsLabel",{defaultMessage:"Visualizations"})};return Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(te.EuiTitle,{size:"s"},Object(N.jsx)("h4",null,i[e])),Object(N.jsx)(te.EuiSpacer,{size:"s"}),Object(N.jsx)("ul",null,t.map((({id:e,title:i,success:n,exists:s,error:r},o)=>Object(N.jsx)("li",{key:e},Object(N.jsx)(te.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(te.EuiFlexGroup,{gutterSize:"xs"},Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiText,{size:"s",color:s?"subdued":"secondary"},i),!1===n&&void 0!==r&&Object(N.jsx)(te.EuiText,{size:"xs",color:"danger"},Object(ze.b)(r))),s&&Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiText,{size:"xs",color:"default"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.recognize.alreadyExistsLabel",defaultMessage:"(already exists)"}))))),!s&&Object(N.jsx)(te.EuiFlexItem,{grow:!1,style:{width:"60px"}},Object(N.jsx)(te.EuiText,{textAlign:"center"},a?Object(N.jsx)(te.EuiLoadingSpinner,{size:"m"}):null,void 0!==n?Object(N.jsx)(te.EuiIcon,{type:n?"check":"cross",color:n?"success":"danger","aria-label":n?y.i18n.translate("xpack.ml.newJob.recognize.results.savedAriaLabel",{defaultMessage:"Saved"}):y.i18n.translate("xpack.ml.newJob.recognize.results.saveFailedAriaLabel",{defaultMessage:"Save failed"})}):null))),(1===t.length||o<t.length-1)&&Object(N.jsx)(te.EuiHorizontalRule,{margin:"s"}))))))})),Ws=Object(n.memo)((({job:e,jobOverride:t,isSaving:a,jobPrefix:i,onEditRequest:n})=>{const{id:s,config:{description:r,groups:o},datafeedResult:l,setupResult:c}=e,d=t&&t.groups||o;return Object(N.jsx)(te.EuiFlexGroup,{alignItems:"center",gutterSize:"s",justifyContent:"spaceBetween",responsive:!1},Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(te.EuiFlexGroup,{gutterSize:"s"},Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiText,{size:"s",color:"secondary"},i,s)),Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiToolTip,{position:"right",content:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.recognize.job.overrideJobConfigurationLabel",defaultMessage:"Override job configuration"})},Object(N.jsx)(te.EuiButtonIcon,{"aria-label":y.i18n.translate("xpack.ml.newJob.recognize.job.overrideJobConfigurationLabel",{defaultMessage:"Override job configuration"}),iconType:"pencil",onClick:()=>n(e)})))),Object(N.jsx)(te.EuiText,{size:"s",color:"subdued"},r),Object(N.jsx)(te.EuiFlexGroup,{wrap:!0,responsive:!1,gutterSize:"xs"},(null!=d?d:[]).map((e=>Object(N.jsx)(te.EuiFlexItem,{grow:!1,key:e},Object(N.jsx)(te.EuiBadge,{color:Object(tt.a)(e)},e))))),c&&c.error&&Object(N.jsx)(te.EuiText,{size:"xs",color:"danger"},Object(ze.b)(c.error)),l&&l.error&&Object(N.jsx)(te.EuiText,{size:"xs",color:"danger"},Object(ze.b)(l.error))),Object(N.jsx)(te.EuiFlexItem,{grow:!1,style:{width:Ks}},a&&Object(N.jsx)(te.EuiLoadingSpinner,{size:"m"}),c&&l&&Object(N.jsx)(te.EuiFlexGroup,{gutterSize:"s",wrap:!1,responsive:!1,justifyContent:"spaceAround"},Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiIcon,{type:c.success?"check":"cross",color:c.success?"secondary":"danger",size:"m","aria-label":c.success?y.i18n.translate("xpack.ml.newJob.recognize.job.savedAriaLabel",{defaultMessage:"Saved"}):y.i18n.translate("xpack.ml.newJob.recognize.job.saveFailedAriaLabel",{defaultMessage:"Save failed"})})),Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiIcon,{type:l.success?"check":"cross",color:l.success?"secondary":"danger",size:"m","aria-label":c.success?y.i18n.translate("xpack.ml.newJob.recognize.datafeed.savedAriaLabel",{defaultMessage:"Saved"}):y.i18n.translate("xpack.ml.newJob.recognize.datafeed.saveFailedAriaLabel",{defaultMessage:"Save failed"})})),Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiIcon,{type:$s(l).type,color:$s(l).color,size:"m","aria-label":c.success?y.i18n.translate("xpack.ml.newJob.recognize.running.startedAriaLabel",{defaultMessage:"Started"}):y.i18n.translate("xpack.ml.newJob.recognize.running.startFailedAriaLabel",{defaultMessage:"Start failed"})})))))}));function $s({awaitingMlNodeAllocation:e,success:t}){return!0===e?{type:"alert",color:"warning"}:t?{type:"check",color:"secondary"}:{type:"cross",color:"danger"}}function Ys(e){const[t,a]=Object(n.useState)(e);return[t,e=>{a({...t,...e})}]}var Xs=a(17);const Qs=({job:e,jobOverride:t,existingGroupIds:a,onClose:i})=>{var s;const[r,o]=Ys({jobGroups:t&&t.groups||e.config.groups}),[l,c]=Object(n.useState)({}),d=Object(Xs.a)((e=>Object(Te.i)(e)?null:{pattern:!0}),Object(Xs.b)(bn.b));Object(n.useEffect)((()=>{(()=>{var e;const t=(null!==(e=r.jobGroups)&&void 0!==e?e:[]).map((e=>d(e))).filter((e=>null!==e));c({jobGroups:t,formValid:0===t.length})})()}),[r.jobGroups]);return Object(N.jsx)(te.EuiFlyout,{onClose:()=>i(null)},Object(N.jsx)(te.EuiFlyoutHeader,{hasBorder:!0},Object(N.jsx)(te.EuiTitle,{size:"m"},Object(N.jsx)("h2",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.recognize.overrideConfigurationHeader",defaultMessage:"Override configuration for {jobID}",values:{jobID:e.id}})))),Object(N.jsx)(te.EuiFlyoutBody,null,Object(N.jsx)(te.EuiSpacer,{size:"m"}),Object(N.jsx)(te.EuiForm,null,Object(N.jsx)(te.EuiFormRow,{fullWidth:!0},Object(N.jsx)(it,{existingGroups:a,selectedGroups:null!==(s=r.jobGroups)&&void 0!==s?s:[],onChange:e=>{o({jobGroups:e})},validation:{valid:!l.jobGroups||0===l.jobGroups.length,message:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.recognize.jobGroupAllowedCharactersDescription",defaultMessage:"Job group names can contain lowercase alphanumeric (a-z and 0-9), hyphens or underscores; must start and end with an alphanumeric character"})}}))),Object(N.jsx)(te.EuiSpacer,null)),Object(N.jsx)(te.EuiFlyoutFooter,null,Object(N.jsx)(te.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiButtonEmpty,{iconType:"cross",onClick:()=>i(null),flush:"left"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.recognize.cancelJobOverrideLabel",defaultMessage:"Close"}))),Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiButton,{onClick:()=>(()=>{const t={job_id:e.id,groups:r.jobGroups};i(t)})(),fill:!0,disabled:!l.formValid},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.recognize.saveJobOverrideLabel",defaultMessage:"Save"}))))))},Ks="200px",Zs=({jobs:e,jobPrefix:t,jobOverrides:a,saveState:i,existingGroupIds:r,onJobOverridesChange:o})=>{const l=i===ar.SAVING,[c,d]=Object(n.useState)(null),u=e=>a[e.id],p=null!==c?Object(N.jsx)(Qs,{job:c,jobOverride:u(c),onClose:e=>{d(null),null!==e&&o(e)},existingGroupIds:r}):null;return Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(te.EuiTitle,{size:"s"},Object(N.jsx)("h4",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.recognize.jobsTitle",defaultMessage:"Jobs"}))),Object(N.jsx)(te.EuiSpacer,{size:"s"}),i!==ar.SAVING&&i!==ar.NOT_SAVED&&Object(N.jsx)(te.EuiFlexGroup,{justifyContent:"flexEnd",responsive:!1,gutterSize:"s"},Object(N.jsx)(te.EuiFlexItem,{style:{width:Ks},grow:!1},Object(N.jsx)(te.EuiFlexGroup,{justifyContent:"spaceAround",responsive:!1,gutterSize:"s"},Object(N.jsx)(te.EuiFlexItem,{grow:1},Object(N.jsx)(te.EuiText,{size:"s",textAlign:"center"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.recognize.jobLabel",defaultMessage:"Job"}))),Object(N.jsx)(te.EuiFlexItem,{grow:1},Object(N.jsx)(te.EuiText,{size:"s",textAlign:"center"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.recognize.datafeedLabel",defaultMessage:"Datafeed"}))),Object(N.jsx)(te.EuiFlexItem,{grow:1},Object(N.jsx)(te.EuiText,{size:"s",textAlign:"center"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.recognize.runningLabel",defaultMessage:"Running"})))))),Object(N.jsx)("ul",null,e.map(((a,i)=>Object(N.jsx)("li",{key:a.id},Object(N.jsx)(te.EuiFlexGroup,null,Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(Ws,{jobPrefix:t,job:a,jobOverride:u(a),isSaving:l,onEditRequest:()=>d(a)}))),i<e.length-1&&Object(N.jsx)(te.EuiHorizontalRule,{margin:"s"}))))),p)};const er=({onSubmit:e,onChange:t,saveState:a,jobs:i})=>{const{from:r,to:o}=Ke(),{currentIndexPattern:l}=Object(g.b)(),c=Object(Xs.a)(Object(Xs.e)(/^([a-z0-9]+[a-z0-9\-_]*)?$/),Object(Xs.b)(bn.b-Math.max(...i.map((({id:e})=>e.length))))),[d,u]=Ys({jobPrefix:"",startDatafeedAfterSave:!0,useFullIndexData:!0,timeRange:{start:r,end:o},useDedicatedIndex:!1}),[p,m]=Object(n.useState)({});return Object(n.useEffect)((()=>{(()=>{const e=c(d.jobPrefix);m({jobPrefix:e,formValid:!e})})()}),[d.jobPrefix]),Object(n.useEffect)((()=>{t(d)}),[d]),Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(te.EuiForm,null,Object(N.jsx)(te.EuiDescribedFormGroup,{title:Object(N.jsx)("h4",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.recognize.jobIdPrefixLabel",defaultMessage:"Job ID prefix"})),description:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.tooltips.newJobRecognizerJobPrefixTooltip",defaultMessage:"The prefix is added to the beginning of each job ID."})},Object(N.jsx)(te.EuiFormRow,{label:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.recognize.jobIdPrefixLabel",defaultMessage:"Job ID prefix"}),isInvalid:!!p.jobPrefix,error:Object(N.jsx)(s.a.Fragment,null,p.jobPrefix&&p.jobPrefix.maxLength?Object(N.jsx)("div",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.recognize.jobPrefixInvalidMaxLengthErrorMessage",defaultMessage:"Job ID prefix must be no more than {maxLength, plural, one {# character} other {# characters}} long.",values:{maxLength:p.jobPrefix.maxLength.requiredLength}})):null,p.jobPrefix&&p.jobPrefix.pattern&&Object(N.jsx)("div",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.recognize.jobLabelAllowedCharactersDescription",defaultMessage:"Job label can contain lowercase alphanumeric (a-z and 0-9), hyphens or underscores; must start and end with an alphanumeric character"})))},Object(N.jsx)(te.EuiFieldText,{name:"jobPrefix",value:d.jobPrefix,onChange:({target:{value:e}})=>(e=>{u({jobPrefix:e&&e.toLowerCase()})})(e),isInvalid:!!p.jobPrefix}))),Object(N.jsx)(te.EuiSpacer,{size:"l"}),Object(N.jsx)(te.EuiFormRow,null,Object(N.jsx)(te.EuiSwitch,{id:"startDataFeed",name:"startDataFeed",label:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.recognize.startDatafeedAfterSaveLabel",defaultMessage:"Start datafeed after save"}),checked:d.startDatafeedAfterSave,onChange:({target:{checked:e}})=>{u({startDatafeedAfterSave:e})}})),Object(N.jsx)(te.EuiFormRow,null,Object(N.jsx)(te.EuiSwitch,{id:"useFullData",name:"useFullData",label:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.recognize.useFullDataLabel",defaultMessage:"Use full {indexPatternTitle} data",values:{indexPatternTitle:l.title}}),checked:d.useFullIndexData,onChange:({target:{checked:e}})=>{u({useFullIndexData:e})}})),!d.useFullIndexData&&Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(te.EuiSpacer,{size:"m"}),Object(N.jsx)(nt,{setTimeRange:e=>{u({timeRange:e})},timeRange:d.timeRange})),Object(N.jsx)(te.EuiSpacer,{size:"l"}),Object(N.jsx)(te.EuiAccordion,{id:"advancedOptions","aria-label":y.i18n.translate("xpack.ml.newJob.recognize.advancedSettingsAriaLabel",{defaultMessage:"Advanced settings"}),buttonContent:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.recognize.advancedLabel",defaultMessage:"Advanced"}),paddingSize:"l"},Object(N.jsx)(te.EuiDescribedFormGroup,{title:Object(N.jsx)("h4",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.recognize.useDedicatedIndexLabel",defaultMessage:"Use dedicated index"})),description:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.tooltips.newJobDedicatedIndexTooltip",defaultMessage:"Store results in a separate index for this job."})},Object(N.jsx)(te.EuiFormRow,{describedByIds:["ml_aria_label_new_job_dedicated_index"]},Object(N.jsx)(te.EuiSwitch,{id:"useDedicatedIndex",name:"useDedicatedIndex",checked:d.useDedicatedIndex,onChange:({target:{checked:e}})=>{u({useDedicatedIndex:e})},label:y.i18n.translate("xpack.ml.newJob.recognize.useDedicatedIndexLabel",{defaultMessage:"Use dedicated index"})})))),Object(N.jsx)(te.EuiSpacer,{size:"l"})),Object(N.jsx)(te.EuiTextAlign,{textAlign:"right"},Object(N.jsx)(te.EuiButton,{fill:!0,type:"submit",isLoading:a===ar.SAVING,disabled:!p.formValid||a===ar.SAVING,onClick:()=>{e(d)},"aria-label":y.i18n.translate("xpack.ml.newJob.recognize.createJobButtonAriaLabel",{defaultMessage:"Create job"})},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.recognize.createJobButtonLabel",defaultMessage:"Create {numberOfJobs, plural, zero {job} one {job} other {jobs}}",values:{numberOfJobs:i.length}}))))};var tr=a(131);let ar;!function(e){e[e.NOT_SAVED=0]="NOT_SAVED",e[e.SAVING=1]="SAVING",e[e.SAVED=2]="SAVED",e[e.FAILED=3]="FAILED",e[e.PARTIAL_FAILURE=4]="PARTIAL_FAILURE"}(ar||(ar={}));const ir=({moduleId:e,existingGroupIds:t})=>{const{services:{notifications:a}}=Object(f.b)(),i=Object(f.d)(),[r,o]=Object(n.useState)(""),[l,c]=Object(n.useState)([]),[u,p]=Object(n.useState)({}),[m,b]=Object(n.useState)({}),[h,j]=Object(n.useState)(ar.NOT_SAVED),[x,v]=Object(n.useState)(""),[O,w]=Object(n.useState)(t),[_,S]=Object(n.useState)(0),{currentSavedSearch:M,currentIndexPattern:k,combinedQuery:C}=Object(g.b)(),F=null!==M?y.i18n.translate("xpack.ml.newJob.recognize.savedSearchPageTitle",{defaultMessage:"saved search {savedSearchTitle}",values:{savedSearchTitle:M.attributes.title}}):y.i18n.translate("xpack.ml.newJob.recognize.indexPatternPageTitle",{defaultMessage:"index pattern {indexPatternTitle}",values:{indexPatternTitle:k.title}}),I=null!==M,D=null===M?void 0:C,A=async()=>{try{const t=await ge.ml.getDataRecognizerModule({moduleId:e});c(t.jobs);const a=await(async e=>{const t=Object(d.i)();try{return await Object.keys(e).reduce((async(a,i)=>{const n=await a,{savedObjects:s}=await t.find({type:i,perPage:1e3});return n[i]=e[i].map((e=>{const t=s.find((t=>t.attributes.title===e.title));return{...e,exists:!!t,id:!!t&&t.id||e.id}})),Promise.resolve(n)}),Promise.resolve({}))}catch(e){console.error("Could not load saved objects",e)}return Promise.resolve(e)})(t.kibana);b(a),j(ar.NOT_SAVED);const i=[...t.jobs.map((e=>e.config.groups||[]))].flat();w([...new Set([...O,...i])])}catch(e){console.error(e)}};Object(n.useEffect)((()=>{A()}),[]);const L=[ar.NOT_SAVED,ar.SAVING].includes(h);return Object(N.jsx)(te.EuiPage,null,Object(N.jsx)(te.EuiPageBody,null,Object(N.jsx)(te.EuiPageHeader,null,Object(N.jsx)(te.EuiPageHeaderSection,null,Object(N.jsx)(te.EuiTitle,{size:"l"},Object(N.jsx)("h3",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.recognize.newJobFromTitle",defaultMessage:"New job from {pageTitle}",values:{pageTitle:F}}))))),I&&Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(te.EuiCallOut,{title:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.recognize.searchWillBeOverwrittenLabel",defaultMessage:"Search will be overwritten"}),color:"warning",iconType:"alert"},Object(N.jsx)(te.EuiText,{size:"s"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.recognize.usingSavedSearchDescription",defaultMessage:"Using a saved search will mean the query used in the datafeeds will be different from the default ones we supply in the {moduleId} module.",values:{moduleId:e}}))),Object(N.jsx)(te.EuiSpacer,{size:"l"})),_>0&&Object(N.jsx)(Gn.a,{jobCount:_}),Object(N.jsx)(te.EuiFlexGroup,{wrap:!0,gutterSize:"m"},Object(N.jsx)(te.EuiFlexItem,{grow:1},Object(N.jsx)(te.EuiPanel,{grow:!1},Object(N.jsx)(te.EuiTitle,{size:"s"},Object(N.jsx)("h4",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.newJob.recognize.jobSettingsTitle",defaultMessage:"Job settings"}))),Object(N.jsx)(te.EuiSpacer,{size:"m"}),L&&Object(N.jsx)(er,{onSubmit:async t=>{j(ar.SAVING);const{jobPrefix:n,startDatafeedAfterSave:s,useDedicatedIndex:r,useFullIndexData:o,timeRange:d}=t,p=await(async(e,t)=>{if(e){const e=k.getComputedFields().runtimeFields,{start:t,end:a}=await ge.ml.getTimeFieldRange({index:k.title,timeFieldName:k.timeFieldName,query:C,...Object(Qe.b)(e)?{runtimeMappings:e}:{}});return{start:t.epoch,end:a.epoch}}return Promise.resolve(t)})(o,d);try{let t=Object.values(u);t=t.length>0?t:null;const a=await ge.ml.setupDataRecognizerConfig({moduleId:e,prefix:n,query:D,indexPatternName:k.title,useDedicatedIndex:r,startDatafeed:s,...null!==t?{jobOverrides:t}:{},...p}),{datafeeds:o,jobs:d,kibana:h}=a;if(c(l.map((e=>({...e,datafeedResult:o.find((({id:t})=>t.endsWith(e.id))),setupResult:d.find((({id:t})=>t===n+e.id))})))),b(Object(E.merge)(m,h)),i){const e=await i.getUrl({page:T.b.ANOMALY_EXPLORER,pageState:{jobIds:d.filter((({success:e})=>e)).map((({id:e})=>e)),timeRange:{from:qe()(p.start).format(tr.a),to:qe()(p.end).format(tr.a),mode:"absolute"}}});v(e)}const f=d.reduce(((e,{success:t})=>t?e:e+1),0),g=o.reduce(((e,{awaitingMlNodeAllocation:t})=>!0===t?e+1:e),0);S(g),j(0===f?ar.SAVED:f===l.length?ar.FAILED:ar.PARTIAL_FAILURE)}catch(t){j(ar.FAILED),console.error("Error setting up module",t);const{toasts:i}=a;i.addDanger({title:y.i18n.translate("xpack.ml.newJob.recognize.moduleSetupFailedWarningTitle",{defaultMessage:"Error setting up module {moduleId}",values:{moduleId:e}}),text:y.i18n.translate("xpack.ml.newJob.recognize.moduleSetupFailedWarningDescription",{defaultMessage:"An error occurred trying to create the {count, plural, one {job} other {jobs}} in the module.",values:{count:l.length}})})}},onChange:e=>{o(e.jobPrefix)},saveState:h,jobs:l}),Object(N.jsx)(qs,{saveState:h,resultsUrl:x,onReset:A}))),Object(N.jsx)(te.EuiFlexItem,{grow:2},Object(N.jsx)(te.EuiPanel,{grow:!1},Object(N.jsx)(Zs,{jobs:l,jobPrefix:r,saveState:h,existingGroupIds:O,jobOverrides:u,onJobOverridesChange:e=>{if(p({...u,[e.job_id]:e}),void 0!==e.groups){const t=[...new Set([...O,...e.groups])];w(t)}}})),Object.keys(m).length>0&&Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(te.EuiSpacer,{size:"m"}),Object(N.jsx)(te.EuiPanel,{grow:!1},Object.keys(m).map(((e,t)=>Object(N.jsx)(n.Fragment,{key:e},Object(N.jsx)(Hs,{objectType:e,kibanaObjects:m[e],isSaving:h===ar.SAVING}),t<Object.keys(m).length-1&&Object(N.jsx)(te.EuiSpacer,{size:"s"})))))))),Object(N.jsx)(te.EuiSpacer,{size:"l"})))};var nr=a(206);const sr=(e,t)=>({path:"/jobs/new_job/recognize",render:(e,t)=>Object(N.jsx)(or,v()({},e,{deps:t})),breadcrumbs:[P("ML_BREADCRUMB",e,t),P("ANOMALY_DETECTION_BREADCRUMB",e,t),P("CREATE_JOB_BREADCRUMB",e,t),{text:y.i18n.translate("xpack.ml.jobsBreadcrumbs.selectIndexOrSearchLabelRecognize",{defaultMessage:"Recognized index"}),href:""}]}),rr=()=>({path:"/modules/check_view_or_create",render:(e,t)=>Object(N.jsx)(lr,v()({},e,{deps:t})),breadcrumbs:[]}),or=({location:e,deps:t})=>{const{id:a,index:i,savedSearchId:n}=Object(me.parse)(e.search,{sort:!1}),{context:s,results:r}=F(i,n,t.config,{...Y(t),existingJobsAndGroups:re.a.getJobAndGroupIds});return Object(N.jsx)(Vb,{context:s},Object(N.jsx)(ir,{moduleId:a,existingGroupIds:r.existingJobsAndGroups.groupIds}))},lr=({location:e,deps:t})=>{const{id:a,index:i}=Object(me.parse)(e.search,{sort:!1}),{createLinkWithUserDefaults:n}=Object(nr.a)(),s=Object(f.e)();return F(void 0,void 0,t.config,{checkViewOrCreateJobs:()=>function(e,t,a,i){return new Promise(((n,s)=>{ge.ml.dataRecognizerModuleJobsExist({moduleId:e}).then((async n=>{if(!0===n.jobsExist){const e=a("explorer",n.jobs);await i(e),s()}else await i(`/jobs/new_job/recognize?id=${e}&index=${t}`),s()})).catch((async t=>{console.error(`Error checking whether jobs in module ${e} exists`,t),Object(d.k)().addWarning({title:y.i18n.translate("xpack.ml.newJob.recognize.moduleCheckJobsExistWarningTitle",{defaultMessage:"Error checking module {moduleId}",values:{moduleId:e}}),text:y.i18n.translate("xpack.ml.newJob.recognize.moduleCheckJobsExistWarningDescription",{defaultMessage:"An error occurred trying to check whether the jobs in the module have been created."})}),await i("/jobs"),s()}))}))}(a,i,n,s)}),null};var cr=a(98),dr=a(104);const ur=()=>{Object(f.g)({timeRangeSelector:!1,autoRefreshSelector:!1});const{services:{licenseManagement:e,http:{basePath:t},docLinks:a,dataVisualizer:i}}=Object(f.b)(),s=a.links.ml.guide,r=Object(f.e)(),o=void 0!==e&&!0===e.enabled&&!1===Object(u.d)();if(void 0===i)return console.error("File data visualizer plugin not available"),null;const l=i.getMaxBytesFormatted();return Object(N.jsx)(n.Fragment,null,Object(N.jsx)(cr.a,{tabId:"datavisualizer"}),Object(N.jsx)(te.EuiPage,{restrictWidth:1e3,"data-test-subj":"mlPageDataVisualizerSelector"},Object(N.jsx)(te.EuiPageBody,null,Object(N.jsx)(te.EuiFlexGroup,{gutterSize:"xl"},Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiTitle,{size:"l"},Object(N.jsx)("h1",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.datavisualizer.selector.dataVisualizerTitle",defaultMessage:"Data Visualizer"}))))),Object(N.jsx)(te.EuiSpacer,{size:"xl"}),Object(N.jsx)(te.EuiFlexGroup,{gutterSize:"xl"},Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiText,{color:"subdued"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.datavisualizer.selector.dataVisualizerDescription",defaultMessage:"The Machine Learning Data Visualizer tool helps you understand your data, by analyzing the metrics and fields in a log file or an existing Elasticsearch index."})))),Object(N.jsx)(te.EuiSpacer,{size:"xl"}),Object(N.jsx)(te.EuiFlexGroup,{justifyContent:"spaceAround",gutterSize:"xl"},Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(te.EuiCard,{icon:Object(N.jsx)(te.EuiIcon,{size:"xxl",type:"addDataApp"}),title:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.datavisualizer.selector.importDataTitle",defaultMessage:"Import data"}),description:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.datavisualizer.selector.importDataDescription",defaultMessage:"Import data from a log file. You can upload files up to {maxFileSize}.",values:{maxFileSize:l}}),footer:Object(N.jsx)(te.EuiButton,{target:"_self",onClick:()=>r("/filedatavisualizer"),"data-test-subj":"mlDataVisualizerUploadFileButton"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.datavisualizer.selector.uploadFileButtonLabel",defaultMessage:"Select file"})),"data-test-subj":"mlDataVisualizerCardImportData"})),Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(te.EuiCard,{icon:Object(N.jsx)(te.EuiIcon,{size:"xxl",type:"dataVisualizer"}),title:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.datavisualizer.selector.selectIndexPatternTitle",defaultMessage:"Select an index pattern"}),description:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.datavisualizer.selector.selectIndexPatternDescription",defaultMessage:"Visualize the data in an existing Elasticsearch index."}),footer:Object(N.jsx)(te.EuiButton,{target:"_self",onClick:()=>r("/datavisualizer_index_select"),"data-test-subj":"mlDataVisualizerSelectIndexButton"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.datavisualizer.selector.selectIndexButtonLabel",defaultMessage:"Select index pattern"})),"data-test-subj":"mlDataVisualizerCardIndexData"}))),!0===o&&Object(N.jsx)(n.Fragment,null,Object(N.jsx)(te.EuiSpacer,{size:"xxl"}),Object(N.jsx)(te.EuiSpacer,{size:"xxl"}),Object(N.jsx)(te.EuiFlexGroup,{justifyContent:"spaceAround",gutterSize:"xl"},Object(N.jsx)(te.EuiFlexItem,{grow:!1,style:{width:"600px"}},Object(N.jsx)(te.EuiCard,{title:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.datavisualizer.selector.startTrialTitle",defaultMessage:"Start trial"}),description:Object(N.jsx)("span",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.datavisualizer.startTrial.fullMLFeaturesDescription",defaultMessage:"To experience the full Machine Learning features that a {subscriptionsLink} offers, start a 30-day trial.",values:{subscriptionsLink:Object(N.jsx)(te.EuiLink,{href:"https://www.elastic.co/subscriptions",target:"_blank"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.datavisualizer.startTrial.subscriptionsLinkText",defaultMessage:"Platinum or Enterprise subscription"}))}})),footer:Object(N.jsx)(te.EuiButton,{target:"_blank",href:`${t.get()}/app/management/stack/license_management/home`,"data-test-subj":"mlDataVisualizerStartTrialButton"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.datavisualizer.selector.startTrialButtonLabel",defaultMessage:"Start trial"})),"data-test-subj":"mlDataVisualizerCardStartTrial"})))))),Object(N.jsx)(dr.a,{docLink:s}))},pr=(e,t)=>({path:"/datavisualizer",render:(e,t)=>Object(N.jsx)(mr,v()({},e,{deps:t})),breadcrumbs:[P("ML_BREADCRUMB",e,t),P("DATA_VISUALIZER_BREADCRUMB",e,t)]}),mr=({location:e,deps:t})=>{const{redirectToMlAccessDeniedPage:a}=t,{context:i}=F(void 0,void 0,t.config,{checkBasicLicense:u.a,checkFindFileStructurePrivilege:()=>Object(I.b)(a)});return Object(N.jsx)(Vb,{context:i},Object(N.jsx)(ur,null))},br=()=>{Object(f.g)({timeRangeSelector:!1,autoRefreshSelector:!1});const{services:{docLinks:e,dataVisualizer:t,data:{indexPatterns:{get:a}}}}=Object(f.b)(),i=Object(f.d)();Object($.c)();const[s,r]=Object(n.useState)(null);Object(n.useEffect)((()=>{if(void 0!==t){const{getIndexDataVisualizerComponent:e}=t;e().then(r)}}),[]);const o=Object(n.useMemo)((()=>[{id:"create_ml_ad_job",title:y.i18n.translate("xpack.ml.indexDatavisualizer.actionsPanel.anomalyDetectionTitle",{defaultMessage:"Advanced anomaly detection"}),description:y.i18n.translate("xpack.ml.indexDatavisualizer.actionsPanel.anomalyDetectionDescription",{defaultMessage:"Create a job with the full range of options for more advanced use cases."}),icon:"createAdvancedJob",type:"file",getUrl:async({indexPatternId:e,globalState:t})=>await i.getUrl({page:T.b.ANOMALY_DETECTION_CREATE_JOB_ADVANCED,pageState:{index:e,globalState:t}}),canDisplay:async({indexPatternId:e})=>{try{const{timeFieldName:t}=await a(e);return Object(u.d)()&&void 0!==t&&Object(I.e)("canCreateJob")&&Object($.e)()}catch(e){return!1}},dataTestSubj:"dataVisualizerCreateAdvancedJobCard"},{id:"create_ml_dfa_job",title:y.i18n.translate("xpack.ml.indexDatavisualizer.actionsPanel.dataframeTitle",{defaultMessage:"Data frame analytics"}),description:y.i18n.translate("xpack.ml.indexDatavisualizer.actionsPanel.dataframeDescription",{defaultMessage:"Create outlier detection, regression, or classification analytics."}),icon:"classificationJob",type:"file",getUrl:async({indexPatternId:e,globalState:t})=>await i.getUrl({page:T.b.DATA_FRAME_ANALYTICS_CREATE_JOB,pageState:{index:e,globalState:t}}),canDisplay:async()=>Object(u.d)()&&Object(I.e)("canCreateDataFrameAnalytics")&&Object($.e)(),dataTestSubj:"dataVisualizerCreateDataFrameAnalyticsCard"}]),[]);return s?Object(N.jsx)(n.Fragment,null,Object(N.jsx)(cr.a,{tabId:"datavisualizer"}),null!==s&&Object(N.jsx)(s,{additionalLinks:o}),Object(N.jsx)(dr.a,{docLink:e.links.ml.guide})):Object(N.jsx)(n.Fragment,null)},hr=(e,t)=>({path:"/jobs/new_job/datavisualizer",render:(e,t)=>Object(N.jsx)(fr,v()({},e,{deps:t})),breadcrumbs:[P("ML_BREADCRUMB",e,t),P("DATA_VISUALIZER_BREADCRUMB",e,t),{text:y.i18n.translate("xpack.ml.dataFrameAnalyticsBreadcrumbs.indexLabel",{defaultMessage:"Index"}),href:""}]}),fr=({location:e,deps:t})=>{const{redirectToMlAccessDeniedPage:a}=t,{index:i,savedSearchId:n}=Object(me.parse)(e.search,{sort:!1}),{context:s}=F(i,n,t.config,{checkBasicLicense:u.a,loadIndexPatterns:()=>Object(O.h)(t.indexPatterns),checkGetJobsCapabilities:()=>Object(I.c)(a)});return Object(N.jsx)(Vb,{context:s},Object(N.jsx)(br,null))},gr=()=>{Object(f.g)({timeRangeSelector:!1,autoRefreshSelector:!1});const{services:{docLinks:e,dataVisualizer:t,data:{indexPatterns:{get:a}}}}=Object(f.b)(),i=Object(f.d)();Object($.c)();const[s,r]=Object(n.useState)(null),o=Object(n.useMemo)((()=>[{id:"create_ml_job",title:y.i18n.translate("xpack.ml.fileDatavisualizer.actionsPanel.anomalyDetectionTitle",{defaultMessage:"Create new ML job"}),description:"",icon:"machineLearningApp",type:"file",getUrl:async({indexPatternId:e,globalState:t})=>await i.getUrl({page:T.b.ANOMALY_DETECTION_CREATE_JOB_SELECT_TYPE,pageState:{index:e,globalState:t}}),canDisplay:async({indexPatternId:e})=>{try{const{timeFieldName:t}=await a(e);return Object(u.d)()&&void 0!==t&&Object(I.e)("canCreateJob")&&Object($.e)()}catch(e){return!1}}},{id:"open_in_data_viz",title:y.i18n.translate("xpack.ml.fileDatavisualizer.actionsPanel.dataframeTitle",{defaultMessage:"Open in Data Visualizer"}),description:"",icon:"dataVisualizer",type:"file",getUrl:async({indexPatternId:e,globalState:t})=>await i.getUrl({page:T.b.DATA_VISUALIZER_INDEX_VIEWER,pageState:{index:e,globalState:t}}),canDisplay:async()=>!0}]),[]);return Object(n.useEffect)((()=>{if(void 0!==t){Object($.c)();const{getFileDataVisualizerComponent:e}=t;e().then(r)}}),[]),Object(N.jsx)(n.Fragment,null,Object(N.jsx)(cr.a,{tabId:"datavisualizer"}),null!==s&&Object(N.jsx)(s,{additionalLinks:o}),Object(N.jsx)(dr.a,{docLink:e.links.ml.guide}))},jr=(e,t)=>({path:"/filedatavisualizer",render:(e,t)=>Object(N.jsx)(xr,v()({},e,{deps:t})),breadcrumbs:[P("ML_BREADCRUMB",e,t),P("DATA_VISUALIZER_BREADCRUMB",e,t),{text:y.i18n.translate("xpack.ml.dataVisualizer.fileBasedLabel",{defaultMessage:"File"}),href:""}]}),xr=({deps:e})=>{const{redirectToMlAccessDeniedPage:t}=e,{context:a}=F(void 0,void 0,e.config,{checkBasicLicense:u.a,loadIndexPatterns:()=>Object(O.h)(e.indexPatterns),checkFindFileStructurePrivilege:()=>Object(I.b)(t)});return Object(N.jsx)(Vb,{context:a},Object(N.jsx)(gr,null))},vr=Object(n.createContext)({canGetFilters:!1,canCreateFilter:!1,canGetCalendars:!1,canCreateCalendar:!1}),yr=()=>{const[e,t]=Object(n.useState)(0),[a,i]=Object(n.useState)(0),{canGetFilters:s,canCreateFilter:r,canGetCalendars:o,canCreateCalendar:l}=Object(n.useContext)(vr),{toasts:c}=Object(f.f)(),d=Object(C.a)(T.b.CALENDARS_MANAGE),u=Object(C.a)(T.b.CALENDARS_NEW),p=Object(C.a)(T.b.FILTER_LISTS_MANAGE),m=Object(C.a)(T.b.FILTER_LISTS_NEW);return Object(n.useEffect)((()=>{!async function(){if(!0===o)try{const e=await ge.ml.calendars();t(e.length)}catch(e){c.addDanger(y.i18n.translate("xpack.ml.settings.anomalyDetection.loadingCalendarsCountErrorMessage",{defaultMessage:"An error occurred obtaining the count of calendars"}))}if(!0===s)try{const e=await ge.ml.filters.filtersStats();i(e.length)}catch(e){c.addDanger(y.i18n.translate("xpack.ml.settings.anomalyDetection.loadingFilterListCountErrorMessage",{defaultMessage:"An error occurred obtaining the count of filter lists"}))}}()}),[]),Object(N.jsx)(n.Fragment,null,Object(N.jsx)(te.EuiPageContent,{className:"mlSettingsPage__content",horizontalPosition:"center"},Object(N.jsx)(te.EuiPageContentHeader,null,Object(N.jsx)(te.EuiTitle,null,Object(N.jsx)("h2",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.settings.anomalyDetection.anomalyDetectionTitle",defaultMessage:"Anomaly Detection"})))),Object(N.jsx)(te.EuiFlexGroup,{gutterSize:"xl"},Object(N.jsx)(te.EuiFlexItem,{grow:5},Object(N.jsx)(te.EuiTitle,{size:"s"},Object(N.jsx)("h3",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.settings.anomalyDetection.calendarsTitle",defaultMessage:"Calendars"}))),Object(N.jsx)(te.EuiSpacer,{size:"s"}),Object(N.jsx)(te.EuiText,{size:"s"},Object(N.jsx)(te.EuiTextColor,{color:"subdued"},Object(N.jsx)("p",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.settings.anomalyDetection.calendarsText",defaultMessage:"Calendars contain a list of scheduled events for which you do not want to generate anomalies, such as planned system outages or public holidays."})))),Object(N.jsx)(te.EuiSpacer,{size:"m"}),Object(N.jsx)(te.EuiFlexGroup,{alignItems:"center"},o&&Object(N.jsx)(te.EuiFlexItem,{grow:!1,style:{display:"block"}},Object(N.jsx)(te.EuiText,null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.settings.anomalyDetection.calendarsSummaryCount",defaultMessage:"You have {calendarsCountBadge} {calendarsCount, plural, one {calendar} other {calendars}}",values:{calendarsCountBadge:Object(N.jsx)(te.EuiBadge,null,e),calendarsCount:e}}))),Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiButtonEmpty,{"data-test-subj":"mlCalendarsMngButton",flush:"left",color:"primary",onClick:d,isDisabled:!1===o},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.settings.anomalyDetection.manageCalendarsLink",defaultMessage:"Manage"}))),Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiButtonEmpty,{"data-test-subj":"mlCalendarsCreateButton",flush:"left",color:"primary",onClick:u,isDisabled:!1===l},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.settings.anomalyDetection.createCalendarLink",defaultMessage:"Create"}))))),Object(N.jsx)(te.EuiFlexItem,{grow:5},Object(N.jsx)(te.EuiTitle,{size:"s"},Object(N.jsx)("h3",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.settings.anomalyDetection.filterListsTitle",defaultMessage:"Filter Lists"}))),Object(N.jsx)(te.EuiSpacer,{size:"s"}),Object(N.jsx)(te.EuiText,{size:"s"},Object(N.jsx)(te.EuiTextColor,{color:"subdued"},Object(N.jsx)("p",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.settings.anomalyDetection.filterListsText",defaultMessage:"Filter lists contain values that you can use to include or exclude events from the machine learning analysis."})))),Object(N.jsx)(te.EuiSpacer,{size:"m"}),Object(N.jsx)(te.EuiFlexGroup,{alignItems:"center"},s&&Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiText,null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.settings.anomalyDetection.filterListsSummaryCount",defaultMessage:"You have {filterListsCountBadge} {filterListsCount, plural, one {filter list} other {filter lists}}",values:{filterListsCountBadge:Object(N.jsx)(te.EuiBadge,null,a),filterListsCount:a}}))),Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiButtonEmpty,{"data-test-subj":"mlFilterListsMngButton",flush:"left",color:"primary",onClick:p,isDisabled:!1===s},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.settings.anomalyDetection.manageFilterListsLink",defaultMessage:"Manage"}))),Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiButtonEmpty,{"data-test-subj":"mlFilterListsCreateButton",color:"primary",onClick:m,isDisabled:!1===r},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.settings.anomalyDetection.createFilterListsLink",defaultMessage:"Create"}))))))))},Or=()=>{const{services:{docLinks:e}}=Object(f.b)(),t=e.links.ml.guide;return Object(N.jsx)(n.Fragment,null,Object(N.jsx)(cr.a,{tabId:"settings"}),Object(N.jsx)(te.EuiPage,{className:"mlSettingsPage","data-test-subj":"mlPageSettings"},Object(N.jsx)(te.EuiPageBody,null,Object(N.jsx)(te.EuiPageHeader,{className:"mlSettingsPage__header"},Object(N.jsx)(te.EuiPageHeaderSection,null,Object(N.jsx)(te.EuiTitle,null,Object(N.jsx)("h1",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.settings.title",defaultMessage:"Settings"}))))),Object(N.jsx)(yr,null))),Object(N.jsx)(dr.a,{docLink:t}))},Er=(e,t)=>({path:"/settings",render:(e,t)=>Object(N.jsx)(wr,v()({},e,{deps:t})),breadcrumbs:[P("ML_BREADCRUMB",e,t),P("SETTINGS_BREADCRUMB",e,t)]}),wr=({deps:e})=>{const{redirectToMlAccessDeniedPage:t}=e,{context:a}=F(void 0,void 0,e.config,{checkFullLicense:u.b,checkGetJobsCapabilities:()=>Object(I.c)(t),getMlNodeCount:$.c});Object(f.g)({timeRangeSelector:!1,autoRefreshSelector:!1});const i=Object(I.e)("canGetFilters"),n=Object(I.e)("canCreateFilter"),s=Object(I.e)("canGetCalendars"),r=Object(I.e)("canCreateCalendar");return Object(N.jsx)(Vb,{context:a},Object(N.jsx)(vr.Provider,{value:{canGetFilters:i,canCreateFilter:n,canGetCalendars:s,canCreateCalendar:r}},Object(N.jsx)(Or,null)))};function _r(){return Math.random().toString(36).substr(2,9)}function Sr({onClick:e,testSubj:t,disabled:a}){return Object(N.jsx)(n.Fragment,null,Object(N.jsx)(te.EuiButtonEmpty,{size:"xs",color:"danger",onClick:e,isDisabled:a,"data-test-subj":t},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.calendarsEdit.eventsTable.deleteButtonLabel",defaultMessage:"Delete"})))}const Mr=({canCreateCalendar:e,canDeleteCalendar:t,eventsList:a,onDeleteClick:i,showSearchBar:s,showImportModal:r,showNewEventModal:o,loading:l,saving:c})=>{const d=[{field:"description",name:y.i18n.translate("xpack.ml.calendarsEdit.eventsTable.descriptionColumnName",{defaultMessage:"Description"}),sortable:!0,truncateText:!0,scope:"row"},{field:"start_time",name:y.i18n.translate("xpack.ml.calendarsEdit.eventsTable.startColumnName",{defaultMessage:"Start"}),sortable:!0,render:e=>qe()(e).format(tr.a)},{field:"end_time",name:y.i18n.translate("xpack.ml.calendarsEdit.eventsTable.endColumnName",{defaultMessage:"End"}),sortable:!0,render:e=>qe()(e).format(tr.a)},{field:"",name:"",render:e=>Object(N.jsx)(Sr,{testSubj:"mlCalendarEventDeleteButton",disabled:!1===t||!0===c||!0===l,onClick:()=>{i(e.event_id)}})}],u={toolsRight:[Object(N.jsx)(te.EuiButton,{isDisabled:!1===e||!0===c||!0===l,key:"ml_new_event","data-test-subj":"mlCalendarNewEventButton",size:"s",iconType:"plusInCircle",onClick:o},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.calendarsEdit.eventsTable.newEventButtonLabel",defaultMessage:"New event"})),Object(N.jsx)(te.EuiButton,{isDisabled:!1===e||!0===c||!0===l,key:"ml_import_event","data-test-subj":"mlCalendarImportEventsButton",size:"s",iconType:"importAction",onClick:r},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.calendarsEdit.eventsTable.importEventsButtonLabel",defaultMessage:"Import events"}))],box:{incremental:!0},filters:[]};return Object(N.jsx)(n.Fragment,null,Object(N.jsx)(te.EuiSpacer,{size:"m"}),Object(N.jsx)(te.EuiInMemoryTable,{items:a,itemId:"event_id",columns:d,pagination:{initialPageSize:5,pageSizeOptions:[5,10]},sorting:{sort:{field:"description",direction:"asc"}},search:s?u:void 0,"data-test-subj":"mlCalendarEventsTable",rowProps:e=>({"data-test-subj":`mlCalendarEventListRow row-${e.description}`})}))};function kr({calendarId:e,description:t}){return Object(N.jsx)(n.Fragment,null,Object(N.jsx)(te.EuiTitle,{"data-test-subj":"mlCalendarTitle"},Object(N.jsx)("h1",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.calendarsEdit.calendarForm.calendarTitle",defaultMessage:"Calendar {calendarId}",values:{calendarId:e}}))),Object(N.jsx)(te.EuiText,{"data-test-subj":"mlCalendarDescriptionText"},Object(N.jsx)("p",null,t)),Object(N.jsx)(te.EuiSpacer,{size:"l"}))}Mr.defaultProps={showSearchBar:!1,canCreateCalendar:!0,canDeleteCalendar:!0};const Cr=({calendarId:e,canCreateCalendar:t,canDeleteCalendar:a,description:i,eventsList:r,groupIds:o,isEdit:l,isNewCalendarIdValid:c,jobIds:d,onCalendarIdChange:u,onCreate:p,onCreateGroupOption:m,onDescriptionChange:b,onEdit:h,onEventDelete:f,onGroupSelection:g,showImportModal:j,onJobSelection:x,saving:v,loading:O,selectedGroupOptions:E,selectedJobOptions:w,showNewEventModal:_,isGlobalCalendar:S,onGlobalCalendarChange:M})=>{const k=y.i18n.translate("xpack.ml.calendarsEdit.calendarForm.allowedCharactersDescription",{defaultMessage:"Use lowercase alphanumerics (a-z and 0-9), hyphens or underscores; must start and end with an alphanumeric character"}),F=!0!==c||l?void 0:k,I=!1!==c||l?void 0:[k],D=!1===t||v||!c||""===e||!0===O,A=Object(C.a)(T.b.CALENDARS_MANAGE);return Object(N.jsx)(te.EuiForm,{"data-test-subj":"mlCalendarForm"+(!0===l?"Edit":"New")},!0===l?Object(N.jsx)(kr,{calendarId:e,description:i}):Object(N.jsx)(n.Fragment,null,Object(N.jsx)(te.EuiTitle,null,Object(N.jsx)("h1",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.calendarsEdit.calendarForm.createCalendarTitle",defaultMessage:"Create new calendar"}))),Object(N.jsx)(te.EuiSpacer,{size:"m"}),Object(N.jsx)(te.EuiFormRow,{label:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.calendarsEdit.calendarForm.calendarIdLabel",defaultMessage:"Calendar ID"}),helpText:F,error:I,isInvalid:!c},Object(N.jsx)(te.EuiFieldText,{name:"calendarId",value:e,onChange:u,disabled:!0===l||!0===v||!0===O,"data-test-subj":"mlCalendarIdInput"})),Object(N.jsx)(te.EuiFormRow,{label:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.calendarsEdit.calendarForm.descriptionLabel",defaultMessage:"Description"})},Object(N.jsx)(te.EuiFieldText,{name:"description",value:i,onChange:b,disabled:!0===l||!0===v||!0===O,"data-test-subj":"mlCalendarDescriptionInput"}))),Object(N.jsx)(te.EuiSpacer,{size:"xl"}),Object(N.jsx)(te.EuiSwitch,{name:"switch",label:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.calendarsEdit.calendarForm.allJobsLabel",defaultMessage:"Apply calendar to all jobs"}),checked:S,onChange:M,disabled:!0===v||!1===t||!0===O,"data-test-subj":"mlCalendarApplyToAllJobsSwitch"}),!1===S&&Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(te.EuiSpacer,{size:"m"}),Object(N.jsx)(te.EuiFormRow,{label:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.calendarsEdit.calendarForm.jobsLabel",defaultMessage:"Jobs"})},Object(N.jsx)(te.EuiComboBox,{options:d,selectedOptions:w,onChange:x,isDisabled:!0===v||!1===t||!0===O,"data-test-subj":"mlCalendarJobSelection"})),Object(N.jsx)(te.EuiFormRow,{label:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.calendarsEdit.calendarForm.groupsLabel",defaultMessage:"Groups"})},Object(N.jsx)(te.EuiComboBox,{onCreateOption:m,options:o,selectedOptions:E,onChange:g,isDisabled:!0===v||!1===t||!0===O,"data-test-subj":"mlCalendarJobGroupSelection"}))),Object(N.jsx)(te.EuiSpacer,{size:"xl"}),Object(N.jsx)(te.EuiFormRow,{label:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.calendarsEdit.calendarForm.eventsLabel",defaultMessage:"Events"}),fullWidth:!0},Object(N.jsx)(Mr,{canCreateCalendar:t,canDeleteCalendar:a,eventsList:r,onDeleteClick:f,showImportModal:j,showNewEventModal:_,loading:O,saving:v,showSearchBar:!0})),Object(N.jsx)(te.EuiSpacer,{size:"l"}),Object(N.jsx)(te.EuiFlexGroup,{justifyContent:"flexEnd"},Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiButton,{isDisabled:v,onClick:A},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.calendarsEdit.calendarForm.cancelButtonLabel",defaultMessage:"Cancel"}))),Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiButton,{"data-test-subj":"mlSaveCalendarButton",fill:!0,onClick:l?h:p,isDisabled:D},v?Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.calendarsEdit.calendarForm.savingButtonLabel",defaultMessage:"Saving…"}):Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.calendarsEdit.calendarForm.saveButtonLabel",defaultMessage:"Save"})))))};class new_event_modal_NewEventModal extends n.Component{constructor(e){super(e),Ce()(this,"onDescriptionChange",(e=>{this.setState({description:e.target.value})})),Ce()(this,"handleAddEvent",(()=>{const{description:e,startDate:t,endDate:a}=this.state,i=_r(),n={description:e,start_time:t.valueOf(),end_time:a.valueOf(),event_id:i};this.props.addEvent(n)})),Ce()(this,"handleChangeStart",(e=>{let t=null,a=this.state.endDate;const i=qe()(e),n=qe()(e);t=i.startOf("day"),t>a&&(a=n.startOf("day").add(1,"days")),this.setState({startDate:t,endDate:a,startDateString:t.format(tr.a),endDateString:a.format(tr.a)})})),Ce()(this,"handleChangeEnd",(e=>{let t=this.state.startDate,a=null;const i=qe()(e);a=qe()(e).startOf("day"),t>a&&(t=i.startOf("day").subtract(1,"days")),this.setState({startDate:t,endDate:a,startDateString:t.format(tr.a),endDateString:a.format(tr.a)})})),Ce()(this,"handleTimeStartChange",(e=>{const t=e.target.value;let a=!1;19===t.length?a=qe()(t).isValid(tr.a,!0):this.setState({startDateString:t}),a&&this.setState({startDateString:t,startDate:qe()(t)})})),Ce()(this,"handleTimeEndChange",(e=>{const t=e.target.value;let a=!1;19===t.length?a=qe()(t).isValid(tr.a,!0):this.setState({endDateString:t}),a&&this.setState({endDateString:t,endDate:qe()(t)})})),Ce()(this,"renderRangedDatePicker",(()=>{const{startDate:e,endDate:t,startDateString:a,endDateString:i}=this.state,s=Object(N.jsx)(n.Fragment,null,Object(N.jsx)(te.EuiFlexGroup,null,Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(te.EuiFormRow,{label:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.calendarsEdit.newEventModal.fromLabel",defaultMessage:"From:"}),helpText:tr.a},Object(N.jsx)(te.EuiFieldText,{name:"startTime",onChange:this.handleTimeStartChange,placeholder:tr.a,value:a}))),Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(te.EuiFormRow,{label:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.calendarsEdit.newEventModal.toLabel",defaultMessage:"To:"}),helpText:tr.a},Object(N.jsx)(te.EuiFieldText,{name:"endTime",onChange:this.handleTimeEndChange,placeholder:tr.a,value:i})))));return Object(N.jsx)(n.Fragment,null,Object(N.jsx)(te.EuiSpacer,{size:"s"}),s,Object(N.jsx)(te.EuiSpacer,{size:"s"}),Object(N.jsx)(te.EuiFormRow,{fullWidth:!0},Object(N.jsx)(te.EuiDatePickerRange,{fullWidth:!0,iconType:!1,startDateControl:Object(N.jsx)(te.EuiDatePicker,{fullWidth:!0,inline:!0,selected:e,onChange:this.handleChangeStart,startDate:e,endDate:t,isInvalid:e>t,"aria-label":y.i18n.translate("xpack.ml.calendarsEdit.newEventModal.startDateAriaLabel",{defaultMessage:"Start date"}),timeFormat:tr.a,dateFormat:tr.a}),endDateControl:Object(N.jsx)(te.EuiDatePicker,{fullWidth:!0,inline:!0,selected:t,onChange:this.handleChangeEnd,startDate:e,endDate:t,isInvalid:e>t,"aria-label":y.i18n.translate("xpack.ml.calendarsEdit.newEventModal.endDateAriaLabel",{defaultMessage:"End date"}),timeFormat:tr.a,dateFormat:tr.a})})))}));const t=qe()().startOf("day"),a=qe()().startOf("day").add(1,"days");this.state={startDate:t,endDate:a,description:"",startDateString:t.format(tr.a),endDateString:a.format(tr.a)}}render(){const{closeModal:e}=this.props,{description:t}=this.state;return Object(N.jsx)(n.Fragment,null,Object(N.jsx)(te.EuiModal,{onClose:e,initialFocus:"[name=eventDescription]",maxWidth:!1,"data-test-subj":"mlCalendarEventForm"},Object(N.jsx)(te.EuiModalHeader,null,Object(N.jsx)(te.EuiModalHeaderTitle,null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.calendarsEdit.newEventModal.createNewEventTitle",defaultMessage:"Create new event"}))),Object(N.jsx)(te.EuiModalBody,null,Object(N.jsx)(te.EuiForm,null,Object(N.jsx)(te.EuiFormRow,{label:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.calendarsEdit.newEventModal.descriptionLabel",defaultMessage:"Description"}),fullWidth:!0},Object(N.jsx)(te.EuiFieldText,{name:"eventDescription",onChange:this.onDescriptionChange,isInvalid:!t,fullWidth:!0,"data-test-subj":"mlCalendarEventDescriptionInput"})),Object(N.jsx)(te.EuiSpacer,{size:"m"}),this.renderRangedDatePicker())),Object(N.jsx)(te.EuiModalFooter,null,Object(N.jsx)(te.EuiButtonEmpty,{onClick:e,"data-test-subj":"mlCalendarCancelEventButton"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.calendarsEdit.newEventModal.cancelButtonLabel",defaultMessage:"Cancel"})),Object(N.jsx)(te.EuiButton,{onClick:this.handleAddEvent,fill:!0,disabled:!t,"data-test-subj":"mlCalendarAddEventButton"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.calendarsEdit.newEventModal.addButtonLabel",defaultMessage:"Add"})))))}}function Tr({events:e,showRecurringWarning:t,includePastEvents:a,onCheckboxToggle:i,onEventDelete:s}){return Object(N.jsx)(n.Fragment,null,Object(N.jsx)(te.EuiSpacer,{size:"s"}),Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(te.EuiText,null,Object(N.jsx)("h4",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.calendarsEdit.importedEvents.eventsToImportTitle",defaultMessage:"Events to import: {eventsCount}",values:{eventsCount:e.length}})),t&&Object(N.jsx)(te.EuiText,{color:"danger"},Object(N.jsx)("p",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.calendarsEdit.importedEvents.recurringEventsNotSupportedDescription",defaultMessage:"Recurring events not supported. Only the first event will be imported."}))))),Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(Mr,{eventsList:e,onDeleteClick:s})),Object(N.jsx)(te.EuiSpacer,{size:"m"}),Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiCheckbox,{id:"ml-include-past-events",label:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.calendarsEdit.importedEvents.includePastEventsLabel",defaultMessage:"Include past events"}),checked:a,onChange:i})))}var Fr=a(282),Ir=a.n(Fr);function Dr(e){const t=qe()().valueOf();return e.filter((e=>e.start_time>t))}function Ar(e){return function(e){const t=e.events(),a=[];return t.forEach((e=>{if("VEVENT"===e.element){const t=e.properties.SUMMARY,i=e.properties.DTSTART,n=e.properties.DTEND,s=void 0!==e.properties.RRULE;if(t&&i&&n&&t.length&&i.length&&n.length){const e=_r();a.push({event_id:e,description:t[0].value,start_time:i[0].value.valueOf(),end_time:n[0].value.valueOf(),asterisk:s})}}})),a}(Ir.a.parse_calendar(e+"\n"))}class import_modal_ImportModal extends n.Component{constructor(e){super(e),Ce()(this,"handleImport",(async e=>{const t=e[0],a=y.i18n.translate("xpack.ml.calendarsEdit.importModal.couldNotParseICSFileErrorMessage",{defaultMessage:"Could not parse ICS file."});let i=[];if(t&&t.size<=1e8){this.setState({fileLoading:!0,fileLoaded:!0});try{i=Ar((await(n=t,new Promise(((e,t)=>{if(n&&n.size){const a=new FileReader;a.readAsText(n),a.onload=()=>{const i=a.result;""===i?t():e({data:i})}}else t()})))).data),this.setState({allImportedEvents:i,selectedEvents:Dr(i),fileLoading:!1,errorMessage:null,includePastEvents:!1})}catch(e){console.log(a,e),this.setState({errorMessage:a,fileLoading:!1})}}else t&&t.size>1e8?this.setState({fileLoading:!1,errorMessage:a}):this.setState({fileLoading:!1,errorMessage:null});var n})),Ce()(this,"onEventDelete",(e=>{this.setState((t=>({allImportedEvents:t.allImportedEvents.filter((t=>t.event_id!==e)),selectedEvents:t.selectedEvents.filter((t=>t.event_id!==e))})))})),Ce()(this,"onCheckboxToggle",(e=>{this.setState({includePastEvents:e.target.checked})})),Ce()(this,"handleEventsAdd",(()=>{const{allImportedEvents:e,selectedEvents:t,includePastEvents:a}=this.state,i=(a?e:t).map((e=>({description:e.description,start_time:e.start_time,end_time:e.end_time,event_id:e.event_id})));this.props.addImportedEvents(i)})),Ce()(this,"renderCallout",(()=>Object(N.jsx)(te.EuiCallOut,{color:"danger"},Object(N.jsx)("p",null,this.state.errorMessage)))),this.state={includePastEvents:!1,allImportedEvents:[],selectedEvents:[],fileLoading:!1,fileLoaded:!1,errorMessage:null}}render(){const{closeImportModal:e}=this.props,{fileLoading:t,fileLoaded:a,allImportedEvents:i,selectedEvents:s,errorMessage:r,includePastEvents:o}=this.state;let l,c=!1;return l=o?i:s,void 0!==l.find((e=>e.asterisk))&&(c=!0),Object(N.jsx)(n.Fragment,null,Object(N.jsx)(te.EuiModal,{onClose:e,maxWidth:!0},Object(N.jsx)(te.EuiModalHeader,null,Object(N.jsx)(te.EuiFlexGroup,{direction:"column",gutterSize:"none"},Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiModalHeaderTitle,null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.calendarsEdit.eventsTable.importEventsTitle",defaultMessage:"Import events"}))),Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)("p",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.calendarsEdit.eventsTable.importEventsDescription",defaultMessage:"Import events from an ICS file."}))))),Object(N.jsx)(te.EuiModalBody,null,Object(N.jsx)(te.EuiFlexGroup,{direction:"column"},Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiFilePicker,{compressed:!0,initialPromptText:y.i18n.translate("xpack.ml.calendarsEdit.importModal.selectOrDragAndDropFilePromptText",{defaultMessage:"Select or drag and drop a file"}),onChange:this.handleImport,disabled:t})),null!==r&&this.renderCallout(),i.length>0&&Object(N.jsx)(Tr,{events:l,showRecurringWarning:c,includePastEvents:o,onCheckboxToggle:this.onCheckboxToggle,onEventDelete:this.onEventDelete}))),Object(N.jsx)(te.EuiModalFooter,null,Object(N.jsx)(te.EuiButtonEmpty,{onClick:e},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.calendarsEdit.eventsTable.cancelButtonLabel",defaultMessage:"Cancel"})),Object(N.jsx)(te.EuiButton,{onClick:this.handleEventsAdd,fill:!0,disabled:!1===a||null!==r},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.calendarsEdit.eventsTable.importButtonLabel",defaultMessage:"Import"})))))}}class new_calendar_NewCalendarUI extends n.Component{constructor(e){super(e),Ce()(this,"returnToCalendarsManagementPage",(async()=>{const{services:{http:{basePath:e},application:{navigateToUrl:t}}}=this.props.kibana;await t(`${e.get()}/app/ml/${T.b.CALENDARS_MANAGE}`,!0)})),Ce()(this,"isDuplicateId",(()=>{const{calendars:e,formCalendarId:t}=this.state;for(let a=0;a<e.length;a++)if(e[a].calendar_id===t)return!0;return!1})),Ce()(this,"onCreate",(async()=>{const{formCalendarId:e}=this.state;if(this.isDuplicateId()){const{toasts:t}=this.props.kibana.services.notifications;t.addDanger(y.i18n.translate("xpack.ml.calendarsEdit.canNotCreateCalendarWithExistingIdErrorMessag",{defaultMessage:"Cannot create calendar with id [{formCalendarId}] as it already exists.",values:{formCalendarId:e}}))}else{const e=this.setUpCalendarForApi();this.setState({saving:!0});try{await ge.ml.addCalendar(e),await this.returnToCalendarsManagementPage()}catch(t){console.log("Error saving calendar",t),this.setState({saving:!1});const{toasts:a}=this.props.kibana.services.notifications;a.addDanger(y.i18n.translate("xpack.ml.calendarsEdit.errorWithCreatingCalendarErrorMessage",{defaultMessage:"An error occurred creating calendar {calendarId}",values:{calendarId:e.calendarId}}))}}})),Ce()(this,"onEdit",(async()=>{const e=this.setUpCalendarForApi();this.setState({saving:!0});try{await ge.ml.updateCalendar(e),await this.returnToCalendarsManagementPage()}catch(t){console.log("Error saving calendar",t),this.setState({saving:!1});const{toasts:a}=this.props.kibana.services.notifications;a.addDanger(y.i18n.translate("xpack.ml.calendarsEdit.errorWithUpdatingCalendarErrorMessage",{defaultMessage:"An error occurred saving calendar {calendarId}. Try refreshing the page.",values:{calendarId:e.calendarId}}))}})),Ce()(this,"setUpCalendarForApi",(()=>{const{formCalendarId:e,description:t,events:a,selectedGroupOptions:i,selectedJobOptions:n,isGlobalCalendar:s}=this.state,r=s?[nn.a]:[...n.map((e=>e.label)),...i.map((e=>e.label))];return{calendarId:e,description:t,events:a.map((e=>({description:e.description,start_time:e.start_time,end_time:e.end_time}))),job_ids:r}})),Ce()(this,"onCreateGroupOption",(e=>{const t={label:e};this.setState((e=>({selectedGroupOptions:e.selectedGroupOptions.concat(t)})))})),Ce()(this,"onGlobalCalendarChange",(({currentTarget:e})=>{this.setState({isGlobalCalendar:e.checked})})),Ce()(this,"onJobSelection",(e=>{this.setState({selectedJobOptions:e})})),Ce()(this,"onGroupSelection",(e=>{this.setState({selectedGroupOptions:e})})),Ce()(this,"onCalendarIdChange",(e=>{const t=function(e){let t=!0;return(""===e||void 0===e||!1===Object(Te.i)(e))&&(t=!1),t}(e.target.value);this.setState({formCalendarId:e.target.value,isNewCalendarIdValid:t})})),Ce()(this,"onDescriptionChange",(e=>{this.setState({description:e.target.value})})),Ce()(this,"showImportModal",(()=>{this.setState((e=>({isImportModalVisible:!e.isImportModalVisible})))})),Ce()(this,"closeImportModal",(()=>{this.setState({isImportModalVisible:!1})})),Ce()(this,"onEventDelete",(e=>{this.setState((t=>({events:t.events.filter((t=>t.event_id!==e))})))})),Ce()(this,"closeNewEventModal",(()=>{this.setState({isNewEventModalVisible:!1})})),Ce()(this,"showNewEventModal",(()=>{this.setState({isNewEventModalVisible:!0})})),Ce()(this,"addEvent",(e=>{this.setState((t=>({events:[...t.events,e],isNewEventModalVisible:!1})))})),Ce()(this,"addImportedEvents",(e=>{this.setState((t=>({events:[...t.events,...e],isImportModalVisible:!1})))})),this.state={isNewEventModalVisible:!1,isImportModalVisible:!1,isNewCalendarIdValid:null,loading:!0,jobIds:[],jobIdOptions:[],groupIds:[],groupIdOptions:[],calendars:[],formCalendarId:"",description:"",selectedJobOptions:[],selectedGroupOptions:[],events:[],saving:!1,selectedCalendar:void 0,isGlobalCalendar:!1}}componentDidMount(){this.formSetup()}async formSetup(){try{const{jobIds:e,groupIds:t,calendars:a}=await new Promise((async(e,t)=>{try{const[t,a,i]=await Promise.all([new Promise(((e,t)=>{ge.ml.jobs.jobsSummary().then((t=>{e(t.map((e=>e.id)))})).catch((e=>{const a=y.i18n.translate("xpack.ml.calendarsEdit.errorWithFetchingJobSummariesErrorMessage",{defaultMessage:"Error fetching job summaries: {err}",values:{err:e}});console.log(a),t(a)}))})),new Promise(((e,t)=>{ge.ml.jobs.groups().then((t=>{e(t.map((e=>e.id)))})).catch((e=>{const a=y.i18n.translate("xpack.ml.calendarsEdit.errorWithLoadingGroupsErrorMessage",{defaultMessage:"Error loading groups: {err}",values:{err:e}});console.log(a),t(a)}))})),new Promise(((e,t)=>{ge.ml.calendars().then((t=>{e(t)})).catch((e=>{const a=y.i18n.translate("xpack.ml.calendarsEdit.errorWithLoadingCalendarsErrorMessage",{defaultMessage:"Error loading calendars: {err}",values:{err:e}});console.log(a),t(a)}))}))]);e({jobIds:t,groupIds:a,calendars:i})}catch(e){console.log(e),t(e)}})),i=e.map((e=>({label:e}))),n=t.map((e=>({label:e}))),s=[],r=[];let o,l=[],c="",d=!1;void 0!==this.props.calendarId&&(o=a.find((e=>e.calendar_id===this.props.calendarId)),o&&(c=o.calendar_id,l=o.events,o.job_ids.includes(nn.a)?d=!0:o.job_ids.forEach((a=>{e.find((e=>e===a))?s.push({label:a}):t.find((e=>e===a))&&r.push({label:a})})))),this.setState({events:l,formCalendarId:c,jobIds:e,jobIdOptions:i,groupIds:t,groupIdOptions:n,calendars:a,loading:!1,selectedJobOptions:s,selectedGroupOptions:r,selectedCalendar:o,isGlobalCalendar:d})}catch(e){console.log(e),this.setState({loading:!1});const{toasts:t}=this.props.kibana.services.notifications;t.addDanger(y.i18n.translate("xpack.ml.calendarsEdit.errorWithLoadingCalendarFromDataErrorMessage",{defaultMessage:"An error occurred loading calendar form data. Try refreshing the page."}))}}render(){const{events:e,isNewEventModalVisible:t,isImportModalVisible:a,isNewCalendarIdValid:i,formCalendarId:s,description:r,groupIdOptions:o,jobIdOptions:l,saving:c,loading:u,selectedCalendar:p,selectedJobOptions:m,selectedGroupOptions:b,isGlobalCalendar:h}=this.state,f=Object(d.c)().links.ml.calendars;let g="";return t?g=Object(N.jsx)(new_event_modal_NewEventModal,{addEvent:this.addEvent,closeModal:this.closeNewEventModal}):a&&(g=Object(N.jsx)(import_modal_ImportModal,{addImportedEvents:this.addImportedEvents,closeImportModal:this.closeImportModal})),Object(N.jsx)(n.Fragment,null,Object(N.jsx)(cr.a,{tabId:"settings"}),Object(N.jsx)(te.EuiPage,{className:"mlCalendarEditForm","data-test-subj":"mlPageCalendarEdit"},Object(N.jsx)(te.EuiPageBody,null,Object(N.jsx)(te.EuiPageContent,{className:"mlCalendarEditForm__content",verticalPosition:"center",horizontalPosition:"center"},Object(N.jsx)(Cr,{calendarId:p?p.calendar_id:s,canCreateCalendar:this.props.canCreateCalendar,canDeleteCalendar:this.props.canDeleteCalendar,description:p?p.description:r,eventsList:e,groupIds:o,isEdit:void 0!==p,isNewCalendarIdValid:!(!p&&null!==i)||i,jobIds:l,onCalendarIdChange:this.onCalendarIdChange,onCreate:this.onCreate,onDescriptionChange:this.onDescriptionChange,onEdit:this.onEdit,onEventDelete:this.onEventDelete,onGroupSelection:this.onGroupSelection,showImportModal:this.showImportModal,onJobSelection:this.onJobSelection,saving:c,loading:u,selectedGroupOptions:b,selectedJobOptions:m,onCreateGroupOption:this.onCreateGroupOption,showNewEventModal:this.showNewEventModal,isGlobalCalendar:h,onGlobalCalendarChange:this.onGlobalCalendarChange})),g)),Object(N.jsx)(dr.a,{docLink:f}))}}const Lr=Object(c.withKibana)(new_calendar_NewCalendarUI);const Rr=Object(c.withKibana)((function({totalCount:e,refreshCalendars:t,kibana:a}){const i=a.services.docLinks.links.ml.calendars;return Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(te.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"baseline"},Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiFlexGroup,{alignItems:"baseline",gutterSize:"m",responsive:!1},Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiTitle,null,Object(N.jsx)("h1",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.settings.calendars.listHeader.calendarsTitle",defaultMessage:"Calendars"})))),Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiTextColor,{color:"subdued"},Object(N.jsx)("p",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.settings.calendars.listHeader.calendarsListTotalCount",defaultMessage:"{totalCount} in total",values:{totalCount:e}})))))),Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiFlexGroup,{alignItems:"baseline",gutterSize:"m",responsive:!1},Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiButtonEmpty,{size:"s",iconType:"refresh",onClick:t,"data-test-subj":"mlCalendarListRefreshButton"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.settings.calendars.listHeader.refreshButtonLabel",defaultMessage:"Refresh"})))))),Object(N.jsx)(te.EuiSpacer,{size:"m"}),Object(N.jsx)(te.EuiText,null,Object(N.jsx)("p",null,Object(N.jsx)(te.EuiTextColor,{color:"subdued"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.settings.calendars.listHeader.calendarsDescription",defaultMessage:"Calendars contain a list of scheduled events for which you do not want to generate anomalies, such as planned system outages or public holidays. The same calendar can be assigned to multiple jobs.{br}{learnMoreLink}",values:{br:Object(N.jsx)("br",null),learnMoreLink:Object(N.jsx)(te.EuiLink,{href:i,target:"_blank"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.settings.calendars.listHeader.calendarsDescription.learnMoreLinkText",defaultMessage:"Learn more"}))}})))),Object(N.jsx)(te.EuiSpacer,{size:"m"}))})),Pr=({calendarsList:e,onDeleteClick:t,setSelectedCalendarList:a,loading:i,canCreateCalendar:n,canDeleteCalendar:s,mlNodesAvailable:r,itemsSelected:o})=>{const l=Object(C.a)(T.b.CALENDARS_NEW),c=[{field:"calendar_id",name:y.i18n.translate("xpack.ml.calendarsList.table.idColumnName",{defaultMessage:"ID"}),sortable:!0,truncateText:!0,scope:"row",render:e=>Object(N.jsx)(h.Link,{to:`/${T.b.CALENDARS_EDIT}/${e}`,"data-test-subj":"mlEditCalendarLink"},e),"data-test-subj":"mlCalendarListColumnId"},{field:"job_ids_string",name:y.i18n.translate("xpack.ml.calendarsList.table.jobsColumnName",{defaultMessage:"Jobs"}),sortable:!0,truncateText:!0,render:e=>e===nn.a?Object(N.jsx)("span",{style:{fontStyle:"italic"}},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.calendarsList.table.allJobsLabel",defaultMessage:"Applies to all jobs"})):e,"data-test-subj":"mlCalendarListColumnJobs"},{field:"events_length",name:y.i18n.translate("xpack.ml.calendarsList.table.eventsColumnName",{defaultMessage:"Events"}),sortable:!0,render:e=>y.i18n.translate("xpack.ml.calendarsList.table.eventsCountLabel",{defaultMessage:"{eventsLength, plural, one {# event} other {# events}}",values:{eventsLength:e}}),"data-test-subj":"mlCalendarListColumnEvents"}],d={onSelectionChange:e=>a(e)},u={toolsRight:[Object(N.jsx)(te.EuiButton,{size:"s","data-test-subj":"mlCalendarButtonCreate",key:"new_calendar_button",onClick:l,isDisabled:!1===n||!1===r},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.calendarsList.table.newButtonLabel",defaultMessage:"New"})),Object(N.jsx)(te.EuiButton,{size:"s",color:"danger",iconType:"trash",onClick:t,isDisabled:!1===s||!1===r||!1===o,"data-test-subj":"mlCalendarButtonDelete",key:"delete_calendar_button"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.calendarsList.table.deleteButtonLabel",defaultMessage:"Delete"}))],box:{incremental:!0},filters:[]};return Object(N.jsx)("div",{"data-test-subj":"mlCalendarTableContainer"},Object(N.jsx)(te.EuiInMemoryTable,{items:e,itemId:"calendar_id",columns:c,search:u,pagination:{initialPageSize:20,pageSizeOptions:[10,20]},sorting:{sort:{field:"calendar_id",direction:"asc"}},loading:i,selection:d,isSelectable:!0,"data-test-subj":i?"mlCalendarTable loading":"mlCalendarTable loaded",rowProps:e=>({"data-test-subj":`mlCalendarListRow row-${e.calendar_id}`})}))};class calendars_list_CalendarsListUI extends n.Component{constructor(e){super(e),Ce()(this,"loadCalendars",(async()=>{this.setState({loading:!0});try{const e=await ge.ml.calendars();this.setState({calendars:e,loading:!1,isDestroyModalVisible:!1})}catch(e){console.log(e),this.setState({loading:!1});const{toasts:t}=this.props.kibana.services.notifications;t.addDanger(y.i18n.translate("xpack.ml.calendarsList.errorWithLoadingListOfCalendarsErrorMessage",{defaultMessage:"An error occurred loading the list of calendars."}))}})),Ce()(this,"closeDestroyModal",(()=>{this.setState({isDestroyModalVisible:!1,calendarId:null})})),Ce()(this,"showDestroyModal",(()=>{this.setState({isDestroyModalVisible:!0})})),Ce()(this,"setSelectedCalendarList",(e=>{this.setState({selectedForDeletion:e})})),Ce()(this,"deleteCalendars",(()=>{const{selectedForDeletion:e}=this.state;this.closeDestroyModal(),async function(e,t){if(void 0===e||0===e.length)return;const a=Object(d.k)(),i=e.length>1?y.i18n.translate("xpack.ml.calendarsList.deleteCalendars.calendarsLabel",{defaultMessage:"{calendarsToDeleteCount} calendars",values:{calendarsToDeleteCount:e.length}}):`${e[0].calendar_id}`;a.add(y.i18n.translate("xpack.ml.calendarsList.deleteCalendars.deletingCalendarsNotificationMessage",{defaultMessage:"Deleting {messageId}",values:{messageId:i}}));for(const t of e){const e=t.calendar_id;try{await ge.ml.deleteCalendar({calendarId:e})}catch(e){console.log("Error deleting calendar:",e),a.addDanger({title:y.i18n.translate("xpack.ml.calendarsList.deleteCalendars.deletingCalendarErrorMessage",{defaultMessage:"An error occurred deleting calendar {calendarId}",values:{calendarId:t.calendar_id}}),text:Object(ze.b)(e)})}}a.addSuccess(y.i18n.translate("xpack.ml.calendarsList.deleteCalendars.deletingCalendarSuccessNotificationMessage",{defaultMessage:"{messageId} deleted",values:{messageId:i}})),t()}(e,this.loadCalendars)})),Ce()(this,"addRequiredFieldsToList",((e=[])=>{for(let t=0;t<e.length;t++)e[t].job_ids_string=e[t].job_ids.join(", "),e[t].events_length=e[t].events.length;return e})),this.state={loading:!0,calendars:[],isDestroyModalVisible:!1,calendarId:null,selectedForDeletion:[],nodesAvailable:Object($.e)()}}componentDidMount(){this.loadCalendars()}render(){const{calendars:e,selectedForDeletion:t,loading:a,nodesAvailable:i}=this.state,{canCreateCalendar:s,canDeleteCalendar:r}=this.props;let o="";const l=Object(d.c)().links.ml.calendars;return this.state.isDestroyModalVisible&&(o=Object(N.jsx)(te.EuiConfirmModal,{"data-test-subj":"mlCalendarDeleteConfirmation",title:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.calendarsList.deleteCalendarsModal.deleteMultipleCalendarsTitle",defaultMessage:"Delete {calendarsCount, plural, one {{calendarsList}} other {# calendars}}?",values:{calendarsCount:t.length,calendarsList:t.map((e=>e.calendar_id)).join(", ")}}),onCancel:this.closeDestroyModal,onConfirm:this.deleteCalendars,cancelButtonText:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.calendarsList.deleteCalendarsModal.cancelButtonLabel",defaultMessage:"Cancel"}),confirmButtonText:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.calendarsList.deleteCalendarsModal.deleteButtonLabel",defaultMessage:"Delete"}),buttonColor:"danger",defaultFocusedButton:te.EUI_MODAL_CONFIRM_BUTTON})),Object(N.jsx)(n.Fragment,null,Object(N.jsx)(cr.a,{tabId:"settings"}),Object(N.jsx)(te.EuiPage,{className:"mlCalendarList","data-test-subj":"mlPageCalendarManagement"},Object(N.jsx)(te.EuiPageBody,null,Object(N.jsx)(te.EuiPageContent,{className:"mlCalendarList__content",verticalPosition:"center",horizontalPosition:"center"},Object(N.jsx)(Rr,{totalCount:e.length,refreshCalendars:this.loadCalendars}),Object(N.jsx)(Pr,{loading:a,calendarsList:this.addRequiredFieldsToList(e),onDeleteClick:this.showDestroyModal,canCreateCalendar:s,canDeleteCalendar:r,mlNodesAvailable:i,setSelectedCalendarList:this.setSelectedCalendarList,itemsSelected:t.length>0})),o)),Object(N.jsx)(dr.a,{docLink:l}))}}const Nr=Object(c.withKibana)(calendars_list_CalendarsListUI),zr=(e,t)=>({path:"/settings/calendars_list",render:(e,t)=>Object(N.jsx)(Br,v()({},e,{deps:t})),breadcrumbs:[P("ML_BREADCRUMB",e,t),P("SETTINGS_BREADCRUMB",e,t),P("CALENDAR_MANAGEMENT_BREADCRUMB",e,t)]}),Br=({deps:e})=>{const{redirectToMlAccessDeniedPage:t}=e,{context:a}=F(void 0,void 0,e.config,{checkFullLicense:u.b,checkGetJobsCapabilities:()=>Object(I.c)(t),getMlNodeCount:$.c});Object(f.g)({timeRangeSelector:!1,autoRefreshSelector:!1});const i=Object(I.e)("canCreateCalendar"),n=Object(I.e)("canDeleteCalendar");return Object(N.jsx)(Vb,{context:a},Object(N.jsx)(Nr,{canCreateCalendar:i,canDeleteCalendar:n}))};var Jr;!function(e){e[e.NEW=0]="NEW",e[e.EDIT=1]="EDIT"}(Jr||(Jr={}));const Vr=(e,t)=>({path:"/settings/calendars_list/new_calendar",render:(e,t)=>Object(N.jsx)(Gr,v()({},e,{deps:t,mode:Jr.NEW})),breadcrumbs:[P("ML_BREADCRUMB",e,t),P("SETTINGS_BREADCRUMB",e,t),P("CALENDAR_MANAGEMENT_BREADCRUMB",e,t),{text:y.i18n.translate("xpack.ml.settings.breadcrumbs.calendarManagement.createLabel",{defaultMessage:"Create"}),onClick:R("/settings/calendars_list/new_calendar",e)}]}),Ur=(e,t)=>({path:"/settings/calendars_list/edit_calendar/:calendarId",render:(e,t)=>Object(N.jsx)(Gr,v()({},e,{deps:t,mode:Jr.EDIT})),breadcrumbs:[P("ML_BREADCRUMB",e,t),P("SETTINGS_BREADCRUMB",e,t),P("CALENDAR_MANAGEMENT_BREADCRUMB",e,t),{text:y.i18n.translate("xpack.ml.settings.breadcrumbs.calendarManagement.editLabel",{defaultMessage:"Edit"}),onClick:R("/settings/calendars_list/edit_calendar",e)}]}),Gr=({location:e,mode:t,deps:a})=>{let i;if(t===Jr.EDIT){const t=e.pathname.match(/.+\/(.+)$/);i=t&&t.length>1?t[1]:void 0}const{redirectToMlAccessDeniedPage:n}=a,s=Object(C.a)(T.b.ANOMALY_DETECTION_JOBS_MANAGE),{context:r}=F(void 0,void 0,a.config,{checkFullLicense:u.b,checkGetJobsCapabilities:()=>Object(I.c)(n),checkMlNodesAvailable:()=>Object($.a)(s)});Object(f.g)({timeRangeSelector:!1,autoRefreshSelector:!1});const o=Object(I.e)("canCreateCalendar"),l=Object(I.e)("canDeleteCalendar");return Object(N.jsx)(Vb,{context:r},Object(N.jsx)(Lr,{calendarId:i,canCreateCalendar:o,canDeleteCalendar:l}))};class edit_description_popover_EditDescriptionPopover extends n.Component{constructor(e){super(e),Ce()(this,"onChange",(e=>{this.setState({value:e.target.value})})),Ce()(this,"onButtonClick",(()=>{!1===this.state.isPopoverOpen?this.setState({isPopoverOpen:!this.state.isPopoverOpen,value:this.props.description}):this.closePopover()})),Ce()(this,"closePopover",(()=>{!0===this.state.isPopoverOpen&&(this.setState({isPopoverOpen:!1}),this.props.updateDescription(this.state.value))})),this.state={isPopoverOpen:!1,value:e.description}}render(){const{isPopoverOpen:e,value:t}=this.state,a=Object(N.jsx)(te.EuiButtonIcon,{size:"s",color:"primary",onClick:this.onButtonClick,iconType:"pencil","aria-label":y.i18n.translate("xpack.ml.settings.filterLists.editDescriptionPopover.editDescriptionAriaLabel",{defaultMessage:"Edit description"}),isDisabled:!1===this.props.canCreateFilter,"data-test-subj":"mlFilterListEditDescriptionButton"});return Object(N.jsx)("div",null,Object(N.jsx)(te.EuiPopover,{id:"filter_list_description_popover",ownFocus:!0,button:a,isOpen:e,closePopover:this.closePopover},Object(N.jsx)("div",{style:{width:"300px"}},Object(N.jsx)(te.EuiForm,null,Object(N.jsx)(te.EuiFormRow,{label:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.settings.filterLists.editDescriptionPopover.filterListDescriptionAriaLabel",defaultMessage:"Filter list description"})},Object(N.jsx)(te.EuiFieldText,{name:"filter_list_description",value:t,onChange:this.onChange,"data-test-subj":"mlFilterListDescriptionInput"}))))))}}Ce()(edit_description_popover_EditDescriptionPopover,"displayName","EditDescriptionPopover");class filter_list_usage_popover_FilterListUsagePopover extends n.Component{constructor(e){super(e),Ce()(this,"onButtonClick",(()=>{this.setState({isPopoverOpen:!this.state.isPopoverOpen})})),Ce()(this,"closePopover",(()=>{this.setState({isPopoverOpen:!1})})),this.state={isPopoverOpen:!1}}render(){const{entityType:e,entityValues:t}=this.props,a=`${t.length} ${e}${1!==t.length?"s":""}`,i=t.map((e=>Object(N.jsx)("li",{key:e},e))),n=Object(N.jsx)(te.EuiButtonEmpty,{size:"s",color:"primary",onClick:this.onButtonClick},a);return Object(N.jsx)("div",null,Object(N.jsx)(te.EuiPopover,{id:`${e}_filter_list_usage`,panelClassName:"ml-filter-list-usage-popover",ownFocus:!0,button:n,isOpen:this.state.isPopoverOpen,closePopover:this.closePopover},Object(N.jsx)("ul",null,i)))}}const qr=({canCreateFilter:e,filterId:t,totalItemCount:a,description:i,updateDescription:n,newFilterId:r,isNewFilterIdInvalid:o,updateNewFilterId:l,usedBy:c})=>{const d=void 0!==t?Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.settings.filterLists.editFilterHeader.filterListTitle",defaultMessage:"Filter list {filterId}",values:{filterId:t}}):Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.settings.filterLists.editFilterHeader.createFilterListTitle",defaultMessage:"Create new filter list"});let u,p,m;if(void 0===t){const e=y.i18n.translate("xpack.ml.settings.filterLists.editFilterHeader.allowedCharactersDescription",{defaultMessage:"Use lowercase alphanumerics (a-z and 0-9), hyphens or underscores; must start and end with an alphanumeric character"}),t=!1===o?e:void 0,a=!0===o?[e]:void 0;u=Object(N.jsx)(te.EuiFormRow,{label:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.settings.filterLists.editFilterHeader.filterListIdAriaLabel",defaultMessage:"Filter list ID"}),helpText:t,error:a,isInvalid:o},Object(N.jsx)(te.EuiFieldText,{name:"new_filter_id",value:r,isInvalid:o,onChange:e=>l(e.target.value),"data-test-subj":"mlNewFilterListIdInput"}))}return p=void 0!==i&&i.length>0?Object(N.jsx)(te.EuiText,{"data-test-subj":"mlNewFilterListDescriptionText"},Object(N.jsx)("p",null,i)):Object(N.jsx)(te.EuiText,null,Object(N.jsx)(te.EuiTextColor,{color:"subdued"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.settings.filterLists.editFilterList.addDescriptionText",defaultMessage:"Add a description"}))),void 0!==t&&(m=void 0!==c&&c.jobs.length>0?Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)("div",{className:"ml-filter-list-usage"},Object(N.jsx)(te.EuiText,null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.settings.filterLists.editFilterList.filterIsUsedInJobsDescription",defaultMessage:"This filter list is used in"})),Object(N.jsx)(filter_list_usage_popover_FilterListUsagePopover,{entityType:"detector",entityValues:c.detectors}),Object(N.jsx)(te.EuiText,null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.settings.filterLists.editFilterList.acrossText",defaultMessage:"across"})),Object(N.jsx)(filter_list_usage_popover_FilterListUsagePopover,{entityType:"job",entityValues:c.jobs})),Object(N.jsx)(te.EuiSpacer,{size:"s"})):Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(te.EuiText,null,Object(N.jsx)("p",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.settings.filterLists.editFilterList.filterIsNotUsedInJobsDescription",defaultMessage:"This filter list is not used by any jobs."}))),Object(N.jsx)(te.EuiSpacer,{size:"s"}))),Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(te.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"baseline"},Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiFlexGroup,{alignItems:"baseline",gutterSize:"m",responsive:!1},Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiTitle,null,Object(N.jsx)("h1",null,d))),Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiTextColor,{color:"subdued"},Object(N.jsx)("p",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.settings.filterLists.editFilterList.totalItemsDescription",defaultMessage:"{totalItemCount, plural, one {# item} other {# items}} in total",values:{totalItemCount:a}}))))))),Object(N.jsx)(te.EuiSpacer,{size:"m"}),u,Object(N.jsx)(te.EuiFlexGroup,{alignItems:"baseline",gutterSize:"s",responsive:!1},Object(N.jsx)(te.EuiFlexItem,{grow:!1},p),Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(edit_description_popover_EditDescriptionPopover,{canCreateFilter:e,description:i,updateDescription:n}))),Object(N.jsx)(te.EuiSpacer,{size:"s"}),m)};qr.displayName="EditFilterListHeader";class add_item_popover_AddItemPopover extends n.Component{constructor(e){super(e),Ce()(this,"onItemsTextChange",(e=>{this.setState({itemsText:e.target.value})})),Ce()(this,"onButtonClick",(()=>{this.setState({isPopoverOpen:!this.state.isPopoverOpen})})),Ce()(this,"closePopover",(()=>{this.setState({isPopoverOpen:!1})})),Ce()(this,"onAddButtonClick",(()=>{const e=this.state.itemsText.split("\n"),t=[];e.forEach((e=>{-1===t.indexOf(e)&&e.length>0&&t.push(e)})),this.props.addItems(t),this.setState({isPopoverOpen:!1,itemsText:""})})),this.state={isPopoverOpen:!1,itemsText:""}}render(){const e=Object(N.jsx)(te.EuiButton,{size:"s",color:"primary",iconType:"arrowDown",iconSide:"right",onClick:this.onButtonClick,isDisabled:!1===this.props.canCreateFilter,"data-test-subj":"mlFilterListOpenNewItemsPopoverButton"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.settings.filterLists.addItemPopover.addItemButtonLabel",defaultMessage:"Add item"}));return Object(N.jsx)("div",null,Object(N.jsx)(te.EuiPopover,{id:"add_item_popover",panelClassName:"ml-add-filter-item-popover",ownFocus:!0,button:e,isOpen:this.state.isPopoverOpen,closePopover:this.closePopover},Object(N.jsx)(te.EuiForm,null,Object(N.jsx)(te.EuiFormRow,{label:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.settings.filterLists.addItemPopover.itemsLabel",defaultMessage:"Items"})},Object(N.jsx)(te.EuiTextArea,{value:this.state.itemsText,onChange:this.onItemsTextChange,"data-test-subj":"mlFilterListAddItemTextArea"}))),Object(N.jsx)(te.EuiText,{size:"xs"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.settings.filterLists.addItemPopover.enterItemPerLineDescription",defaultMessage:"Enter one item per line"})),Object(N.jsx)(te.EuiSpacer,{size:"s"}),Object(N.jsx)(te.EuiFlexGroup,{justifyContent:"flexEnd"},Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiButton,{onClick:this.onAddButtonClick,disabled:0===this.state.itemsText.length,"data-test-subj":"mlFilterListAddItemsButton"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.settings.filterLists.addItemPopover.addButtonLabel",defaultMessage:"Add"}))))))}}function Hr({canCreateFilter:e,canDeleteFilter:t,onSearchChange:a,addItems:i,deleteSelectedItems:n,selectedItemCount:r}){const o=function(e,t,a,i,n){return[Object(N.jsx)(add_item_popover_AddItemPopover,{addItems:a,canCreateFilter:e,key:"add_item_btn"}),Object(N.jsx)(te.EuiButton,{color:"danger",size:"s",disabled:0===n||!1===t,onClick:i,key:"delete_item_btn","data-test-subj":"mlFilterListDeleteItemButton"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.settings.filterLists.toolbar.deleteItemButtonLabel",defaultMessage:"Delete item"}))]}(e,t,i,n,r);return Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(te.EuiFlexGroup,{alignItems:"center",gutterSize:"xl"},Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(te.EuiSearchBar,{toolsRight:o,onChange:a,filters:[]}))))}function Wr(e,t){return e===t?"check":"empty"}Ce()(add_item_popover_AddItemPopover,"displayName","AddItemPopover");class items_grid_pagination_ItemsGridPagination extends n.Component{constructor(e){super(e),Ce()(this,"onButtonClick",(()=>{this.setState({isPopoverOpen:!this.state.isPopoverOpen})})),Ce()(this,"closePopover",(()=>{this.setState({isPopoverOpen:!1})})),Ce()(this,"onPageClick",(e=>{this.props.setActivePage(e)})),Ce()(this,"onChangeItemsPerPage",(e=>{this.closePopover(),this.props.setItemsPerPage(e)})),this.state={isPopoverOpen:!1}}render(){const{itemCount:e,itemsPerPage:t,itemsPerPageOptions:a,activePage:i}=this.props,n=Object(N.jsx)(te.EuiButtonEmpty,{size:"s",color:"text",iconType:"arrowDown",iconSide:"right",onClick:this.onButtonClick},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.itemsGrid.itemsPerPageButtonLabel",defaultMessage:"Items per page: {itemsPerPage}",values:{itemsPerPage:t}})),s=Math.ceil(e/t),r=a.map((e=>Object(N.jsx)(te.EuiContextMenuItem,{key:`${e} items`,icon:Wr(e,t),onClick:()=>{this.onChangeItemsPerPage(e)}},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.itemsGrid.itemsCountLabel",defaultMessage:"{pageSize} items",values:{pageSize:e}}))));return Object(N.jsx)(te.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"center"},Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiPopover,{id:"customizablePagination",button:n,isOpen:this.state.isPopoverOpen,closePopover:this.closePopover,panelPaddingSize:"none"},Object(N.jsx)(te.EuiContextMenuPanel,{items:r,className:"ml-items-grid-page-size-menu"}))),Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiPagination,{pageCount:s,activePage:i,onPageClick:this.onPageClick})))}}function $r({numberColumns:e,totalItemCount:t,items:a,selectedItems:i,itemsPerPage:n,itemsPerPageOptions:s,setItemsPerPage:r,setItemSelected:o,activePage:l,setActivePage:c}){if(void 0===a||0===a.length)return Object(N.jsx)(te.EuiFlexGroup,{justifyContent:"spaceAround"},Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiText,null,Object(N.jsx)("h4",null,0===t?Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.itemsGrid.noItemsAddedTitle",defaultMessage:"No items have been added"}):Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.itemsGrid.noMatchingItemsTitle",defaultMessage:"No matching items"})))));const d=l*n,u=a.slice(d,d+n).map(((e,t)=>Object(N.jsx)(te.EuiFlexItem,{key:`ml_grid_item_${t}`,"data-test-subj":`mlGridItem ${e}`},Object(N.jsx)(te.EuiCheckbox,{id:`ml_grid_item_${t}`,label:e,checked:i.indexOf(e)>=0,onChange:t=>{o(e,t.target.checked)},"data-test-subj":"mlGridItemCheckbox"}))));return Object(N.jsx)("div",null,Object(N.jsx)(te.EuiFlexGrid,{columns:e,className:"eui-textBreakWord",gutterSize:"m"},u),Object(N.jsx)(items_grid_pagination_ItemsGridPagination,{itemCount:a.length,itemsPerPage:n,itemsPerPageOptions:s,setItemsPerPage:r,activePage:l,setActivePage:c}))}function Yr(e,t,a,i){return new Promise(((n,s)=>{void 0===i||void 0===i.filter_id?function(e,t,a){const i=y.i18n.translate("xpack.ml.settings.filterLists.filterWithIdExistsErrorMessage",{defaultMessage:"A filter with id {filterId} already exists",values:{filterId:e}});return new Promise(((n,s)=>{ge.ml.filters.filtersStats().then((r=>{if(-1===r.map((e=>e.filter_id)).indexOf(e))ge.ml.filters.addFilter(e,t,a).then((e=>{n(e)})).catch((e=>{s(e)}));else{Object(d.k)().addDanger(i),s(new Error(i))}})).catch((e=>{s(e)}))}))}(e,t,a).then((e=>{n(e)})).catch((e=>{s(e)})):function(e,t,a){return new Promise(((i,n)=>{const s=e.items,r=a.filter((e=>!1===s.includes(e))),o=s.filter((e=>!1===a.includes(e)));ge.ml.filters.updateFilter(e.filter_id,t,r,o).then((e=>{i(e)})).catch((e=>{n(e)}))}))}(i,t,a).then((e=>{n(e)})).catch((e=>{s(e)}))}))}$r.defaultProps={numberColumns:4,itemsPerPage:50,itemsPerPageOptions:[50,100,500,1e3]};function Xr(e,t){if(void 0===t)return[];if(void 0===e)return[...t];const a=t.map((e=>({value:e})));return te.EuiSearchBar.Query.execute(e,a,{defaultFields:["value"]}).map((e=>e.value))}function Qr(e,t,a){let i=e;return t*e>a&&(i=Math.max(Math.ceil(a/t)-1,0)),i}class edit_filter_list_EditFilterListUI extends n.Component{constructor(e){super(e),Ce()(this,"returnToFiltersList",(async()=>{const{services:{http:{basePath:e},application:{navigateToUrl:t}}}=this.props.kibana;await t(`${e.get()}/app/ml/${T.b.FILTER_LISTS_MANAGE}`,!0)})),Ce()(this,"loadFilterList",(e=>{ge.ml.filters.filters({filterId:e}).then((e=>{this.setLoadedFilterState(e)})).catch((t=>{console.log(`Error loading filter ${e}:`,t);const{toasts:a}=this.props.kibana.services.notifications;a.addDanger(y.i18n.translate("xpack.ml.settings.filterLists.editFilterList.loadingDetailsOfFilterErrorMessage",{defaultMessage:"An error occurred loading details of filter {filterId}",values:{filterId:e}}))}))})),Ce()(this,"setLoadedFilterState",(e=>{this.setState((t=>{const{itemsPerPage:a,searchQuery:i}=t,n=Xr(i,e.items),s=Qr(t.activePage,a,n.length);return{description:e.description,items:void 0!==e.items?[...e.items]:[],matchingItems:n,selectedItems:[],loadedFilter:e,isNewFilterIdInvalid:!1,activePage:s,searchQuery:i,saveInProgress:!1}}))})),Ce()(this,"updateNewFilterId",(e=>{var t;this.setState({newFilterId:e,isNewFilterIdInvalid:(t=e,!(void 0!==t&&t.length>0&&Object(Te.i)(t)))})})),Ce()(this,"updateDescription",(e=>{this.setState({description:e})})),Ce()(this,"addItems",(e=>{this.setState((t=>{const{itemsPerPage:a,searchQuery:i}=t,n=[...t.items],s=[];if(e.forEach((e=>{-1===n.indexOf(e)?n.push(e):s.push(e)})),n.sort(((e,t)=>e.localeCompare(t))),s.length>0){const{toasts:e}=this.props.kibana.services.notifications;e.addWarning(y.i18n.translate("xpack.ml.settings.filterLists.editFilterList.duplicatedItemsInFilterListWarningMessage",{defaultMessage:"The following items were already in the filter list: {alreadyInFilter}",values:{alreadyInFilter:s}}))}const r=Xr(i,n),o=Qr(t.activePage,a,r.length);return{items:n,matchingItems:r,activePage:o,searchQuery:i}}))})),Ce()(this,"deleteSelectedItems",(()=>{this.setState((e=>{const{selectedItems:t,itemsPerPage:a,searchQuery:i}=e,n=[...e.items];t.forEach((e=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}));const s=Xr(i,n),r=Qr(e.activePage,a,s.length);return{items:n,matchingItems:s,selectedItems:[],activePage:r,searchQuery:i}}))})),Ce()(this,"onSearchChange",(({query:e})=>{this.setState((t=>{const{items:a,itemsPerPage:i}=t,n=Xr(e,a);return{matchingItems:n,activePage:Qr(t.activePage,i,n.length),searchQuery:e}}))})),Ce()(this,"setItemSelected",((e,t)=>{this.setState((a=>{const i=[...a.selectedItems],n=i.indexOf(e);return!0===t&&-1===n?i.push(e):!1===t&&-1!==n&&i.splice(n,1),{selectedItems:i}}))})),Ce()(this,"setActivePage",(e=>{this.setState({activePage:e})})),Ce()(this,"setItemsPerPage",(e=>{this.setState({itemsPerPage:e,activePage:0})})),Ce()(this,"save",(()=>{this.setState({saveInProgress:!0});const{loadedFilter:e,newFilterId:t,description:a,items:i}=this.state,n=void 0!==this.props.filterId?this.props.filterId:t;Yr(n,a,i,e).then((e=>{this.setLoadedFilterState(e),this.returnToFiltersList()})).catch((e=>{console.log(`Error saving filter ${n}:`,e);const{toasts:t}=this.props.kibana.services.notifications;t.addDanger(y.i18n.translate("xpack.ml.settings.filterLists.editFilterList.savingFilterErrorMessage",{defaultMessage:"An error occurred saving filter {filterId}",values:{filterId:n}})),this.setState({saveInProgress:!1})}))})),this.state={description:"",items:[],matchingItems:[],selectedItems:[],loadedFilter:{},newFilterId:"",isNewFilterIdInvalid:!0,activePage:0,itemsPerPage:50,saveInProgress:!1}}componentDidMount(){const e=this.props.filterId;void 0!==e?this.loadFilterList(e):this.setState({newFilterId:""})}render(){const{loadedFilter:e,newFilterId:t,isNewFilterIdInvalid:a,description:i,items:s,matchingItems:r,selectedItems:o,itemsPerPage:l,activePage:c,saveInProgress:u}=this.state,{canCreateFilter:p,canDeleteFilter:m}=this.props,b=void 0!==s?s.length:0,h=Object(d.c)().links.ml.customRules;return Object(N.jsx)(n.Fragment,null,Object(N.jsx)(cr.a,{tabId:"settings"}),Object(N.jsx)(te.EuiPage,{className:"ml-edit-filter-lists","data-test-subj":"mlPageFilterListEdit"},Object(N.jsx)(te.EuiPageBody,null,Object(N.jsx)(te.EuiPageContent,{className:"ml-edit-filter-lists-content",verticalPosition:"center",horizontalPosition:"center"},Object(N.jsx)(qr,{canCreateFilter:p,filterId:this.props.filterId,newFilterId:t,isNewFilterIdInvalid:a,updateNewFilterId:this.updateNewFilterId,description:i,updateDescription:this.updateDescription,totalItemCount:b,usedBy:e.used_by}),Object(N.jsx)(Hr,{canCreateFilter:p,canDeleteFilter:m,onSearchChange:this.onSearchChange,addItems:this.addItems,deleteSelectedItems:this.deleteSelectedItems,selectedItemCount:o.length}),Object(N.jsx)(te.EuiSpacer,{size:"xl"}),Object(N.jsx)($r,{totalItemCount:b,items:r,selectedItems:o,itemsPerPage:l,setItemsPerPage:this.setItemsPerPage,setItemSelected:this.setItemSelected,activePage:c,setActivePage:this.setActivePage}),Object(N.jsx)(te.EuiFlexGroup,{justifyContent:"flexEnd"},Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiButtonEmpty,{"data-test-subj":"mlFilterListCancelButton",onClick:()=>this.returnToFiltersList()},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.settings.filterLists.editFilterList.cancelButtonLabel",defaultMessage:"Cancel"}))),Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiButton,{onClick:this.save,disabled:!0===u||!0===a||!1===p,fill:!0,"data-test-subj":"mlFilterListSaveButton"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.settings.filterLists.editFilterList.saveButtonLabel",defaultMessage:"Save"}))))))),Object(N.jsx)(dr.a,{docLink:h}))}}Ce()(edit_filter_list_EditFilterListUI,"displayName","EditFilterList");const Kr=Object(c.withKibana)(edit_filter_list_EditFilterListUI);const Zr=Object(c.withKibana)((function({totalCount:e,refreshFilterLists:t,kibana:a}){const i=a.services.docLinks.links.ml.customRules;return Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(te.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"baseline"},Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiFlexGroup,{alignItems:"baseline",gutterSize:"m",responsive:!1},Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiTitle,null,Object(N.jsx)("h1",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.settings.filterLists.listHeader.filterListsTitle",defaultMessage:"Filter Lists"})))),Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiTextColor,{color:"subdued"},Object(N.jsx)("p",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.settings.filterLists.listHeader.filterListsDescription",defaultMessage:"{totalCount} in total",values:{totalCount:e}})))))),Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiFlexGroup,{alignItems:"baseline",gutterSize:"m",responsive:!1},Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiButtonEmpty,{size:"s",iconType:"refresh",onClick:()=>t(),"data-test-subj":"mlFilterListRefreshButton"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.settings.filterLists.listHeader.refreshButtonLabel",defaultMessage:"Refresh"})))))),Object(N.jsx)(te.EuiSpacer,{size:"m"}),Object(N.jsx)(te.EuiText,null,Object(N.jsx)("p",null,Object(N.jsx)(te.EuiTextColor,{color:"subdued"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.settings.filterLists.listHeader.filterListsContainsNotAllowedValuesDescription",defaultMessage:"Filter lists contain values that you can use to include or exclude events from the machine learning analysis.\nYou can use the same filter list in multiple jobs.{br}{learnMoreLink}",values:{br:Object(N.jsx)("br",null),learnMoreLink:Object(N.jsx)(te.EuiLink,{href:i,target:"_blank"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.settings.filterLists.listHeader.filterListsContainsNotAllowedValuesDescription.learnMoreLinkText",defaultMessage:"Learn more"}))}})))),Object(N.jsx)(te.EuiSpacer,{size:"m"}))}));class delete_filter_list_modal_DeleteFilterListModal extends n.Component{constructor(e){super(e),Ce()(this,"closeModal",(()=>{this.setState({isModalVisible:!1})})),Ce()(this,"showModal",(()=>{this.setState({isModalVisible:!0})})),Ce()(this,"onConfirmDelete",(()=>{this.doDelete()})),this.state={isModalVisible:!1}}async doDelete(){const{selectedFilterLists:e,refreshFilterLists:t}=this.props;await async function(e){if(void 0===e||0===e.length)return;const t=Object(d.k)();t.add(y.i18n.translate("xpack.ml.settings.filterLists.deleteFilterLists.deletingNotificationMessage",{defaultMessage:"Deleting {filterListsToDeleteLength, plural, one {{filterListToDeleteId}} other {# filter lists}}",values:{filterListsToDeleteLength:e.length,filterListToDeleteId:!!e.length&&e[0].filter_id}}));for(const a of e){const e=a.filter_id;try{await ge.ml.filters.deleteFilter(e)}catch(e){console.log("Error deleting filter list:",e),t.addDanger(y.i18n.translate("xpack.ml.settings.filterLists.deleteFilterLists.deletingErrorMessage",{defaultMessage:"An error occurred deleting filter list {filterListId}{respMessage}",values:{filterListId:a.filter_id,respMessage:e.message?` : ${e.message}`:""}}))}}t.addSuccess(y.i18n.translate("xpack.ml.settings.filterLists.deleteFilterLists.filtersSuccessfullyDeletedNotificationMessage",{defaultMessage:"{filterListsToDeleteLength, plural, one {{filterListToDeleteId}} other {# filter lists}} deleted",values:{filterListsToDeleteLength:e.length,filterListToDeleteId:!!e.length&&e[0].filter_id}}))}(e),t(),this.closeModal()}render(){const{selectedFilterLists:e,canDeleteFilter:t}=this.props;let a;if(this.state.isModalVisible){const t=Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.settings.filterLists.deleteFilterListModal.modalTitle",defaultMessage:"Delete {selectedFilterListsLength, plural, one {{selectedFilterId}} other {# filter lists}}?",values:{selectedFilterListsLength:e.length,selectedFilterId:!!e.length&&e[0].filter_id}});a=Object(N.jsx)(te.EuiConfirmModal,{title:t,className:"eui-textBreakWord",onCancel:this.closeModal,onConfirm:this.onConfirmDelete,cancelButtonText:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.settings.filterLists.deleteFilterListModal.cancelButtonLabel",defaultMessage:"Cancel"}),confirmButtonText:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.settings.filterLists.deleteFilterListModal.confirmButtonLabel",defaultMessage:"Delete"}),buttonColor:"danger",defaultFocusedButton:te.EUI_MODAL_CONFIRM_BUTTON,"data-test-subj":"mlFilterListDeleteConfirmation"})}return Object(N.jsx)("div",null,Object(N.jsx)(te.EuiButton,{key:"delete_filter_list",iconType:"trash",color:"danger",onClick:this.showModal,isDisabled:void 0===e||0===e.length||!1===t,"data-test-subj":"mlFilterListsDeleteButton"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.settings.filterLists.deleteFilterListModal.deleteButtonLabel",defaultMessage:"Delete"})),a)}}function eo({usedBy:e}){let t;return t=void 0!==e&&e.jobs.length>0?Object(N.jsx)(te.EuiIcon,{type:"check","aria-label":y.i18n.translate("xpack.ml.settings.filterLists.table.inUseAriaLabel",{defaultMessage:"In use"}),"data-test-subj":"mlFilterListUsedByIcon inUse"}):Object(N.jsx)(te.EuiIcon,{type:"cross","aria-label":y.i18n.translate("xpack.ml.settings.filterLists.table.notInUseAriaLabel",{defaultMessage:"Not in use"}),"data-test-subj":"mlFilterListUsedByIcon notInUse"}),t}function to({canCreateFilter:e}){const t=Object(C.a)(T.b.FILTER_LISTS_NEW);return Object(N.jsx)(te.EuiButton,{key:"new_filter_list",onClick:t,isDisabled:!1===e,"data-test-subj":"mlFilterListsButtonCreate"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.settings.filterLists.table.newButtonLabel",defaultMessage:"New"}))}function ao(e,t,a,i){return[Object(N.jsx)(to,{key:"new_filter_list",canCreateFilter:e}),Object(N.jsx)(delete_filter_list_modal_DeleteFilterListModal,{canDeleteFilter:t,selectedFilterLists:a,refreshFilterLists:i})]}function io({canCreateFilter:e,canDeleteFilter:t,filterLists:a,selectedFilterLists:i,setSelectedFilterLists:n,refreshFilterLists:r}){const o={toolsRight:ao(e,t,i,r),box:{incremental:!0},filters:[]},l={selectable:e=>void 0===e.used_by||0===e.used_by.jobs.length,selectableMessage:()=>{},onSelectionChange:e=>n(e)};return Object(N.jsx)(s.a.Fragment,null,void 0===a||0===a.length?Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(te.EuiFlexGroup,{alignItems:"flexEnd",justifyContent:"flexEnd"},Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(to,null))),Object(N.jsx)(te.EuiSpacer,{size:"l"}),Object(N.jsx)(te.EuiFlexGroup,{justifyContent:"spaceAround"},Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiText,null,Object(N.jsx)("h4",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.settings.filterLists.table.noFiltersCreatedTitle",defaultMessage:"No filters have been created"})))))):Object(N.jsx)("div",{"data-test-subj":"mlFilterListTableContainer"},Object(N.jsx)(te.EuiInMemoryTable,{className:"ml-filter-lists-table",items:a,itemId:"filter_id",columns:[{field:"filter_id",name:y.i18n.translate("xpack.ml.settings.filterLists.table.idColumnName",{defaultMessage:"ID"}),render:e=>Object(N.jsx)(h.Link,{to:`/${T.b.FILTER_LISTS_EDIT}/${e}`,"data-test-subj":"mlEditFilterListLink"},e),sortable:!0,scope:"row","data-test-subj":"mlFilterListColumnId"},{field:"description",name:y.i18n.translate("xpack.ml.settings.filterLists.table.descriptionColumnName",{defaultMessage:"Description"}),sortable:!0,"data-test-subj":"mlFilterListColumnDescription"},{field:"item_count",name:y.i18n.translate("xpack.ml.settings.filterLists.table.itemCountColumnName",{defaultMessage:"Item count"}),sortable:!0,"data-test-subj":"mlFilterListColumnItemCount"},{field:"used_by",name:y.i18n.translate("xpack.ml.settings.filterLists.table.inUseColumnName",{defaultMessage:"In use"}),render:e=>Object(N.jsx)(eo,{usedBy:e}),sortable:!0,"data-test-subj":"mlFilterListColumnInUse"}],search:o,pagination:!0,sorting:{sort:{field:"filter_id",direction:"asc"}},selection:l,isSelectable:!0,"data-test-subj":"mlFilterListsTable",rowProps:e=>({"data-test-subj":`mlFilterListRow row-${e.filter_id}`})})))}Ce()(delete_filter_list_modal_DeleteFilterListModal,"displayName","DeleteFilterListModal"),eo.propTypes={usedBy:mn.a.object},eo.displayName="UsedByIcon";class filter_lists_FilterListsUI extends n.Component{constructor(e){super(e),Ce()(this,"setFilterLists",(e=>{this.setState((t=>{const a=e.map((e=>e.filter_id)),i=t.selectedFilterLists.filter((e=>-1!==a.indexOf(e.filter_id)));return{filterLists:e,selectedFilterLists:i}}))})),Ce()(this,"setSelectedFilterLists",(e=>{this.setState({selectedFilterLists:e})})),Ce()(this,"refreshFilterLists",(()=>{ge.ml.filters.filtersStats().then((e=>{this.setFilterLists(e)})).catch((e=>{console.log("Error loading list of filters:",e);const{toasts:t}=this.props.kibana.services.notifications;t.addDanger(y.i18n.translate("xpack.ml.settings.filterLists.filterLists.loadingFilterListsErrorMessage",{defaultMessage:"An error occurred loading the filter lists"}))}))})),this.state={filterLists:[],selectedFilterLists:[]}}componentDidMount(){this.refreshFilterLists()}render(){const{filterLists:e,selectedFilterLists:t}=this.state,{canCreateFilter:a,canDeleteFilter:i}=this.props,s=Object(d.c)().links.ml.customRules;return Object(N.jsx)(n.Fragment,null,Object(N.jsx)(cr.a,{tabId:"settings"}),Object(N.jsx)(te.EuiPage,{className:"ml-list-filter-lists","data-test-subj":"mlPageFilterListManagement"},Object(N.jsx)(te.EuiPageBody,null,Object(N.jsx)(te.EuiPageContent,{className:"ml-list-filter-lists-content",verticalPosition:"center",horizontalPosition:"center"},Object(N.jsx)(Zr,{totalCount:e.length,refreshFilterLists:this.refreshFilterLists}),Object(N.jsx)(io,{canCreateFilter:a,canDeleteFilter:i,filterLists:e,selectedFilterLists:t,setSelectedFilterLists:this.setSelectedFilterLists,refreshFilterLists:this.refreshFilterLists})))),Object(N.jsx)(dr.a,{docLink:s}))}}Ce()(filter_lists_FilterListsUI,"displayName","FilterLists");const no=Object(c.withKibana)(filter_lists_FilterListsUI),so=(e,t)=>({path:"/settings/filter_lists",render:(e,t)=>Object(N.jsx)(ro,v()({},e,{deps:t})),breadcrumbs:[P("ML_BREADCRUMB",e,t),P("SETTINGS_BREADCRUMB",e,t),P("FILTER_LISTS_BREADCRUMB",e,t)]}),ro=({deps:e})=>{const{redirectToMlAccessDeniedPage:t}=e,{context:a}=F(void 0,void 0,e.config,{checkFullLicense:u.b,checkGetJobsCapabilities:()=>Object(I.c)(t),getMlNodeCount:$.c});Object(f.g)({timeRangeSelector:!1,autoRefreshSelector:!1});const i=Object(I.e)("canCreateFilter"),n=Object(I.e)("canDeleteFilter");return Object(N.jsx)(Vb,{context:a},Object(N.jsx)(no,{canCreateFilter:i,canDeleteFilter:n}))};var oo;!function(e){e[e.NEW=0]="NEW",e[e.EDIT=1]="EDIT"}(oo||(oo={}));const lo=(e,t)=>({path:"/settings/filter_lists/new_filter_list",render:(e,t)=>Object(N.jsx)(uo,v()({},e,{mode:oo.NEW,deps:t})),breadcrumbs:[P("ML_BREADCRUMB",e,t),P("SETTINGS_BREADCRUMB",e,t),P("FILTER_LISTS_BREADCRUMB",e,t),{text:y.i18n.translate("xpack.ml.settings.breadcrumbs.filterLists.createLabel",{defaultMessage:"Create"}),onClick:R("/settings/filter_lists/new",e)}]}),co=(e,t)=>({path:"/settings/filter_lists/edit_filter_list/:filterId",render:(e,t)=>Object(N.jsx)(uo,v()({},e,{mode:oo.EDIT,deps:t})),breadcrumbs:[P("ML_BREADCRUMB",e,t),P("SETTINGS_BREADCRUMB",e,t),P("FILTER_LISTS_BREADCRUMB",e,t),{text:y.i18n.translate("xpack.ml.settings.breadcrumbs.filterLists.editLabel",{defaultMessage:"Edit"}),onClick:R("/settings/filter_lists/edit",e)}]}),uo=({location:e,mode:t,deps:a})=>{let i;if(t===oo.EDIT){const t=e.pathname.match(/.+\/(.+)$/);i=t&&t.length>1?t[1]:void 0}const{redirectToMlAccessDeniedPage:n}=a,s=Object(C.a)(T.b.ANOMALY_DETECTION_JOBS_MANAGE),{context:r}=F(void 0,void 0,a.config,{checkFullLicense:u.b,checkGetJobsCapabilities:()=>Object(I.c)(n),checkMlNodesAvailable:()=>Object($.a)(s)});Object(f.g)({timeRangeSelector:!1,autoRefreshSelector:!1});const o=Object(I.e)("canCreateFilter"),l=Object(I.e)("canDeleteFilter");return Object(N.jsx)(Vb,{context:r},Object(N.jsx)(Kr,{filterId:i,canCreateFilter:o,canDeleteFilter:l}))};var po=a(249);const mo=(e,t)=>({path:"/data_frame_analytics",render:(e,t)=>Object(N.jsx)(bo,v()({},e,{deps:t})),breadcrumbs:[P("ML_BREADCRUMB",e,t),P("DATA_FRAME_ANALYTICS_BREADCRUMB",e,t),{text:y.i18n.translate("xpack.ml.dataFrameAnalyticsBreadcrumbs.dataFrameListLabel",{defaultMessage:"Job Management"}),href:""}]}),bo=({location:e,deps:t})=>{const{context:a}=F(void 0,void 0,t.config,Y(t));return Object(N.jsx)(Vb,{context:a},Object(N.jsx)(po.a,null))};var ho=a(116),fo=a(105);const go=(e,t,a,i="")=>Object(n.useMemo)((()=>{const n=[];return void 0===e||void 0===t?n:(t.length>1?n.push(...t.filter((t=>e.fields.some((e=>e.name===t&&"number"===e.type))))):n.push(...e.fields.filter((t=>"number"===t.type&&!e.metaFields.includes(t.name)&&!t.name.startsWith(`${i}.`)&&t.name!==fo.e)).map((e=>e.name))),Array.isArray(a)&&a.length>0?n.filter((e=>!a.includes(e))):n)}),[e,t,a]);var jo=a(16),xo=a(18),vo=a(115);const yo=()=>Object(N.jsx)(te.EuiText,{textAlign:"center"},Object(N.jsx)(te.EuiSpacer,{size:"l"}),Object(N.jsx)(te.EuiLoadingSpinner,{size:"l"}),Object(N.jsx)(te.EuiSpacer,{size:"l"})),Oo=s.a.lazy((()=>a.e(16).then(a.bind(null,754)))),Eo=e=>Object(N.jsx)(te.EuiErrorBoundary,null,Object(N.jsx)(n.Suspense,{fallback:Object(N.jsx)(yo,null)},Object(N.jsx)(Oo,e)));var wo=a(200);const _o=Object(te.euiPaletteColorBlind)()[0],So=Object(te.euiPaletteNegative)(2)[1],Mo=Object(te.euiPaletteColorBlind)({rotations:2}),ko=Object(te.euiPalettePositive)(5);function Co(e){return e.replace(/([\.|\[|\]])/g,"\\$1")}const To=(e,t,a,i,n,s,r)=>{const o=e,l=t.map(Co),c=void 0!==i,d=`${i}\\.outlier_score`,u=((e,t,a,i)=>"string"==typeof t?{condition:{value:So,test:`(datum['${t}'] >= mlOutlierScoreThreshold.cutoff)`},value:e.euiColorMediumShade}:void 0!==a&&void 0!==i?{field:Co(a),type:i,scale:{range:i===wo.a.NOMINAL?Mo:ko}}:{value:_o})(a,i&&d,n,s);return{$schema:"https://vega.github.io/schema/vega-lite/v4.17.0.json",background:"transparent",view:{fill:"transparent",stroke:a.euiColorLightestShade},padding:10,config:{axis:{domainColor:a.euiColorLightShade,gridColor:a.euiColorLightestShade,tickColor:a.euiColorLightestShade,labelColor:a.euiTextSubduedColor,titleColor:a.euiTextSubduedColor},legend:{orient:"right",labelColor:a.euiTextSubduedColor,titleColor:a.euiTextSubduedColor}},repeat:{column:l,row:l.slice().reverse()},spec:{data:{values:[...o]},mark:{...c&&r?{type:"circle",strokeWidth:1.2,strokeOpacity:.75,fillOpacity:.1}:{type:"circle",opacity:.75,size:8}},encoding:{color:u,...r?{stroke:u,opacity:{condition:{value:1,test:`(datum['${d}'] >= mlOutlierScoreThreshold.cutoff)`},value:.5}}:{},...c?{order:{field:d},size:{...r?{type:wo.a.QUANTITATIVE,field:d,scale:{type:"linear",range:[8,200],domain:[0,1]}}:{condition:{value:40,test:`(datum['${d}'] >= mlOutlierScoreThreshold.cutoff)`},value:8}}}:{},x:{type:wo.a.QUANTITATIVE,field:{repeat:"column"},scale:{zero:!1}},y:{type:wo.a.QUANTITATIVE,field:{repeat:"row"},scale:{zero:!1}},tooltip:[...void 0!==n?[{type:u.type,field:Co(n)}]:[],...l.map((e=>({type:wo.a.QUANTITATIVE,field:e}))),...c?[{type:wo.a.QUANTITATIVE,field:d,format:".3f"}]:[]]},...c?{selection:{mlOutlierScoreThreshold:{type:"single",fields:["cutoff"],bind:{input:"range",max:1,min:0,name:y.i18n.translate("xpack.ml.splomSpec.outlierScoreThresholdName",{defaultMessage:"Outlier score threshold: "}),step:.01},init:{cutoff:.99}}}}:{},width:125,height:125}}};a(602);const Fo=y.i18n.translate("xpack.ml.splom.toggleOn",{defaultMessage:"On"}),Io=y.i18n.translate("xpack.ml.splom.toggleOff",{defaultMessage:"Off"}),Do=[100,1e3,1e4].map((e=>({value:e,text:""+e}))),Ao=({label:e,tooltip:t})=>Object(N.jsx)(s.a.Fragment,null,e,Object(N.jsx)(te.EuiIconTip,{content:t,iconProps:{className:"eui-alignTop"},size:"s"})),Lo=({fields:e,index:t,resultsField:a,color:i,legendType:r,searchQuery:o,runtimeMappings:l,indexPattern:c})=>{const{esSearch:d}=Object(f.a)(),[u,p]=Object(n.useState)(!1),[m,b]=Object(n.useState)([]);Object(n.useEffect)((()=>{const t=e.length>4?e.slice(0,4):e;b(t)}),[e]);const[h,g]=Object(n.useState)(1e3),[j,x]=Object(n.useState)(!1),[v,O]=Object(n.useState)(!1),[E,w]=Object(n.useState)(),_=Object(n.useMemo)((()=>e.map((e=>({label:e})))),[e]),{euiTheme:S}=Object(ho.e)();Object(n.useEffect)((()=>{if(0===m.length)return w({columns:[],items:[],messages:[]}),void O(!1);const e={didCancel:!1};return async function(e){O(!0);const n=[];try{const s=`${a}.outlier_score`,r=void 0!==a,u=[...m,...void 0!==i?[i]:[],...r?[s]:[]],p=j?{function_score:{query:o,random_score:{seed:10,field:"_seq_no"}}}:o,b=c&&Object(vo.b)(c,l),f=await d({index:t,body:{fields:u,_source:!1,query:p,from:0,size:h,...Object(xo.b)(b)?{runtime_mappings:b}:{}}});if(!e.didCancel){const e=f.hits.hits.map((e=>{var t;return Object(vo.h)(null!==(t=e.fields)&&void 0!==t?t:{},(e=>e.startsWith(`${a}.feature_importance`)))})).filter((e=>!Object.keys(e).some((t=>Array.isArray(e[t]))))),t=f.hits.hits.length,i=t-e.length;t===i?n.push(y.i18n.translate("xpack.ml.splom.allDocsFilteredWarningMessage",{defaultMessage:"All fetched documents included fields with arrays of values and cannot be visualized."})):f.hits.hits.length!==e.length&&n.push(y.i18n.translate("xpack.ml.splom.arrayFieldsWarningMessage",{defaultMessage:"{filteredDocsCount} out of {originalDocsCount} fetched documents include fields with arrays of values and cannot be visualized.",values:{originalDocsCount:t,filteredDocsCount:i}})),w({columns:m,items:e,messages:n}),O(!1)}}catch(e){O(!1),w({columns:[],items:[],messages:[Object(jo.extractErrorMessage)(e)]})}}(e),()=>{e.didCancel=!0}}),[h,JSON.stringify({fields:m,searchQuery:o}),t,j,a]);const M=Object(n.useMemo)((()=>{if(void 0===E)return;const{items:e,columns:t}=E;return To(e,t,S,a,i,r,u)}),[a,E,i,r,u]);return Object(N.jsx)(s.a.Fragment,null,void 0===E||void 0===M?Object(N.jsx)(yo,null):Object(N.jsx)("div",{"data-test-subj":"mlScatterplotMatrix "+(v?"loading":"loaded")},Object(N.jsx)(te.EuiFlexGroup,null,Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(te.EuiFormRow,{label:Object(N.jsx)(Ao,{label:y.i18n.translate("xpack.ml.splom.fieldSelectionLabel",{defaultMessage:"Fields"}),tooltip:y.i18n.translate("xpack.ml.splom.fieldSelectionInfoTooltip",{defaultMessage:"Pick fields to explore their relationships."})}),display:"rowCompressed",fullWidth:!0},Object(N.jsx)(te.EuiComboBox,{compressed:!0,fullWidth:!0,placeholder:y.i18n.translate("xpack.ml.splom.fieldSelectionPlaceholder",{defaultMessage:"Select fields"}),options:_,selectedOptions:m.map((e=>({label:e}))),onChange:e=>{b(e.map((e=>e.label)))},isClearable:!0,"data-test-subj":"mlScatterplotMatrixFieldsComboBox"}))),Object(N.jsx)(te.EuiFlexItem,{style:{width:"200px"},grow:!1},Object(N.jsx)(te.EuiFormRow,{label:Object(N.jsx)(Ao,{label:y.i18n.translate("xpack.ml.splom.sampleSizeLabel",{defaultMessage:"Sample size"}),tooltip:y.i18n.translate("xpack.ml.splom.sampleSizeInfoTooltip",{defaultMessage:"Amount of documents to display in the scatterplot matrix."})}),display:"rowCompressed",fullWidth:!0},Object(N.jsx)(te.EuiSelect,{"data-test-subj":"mlScatterplotMatrixSampleSizeSelect",compressed:!0,options:Do,value:h,onChange:e=>{g(Math.min(Math.max(parseInt(e.target.value,10),1),1e4))}}))),Object(N.jsx)(te.EuiFlexItem,{style:{width:"120px"},grow:!1},Object(N.jsx)(te.EuiFormRow,{label:Object(N.jsx)(Ao,{label:y.i18n.translate("xpack.ml.splom.randomScoringLabel",{defaultMessage:"Random scoring"}),tooltip:y.i18n.translate("xpack.ml.splom.randomScoringInfoTooltip",{defaultMessage:"Uses a function score query to get randomly selected documents as the sample."})}),display:"rowCompressed",fullWidth:!0},Object(N.jsx)(te.EuiSwitch,{"data-test-subj":"mlScatterplotMatrixRandomizeQuerySwitch",name:"mlScatterplotMatrixRandomizeQuery",label:j?Fo:Io,checked:j,onChange:()=>{x(!j)},disabled:v}))),void 0!==a&&void 0===r&&Object(N.jsx)(te.EuiFlexItem,{style:{width:"120px"},grow:!1},Object(N.jsx)(te.EuiFormRow,{label:Object(N.jsx)(Ao,{label:y.i18n.translate("xpack.ml.splom.dynamicSizeLabel",{defaultMessage:"Dynamic size"}),tooltip:y.i18n.translate("xpack.ml.splom.dynamicSizeInfoTooltip",{defaultMessage:"Scales the size of each point by its outlier score."})}),display:"rowCompressed",fullWidth:!0},Object(N.jsx)(te.EuiSwitch,{name:"mlScatterplotMatrixDynamicSize",label:u?Fo:Io,checked:u,onChange:()=>{p(!u)},disabled:v})))),E.messages.length>0&&Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(te.EuiSpacer,{size:"m"}),Object(N.jsx)(te.EuiCallOut,{color:"warning"},E.messages.map((e=>Object(N.jsx)("span",{key:Object(hn.d)(e)},e,Object(N.jsx)("br",null)))))),E.items.length>0&&Object(N.jsx)(Eo,{vegaSpec:M})))};var Ro=a(75),Po=a(140);a(329);function No(e){return{queryText:"",queryLanguage:S.c.KUERY,pageIndex:0,pageSize:25,analysis:!1,evaluation:!0,feature_importance:!0,results:!0,splom:!0,...Object(Qe.b)(e)?e:{}}}function zo(e){return Object(j.b)(T.b.DATA_FRAME_ANALYTICS_EXPLORATION,No(e))}const Bo="header_items_loading",Jo=({headerItems:e,content:t,isExpanded:a,contentPadding:i=!1,dataTestId:r,title:o,docsLink:l,urlStateKey:c})=>{const d=Object(n.useMemo)((()=>void 0!==a?{[c]:a}:void 0),[c,a]),[u,p]=zo(d),m=void 0!==a&&u[c]===No(d)[c]?a:u[c],b=Object(n.useCallback)((()=>{p({[c]:!m})}),[m,p,c]);return Object(N.jsx)(te.EuiPanel,{paddingSize:"none","data-test-subj":`mlDFExpandableSection-${r}`},Object(N.jsx)("div",{className:"mlExpandableSection"},Object(N.jsx)(te.EuiFlexGroup,{justifyContent:"spaceBetween",gutterSize:"none"},Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiButtonEmpty,{onClick:b,iconType:m?"arrowUp":"arrowDown",iconSide:"right",flush:"left","data-test-subj":`mlDFExpandableSection-${r}-toggle-button`},o)),void 0!==l&&Object(N.jsx)(te.EuiFlexItem,{grow:!1},l)),e===Bo&&Object(N.jsx)(te.EuiLoadingContent,{lines:1}),(h=e,Array.isArray(h)&&Object(N.jsx)(te.EuiFlexGroup,null,e.map((({label:e,value:t,id:a})=>Object(N.jsx)(te.EuiFlexItem,{grow:!1,key:a,"data-test-subj":`mlDFExpandableSectionItem-${r}-${a}`},void 0!==e&&void 0!==t&&Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(te.EuiFlexGroup,null,Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiText,{size:"xs",color:"subdued"},Object(N.jsx)("p",null,e)))),Object(N.jsx)(te.EuiFlexGroup,null,Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiBadge,null,t)))),void 0===e&&Object(N.jsx)(te.EuiText,{size:"xs",color:"subdued"},t))))))),m&&Object(N.jsx)("div",{className:i?"mlExpandableSection-contentPadding":"","data-test-subj":`mlDFExpandableSection-${r}-content`},t));var h};var Vo=a(153),Uo=a(94),Go=a(350);const qo=({jobId:e})=>{const[t,a]=Object(n.useState)();Object(n.useEffect)((()=>{(async()=>{const t=await ge.ml.dataFrameAnalytics.getDataFrameAnalytics(e),i=await ge.ml.dataFrameAnalytics.getDataFrameAnalyticsStats(e),n=t.data_frame_analytics[0],s=Object(Vo.b)(i)?i.data_frame_analytics[0]:void 0;if(void 0===s)return;const r={checkpointing:{},config:n,id:n.id,job_type:Object(Ro.h)(n.analysis),mode:Uo.a.BATCH,state:s.state,stats:s};a(r)})()}),[e]);const i=(e=>{if(void 0===e)return Bo;const t=Array.isArray(e.config.source.index)?e.config.source.index.join():e.config.source.index;return[{id:"analysisTypeLabel",label:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.dataframe.analytics.exploration.analysisTypeLabel",defaultMessage:"Type"}),value:e.job_type},{id:"analysisSourceIndexLabel",label:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.dataframe.analytics.exploration.analysisSourceIndexLabel",defaultMessage:"Source index"}),value:t},{id:"analysisDestinationIndexLabel",label:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.dataframe.analytics.exploration.analysisDestinationIndexLabel",defaultMessage:"Destination index"}),value:e.config.dest.index}]})(t),r=Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(te.EuiHorizontalRule,{size:"full",margin:"none"}),void 0===t&&Object(N.jsx)(te.EuiText,{textAlign:"center"},Object(N.jsx)(te.EuiSpacer,{size:"l"}),Object(N.jsx)(te.EuiLoadingSpinner,{size:"l"}),Object(N.jsx)(te.EuiSpacer,{size:"l"})),void 0!==t&&Object(N.jsx)(Go.a,{item:t}));return Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(Jo,{dataTestId:"analysis",content:r,headerItems:i,urlStateKey:"analysis",title:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.dataframe.analytics.exploration.analysisSectionTitle",defaultMessage:"Analysis"})}),Object(N.jsx)(te.EuiSpacer,{size:"m"}))};var Ho=a(96),Wo=a(12);const $o=({destIndex:e})=>{const{services:{http:{basePath:t}}}=Object(f.b)();return Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(te.EuiText,{size:"xs",color:"warning"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.dataframe.analytics.indexPatternPromptMessage",defaultMessage:"No index pattern exists for index {destIndex}. {linkToIndexPatternManagement} for {destIndex}.",values:{destIndex:e,linkToIndexPatternManagement:Object(N.jsx)(te.EuiLink,{href:`${t.get()}/app/management/kibana/indexPatterns/create`,target:"_blank"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.dataframe.analytics.indexPatternPromptLinkText",defaultMessage:"Create an index pattern"}))}})))},Yo=y.i18n.translate("xpack.ml.dataframe.analytics.explorationResults.documentsShownHelpText",{defaultMessage:"Showing documents for which predictions exist"}),Xo=y.i18n.translate("xpack.ml.dataframe.analytics.explorationResults.firstDocumentsShownHelpText",{defaultMessage:"Showing first {searchSize} documents for which predictions exist",values:{searchSize:Ro.f}}),Qo=({colorRange:e,indexData:t,indexPattern:a,jobConfig:i,needsDestIndexPattern:n,searchQuery:r})=>{const{columnsWithCharts:o,status:l,tableItems:c}=t,u=((e,t,a,i,n,s)=>e.length>0&&(a.length>0||t===Ro.b.LOADED)?[{id:"explorationTableTotalDocs",label:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.dataframe.analytics.exploration.explorationTableTotalDocsLabel",defaultMessage:"Total docs"}),value:`${n===Wo.a.GTE?">":""}${i}`},...void 0!==s?[{id:"colorRangeLegend",value:Object(N.jsx)(ho.c,{colorRange:s,title:y.i18n.translate("xpack.ml.dataframe.analytics.exploration.colorRangeLegendTitle",{defaultMessage:"Feature influence score"})})}]:[]]:Bo)(o,l,c,t.rowCount,t.rowCountRelation,e),p=i&&i.analysis?Object(Ro.h)(i.analysis):void 0,m=Object(N.jsx)(s.a.Fragment,null,void 0!==i&&n&&Object(N.jsx)("div",{className:"mlExpandableSection-contentPadding"},Object(N.jsx)($o,{destIndex:i.dest.index})),void 0!==i&&(Object(Ho.h)(i.analysis)||Object(Ho.f)(i.analysis))&&Object(N.jsx)(te.EuiText,{size:"xs",color:"subdued",className:"mlExpandableSection-contentPadding"},c.length===Ro.f?Xo:Yo),(o.length>0||r!==Ro.g)&&void 0!==a&&Object(N.jsx)(s.a.Fragment,null,o.length>0&&(c.length>0||l===Ro.b.LOADED)&&Object(N.jsx)(vo.a,v()({},t,{analysisType:p,dataTestSubj:"mlExplorationDataGrid",toastNotifications:Object(d.k)()}))));return Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(Jo,{urlStateKey:"results",dataTestId:"results",content:m,headerItems:u,title:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.dataframe.analytics.exploration.explorationTableTitle",defaultMessage:"Results"})}),Object(N.jsx)(te.EuiSpacer,{size:"m"}))},Ko=e=>{const t=Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(te.EuiHorizontalRule,{size:"full",margin:"none"}),Object(N.jsx)("div",{className:"mlExpandableSection-contentPadding"},Object(N.jsx)(Lo,e)));return Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(Jo,{dataTestId:"splom",urlStateKey:"splom",content:t,headerItems:undefined,isExpanded:!0,title:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.dataframe.analytics.exploration.splomSectionTitle",defaultMessage:"Scatterplot matrix"})}),Object(N.jsx)(te.EuiSpacer,{size:"m"}))};var Zo=a(97);const el=({indexPattern:e,setSearchQuery:t,filters:a,query:i})=>{const[s,r]=Object(n.useState)(i),[o,l]=Object(n.useState)({}),[c,d]=Object(n.useState)(void 0),u=Object(n.useMemo)((()=>new RegExp(`${null==a?void 0:a.columnId}\\s*:\\s*(true|false)`,"g")),[null==a?void 0:a.columnId]);Object(n.useEffect)((function(){if(void 0!==a){const e=i.query.match(u);let t;null!==e&&e[0].includes("true")?t=Object.keys(a.key).find((e=>!0===a.key[e])):null!==e&&e[0].includes("false")&&(t=Object.keys(a.key).find((e=>!1===a.key[e]))),t&&l({[t]:!0})}}),[]),Object(n.useEffect)((()=>{try{let a={};switch(i.language){case S.c.KUERY:a=Object(w.f)(Object(w.d)(i.query),e);break;case S.c.LUCENE:a=Object(w.e)(i.query);break;default:return void d({query:i.query,message:y.i18n.translate("xpack.ml.queryBar.queryLanguageNotSupported",{defaultMessage:"Query language is not supported"})})}t({queryString:i.query,query:a,language:i.language})}catch(e){d({query:i.query,message:e.message})}}),[i.query]);const p=(e,a)=>{void 0===a&&l({}),t({queryString:e.query,language:e.language})},m=Object(E.debounce)(((e,t)=>{let i="";const n=null==a?void 0:a.key[e],o=`${null==a?void 0:a.columnId}:${n}`;!1===t[e]?i=""!==s.query?Object(Zo.s)(s.query,null==a?void 0:a.columnId,String(n)):"":!0===t[e]&&(i=""===s.query?o:null!==s.query.match(u)?s.query.replace(u,o):`${s.query} and ${o}`);const l={...s,query:i};r(l),p(l,!0)}),200);return Object(N.jsx)(te.EuiInputPopover,{style:{maxWidth:"100%"},closePopover:()=>d(void 0),input:Object(N.jsx)(te.EuiFlexGroup,{alignItems:"center"},Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(_.QueryStringInput,{bubbleSubmitEvent:!1,query:s,indexPatterns:[e],onChange:e=>r(e),onSubmit:p,placeholder:s.language===S.c.KUERY?y.i18n.translate("xpack.ml.stepDefineForm.queryPlaceholderKql",{defaultMessage:"Search for e.g. {example}",values:{example:'method : "GET" or status : "404"'}}):y.i18n.translate("xpack.ml.stepDefineForm.queryPlaceholderLucene",{defaultMessage:"Search for e.g. {example}",values:{example:"method:GET OR status:404"}}),disableAutoFocus:!0,dataTestSubj:"mlDFAnalyticsQueryInput",languageSwitcherPopoverAnchorPosition:"rightDown"})),a&&a.options&&Object(N.jsx)(te.EuiFlexItem,{grow:!1,"data-test-subj":"mlDFAnalyticsExplorationQueryBarFilterButtons"},Object(N.jsx)(te.EuiButtonGroup,{legend:y.i18n.translate("xpack.ml.dataframe.analytics.explorationQueryBar.buttonGroupLegend",{defaultMessage:"Analytics query bar filter buttons"}),options:a.options,type:"multi",idToSelectedMap:o,onChange:e=>{const t={[e]:!o[e]};l(t),m(e,t)}}))),isOpen:(null==c?void 0:c.query)===s.query&&""!==(null==c?void 0:c.message)},Object(N.jsx)(te.EuiCode,null,y.i18n.translate("xpack.ml.stepDefineForm.invalidQuery",{defaultMessage:"Invalid Query"}),": ",null==c?void 0:c.message.split("\n")[0]))},tl=e=>`${e.dest.results_field}.${Po.c}`,al=(e,t=[])=>{if(0===t.length)return 0;const a=t[0];return Array.isArray(a[`${e}.${Po.b}`])?a[`${e}.${Po.b}`].length:0};var il=a(202);class data_loader_DataLoader{constructor(e,t){Ce()(this,"_indexPattern",void 0),Ce()(this,"_runtimeMappings",void 0),Ce()(this,"_indexPatternTitle",""),Ce()(this,"_maxExamples",10),this._indexPattern=e,this._runtimeMappings=this._indexPattern.getComputedFields().runtimeFields,this._indexPatternTitle=e.title}async loadFieldHistograms(e,t,a=il.a,i){return await ge.ml.getVisualizerFieldHistograms({indexPatternTitle:this._indexPatternTitle,query:t,fields:e,samplerShardSize:a,runtimeMappings:i||this._runtimeMappings})}set maxExamples(e){this._maxExamples=e}get maxExamples(){return this._maxExamples}isDisplayField(e){return!Ct.c.includes(e)}}var nl=a(82),sl=a(619),rl=a.n(sl),ol=a(93);const ll=(e,t=ol.b,a)=>{const[i,s]=zo(),r=Object(vo.k)(e,25,t,a);return r.pagination=Object(n.useMemo)((()=>({pageSize:i.pageSize,pageIndex:i.pageIndex})),[i.pageSize,i.pageIndex]),r.setPagination=Object(n.useCallback)((e=>{s({...e})}),[s]),r.onChangePage=Object(n.useCallback)((e=>{s({pageIndex:e})}),[s]),r.onChangeItemsPerPage=Object(n.useCallback)((e=>{s({pageSize:e})}),[s]),r.resetPagination=Object(n.useCallback)((()=>{const e=No();s({pageSize:e.pageSize,pageIndex:e.pageIndex})}),[s]),rl()((function(){r.resetPagination()}),[i.queryText]),r},cl=(e,t,a)=>{var i;const s=void 0!==e&&e.title===(null==t?void 0:t.source.index[0]),r=Object(n.useMemo)((()=>{const a=[];if(void 0!==t&&void 0!==e){const e=t.dest.results_field,{fieldTypes:i}=Object(Ro.m)(t,s);a.push(...Object(vo.e)(i,e).sort(((e,a)=>Object(fo.h)(e.id,a.id,t))))}return a}),[t,e]),o=ll(r,8,(e=>!e.includes(`.${Po.b}.`)&&e!==fo.d&&e!==fo.e));Object(n.useEffect)((()=>{void 0!==t&&o.setSortingColumns([{id:tl(t),direction:"desc"}])}),[t&&t.id]),Object(n.useEffect)((()=>{const e={didCancel:!1};return Object(Ro.l)(t,o,a,e),()=>{e.didCancel=!0}}),[t&&t.id,o.pagination,a,o.sortingColumns]);const l=Object(n.useMemo)((()=>void 0!==e?new data_loader_DataLoader(e,Object(d.k)()):void 0),[e]);Object(n.useEffect)((()=>{o.chartsVisible&&async function(){try{if(void 0!==t&&void 0!==l){const e=await l.loadFieldHistograms(r.filter((e=>o.visibleColumns.includes(e.id))).map((e=>({fieldName:e.id,type:Object(vo.f)(e.schema)}))),a);o.setColumnCharts(e)}}catch(e){Object(vo.j)(e,Object(d.k)())}}()}),[o.chartsVisible,null==t?void 0:t.dest.index,JSON.stringify([a,[...o.visibleColumns].sort()])]);const c=Object(ho.d)(ho.a.BLUE,ho.b.INFLUENCER,void 0!==t?al(t.dest.results_field,o.tableItems):1),u=Object(vo.l)(e,o.pagination,o.tableItems,null!==(i=null==t?void 0:t.dest.results_field)&&void 0!==i?i:nl.d,((e,a,i,n)=>{var s;let r;const o=i[`${null!==(s=null==t?void 0:t.dest.results_field)&&void 0!==s?s:""}.${Po.b}`];if(Array.isArray(o)){const t=o.find((t=>e===t.feature_name[0]));t&&(r=c(t.influence[0]))}void 0!==r&&n({style:{backgroundColor:String(r)}})}));return{...o,renderCellValue:u}},dl=s.a.memo((({jobId:e})=>{var t,a,i,r;const{indexPattern:o,indexPatternErrorMessage:l,jobConfig:c,needsDestIndexPattern:d}=Object(Ro.x)(e),[u,p]=zo(),[m,b]=Object(n.useState)(Ro.g),h=cl(o,c,m),f=Object(n.useCallback)((e=>{e.query&&b(e.query),e.queryString!==u.queryText&&p({queryText:e.queryString,queryLanguage:e.language})}),[u,p]),g={query:u.queryText,language:u.queryLanguage},{columnsWithCharts:j,tableItems:x}=h,v=al((null==c||null===(t=c.dest)||void 0===t?void 0:t.results_field)||"",x),O=Object(ho.d)(ho.a.BLUE,ho.b.INFLUENCER,v),E=v>0&&Object(Ro.r)(null==c?void 0:c.analysis)&&!0===(null==c?void 0:c.analysis.outlier_detection.compute_feature_influence),w=null!==(a=null==c?void 0:c.dest.results_field)&&void 0!==a?a:"",_=!d&&Object(Ro.r)(null==c?void 0:c.analysis)&&!0===(null==c?void 0:c.analysis.outlier_detection.compute_feature_influence)&&-1===j.findIndex((e=>e.id===`${w}.${Po.b}`)),S=go(o,null==c||null===(i=c.analyzed_fields)||void 0===i?void 0:i.includes,null==c||null===(r=c.analyzed_fields)||void 0===r?void 0:r.excludes,w);return void 0!==l?Object(N.jsx)(te.EuiPanel,{grow:!1},Object(N.jsx)(te.EuiCallOut,{title:y.i18n.translate("xpack.ml.dataframe.analytics.exploration.indexError",{defaultMessage:"An error occurred loading the index data."}),color:"danger",iconType:"cross"},Object(N.jsx)("p",null,l))):Object(N.jsx)(s.a.Fragment,null,void 0!==(null==c?void 0:c.description)&&Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(te.EuiText,null,null==c?void 0:c.description),Object(N.jsx)(te.EuiSpacer,{size:"m"})),(j.length>0||m!==Ro.g)&&void 0!==o&&Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(el,{indexPattern:o,setSearchQuery:f,query:g}),Object(N.jsx)(te.EuiSpacer,{size:"m"})),"string"==typeof(null==c?void 0:c.id)&&Object(N.jsx)(qo,{jobId:null==c?void 0:c.id}),"string"==typeof(null==c?void 0:c.id)&&S.length>1&&Object(N.jsx)(Ko,{fields:S,index:null==c?void 0:c.dest.index,resultsField:null==c?void 0:c.dest.results_field,searchQuery:m}),_&&Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(te.EuiCallOut,{size:"s",title:y.i18n.translate("xpack.ml.dataframe.analytics.outlierExploration.legacyFeatureInfluenceFormatCalloutTitle",{defaultMessage:"Color coded table cells based on feature influence are not available because the results index uses an unsupported legacy format. Please clone and rerun the job."}),iconType:"pin"}),Object(N.jsx)(te.EuiSpacer,{size:"m"})),Object(N.jsx)(Qo,{colorRange:E&&!_?O:void 0,indexData:h,indexPattern:o,jobConfig:c,needsDestIndexPattern:d,searchQuery:m}))}));var ul=a(70),pl=a(201);const ml=(e,t,a,i,s)=>{var r;const[o,l]=Object(n.useState)(),c=Object(pl.a)(),d=void 0!==e&&e.title===(null==t?void 0:t.source.index[0]),u=[];if(void 0!==t){const e=t.dest.results_field,{fieldTypes:a}=Object(Ro.m)(t,d);u.push(...Object(vo.e)(a,e).sort(((e,a)=>Object(fo.h)(e.id,a.id,t))))}const p=ll(u,8,(e=>!e.includes(`.${Po.a}.`)&&!e.includes(`.${Po.d}.`)&&e!==fo.d));Object(n.useEffect)((()=>{const e={didCancel:!1};return Object(Ro.l)(t,p,a,e),()=>{e.didCancel=!0}}),[t&&t.id,p.pagination,a,p.sortingColumns]);const m=Object(n.useMemo)((()=>void 0!==e?new data_loader_DataLoader(e,i):void 0),[e]);Object(n.useEffect)((()=>{p.chartsVisible&&async function(){try{if(void 0!==t&&void 0!==m){const e=await m.loadFieldHistograms(u.filter((e=>p.visibleColumns.includes(e.id))).map((e=>({fieldName:e.id,type:Object(vo.f)(e.schema)}))),a);p.setColumnCharts(e)}}catch(e){Object(vo.j)(e,i)}}()}),[p.chartsVisible,null==t?void 0:t.dest.index,JSON.stringify([a,p.visibleColumns])]);const b=Object(n.useMemo)((()=>{var e;if(t)return null!==(e=Object(Ho.e)(t.analysis))&&void 0!==e?e:Object(Ho.b)(t.analysis)}),[t]),h=Object(n.useCallback)((async()=>{try{if(void 0!==t&&void 0!==t.analysis&&(Object(ul.y)(t.analysis)||Object(Ho.f)(t.analysis))){var e;const i=t.id,n=(await c.getTrainedModels(`${i}*`,{include:"feature_importance_baseline"})).find((e=>{var t,a;return(null===(t=e.metadata)||void 0===t||null===(a=t.analytics_config)||void 0===a?void 0:a.id)===i}));var a;if(void 0!==(null==n||null===(e=n.metadata)||void 0===e?void 0:e.feature_importance_baseline))l(null==n||null===(a=n.metadata)||void 0===a?void 0:a.feature_importance_baseline)}}catch(e){const t=Object(ze.b)(e);i.addDanger({title:y.i18n.translate("xpack.ml.dataframe.analytics.explorationResults.baselineErrorMessageToast",{defaultMessage:"An error occurred getting feature importance baseline"}),text:t})}}),[s,t]);Object(n.useEffect)((()=>{h()}),[t]);const f=null!==(r=null==t?void 0:t.dest.results_field)&&void 0!==r?r:nl.d,g=Object(vo.l)(e,p.pagination,p.tableItems,f);return{...p,renderCellValue:g,baseline:o,predictionFieldName:b,resultsField:f}},bl=s.a.memo((({indexPattern:e,jobConfig:t,needsDestIndexPattern:a,searchQuery:i})=>{const{services:{mlServices:{mlApiServices:n}}}=Object(f.b)(),s=ml(e,t,i,Object(d.k)(),n);return void 0===t||void 0===s?null:Object(N.jsx)("div",{"data-test-subj":"mlDFAnalyticsExplorationTablePanel"},Object(N.jsx)(Qo,{indexData:s,indexPattern:e,jobConfig:t,needsDestIndexPattern:a,searchQuery:i}))})),hl=y.i18n.translate("xpack.ml.dataframe.analytics.jobConfig.errorTitle",{defaultMessage:"Unable to fetch results. An error occurred loading the job configuration data."}),fl=y.i18n.translate("xpack.ml.dataframe.analytics.jobCaps.errorTitle",{defaultMessage:"Unable to fetch results. An error occurred loading the index's field data."}),gl=({jobCapsServiceErrorMessage:e,jobConfigErrorMessage:t,title:a})=>{const{services:{application:{getUrlForApp:i}}}=Object(f.b)(),s="string"==typeof e&&e.includes("locate that index-pattern")&&e.includes("click here to re-create"),r=Object(N.jsx)("p",null,t||e),o=Object(n.useMemo)((()=>i("management",{path:"kibana/indexPatterns"})),[]),l=s?Object(N.jsx)(te.EuiLink,{href:o,target:"_blank"},r):r;return Object(N.jsx)(te.EuiPanel,{grow:!1},Object(N.jsx)(te.EuiSpacer,null),Object(N.jsx)(te.EuiCallOut,{title:t?hl:fl,color:"danger",iconType:"cross"},l))},jl=()=>Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(te.EuiPanel,{className:"eui-textCenter"},Object(N.jsx)(te.EuiLoadingSpinner,{size:"xl"})),Object(N.jsx)(te.EuiSpacer,{size:"m"}));function xl(e){return{options:[{id:"training",label:y.i18n.translate("xpack.ml.dataframe.analytics.explorationResults.trainingSubsetLabel",{defaultMessage:"Training"})},{id:"testing",label:y.i18n.translate("xpack.ml.dataframe.analytics.explorationResults.testingSubsetLabel",{defaultMessage:"Testing"})}],columnId:`${e}.is_training`,key:{training:!0,testing:!1}}}const vl=({jobId:e,title:t,EvaluatePanel:a,FeatureImportanceSummaryPanel:i})=>{var r,o,l;const{indexPattern:c,indexPatternErrorMessage:d,isInitialized:u,isLoadingJobConfig:p,jobCapsServiceErrorMessage:m,jobConfig:b,jobConfigErrorMessage:h,jobStatus:f,needsDestIndexPattern:g,totalFeatureImportance:j}=Object(Ro.x)(e),[x,v]=zo(),[O,E]=Object(n.useState)(Ro.g),w=Object(n.useCallback)((e=>{e.query&&E(e.query),e.queryString!==x.queryText&&v({queryText:e.queryString,queryLanguage:e.language})}),[x,v]),_={query:x.queryText,language:x.queryLanguage},S=null!==(r=null==b?void 0:b.dest.results_field)&&void 0!==r?r:"",M=go(c,null==b||null===(o=b.analyzed_fields)||void 0===o?void 0:o.includes,null==b||null===(l=b.analyzed_fields)||void 0===l?void 0:l.excludes,S);if(void 0!==d)return Object(N.jsx)(te.EuiPanel,{grow:!1},Object(N.jsx)(te.EuiCallOut,{title:y.i18n.translate("xpack.ml.dataframe.analytics.exploration.indexError",{defaultMessage:"An error occurred loading the index data."}),color:"danger",iconType:"cross"},Object(N.jsx)("p",null,d)));if(void 0!==h||void 0!==m)return Object(N.jsx)(gl,{jobCapsServiceErrorMessage:m,jobConfigErrorMessage:h,title:t});const k=b&&b.analysis?Object(Ho.a)(null==b?void 0:b.analysis):void 0;return Object(N.jsx)(s.a.Fragment,null,void 0!==(null==b?void 0:b.description)&&Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(te.EuiText,null,null==b?void 0:b.description),Object(N.jsx)(te.EuiSpacer,{size:"m"})),void 0!==c&&b&&Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(te.EuiFlexGroup,{direction:"column"},Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiSpacer,{size:"s"}),Object(N.jsx)(te.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(el,{indexPattern:c,setSearchQuery:w,query:_,filters:xl(b.dest.results_field)}))))),Object(N.jsx)(te.EuiSpacer,{size:"m"})),!0===p&&void 0===b&&Object(N.jsx)(jl,null),!1===p&&void 0!==b&&!0===u&&Object(N.jsx)(qo,{jobId:b.id}),!0===p&&void 0===b&&Object(N.jsx)(jl,null),!1===p&&void 0!==b&&!0===u&&Object(N.jsx)(a,{jobConfig:b,jobStatus:f,searchQuery:O}),!0===p&&void 0!==b&&void 0===j&&Object(N.jsx)(jl,null),!1===p&&void 0!==b&&void 0!==j&&Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(i,{totalFeatureImportance:j,jobConfig:b})),Object(N.jsx)(te.EuiSpacer,{size:"m"}),!0===p&&void 0===b&&Object(N.jsx)(jl,null),!1===p&&void 0!==b&&!0===u&&"string"==typeof(null==b?void 0:b.id)&&M.length>1&&void 0!==(null==b?void 0:b.analysis)&&Object(N.jsx)(Ko,{fields:M,index:null==b?void 0:b.dest.index,color:k===ul.b.REGRESSION||k===ul.b.CLASSIFICATION?Object(Ho.c)(b.analysis):void 0,legendType:Object(Ro.p)(k),searchQuery:O}),!0===p&&void 0===b&&Object(N.jsx)(jl,null),!1===p&&void 0!==b&&void 0!==c&&!0===u&&Object(N.jsx)(bl,{indexPattern:c,jobConfig:b,jobStatus:f,needsDestIndexPattern:g,searchQuery:O}))},yl={[ul.h.MSE]:y.i18n.translate("xpack.ml.dataframe.analytics.regressionExploration.meanSquaredErrorText",{defaultMessage:"Mean squared error"}),[ul.h.MSLE]:y.i18n.translate("xpack.ml.dataframe.analytics.regressionExploration.msleText",{defaultMessage:"Mean squared logarithmic error"}),[ul.h.R_SQUARED]:y.i18n.translate("xpack.ml.dataframe.analytics.regressionExploration.rSquaredText",{defaultMessage:"R squared"}),[ul.h.HUBER]:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.dataframe.analytics.regressionExploration.huberText",defaultMessage:"{wikiLink}",values:{wikiLink:Object(N.jsx)(te.EuiLink,{href:"https://en.wikipedia.org/wiki/Huber_loss#Pseudo-Huber_loss_function",target:"_blank",external:!0},y.i18n.translate("xpack.ml.dataframe.analytics.regressionExploration.huberLinkText",{defaultMessage:"Pseudo Huber loss function"}))}})},Ol={[ul.h.MSE]:y.i18n.translate("xpack.ml.dataframe.analytics.regressionExploration.meanSquaredErrorTooltipContent",{defaultMessage:"Measures how well the regression analysis model is performing. Mean squared sum of the difference between true and predicted values."}),[ul.h.MSLE]:y.i18n.translate("xpack.ml.dataframe.analytics.regressionExploration.msleTooltipContent",{defaultMessage:"Average squared difference between the logarithm of the predicted values and the logarithm of the actual (ground truth) value"}),[ul.h.R_SQUARED]:y.i18n.translate("xpack.ml.dataframe.analytics.regressionExploration.rSquaredTooltipContent",{defaultMessage:"Represents the goodness of fit. Measures how well the observed outcomes are replicated by the model."})},El=({isLoading:e,statType:t,title:a,dataTestSubj:i})=>Object(N.jsx)(te.EuiFlexGroup,{gutterSize:"xs","data-test-subj":i},Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiStat,{reverse:!0,isLoading:e,title:a,description:yl[t],titleSize:"xxs"})),Object(N.jsx)(te.EuiFlexItem,{grow:!1},t!==ul.h.HUBER&&Object(N.jsx)(te.EuiIconTip,{anchorClassName:"mlDataFrameAnalyticsRegression__evaluateStat",content:Ol[t]}))),wl={mse:ul.c,msle:ul.c,huber:ul.c,rSquared:ul.c},_l={...wl,error:null},Sl=({jobConfig:e,jobStatus:t,searchQuery:a})=>{const{services:{docLinks:i}}=Object(f.b)(),r=i.links.ml.regressionEvaluation,[o,l]=Object(n.useState)(_l),[c,d]=Object(n.useState)(_l),[u,p]=Object(n.useState)(!1),[m,b]=Object(n.useState)(!1),[h,g]=Object(n.useState)(void 0),[j,x]=Object(n.useState)(null),[v,O]=Object(n.useState)(null),E=e.dest.index,w=Object(Ro.k)(e.analysis),_=Object(Ro.o)(e.analysis),S=e.dest.results_field,M=async()=>{(async(e=!0)=>{b(!0);const t=await Object(Ro.t)({isTraining:!1,index:E,dependentVariable:w,resultsField:S,predictionFieldName:_,searchQuery:a,ignoreDefaultQuery:e,jobType:ul.b.REGRESSION});if(!0===t.success&&t.eval&&Object(ul.z)(t.eval)){const{mse:e,msle:a,huber:i,r_squared:n}=Object(Ro.q)(t.eval);d({mse:e,msle:a,huber:i,rSquared:n,error:null}),b(!1)}else b(!1),d({...wl,error:t.error})})(!1);const t=await Object(Ro.s)({ignoreDefaultQuery:!1,isTraining:!1,searchQuery:a,resultsField:S,destIndex:e.dest.index});!0===t.success?O(t.docsCount):O(null),(async(e=!0)=>{p(!0);const t=await Object(Ro.t)({isTraining:!0,index:E,dependentVariable:w,resultsField:S,predictionFieldName:_,searchQuery:a,ignoreDefaultQuery:e,jobType:ul.b.REGRESSION});if(!0===t.success&&t.eval&&Object(ul.z)(t.eval)){const{mse:e,msle:a,huber:i,r_squared:n}=Object(Ro.q)(t.eval);l({mse:e,msle:a,huber:i,rSquared:n,error:null}),p(!1)}else p(!1),l({...wl,error:t.error})})(!1);const i=await Object(Ro.s)({ignoreDefaultQuery:!1,isTraining:!0,searchQuery:a,resultsField:S,destIndex:e.dest.index});!0===i.success?x(i.docsCount):x(null)};return Object(n.useEffect)((()=>{let e;const t=Object(ul.A)(a)&&(a.bool.should||a.bool.filter);if(void 0!==t&&!1!==t)for(let a=0;a<t.length;a++){const i=t[a];if(i.match&&void 0!==i.match[`${S}.is_training`]){e=i.match[`${S}.is_training`];break}if(i.bool&&(void 0!==i.bool.should||void 0!==i.bool.filter)){const t=i.bool.should||i.bool.filter;if(void 0!==t)for(let a=0;a<t.length;a++){const i=t[a];if(i.match&&void 0!==i.match[`${S}.is_training`]){e=i.match[`${S}.is_training`];break}}}}g(e),M()}),[JSON.stringify(a)]),Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(Jo,{urlStateKey:"evaluation",dataTestId:"RegressionEvaluation",title:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.dataframe.analytics.regressionExploration.evaluateSectionTitle",defaultMessage:"Model evaluation"}),docsLink:Object(N.jsx)(te.EuiButtonEmpty,{target:"_blank",iconType:"help",iconSide:"left",color:"primary",href:r},y.i18n.translate("xpack.ml.dataframe.analytics.regressionExploration.regressionDocsLink",{defaultMessage:"Regression evaluation docs "})),headerItems:void 0!==t?[{id:"jobStatus",label:y.i18n.translate("xpack.ml.dataframe.analytics.classificationExploration.evaluateJobStatusLabel",{defaultMessage:"Job status"}),value:t}]:[],contentPadding:!0,content:Object(N.jsx)(te.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(te.EuiTitle,{size:"xxs"},Object(N.jsx)("span",null,y.i18n.translate("xpack.ml.dataframe.analytics.regressionExploration.generalizationErrorTitle",{defaultMessage:"Generalization error"}))),null!==v&&Object(N.jsx)(te.EuiText,{size:"xs",color:"subdued"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.dataframe.analytics.regressionExploration.generalizationDocsCount",defaultMessage:"{docsCount, plural, one {# doc} other {# docs}} evaluated",values:{docsCount:v}}),!0===h&&0===v&&Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.dataframe.analytics.regressionExploration.generalizationFilterText",defaultMessage:". Filtering for training data."})),Object(N.jsx)(te.EuiSpacer,null),Object(N.jsx)(te.EuiFlexGroup,{direction:"column",gutterSize:"none"},Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(te.EuiFlexGroup,{direction:"column",gutterSize:"s"},Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(te.EuiFlexGroup,null,Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(El,{dataTestSubj:"mlDFAnalyticsRegressionGenMSEstat",isLoading:m,title:c.mse,statType:ul.h.MSE})),Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(El,{dataTestSubj:"mlDFAnalyticsRegressionGenRSquaredStat",isLoading:m,title:c.rSquared,statType:ul.h.R_SQUARED})))),Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(te.EuiFlexGroup,null,Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(El,{dataTestSubj:"mlDFAnalyticsRegressionGenMsleStat",isLoading:m,title:c.msle,statType:ul.h.MSLE})),Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(El,{dataTestSubj:"mlDFAnalyticsRegressionGenHuberStat",isLoading:m,title:c.huber,statType:ul.h.HUBER})))))),null!==c.error&&Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiText,{size:"xs",color:"danger"},!0===h&&0===v&&c.error.includes("No documents found")?y.i18n.translate("xpack.ml.dataframe.analytics.regressionExploration.evaluateNoTestingDocsError",{defaultMessage:"No testing documents found"}):c.error)))),Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(te.EuiTitle,{size:"xxs"},Object(N.jsx)("span",null,y.i18n.translate("xpack.ml.dataframe.analytics.regressionExploration.trainingErrorTitle",{defaultMessage:"Training error"}))),null!==j&&Object(N.jsx)(te.EuiText,{size:"xs",color:"subdued"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.dataframe.analytics.regressionExploration.trainingDocsCount",defaultMessage:"{docsCount, plural, one {# doc} other {# docs}} evaluated",values:{docsCount:j}}),!1===h&&0===j&&Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.dataframe.analytics.regressionExploration.trainingFilterText",defaultMessage:". Filtering for testing data."})),Object(N.jsx)(te.EuiSpacer,null),Object(N.jsx)(te.EuiFlexGroup,{direction:"column",gutterSize:"none"},Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(te.EuiFlexGroup,{direction:"column",gutterSize:"s"},Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(te.EuiFlexGroup,null,Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(El,{dataTestSubj:"mlDFAnalyticsRegressionTrainingMSEstat",isLoading:u,title:o.mse,statType:ul.h.MSE})),Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(El,{dataTestSubj:"mlDFAnalyticsRegressionTrainingRSquaredStat",isLoading:u,title:o.rSquared,statType:ul.h.R_SQUARED})))),Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(te.EuiFlexGroup,null,Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(El,{dataTestSubj:"mlDFAnalyticsRegressionTrainingMsleStat",isLoading:u,title:o.msle,statType:ul.h.MSLE})),Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(El,{dataTestSubj:"mlDFAnalyticsRegressionTrainingHuberStat",isLoading:u,title:o.huber,statType:ul.h.HUBER})))))),null!==o.error&&Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiText,{size:"xs",color:"danger"},!1===h&&0===j&&o.error.includes("No documents found")?y.i18n.translate("xpack.ml.dataframe.analytics.regressionExploration.evaluateNoTrainingDocsError",{defaultMessage:"No training documents found"}):o.error)))))}),Object(N.jsx)(te.EuiSpacer,{size:"m"}))};var Ml=a(51),kl=a(167);const{euiColorMediumShade:Cl}=Ml.euiLightVars,Tl={axes:{axisLine:{stroke:Cl},tickLabel:{fontSize:12,fill:Cl},tickLine:{stroke:Cl},gridLine:{horizontal:{dash:[1,2]},vertical:{strokeWidth:0}}},legend:{spacingBuffer:100}},Fl=y.i18n.translate("xpack.ml.dataframe.analytics.exploration.featureImportanceSummaryTooltipContent",{defaultMessage:"Total feature importance values indicate how significantly a field affects the predictions across all the training data."}),Il=e=>e.classes.reduce(((e,t)=>e+t.importance.mean_magnitude),0),Dl=({totalFeatureImportance:e,jobConfig:t})=>{const{services:{docLinks:a}}=Object(f.b)(),[i,r,o,l]=Object(n.useMemo)((()=>{let t=[],a={xAccessor:"featureName",yAccessors:["meanImportance"],name:y.i18n.translate("xpack.ml.dataframe.analytics.exploration.featureImportanceYSeriesName",{defaultMessage:"magnitude"})},i="";if(e.length<1)return[t,a];Object(kl.b)(e[0])&&(2===e[0].classes.length&&(i="binary_classification",t=e.map((e=>({featureName:e.feature_name,meanImportance:e.classes[0].importance.mean_magnitude}))).sort(((e,t)=>t.meanImportance-e.meanImportance))),e[0].classes.length>2&&(i="multiclass_classification",e.sort(((e,t)=>Il(t)-Il(e))).forEach((e=>{const a=e.classes.sort(((e,t)=>t.importance.mean_magnitude-e.importance.mean_magnitude));t.push(...a.map((t=>({featureName:e.feature_name,meanImportance:t.importance.mean_magnitude,className:t.class_name}))))})),a={xAccessor:"featureName",yAccessors:["meanImportance"],splitSeriesAccessors:["className"],stackAccessors:["featureName"]})),Object(kl.d)(e[0])&&(i="regression",t=e.map((e=>({featureName:e.feature_name,meanImportance:e.importance.mean_magnitude}))).sort(((e,t)=>t.meanImportance-e.meanImportance)));const n="multiclass_classification"===i,s=e.length*(e.length<5?40:20)+50;return[t,a,n,s]}),[e]),c=a.links.ml.featureImportance,d=Object(n.useCallback)((e=>Number(e.toPrecision(3)).toString()),[]),u=Object(n.useMemo)((()=>{if(0===e.length&&(null!=t&&t.analysis&&Object(ul.y)(null==t?void 0:t.analysis)||Object(ul.v)(null==t?void 0:t.analysis))){const e=Object(Ro.h)(t.analysis);return"unknown"!==e&&0===t.analysis[e].num_top_feature_importance_values?Object(N.jsx)(te.EuiCallOut,{"data-test-subj":"mlTotalFeatureImportanceNotCalculatedCallout",size:"s",title:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.dataframe.analytics.exploration.totalFeatureImportanceNotCalculatedCalloutMessage",defaultMessage:"Feature importance was not calculated because num_top_feature_importance values is set to 0."})}):Object(N.jsx)(te.EuiCallOut,{"data-test-subj":"mlNoTotalFeatureImportanceCallout",size:"s",title:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.dataframe.analytics.exploration.noTotalFeatureImportanceCalloutMessage",defaultMessage:"Total feature importance data is not available; the data set is uniform and the features have no significant impact on the prediction."})})}}),[e,t]);return Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(Jo,{urlStateKey:"feature_importance",isExpanded:void 0===u,dataTestId:"FeatureImportanceSummary",title:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.dataframe.analytics.exploration.featureImportanceSummaryTitle",defaultMessage:"Total feature importance"}),docsLink:Object(N.jsx)(te.EuiButtonEmpty,{target:"_blank",iconType:"help",iconSide:"left",color:"primary",href:c},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.dataframe.analytics.exploration.featureImportanceDocsLink",defaultMessage:"Feature importance docs"})),headerItems:[{id:"FeatureImportanceSummary",value:Fl}],content:u||Object(N.jsx)("div",{"data-test-subj":"mlTotalFeatureImportanceChart"},Object(N.jsx)(ct.Chart,{size:{width:"100%",height:l}},Object(N.jsx)(ct.Settings,{rotation:90,theme:Tl,showLegend:o}),Object(N.jsx)(ct.Axis,{id:"x-axis",title:y.i18n.translate("xpack.ml.dataframe.analytics.exploration.featureImportanceXAxisTitle",{defaultMessage:"Feature importance average magnitude"}),position:ct.Position.Bottom,tickFormat:d}),Object(N.jsx)(ct.Axis,{id:"y-axis",title:"",position:ct.Position.Left}),Object(N.jsx)(ct.BarSeries,v()({id:"magnitude",xScaleType:ct.ScaleType.Ordinal,yScaleType:ct.ScaleType.Linear,data:i},r))))}),Object(N.jsx)(te.EuiSpacer,{size:"m"}))},Al=({jobId:e})=>Object(N.jsx)(vl,{jobId:e,title:y.i18n.translate("xpack.ml.dataframe.analytics.regressionExploration.tableJobIdTitle",{defaultMessage:"Destination index for regression job ID {jobId}",values:{jobId:e}}),EvaluatePanel:Sl,FeatureImportanceSummaryPanel:Dl});a(621);const Ll=({error:e})=>{let t=Object(N.jsx)(te.EuiCallOut,{title:y.i18n.translate("xpack.ml.dataframe.analytics.errorCallout.generalErrorTitle",{defaultMessage:"An error occurred loading the data."}),color:"danger",iconType:"cross"},Object(N.jsx)("p",null,e));return"string"==typeof e&&e.includes("index_not_found")?t=Object(N.jsx)(te.EuiCallOut,{title:y.i18n.translate("xpack.ml.dataframe.analytics.errorCallout.evaluateErrorTitle",{defaultMessage:"An error occurred loading the data."}),color:"danger",iconType:"cross"},Object(N.jsx)("p",null,y.i18n.translate("xpack.ml.dataframe.analytics.errorCallout.noIndexCalloutBody",{defaultMessage:"The query for the index returned no results. Please make sure the destination index exists and contains documents."}))):"string"==typeof e&&e.includes("No documents found")?t=Object(N.jsx)(te.EuiCallOut,{title:y.i18n.translate("xpack.ml.dataframe.analytics.errorCallout.noDataCalloutTitle",{defaultMessage:"Empty index query result."}),color:"primary"},Object(N.jsx)("p",null,y.i18n.translate("xpack.ml.dataframe.analytics.errorCallout.noDataCalloutBody",{defaultMessage:"The query for the index returned no results. Please make sure the job has completed and the index contains documents."}))):"string"==typeof e&&e.includes("userProvidedQueryBuilder")&&(t=Object(N.jsx)(te.EuiCallOut,{title:y.i18n.translate("xpack.ml.dataframe.analytics.errorCallout.queryParsingErrorTitle",{defaultMessage:"Unable to parse query."}),color:"primary"},Object(N.jsx)("p",null,y.i18n.translate("xpack.ml.dataframe.analytics.errorCallout.queryParsingErrorBody",{defaultMessage:"The query syntax is invalid and returned no results. Please check the query syntax and try again."})))),Object(N.jsx)(n.Fragment,null,t)},Rl=({isLoading:e,title:t,description:a,dataTestSubj:i,tooltipContent:n})=>Object(N.jsx)(te.EuiFlexGroup,{gutterSize:"xs","data-test-subj":i},Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiStat,{reverse:!0,isLoading:e,title:null!==t?Math.round(1e3*t)/1e3:ul.c,description:a,titleSize:"xs"})),Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiIconTip,{anchorClassName:"mlDataFrameAnalyticsRegression__evaluateStat",content:n}))),Pl=[{field:"className",name:y.i18n.translate("xpack.ml.dataframe.analytics.classificationExploration.recallAndAccuracyClassColumn",{defaultMessage:"Class"}),sortable:!0,truncateText:!0},{field:"accuracy",name:y.i18n.translate("xpack.ml.dataframe.analytics.classificationExploration.recallAndAccuracyAccuracyColumn",{defaultMessage:"Accuracy"}),render:e=>Math.round(1e3*e)/1e3},{field:"recall",name:y.i18n.translate("xpack.ml.dataframe.analytics.classificationExploration.recallAndAccuracyRecallColumn",{defaultMessage:"Recall"}),render:e=>Math.round(1e3*e)/1e3}],Nl=({evaluationMetricsItems:e})=>Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(te.EuiAccordion,{id:"recall-and-accuracy",buttonContent:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.dataframe.analytics.classificationExploration.evaluateSectionRecallAndAccuracy",defaultMessage:"Per class recall and accuracy"})},Object(N.jsx)(te.EuiPanel,null,Object(N.jsx)(te.EuiInMemoryTable,{items:e,columns:Pl,pagination:!0,sorting:!0})))),zl=Object(te.euiPaletteGray)(1)[0],Bl="baseline",Jl=300;const Vl=(e,t,a,i)=>{t.push({tpr:0,fpr:0,threshold:1,class_name:Bl}),t.push({tpr:1,fpr:1,threshold:1,class_name:Bl});const n=function(e){const t=[...e,Bl].sort().indexOf(Bl),a=Object(te.euiPaletteColorBlind)({rotations:2}).slice(0,e.length);return a.splice(t,0,zl),a}(e);return{$schema:"https://vega.github.io/schema/vega-lite/v4.8.1.json",background:"transparent",padding:{left:45,top:0,right:0,bottom:0},config:{legend:{orient:"right",labelColor:i.euiTextSubduedColor,titleColor:i.euiTextSubduedColor},view:{continuousHeight:Jl,continuousWidth:Jl}},data:{name:"roc-curve-data"},datasets:{"roc-curve-data":t},encoding:{color:{field:"class_name",type:wo.a.NOMINAL,scale:{range:n},legend:{title:a}},size:{value:2},strokeDash:{condition:{test:`(datum.class_name === '${Bl}')`,value:[5,5]},value:[0]},x:{field:"fpr",sort:null,title:y.i18n.translate("xpack.ml.dataframe.analytics.rocChartSpec.xAxisTitle",{defaultMessage:"False Positive Rate (FPR)"}),type:"quantitative",axis:{tickColor:zl,labelColor:i.euiTextSubduedColor,domainColor:zl,titleColor:i.euiTextSubduedColor}},y:{field:"tpr",title:y.i18n.translate("xpack.ml.dataframe.analytics.rocChartSpec.yAxisTitle",{defaultMessage:"True Positive Rate (TPR) (a.k.a Recall)"}),type:"quantitative",axis:{tickColor:zl,labelColor:i.euiTextSubduedColor,domainColor:zl,titleColor:i.euiTextSubduedColor}},tooltip:[{type:wo.a.NOMINAL,field:"class_name"},{type:wo.a.QUANTITATIVE,field:"fpr"},{type:wo.a.QUANTITATIVE,field:"tpr"}]},height:Jl,width:Jl,mark:{type:"line",strokeCap:"round",strokeJoin:"round"}}},Ul="actual_class",Gl="other";function ql(e,t){return[{id:"actions",width:60,headerCellRender:()=>Object(N.jsx)("span",null,`${e} more`),rowCellRender:function(){const[e,a]=Object(n.useState)(!1);return Object(N.jsx)(te.EuiPopover,{isOpen:e,anchorPosition:"upCenter",button:Object(N.jsx)(te.EuiButtonIcon,{"aria-label":y.i18n.translate("xpack.ml.dataframe.analytics.classificationExploration.showActions",{defaultMessage:"Show actions"}),iconType:"boxesHorizontal",color:"text",onClick:()=>a(!e)}),closePopover:()=>a(!1),ownFocus:!0},Object(N.jsx)(te.EuiButtonEmpty,{onClick:()=>t(!0)},Object(N.jsx)(te.EuiText,{size:"s",grow:!1,textAlign:"center"},y.i18n.translate("xpack.ml.dataframe.analytics.classificationExploration.showAllColumns",{defaultMessage:"Show all columns"}))))}}]}function Hl(e,t){let a;const i=Object(ul.A)(e)&&(e.bool.should||e.bool.filter);if(void 0!==i&&!1!==i)for(let e=0;e<i.length;e++){const n=i[e];if(n.match&&void 0!==n.match[`${t}.is_training`]){a=n.match[`${t}.is_training`];break}if(n.bool&&(void 0!==n.bool.should||void 0!==n.bool.filter)){const e=n.bool.should||n.bool.filter;if(void 0!==e)for(let i=0;i<e.length;i++){const n=e[i];if(n.match&&void 0!==n.match[`${t}.is_training`]){a=n.match[`${t}.is_training`];break}}}}return a}const Wl=1e5;const $l=(e,t)=>{const[a,i]=Object(n.useState)([]),[s,r]=Object(n.useState)(null),[o,l]=Object(n.useState)(null),[c,d]=Object(n.useState)([]),[u,p]=Object(n.useState)(!1),[m,b]=Object(n.useState)(null),[h,f]=Object(n.useState)(null);return Object(n.useEffect)((()=>{!async function(){p(!0);let a=!1;const n=Object(Ro.k)(e.analysis),s=e.dest.results_field,o=Hl(t,s);try{a=Object(fo.g)(n)}catch(e){console.error("Unable to load new field types",e)}const c=await Object(Ro.t)({isTraining:o,index:e.dest.index,dependentVariable:n,resultsField:s,predictionFieldName:Object(Ro.o)(e.analysis),searchQuery:t,jobType:ul.b.CLASSIFICATION,requiresKeyword:a}),u=await Object(Ro.s)({isTraining:o,searchQuery:t,resultsField:s,destIndex:e.dest.index});if(!0===c.success&&c.eval&&Object(ul.w)(c.eval)){var m,h,g,j,x,v,y,O,E,w;const e=null===(m=c.eval)||void 0===m||null===(h=m.classification)||void 0===h||null===(g=h.multiclass_confusion_matrix)||void 0===g?void 0:g.confusion_matrix;f(null),i(e||[]),l((null===(j=c.eval)||void 0===j||null===(x=j.classification)||void 0===x||null===(v=x.recall)||void 0===v?void 0:v.avg_recall)||null),r((null===(y=c.eval)||void 0===y||null===(O=y.classification)||void 0===O||null===(E=O.accuracy)||void 0===E?void 0:E.overall_accuracy)||null),d(function(e){var t,a;if(void 0===e)return[];const i=(null===(t=e.accuracy)||void 0===t?void 0:t.classes)||[],n=(null===(a=e.recall)||void 0===a?void 0:a.classes)||[],s=i.reduce(((e,t)=>(e[t.class_name]={className:t.class_name,accuracy:t.value},e)),{});return n.forEach((e=>{void 0!==s[e.class_name]?s[e.class_name]={recall:e.value,...s[e.class_name]}:s[e.class_name]={className:e.class_name,recall:e.value}})),Object.values(s)}(null===(w=c.eval)||void 0===w?void 0:w.classification)),p(!1)}else p(!1),i([]),f(c.error);!0===u.success?b(u.docsCount):b(null)}()}),[JSON.stringify([e,t])]),{avgRecall:o,confusionMatrixData:a,docsCount:m,error:h,isLoading:u,overallAccuracy:s,evaluationMetricsItems:c}};a(630);const Yl=({onClick:e})=>Object(N.jsx)(te.EuiButtonIcon,{className:"mlHelpPopover__buttonIcon",size:"s",iconType:"help","aria-label":y.i18n.translate("xpack.ml.helpPopover.ariaLabel",{defaultMessage:"Help"}),onClick:e}),Xl=({anchorPosition:e,button:t,children:a,closePopover:i,isOpen:n,title:s})=>Object(N.jsx)(te.EuiPopover,{anchorPosition:e,button:t,className:"mlHelpPopover",closePopover:i,isOpen:n,ownFocus:!0,panelClassName:"mlHelpPopover__panel",panelPaddingSize:"none"},s&&Object(N.jsx)(te.EuiPopoverTitle,{paddingSize:"s"},s),Object(N.jsx)(te.EuiText,{className:"mlHelpPopover__content",size:"s"},a)),Ql=()=>{const[e,t]=Object(n.useState)(!1);return Object(N.jsx)(Xl,{anchorPosition:"upCenter",button:Object(N.jsx)(Yl,{onClick:()=>{t(!e)}}),closePopover:()=>t(!1),isOpen:e,title:y.i18n.translate("xpack.ml.dataframe.analytics.confusionMatrixPopoverTitle",{defaultMessage:"Normalized confusion matrix"})},Object(N.jsx)("p",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.dataframe.analytics.confusionMatrixBasicExplanation",defaultMessage:"The multiclass confusion matrix provides a summary of the performance of the classification analysis. It contains the proportion of the data points that the analysis classified correctly with their actual class as well as the proportion of the misclassified data points."})),Object(N.jsx)("p",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.dataframe.analytics.confusionMatrixAxisExplanation",defaultMessage:"The matrix contains the actual labels on the left side while the predicted labels are on the top. The proportion of correct and incorrect predictions is broken down for each class. This enables you to examine how the classification analysis confused the different classes while it made its predictions. If you want to see the exact number of occurrences, select a cell in the matrix and click the appearing icon."})),Object(N.jsx)("p",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.dataframe.analytics.confusionMatrixShadeExplanation",defaultMessage:"As the number of classes in the classification analysis increases, the confusion matrix also increases in complexity. For an easier overview, darker cells indicate higher percentage of the predictions."})),Object(N.jsx)("p",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.dataframe.analytics.confusionMatrixColumnExplanation",defaultMessage:"The Columns selector enables you to toggle between showing or hiding some of the columns or all of them."})))},Kl=()=>{const[e,t]=Object(n.useState)(!1);return Object(N.jsx)(Xl,{anchorPosition:"upCenter",button:Object(N.jsx)(Yl,{onClick:()=>{t(!e)}}),closePopover:()=>t(!1),isOpen:e,title:y.i18n.translate("xpack.ml.dataframe.analytics.rocCurvePopoverTitle",{defaultMessage:"Receiver operating characteristic (ROC) curve"})},Object(N.jsx)("p",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.dataframe.analytics.rocCurveBasicExplanation",defaultMessage:"The ROC curve is a plot that represents the performance of the classification process at different predicted probability thresholds."})),Object(N.jsx)("p",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.dataframe.analytics.rocCurveCompute",defaultMessage:"It compares the true positive rate (y-axis) for a specific class against the false positive rate (x-axis) at the different threshold levels to create the curve."})),Object(N.jsx)("p",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.dataframe.analytics.rocCurveAuc",defaultMessage:"From this plot, the area under the curve (AUC) value can be computed, which is a number between 0 and 1. The closer to 1, the better the algorithm performance."})))};var Zl;!function(e){e.TRAINING="training",e.TESTING="testing",e.ENTIRE="entire"}(Zl||(Zl={}));const ec=y.i18n.translate("xpack.ml.dataframe.analytics.classificationExploration.confusionMatrixEntireHelpText",{defaultMessage:"Normalized confusion matrix for entire dataset"}),tc=y.i18n.translate("xpack.ml.dataframe.analytics.classificationExploration.confusionMatrixTestingHelpText",{defaultMessage:"Normalized confusion matrix for testing dataset"}),ac=y.i18n.translate("xpack.ml.dataframe.analytics.classificationExploration.confusionMatrixTrainingHelpText",{defaultMessage:"Normalized confusion matrix for training dataset"}),ic=y.i18n.translate("xpack.ml.dataframe.analytics.classificationExploration.evaluationQualityMetricsHelpText",{defaultMessage:"Evaluation quality metrics"});function nc(e){let t=ec;return e===Zl.TESTING?t=tc:e===Zl.TRAINING&&(t=ac),t}const sc=({jobConfig:e,jobStatus:t,searchQuery:a})=>{const{services:{docLinks:i}}=Object(f.b)(),{euiTheme:r}=Object(ho.e)(),[o,l]=Object(n.useState)([]),[c,d]=Object(n.useState)([]),[u,p]=Object(n.useState)(!1),[m,b]=Object(n.useState)({}),[h,g]=Object(n.useState)(Zl.ENTIRE),[j,x]=Object(n.useState)((()=>o.map((({id:e})=>e)))),v=Hl(a,e.dest.results_field),{avgRecall:O,confusionMatrixData:E,docsCount:w,error:_,isLoading:S,overallAccuracy:M,evaluationMetricsItems:k}=$l(e,a);Object(n.useEffect)((()=>{g(void 0===v?Zl.ENTIRE:v&&!0===v?Zl.TRAINING:Zl.TESTING)}),[v]),Object(n.useEffect)((()=>{if(E.length>0){const{columns:e,columnData:t}=function(e){const t=[],a=[{id:Ul,display:Object(N.jsx)("span",null),initialWidth:165}];let i=!1;for(const n of e){const e=n.other_predicted_class_doc_count;e>0&&(i=!0);const s={actual_class:n.actual_class,actual_class_doc_count:n.actual_class_doc_count,other:e,predicted_classes_count:{}},r=n.predicted_classes||[];a.push({id:n.actual_class,initialWidth:165});for(let e=0;e<r.length;e++){const t=r[e].predicted_class,a=r[e].count;s.predicted_classes_count[t]=a}t.push(s)}return i&&a.push({id:Gl,initialWidth:165}),{columns:a,columnData:t}}(E);x((()=>e.map((({id:e})=>e)))),l(e),d(t),b({numeric:({cellContentsElement:e,children:a})=>{var i,n;const s=null==a||null===(i=a.props)||void 0===i?void 0:i.rowIndex,r=null==a||null===(n=a.props)||void 0===n?void 0:n.columnId,o=t[s];if(void 0!==o&&r!==Ul){return`${o.predicted_classes_count[r]} / ${o.actual_class_doc_count} * 100 = ${e.textContent}`}return e.textContent}})}}),[E]);const{rocCurveData:C,classificationClasses:T,error:F,isLoading:I}=((e,t,a)=>{const i=a.filter((e=>e!==Ul&&e!==Gl));i.length<=2&&i.splice(1);const[s,r]=Object(n.useState)([]),[o,l]=Object(n.useState)(!1),[c,d]=Object(n.useState)(null);return Object(n.useEffect)((()=>{!async function(){l(!0);const a=Object(Ro.k)(e.analysis),n=e.dest.results_field,s=[];let o=!1;const c=[];try{o=Object(fo.g)(a)}catch(e){console.error("Unable to load new field types",e)}for(let r=0;r<i.length;r++){const l=i[r],d=await Object(Ro.t)({isTraining:Hl(t,n),index:e.dest.index,dependentVariable:a,resultsField:n,predictionFieldName:Object(Ro.o)(e.analysis),searchQuery:t,jobType:ul.b.CLASSIFICATION,requiresKeyword:o,rocCurveClassName:l,includeMulticlassConfusionMatrix:!1});if(!0===d.success&&d.eval&&Object(ul.w)(d.eval)){var u,p,m,b,h,f;const e=(null===(u=d.eval)||void 0===u||null===(p=u.classification)||void 0===p||null===(m=p.auc_roc)||void 0===m?void 0:m.value)||0,t=i.length>2?i[r]:"ROC",a=((null===(b=d.eval)||void 0===b||null===(h=b.classification)||void 0===h||null===(f=h.auc_roc)||void 0===f?void 0:f.curve)||[]).map((a=>({class_name:`${t} (AUC: ${Math.round(e*Wl)/Wl})`,...a})));s.push(...a)}else null!==d.error&&c.push(d.error)}d(c.length>0?c:null),r(s),l(!1)}()}),[JSON.stringify([e,t,a])]),{rocCurveData:s,classificationClasses:i.length>2?i:["ROC"],error:c,isLoading:o}})(e,a,o.map((e=>e.id))),D=i.links.ml.classificationEvaluation,A=c.length>6,L=c.length-6,R=!0===A&&!1===u?o.slice(0,7):o,P=!0===A&&!1===u?6:c.length;return Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(Jo,{urlStateKey:"evaluation",dataTestId:"ClassificationEvaluation",title:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.dataframe.analytics.classificationExploration.evaluateSectionTitle",defaultMessage:"Model evaluation"}),docsLink:Object(N.jsx)(te.EuiButtonEmpty,{target:"_blank",iconType:"help",iconSide:"left",color:"primary",href:D},y.i18n.translate("xpack.ml.dataframe.analytics.classificationExploration.classificationDocsLink",{defaultMessage:"Classification evaluation docs "})),headerItems:S?Bo:[...void 0!==t?[{id:"jobStatus",label:y.i18n.translate("xpack.ml.dataframe.analytics.classificationExploration.evaluateJobStatusLabel",{defaultMessage:"Job status"}),value:t}]:[],...null!==w?[{id:"docsEvaluated",label:y.i18n.translate("xpack.ml.dataframe.analytics.classificationExploration.generalizationDocsCount",{defaultMessage:"{docsCount, plural, one {doc} other {docs}} evaluated",values:{docsCount:w}}),value:w}]:[]],contentPadding:!0,content:Object(N.jsx)(s.a.Fragment,null,S?null:Object(N.jsx)(s.a.Fragment,null,null!==_&&Object(N.jsx)(Ll,{error:_}),null===_&&Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(te.EuiFlexGroup,{gutterSize:"none",alignItems:"center"},Object(N.jsx)(te.EuiTitle,{size:"xxs"},Object(N.jsx)("span",null,nc(h))),Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(Ql,null))),Object(N.jsx)(te.EuiSpacer,{size:"m"}),Object(N.jsx)("div",{className:"mlDataFrameAnalyticsClassification__evaluateSectionContent"},Object(N.jsx)("div",{className:"mlDataFrameAnalyticsClassification__actualLabel"},Object(N.jsx)(te.EuiText,{size:"xs",color:"subdued"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.dataframe.analytics.classificationExploration.confusionMatrixActualLabel",defaultMessage:"Actual class"}))),Object(N.jsx)("div",{className:"mlDataFrameAnalyticsClassification__dataGridMinWidth"},o.length>0&&c.length>0&&Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)("div",null,Object(N.jsx)(te.EuiText,{size:"xs",color:"subdued"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.dataframe.analytics.classificationExploration.confusionMatrixPredictedLabel",defaultMessage:"Predicted class"}))),Object(N.jsx)(te.EuiSpacer,{size:"s"}),Object(N.jsx)(te.EuiDataGrid,{"data-test-subj":"mlDFAnalyticsClassificationExplorationConfusionMatrix","aria-label":y.i18n.translate("xpack.ml.dataframe.analytics.classificationExploration.confusionMatrixLabel",{defaultMessage:"Classification confusion matrix"}),columns:R,columnVisibility:{visibleColumns:j,setVisibleColumns:x},rowCount:P,renderCellValue:({rowIndex:e,columnId:t,setCellProps:a})=>{const i=t===Ul?c[e][t]:c[e].predicted_classes_count[t],s=c[e]&&c[e].actual_class_doc_count;let r="0%";if(t!==Ul&&s&&"number"==typeof i){let e=i/s;e=Math.round(100*e)/100,r=`${Math.round(100*e)}%`}return Object(n.useEffect)((()=>{t!==Ul&&a({style:{backgroundColor:`rgba(0, 179, 164, ${r})`}})}),[e,t,a]),Object(N.jsx)("span",null,t===Ul?i:r)},inMemory:{level:"sorting"},toolbarVisibility:{showColumnSelector:!0,showStyleSelector:!1,showFullScreenSelector:!1,showSortSelector:!1},popoverContents:m,gridStyle:{border:"all",fontSize:"s",cellPadding:"s",stripes:!1,rowHover:"none",header:"shade"},trailingControlColumns:!0===A&&!1===u?ql(L,p):void 0})))))),Object(N.jsx)(te.EuiSpacer,{size:"xl"}),Object(N.jsx)(te.EuiTitle,{size:"xxs"},Object(N.jsx)("span",null,ic)),Object(N.jsx)(te.EuiSpacer,{size:"s"}),Object(N.jsx)(te.EuiFlexGroup,{direction:"column",justifyContent:"center",className:"mlDataFrameAnalyticsClassification__evaluationMetrics"},Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiFlexGroup,{gutterSize:"l"},Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(Rl,{dataTestSubj:"mlDFAEvaluateSectionOverallAccuracyStat",title:M,isLoading:S,description:y.i18n.translate("xpack.ml.dataframe.analytics.classificationExploration.evaluateSectionOverallAccuracyStat",{defaultMessage:"Overall accuracy"}),tooltipContent:y.i18n.translate("xpack.ml.dataframe.analytics.classificationExploration.evaluateSectionOverallAccuracyTooltip",{defaultMessage:"The ratio of the number of correct class predictions to the total number of predictions."})})),Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(Rl,{dataTestSubj:"mlDFAEvaluateSectionAvgRecallStat",title:O,isLoading:S,description:y.i18n.translate("xpack.ml.dataframe.analytics.classificationExploration.evaluateSectionMeanRecallStat",{defaultMessage:"Mean recall"}),tooltipContent:y.i18n.translate("xpack.ml.dataframe.analytics.classificationExploration.evaluateSectionAvgRecallTooltip",{defaultMessage:"Mean recall shows how many of the data points that are actual class members were identified correctly as class members."})})))),Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(Nl,{evaluationMetricsItems:k}))),Object(N.jsx)(te.EuiSpacer,{size:"l"}),Object(N.jsx)(te.EuiFlexGroup,{gutterSize:"none",alignItems:"center"},Object(N.jsx)(te.EuiTitle,{size:"xxs"},Object(N.jsx)("span",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.dataframe.analytics.classificationExploration.evaluateSectionRocTitle",defaultMessage:"Receiver operating characteristic (ROC) curve"}))),Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(Kl,null))),Array.isArray(F)&&Object(N.jsx)(Ll,{error:Object(N.jsx)(s.a.Fragment,null,F.map((e=>Object(N.jsx)(s.a.Fragment,null,e,Object(N.jsx)("br",null)))))}),!I&&null===F&&C.length>0&&Object(N.jsx)("div",{className:"mlDataFrameAnalyticsClassification__evaluateSectionContent","data-test-subj":"mlDFAnalyticsClassificationExplorationRocCurveChart"},Object(N.jsx)(Eo,{vegaSpec:Vl(T,C,Object(Ro.k)(e.analysis),r)})),I&&Object(N.jsx)(yo,null))}),Object(N.jsx)(te.EuiSpacer,{size:"m"}))},rc=({jobId:e})=>Object(N.jsx)("div",{className:"mlDataFrameAnalyticsClassification"},Object(N.jsx)(vl,{jobId:e,title:y.i18n.translate("xpack.ml.dataframe.analytics.classificationExploration.tableJobIdTitle",{defaultMessage:"Destination index for classification job ID {jobId}",values:{jobId:e}}),EvaluatePanel:sc,FeatureImportanceSummaryPanel:Dl})),oc=({jobId:e,analysisType:t})=>{const{services:{docLinks:a}}=Object(f.b)(),i=a.links.ml.dataFrameAnalytics;return Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(cr.a,{tabId:"data_frame_analytics"}),Object(N.jsx)(te.EuiPage,{"data-test-subj":"mlPageDataFrameAnalyticsExploration"},Object(N.jsx)(te.EuiPageBody,{style:{maxWidth:"calc(100% - 0px)"}},Object(N.jsx)(te.EuiPageContentHeader,null,Object(N.jsx)(te.EuiPageContentHeaderSection,null,Object(N.jsx)(te.EuiTitle,null,Object(N.jsx)("h1",null,e)))),Object(N.jsx)(te.EuiPageContentBody,{style:{maxWidth:"calc(100% - 0px)"}},t===nl.a.OUTLIER_DETECTION&&Object(N.jsx)(dl,{jobId:e}),t===nl.a.REGRESSION&&Object(N.jsx)(Al,{jobId:e}),t===nl.a.CLASSIFICATION&&Object(N.jsx)(rc,{jobId:e})))),Object(N.jsx)(dr.a,{docLink:i}))},lc=(e,t)=>({path:"/data_frame_analytics/exploration",render:(e,t)=>Object(N.jsx)(cc,v()({},e,{deps:t})),breadcrumbs:[P("ML_BREADCRUMB",e,t),P("DATA_FRAME_ANALYTICS_BREADCRUMB",e,t),{text:y.i18n.translate("xpack.ml.dataFrameAnalyticsBreadcrumbs.dataFrameExplorationLabel",{defaultMessage:"Exploration"}),href:""}]}),cc=({location:e,deps:t})=>{const{context:a}=F(void 0,void 0,t.config,Y(t)),[i]=Object(j.c)("_g"),n=Object(f.d)(),{services:{application:{navigateToUrl:s}}}=Object(f.b)(),r=i.ml.jobId,o=i.ml.analysisType;return o||(async()=>{if(!n)return;const e=await n.getUrl({page:T.b.DATA_FRAME_ANALYTICS_JOBS_MANAGE});await s(e)})(),Object(N.jsx)(Vb,{context:a},Object(N.jsx)(oc,{jobId:r,analysisType:o}))};var dc=a(358);const uc=({messages:e})=>Object(N.jsx)(s.a.Fragment,null,e.map(((e,t)=>Object(N.jsx)(n.Fragment,{key:t},Object(N.jsx)(te.EuiCallOut,{"data-test-subj":`analyticsWizardCreationCallout_${t}`,title:e.message,color:void 0!==e.error?"danger":"primary",iconType:void 0!==e.error?"alert":"checkInCircleFilled",size:"s"},void 0!==e.error&&Object(N.jsx)(te.EuiCodeBlock,{language:"json",fontSize:"s",paddingSize:"s",isCopyable:!0},e.error)),Object(N.jsx)(te.EuiSpacer,{size:"s"})))));var pc=a(118);const mc=async e=>{const t=Object(pc.f)(e);let a="",i="",n=!0,s="",r=[],o=!1;try{var l;delete t.dest,delete t.model_memory_limit;const e=await ge.ml.dataFrameAnalytics.explainDataFrameAnalytics(t);s=null===(l=e.memory_estimation)||void 0===l?void 0:l.expected_memory_without_disk,r=e.field_selection||[]}catch(e){const t=Object(ze.c)(e);n=!1,a=t.message,t.causedBy&&(i=t.causedBy)}return a.includes("status_exception")&&a.includes("Unable to estimate memory usage as no documents")&&(o=!0),{success:n,expectedMemory:s,fieldSelection:r,errorMessage:a,errorReason:i,noDocsContainMappedFields:o}},bc=()=>{const e=Object(f.c)({page:T.b.DATA_FRAME_ANALYTICS_JOBS_MANAGE});return Object(N.jsx)(n.Fragment,null,Object(N.jsx)(te.EuiCard,{className:"dfAnalyticsCreationWizard__card",icon:Object(N.jsx)(te.EuiIcon,{size:"xxl",type:"list"}),title:y.i18n.translate("xpack.ml.dataframe.analytics.create.analyticsListCardTitle",{defaultMessage:"Data Frame Analytics"}),description:y.i18n.translate("xpack.ml.dataframe.analytics.create.analyticsListCardDescription",{defaultMessage:"Return to the analytics management page."}),href:e,"data-test-subj":"analyticsWizardCardManagement"}))},hc=({jobId:e,analysisType:t})=>{const a=Object(f.c)({page:T.b.DATA_FRAME_ANALYTICS_EXPLORATION,pageState:{jobId:e,analysisType:t}});return Object(N.jsx)(n.Fragment,null,Object(N.jsx)(te.EuiCard,{className:"dfAnalyticsCreationWizard__card",icon:Object(N.jsx)(te.EuiIcon,{size:"xxl",type:"visTable"}),title:y.i18n.translate("xpack.ml.dataframe.analytics.create.viewResultsCardTitle",{defaultMessage:"View Results"}),description:y.i18n.translate("xpack.ml.dataframe.analytics.create.viewResultsCardDescription",{defaultMessage:"View results for the analytics job."}),href:a,"data-test-subj":"analyticsWizardViewResultsCard"}))},fc=({currentProgress:e,failedJobMessage:t})=>void 0===e?null:Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(te.EuiSpacer,null),void 0!==t&&Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(te.EuiCallOut,{"data-test-subj":"analyticsWizardProgressCallout",title:y.i18n.translate("xpack.ml.dataframe.analytics.create.analyticsProgressCalloutTitle",{defaultMessage:"Job failed"}),color:"danger",iconType:"alert",size:"s"},Object(N.jsx)("p",null,t)),Object(N.jsx)(te.EuiSpacer,{size:"s"})),Object(N.jsx)(te.EuiText,{size:"m"},Object(N.jsx)("strong",null,y.i18n.translate("xpack.ml.dataframe.analytics.create.analyticsProgressTitle",{defaultMessage:"Progress"}))),Object(N.jsx)(te.EuiSpacer,{size:"s"}),Object(N.jsx)(te.EuiFlexGroup,{alignItems:"center"},Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiText,{size:"s"},Object(N.jsx)("strong",null,y.i18n.translate("xpack.ml.dataframe.analytics.create.analyticsProgressPhaseTitle",{defaultMessage:"Phase"})," ",e.currentPhase,"/",e.totalPhases))),Object(N.jsx)(te.EuiFlexItem,{style:{width:"400px"},grow:!1},Object(N.jsx)(te.EuiProgress,{value:e.progress,max:100,color:"primary",size:"l","data-test-subj":"mlAnalyticsCreationWizardProgress"})),Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiText,{size:"s"},`${e.progress}%`)))),gc=({jobId:e,jobType:t,showProgress:a})=>{const[i,r]=Object(n.useState)(!1),[o,l]=Object(n.useState)(void 0),[c,d]=Object(n.useState)(!1),[u,p]=Object(n.useState)(void 0),[m,b]=Object(n.useState)(!1),{services:{notifications:h}}=Object(f.b)();return Object(n.useEffect)((()=>{r(!0)}),[]),Object(n.useEffect)((()=>{const t=setInterval((async()=>{try{const a=await ge.ml.dataFrameAnalytics.getDataFrameAnalyticsStats(e),i=Object(Vo.b)(a)?a.data_frame_analytics[0]:void 0;if(b((null==i?void 0:i.state)===Uo.b.STARTING&&void 0===(null==i?void 0:i.node)),void 0!==i){const a=Object(Uo.d)(i);i.state===Uo.b.FAILED&&(clearInterval(t),l(i.failure_reason||y.i18n.translate("xpack.ml.dataframe.analytics.create.analyticsProgressCalloutMessage",{defaultMessage:"Analytics job {jobId} has failed.",values:{jobId:e}}))),p(a),(a.currentPhase===a.totalPhases&&100===a.progress||i.state===Uo.b.STOPPED&&(1!==a.currentPhase||0!==a.progress))&&(clearInterval(t),d(a.currentPhase===a.totalPhases&&100===a.progress))}else clearInterval(t)}catch(a){h.toasts.addDanger(y.i18n.translate("xpack.ml.dataframe.analytics.create.analyticsProgressErrorMessage",{defaultMessage:"An error occurred getting progress stats for analytics job {jobId}",values:{jobId:e}})),clearInterval(t)}}),1e3);return()=>clearInterval(t)}),[i]),Object(N.jsx)(s.a.Fragment,null,m&&Object(N.jsx)(Gn.b,{jobType:"data-frame-analytics"}),Object(N.jsx)(te.EuiFlexGroup,{direction:"column"},Object(N.jsx)(te.EuiFlexItem,{grow:!1},a&&Object(N.jsx)(fc,{currentProgress:u,failedJobMessage:o})),Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiHorizontalRule,null),Object(N.jsx)(te.EuiFlexGroup,null,Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(bc,null)),!0===c&&Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(hc,{jobId:e,analysisType:t}))))))},jc=({actions:e,state:t,step:a})=>{const{createAnalyticsJob:i,startAnalyticsJob:s}=e,{isAdvancedEditorValidJson:r,isJobCreated:o,isJobStarted:l,isValid:c,requestMessages:d}=t,{jobId:u,jobType:p}=t.form,[m,b]=Object(n.useState)(!0),[h,f]=Object(n.useState)(!1),[g,j]=Object(n.useState)(!1);if(a!==kd.CREATE)return null;return Object(N.jsx)("div",{"data-test-subj":"mlAnalyticsCreateJobWizardCreateStep active"},!o&&!l&&Object(N.jsx)(te.EuiFlexGroup,{gutterSize:"s"},Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiFormRow,{helpText:y.i18n.translate("xpack.ml.dataframe.analytics.create.startCheckboxHelpText",{defaultMessage:"If unselected, job can be started later by returning to the jobs list."})},Object(N.jsx)(te.EuiCheckbox,{"data-test-subj":"mlAnalyticsCreateJobWizardStartJobCheckbox",id:"dataframe-create-start-checkbox",label:y.i18n.translate("xpack.ml.dataframe.analytics.create.wizardStartCheckbox",{defaultMessage:"Start immediately"}),checked:m,onChange:e=>b(e.target.checked)}))),Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiButton,{className:"mlAnalyticsCreateWizard__footerButton",disabled:!c||!r,onClick:async()=>{f(!0);const e=await i();!1===e&&f(!1),m&&!0===e&&(j(!0),s())},fill:!0,isLoading:h,"data-test-subj":"mlAnalyticsCreateJobWizardCreateButton"},y.i18n.translate("xpack.ml.dataframe.analytics.create.wizardCreateButton",{defaultMessage:"Create"})))),Object(N.jsx)(te.EuiSpacer,{size:"s"}),Object(N.jsx)(uc,{messages:d}),!0===o&&Object(N.jsx)(gc,{jobId:u,jobType:p,showProgress:g}))},xc=e=>{const{actions:t,state:a}=e,{setAdvancedEditorRawString:i,setFormState:s}=t,{advancedEditorMessages:r,advancedEditorRawString:o,isJobCreated:l}=a,{createIndexPattern:d,destinationIndexPatternTitleExists:u,jobId:p,jobIdEmpty:m,jobIdExists:b,jobIdValid:h}=a.form,g=Object(n.useRef)(null),{toasts:j}=Object(f.f)(),x=Object(n.useMemo)((()=>Object(E.debounce)((async()=>{try{const e=await ge.ml.dataFrameAnalytics.jobsExist([p],!0);s({jobIdExists:e[p].exists})}catch(e){j.addDanger(y.i18n.translate("xpack.ml.dataframe.analytics.create.advancedEditor.errorCheckingJobIdExists",{defaultMessage:"The following error occurred checking if job id exists: {error}",values:{error:Object(ze.b)(e)}}))}}),400)),[p]);return Object(n.useEffect)((()=>{if(null===g.current)return;const e=document.createEvent("MouseEvents");e.initEvent("mouseup",!0,!0),g.current.dispatchEvent(e)}),[]),Object(n.useEffect)((()=>(!0===h?x():"string"==typeof p&&""===p.trim()&&!0===b&&s({jobIdExists:!1}),()=>{x.cancel()})),[p]),Object(N.jsx)(te.EuiForm,{className:"mlDataFrameAnalyticsCreateForm"},Object(N.jsx)(te.EuiFormRow,{label:y.i18n.translate("xpack.ml.dataframe.analytics.create.advancedEditor.jobIdLabel",{defaultMessage:"Analytics job ID"}),isInvalid:!m&&!h||b,error:[...m||h?[]:[y.i18n.translate("xpack.ml.dataframe.analytics.create.advancedEditor.jobIdInvalidError",{defaultMessage:"Must contain lowercase alphanumeric characters (a-z and 0-9), hyphens, and underscores only and must start and end with alphanumeric characters."})],...b?[y.i18n.translate("xpack.ml.dataframe.analytics.create.advancedEditor.jobIdExistsError",{defaultMessage:"An analytics job with this ID already exists."})]:[]]},Object(N.jsx)(te.EuiFieldText,{inputRef:e=>{e&&(g.current=e)},disabled:l,placeholder:"analytics job ID",value:p,onChange:e=>s({jobId:e.target.value}),"aria-label":y.i18n.translate("xpack.ml.dataframe.analytics.create.advancedEditor.jobIdInputAriaLabel",{defaultMessage:"Choose a unique analytics job ID."}),isInvalid:!m&&!h||b})),Object(N.jsx)(te.EuiFormRow,{label:y.i18n.translate("xpack.ml.dataframe.analytics.create.advancedEditor.configRequestBody",{defaultMessage:"Configuration request body"}),style:{maxWidth:"100%"}},Object(N.jsx)(c.CodeEditor,{languageId:"json",height:500,languageConfiguration:{autoClosingPairs:[{open:"{",close:"}"}]},value:o,onChange:e=>{i(e)},options:{ariaLabel:y.i18n.translate("xpack.ml.dataframe.analytics.create.advancedEditor.codeEditorAriaLabel",{defaultMessage:"Advanced analytics job editor"}),automaticLayout:!0,readOnly:l,fontSize:12,scrollBeyondLastLine:!1,quickSuggestions:!0,minimap:{enabled:!1},wordWrap:"on",wrappingIndent:"indent"}})),Object(N.jsx)(te.EuiSpacer,null),r.map(((e,t)=>Object(N.jsx)(n.Fragment,{key:t},Object(N.jsx)(te.EuiCallOut,{title:""!==e.message?e.message:e.error,color:void 0!==e.error?"danger":"primary",iconType:void 0!==e.error?"alert":"checkInCircleFilled",size:"s"},""!==e.message&&void 0!==e.error?Object(N.jsx)("p",null,e.error):null),Object(N.jsx)(te.EuiSpacer,null)))),!l&&Object(N.jsx)(n.Fragment,null,Object(N.jsx)(te.EuiFormRow,{isInvalid:d&&u,error:d&&u&&[y.i18n.translate("xpack.ml.dataframe.analytics.create.indexPatternAlreadyExistsError",{defaultMessage:"An index pattern with this title already exists."})]},Object(N.jsx)(te.EuiSwitch,{disabled:l,name:"mlDataFrameAnalyticsCreateIndexPattern",label:y.i18n.translate("xpack.ml.dataframe.analytics.create.createIndexPatternLabel",{defaultMessage:"Create index pattern"}),checked:!0===d,onChange:()=>s({createIndexPattern:!d})}))),Object(N.jsx)(te.EuiSpacer,null),Object(N.jsx)(jc,v()({},e,{step:kd.CREATE})))},vc=({setCurrentStep:e,state:t})=>{const a=Object(g.b)(),{currentIndexPattern:i}=a,{form:s,isJobCreated:r}=t,{dependentVariable:o,includes:l,jobConfigQueryString:c,jobType:d,trainingPercent:u}=s,p=d===ul.b.REGRESSION||d===ul.b.CLASSIFICATION,m=[{title:y.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.sourceIndex",{defaultMessage:"Source index"}),description:i.title||pc.c},{title:y.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.Query",{defaultMessage:"Query"}),description:c||pc.c}],b=[{title:y.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.jobType",{defaultMessage:"Job type"}),description:d}],h=[{title:y.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.includedFields",{defaultMessage:"Included fields"}),description:l.length>5?y.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.includedFieldsAndMoreDescription",{defaultMessage:"{includedFields} ... (and {extraCount} more)",values:{extraCount:l.length-5,includedFields:l.slice(0,5).join(", ")}}):l.join(", ")}];return p&&(b.push({title:y.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.trainingPercent",{defaultMessage:"Training percent"}),description:`${u}`}),h.unshift({title:y.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.dependentVariable",{defaultMessage:"Dependent variable"}),description:o})),Object(N.jsx)(n.Fragment,null,Object(N.jsx)(te.EuiFlexGroup,{style:{width:"70%"},justifyContent:"spaceBetween"},Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiDescriptionList,{compressed:!0,listItems:m})),Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiDescriptionList,{compressed:!0,listItems:b})),Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiDescriptionList,{compressed:!0,listItems:h}))),Object(N.jsx)(te.EuiSpacer,null),!r&&Object(N.jsx)(te.EuiButtonEmpty,{iconType:"pencil",size:"s",onClick:()=>{e(kd.CONFIGURATION)}},y.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.editButtonText",{defaultMessage:"Edit"})))};var yc=a(199);const Oc=new Set(["ip","keyword"]),Ec=(e,t,a)=>{if(e===Tt.a)return!1;const i=fo.a.has(t),n=i||Oc.has(t)||t===_.ES_FIELD_TYPES.BOOLEAN;return a===ul.b.REGRESSION?i||fo.b.has(t):a===ul.b.CLASSIFICATION?n:void 0},wc=(e,t,a)=>{let i,n,s,r;return a===ul.b.CLASSIFICATION&&(e.includes("must have at most")||e.includes("must have at least"))?i=e:e.includes("status_exception")&&e.includes("unsupported type")?n=e:e.includes("status_exception")&&e.includes("Unable to estimate memory usage as no documents")?s=y.i18n.translate("xpack.ml.dataframe.analytics.create.allDocsMissingFieldsErrorMessage",{defaultMessage:"Unable to estimate memory usage. There are mapped fields for source index [{index}] that do not exist in any indexed documents. You will have to switch to the JSON editor for explicit field selection and include only fields that exist in indexed documents.",values:{index:t}}):r={title:y.i18n.translate("xpack.ml.dataframe.analytics.create.unableToFetchExplainDataMessage",{defaultMessage:"An error occurred fetching analysis fields data."}),text:e},{maxDistinctValuesErrorMessage:i,unsupportedFieldsErrorMessage:n,toastNotificationDanger:r,toastNotificationWarning:s}},_c=y.i18n.translate("xpack.ml.dataframe.analytics.creation.continueButtonText",{defaultMessage:"Continue"}),Sc=({isDisabled:e,onClick:t})=>Object(N.jsx)(te.EuiFlexGroup,null,Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiButton,{"data-test-subj":"mlAnalyticsCreateJobWizardContinueButton",isDisabled:e,size:"s",onClick:t},_c))),Mc={[nl.a.OUTLIER_DETECTION]:{helpText:y.i18n.translate("xpack.ml.dataframe.analytics.create.outlierDetectionHelpText",{defaultMessage:"Outlier detection identifies unusual data points in the data set."}),icon:"outlierDetectionJob",title:y.i18n.translate("xpack.ml.dataframe.analytics.create.outlierDetectionTitle",{defaultMessage:"Outlier detection"})},[nl.a.REGRESSION]:{helpText:y.i18n.translate("xpack.ml.dataframe.analytics.create.regressionHelpText",{defaultMessage:"Regression predicts numerical values in the data set."}),icon:"regressionJob",title:y.i18n.translate("xpack.ml.dataframe.analytics.create.regressionTitle",{defaultMessage:"Regression"})},[nl.a.CLASSIFICATION]:{helpText:y.i18n.translate("xpack.ml.dataframe.analytics.create.classificationHelpText",{defaultMessage:"Classification predicts classes of data points in the data set."}),icon:"classificationJob",title:y.i18n.translate("xpack.ml.dataframe.analytics.create.classificationTitle",{defaultMessage:"Classification"})}},kc=({type:e,setFormState:t})=>{const[a,i]=Object(n.useState)({});return Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(te.EuiFlexGroup,{gutterSize:"m","data-test-subj":"mlAnalyticsCreateJobWizardJobTypeSelect"},Object.keys(Mc).map((n=>Object(N.jsx)(te.EuiFlexItem,{key:n,grow:1},Object(N.jsx)(te.EuiCard,{icon:Object(N.jsx)(te.EuiIcon,{size:"xl",type:Mc[n].icon}),title:Mc[n].title,description:Mc[n].helpText,"data-test-subj":`mlAnalyticsCreation-${n}-option${e===n?" selectedJobType":""}`,selectable:{onClick:()=>{!0!==a[n]&&(t({previousJobType:e,jobType:n,requiredFieldsError:void 0}),i({[n]:!a[n]}))},isSelected:!0===a[n]||e===n}}))))),Object(N.jsx)(te.EuiSpacer,{size:"m"}))},Cc={[ul.b.CLASSIFICATION]:({name:e,type:t})=>!Ct.c.includes(e)&&e!==Tt.a&&(fo.a.has(t)||Oc.has(t)||t===_.ES_FIELD_TYPES.BOOLEAN),[ul.b.REGRESSION]:({name:e,type:t})=>!Ct.c.includes(e)&&e!==Tt.a&&(fo.a.has(t)||fo.b.has(t)),[ul.b.OUTLIER_DETECTION]:({name:e,type:t})=>!Ct.c.includes(e)&&e!==Tt.a&&(fo.a.has(t)||fo.b.has(t))},Tc={[ul.b.CLASSIFICATION]:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.dataframe.analytics.create.sourceObjectClassificationHelpText",defaultMessage:"This index pattern does not contain any supported fields. Classification jobs require categorical, numeric, or boolean fields."}),[ul.b.REGRESSION]:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.dataframe.analytics.create.sourceObjectRegressionHelpText",defaultMessage:"This index pattern does not contain any supported fields. Regression jobs require numeric fields."}),[ul.b.OUTLIER_DETECTION]:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.dataframe.analytics.create.sourceObjectHelpText",defaultMessage:"This index pattern does not contain any numeric type fields. The analytics job may not be able to come up with any outliers."})},Fc=({jobType:e})=>{const[t,a]=Object(n.useState)(!0),[i,s]=Object(n.useState)(!1),{fields:r}=ks.a;return Object(n.useEffect)((()=>{void 0!==e&&(()=>{if(r&&void 0!==e)try{const t=r.some(Cc[e]);a(t),s(!1)}catch(e){s(!0)}})()}),[e]),!0===t?null:!0===i?Object(N.jsx)(n.Fragment,null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.dataframe.analytics.create.sourceIndexFieldsCheckError",defaultMessage:"There was a problem checking for supported fields for job type. Please refresh the page and try again."}),Object(N.jsx)(te.EuiSpacer,{size:"s"})):Object(N.jsx)(n.Fragment,null,Object(N.jsx)(te.EuiText,{size:"xs",color:"danger"},void 0!==e&&Tc[e]),Object(N.jsx)(te.EuiSpacer,{size:"s"}))};var Ic=a(54),Dc=a(363);const Ac=y.i18n.translate("xpack.ml.dataframe.analytics.create.analysisFieldsTable.minimumFieldsMessage",{defaultMessage:"At least one field must be selected."}),Lc=[{id:"checkbox",isCheckbox:!0,textOnly:!1,width:"32px"},{label:y.i18n.translate("xpack.ml.dataframe.analytics.create.analysisFieldsTable.fieldNameColumn",{defaultMessage:"Field name"}),id:"name",isSortable:!0,alignment:Ic.LEFT_ALIGNMENT},{id:"mapping_types",label:y.i18n.translate("xpack.ml.dataframe.analytics.create.analyticsTable.mappingColumn",{defaultMessage:"Mapping"}),isSortable:!1,alignment:Ic.LEFT_ALIGNMENT},{label:y.i18n.translate("xpack.ml.dataframe.analytics.create.analyticsTable.isIncludedColumn",{defaultMessage:"Is included"}),id:"is_included",alignment:Ic.LEFT_ALIGNMENT,isSortable:!0,render:({is_included:e})=>e?"Yes":"No"},{label:y.i18n.translate("xpack.ml.dataframe.analytics.create.analyticsTable.isRequiredColumn",{defaultMessage:"Is required"}),id:"is_required",alignment:Ic.LEFT_ALIGNMENT,isSortable:!0,render:({is_required:e})=>e?"Yes":"No"},{label:y.i18n.translate("xpack.ml.dataframe.analytics.create.analyticsTable.reasonColumn",{defaultMessage:"Reason"}),id:"reason",alignment:Ic.LEFT_ALIGNMENT,isSortable:!1}],Rc=e=>!0===e.is_required||e.reason&&e.reason.includes("unsupported type"),Pc=s.a.memo((({dependentVariable:e,includes:t,isJobTypeWithDepVar:a,setFormState:i,minimumFieldsRequiredMessage:s,setMinimumFieldsRequiredMessage:r,tableItems:o,unsupportedFieldsError:l,setUnsupportedFieldsError:c})=>{const[d,u]=Object(n.useState)(),[p,m]=Object(n.useState)({pageIndex:0,itemsPerPage:5});Object(n.useEffect)((()=>{if(0===t.length&&o.length>0){const e=[];o.forEach((t=>{!0===t.is_included&&e.push(t.name)})),i({includes:e})}else t.length>0&&i({includes:e&&t.includes(e)||!a?t:[...t,e]});r(void 0)}),[o]),Object(n.useEffect)((()=>{let e=[];e=[{name:"name",getValue:e=>e.name.toLowerCase(),isAscending:!0},{name:"is_included",getValue:e=>e.is_included,isAscending:!0},{name:"is_required",getValue:e=>e.is_required,isAscending:!0}];const t=new Ic.SortableProperties(e,"name");u(t)}),[]);const b=[{type:"field_value_toggle_group",field:"is_included",items:[{value:!0,name:y.i18n.translate("xpack.ml.dataframe.analytics.create.isIncludedOption",{defaultMessage:"Is included"})},{value:!1,name:y.i18n.translate("xpack.ml.dataframe.analytics.create.isNotIncludedOption",{defaultMessage:"Is not included"})}]}];return Object(N.jsx)(n.Fragment,null,Object(N.jsx)(te.EuiFormRow,{"data-test-subj":"mlAnalyticsCreateJobWizardIncludesTable",label:y.i18n.translate("xpack.ml.dataframe.analytics.create.includedFieldsLabel",{defaultMessage:"Included fields"}),fullWidth:!0,isInvalid:void 0!==s||void 0!==l,error:[...void 0!==s?[s]:[],...void 0!==l?[y.i18n.translate("xpack.ml.dataframe.analytics.create.unsupportedFieldsError",{defaultMessage:"Invalid. {message}",values:{message:l}})]:[]]},Object(N.jsx)(n.Fragment,null)),o.length>0&&void 0===s&&Object(N.jsx)(te.EuiText,{size:"xs"},y.i18n.translate("xpack.ml.dataframe.analytics.create.includedFieldsCount",{defaultMessage:"{numFields, plural, one {# field} other {# fields}} included in the analysis",values:{numFields:t.length}})),0===o.length&&Object(N.jsx)(te.EuiCallOut,{title:y.i18n.translate("xpack.ml.dataframe.analytics.create.calloutTitle",{defaultMessage:"Analysis fields not available"})},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.dataframe.analytics.create.calloutMessage",defaultMessage:"Additional data required to load analysis fields."})),o.length>0&&Object(N.jsx)(te.EuiPanel,{paddingSize:"m","data-test-subj":"mlAnalyticsCreateJobWizardIncludesSelect"},Object(N.jsx)(Dc.a,{currentPage:p.pageIndex,"data-test-subj":"mlAnalyticsCreationAnalysisFieldsTable",checkboxDisabledCheck:Rc,columns:Lc,filters:b,items:o,itemsPerPage:p.itemsPerPage,onTableChange:t=>{a&&void 0!==e&&""!==e&&0===t.length&&(t=[e]),0===t.length?(r(Ac),c(void 0)):(r(void 0),i({includes:t}))},selectedIds:t,setCurrentPaginationData:m,singleSelection:!1,sortableProperties:d,tableItemId:"name"})),Object(N.jsx)(te.EuiSpacer,null))}),((e,t)=>e.dependentVariable===t.dependentVariable&&Object(E.isEqual)(e.includes,t.includes)&&Object(E.isEqual)(e.tableItems,t.tableItems)&&e.unsupportedFieldsError===t.unsupportedFieldsError));function Nc(e){return Object.keys(e).map((t=>{const a=e[t],i=Object(vo.c)(a.type);return{id:t,schema:i,isExpandable:"boolean"!==i,isRuntimeFieldColumn:!0}}))}function zc(e,t){const{fields:a}=ks.a;return a.filter((e=>t.includes(e.name))).map((e=>{const t=Object(vo.c)(e.type)||Object(vo.d)(e);return{id:e.name,schema:t,isExpandable:"boolean"!==t,isRuntimeFieldColumn:!1}}))}function Bc(){const[e,t]=Object(n.useState)(void 0),[a,i]=Object(n.useState)(void 0),s=Object(g.b)(),{currentSavedSearch:r,currentIndexPattern:o,kibanaConfig:l}=s;return Object(n.useEffect)((()=>{(()=>{let e,a={};if(null!==r){const{query:n}=Object(O.f)(r),s=n.language;if(e=n.query,s===S.c.KUERY){const t=Object(w.d)(e);a=Object(w.f)(t,o)}else a=Object(w.e)(e),Object(w.c)(a,l.get("query:queryString:options"));t(a),i(e)}else t(null),i(null)})()}),[]),{savedSearchQuery:e,savedSearchQueryStr:a}}var Jc=a(209),Vc=a(59);const Uc=Object(n.memo)((({convertToJson:e,xJsonMode:t,setAdvancedRuntimeMappingsConfig:a,setIsRuntimeMappingsEditorApplyButtonEnabled:i,advancedEditorRuntimeMappingsLastApplied:n,advancedRuntimeMappingsConfig:s})=>Object(N.jsx)("div",{"data-test-subj":"mlDataFrameAnalyticsAdvancedRuntimeMappingsEditor"},Object(N.jsx)(c.CodeEditor,{height:250,languageId:"json",onChange:t=>{if(a(t),n!==t)if(""!==t)try{const a=JSON.parse(e(t));i(Object(xo.b)(a))}catch(e){i(!1)}else i(!0);else i(!1)},options:{ariaLabel:y.i18n.translate("xpack.ml.dataframe.analytics.createWizard.runtimeMappings.advancedEditorAriaLabel",{defaultMessage:"Advanced runtime editor"}),automaticLayout:!0,fontSize:12,scrollBeyondLastLine:!1,quickSuggestions:!0,minimap:{enabled:!1},wordWrap:"on",wrappingIndent:"indent"},value:s}))),((e,t)=>Object(E.isEqual)(Gc(e),Gc(t))));function Gc(e){return[e.advancedEditorRuntimeMappingsLastApplied,e.advancedRuntimeMappingsConfig]}const qc=y.i18n.translate("xpack.ml.dataframe.analytics.createWizard.runtimeEditorSwitchModalTitle",{defaultMessage:"Edits will be lost"}),Hc=y.i18n.translate("xpack.ml.dataframe.analytics.createWizard.runtimeEditorSwitchModalCancelButtonText",{defaultMessage:"Cancel"}),Wc=y.i18n.translate("xpack.ml.dataframe.analytics.createWizard.runtimeEditorSwitchModalConfirmButtonText",{defaultMessage:"Close editor"}),$c=y.i18n.translate("xpack.ml.dataframe.analytics.createWizard.runtimeEditorSwitchModalBodyText",{defaultMessage:"The changes in the editor haven't been applied yet. By closing the editor you will lose your edits."}),Yc=({onCancel:e,onConfirm:t})=>Object(N.jsx)(te.EuiConfirmModal,{title:qc,onCancel:e,onConfirm:t,cancelButtonText:Hc,confirmButtonText:Wc,buttonColor:"danger",defaultFocusedButton:"confirm"},Object(N.jsx)("p",null,$c)),Xc="220px",Qc=y.i18n.translate("xpack.ml.dataframe.analytics.createWizard.indexPreview.copyRuntimeMappingsClipboardTooltip",{defaultMessage:"Copy Dev Console statement of the runtime fields to the clipboard."}),Kc=y.i18n.translate("xpack.ml.dataframe.analytics.createWizard.advancedSourceEditorApplyButtonText",{defaultMessage:"Apply changes"}),Zc=y.i18n.translate("xpack.ml.dataframe.analytics.createWizard.advancedRuntimeFieldsEditorHelpText",{defaultMessage:"The advanced editor allows you to edit the runtime fields of the source."}),ed=y.i18n.translate("xpack.ml.dataframe.analytics.createWizard.advancedEditorRuntimeFieldsSwitchLabel",{defaultMessage:"Edit runtime fields"}),td=y.i18n.translate("xpack.ml.dataframe.analytics.createWizard.runtimeFieldsLabel",{defaultMessage:"Runtime fields"}),{useXJsonMode:ad}=Vc.XJson,id=new Jc.XJsonMode,nd=({actions:e,state:t})=>{const[a,i]=Object(n.useState)(!1),[r,o]=Object(n.useState)(!1),[l,c]=Object(n.useState)(!1),[d,u]=Object(n.useState)(),{setFormState:p}=e,{jobType:m,previousRuntimeMapping:b,runtimeMappings:h}=t.form,{convertToJson:f,setXJson:j,xJson:x}=ad(h||""),v=Object(g.b)(),{currentIndexPattern:y}=v,O=(e=!1)=>{!0===e&&(p({runtimeMappingsUpdated:!1}),j(null!=d?d:"")),i(!a),c(Object(jo.isRuntimeMappings)(h))};return Object(n.useEffect)((function(){const e=Object(ol.f)(y,h),t=JSON.stringify(e,null,2);e&&(j(t),u(t),p({runtimeMappings:e}))}),[]),Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(te.EuiSpacer,{size:"s"}),Object(N.jsx)(te.EuiFormRow,{fullWidth:!0,label:td},Object(N.jsx)(te.EuiFlexGroup,{alignItems:"baseline",justifyContent:"spaceBetween"},Object(N.jsx)(te.EuiFlexItem,{grow:!0},Object(Qe.b)(h)?Object(N.jsx)(te.EuiText,{size:"s",grow:!1},Object.keys(h).join(",")):Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.dataframe.analytics.createWizard.noRuntimeFieldLabel",defaultMessage:"No runtime field"}),a&&Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(te.EuiSpacer,{size:"s"}),Object(N.jsx)(Uc,{advancedEditorRuntimeMappingsLastApplied:d,advancedRuntimeMappingsConfig:x,setIsRuntimeMappingsEditorApplyButtonEnabled:c,setAdvancedRuntimeMappingsConfig:j,convertToJson:f,xJsonMode:id}))),Object(N.jsx)(te.EuiFlexItem,{grow:!1,style:{width:Xc}},Object(N.jsx)(te.EuiFlexGroup,{gutterSize:"xs",direction:"column",justifyContent:"spaceBetween"},Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiFlexGroup,{alignItems:"center",justifyContent:"spaceBetween"},Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiSwitch,{disabled:void 0===m,label:ed,checked:a,onChange:()=>{a&&x!==d?o(!0):O()},"data-test-subj":"mlDataFrameAnalyticsRuntimeMappingsEditorSwitch"}),r&&Object(N.jsx)(Yc,{onCancel:()=>o(!1),onConfirm:()=>{o(!1),O(!0)}})),Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiCopy,{beforeMessage:Qc,textToCopy:null!=x?x:""},(e=>Object(N.jsx)(te.EuiButtonIcon,{onClick:e,iconType:"copyClipboard","aria-label":Qc})))))),a&&Object(N.jsx)(te.EuiFlexItem,{style:{width:Xc}},Object(N.jsx)(te.EuiSpacer,{size:"s"}),Object(N.jsx)(te.EuiText,{size:"xs"},Zc),Object(N.jsx)(te.EuiSpacer,{size:"s"}),Object(N.jsx)(te.EuiButton,{style:{width:"fit-content"},size:"s",fill:!0,onClick:()=>{const e=""===x,t=e?void 0:JSON.parse(x),a=e?"":JSON.stringify(t,null,2);p({runtimeMappings:t,runtimeMappingsUpdated:!0,previousRuntimeMapping:void 0===b&&void 0===h?t:h}),j(a),u(a),c(!1)},disabled:!l,"data-test-subj":"mlDataFrameAnalyticsRuntimeMappingsApplyButton"},Kc)))))),Object(N.jsx)(te.EuiSpacer,{size:"s"}))},sd="runtime_mapping",rd=y.i18n.translate("xpack.ml.dataframe.analytics.createWizard.requiredFieldsErrorMessage",{defaultMessage:"At least one field must be included in the analysis in addition to the dependent variable."});function od(e,t){const a=[];return Object.keys(t).forEach((i=>{const n=t[i];Object(xo.a)(n)&&Ec(i,n.type,e)&&a.push({label:i})})),a}const ld=({actions:e,isClone:t,state:a,setCurrentStep:i})=>{const r=Object(g.b)(),{currentSavedSearch:o,currentIndexPattern:l}=r,{savedSearchQuery:c,savedSearchQueryStr:u}=Bc(),[p,m]=Object(n.useState)(!1),[b,h]=Object(n.useState)(!1),[f,j]=Object(n.useState)(!1),[x,v]=Object(n.useState)([]),[O,w]=Object(n.useState)([]),[_,M]=Object(n.useState)(!1),[k,C]=Object(n.useState)(),[T,F]=Object(n.useState)(),[I,D]=Object(n.useState)(!1),[A,L]=Object(n.useState)(),{setEstimatedModelMemoryLimit:R,setFormState:P}=e,{cloneJob:z,estimatedModelMemoryLimit:B,form:J,isJobCreated:V,requestMessages:U}=a,G=Object(n.useRef)(!0),{dependentVariable:q,includes:H,jobConfigQuery:W,jobConfigQueryLanguage:$,jobConfigQueryString:Y,jobType:X,modelMemoryLimit:Q,previousJobType:K,requiredFieldsError:Z,runtimeMappings:ee,previousRuntimeMapping:ae,runtimeMappingsUpdated:ie,sourceIndex:ne,trainingPercent:se,useEstimatedMml:re}=J,oe=X===ul.b.REGRESSION||X===ul.b.CLASSIFICATION,le=oe&&""===q,ce=void 0!==X,de=oe&&""!==q||X===ul.b.OUTLIER_DETECTION,[ue,pe]=Object(n.useState)({query:null!=Y?Y:"",language:null!=$?$:S.c.KUERY}),me=Object(d.k)(),be=((e,t,a,i)=>{const[s,r]=Object(n.useState)();Object(n.useEffect)((()=>{!async function(){m(""),f(ul.d.LOADING);const t={index:e.title,body:{fields:["*"],_source:!1,query:{function_score:{query:{match_all:{}},random_score:{}}},size:500}};try{const a=(await ge.ml.esSearch(t)).hits.hits.map((e=>{var t;return Object(vo.h)(null!==(t=e.fields)&&void 0!==t?t:{})})),i=Object(vo.g)(e),n=[...new Set(a.map(Object.keys).flat(1))].filter((e=>i.includes(e))).sort();f(ul.d.LOADED),r(n)}catch(e){m(Object(ze.b)(e)),f(ul.d.ERROR)}}()}),[]);const o=Object(n.useMemo)((()=>Object(vo.b)(e,i)),[e,i]),[l,c]=Object(n.useState)([]);Object(n.useEffect)((()=>{Array.isArray(s)&&c([...zc(0,s),...o?Nc(o):[]])}),[e,s,o]);const d=Object(vo.k)(l),{pagination:u,resetPagination:p,setErrorMessage:m,setRowCount:b,setRowCountRelation:h,setStatus:f,setTableItems:g,sortingColumns:j,tableItems:x}=d;Object(n.useEffect)((()=>{p()}),[JSON.stringify(t)]),Object(n.useEffect)((()=>{void 0!==s&&void 0!==t&&async function(){m(""),f(ul.d.LOADING);const a=j.reduce(((e,t)=>(e[t.id]={order:t.direction},e)),{}),i={index:e.title,body:{query:t,from:u.pageIndex*u.pageSize,size:u.pageSize,fields:[...null!=s?s:[],...Object(xo.b)(o)?Object.keys(o):[]],_source:!1,...Object.keys(a).length>0?{sort:a}:{},...Object(xo.b)(o)?{runtime_mappings:o}:{}}};try{const e=await ge.ml.esSearch(i),t=e.hits.hits.map((e=>{var t;return Object(vo.h)(null!==(t=e.fields)&&void 0!==t?t:{})}));b("number"==typeof e.hits.total?e.hits.total:e.hits.total.value),h("number"==typeof e.hits.total?"eq":e.hits.total.relation),g(t),f(ul.d.LOADED)}catch(e){m(Object(ze.b)(e)),f(ul.d.ERROR)}}()}),[e.title,s,JSON.stringify([t,u,j,o])]);const v=Object(n.useMemo)((()=>new data_loader_DataLoader(e,a)),[e]);Object(n.useEffect)((()=>{d.chartsVisible&&void 0!==t&&async function(e){try{const t=await v.loadFieldHistograms(l.filter((e=>d.visibleColumns.includes(e.id))).map((e=>({fieldName:e.id,type:Object(vo.f)(e.schema)}))),e,il.a,o);d.setColumnCharts(t)}catch(e){Object(vo.j)(e,a)}}(t)}),[d.chartsVisible,e.title,JSON.stringify([t,d.visibleColumns,i])]);const y=Object(vo.l)(e,u,x);return{...d,indexPatternFields:s,renderCellValue:y}})(l,function(e,t){if(void 0!==e)return null!==e?e:t}(c,W),me,ee),he={...be,dataTestSubj:"mlAnalyticsCreationDataGrid",toastNotifications:me},fe=le||void 0===X||void 0!==k||void 0!==A||void 0!==Z||void 0!==T||_,je=Object(E.debounce)((async()=>{M(!0);const e=K!==X,t=!(G.current&&Q||!0!==re),a=!G.current||!Q||""===B;G.current&&(G.current=!1);const i=oe&&H.length>0&&!1===H.includes(q),n=i&&ee&&Object.keys(ee).includes(q);let s=J;(n||i)&&(s=Object(E.cloneDeep)(J),s.includes=[...H,q]);const{success:r,expectedMemory:o,fieldSelection:l,errorMessage:c,noDocsContainMappedFields:d}=await mc(s);if(r){a&&R(o);const r=l.some((e=>!0===e.is_included&&!1===e.is_required)),c={...t?{modelMemoryLimit:o}:{},...n||e||i?{includes:s.includes}:{},requiredFieldsError:r?void 0:rd};e&&(m(!1),C(void 0),F(void 0),D(!1),w(l||[])),P(c),M(!1)}else{const{maxDistinctValuesErrorMessage:e,unsupportedFieldsErrorMessage:a,toastNotificationDanger:i,toastNotificationWarning:n}=wc(c,ne,X);i&&me.addDanger(i),n&&me.addWarning(n);const s=void 0!==X?pc.a[X]:pc.a.outlier_detection;R(s),m(!0),C(e),F(a),D(d),M(!1),P({...t?{modelMemoryLimit:s}:{}})}}),300);Object(n.useEffect)((()=>{P({sourceIndex:l.title})}),[]);const xe=Object(n.useMemo)((()=>void 0!==(null==be?void 0:be.indexPatternFields)?be.indexPatternFields.map((e=>({name:e,is_included:!1,is_required:!1}))):[]),[`${null==be?void 0:be.indexPatternFields}`]);Object(n.useEffect)((()=>{"string"==typeof u&&P({jobConfigQuery:c,jobConfigQueryString:u})}),[JSON.stringify(c),u]),Object(n.useEffect)((()=>{if(oe){const e=Object(ol.f)(l);let t;e&&(t=od(X,e)),(async(e,t=[])=>{h(!0),C(void 0);try{if(void 0!==l){const a=[];let i=e.dependentVariable;const{fields:n}=ks.a;let s=!0;for(const t of n)Ec(t.id,t.type,X)&&(a.push({label:t.id}),e.dependentVariable===t.id&&(s=!1));Object(xo.b)(e.runtimeMappings)&&Object.keys(e.runtimeMappings).includes(J.dependentVariable)&&(s=!1,a.push({label:J.dependentVariable,key:`runtime_mapping_${J.dependentVariable}`})),s&&(i=""),v([...t,...a]),h(!1),j(!1),P({dependentVariable:i})}}catch(e){h(!1),j(!0)}})(J,t)}}),[X]);const ve=Object(n.useCallback)((async()=>{if(ie){let e=!1;if(oe){const t=x.filter((t=>{var a,i;return t.label===q&&null!==(a=t.key)&&void 0!==a&&a.includes(sd)&&(e=!0),!(null!==(i=t.key)&&void 0!==i&&i.includes(sd))}));if(void 0===ee&&!0===ie)v(t);else if(ee){const e=od(X,ee);v([...t,...e])}}const t=H.filter((e=>!(ae&&ae[e])));if(e&&(P({dependentVariable:"",includes:t}),w(O.filter((({name:e})=>!(ae&&ae[e]))))),!e&&ce&&de){const e=Object(E.cloneDeep)(J),a=oe&&ee&&Object.keys(ee).includes(q)&&e.includes.length>0&&!1===e.includes.includes(q);e.includes=a?[...t,q]:t;const{success:i,fieldSelection:n,errorMessage:s,noDocsContainMappedFields:r}=await mc(e);if(i){const e=n.some((e=>!0===e.is_included&&!1===e.is_required));let a;Object(xo.b)(ee)&&(a=n.map((e=>{var a;return void 0!==ee[e.name]&&!1===e.is_included&&null!==(a=e.reason)&&void 0!==a&&a.includes("field not in includes list")&&(t.push(e.name),e.is_included=!0),e}))),w(a||n),C(void 0),F(void 0),D(r),P({includes:t,requiredFieldsError:e?void 0:rd})}else{const{maxDistinctValuesErrorMessage:e,unsupportedFieldsErrorMessage:t,toastNotificationDanger:a,toastNotificationWarning:i}=wc(s,ne,X);a&&me.addDanger(a),i&&me.addWarning(i),C(e),F(t),D(r)}}}}),[JSON.stringify(ee)]);Object(n.useEffect)((()=>{ve()}),[JSON.stringify(ee)]),Object(n.useEffect)((()=>(ce&&de&&je(),()=>{je.cancel()})),[X,q,se,JSON.stringify(H),Y]);const ye=Object(n.useMemo)((()=>({color:oe?q:void 0,fields:O.filter((e=>"numerical"===e.feature_type&&e.is_included)).map((e=>e.name)),index:l.title,legendType:Object(yc.a)(X),searchQuery:W,runtimeMappings:ee,indexPattern:l})),[l.title,q,O,oe,W,X]),Oe=Object(n.useMemo)((()=>(X===ul.b.OUTLIER_DETECTION||oe&&!le)&&ye.fields.length>1),[le,X,ye.fields.length]);if(void 0===c)return null;const Ee=O.length>0&&!I?O:xe;return Object(N.jsx)(n.Fragment,null,Object(N.jsx)(uc,{messages:U}),Object(N.jsx)(Fc,{jobType:X}),Object(N.jsx)(kc,{type:X,setFormState:P}),null===c&&Object(N.jsx)(te.EuiFormRow,{label:y.i18n.translate("xpack.ml.dataframe.analytics.create.sourceQueryLabel",{defaultMessage:"Query"}),fullWidth:!0},Object(N.jsx)(el,{indexPattern:l,setSearchQuery:e=>{e.query&&P({jobConfigQuery:e.query,jobConfigQueryLanguage:e.language,jobConfigQueryString:e.queryString}),pe({query:e.queryString,language:e.language})},query:ue})),(t&&z||!t)&&Object(N.jsx)(nd,{actions:e,state:a}),Object(N.jsx)(te.EuiFormRow,{label:Object(N.jsx)(n.Fragment,null,null!==c&&Object(N.jsx)(te.EuiText,null,y.i18n.translate("xpack.ml.dataframe.analytics.create.savedSearchLabel",{defaultMessage:"Saved search"})),Object(N.jsx)(te.EuiBadge,{color:"hollow"},null!==c?null==o?void 0:o.attributes.title:l.title)),fullWidth:!0},Object(N.jsx)(vo.a,he)),oe&&Object(N.jsx)(n.Fragment,null,Object(N.jsx)(te.EuiFormRow,{fullWidth:!0,label:y.i18n.translate("xpack.ml.dataframe.analytics.create.dependentVariableLabel",{defaultMessage:"Dependent variable"}),helpText:0===x.length&&!1===f&&l&&y.i18n.translate("xpack.ml.dataframe.analytics.create.dependentVariableOptionsNoNumericalFields",{defaultMessage:"No numeric type fields were found for this index pattern."}),isInvalid:void 0!==k,error:[...!0===f?[Object(N.jsx)(n.Fragment,null,y.i18n.translate("xpack.ml.dataframe.analytics.create.dependentVariableOptionsFetchError",{defaultMessage:"There was a problem fetching fields. Please refresh the page and try again."}))]:[],...!0===p&&void 0!==k?[Object(N.jsx)(n.Fragment,null,y.i18n.translate("xpack.ml.dataframe.analytics.create.dependentVariableMaxDistictValuesError",{defaultMessage:"Invalid. {message}",values:{message:k}}))]:[]]},Object(N.jsx)(te.EuiComboBox,{fullWidth:!0,"aria-label":y.i18n.translate("xpack.ml.dataframe.analytics.create.dependentVariableInputAriaLabel",{defaultMessage:"Enter field to be used as dependent variable."}),placeholder:X===ul.b.REGRESSION?y.i18n.translate("xpack.ml.dataframe.analytics.create.dependentVariableRegressionPlaceholder",{defaultMessage:"Select the numeric field that you want to predict."}):y.i18n.translate("xpack.ml.dataframe.analytics.create.dependentVariableClassificationPlaceholder",{defaultMessage:"Select the numeric, categorical, or boolean field that you want to predict."}),isDisabled:V,isLoading:b,singleSelection:!0,options:x,selectedOptions:q?[{label:q}]:[],onChange:e=>{P({dependentVariable:e[0].label||""})},isClearable:!1,isInvalid:""===q,"data-test-subj":"mlAnalyticsCreateJobWizardDependentVariableSelect"+(b?" loading":" loaded")}))),Object(N.jsx)(Pc,{dependentVariable:q,includes:H,isJobTypeWithDepVar:oe,minimumFieldsRequiredMessage:A,setMinimumFieldsRequiredMessage:L,tableItems:G.current?O:Ee,unsupportedFieldsError:T,setUnsupportedFieldsError:F,setFormState:P}),Object(N.jsx)(te.EuiFormRow,{fullWidth:!0,isInvalid:void 0!==Z,error:y.i18n.translate("xpack.ml.dataframe.analytics.create.requiredFieldsError",{defaultMessage:"Invalid. {message}",values:{message:Z}})},Object(N.jsx)(n.Fragment,null)),Object(N.jsx)(te.EuiSpacer,null),Oe&&Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(te.EuiFormRow,{"data-test-subj":"mlAnalyticsCreateJobWizardScatterplotMatrixFormRow",label:y.i18n.translate("xpack.ml.dataframe.analytics.create.scatterplotMatrixLabel",{defaultMessage:"Scatterplot matrix"}),helpText:y.i18n.translate("xpack.ml.dataframe.analytics.create.scatterplotMatrixLabelHelpText",{defaultMessage:"Visualizes the relationships between pairs of selected included fields."}),fullWidth:!0},Object(N.jsx)(n.Fragment,null)),Object(N.jsx)(te.EuiPanel,{paddingSize:"m","data-test-subj":"mlAnalyticsCreateJobWizardScatterplotMatrixPanel"},Object(N.jsx)(Lo,ye)),Object(N.jsx)(te.EuiSpacer,null)),oe&&Object(N.jsx)(te.EuiFormRow,{fullWidth:!0,label:y.i18n.translate("xpack.ml.dataframe.analytics.create.trainingPercentLabel",{defaultMessage:"Training percent"}),helpText:y.i18n.translate("xpack.ml.dataframe.analytics.create.trainingPercentHelpText",{defaultMessage:"Defines the percentage of eligible documents that will be used for training."})},Object(N.jsx)(te.EuiRange,{fullWidth:!0,min:ul.k,max:ul.j,step:1,showLabels:!0,showRange:!0,showValue:!0,value:se,onChange:e=>P({trainingPercent:+e.target.value}),"data-test-subj":"mlAnalyticsCreateJobWizardTrainingPercentSlider"})),Object(N.jsx)(te.EuiSpacer,null),Object(N.jsx)(Sc,{isDisabled:fe,onClick:()=>{i(kd.ADVANCED)}}))},cd=({actions:e,state:t,setCurrentStep:a,step:i,stepActivated:n,isClone:s})=>{const r=i===kd.CONFIGURATION,o=i!==kd.CONFIGURATION&&!0===n,l=`mlAnalyticsCreateJobWizardConfigurationStep${r?" active":""}${o?" summary":""}`;return Object(N.jsx)(te.EuiForm,{className:"mlDataFrameAnalyticsCreateForm","data-test-subj":l},r&&Object(N.jsx)(ld,{actions:e,isClone:s,state:t,setCurrentStep:a}),o&&Object(N.jsx)(vc,{setCurrentStep:a,state:t}))},dd=({actions:e,state:t,advancedParamErrors:a})=>{const{setFormState:i}=e,{alpha:s,downsampleFactor:r,eta:o,etaGrowthRatePerTree:l,featureBagFraction:c,gamma:d,lambda:u,maxOptimizationRoundsPerHyperparameter:p,maxTrees:m,softTreeDepthLimit:b,softTreeDepthTolerance:h}=t.form;return Object(N.jsx)(n.Fragment,null,Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(te.EuiFormRow,{label:y.i18n.translate("xpack.ml.dataframe.analytics.create.lambdaLabel",{defaultMessage:"Lambda"}),helpText:y.i18n.translate("xpack.ml.dataframe.analytics.create.lambdaHelpText",{defaultMessage:"A multiplier of the leaf weights in loss calculations. Must be a nonnegative value."}),isInvalid:void 0!==a[ul.a.LAMBDA],error:a[ul.a.LAMBDA]},Object(N.jsx)(te.EuiFieldNumber,{"aria-label":y.i18n.translate("xpack.ml.dataframe.analytics.create.lambdaInputAriaLabel",{defaultMessage:"A multiplier of leaf weights in loss calculations."}),"data-test-subj":"mlAnalyticsCreateJobFlyoutLambdaInput",onChange:e=>i({lambda:""===e.target.value?void 0:+e.target.value}),step:.001,min:0,value:fd(u)}))),Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(te.EuiFormRow,{label:y.i18n.translate("xpack.ml.dataframe.analytics.create.maxTreesLabel",{defaultMessage:"Max trees"}),helpText:y.i18n.translate("xpack.ml.dataframe.analytics.create.maxTreesText",{defaultMessage:"The maximum number of decision trees in the forest."}),isInvalid:void 0!==a[ul.a.MAX_TREES],error:a[ul.a.MAX_TREES]},Object(N.jsx)(te.EuiFieldNumber,{"aria-label":y.i18n.translate("xpack.ml.dataframe.analytics.create.maxTreesInputAriaLabel",{defaultMessage:"The maximum number of decision trees in the forest."}),"data-test-subj":"mlAnalyticsCreateJobFlyoutMaxTreesInput",onChange:e=>i({maxTrees:""===e.target.value?void 0:+e.target.value}),isInvalid:void 0!==m&&!Number.isInteger(m),step:1,min:1,max:2e3,value:fd(m)}))),Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(te.EuiFormRow,{label:y.i18n.translate("xpack.ml.dataframe.analytics.create.gammaLabel",{defaultMessage:"Gamma"}),helpText:y.i18n.translate("xpack.ml.dataframe.analytics.create.gammaText",{defaultMessage:"A multiplier of the tree size in loss calcuations. Must be nonnegative value."}),isInvalid:void 0!==a[ul.a.GAMMA],error:a[ul.a.GAMMA]},Object(N.jsx)(te.EuiFieldNumber,{"aria-label":y.i18n.translate("xpack.ml.dataframe.analytics.create.gammaInputAriaLabel",{defaultMessage:"A multiplier of the tree size in loss calculations."}),"data-test-subj":"mlAnalyticsCreateJobWizardGammaInput",onChange:e=>i({gamma:""===e.target.value?void 0:+e.target.value}),step:.001,min:0,value:fd(d)}))),Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(te.EuiFormRow,{label:y.i18n.translate("xpack.ml.dataframe.analytics.create.etaLabel",{defaultMessage:"Eta"}),helpText:y.i18n.translate("xpack.ml.dataframe.analytics.create.etaText",{defaultMessage:"The shrinkage applied to the weights. Must be between 0.001 and 1."}),isInvalid:void 0!==a[ul.a.ETA],error:a[ul.a.ETA]},Object(N.jsx)(te.EuiFieldNumber,{"aria-label":y.i18n.translate("xpack.ml.dataframe.analytics.create.etaInputAriaLabel",{defaultMessage:"The shrinkage applied to the weights."}),"data-test-subj":"mlAnalyticsCreateJobWizardEtaInput",onChange:e=>i({eta:""===e.target.value?void 0:+e.target.value}),step:.001,min:.001,max:1,value:fd(o)}))),Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(te.EuiFormRow,{label:y.i18n.translate("xpack.ml.dataframe.analytics.create.featureBagFractionLabel",{defaultMessage:"Feature bag fraction"}),helpText:y.i18n.translate("xpack.ml.dataframe.analytics.create.featureBagFractionText",{defaultMessage:"The fraction of features used when selecting a random bag for each candidate split."}),isInvalid:void 0!==a[ul.a.FEATURE_BAG_FRACTION],error:a[ul.a.FEATURE_BAG_FRACTION]},Object(N.jsx)(te.EuiFieldNumber,{"aria-label":y.i18n.translate("xpack.ml.dataframe.analytics.create.featureBagFractionInputAriaLabel",{defaultMessage:"The fraction of features used when selecting a random bag for each candidate split"}),"data-test-subj":"mlAnalyticsCreateJobWizardFeatureBagFractionInput",onChange:e=>i({featureBagFraction:""===e.target.value?void 0:+e.target.value}),isInvalid:void 0!==c&&(c>1||c<=0),step:.001,max:1,value:fd(c)}))),Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(te.EuiFormRow,{label:y.i18n.translate("xpack.ml.dataframe.analytics.create.alphaLabel",{defaultMessage:"Alpha"}),helpText:y.i18n.translate("xpack.ml.dataframe.analytics.create.alphaText",{defaultMessage:"A multiplier of the tree depth in loss calculations. Must be greater than or equal to 0."}),isInvalid:void 0!==a[ul.a.ALPHA],error:a[ul.a.ALPHA]},Object(N.jsx)(te.EuiFieldNumber,{"aria-label":y.i18n.translate("xpack.ml.dataframe.analytics.create.alphaInputAriaLabel",{defaultMessage:"A multiplier of the tree depth in loss calculations."}),"data-test-subj":"mlAnalyticsCreateJobWizardAlphaInput",onChange:e=>i({alpha:""===e.target.value?void 0:+e.target.value}),step:.001,min:0,value:fd(s)}))),Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(te.EuiFormRow,{label:y.i18n.translate("xpack.ml.dataframe.analytics.create.downsampleFactorLabel",{defaultMessage:"Downsample factor"}),helpText:y.i18n.translate("xpack.ml.dataframe.analytics.create.downsampleFactorText",{defaultMessage:"The fraction of data used to compute derivatives of the loss function for tree training. Must be between 0 and 1."}),isInvalid:void 0!==a[ul.a.DOWNSAMPLE_FACTOR],error:a[ul.a.DOWNSAMPLE_FACTOR]},Object(N.jsx)(te.EuiFieldNumber,{"aria-label":y.i18n.translate("xpack.ml.dataframe.analytics.create.downsampleFactorInputAriaLabel",{defaultMessage:"The fraction of data used to compute derivatives of the loss function for tree training."}),"data-test-subj":"mlAnalyticsCreateJobWizardDownsampleFactorInput",onChange:e=>i({downsampleFactor:""===e.target.value?void 0:+e.target.value}),step:.001,min:0,max:1,value:fd(r)}))),Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(te.EuiFormRow,{label:y.i18n.translate("xpack.ml.dataframe.analytics.create.etaGrowthRatePerTreeLabel",{defaultMessage:"Eta growth rate per tree"}),helpText:y.i18n.translate("xpack.ml.dataframe.analytics.create.etaGrowthRatePerTreeText",{defaultMessage:"The rate at which eta increases for each new tree that is added to the forest. Must be between 0.5 and 2."}),isInvalid:void 0!==a[ul.a.ETA_GROWTH_RATE_PER_TREE],error:a[ul.a.ETA_GROWTH_RATE_PER_TREE]},Object(N.jsx)(te.EuiFieldNumber,{"aria-label":y.i18n.translate("xpack.ml.dataframe.analytics.create.etaGrowthRatePerTreeInputAriaLabel",{defaultMessage:"The rate at which eta increases for each new tree that is added to the forest."}),"data-test-subj":"mlAnalyticsCreateJobWizardEtaGrowthRatePerTreeInput",onChange:e=>i({etaGrowthRatePerTree:""===e.target.value?void 0:+e.target.value}),step:.001,min:.5,max:2,value:fd(l)}))),Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(te.EuiFormRow,{label:y.i18n.translate("xpack.ml.dataframe.analytics.create.maxOptimizationRoundsPerHyperparameterLabel",{defaultMessage:"Max optimization rounds per hyperparameter"}),helpText:y.i18n.translate("xpack.ml.dataframe.analytics.create.maxOptimizationRoundsPerHyperparameterText",{defaultMessage:"The maximum number of optimization rounds for each undefined hyperparameter."}),isInvalid:void 0!==a[ul.a.MAX_OPTIMIZATION_ROUNDS_PER_HYPERPARAMETER],error:a[ul.a.MAX_OPTIMIZATION_ROUNDS_PER_HYPERPARAMETER]},Object(N.jsx)(te.EuiFieldNumber,{"aria-label":y.i18n.translate("xpack.ml.dataframe.analytics.create.maxOptimizationRoundsPerHyperparameterInputAriaLabel",{defaultMessage:"The maximum number of optimization rounds for each undefined hyperparameter. Must be an integer between 0 and 20."}),"data-test-subj":"mlAnalyticsCreateJobWizardMaxOptimizationRoundsPerHyperparameterInput",onChange:e=>i({maxOptimizationRoundsPerHyperparameter:""===e.target.value?void 0:+e.target.value}),min:0,max:20,step:1,value:fd(p)}))),Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(te.EuiFormRow,{label:y.i18n.translate("xpack.ml.dataframe.analytics.create.softTreeDepthLimitLabel",{defaultMessage:"Soft tree depth limit"}),helpText:y.i18n.translate("xpack.ml.dataframe.analytics.create.softTreeDepthLimitText",{defaultMessage:"Decision trees that exceed this depth are penalized in loss calculations. Must be greater than or equal to 0. "}),isInvalid:void 0!==a[ul.a.SOFT_TREE_DEPTH_LIMIT],error:a[ul.a.SOFT_TREE_DEPTH_LIMIT]},Object(N.jsx)(te.EuiFieldNumber,{"aria-label":y.i18n.translate("xpack.ml.dataframe.analytics.create.softTreeDepthLimitInputAriaLabel",{defaultMessage:"Decision trees that exceed this depth are penalized in loss calculations."}),"data-test-subj":"mlAnalyticsCreateJobWizardSoftTreeDepthLimitInput",onChange:e=>i({softTreeDepthLimit:""===e.target.value?void 0:+e.target.value}),step:.001,min:0,value:fd(b)}))),Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(te.EuiFormRow,{label:y.i18n.translate("xpack.ml.dataframe.analytics.create.softTreeDepthToleranceLabel",{defaultMessage:"Soft tree depth tolerance"}),helpText:y.i18n.translate("xpack.ml.dataframe.analytics.create.softTreeDepthToleranceText",{defaultMessage:"Controls how quickly the loss increases when tree depths exceed soft limits. The smaller the value, the faster the loss increases. Must be greater than or equal to 0.01. "}),isInvalid:void 0!==a[ul.a.SOFT_TREE_DEPTH_TOLERANCE],error:a[ul.a.SOFT_TREE_DEPTH_TOLERANCE]},Object(N.jsx)(te.EuiFieldNumber,{"aria-label":y.i18n.translate("xpack.ml.dataframe.analytics.create.softTreeDepthToleranceInputAriaLabel",{defaultMessage:"Decision trees that exceed this depth are penalized in loss calculations."}),"data-test-subj":"mlAnalyticsCreateJobWizardSoftTreeDepthToleranceInput",onChange:e=>i({softTreeDepthTolerance:""===e.target.value?void 0:+e.target.value}),step:.001,min:.01,value:fd(h)}))))};var ud=a(285);const pd=({actions:e,state:t,advancedParamErrors:a})=>{const{setFormState:i}=e,{method:s,nNeighbors:r,outlierFraction:o,standardizationEnabled:l}=t.form;return Object(N.jsx)(n.Fragment,null,Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(te.EuiFormRow,{label:y.i18n.translate("xpack.ml.dataframe.analytics.create.methodLabel",{defaultMessage:"Method"}),helpText:y.i18n.translate("xpack.ml.dataframe.analytics.create.methodHelpText",{defaultMessage:"Sets the method that outlier detection uses. If not set, uses an ensemble of different methods, normalizes and combines their individual outlier scores to obtain the overall outlier score. It is recommended to use the ensemble method."}),isInvalid:void 0!==a[ul.a.METHOD],error:a[ul.a.METHOD]},Object(N.jsx)(te.EuiSelect,{options:Object.values(ul.f).map((e=>({value:e,text:e}))),value:s,hasNoInitialSelection:!0,onChange:e=>{i({method:e.target.value})},"data-test-subj":"mlAnalyticsCreateJobWizardMethodInput"}))),Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(te.EuiFormRow,{label:y.i18n.translate("xpack.ml.dataframe.analytics.create.nNeighborsLabel",{defaultMessage:"N neighbors"}),helpText:y.i18n.translate("xpack.ml.dataframe.analytics.create.nNeighborsHelpText",{defaultMessage:"The value for how many nearest neighbors each method of outlier detection uses to calculate its outlier score. When not set, different values are used for different ensemble members. Must be a positive integer."}),isInvalid:void 0!==a[ul.a.N_NEIGHBORS],error:a[ul.a.N_NEIGHBORS]},Object(N.jsx)(te.EuiFieldNumber,{"aria-label":y.i18n.translate("xpack.ml.dataframe.analytics.create.nNeighborsInputAriaLabel",{defaultMessage:"The value for how many nearest neighbors each method of outlier detection uses to calculate its outlier score."}),"data-test-subj":"mlAnalyticsCreateJobWizardnNeighborsInput",onChange:e=>i({nNeighbors:""===e.target.value?void 0:+e.target.value}),step:1,min:1,value:fd(r)}))),Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(te.EuiFormRow,{label:y.i18n.translate("xpack.ml.dataframe.analytics.create.outlierFractionLabel",{defaultMessage:"Outlier fraction"}),helpText:y.i18n.translate("xpack.ml.dataframe.analytics.create.outlierFractionHelpText",{defaultMessage:"Sets the proportion of the data set that is assumed to be outlying prior to outlier detection."}),isInvalid:void 0!==a[ul.a.OUTLIER_FRACTION],error:a[ul.a.OUTLIER_FRACTION]},Object(N.jsx)(te.EuiFieldNumber,{"aria-label":y.i18n.translate("xpack.ml.dataframe.analytics.create.outlierFractionInputAriaLabel",{defaultMessage:"Sets the proportion of the data set that is assumed to be outlying prior to outlier detection."}),"data-test-subj":"mlAnalyticsCreateJobWizardoutlierFractionInput",onChange:e=>i({outlierFraction:""===e.target.value?void 0:+e.target.value}),step:.001,min:0,max:1,value:fd(o)}))),Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(te.EuiFormRow,{label:y.i18n.translate("xpack.ml.dataframe.analytics.create.standardizationEnabledLabel",{defaultMessage:"Standardization enabled"}),helpText:y.i18n.translate("xpack.ml.dataframe.analytics.create.standardizationEnabledHelpText",{defaultMessage:"If true, the following operation is performed on the columns before computing outlier scores: (x_i - mean(x_i)) / sd(x_i)."})},Object(N.jsx)(te.EuiSelect,{"aria-label":y.i18n.translate("xpack.ml.dataframe.analytics.create.standardizationEnabledInputAriaLabel",{defaultMessage:"Sets standardization enabled setting."}),"data-test-subj":"mlAnalyticsCreateJobWizardStandardizationEnabledInput",options:[{value:"true",text:y.i18n.translate("xpack.ml.dataframe.analytics.create.standardizationEnabledTrueValue",{defaultMessage:"True"})},{value:"false",text:y.i18n.translate("xpack.ml.dataframe.analytics.create.standardizationEnabledFalseValue",{defaultMessage:"False"})}],value:l,hasNoInitialSelection:!0,onChange:e=>{i({standardizationEnabled:e.target.value})}}))))},md={label:y.i18n.translate("xpack.ml.dataframe.analytics.create.allClassesLabel",{defaultMessage:"All classes"}),value:-1},bd=Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.dataframe.analytics.create.numTopClassTypeWarning",defaultMessage:"Value must be an integer of -1 or greater, where -1 indicates all classes."});function hd(e){return-1===e?Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.dataframe.analytics.create.numTopClassesHelpText",defaultMessage:"The number of categories for which the predicted probabilities are reported."})," ",Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.dataframe.analytics.create.allClassesMessage",defaultMessage:"If you have a large number of classes there could be a significant effect on the size of your destination index."})):Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.dataframe.analytics.create.numTopClassesHelpText",defaultMessage:"The number of categories for which the predicted probabilities are reported."})}function fd(e){return void 0===e?"":+e}const gd=({actions:e,state:t,setCurrentStep:a})=>{var i;const[r,o]=Object(n.useState)({}),[l,c]=Object(n.useState)(!1),{services:{docLinks:d}}=Object(f.b)(),u=d.links.ml.classificationAucRoc,{setEstimatedModelMemoryLimit:p,setFormState:m}=e,{form:b,isJobCreated:h,estimatedModelMemoryLimit:g}=t,{alpha:j,computeFeatureInfluence:x,downsampleFactor:v,eta:O,etaGrowthRatePerTree:E,featureBagFraction:w,featureInfluenceThreshold:_,gamma:S,jobType:M,lambda:k,maxNumThreads:C,maxOptimizationRoundsPerHyperparameter:T,maxTrees:F,method:I,modelMemoryLimit:D,modelMemoryLimitValidationResult:A,nNeighbors:L,numTopClasses:R,numTopFeatureImportanceValues:P,numTopFeatureImportanceValuesValid:z,outlierFraction:B,predictionFieldName:J,randomizeSeed:V,softTreeDepthLimit:U,softTreeDepthTolerance:G,useEstimatedMml:q}=b,[H,W]=Object(n.useState)([md]),[$,Y]=Object(n.useState)(function(e){const t=[];return-1===e?t.push(md):void 0!==e&&t.push({label:`${e}`}),t}(R)),X=$[0]&&(null!==(i=$[0].value)&&void 0!==i?i:Number($[0].label)),Q=void 0!==(K=X)&&(isNaN(K)||K<-1||K-Math.floor(K)!=0);var K;const Z=Object(n.useMemo)((()=>Object(ud.a)(A)),[A]),ee=M===ul.b.REGRESSION||M===ul.b.CLASSIFICATION,ie=null!==A&&(void 0!==A.invalidUnits||!0===A.required),ne=Q||ie||Object.keys(r).length>0||!0===l||0===C;Object(n.useEffect)((()=>{c(!0),async function(){const{success:e,errorMessage:t,errorReason:a,expectedMemory:i}=await mc(b),n={};e?D!==i&&(p(i),!0===q&&m({modelMemoryLimit:i})):Object.values(ul.a).forEach((e=>{t.includes(`[${e}]`)?n[e]=t:null!=a&&a.includes(`[${e}]`)&&(n[e]=a)})),c(!1),o(n)}()}),[j,v,O,E,w,_,S,k,C,T,F,I,L,R,P,B,V,U,G]);const se=Object(N.jsx)(n.Fragment,null,Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(te.EuiFormRow,{label:y.i18n.translate("xpack.ml.dataframe.analytics.create.computeFeatureInfluenceLabel",{defaultMessage:"Compute feature influence"}),helpText:y.i18n.translate("xpack.ml.dataframe.analytics.create.computeFeatureInfluenceLabelHelpText",{defaultMessage:"Specifies whether the feature influence calculation is enabled. Defaults to true."})},Object(N.jsx)(te.EuiSelect,{"data-test-subj":"mlAnalyticsCreateJobWizardComputeFeatureInfluenceLabelInput",options:[{value:"true",text:y.i18n.translate("xpack.ml.dataframe.analytics.create.computeFeatureInfluenceTrueValue",{defaultMessage:"True"})},{value:"false",text:y.i18n.translate("xpack.ml.dataframe.analytics.create.computeFeatureInfluenceFalseValue",{defaultMessage:"False"})}],value:x,hasNoInitialSelection:!1,onChange:e=>{m({computeFeatureInfluence:e.target.value})}}))),Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(te.EuiFormRow,{label:y.i18n.translate("xpack.ml.dataframe.analytics.create.featureInfluenceThresholdLabel",{defaultMessage:"Feature influence threshold"}),helpText:y.i18n.translate("xpack.ml.dataframe.analytics.create.featureInfluenceThresholdHelpText",{defaultMessage:"The minimum outlier score that a document needs to have in order to calculate its feature influence score. Value range: 0-1. Defaults to 0.1."}),isInvalid:void 0!==r[ul.a.FEATURE_INFLUENCE_THRESHOLD],error:r[ul.a.FEATURE_INFLUENCE_THRESHOLD]},Object(N.jsx)(te.EuiFieldNumber,{onChange:e=>m({featureInfluenceThreshold:""===e.target.value?void 0:+e.target.value}),"data-test-subj":"mlAnalyticsCreateJobWizardFeatureInfluenceThresholdInput",min:0,max:1,step:.001,value:fd(_)})))),re=Object(N.jsx)(n.Fragment,null,Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(te.EuiFormRow,{label:y.i18n.translate("xpack.ml.dataframe.analytics.create.numTopFeatureImportanceValuesLabel",{defaultMessage:"Feature importance values"}),helpText:y.i18n.translate("xpack.ml.dataframe.analytics.create.numTopFeatureImportanceValuesHelpText",{defaultMessage:"Specify the maximum number of feature importance values per document to return."}),isInvalid:!1===z,error:[...!1===z?[Object(N.jsx)(n.Fragment,null,y.i18n.translate("xpack.ml.dataframe.analytics.create.numTopFeatureImportanceValuesErrorText",{defaultMessage:"Invalid maximum number of feature importance values."}))]:[]]},Object(N.jsx)(te.EuiFieldNumber,{"aria-label":y.i18n.translate("xpack.ml.dataframe.analytics.create.numTopFeatureImportanceValuesInputAriaLabel",{defaultMessage:"Maximum number of feature importance values per document."}),"data-test-subj":"mlAnalyticsCreateJobFlyoutnumTopFeatureImportanceValuesInput",isInvalid:!1===z,min:ul.e,onChange:e=>m({numTopFeatureImportanceValues:""===e.target.value?void 0:+e.target.value}),step:1,value:fd(P)}))),Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(te.EuiFormRow,{label:y.i18n.translate("xpack.ml.dataframe.analytics.create.predictionFieldNameLabel",{defaultMessage:"Prediction field name"}),helpText:y.i18n.translate("xpack.ml.dataframe.analytics.create.predictionFieldNameHelpText",{defaultMessage:"Defines the name of the prediction field in the results. Defaults to <dependent_variable>_prediction."})},Object(N.jsx)(te.EuiFieldText,{disabled:h,value:J,onChange:e=>m({predictionFieldName:e.target.value}),"data-test-subj":"mlAnalyticsCreateJobWizardPredictionFieldNameInput"}))),Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(te.EuiFormRow,{label:y.i18n.translate("xpack.ml.dataframe.analytics.create.randomizeSeedLabel",{defaultMessage:"Randomize seed"}),helpText:y.i18n.translate("xpack.ml.dataframe.analytics.create.randomizeSeedText",{defaultMessage:"The seed for the random generator used to pick training data."}),isInvalid:void 0!==r[ul.a.RANDOMIZE_SEED],error:r[ul.a.RANDOMIZE_SEED]},Object(N.jsx)(te.EuiFieldNumber,{"aria-label":y.i18n.translate("xpack.ml.dataframe.analytics.create.randomizeSeedInputAriaLabel",{defaultMessage:"The seed for the random generator used to pick training data."}),"data-test-subj":"mlAnalyticsCreateJobWizardRandomizeSeedInput",onChange:e=>m({randomizeSeed:""===e.target.value?void 0:+e.target.value}),isInvalid:void 0!==V&&"number"!=typeof V,value:fd(V),step:1}))));return Object(N.jsx)(n.Fragment,null,Object(N.jsx)(te.EuiTitle,{size:"xs"},Object(N.jsx)("h3",null,y.i18n.translate("xpack.ml.dataframe.analytics.create.advancedConfigSectionTitle",{defaultMessage:"Advanced configuration"}))),Object(N.jsx)(te.EuiFlexGrid,{columns:3},M===ul.b.OUTLIER_DETECTION&&se,ee&&re,M===ul.b.CLASSIFICATION&&Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(te.EuiFormRow,{label:y.i18n.translate("xpack.ml.dataframe.analytics.create.numTopClassesLabel",{defaultMessage:"Top classes"}),helpText:hd(X),isInvalid:0===X||Q,error:[...0===X?[(oe=u,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.dataframe.analytics.create.zeroClassesMessage",defaultMessage:"To evaluate the {wikiLink}, select all classes or a value greater than the total number of categories.",values:{wikiLink:Object(N.jsx)(te.EuiLink,{href:oe,target:"_blank",external:!0},y.i18n.translate("xpack.ml.dataframe.analytics.create.aucRocLabel",{defaultMessage:"AUC ROC"}))}}))]:[],...Q?[bd]:[]]},Object(N.jsx)(te.EuiComboBox,{"aria-label":y.i18n.translate("xpack.ml.dataframe.analytics.create.numTopClassesInputAriaLabel",{defaultMessage:"The number of categories for which the predicted probabilities are reported"}),singleSelection:!0,options:H,selectedOptions:$,onCreateOption:(e,t=[])=>{const a=e.trim().toLowerCase();if(""===a)return;const i={label:e};-1===t.findIndex((e=>e.label.trim().toLowerCase()===a))&&W([...H,i]),Y([i])},onChange:e=>{Y(e)},isClearable:!0,isInvalid:void 0!==X&&X<-1,"data-test-subj":"mlAnalyticsCreateJobWizardnumTopClassesInput"}))),Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(te.EuiFormRow,{label:y.i18n.translate("xpack.ml.dataframe.analytics.create.modelMemoryLimitLabel",{defaultMessage:"Model memory limit"}),isInvalid:null!==A,error:Z,helpText:y.i18n.translate("xpack.ml.dataframe.analytics.create.modelMemoryLimitHelpText",{defaultMessage:"The approximate maximum amount of memory resources that are permitted for analytical processing."})},Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(te.EuiFieldText,{placeholder:void 0!==M?pc.a[M]:pc.a.outlier_detection,disabled:h||q,value:q?g:D||"",onChange:e=>m({modelMemoryLimit:e.target.value}),isInvalid:null!==A,"data-test-subj":"mlAnalyticsCreateJobWizardModelMemoryInput"}),Object(N.jsx)(te.EuiSpacer,{size:"s"}),Object(N.jsx)(te.EuiSwitch,{disabled:h,name:"mlDataFrameAnalyticsUseEstimatedMml",label:y.i18n.translate("xpack.ml.dataframe.analytics.create.useEstimatedMmlLabel",{defaultMessage:"Use estimated model memory limit"}),checked:!0===q,onChange:()=>m({useEstimatedMml:!q}),"data-test-subj":"mlAnalyticsCreateJobWizardUseEstimatedMml"})))),Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(te.EuiFormRow,{label:y.i18n.translate("xpack.ml.dataframe.analytics.create.maxNumThreadsLabel",{defaultMessage:"Maximum number of threads"}),helpText:y.i18n.translate("xpack.ml.dataframe.analytics.create.maxNumThreadsHelpText",{defaultMessage:"The maximum number of threads to be used by the analysis. The default value is 1."}),isInvalid:0===C,error:0===C&&y.i18n.translate("xpack.ml.dataframe.analytics.create.maxNumThreadsError",{defaultMessage:"The minimum value is 1."})},Object(N.jsx)(te.EuiFieldNumber,{"aria-label":y.i18n.translate("xpack.ml.dataframe.analytics.create.maxNumThreadsInputAriaLabel",{defaultMessage:"The maximum number of threads to be used by the analysis."}),"data-test-subj":"mlAnalyticsCreateJobWizardMaxNumThreadsInput",min:1,onChange:e=>m({maxNumThreads:""===e.target.value?void 0:+e.target.value}),step:1,value:fd(C)})))),Object(N.jsx)(te.EuiSpacer,null),Object(N.jsx)(te.EuiAccordion,{id:"hyper-parameters",buttonContent:Object(N.jsx)(te.EuiTitle,{size:"xs"},Object(N.jsx)("h3",null,y.i18n.translate("xpack.ml.dataframe.analytics.create.hyperParametersSectionTitle",{defaultMessage:"Hyperparameters"}))),initialIsOpen:!1,"data-test-subj":"mlAnalyticsCreateJobWizardHyperParametersSection"},Object(N.jsx)(te.EuiFlexGrid,{columns:3},M===ul.b.OUTLIER_DETECTION&&Object(N.jsx)(pd,{actions:e,state:t,advancedParamErrors:r}),ee&&Object(N.jsx)(dd,{actions:e,state:t,advancedParamErrors:r}))),Object(N.jsx)(te.EuiSpacer,null),Object(N.jsx)(Sc,{isDisabled:ne,onClick:()=>{m({numTopClasses:!1===Q?X:void 0}),a(kd.DETAILS)}}));var oe};function jd(e){return"number"==typeof e?`${e}`:pc.c}const xd=({setCurrentStep:e,state:t})=>{const{form:a,isJobCreated:i}=t,{computeFeatureInfluence:s,dependentVariable:r,eta:o,featureBagFraction:l,featureInfluenceThreshold:c,gamma:d,jobType:u,lambda:p,method:m,maxNumThreads:b,maxTrees:h,modelMemoryLimit:f,nNeighbors:g,numTopClasses:j,numTopFeatureImportanceValues:x,outlierFraction:v,predictionFieldName:O,randomizeSeed:E,standardizationEnabled:w}=a,_=u===ul.b.REGRESSION||u===ul.b.CLASSIFICATION,S=[],M=[],k=[],C=[],T=[],F=[];return u===ul.b.OUTLIER_DETECTION&&(S.push({title:y.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.computeFeatureInfluence",{defaultMessage:"Compute feature influence"}),description:s}),M.push({title:y.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.featureInfluenceThreshold",{defaultMessage:"Feature influence threshold"}),description:jd(c)}),k.push({title:y.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.modelMemoryLimit",{defaultMessage:"Model memory limit"}),description:`${f}`}),C.push({title:y.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.nNeighbors",{defaultMessage:"N neighbors"}),description:jd(g)},{title:y.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.outlierFraction",{defaultMessage:"Outlier fraction"}),description:jd(v)}),T.push({title:y.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.method",{defaultMessage:"Method"}),description:void 0!==m?m:pc.c}),F.push({title:y.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.standardizationEnabled",{defaultMessage:"Standardization enabled"}),description:`${w}`})),_&&(S.push({title:y.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.numTopFeatureImportanceValues",{defaultMessage:"Top feature importance values"}),description:`${x}`}),C.push({title:y.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.lambdaFields",{defaultMessage:"Lambda"}),description:jd(p)},{title:y.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.eta",{defaultMessage:"Eta"}),description:jd(o)}),M.push({title:y.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.predictionFieldName",{defaultMessage:"Prediction field name"}),description:O||`${r}_prediction`},{title:y.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.randomizedSeed",{defaultMessage:"Randomized seed"}),description:jd(E)}),T.push({title:y.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.maxTreesFields",{defaultMessage:"Max trees"}),description:jd(h)},{title:y.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.featureBagFraction",{defaultMessage:"Feature bag fraction"}),description:jd(l)}),k.push({title:y.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.modelMemoryLimit",{defaultMessage:"Model memory limit"}),description:`${f}`}),F.push({title:y.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.gamma",{defaultMessage:"Gamma"}),description:jd(d)})),u===ul.b.CLASSIFICATION&&k.push({title:y.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.numTopClasses",{defaultMessage:"Top classes"}),description:-1===j?y.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.allClasses",{defaultMessage:"All classes"}):jd(j)}),void 0!==b&&S.push({title:y.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.maxNumThreads",{defaultMessage:"Maximum number of threads"}),description:`${b}`}),Object(N.jsx)(n.Fragment,null,Object(N.jsx)(te.EuiTitle,{size:"xs"},Object(N.jsx)("h3",null,y.i18n.translate("xpack.ml.dataframe.analytics.create.advancedConfigDetailsTitle",{defaultMessage:"Advanced configuration"}))),Object(N.jsx)(te.EuiSpacer,null),Object(N.jsx)(te.EuiFlexGroup,{style:{width:"70%"},justifyContent:"spaceBetween"},Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiDescriptionList,{compressed:!0,listItems:S})),Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiDescriptionList,{compressed:!0,listItems:M})),Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiDescriptionList,{compressed:!0,listItems:k}))),Object(N.jsx)(te.EuiSpacer,null),Object(N.jsx)(te.EuiTitle,{size:"xs"},Object(N.jsx)("h3",null,y.i18n.translate("xpack.ml.dataframe.analytics.create.hyperParametersDetailsTitle",{defaultMessage:"Hyperparameters"}))),Object(N.jsx)(te.EuiSpacer,null),Object(N.jsx)(te.EuiFlexGroup,{style:{width:"70%"},justifyContent:"spaceBetween"},Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiDescriptionList,{compressed:!0,listItems:C})),Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiDescriptionList,{compressed:!0,listItems:T})),Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiDescriptionList,{compressed:!0,listItems:F}))),Object(N.jsx)(te.EuiSpacer,null),!i&&Object(N.jsx)(te.EuiButtonEmpty,{iconType:"pencil",size:"s",onClick:()=>{e(kd.ADVANCED)}},y.i18n.translate("xpack.ml.dataframe.analytics.create.advancedDetails.editButtonText",{defaultMessage:"Edit"})))},vd=({actions:e,state:t,step:a,setCurrentStep:i,stepActivated:n})=>{const s=a===kd.ADVANCED,r=a!==kd.ADVANCED&&!0===n,o=`mlAnalyticsCreateJobWizardAdvancedStep${s?" active":""}${r?" summary":""}`;return Object(N.jsx)(te.EuiForm,{"data-test-subj":o},s&&Object(N.jsx)(gd,{actions:e,state:t,setCurrentStep:i}),r&&Object(N.jsx)(xd,{setCurrentStep:i,state:t}))},yd=({setCurrentStep:e,state:t})=>{const{form:a,isJobCreated:i}=t,{description:s,jobId:r,destinationIndex:o,resultsField:l}=a,c=[{title:y.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.jobId",{defaultMessage:"Job ID"}),description:r}];void 0!==l&&"string"==typeof l&&""!==l.trim()&&c.push({title:y.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.resultsField",{defaultMessage:"Results field"}),description:l});const d=[{title:y.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.jobDescription",{defaultMessage:"Job description"}),description:s}],u=[{title:y.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.destIndex",{defaultMessage:"Destination index"}),description:o||""}];return Object(N.jsx)(n.Fragment,null,Object(N.jsx)(te.EuiFlexGroup,{style:{width:"70%"},justifyContent:"spaceBetween"},Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiDescriptionList,{compressed:!0,listItems:c})),Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiDescriptionList,{style:{wordBreak:"break-word"},compressed:!0,listItems:d})),Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiDescriptionList,{compressed:!0,listItems:u}))),Object(N.jsx)(te.EuiSpacer,null),!i&&Object(N.jsx)(te.EuiButtonEmpty,{iconType:"pencil",size:"s",onClick:()=>{e(kd.DETAILS)}},y.i18n.translate("xpack.ml.dataframe.analytics.create.detailsDetails.editButtonText",{defaultMessage:"Edit"})))},Od=y.i18n.translate("xpack.ml.dataframe.analytics.create.destinationIndexHelpText",{defaultMessage:"An index with this name already exists. Be aware that running this analytics job will modify this destination index."}),Ed=({actions:e,state:t,setCurrentStep:a})=>{const{services:{docLinks:i,notifications:s}}=Object(f.b)(),r=i.links.apis.createIndex,{setFormState:o}=e,{form:l,cloneJob:c,hasSwitchedToEditor:d,isJobCreated:u}=t,{createIndexPattern:p,description:m,destinationIndex:b,destinationIndexNameEmpty:h,destinationIndexNameExists:g,destinationIndexNameValid:j,destinationIndexPatternTitleExists:x,jobId:v,jobIdEmpty:O,jobIdExists:w,jobIdInvalidMaxLength:_,jobIdValid:S,resultsField:M}=l,[k,C]=Object(n.useState)(void 0===c&&!1===d),[T,F]=Object(n.useState)(void 0===c&&!1===d&&void 0===M||void 0!==c&&"ml"===M),I=Object(n.useRef)(null),D=!0===O||!0===w||!1===S||!0===h||!1===j||!0===x&&!0===p,A=Object(E.debounce)((async()=>{try{const e=await ge.ml.checkIndicesExists({indices:[b]});o({destinationIndexNameExists:e[b].exists})}catch(e){s.toasts.addDanger(y.i18n.translate("xpack.ml.dataframe.analytics.create.errorCheckingIndexExists",{defaultMessage:"The following error occurred getting the existing index names: {error}",values:{error:Object(ze.b)(e)}}))}}),400),L=Object(n.useMemo)((()=>Object(E.debounce)((async()=>{try{const e=await ge.ml.dataFrameAnalytics.jobsExist([v],!0);o({jobIdExists:e[v].exists})}catch(e){s.toasts.addDanger(y.i18n.translate("xpack.ml.dataframe.analytics.create.errorCheckingJobIdExists",{defaultMessage:"The following error occurred checking if job id exists: {error}",values:{error:Object(ze.b)(e)}}))}}),400)),[v]);return Object(n.useEffect)((()=>(!0===S?L():"string"==typeof v&&""===v.trim()&&!0===w&&o({jobIdExists:!1}),()=>{L.cancel()})),[v]),Object(n.useEffect)((()=>(!0===j?A():"string"==typeof b&&""===b.trim()&&!0===g&&o({destinationIndexNameExists:!1}),()=>{A.cancel()})),[b]),Object(n.useEffect)((()=>{!0===k&&!O&&S?o({destinationIndex:v}):!1===k&&!1===d&&o({destinationIndex:""})}),[k,v]),Object(N.jsx)(n.Fragment,null,Object(N.jsx)(te.EuiFormRow,{fullWidth:!0,label:y.i18n.translate("xpack.ml.dataframe.analytics.create.jobIdLabel",{defaultMessage:"Job ID"}),isInvalid:!O&&!S||w||_,error:[...O||S?[]:[y.i18n.translate("xpack.ml.dataframe.analytics.create.jobIdInvalidError",{defaultMessage:"Must contain lowercase alphanumeric characters (a-z and 0-9), hyphens, and underscores only and must start and end with alphanumeric characters."})],...w?[y.i18n.translate("xpack.ml.dataframe.analytics.create.jobIdExistsError",{defaultMessage:"An analytics job with this ID already exists."})]:[],..._?[y.i18n.translate("xpack.ml.dataframe.analytics.create.jobIdInvalidMaxLengthErrorMessage",{defaultMessage:"Job ID must be no more than {maxLength, plural, one {# character} other {# characters}} long.",values:{maxLength:bn.b}})]:[]]},Object(N.jsx)(te.EuiFieldText,{fullWidth:!0,inputRef:e=>{e&&(I.current=e)},disabled:u,placeholder:y.i18n.translate("xpack.ml.dataframe.analytics.create.jobIdPlaceholder",{defaultMessage:"Job ID"}),value:v,onChange:e=>o({jobId:e.target.value}),"aria-label":y.i18n.translate("xpack.ml.dataframe.analytics.create.jobIdInputAriaLabel",{defaultMessage:"Choose a unique analytics job ID."}),isInvalid:!O&&!S||w||O,"data-test-subj":"mlAnalyticsCreateJobFlyoutJobIdInput"})),Object(N.jsx)(te.EuiFormRow,{fullWidth:!0,label:y.i18n.translate("xpack.ml.dataframe.analytics.create.jobDescription.label",{defaultMessage:"Job description"})},Object(N.jsx)(te.EuiTextArea,{fullWidth:!0,value:m,placeholder:y.i18n.translate("xpack.ml.dataframe.analytics.create.jobDescription.helpText",{defaultMessage:"Optional descriptive text"}),rows:2,onChange:e=>{const t=e.target.value;o({description:t})},"data-test-subj":"mlDFAnalyticsJobCreationJobDescription"})),Object(N.jsx)(te.EuiFormRow,{fullWidth:!0,helpText:!0===k&&g&&Od},Object(N.jsx)(te.EuiSwitch,{disabled:u,name:"mlDataFrameAnalyticsDestIndexSameAsId",label:y.i18n.translate("xpack.ml.dataframe.analytics.create.DestIndexSameAsIdLabel",{defaultMessage:"Destination index same as job ID"}),checked:!0===k,onChange:()=>C(!k),"data-test-subj":"mlAnalyticsCreateJobWizardDestIndexSameAsIdSwitch"})),!1===k&&Object(N.jsx)(te.EuiFormRow,{fullWidth:!0,label:y.i18n.translate("xpack.ml.dataframe.analytics.create.destinationIndexLabel",{defaultMessage:"Destination index"}),isInvalid:h||!h&&!j,helpText:g&&Od,error:!h&&!j&&[Object(N.jsx)(n.Fragment,null,y.i18n.translate("xpack.ml.dataframe.analytics.create.destinationIndexInvalidError",{defaultMessage:"Invalid destination index name."}),Object(N.jsx)("br",null),Object(N.jsx)(te.EuiLink,{href:r,target:"_blank"},y.i18n.translate("xpack.ml.dataframe.stepDetailsForm.destinationIndexInvalidErrorLink",{defaultMessage:"Learn more about index name limitations."})))]},Object(N.jsx)(te.EuiFieldText,{fullWidth:!0,disabled:u,placeholder:"destination index",value:b,onChange:e=>o({destinationIndex:e.target.value}),"aria-label":y.i18n.translate("xpack.ml.dataframe.analytics.create.destinationIndexInputAriaLabel",{defaultMessage:"Choose a unique destination index name."}),isInvalid:!h&&!j,"data-test-subj":"mlAnalyticsCreateJobFlyoutDestinationIndexInput"})),Object(N.jsx)(te.EuiFormRow,{fullWidth:!0},Object(N.jsx)(te.EuiSwitch,{disabled:u,name:"mlDataFrameAnalyticsUseResultsFieldDefault",label:y.i18n.translate("xpack.ml.dataframe.analytics.create.UseResultsFieldDefaultLabel",{defaultMessage:'Use results field default value "{defaultValue}"',values:{defaultValue:"ml"}}),checked:!0===T,onChange:()=>{!0==!T&&o({resultsField:void 0}),F(!T)},"data-test-subj":"mlAnalyticsCreateJobWizardUseResultsFieldDefault"})),!1===T&&Object(N.jsx)(te.EuiFormRow,{fullWidth:!0,label:y.i18n.translate("xpack.ml.dataframe.analytics.create.resultsFieldLabel",{defaultMessage:"Results field"}),helpText:y.i18n.translate("xpack.ml.dataframe.analytics.create.resultsFieldHelpText",{defaultMessage:"Defines the name of the field in which to store the results of the analysis. Defaults to ml."})},Object(N.jsx)(te.EuiFieldText,{disabled:u,placeholder:"results field",value:M,onChange:e=>o({resultsField:e.target.value}),"aria-label":y.i18n.translate("xpack.ml.dataframe.analytics.create.resultsFieldInputAriaLabel",{defaultMessage:"The name of the field in which to store the results of the analysis."}),"data-test-subj":"mlAnalyticsCreateJobWizardResultsFieldInput"})),Object(N.jsx)(te.EuiFormRow,{fullWidth:!0,isInvalid:p&&x||!p,error:[...p&&x?[y.i18n.translate("xpack.ml.dataframe.analytics.create.indexPatternExistsError",{defaultMessage:"An index pattern with this title already exists."})]:[],...p?[]:[Object(N.jsx)(te.EuiText,{size:"xs",color:"warning"},y.i18n.translate("xpack.ml.dataframe.analytics.create.shouldCreateIndexPatternMessage",{defaultMessage:"You may not be able to view job results if an index pattern is not created for the destination index."}))]]},Object(N.jsx)(te.EuiSwitch,{disabled:u,name:"mlDataFrameAnalyticsCreateIndexPattern",label:y.i18n.translate("xpack.ml.dataframe.analytics.create.createIndexPatternLabel",{defaultMessage:"Create index pattern"}),checked:!0===p,onChange:()=>o({createIndexPattern:!p}),"data-test-subj":"mlAnalyticsCreateJobWizardCreateIndexPatternSwitch"})),Object(N.jsx)(te.EuiSpacer,null),Object(N.jsx)(Sc,{isDisabled:D,onClick:()=>{a(kd.VALIDATION)}}))},wd=({actions:e,state:t,setCurrentStep:a,step:i,stepActivated:n})=>{const s=i===kd.DETAILS,r=i!==kd.DETAILS&&!0===n,o=`mlAnalyticsCreateJobWizardDetailsStep${s?" active":""}${r?" summary":""}`;return Object(N.jsx)(te.EuiForm,{className:"mlDataFrameAnalyticsCreateForm","data-test-subj":o},s&&Object(N.jsx)(Ed,{actions:e,state:t,setCurrentStep:a}),r&&Object(N.jsx)(yd,{setCurrentStep:a,state:t}))},_d=({checksInProgress:e,validationMessages:t,setCurrentStep:a})=>{const i=t.map(((e,t)=>Object(N.jsx)(yn,v()({key:`${e.id}_${t}`},e))));return Object(N.jsx)(s.a.Fragment,null,e&&Object(N.jsx)(te.EuiLoadingSpinner,{size:"xl"}),!e&&Object(N.jsx)(s.a.Fragment,null,i,Object(N.jsx)(te.EuiSpacer,null),Object(N.jsx)(Sc,{isDisabled:!1,onClick:()=>{a(kd.CREATE)}})))},Sd=({setCurrentStep:e,state:t,validationSummary:a})=>{const{isJobCreated:i}=t,n=[{title:y.i18n.translate("xpack.ml.dataframe.analytics.create.validatioinDetails.successfulChecks",{defaultMessage:"Successful checks"}),description:Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(te.EuiFlexGroup,{gutterSize:"xs",alignItems:"center"},Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiText,{size:"s"},a.success)),Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiIcon,{type:"check"}))))}],r=[{title:y.i18n.translate("xpack.ml.dataframe.analytics.create.validatioinDetails.warnings",{defaultMessage:"Warnings"}),description:Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(te.EuiFlexGroup,{gutterSize:"xs"},Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiText,{size:"s"},a.warning)),Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiIcon,{type:"alert"}))))}];return Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(te.EuiFlexGroup,{style:{width:"70%"}},Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiDescriptionList,{compressed:!0,listItems:n})),Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiDescriptionList,{style:{wordBreak:"break-word"},compressed:!0,listItems:r}))),Object(N.jsx)(te.EuiSpacer,null),!i&&Object(N.jsx)(te.EuiButtonEmpty,{size:"s",onClick:()=>{e(kd.VALIDATION)}},y.i18n.translate("xpack.ml.dataframe.analytics.create.validationDetails.viewButtonText",{defaultMessage:"View"})))},Md=({state:e,setCurrentStep:t,step:a,stepActivated:i})=>{const[s,r]=Object(n.useState)(!1),[o,l]=Object(n.useState)([]),[c,d]=Object(n.useState)(),{form:u,jobConfig:p,isAdvancedEditorEnabled:m}=e,{dependentVariable:b,jobType:h,trainingPercent:g,numTopFeatureImportanceValues:j,numTopClasses:x,includes:v}=u,O=a===kd.VALIDATION,w=a!==kd.VALIDATION&&!0===i,{dataFrameAnalytics:{validateDataFrameAnalytics:_}}=Object(f.a)(),S=`mlAnalyticsCreateJobWizardValidationStepWrapper${O?" active":""}${w?" summary":""}`,M=Object(E.debounce)((async()=>{r(!0);try{const e=m?p:Object(pc.f)(u),t=await _(e);l(t),d(void 0),r(!1)}catch(e){d({heading:y.i18n.translate("xpack.ml.dataframe.analytics.validation.validationFetchErrorMessage",{defaultMessage:"Error validating job"}),id:"error",status:bn.c.ERROR,text:Object(ze.b)(e)}),r(!1)}}),500);Object(n.useEffect)((function(){void 0===h||!O&&!0!==i||M()}),[O,b,g,j,x,v]),void 0!==c&&o.push(c);const k=Object(n.useMemo)((()=>o.reduce(((e,t)=>((null==t?void 0:t.status)===bn.c.WARNING?e.warning+=1:(null==t?void 0:t.status)===bn.c.SUCCESS&&(e.success+=1),e)),{warning:0,success:0})),[o]);return Object(N.jsx)(te.EuiForm,{className:"mlDataFrameAnalyticsCreateForm","data-test-subj":S},O&&Object(N.jsx)(_d,{checksInProgress:s,validationMessages:o,setCurrentStep:t}),w&&Object(N.jsx)(Sd,{setCurrentStep:t,state:e,validationSummary:k}))};let kd;!function(e){e[e.CONFIGURATION=0]="CONFIGURATION",e[e.ADVANCED=1]="ADVANCED",e[e.DETAILS=2]="DETAILS",e[e.VALIDATION=3]="VALIDATION",e[e.CREATE=4]="CREATE"}(kd||(kd={}));const Cd=({jobId:e})=>{const[t,a]=Object(n.useState)(kd.CONFIGURATION),[i,s]=Object(n.useState)([!0,!1,!1,!1,!1]),r=Object(g.b)(),{currentIndexPattern:o}=r,l=Object(dc.b)(),{state:c}=l,{isAdvancedEditorEnabled:d,disableSwitchToForm:u,isJobCreated:p}=c,{jobType:m}=c.form,{initiateWizard:b,setJobClone:h,switchToAdvancedEditor:f,switchToForm:j}=l.actions;Object(n.useEffect)((()=>{b(),o&&async function(){if(void 0!==e){const t=await ge.ml.dataFrameAnalytics.getDataFrameAnalytics(e,!0);if(Array.isArray(t.data_frame_analytics)&&t.data_frame_analytics.length>0){const e=t.data_frame_analytics[0];await h(e)}}}()}),[]),Object(n.useEffect)((()=>{!1===i[t]&&(i.splice(t,1,!0),s(i))}),[t]);const x=[{title:y.i18n.translate("xpack.ml.dataframe.analytics.creation.configurationStepTitle",{defaultMessage:"Configuration"}),children:Object(N.jsx)(cd,v()({},l,{isClone:void 0!==e,setCurrentStep:a,step:t,stepActivated:i[kd.CONFIGURATION]})),status:t>=kd.CONFIGURATION?void 0:"incomplete"},{title:y.i18n.translate("xpack.ml.dataframe.analytics.creation.advancedStepTitle",{defaultMessage:"Additional options"}),children:Object(N.jsx)(vd,v()({},l,{setCurrentStep:a,step:t,stepActivated:i[kd.ADVANCED]})),status:t>=kd.ADVANCED?void 0:"incomplete"},{title:y.i18n.translate("xpack.ml.dataframe.analytics.creation.detailsStepTitle",{defaultMessage:"Job details"}),children:Object(N.jsx)(wd,v()({},l,{setCurrentStep:a,step:t,stepActivated:i[kd.DETAILS]})),status:t>=kd.DETAILS?void 0:"incomplete"},{title:y.i18n.translate("xpack.ml.dataframe.analytics.creation.validationStepTitle",{defaultMessage:"Validation"}),children:Object(N.jsx)(Md,v()({},l,{setCurrentStep:a,step:t,stepActivated:i[kd.VALIDATION]})),status:t>=kd.VALIDATION?void 0:"incomplete"},{title:y.i18n.translate("xpack.ml.dataframe.analytics.creation.createStepTitle",{defaultMessage:"Create"}),children:Object(N.jsx)(jc,v()({},l,{step:t})),status:t>=kd.CREATE?void 0:"incomplete"}];return Object(N.jsx)(te.EuiPage,{"data-test-subj":"mlAnalyticsCreationContainer"},Object(N.jsx)(te.EuiPageBody,{restrictWidth:1200},Object(N.jsx)(te.EuiPageContent,null,Object(N.jsx)(te.EuiFlexGroup,null,Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(te.EuiFlexGroup,{direction:"column",gutterSize:"none"},Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiTitle,{size:"m","data-test-subj":"mlDataFrameAnalyticsWizardHeaderTitle"},Object(N.jsx)("h1",null,void 0===e&&Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.dataframe.analytics.creationPageTitle",defaultMessage:"Create job"}),void 0!==e&&Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.dataframe.analytics.clone.creationPageTitle",defaultMessage:"Clone job from {jobId}",values:{jobId:e}})))),Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)("h2",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.dataframe.analytics.creationPageSourceIndexTitle",defaultMessage:"Source index pattern: {indexTitle}",values:{indexTitle:o.title}}))))),Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiFormRow,{helpText:u&&y.i18n.translate("xpack.ml.dataframe.analytics.create.jsonEditorDisabledSwitchText",{defaultMessage:"Configuration contains advanced fields not supported by the form. You cannot switch back to the form."})},Object(N.jsx)(te.EuiSwitch,{disabled:void 0===m||u||p,label:y.i18n.translate("xpack.ml.dataframe.analytics.create.switchToJsonEditorSwitch",{defaultMessage:"Switch to json editor"}),checked:d,onChange:e=>{!0===e.target.checked?f():j()},"data-test-subj":"mlAnalyticsCreateJobWizardAdvancedEditorSwitch"})))),Object(N.jsx)(te.EuiSpacer,null),!0===d&&Object(N.jsx)(xc,l),!1===d&&Object(N.jsx)(te.EuiSteps,{"data-test-subj":"mlAnalyticsCreateJobWizardSteps",steps:x}))))},Td=(e,t)=>({path:"/data_frame_analytics/new_job",render:(e,t)=>Object(N.jsx)(Fd,v()({},e,{deps:t})),breadcrumbs:[P("ML_BREADCRUMB",e,t),{text:y.i18n.translate("xpack.ml.dataFrameAnalyticsBreadcrumbs.dataFrameManagementLabel",{defaultMessage:"Data Frame Analytics"}),onClick:R("/data_frame_analytics",e)}]}),Fd=({location:e,deps:t})=>{const{index:a,jobId:i,savedSearchId:n}=Object(me.parse)(e.search,{sort:!1}),{context:s}=F(a,n,t.config,{...Y(t),analyticsFields:()=>Ts(a,n,t.indexPatterns,"data-frame-analytics")});return Object(N.jsx)(Vb,{context:s},Object(N.jsx)(Cd,{jobId:i}))},Id=(e,t)=>({path:"/data_frame_analytics/models",render:(e,t)=>Object(N.jsx)(Dd,v()({},e,{deps:t})),breadcrumbs:[P("ML_BREADCRUMB",e,t),P("DATA_FRAME_ANALYTICS_BREADCRUMB",e,t),{text:y.i18n.translate("xpack.ml.dataFrameAnalyticsBreadcrumbs.modelsListLabel",{defaultMessage:"Model Management"}),href:""}]}),Dd=({location:e,deps:t})=>{const{context:a}=F(void 0,void 0,t.config,Y(t));return Object(N.jsx)(Vb,{context:a},Object(N.jsx)(po.a,null))},Ad=(e,t)=>({path:"/data_frame_analytics/map",render:(e,t)=>Object(N.jsx)(Ld,v()({},e,{deps:t})),breadcrumbs:[P("ML_BREADCRUMB",e,t),P("DATA_FRAME_ANALYTICS_BREADCRUMB",e,t),{text:y.i18n.translate("xpack.ml.dataFrameAnalyticsBreadcrumbs.analyticsMapLabel",{defaultMessage:"Analytics Map"}),href:""}]}),Ld=({deps:e})=>{const{context:t}=F(void 0,void 0,e.config,Y(e));return Object(N.jsx)(Vb,{context:t},Object(N.jsx)(po.a,null))};var Rd=a(683),Pd=a.n(Rd),Nd=a(48),zd=a.n(Nd);const Bd=()=>{const[e,t]=Object(n.useState)(!1);return Object(N.jsx)(Xl,{anchorPosition:"upCenter",button:Object(N.jsx)(Yl,{onClick:()=>{t(!e)}}),closePopover:()=>t(!1),isOpen:e,title:y.i18n.translate("xpack.ml.timeSeriesExplorer.popoverTitle",{defaultMessage:"Single time series analysis"})},Object(N.jsx)("p",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.popoverBasicExplanation",defaultMessage:"This chart illustrates the actual data values over time for a specific detector. You can examine an event by sliding the time selector and changing its length. For the most accurate view, set the zoom size to auto."})),Object(N.jsx)("p",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.popoverAnomalyExplanation",defaultMessage:"An anomaly score is calculated for each bucket time interval, with a value from 0 to 100. Anomalous events are highlighted in colors that indicate their severity. If an anomaly is depicted with a cross symbol instead of a dot, it has a medium or high multi-bucket impact. This extra analysis can catch anomalies even when they fall within the bounds of expected behavior."})),Object(N.jsx)("p",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.popoverForecastExplanation",defaultMessage:"If you create a forecast, predicted data values are added to the chart. A shaded area around these values represents the confidence level; as you forecast further into the future, the confidence level generally decreases."})),Object(N.jsx)("p",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.popoverAnnotationsExplanation",defaultMessage:"You can also optionally annotate your job results by drag-selecting a period of time in the chart and adding a description. Some annotations are generated automatically to indicate noteworthy occurrences."})),Object(N.jsx)("p",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.popoverModelPlotExplanation",defaultMessage:"If model plot is enabled, you can optionally show model bounds, which are represented by a shaded area in the chart. As the job analyzes more data, it learns to more closely predict the expected patterns of behavior."})))};var Jd=a(252),Vd=a(260),Ud=a(76),Gd=a(194);function qd({actual:e,typical:t}){const{iconType:a,message:i}=Object(Gd.a)(e,t);return Object(N.jsx)(te.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},void 0!==a&&Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiIcon,{type:a,size:"s"})),Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiText,{size:"xs"},i)))}function Hd({detectorDescription:e,numberOfRules:t}){let a;return void 0!==t&&t>0&&(a=Object(N.jsx)(te.EuiToolTip,{content:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.anomaliesTable.detectorCell.rulesConfiguredTooltip",defaultMessage:"rules have been configured for this detector"})},Object(N.jsx)(te.EuiIcon,{type:"controlsHorizontal",className:"detector-rules-icon"}))),Object(N.jsx)(s.a.Fragment,null,e,a)}var Wd=a(165),$d=a(7),Yd=a(228);function Xd({entityName:e,entityValue:t,filter:a}){if(void 0!==a)return Object(N.jsx)(te.EuiToolTip,{content:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.anomaliesTable.entityCell.addFilterTooltip",defaultMessage:"Add filter"})},Object(N.jsx)(te.EuiButtonIcon,{size:"s",className:"filter-button",onClick:Object(Yd.a)((()=>{a(e,t,$d.a.ADD)})),iconType:"plusInCircle","aria-label":y.i18n.translate("xpack.ml.anomaliesTable.entityCell.addFilterAriaLabel",{defaultMessage:"Add filter"})}))}function Qd({entityName:e,entityValue:t,filter:a}){if(void 0!==a)return Object(N.jsx)(te.EuiToolTip,{content:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.anomaliesTable.entityCell.removeFilterTooltip",defaultMessage:"Remove filter"})},Object(N.jsx)(te.EuiButtonIcon,{size:"s",className:"filter-button",onClick:Object(Yd.a)((()=>{a(e,t,$d.a.REMOVE)})),iconType:"minusInCircle","aria-label":y.i18n.translate("xpack.ml.anomaliesTable.entityCell.removeFilterAriaLabel",{defaultMessage:"Remove filter"})}))}const Kd=({entityName:e,entityValue:t,filter:a,wrapText:i=!1})=>{let n=""===t?Object(N.jsx)("i",null,Wd.a):t;e===Ct.b&&(n=`${Ct.b} ${n}`);const r={maxWidth:"100%"},o=i?"field-value-long":"field-value-short",l=void 0!==a&&void 0!==e&&void 0!==t;return!0===i?Object(N.jsx)("div",null,Object(N.jsx)("span",{className:o},n),l&&Object(N.jsx)(s.a.Fragment,null,Xd({entityName:e,entityValue:t,filter:a}),Qd({entityName:e,entityValue:t,filter:a}))):Object(N.jsx)(te.EuiFlexGroup,{direction:"row",alignItems:"center",gutterSize:"none"},Object(N.jsx)(te.EuiFlexItem,{grow:!1,style:r},Object(N.jsx)(te.EuiText,{size:"xs",className:o},n)),l&&Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiFlexGroup,{direction:"row",alignItems:"center",gutterSize:"none"},Object(N.jsx)(te.EuiFlexItem,{grow:!1},Xd({entityName:e,entityValue:t,filter:a})),Object(N.jsx)(te.EuiFlexItem,{grow:!1},Qd({entityName:e,entityValue:t,filter:a})))))};class influencers_cell_InfluencersCell extends n.Component{constructor(e){super(e),this.state={showAll:!1}}toggleAllInfluencers(){this.setState({showAll:!this.state.showAll})}renderInfluencers(e){const t=!1===this.state.showAll?this.props.limit:e.length,a=e.slice(0,t),{influencerFilter:i}=this.props;let n=Math.max(e.length-t,0);1===n&&(a.push(e[this.props.limit]),n=0);const r=a.map(((e,t)=>Object(N.jsx)("div",{key:t},e.influencerFieldName,": ",e.influencerFieldValue,void 0!==i&&Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(te.EuiToolTip,{content:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.anomaliesTable.influencersCell.addFilterTooltip",defaultMessage:"Add filter"})},Object(N.jsx)(te.EuiButtonIcon,{size:"s",className:"filter-button",onClick:Object(Yd.a)((()=>{i(e.influencerFieldName,e.influencerFieldValue,"+")})),iconType:"plusInCircle","aria-label":y.i18n.translate("xpack.ml.anomaliesTable.influencersCell.addFilterAriaLabel",{defaultMessage:"Add filter"})})),Object(N.jsx)(te.EuiToolTip,{content:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.anomaliesTable.influencersCell.removeFilterTooltip",defaultMessage:"Remove filter"})},Object(N.jsx)(te.EuiButtonIcon,{size:"s",className:"filter-button",onClick:Object(Yd.a)((()=>{i(e.influencerFieldName,e.influencerFieldValue,"-")})),iconType:"minusInCircle","aria-label":y.i18n.translate("xpack.ml.anomaliesTable.influencersCell.removeFilterAriaLabel",{defaultMessage:"Remove filter"})}))))));return Object(N.jsx)(s.a.Fragment,null,r,this.renderOthers(e.length,n))}renderOthers(e,t){return t>0?Object(N.jsx)("div",null,Object(N.jsx)(te.EuiLink,{onClick:()=>this.toggleAllInfluencers()},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.anomaliesTable.influencersCell.moreInfluencersLinkText",defaultMessage:"and {othersCount} more",values:{othersCount:t}}))):e>this.props.limit+1?Object(N.jsx)("div",null,Object(N.jsx)(te.EuiLink,{onClick:()=>this.toggleAllInfluencers()},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.anomaliesTable.influencersCell.showLessInfluencersLinkText",defaultMessage:"show less"}))):void 0}render(){const e=this.props.influencers||[],t=[];return e.forEach((e=>{Object(E.each)(e,((e,a)=>{t.push({influencerFieldName:a,influencerFieldValue:e})}))})),Object(N.jsx)("div",null,this.renderInfluencers(t),this.renderOthers(t))}}var Zd=a(53),eu=a.n(Zd),tu=a(26);var au=a(145);class links_menu_LinksMenuUI extends n.Component{constructor(e){super(e),Ce()(this,"openCustomUrl",(e=>{const{anomaly:t,interval:a,isAggregatedData:i}=this.props;console.log("Anomalies Table - open customUrl for record:",t);const n=Object(E.cloneDeep)(t.source),s=n.timestamp,r=e.url_value,o=Object(tu.a)(e.time_range),l=this.props.kibana.services.http.basePath.get();if(r.includes("$earliest$")){let e=qe()(s);null!==o?e.subtract(o):(e=qe()(s).startOf(a),"hour"===a&&e.subtract(1,"h")),n.earliest=e.toISOString()}if(r.includes("$latest$")){let e=qe()(s).add(n.bucket_span,"s");null!==o?e.add(o):!0===i&&(e=qe()(s).endOf(a),"hour"===a&&e.add(1,"h")),n.latest=e.toISOString()}if((r.includes("$mlcategoryterms$")||r.includes("$mlcategoryregex$"))&&void 0!==n.mlcategory){const t=n.job_id,a=n.mlcategory[0];ge.ml.results.getCategoryDefinition(t,a).then((t=>{const a=t.terms.split(" ").map((e=>`+${e}`));n.mlcategoryterms=a.join(" "),n.mlcategoryregex=t.regex;const i=Object(da.e)(e.url_value,n,!0);Object(au.d)(i,e,l)})).catch((e=>{console.log("openCustomUrl(): error loading categoryDefinition:",e);const{toasts:t}=this.props.kibana.services.notifications;t.addDanger(y.i18n.translate("xpack.ml.anomaliesTable.linksMenu.unableToOpenLinkErrorMessage",{defaultMessage:"Unable to open link as an error occurred loading details on category ID {categoryId}",values:{categoryId:a}}))}))}else{const t=Object(au.a)(e,n);Object(au.d)(t,e,l)}})),Ce()(this,"viewSeries",(async()=>{const{services:{share:e}}=this.props.kibana,t=e.url.locators.get(T.a),a=this.props.anomaly.source,i=this.props.bounds,n=i.min.toISOString(),s=i.max.toISOString(),r=qe()(a.timestamp),o=r.subtract(50*a.bucket_span,"s").toISOString(),l=r.add(100*a.bucket_span,"s").toISOString(),c={};void 0!==a.partition_field_value&&(c[a.partition_field_name]=a.partition_field_value),void 0!==a.over_field_value&&(c[a.over_field_name]=a.over_field_value),void 0!==a.by_field_value&&(c[a.by_field_name]=a.by_field_value);const d=await t.getUrl({page:T.b.SINGLE_METRIC_VIEWER,pageState:{jobIds:[a.job_id],refreshInterval:{display:"Off",pause:!0,value:0},timeRange:{from:n,to:s,mode:"absolute"},zoom:{from:o,to:l},detectorIndex:a.detector_index,entities:c,query_string:{analyze_wildcard:!0,query:"*"}}},{absolute:!0});window.open(d,"_blank")})),Ce()(this,"viewExamples",(()=>{const e=this.props.anomaly.entityValue,t=this.props.anomaly.source,a=re.a.getJob(this.props.anomaly.jobId);if(void 0===a){console.log(`viewExamples(): no job found with ID: ${this.props.anomaly.jobId}`);const{toasts:e}=this.props.kibana.services.notifications;return void e.addDanger(y.i18n.translate("xpack.ml.anomaliesTable.linksMenu.unableToViewExamplesErrorMessage",{defaultMessage:"Unable to view examples as no details could be found for job ID {jobId}",values:{jobId:this.props.anomaly.jobId}}))}const i=a.analysis_config.categorization_field_name,n=a.datafeed_config.indices;let s=0;!function e(t){(function(e,t){return new Promise(((a,i)=>{""!==e?ge.ml.getFieldCaps({index:e,fields:[t]}).then((e=>{let t="";Object(E.each)(e.fields,(e=>{Object(E.each)(e,(e=>{""===t&&(t=e.type)}))})),a(t)})).catch((e=>{i(e)})):i()}))})(t,i).then((t=>{""!==t?o(n.join(),t):(s++,s<n.length?e(n[s]):r())})).catch((()=>{r()}))}(n[s]);const r=()=>{console.log(`viewExamples(): error finding type of field ${i} in indices:`,n);const{toasts:t}=this.props.kibana.services.notifications;t.addDanger(y.i18n.translate("xpack.ml.anomaliesTable.linksMenu.noMappingCouldBeFoundErrorMessage",{defaultMessage:"Unable to view examples of documents with mlcategory {categoryId} as no mapping could be found for the categorization field {categorizationFieldName}",values:{categoryId:e,categorizationFieldName:i}}))},o=(a,n)=>{const s=Object(O.c)(a)||a;ge.ml.results.getCategoryDefinition(t.job_id,e).then((e=>{let a=null;if(n===_.ES_FIELD_TYPES.KEYWORD)e.regex&&(a={language:S.c.LUCENE,query:`${i}:/${e.regex}/`});else if(e.terms){const t=Object(Zo.b)(e.terms);a={language:S.c.KUERY,query:`${i}:"`+t.split(" ").join(`" and ${i}:"`)+'"'}}const r=qe()(t.timestamp),o=r.toISOString(),l=r.add(t.bucket_span,"s").toISOString(),c=eu.a.encode({refreshInterval:{display:"Off",pause:!0,value:0},time:{from:o,to:l,mode:"absolute"}}),d={index:s,filters:[]};null!==a&&(d.query=a);const u=eu.a.encode(d),{basePath:p}=this.props.kibana.services.http;let m=p.get();m+="/app/discover#/",m+="?_g="+c,m+="&_a="+encodeURIComponent(u),window.open(m,"_blank")})).catch((t=>{console.log("viewExamples(): error loading categoryDefinition:",t);const{toasts:a}=this.props.kibana.services.notifications;a.addDanger(y.i18n.translate("xpack.ml.anomaliesTable.linksMenu.loadingDetailsErrorMessage",{defaultMessage:"Unable to view examples as an error occurred loading details on category ID {categoryId}",values:{categoryId:e}}))}))}})),Ce()(this,"onButtonClick",(()=>{this.setState((e=>({isPopoverOpen:!e.isPopoverOpen})))})),Ce()(this,"closePopover",(()=>{this.setState({isPopoverOpen:!1})})),this.state={isPopoverOpen:!1,toasts:[]}}render(){const{anomaly:e,showViewSeriesLink:t}=this.props,a=Object($d.m)(e.source)&&Object(I.e)("canUpdateJob"),i=Object(N.jsx)(te.EuiButtonIcon,{size:"s",color:"text",onClick:this.onButtonClick,iconType:"gear","aria-label":y.i18n.translate("xpack.ml.anomaliesTable.linksMenu.selectActionAriaLabel",{defaultMessage:"Select action for anomaly at {time}",values:{time:Object(Ud.c)(e.time)}}),"data-test-subj":"mlAnomaliesListRowActionsButton"}),n=[];return void 0!==e.customUrls&&e.customUrls.forEach(((e,t)=>{n.push(Object(N.jsx)(te.EuiContextMenuItem,{key:`custom_url_${t}`,icon:"popout",onClick:()=>{this.closePopover(),this.openCustomUrl(e)},"data-test-subj":`mlAnomaliesListRowActionCustomUrlButton_${t}`},e.url_name))})),!0===t&&!0===e.isTimeSeriesViewRecord&&n.push(Object(N.jsx)(te.EuiContextMenuItem,{key:"view_series",icon:"visLine",onClick:()=>{this.closePopover(),this.viewSeries()},"data-test-subj":"mlAnomaliesListRowActionViewSeriesButton"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.anomaliesTable.linksMenu.viewSeriesLabel",defaultMessage:"View series"}))),"mlcategory"===e.entityName&&n.push(Object(N.jsx)(te.EuiContextMenuItem,{key:"view_examples",icon:"popout",onClick:()=>{this.closePopover(),this.viewExamples()},"data-test-subj":"mlAnomaliesListRowActionViewExamplesButton"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.anomaliesTable.linksMenu.viewExamplesLabel",defaultMessage:"View examples"}))),a&&n.push(Object(N.jsx)(te.EuiContextMenuItem,{key:"create_rule",icon:"controlsHorizontal",onClick:()=>{this.closePopover(),this.props.showRuleEditorFlyout(e)},"data-test-subj":"mlAnomaliesListRowActionConfigureRulesButton"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.anomaliesTable.linksMenu.configureRulesLabel",defaultMessage:"Configure job rules"}))),Object(N.jsx)(te.EuiPopover,{button:i,isOpen:this.state.isPopoverOpen,closePopover:this.closePopover,panelPaddingSize:"none",anchorPosition:"downLeft"},Object(N.jsx)(te.EuiContextMenuPanel,{items:n,"data-test-subj":"mlAnomaliesListRowActionsMenu"}))}}const iu=Object(c.withKibana)(links_menu_LinksMenuUI);var nu=a(133),su=a(125);const ru=0,ou=1,lu=500;var cu=a(13);const du=Object(n.memo)((({score:e,multiBucketImpact:t})=>{const a=Object($d.g)(e),i=Object($d.j)(e);return t>=cu.a.MEDIUM?Object(N.jsx)(te.EuiFlexGroup,{gutterSize:"xs",alignItems:"center",responsive:!1},Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)("svg",{width:"16",height:"16",viewBox:"-2 -2 20 20",fill:i},Object(N.jsx)("path",{d:"M-6.708203932499369,-2.23606797749979H-2.23606797749979V-6.708203932499369H2.23606797749979V-2.23606797749979H6.708203932499369V2.23606797749979H2.23606797749979V6.708203932499369H-2.23606797749979V2.23606797749979H-6.708203932499369Z",transform:"translate(8,8)"}))),Object(N.jsx)(te.EuiFlexItem,{grow:!1},a)):Object(N.jsx)(te.EuiHealth,{color:i},a)}));function uu(e,t){return Object($d.m)(e.source)&&Object(I.e)("canUpdateJob")||t&&e.isTimeSeriesViewRecord||"mlcategory"===e.entityName||void 0!==e.customUrls}function pu(e,t,a,i,n,s,r,o,l,c,d,u){const p=[{name:Object(N.jsx)(te.EuiScreenReaderOnly,null,Object(N.jsx)("p",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.anomaliesTable.showDetailsColumn.screenReaderDescription",defaultMessage:"This column contains clickable controls for showing more details on each anomaly"}))),render:e=>Object(N.jsx)(te.EuiButtonIcon,{onClick:()=>c(e),iconType:l[e.rowId]?"arrowDown":"arrowRight","aria-label":l[e.rowId]?y.i18n.translate("xpack.ml.anomaliesTable.hideDetailsAriaLabel",{defaultMessage:"Hide details"}):y.i18n.translate("xpack.ml.anomaliesTable.showDetailsAriaLabel",{defaultMessage:"Show details"}),"data-row-id":e.rowId,"data-test-subj":"mlAnomaliesListRowDetailsToggle"})},{field:"time","data-test-subj":"mlAnomaliesListColumnTime",name:y.i18n.translate("xpack.ml.anomaliesTable.timeColumnName",{defaultMessage:"Time"}),dataType:"date",scope:"row",render:e=>function(e,t){return"hour"===t?Object(Ud.b)(e):"second"===t?Object(Ud.c)(e):Object(Ud.a)(e)}(e,n),textOnly:!0,sortable:!0},{field:"severity","data-test-subj":"mlAnomaliesListColumnSeverity",name:Object(N.jsx)(te.EuiToolTip,{content:y.i18n.translate("xpack.ml.overview.anomalyDetection.tableSeverityTooltip",{defaultMessage:"A normalized score between 0-100, which indicates the relative significance of the anomaly record results."})},Object(N.jsx)("span",null,y.i18n.translate("xpack.ml.anomaliesTable.severityColumnName",{defaultMessage:"Severity"}),Object(N.jsx)(te.EuiIcon,{size:"s",color:"subdued",type:"questionInCircle",className:"eui-alignTop"}))),render:(e,t)=>Object(N.jsx)(du,{score:e,multiBucketImpact:t.source.multi_bucket_impact}),sortable:!0},{field:"detector","data-test-subj":"mlAnomaliesListColumnDetector",name:y.i18n.translate("xpack.ml.anomaliesTable.detectorColumnName",{defaultMessage:"Detector"}),render:(e,t)=>Object(N.jsx)(Hd,{detectorDescription:e,numberOfRules:t.rulesLength}),textOnly:!0,sortable:!0}];if(e.some((e=>void 0!==e.entityValue))&&p.push({field:"entityValue","data-test-subj":"mlAnomaliesListColumnFoundFor",name:y.i18n.translate("xpack.ml.anomaliesTable.entityValueColumnName",{defaultMessage:"Found for"}),render:(e,t)=>Object(N.jsx)(Kd,{entityName:t.entityName,entityValue:e,filter:d,wrapText:!0}),textOnly:!0,sortable:!0}),e.some((e=>void 0!==e.influencers))&&p.push({field:"influencers","data-test-subj":"mlAnomaliesListColumnInfluencers",name:y.i18n.translate("xpack.ml.anomaliesTable.influencersColumnName",{defaultMessage:"Influenced by"}),render:e=>Object(N.jsx)(influencers_cell_InfluencersCell,{limit:5,influencers:e,influencerFilter:u}),textOnly:!0,sortable:!0}),e.some((e=>void 0!==e.actual))&&p.push({field:"actualSort","data-test-subj":"mlAnomaliesListColumnActual",name:Object(N.jsx)(te.EuiToolTip,{content:y.i18n.translate("xpack.ml.overview.anomalyDetection.tableActualTooltip",{defaultMessage:"The actual values in the anomaly record results."})},Object(N.jsx)("span",null,y.i18n.translate("xpack.ml.anomaliesTable.actualSortColumnName",{defaultMessage:"Actual"}),Object(N.jsx)(te.EuiIcon,{size:"s",color:"subdued",type:"questionInCircle",className:"eui-alignTop"}))),render:(e,t)=>{const a=nu.a.getFieldFormat(t.jobId,t.source.detector_index);return Object(su.b)(t.actual,t.source.function,a,t.source)},sortable:!0}),e.some((e=>void 0!==e.typical))){p.push({field:"typicalSort","data-test-subj":"mlAnomaliesListColumnTypical",name:Object(N.jsx)(te.EuiToolTip,{content:y.i18n.translate("xpack.ml.overview.anomalyDetection.tableTypicalTooltip",{defaultMessage:"The typical values in the anomaly record results."})},Object(N.jsx)("span",null,y.i18n.translate("xpack.ml.anomaliesTable.typicalSortColumnName",{defaultMessage:"Typical"}),Object(N.jsx)(te.EuiIcon,{size:"s",color:"subdued",type:"questionInCircle",className:"eui-alignTop"}))),render:(e,t)=>{const a=nu.a.getFieldFormat(t.jobId,t.source.detector_index);return Object(su.b)(t.typical,t.source.function,a,t.source)},sortable:!0});!0===e.some((e=>{const t=e.source.function;return"time_of_day"!==t&&"time_of_week"!==t}))&&p.push({field:"metricDescriptionSort","data-test-subj":"mlAnomaliesListColumnDescription",name:y.i18n.translate("xpack.ml.anomaliesTable.metricDescriptionSortColumnName",{defaultMessage:"Description"}),render:(e,t)=>Object(N.jsx)(qd,{actual:t.actual,typical:t.typical}),textOnly:!0,sortable:!0})}t&&t.length>1&&p.push({field:"jobId","data-test-subj":"mlAnomaliesListColumnJobID",name:y.i18n.translate("xpack.ml.anomaliesTable.jobIdColumnName",{defaultMessage:"Job ID"}),sortable:!0});!0===e.some((e=>"mlcategory"===e.entityName))&&p.push({"data-test-subj":"mlAnomaliesListColumnCategoryExamples",name:y.i18n.translate("xpack.ml.anomaliesTable.categoryExamplesColumnName",{defaultMessage:"Category examples"}),truncateText:!0,render:e=>{const t=Object(E.get)(a,[e.jobId,e.entityValue],[]);return Object(N.jsx)(te.EuiLink,{className:"mlAnomalyCategoryExamples__link",onClick:()=>c(e,ou)},t.map(((e,t)=>Object(N.jsx)("span",{key:`example${t}`,className:"category-example"},e))))},width:"13%"});return!0===e.some((e=>uu(e,r)))&&p.push({"data-test-subj":"mlAnomaliesListColumnAction",name:y.i18n.translate("xpack.ml.anomaliesTable.actionsColumnName",{defaultMessage:"Actions"}),render:e=>!0===uu(e,r)?Object(N.jsx)(iu,{anomaly:e,bounds:s,showViewSeriesLink:r,isAggregatedData:i,interval:n,showRuleEditorFlyout:o}):null}),p}function mu(e,t,a){return Object(N.jsx)(Kd,{entityName:e,entityValue:t,filter:a})}class anomaly_details_AnomalyDetails extends n.Component{constructor(e){super(e),this.state={showAllInfluencers:!1},void 0!==this.props.examples&&this.props.examples.length>0&&(this.tabs=[{id:"Details",name:y.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.detailsTitle",{defaultMessage:"Details"}),content:Object(N.jsx)(n.Fragment,null,Object(N.jsx)("div",{className:"ml-anomalies-table-details","data-test-subj":"mlAnomaliesListRowDetails"},this.renderDescription(),Object(N.jsx)(te.EuiSpacer,{size:"m"}),this.renderDetails(),this.renderInfluencers()))},{id:"category-examples",name:y.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.categoryExamplesTitle",{defaultMessage:"Category examples"}),content:Object(N.jsx)(n.Fragment,null,this.renderCategoryExamples())}])}toggleAllInfluencers(){this.setState({showAllInfluencers:!this.state.showAllInfluencers})}renderCategoryExamples(){const{examples:e,definition:t}=this.props;return Object(N.jsx)(te.EuiFlexGroup,{direction:"column",justifyContent:"center",gutterSize:"m",className:"mlAnomalyCategoryExamples"},void 0!==t&&t.terms&&Object(N.jsx)(n.Fragment,null,Object(N.jsx)(te.EuiFlexItem,{key:"example-terms"},Object(N.jsx)(te.EuiText,{size:"xs"},Object(N.jsx)("h4",{className:"mlAnomalyCategoryExamples__header"},y.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.termsTitle",{defaultMessage:"Terms"}))," ",Object(N.jsx)(te.EuiIconTip,{"aria-label":y.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.termsDescriptionAriaLabel",{defaultMessage:"Description"}),type:"questionInCircle",color:"subdued",size:"s",content:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.anomaliesTable.anomalyDetails.termsDescriptionTooltip",defaultMessage:"A space separated list of the common tokens that are matched in values of the category (may have been truncated to a max character limit of {maxChars})",values:{maxChars:lu}})})),Object(N.jsx)(te.EuiText,{size:"xs"},t.terms)),Object(N.jsx)(te.EuiSpacer,{size:"xs"})),void 0!==t&&t.regex&&Object(N.jsx)(n.Fragment,null,Object(N.jsx)(te.EuiFlexItem,{key:"example-regex"},Object(N.jsx)(te.EuiText,{size:"xs"},Object(N.jsx)("h4",{className:"mlAnomalyCategoryExamples__header"},y.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.regexTitle",{defaultMessage:"Regex"}))," ",Object(N.jsx)(te.EuiIconTip,{"aria-label":y.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.regexDescriptionAriaLabel",{defaultMessage:"Description"}),type:"questionInCircle",color:"subdued",size:"s",content:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.anomaliesTable.anomalyDetails.regexDescriptionTooltip",defaultMessage:"The regular expression that is used to search for values that match the category (may have been truncated to a max character limit of {maxChars})",values:{maxChars:lu}})})),Object(N.jsx)(te.EuiText,{size:"xs"},t.regex)),Object(N.jsx)(te.EuiSpacer,{size:"xs"})),e.map(((e,a)=>Object(N.jsx)(te.EuiFlexItem,{key:`example${a}`},0===a&&void 0!==t&&Object(N.jsx)(te.EuiText,{size:"s"},Object(N.jsx)("h4",null,y.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.examplesTitle",{defaultMessage:"Examples"}))),Object(N.jsx)("span",{className:"mlAnomalyCategoryExamples__item"},e)))))}renderDescription(){const e=this.props.anomaly,t=e.source;let a,i=y.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.anomalyInLabel",{defaultMessage:"{anomalySeverity} anomaly in {anomalyDetector}",values:{anomalySeverity:Object($d.i)(e.severity).label,anomalyDetector:e.detector}});return void 0!==e.entityName&&(i+=y.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.foundForLabel",{defaultMessage:" found for {anomalyEntityName} {anomalyEntityValue}",values:{anomalyEntityName:e.entityName,anomalyEntityValue:e.entityValue}})),void 0!==t.partition_field_name&&t.partition_field_name!==e.entityName&&(i+=y.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.detectedInLabel",{defaultMessage:" detected in {sourcePartitionFieldName} {sourcePartitionFieldValue}",values:{sourcePartitionFieldName:t.partition_field_name,sourcePartitionFieldValue:t.partition_field_value}})),void 0!==t.correlated_by_field_value&&(a=y.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.multivariateDescription",{defaultMessage:"multivariate correlations found in {sourceByFieldName}; {sourceByFieldValue} is considered anomalous given {sourceCorrelatedByFieldValue}",values:{sourceByFieldName:t.by_field_name,sourceByFieldValue:t.by_field_value,sourceCorrelatedByFieldValue:t.correlated_by_field_value}})),Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(te.EuiText,{size:"xs"},Object(N.jsx)("h4",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.anomaliesTable.anomalyDetails.descriptionTitle",defaultMessage:"Description"})),i),void 0!==a&&Object(N.jsx)(te.EuiText,{size:"xs"},a))}renderDetails(){const e=function(e,t){const a=e.source;let i=[];const n=a.causes||[];let s,r;1===n.length?void 0!==n[0].by_field_name&&(s=n[0].by_field_name,r=n[0].by_field_value):i=n.map((e=>{const t=Object(E.pick)(e,"typical","actual","probability");return t.entityName=e.by_field_name?e.by_field_name:e.over_field_name,t.entityValue=e.by_field_value?e.by_field_value:e.over_field_value,t}));const o=[];void 0!==a.partition_field_value&&o.push({title:a.partition_field_name,description:mu(a.partition_field_name,a.partition_field_value,t)}),void 0!==a.by_field_value&&o.push({title:a.by_field_name,description:mu(a.by_field_name,a.by_field_value,t)}),void 0!==s&&o.push({title:s,description:mu(s,r,t)}),void 0!==a.over_field_value&&o.push({title:a.over_field_name,description:mu(a.over_field_name,a.over_field_value,t)});const l=a.timestamp;let c=`${Object(Ud.c)(l)}`;if(void 0!==a.bucket_span){const e=l+1e3*a.bucket_span;c=y.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.anomalyTimeRangeLabel",{defaultMessage:"{anomalyTime} to {anomalyEndTime}",values:{anomalyTime:Object(Ud.c)(l),anomalyEndTime:Object(Ud.c)(e)}})}o.push({title:y.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.timeTitle",{defaultMessage:"Time"}),description:c}),o.push({title:y.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.functionTitle",{defaultMessage:"Function"}),description:a.function!==Lt.b.METRIC?a.function:a.function_description}),void 0!==a.field_name&&o.push({title:y.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.fieldNameTitle",{defaultMessage:"Field name"}),description:a.field_name});const d=a.function_description||"";return void 0!==e.actual&&!0===Object($d.n)(d)&&o.push({title:y.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.actualTitle",{defaultMessage:"Actual"}),description:Object(su.b)(e.actual,a.function,void 0,a)}),void 0!==e.typical&&!0===Object($d.o)(d)&&o.push({title:y.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.typicalTitle",{defaultMessage:"Typical"}),description:Object(su.b)(e.typical,a.function,void 0,a)}),o.push({title:y.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.jobIdTitle",{defaultMessage:"Job ID"}),description:e.jobId}),void 0!==a.multi_bucket_impact&&a.multi_bucket_impact>=cu.a.LOW&&o.push({title:y.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.multiBucketImpactTitle",{defaultMessage:"Multi-bucket impact"}),description:Object($d.h)(a.multi_bucket_impact)}),o.push({title:Object(N.jsx)(te.EuiToolTip,{position:"left",content:y.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.recordScoreTooltip",{defaultMessage:"A normalized score between 0-100, which indicates the relative significance of the anomaly record result. This value might change as new data is analyzed."})},Object(N.jsx)("span",null,y.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.recordScoreTitle",{defaultMessage:"Record score"}),Object(N.jsx)(te.EuiIcon,{size:"s",color:"subdued",type:"questionInCircle",className:"eui-alignTop"}))),description:Math.floor(1e3*a.record_score)/1e3}),o.push({title:Object(N.jsx)(te.EuiToolTip,{position:"left",content:y.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.initialRecordScoreTooltip",{defaultMessage:"A normalized score between 0-100, which indicates the relative significance of the anomaly record when the bucket was initially processed."})},Object(N.jsx)("span",null,y.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.initialRecordScoreTitle",{defaultMessage:"Initial record score"}),Object(N.jsx)(te.EuiIcon,{size:"s",color:"subdued",type:"questionInCircle",className:"eui-alignTop"}))),description:Math.floor(1e3*a.initial_record_score)/1e3}),o.push({title:y.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.probabilityTitle",{defaultMessage:"Probability"}),description:void 0!==a.probability?Number.parseFloat(a.probability).toPrecision(3):""}),i.length>1&&i.forEach(((e,t)=>{const i=0===t?y.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.causeValuesTitle",{defaultMessage:"{causeEntityName} values",values:{causeEntityName:e.entityName}}):"",n=y.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.causeValuesDescription",{defaultMessage:"{causeEntityValue} (actual {actualValue}, typical {typicalValue}, probability {probabilityValue})",values:{causeEntityValue:e.entityValue,actualValue:Object(su.b)(e.actual,a.function),typicalValue:Object(su.b)(e.typical,a.function),probabilityValue:e.probability}});o.push({title:i,description:n})})),o}(this.props.anomaly,this.props.filter),t=Object(E.get)(this.props.anomaly,"source.is_interim",!1);return Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(te.EuiText,{size:"xs"},!0===this.props.isAggregatedData?Object(N.jsx)("h4",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.anomaliesTable.anomalyDetails.detailsOnHighestSeverityAnomalyTitle",defaultMessage:"Details on highest severity anomaly"})):Object(N.jsx)("h4",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.anomaliesTable.anomalyDetails.anomalyDetailsTitle",defaultMessage:"Anomaly details"})),!0===t&&Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(te.EuiIcon,{type:"alert"}),Object(N.jsx)("span",{className:"interim-result"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.anomaliesTable.anomalyDetails.interimResultLabel",defaultMessage:"Interim result"})))),Object(N.jsx)(te.EuiDescriptionList,{type:"column",listItems:e,className:"anomaly-description-list"}))}renderInfluencers(){const e=this.props.anomaly.influencers;let t=[],a=0,i=0;if(void 0!==e&&(i=!0===this.state.showAllInfluencers?e.length:Math.min(this.props.influencersLimit,e.length),a=Math.max(e.length-i,0),1===a&&(i++,a=0),t=function(e,t,a){const i=[];for(let n=0;n<a;n++)Object.keys(e[n]).forEach((a=>{const s=e[n][a];i.push({title:a,description:mu(a,s,t)})}));return i}(e,this.props.influencerFilter,i)),t.length>0)return Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(te.EuiSpacer,{size:"m"}),Object(N.jsx)(te.EuiText,{size:"xs"},Object(N.jsx)("h4",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.anomaliesTable.anomalyDetails.influencersTitle",defaultMessage:"Influencers"}))),Object(N.jsx)(te.EuiDescriptionList,{type:"column",listItems:t,className:"anomaly-description-list"}),a>0&&Object(N.jsx)(te.EuiLink,{onClick:()=>this.toggleAllInfluencers()},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.anomaliesTable.anomalyDetails.anomalyDescriptionListMoreLinkText",defaultMessage:"and {othersCount} more",values:{othersCount:a}})),i>this.props.influencersLimit+1&&Object(N.jsx)(te.EuiLink,{onClick:()=>this.toggleAllInfluencers()},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.anomaliesTable.anomalyDetails.anomalyDescriptionShowLessLinkText",defaultMessage:"Show less"})))}render(){const{tabIndex:e}=this.props;return void 0!==this.tabs?Object(N.jsx)(te.EuiTabbedContent,{tabs:this.tabs,size:"s",initialSelectedTab:this.tabs[e],onTabClick:()=>{}}):Object(N.jsx)("div",{className:"ml-anomalies-table-details","data-test-subj":"mlAnomaliesListRowDetails"},this.renderDescription(),Object(N.jsx)(te.EuiSpacer,{size:"m"}),this.renderDetails(),this.renderInfluencers())}}var bu=a(210);function hu({job:e,detector:t,anomaly:a}){const i=[{title:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.ruleEditor.detectorDescriptionList.jobIdTitle",defaultMessage:"Job ID"}),description:e.job_id},{title:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.ruleEditor.detectorDescriptionList.detectorTitle",defaultMessage:"Detector"}),description:t.detector_description}];if(void 0!==a.actual){const e=Object(su.b)(a.actual,a.source.function),t=Object(su.b)(a.typical,a.source.function);i.push({title:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.ruleEditor.detectorDescriptionList.selectedAnomalyTitle",defaultMessage:"Selected anomaly"}),description:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.ruleEditor.detectorDescriptionList.selectedAnomalyDescription",defaultMessage:"actual {actual}, typical {typical}",values:{actual:e,typical:t}})})}return Object(N.jsx)(te.EuiDescriptionList,{className:"rule-detector-description-list",type:"column",listItems:i})}var fu=a(29);function gu({actions:e,onSkipResultChange:t,onSkipModelUpdateChange:a}){return Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(te.EuiText,null,Object(N.jsx)("p",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.ruleEditor.actionsSection.chooseActionsDescription",defaultMessage:"Choose the actions to take when the job rule matches an anomaly."}))),Object(N.jsx)(te.EuiSpacer,{size:"s"}),Object(N.jsx)(te.EuiFlexGroup,{alignItems:"center",gutterSize:"s",responsive:!1},Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiCheckbox,{id:"skip_result_cb",label:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.ruleEditor.actionsSection.skipResultLabel",defaultMessage:"Skip result (recommended)"}),checked:e.indexOf(fu.a.SKIP_RESULT)>-1,onChange:t})),Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiIconTip,{content:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.ruleEditor.actionsSection.resultWillNotBeCreatedTooltip",defaultMessage:"The result will not be created."}),size:"s",position:"right"}))),Object(N.jsx)(te.EuiSpacer,{size:"s"}),Object(N.jsx)(te.EuiFlexGroup,{alignItems:"center",gutterSize:"s",responsive:!1},Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiCheckbox,{id:"skip_model_update_cb",label:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.ruleEditor.actionsSection.skipModelUpdateLabel",defaultMessage:"Skip model update"}),checked:e.indexOf(fu.a.SKIP_MODEL_UPDATE)>-1,onChange:a})),Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiIconTip,{content:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.ruleEditor.actionsSection.valueWillNotBeUsedToUpdateModelTooltip",defaultMessage:"The value for that series will not be used to update the model."}),size:"s",position:"right"}))))}function ju(){return{applies_to:fu.b.ACTUAL,operator:fu.e.LESS_THAN,value:1}}function xu(){return{actions:[fu.a.SKIP_RESULT],conditions:[]}}function vu(e){let t=!1;if(e.actions.length>0){const a=e.conditions;if(void 0!==a&&a.length>0)t=!0;else{const a=e.scope;void 0!==a&&(t=Object.keys(a).some((e=>!0===a[e].enabled)))}}return t}function yu(e,t,a){const i=e.job_id,n={detectors:[{detector_index:t,custom_rules:a}]};let s={};return void 0!==e.custom_settings&&(s={...e.custom_settings},Object(Te.r)(s),n.custom_settings=s),new Promise(((e,t)=>{ge.ml.updateJob({jobId:i,job:n}).then((()=>{re.a.refreshJob(i).then((()=>{e({success:!0})})).catch((e=>{t(e)}))})).catch((e=>{t(e)}))}))}function Ou(e){const{actions:t,conditions:a,scope:i}=e;let n="",s="",r="";if(t.forEach(((e,t)=>{switch(t>0&&(n+=" AND "),e){case fu.a.SKIP_RESULT:n+=y.i18n.translate("xpack.ml.ruleEditor.ruleDescription.resultActionTypeText",{defaultMessage:"result",description:"Part of composite text: xpack.ml.ruleEditor.ruleDescription.[actionName]ActionTypeText +xpack.ml.ruleEditor.ruleDescription.conditionsText + xpack.ml.ruleEditor.ruleDescription.filtersText"});break;case fu.a.SKIP_MODEL_UPDATE:n+=y.i18n.translate("xpack.ml.ruleEditor.ruleDescription.modelUpdateActionTypeText",{defaultMessage:"model update",description:"Part of composite text: xpack.ml.ruleEditor.ruleDescription.[actionName]ActionTypeText + xpack.ml.ruleEditor.ruleDescription.conditionsText + xpack.ml.ruleEditor.ruleDescription.filtersText"})}})),void 0!==a&&a.forEach(((e,t)=>{t>0&&(s+=" AND "),s+=y.i18n.translate("xpack.ml.ruleEditor.ruleDescription.conditionsText",{defaultMessage:"{appliesTo} is {operator} {value}",values:{appliesTo:wu(e.applies_to),operator:_u(e.operator),value:e.value},description:"Part of composite text: xpack.ml.ruleEditor.ruleDescription.[actionName]ActionTypeText + xpack.ml.ruleEditor.ruleDescription.conditionsText + xpack.ml.ruleEditor.ruleDescription.filtersText"})})),void 0!==i){void 0!==a&&a.length>0&&(r+=" AND ");Object.keys(i).forEach(((e,t)=>{t>0&&(r+=" AND ");const a=i[e];r+=y.i18n.translate("xpack.ml.ruleEditor.ruleDescription.filtersText",{defaultMessage:"{fieldName} is {filterType} {filterId}",values:{fieldName:e,filterType:Eu(a.filter_type),filterId:a.filter_id},description:"Part of composite text: xpack.ml.ruleEditor.ruleDescription.[actionName]ActionTypeText + xpack.ml.ruleEditor.ruleDescription.conditionsText + xpack.ml.ruleEditor.ruleDescription.filtersText"})}))}return y.i18n.translate("xpack.ml.ruleEditor.ruleDescription",{defaultMessage:"skip {actions} when {conditions}{filters}",values:{actions:n,conditions:s,filters:r},description:"Composite text: xpack.ml.ruleEditor.ruleDescription.[actionName]ActionTypeText + xpack.ml.ruleEditor.ruleDescription.conditionsText + xpack.ml.ruleEditor.ruleDescription.filtersText. (Example: skip model update when actual is less than 1 AND ip is in xxx)"})}function Eu(e){switch(e){case fu.d.INCLUDE:return y.i18n.translate("xpack.ml.ruleEditor.includeFilterTypeText",{defaultMessage:"in"});case fu.d.EXCLUDE:return y.i18n.translate("xpack.ml.ruleEditor.excludeFilterTypeText",{defaultMessage:"not in"});default:return void 0!==e?e:""}}function wu(e){switch(e){case fu.b.ACTUAL:return y.i18n.translate("xpack.ml.ruleEditor.actualAppliesTypeText",{defaultMessage:"actual"});case fu.b.TYPICAL:return y.i18n.translate("xpack.ml.ruleEditor.typicalAppliesTypeText",{defaultMessage:"typical"});case fu.b.DIFF_FROM_TYPICAL:return y.i18n.translate("xpack.ml.ruleEditor.diffFromTypicalAppliesTypeText",{defaultMessage:"diff from typical"});default:return void 0!==e?e:""}}function _u(e){switch(e){case fu.e.LESS_THAN:return y.i18n.translate("xpack.ml.ruleEditor.lessThanOperatorTypeText",{defaultMessage:"less than"});case fu.e.LESS_THAN_OR_EQUAL:return y.i18n.translate("xpack.ml.ruleEditor.lessThanOrEqualToOperatorTypeText",{defaultMessage:"less than or equal to"});case fu.e.GREATER_THAN:return y.i18n.translate("xpack.ml.ruleEditor.greaterThanOperatorTypeText",{defaultMessage:"greater than"});case fu.e.GREATER_THAN_OR_EQUAL:return y.i18n.translate("xpack.ml.ruleEditor.greaterThanOrEqualToOperatorTypeText",{defaultMessage:"greater than or equal to"});default:return void 0!==e?e:""}}const Su={zIndex:"200"};class condition_expression_ConditionExpression extends n.Component{constructor(e){super(e),Ce()(this,"openAppliesTo",(()=>{this.setState({isAppliesToOpen:!0,isOperatorValueOpen:!1})})),Ce()(this,"closeAppliesTo",(()=>{this.setState({isAppliesToOpen:!1})})),Ce()(this,"openOperatorValue",(()=>{this.setState({isAppliesToOpen:!1,isOperatorValueOpen:!0})})),Ce()(this,"closeOperatorValue",(()=>{this.setState({isOperatorValueOpen:!1})})),Ce()(this,"changeAppliesTo",(e=>{const{index:t,operator:a,value:i,updateCondition:n}=this.props;n(t,e.target.value,a,i)})),Ce()(this,"changeOperator",(e=>{const{index:t,appliesTo:a,value:i,updateCondition:n}=this.props;n(t,a,e.target.value,i)})),Ce()(this,"changeValue",(e=>{const{index:t,appliesTo:a,operator:i,updateCondition:n}=this.props;n(t,a,i,+e.target.value)})),this.state={isAppliesToOpen:!1,isOperatorValueOpen:!1}}renderAppliesToPopover(){return Object(N.jsx)("div",{style:Su},Object(N.jsx)(te.EuiPopoverTitle,null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.ruleEditor.conditionExpression.appliesToPopoverTitle",defaultMessage:"When"})),Object(N.jsx)("div",{className:"euiExpression",style:{width:200}},Object(N.jsx)(te.EuiSelect,{value:this.props.appliesTo,onChange:this.changeAppliesTo,options:[{value:fu.b.ACTUAL,text:wu(fu.b.ACTUAL)},{value:fu.b.TYPICAL,text:wu(fu.b.TYPICAL)},{value:fu.b.DIFF_FROM_TYPICAL,text:wu(fu.b.DIFF_FROM_TYPICAL)}]})))}renderOperatorValuePopover(){return Object(N.jsx)("div",{style:Su},Object(N.jsx)(te.EuiPopoverTitle,null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.ruleEditor.conditionExpression.operatorValuePopoverTitle",defaultMessage:"Is"})),Object(N.jsx)("div",{className:"euiExpression"},Object(N.jsx)(te.EuiFlexGroup,{style:{maxWidth:450}},Object(N.jsx)(te.EuiFlexItem,{grow:!1,style:{width:250}},Object(N.jsx)(te.EuiSelect,{value:this.props.operator,onChange:this.changeOperator,options:[{value:fu.e.LESS_THAN,text:_u(fu.e.LESS_THAN)},{value:fu.e.LESS_THAN_OR_EQUAL,text:_u(fu.e.LESS_THAN_OR_EQUAL)},{value:fu.e.GREATER_THAN,text:_u(fu.e.GREATER_THAN)},{value:fu.e.GREATER_THAN_OR_EQUAL,text:_u(fu.e.GREATER_THAN_OR_EQUAL)}]})),Object(N.jsx)(te.EuiFlexItem,{grow:!1,style:{width:200}},Object(N.jsx)(te.EuiFieldNumber,{value:+this.props.value,onChange:this.changeValue})))))}render(){const{index:e,appliesTo:t,operator:a,value:i,deleteCondition:n}=this.props;return Object(N.jsx)(te.EuiFlexGroup,{gutterSize:"m"},Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiPopover,{id:"appliesToPopover",button:Object(N.jsx)(te.EuiExpression,{description:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.ruleEditor.conditionExpression.appliesToButtonLabel",defaultMessage:"when"}),value:wu(t),isActive:this.state.isAppliesToOpen,onClick:this.openAppliesTo}),isOpen:this.state.isAppliesToOpen,closePopover:this.closeAppliesTo,panelPaddingSize:"none",ownFocus:!0,anchorPosition:"downLeft"},this.renderAppliesToPopover())),Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiPopover,{id:"operatorValuePopover",button:Object(N.jsx)(te.EuiExpression,{description:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.ruleEditor.conditionExpression.operatorValueButtonLabel",defaultMessage:"is {operator}",values:{operator:_u(a)}}),value:`${i}`,isActive:this.state.isOperatorValueOpen,onClick:this.openOperatorValue}),isOpen:this.state.isOperatorValueOpen,closePopover:this.closeOperatorValue,panelPaddingSize:"none",ownFocus:!0,withTitle:!0,anchorPosition:"downLeft"},this.renderOperatorValuePopover())),Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiButtonIcon,{size:"s",color:"danger",onClick:()=>n(e),iconType:"trash","aria-label":y.i18n.translate("xpack.ml.ruleEditor.conditionExpression.deleteConditionButtonAriaLabel",{defaultMessage:"Delete condition"})})))}}function Mu({isEnabled:e,conditions:t,addCondition:a,updateCondition:i,deleteCondition:n}){if(!1===e)return null;let r=[];return void 0!==t&&(r=t.map(((e,t)=>Object(N.jsx)(condition_expression_ConditionExpression,{key:t,index:t,appliesTo:e.applies_to,operator:e.operator,value:e.value,updateCondition:i,deleteCondition:n})))),Object(N.jsx)(s.a.Fragment,null,r,Object(N.jsx)(te.EuiSpacer,{size:"s"}),Object(N.jsx)(te.EuiButtonEmpty,{onClick:()=>a()},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.ruleEditor.conditionsSection.addNewConditionButtonLabel",defaultMessage:"Add new condition"})))}const ku={zIndex:"200"};function Cu(e){return e.map((e=>({value:e,text:e})))}class scope_expression_ScopeExpression extends n.Component{constructor(e){super(e),Ce()(this,"openFilterList",(()=>{this.setState({isFilterListOpen:!0})})),Ce()(this,"closeFilterList",(()=>{this.setState({isFilterListOpen:!1})})),Ce()(this,"onChangeFilterType",(e=>{const{fieldName:t,filterId:a,enabled:i,updateScope:n}=this.props;n(t,a,e.target.value,i)})),Ce()(this,"onChangeFilterId",(e=>{const{fieldName:t,filterType:a,enabled:i,updateScope:n}=this.props;n(t,e.target.value,a,i)})),Ce()(this,"onEnableChange",(e=>{const{fieldName:t,filterId:a,filterType:i,updateScope:n}=this.props;n(t,a,i,e.target.checked)})),this.state={isFilterListOpen:!1}}renderFilterListPopover(){const{filterId:e,filterType:t,filterListIds:a}=this.props;return Object(N.jsx)("div",{style:ku},Object(N.jsx)(te.EuiPopoverTitle,null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.ruleEditor.scopeExpression.scopeFilterTypePopoverTitle",defaultMessage:"Is"})),Object(N.jsx)("div",{className:"euiExpression"},Object(N.jsx)(te.EuiFlexGroup,{style:{maxWidth:450}},Object(N.jsx)(te.EuiFlexItem,{grow:!1,style:{width:150}},Object(N.jsx)(te.EuiSelect,{value:t,onChange:this.onChangeFilterType,options:[{value:fu.d.INCLUDE,text:Eu(fu.d.INCLUDE)},{value:fu.d.EXCLUDE,text:Eu(fu.d.EXCLUDE)}]})),Object(N.jsx)(te.EuiFlexItem,{grow:!1,style:{width:300}},Object(N.jsx)(te.EuiSelect,{value:e,onChange:this.onChangeFilterId,options:Cu(a)})))))}render(){const{fieldName:e,filterId:t,filterType:a,enabled:i,filterListIds:n}=this.props;return Object(N.jsx)(te.EuiFlexGroup,{gutterSize:"m"},Object(N.jsx)(te.EuiFlexItem,{grow:!1,className:"scope-field-checkbox"},Object(N.jsx)(te.EuiCheckbox,{id:`scope_cb_${e}`,checked:i,onChange:this.onEnableChange})),Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiExpression,{className:"scope-field-button",description:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.ruleEditor.scopeExpression.scopeFieldWhenLabel",defaultMessage:"when"}),value:e,isActive:!1,onClick:e=>e.preventDefault()})),void 0!==n&&n.length>0&&Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiPopover,{id:"operatorValuePopover",button:Object(N.jsx)(te.EuiExpression,{description:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.ruleEditor.scopeExpression.scopeFilterTypeButtonLabel",defaultMessage:"is {filterType}",values:{filterType:Eu(a)}}),value:t||"",isActive:this.state.isFilterListOpen,onClick:this.openFilterList}),isOpen:this.state.isFilterListOpen,closePopover:this.closeFilterList,panelPaddingSize:"none",ownFocus:!0,anchorPosition:"downLeft"},this.renderFilterListPopover())))}}function Tu(){const e=Object(f.d)(),t=Object(f.e)();return Object(N.jsx)(te.EuiCallOut,{title:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.ruleEditor.scopeSection.noFilterListsConfiguredTitle",defaultMessage:"No filter lists configured"}),iconType:"gear"},Object(N.jsx)("p",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.ruleEditor.scopeSection.createFilterListsDescription",defaultMessage:"To configure scope, you must first use the {filterListsLink} settings page to create the list of values you want to include or exclude in the job rule.",values:{filterListsLink:Object(N.jsx)(te.EuiLink,{onClick:async()=>{const a=await e.getUrl({page:T.b.FILTER_LISTS_MANAGE});await t(a,!0)}},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.ruleEditor.scopeSection.createFilterListsDescription.filterListsLinkText",defaultMessage:"Filter Lists"}))}})))}function Fu(){return Object(N.jsx)(te.EuiCallOut,{title:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.ruleEditor.scopeSection.noPermissionToViewFilterListsTitle",defaultMessage:"You do not have permission to view filter lists"}),iconType:"gear"})}function Iu({isEnabled:e,onEnabledChange:t,partitioningFieldNames:a,filterListIds:i,scope:n,updateScope:r}){const o=Object(I.e)("canGetFilters");if(null===a||0===a.length)return null;let l;return l=i.length>0?a.map(((e,t)=>{let a;return a=void 0!==n&&void 0!==n[e]?n[e]:function(e){const t={filter_type:fu.d.INCLUDE,enabled:!1};return void 0!==e&&e.length>0&&(t.filter_id=e[0]),t}(i),Object(N.jsx)(scope_expression_ScopeExpression,{key:t,fieldName:e,filterId:a.filter_id,filterType:a.filter_type,enabled:a.enabled,filterListIds:i,updateScope:r})})):!1===o?Object(N.jsx)(Fu,null):Object(N.jsx)(Tu,null),Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(te.EuiTitle,null,Object(N.jsx)("h2",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.ruleEditor.scopeSection.scopeTitle",defaultMessage:"Scope"}))),Object(N.jsx)(te.EuiSpacer,{size:"s"}),Object(N.jsx)(te.EuiCheckbox,{id:"enable_scope_checkbox",label:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.ruleEditor.scopeSection.addFilterListLabel",defaultMessage:"Add a filter list to limit where the job rule applies."}),checked:e,onChange:t}),Object(N.jsx)(te.EuiSpacer,{size:"s"}),e&&Object(N.jsx)(s.a.Fragment,null,l),Object(N.jsx)(te.EuiSpacer,{size:"xxl"}))}function Du({fieldValue:e,filterId:t,addItemToFilterList:a}){return Object(N.jsx)(te.EuiLink,{onClick:()=>a(e,t,!0)},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.ruleEditor.addValueToFilterListLinkText",defaultMessage:"Add {fieldValue} to {filterId}",values:{fieldValue:e,filterId:t}}))}class delete_rule_modal_DeleteRuleModal extends n.Component{constructor(e){super(e),Ce()(this,"deleteRule",(()=>{const{ruleIndex:e,deleteRuleAtIndex:t}=this.props;t(e),this.closeModal()})),Ce()(this,"closeModal",(()=>{this.setState({isModalVisible:!1})})),Ce()(this,"showModal",(()=>{this.setState({isModalVisible:!0})})),this.state={isModalVisible:!1}}render(){let e;return this.state.isModalVisible&&(e=Object(N.jsx)(te.EuiConfirmModal,{title:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.ruleEditor.deleteRuleModal.deleteRuleTitle",defaultMessage:"Delete rule?"}),onCancel:this.closeModal,onConfirm:this.deleteRule,buttonColor:"danger",cancelButtonText:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.ruleEditor.deleteRuleModal.cancelButtonLabel",defaultMessage:"Cancel"}),confirmButtonText:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.ruleEditor.deleteRuleModal.deleteButtonLabel",defaultMessage:"Delete"}),defaultFocusedButton:te.EUI_MODAL_CONFIRM_BUTTON})),Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(te.EuiLink,{color:"danger",onClick:()=>this.showModal()},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.ruleEditor.deleteRuleModal.deleteRuleLinkText",defaultMessage:"Delete rule"})),e)}}class edit_condition_link_EditConditionLink extends n.Component{constructor(e){super(e),Ce()(this,"onChangeValue",(e=>{const t=e.target.value;this.setState({value:""!==t?+t:""})})),Ce()(this,"onUpdateClick",(()=>{const{conditionIndex:e,updateConditionValue:t}=this.props;t(e,this.state.value)}));let t="";const a=this.props.anomaly,i=function(e,t){let a,i;const n=e.actual;void 0!==n&&(a=Array.isArray(n)?n[0]:n);const s=e.typical;switch(void 0!==s&&(i=Array.isArray(s)?s[0]:s),t){case fu.b.ACTUAL:return a;case fu.b.TYPICAL:return i;case fu.b.DIFF_FROM_TYPICAL:if(void 0!==n&&void 0!==s)return Math.abs(a-i)}}(a,e.appliesTo);void 0!==i&&(t=+Object(su.b)(i,a.source.function)),this.state={value:t}}render(){const e=this.state.value;return Object(N.jsx)(te.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiText,null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.ruleEditor.editConditionLink.updateRuleConditionFromText",defaultMessage:"Update rule condition from {conditionValue} to",values:{conditionValue:this.props.conditionValue}}))),Object(N.jsx)(te.EuiFlexItem,{grow:!1,className:"condition-edit-value-field"},Object(N.jsx)(te.EuiFieldNumber,{placeholder:y.i18n.translate("xpack.ml.ruleEditor.editConditionLink.enterValuePlaceholder",{defaultMessage:"Enter value"}),compressed:!0,value:e,onChange:this.onChangeValue,"aria-label":y.i18n.translate("xpack.ml.ruleEditor.editConditionLink.enterNumericValueForConditionAriaLabel",{defaultMessage:"Enter numeric value for condition"})})),""!==e&&Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiLink,{size:"s",onClick:()=>this.onUpdateClick()},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.ruleEditor.editConditionLink.updateLinkText",defaultMessage:"Update"}))))}}class rule_action_panel_RuleActionPanel extends n.Component{constructor(e){super(e),Ce()(this,"getEditRuleLink",(()=>{const{ruleIndex:e,setEditRuleIndex:t}=this.props;return Object(N.jsx)(te.EuiLink,{onClick:()=>t(e)},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleActionPanel.editRuleLinkText",defaultMessage:"Edit rule"}))})),Ce()(this,"getDeleteRuleLink",(()=>{const{ruleIndex:e,deleteRuleAtIndex:t}=this.props;return Object(N.jsx)(delete_rule_modal_DeleteRuleModal,{ruleIndex:e,deleteRuleAtIndex:t})})),Ce()(this,"getQuickEditConditionLink",(()=>{const e=this.rule.conditions;let t=null;return void 0!==this.rule.conditions&&1===e.length&&(t=Object(N.jsx)(edit_condition_link_EditConditionLink,{conditionIndex:0,conditionValue:e[0].value,appliesTo:e[0].applies_to,anomaly:this.props.anomaly,updateConditionValue:this.updateConditionValue})),t})),Ce()(this,"getQuickAddToFilterListLink",(()=>{const{anomaly:e,addItemToFilterList:t}=this.props,a=this.rule.scope,i=Object.keys(a)[0],n=e.source[i],s=a[i].filter_id;return Object(N.jsx)(Du,{fieldValue:n[0],filterId:s,addItemToFilterList:t})})),Ce()(this,"updateConditionValue",((e,t)=>{const{job:a,anomaly:i,ruleIndex:n,updateRuleAtIndex:s}=this.props,r=a.analysis_config.detectors[i.detectorIndex],o=Object(E.cloneDeep)(r.custom_rules[n]),l=o.conditions;e<l.length&&(l[e].value=t),s(n,o)}));const{job:t,anomaly:a,ruleIndex:i}=this.props,n=t.analysis_config.detectors[a.detectorIndex].custom_rules;void 0!==n&&i<n.length&&(this.rule=n[i]),this.state={showAddToFilterListLink:!1}}componentDidMount(){const e=this.rule.scope;if(void 0!==e&&1===Object.keys(e).length){const t=Object.keys(e)[0],a=this.props.anomaly.source[t];if(void 0!==e[t]&&void 0!==a&&1===a.length&&a[0].length>0){const i=e[t].filter_id;ge.ml.filters.filters({filterId:i}).then((e=>{-1===e.items.indexOf(a[0])&&this.setState({showAddToFilterListLink:!0})})).catch((e=>{console.log(`Error loading filter ${i}:`,e)}))}}}render(){if(void 0===this.rule)return null;const e=[{title:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleActionPanel.ruleTitle",defaultMessage:"Rule"}),description:Ou(this.rule,this.props.anomaly)},{title:"",description:this.getEditRuleLink()},{title:"",description:this.getDeleteRuleLink()}],t=this.getQuickEditConditionLink();if(null!==t&&e.splice(1,0,{title:"",description:t}),!0===this.state.showAddToFilterListLink){const t=this.getQuickAddToFilterListLink();e.splice(e.length-2,0,{title:"",description:t})}return e[1].title=Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleActionPanel.actionsTitle",defaultMessage:"Actions"}),Object(N.jsx)(te.EuiPanel,{paddingSize:"m",className:"select-rule-action-panel"},Object(N.jsx)(te.EuiDescriptionList,{type:"column",listItems:e}))}}function Au({job:e,anomaly:t,setEditRuleIndex:a,updateRuleAtIndex:i,deleteRuleAtIndex:n,addItemToFilterList:r}){const o=t.detectorIndex,l=e.analysis_config.detectors[o],c=l.custom_rules||[];let d;return c.length>0&&(d=c.map(((o,l)=>Object(N.jsx)(s.a.Fragment,{key:`rule_panel_${l}_${c.length}`},Object(N.jsx)(rule_action_panel_RuleActionPanel,{job:e,ruleIndex:l,anomaly:t,setEditRuleIndex:a,updateRuleAtIndex:i,deleteRuleAtIndex:n,addItemToFilterList:r}),Object(N.jsx)(te.EuiSpacer,{size:"l"}))))),Object(N.jsx)("div",{className:"select-rule-action"},c.length>0&&Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(hu,{job:e,detector:l,anomaly:t}),Object(N.jsx)(te.EuiSpacer,{size:"m"}),d,Object(N.jsx)(te.EuiSpacer,{size:"m"}),Object(N.jsx)(te.EuiText,{style:{display:"inline"}},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.ruleEditor.selectRuleAction.orText",defaultMessage:"Or "}))),Object(N.jsx)(te.EuiLink,{onClick:()=>a(c.length)},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.ruleEditor.selectRuleAction.createRuleLinkText",defaultMessage:"create a rule"})))}class rule_editor_flyout_RuleEditorFlyoutUI extends n.Component{constructor(e){super(e),Ce()(this,"showFlyout",(e=>{let t=-1;const a=re.a.getJob(e.jobId);if(void 0===a){const{toasts:t}=this.props.kibana.services.notifications;return t.addDanger(y.i18n.translate("xpack.ml.ruleEditor.ruleEditorFlyout.unableToConfigureRulesNotificationMesssage",{defaultMessage:"Unable to configure job rules as an error occurred obtaining details for job ID {jobId}",values:{jobId:e.jobId}})),void this.setState({job:a,isFlyoutVisible:!1})}this.partitioningFieldNames=Object(Te.h)(a,e.detectorIndex);const i=e.detectorIndex;void 0===a.analysis_config.detectors[i].custom_rules&&(t=0);let n=!1;0===t&&(n=0===this.partitioningFieldNames.length),this.setState({anomaly:e,job:a,ruleIndex:t,isConditionsEnabled:n,isScopeEnabled:!1,isFlyoutVisible:!0}),this.partitioningFieldNames.length>0&&this.canGetFilters&&ge.ml.filters.filters().then((e=>{const t=e.map((e=>e.filter_id));this.setState({filterListIds:t})})).catch((e=>{console.log("Error loading list of filters:",e);const{toasts:t}=this.props.kibana.services.notifications;t.addDanger(y.i18n.translate("xpack.ml.ruleEditor.ruleEditorFlyout.errorWithLoadingFilterListsNotificationMesssage",{defaultMessage:"Error loading the filter lists used in the job rule scope"}))}))})),Ce()(this,"closeFlyout",(()=>{this.setState({isFlyoutVisible:!1})})),Ce()(this,"setEditRuleIndex",(e=>{const t=this.state.anomaly.detectorIndex,a=this.state.job.analysis_config.detectors[t].custom_rules,i=void 0===a||e>=a.length?xu():a[e],n=0===this.partitioningFieldNames.length||void 0!==i.conditions&&i.conditions.length>0,s=void 0!==i.scope&&Object.keys(i.scope).length>0;!0===s&&Object.keys(i.scope).forEach((e=>{i.scope[e].enabled=!0})),this.setState({ruleIndex:e,rule:i,isConditionsEnabled:n,isScopeEnabled:s})})),Ce()(this,"onSkipResultChange",(e=>{const t=e.target.checked;this.setState((e=>{const a=[...e.rule.actions],i=a.indexOf(fu.a.SKIP_RESULT);return-1===i&&t?a.push(fu.a.SKIP_RESULT):i>-1&&!t&&a.splice(i,1),{rule:{...e.rule,actions:a}}}))})),Ce()(this,"onSkipModelUpdateChange",(e=>{const t=e.target.checked;this.setState((e=>{const a=[...e.rule.actions],i=a.indexOf(fu.a.SKIP_MODEL_UPDATE);return-1===i&&t?a.push(fu.a.SKIP_MODEL_UPDATE):i>-1&&!t&&a.splice(i,1),{rule:{...e.rule,actions:a}}}))})),Ce()(this,"onConditionsEnabledChange",(e=>{const t=e.target.checked;this.setState((e=>{let a;return a=!1===t?[]:[ju()],{rule:{...e.rule,conditions:a},isConditionsEnabled:t}}))})),Ce()(this,"addCondition",(()=>{this.setState((e=>{const t=[...e.rule.conditions];return t.push(ju()),{rule:{...e.rule,conditions:t}}}))})),Ce()(this,"updateCondition",((e,t,a,i)=>{this.setState((n=>{const s=[...n.rule.conditions];return e<s.length&&(s[e]={applies_to:t,operator:a,value:i}),{rule:{...n.rule,conditions:s}}}))})),Ce()(this,"deleteCondition",(e=>{this.setState((t=>{const a=[...t.rule.conditions];return e<a.length&&a.splice(e,1),{rule:{...t.rule,conditions:a}}}))})),Ce()(this,"onScopeEnabledChange",(e=>{const t=e.target.checked;this.setState((e=>{const a={...e.rule};return!1===t&&delete a.scope,{rule:a,isScopeEnabled:t}}))})),Ce()(this,"updateScope",((e,t,a,i)=>{this.setState((n=>{let s={...n.rule.scope};return void 0===s&&(s={}),s[e]={filter_id:t,filter_type:a,enabled:i},{rule:{...n.rule,scope:s}}}))})),Ce()(this,"saveEdit",(()=>{const{rule:e,ruleIndex:t}=this.state;this.updateRuleAtIndex(t,e)})),Ce()(this,"updateRuleAtIndex",((e,t)=>{const{toasts:a}=this.props.kibana.services.notifications,{job:i,anomaly:n}=this.state,s=i.job_id;(function(e,t,a,i){const n=e.analysis_config.detectors[t],s=Object(E.cloneDeep)(i),r=s.scope;void 0!==r&&Object.keys(r).forEach((e=>{!1===r[e].enabled?delete r[e]:delete r[e].enabled}));let o=[];return void 0===n.custom_rules?o=[s]:(o=Object(E.cloneDeep)(n.custom_rules),a<o.length?o[a]=s:o.push(s)),yu(e,t,o)})(i,n.detectorIndex,e,t).then((e=>{e.success?(a.add({title:y.i18n.translate("xpack.ml.ruleEditor.ruleEditorFlyout.changesToJobDetectorRulesSavedNotificationMessageTitle",{defaultMessage:"Changes to {jobId} detector rules saved",values:{jobId:s}}),color:"success",iconType:"check",text:y.i18n.translate("xpack.ml.ruleEditor.ruleEditorFlyout.changesToJobDetectorRulesSavedNotificationMessageDescription",{defaultMessage:"Note that changes will take effect for new results only."})}),this.closeFlyout()):a.addDanger(y.i18n.translate("xpack.ml.ruleEditor.ruleEditorFlyout.errorWithSavingChangesToJobDetectorRulesNotificationMessage",{defaultMessage:"Error saving changes to {jobId} detector rules",values:{jobId:s}}))})).catch((e=>{console.error(e),a.addDanger(y.i18n.translate("xpack.ml.ruleEditor.ruleEditorFlyout.errorWithSavingChangesToJobDetectorRulesNotificationMessage",{defaultMessage:"Error saving changes to {jobId} detector rules",values:{jobId:s}}))}))})),Ce()(this,"deleteRuleAtIndex",(e=>{const{toasts:t}=this.props.kibana.services.notifications,{job:a,anomaly:i}=this.state,n=a.job_id,s=i.detectorIndex;(function(e,t,a){const i=e.analysis_config.detectors[t];let n=[];return void 0!==i.custom_rules&&a<i.custom_rules.length?(n=Object(E.cloneDeep)(i.custom_rules),n.splice(a,1),yu(e,t,n)):Promise.reject(new Error(y.i18n.translate("xpack.ml.ruleEditor.deleteJobRule.ruleNoLongerExistsErrorMessage",{defaultMessage:"Rule no longer exists for detector index {detectorIndex} in job {jobId}",values:{detectorIndex:t,jobId:e.job_id}})))})(a,s,e).then((e=>{if(e.success){t.addSuccess(y.i18n.translate("xpack.ml.ruleEditor.ruleEditorFlyout.ruleDeletedFromJobDetectorNotificationMessage",{defaultMessage:"Rule deleted from {jobId} detector",values:{jobId:n}}));const e=re.a.getJob(i.jobId);e.analysis_config.detectors[s].custom_rules?this.setState({job:{...e}}):this.closeFlyout()}else t.addDanger(y.i18n.translate("xpack.ml.ruleEditor.ruleEditorFlyout.errorWithDeletingRuleFromJobDetectorNotificationMessage",{defaultMessage:"Error deleting rule from {jobId} detector",values:{jobId:n}}))})).catch((e=>{console.error(e);let a=y.i18n.translate("xpack.ml.ruleEditor.ruleEditorFlyout.errorWithDeletingRuleFromJobDetectorNotificationMessage",{defaultMessage:"Error deleting rule from {jobId} detector",values:{jobId:n}});e.error&&(a+=` : ${Object(ze.b)(e.error)}`),t.addDanger(a)}))})),Ce()(this,"addItemToFilterList",((e,t,a)=>{const{toasts:i}=this.props.kibana.services.notifications;(function(e,t){return new Promise(((a,i)=>{ge.ml.filters.updateFilter(t,void 0,[e],void 0).then((e=>{a(e)})).catch((e=>{i(e)}))}))})(e,t).then((()=>{!0===a&&(i.add({title:y.i18n.translate("xpack.ml.ruleEditor.ruleEditorFlyout.addedItemToFilterListNotificationMessageTitle",{defaultMessage:"Added {item} to {filterId}",values:{item:e,filterId:t}}),color:"success",iconType:"check",text:y.i18n.translate("xpack.ml.ruleEditor.ruleEditorFlyout.addedItemToFilterListNotificationMessageDescription",{defaultMessage:"Note that changes will take effect for new results only."})}),this.closeFlyout())})).catch((a=>{console.log(`Error adding ${e} to filter ${t}:`,a),i.addDanger(y.i18n.translate("xpack.ml.ruleEditor.ruleEditorFlyout.errorWithAddingItemToFilterListNotificationMessage",{defaultMessage:"An error occurred adding {item} to filter {filterId}",values:{item:e,filterId:t}}))}))})),this.state={anomaly:{},job:{},ruleIndex:-1,rule:xu(),skipModelUpdate:!1,isConditionsEnabled:!1,isScopeEnabled:!1,filterListIds:[],isFlyoutVisible:!1},this.partitioningFieldNames=[],this.canGetFilters=Object(I.e)("canGetFilters")}componentDidMount(){"function"==typeof this.props.setShowFunction&&this.props.setShowFunction(this.showFlyout)}componentWillUnmount(){"function"==typeof this.props.unsetShowFunction&&this.props.unsetShowFunction()}render(){const e=this.props.kibana.services.docLinks.links.ml.customRules,{isFlyoutVisible:t,job:a,anomaly:i,ruleIndex:n,rule:r,filterListIds:o,isConditionsEnabled:l,isScopeEnabled:c}=this.state;if(!1===t)return null;let d;if(-1===n)d=Object(N.jsx)(te.EuiFlyout,{className:"ml-rule-editor-flyout",onClose:this.closeFlyout,"aria-labelledby":"flyoutTitle"},Object(N.jsx)(te.EuiFlyoutHeader,{hasBorder:!0},Object(N.jsx)(te.EuiTitle,{size:"m"},Object(N.jsx)("h1",{id:"flyoutTitle"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleEditorFlyout.editRulesTitle",defaultMessage:"Edit job rules"})))),Object(N.jsx)(te.EuiFlyoutBody,null,Object(N.jsx)(Au,{job:a,anomaly:i,setEditRuleIndex:this.setEditRuleIndex,updateRuleAtIndex:this.updateRuleAtIndex,deleteRuleAtIndex:this.deleteRuleAtIndex,addItemToFilterList:this.addItemToFilterList})),Object(N.jsx)(te.EuiFlyoutFooter,null,Object(N.jsx)(te.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiButtonEmpty,{iconType:"cross",onClick:this.closeFlyout,flush:"left"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleEditorFlyout.closeButtonLabel",defaultMessage:"Close"}))))));else{const t=i.detectorIndex,s=a.analysis_config.detectors[t],u=s.custom_rules,p=void 0===u||n>=u.length,m=this.partitioningFieldNames&&this.partitioningFieldNames.length>0,b=-1===fu.c.indexOf(i.source.function),h=y.i18n.translate("xpack.ml.ruleEditor.ruleEditorFlyout.conditionsDescription",{defaultMessage:"Add numeric conditions for when the job rule applies. Multiple conditions are combined using AND."});d=Object(N.jsx)(te.EuiFlyout,{className:"ml-rule-editor-flyout",onClose:this.closeFlyout,"aria-labelledby":"flyoutTitle"},Object(N.jsx)(te.EuiFlyoutHeader,{hasBorder:!0},Object(N.jsx)(te.EuiTitle,{size:"m"},Object(N.jsx)("h1",{id:"flyoutTitle"},!0===p?Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleEditorFlyout.createRuleTitle",defaultMessage:"Create job rule"}):Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleEditorFlyout.editRuleTitle",defaultMessage:"Edit job rule"})))),Object(N.jsx)(te.EuiFlyoutBody,null,Object(N.jsx)(hu,{job:a,detector:s,anomaly:i}),Object(N.jsx)(te.EuiSpacer,{size:"m"}),Object(N.jsx)(te.EuiText,null,Object(N.jsx)("p",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleEditorFlyout.rulesDescription",defaultMessage:"Job rules instruct anomaly detectors to change their behavior based on domain-specific knowledge that you provide. When you create a job rule, you can specify conditions, scope, and actions. When the conditions of a job rule are satisfied, its actions are triggered. {learnMoreLink}",values:{learnMoreLink:Object(N.jsx)(te.EuiLink,{href:e,target:"_blank"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleEditorFlyout.rulesDescription.learnMoreLinkText",defaultMessage:"Learn more"}))}}))),Object(N.jsx)(te.EuiSpacer,null),Object(N.jsx)(te.EuiTitle,null,Object(N.jsx)("h2",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleEditorFlyout.actionTitle",defaultMessage:"Action"}))),Object(N.jsx)(gu,{actions:r.actions,onSkipResultChange:this.onSkipResultChange,onSkipModelUpdateChange:this.onSkipModelUpdateChange}),Object(N.jsx)(te.EuiSpacer,{size:"xl"}),Object(N.jsx)(te.EuiTitle,null,Object(N.jsx)("h2",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleEditorFlyout.conditionsTitle",defaultMessage:"Conditions"}))),Object(N.jsx)(te.EuiSpacer,{size:"s"}),!0===b?Object(N.jsx)(te.EuiCheckbox,{id:"enable_conditions_checkbox",className:"scope-enable-checkbox",label:h,checked:l,onChange:this.onConditionsEnabledChange,disabled:!b||!m}):Object(N.jsx)(te.EuiCallOut,{title:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleEditorFlyout.conditionsNotSupportedTitle",defaultMessage:"Conditions are not supported for detectors using the {functionName} function",values:{functionName:i.source.function}}),iconType:"iInCircle"}),Object(N.jsx)(te.EuiSpacer,{size:"s"}),Object(N.jsx)(Mu,{isEnabled:l,conditions:r.conditions,addCondition:this.addCondition,updateCondition:this.updateCondition,deleteCondition:this.deleteCondition}),Object(N.jsx)(te.EuiSpacer,{size:"xl"}),Object(N.jsx)(Iu,{isEnabled:c,onEnabledChange:this.onScopeEnabledChange,partitioningFieldNames:this.partitioningFieldNames,filterListIds:o,scope:r.scope,updateScope:this.updateScope}),Object(N.jsx)(te.EuiCallOut,{title:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleEditorFlyout.rerunJobTitle",defaultMessage:"Rerun job"}),color:"warning",iconType:"help"},Object(N.jsx)("p",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleEditorFlyout.whenChangesTakeEffectDescription",defaultMessage:"Changes to job rules take effect for new results only."})),Object(N.jsx)("p",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleEditorFlyout.howToApplyChangesToExistingResultsDescription",defaultMessage:"To apply these changes to existing results you must clone and rerun the job. Note rerunning the job may take some time and should only be done once you have completed all your changes to the rules for this job."})))),Object(N.jsx)(te.EuiFlyoutFooter,null,Object(N.jsx)(te.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiButtonEmpty,{iconType:"cross",onClick:this.closeFlyout,flush:"left"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleEditorFlyout.closeButtonLabel",defaultMessage:"Close"}))),Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiButton,{onClick:this.saveEdit,isDisabled:!vu(r),fill:!0},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleEditorFlyout.saveButtonLabel",defaultMessage:"Save"}))))))}return Object(N.jsx)(s.a.Fragment,null,d)}}const Lu=Object(c.withKibana)(rule_editor_flyout_RuleEditorFlyoutUI);class anomalies_table_AnomaliesTableInternal extends n.Component{constructor(e){super(e),Ce()(this,"isShowingAggregatedData",(()=>"second"!==this.props.tableData.interval)),Ce()(this,"toggleRow",(async(e,t=ru)=>{const a={...this.state.itemIdToExpandedRowMap};if(a[e.rowId])delete a[e.rowId];else{const i="mlcategory"===e.entityName?Object(E.get)(this.props.tableData,["examplesByJobId",e.jobId,e.entityValue]):void 0;let n;if(void 0!==i)try{n=await ge.ml.results.getCategoryDefinition(e.jobId,e.source.mlcategory[0]),n.terms&&n.terms.length>lu&&(n.terms=`${n.terms.substring(0,lu)}...`),n.regex&&n.regex.length>lu&&(n.terms=`${n.regex.substring(0,lu)}...`)}catch(e){console.log("Error fetching category definition for row item.",e)}a[e.rowId]=Object(N.jsx)(anomaly_details_AnomalyDetails,{tabIndex:t,anomaly:e,examples:i,definition:n,isAggregatedData:this.isShowingAggregatedData(),filter:this.props.filter,influencerFilter:this.props.influencerFilter,influencersLimit:5})}this.setState({itemIdToExpandedRowMap:a})})),Ce()(this,"onMouseOverRow",(e=>{void 0!==this.mouseOverRecord?this.mouseOverRecord.rowId!==e.rowId&&(bu.a.rowMouseleave$.next({record:this.mouseOverRecord}),bu.a.rowMouseenter$.next({record:e})):bu.a.rowMouseenter$.next({record:e}),this.mouseOverRecord=e})),Ce()(this,"onMouseLeaveRow",(()=>{void 0!==this.mouseOverRecord&&(bu.a.rowMouseleave$.next({record:this.mouseOverRecord}),this.mouseOverRecord=void 0)})),Ce()(this,"setShowRuleEditorFlyoutFunction",(e=>{this.setState({showRuleEditorFlyout:e})})),Ce()(this,"unsetShowRuleEditorFlyoutFunction",(()=>{this.setState({showRuleEditorFlyout:()=>{}})})),Ce()(this,"onTableChange",(({page:e,sort:t})=>{const{tableState:a,updateTableState:i}=this.props;i({pageIndex:e&&void 0!==e.index?e.index:a.pageIndex,pageSize:e&&void 0!==e.size?e.size:a.pageSize,sortField:t&&void 0!==t.field&&"string"==typeof t.field?t.field:a.sortField,sortDirection:t&&void 0!==t.direction?t.direction:a.sortDirection})})),this.state={itemIdToExpandedRowMap:{},showRuleEditorFlyout:()=>{}}}static getDerivedStateFromProps(e,t){const a=t.itemIdToExpandedRowMap;return void 0!==Object.keys(a).find((t=>void 0===e.tableData.anomalies.find((e=>e.rowId===t))))?{itemIdToExpandedRowMap:{}}:null}render(){const{bounds:e,tableData:t,filter:a,influencerFilter:i,tableState:n}=this.props;if(void 0===t||void 0===t.anomalies||0===t.anomalies.length)return Object(N.jsx)(te.EuiFlexGroup,{justifyContent:"spaceAround"},Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiText,null,Object(N.jsx)("h4",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.anomaliesTable.noMatchingAnomaliesFoundTitle",defaultMessage:"No matching anomalies found"})))));const r=pu(t.anomalies,t.jobIds,t.examplesByJobId,this.isShowingAggregatedData(),t.interval,e,t.showViewSeriesLink,this.state.showRuleEditorFlyout,this.state.itemIdToExpandedRowMap,this.toggleRow,a,i),o={sort:{field:n.sortField,direction:n.sortDirection}},l={pageIndex:n.pageIndex,pageSize:n.pageSize,totalItemCount:t.anomalies.length,pageSizeOptions:[10,25,100]};return Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(Lu,{setShowFunction:this.setShowRuleEditorFlyoutFunction,unsetShowFunction:this.unsetShowRuleEditorFlyoutFunction}),Object(N.jsx)(te.EuiInMemoryTable,{className:"ml-anomalies-table eui-textOverflowWrap",items:t.anomalies,columns:r,pagination:l,sorting:o,itemId:"rowId",itemIdToExpandedRowMap:this.state.itemIdToExpandedRowMap,compressed:!0,rowProps:e=>({onMouseOver:()=>this.onMouseOverRow(e),onMouseLeave:()=>this.onMouseLeaveRow(),"data-test-subj":`mlAnomaliesListRow row-${e.rowId}`}),"data-test-subj":"mlAnomaliesTable",onTableChange:this.onTableChange}))}}const Ru=e=>{const[t,a]=Object(j.b)("mlAnomaliesTable",{pageIndex:0,pageSize:25,sortField:"severity",sortDirection:"desc"});return Object(N.jsx)(anomalies_table_AnomaliesTableInternal,v()({},e,{tableState:t,updateTableState:a}))},Pu="error",Nu="info",zu="success",Bu="warning";function Ju({message:e,status:t,...a}){return Object(N.jsx)(te.EuiCallOut,v()({size:"s"},function(e,t){switch(t){case Pu:return{title:e,iconType:"cross",color:"danger"};case Bu:return{title:e,iconType:"alert",color:"warning"};case zu:return{title:e,iconType:"check",color:"success"};case Nu:return{title:e,iconType:"iInCircle",color:"primary"}}}(e,t),a))}function Vu(e){return[{field:"forecast_create_timestamp",name:y.i18n.translate("xpack.ml.timeSeriesExplorer.forecastsList.createdColumnName",{defaultMessage:"Created"}),dataType:"date",render:e=>Object(Ud.c)(e),sortable:!0},{field:"forecast_start_timestamp",name:y.i18n.translate("xpack.ml.timeSeriesExplorer.forecastsList.fromColumnName",{defaultMessage:"From"}),dataType:"date",render:e=>Object(Ud.c)(e),sortable:!0},{field:"forecast_end_timestamp",name:y.i18n.translate("xpack.ml.timeSeriesExplorer.forecastsList.toColumnName",{defaultMessage:"To"}),dataType:"date",render:e=>Object(Ud.c)(e),sortable:!0},{name:y.i18n.translate("xpack.ml.timeSeriesExplorer.forecastsList.viewColumnName",{defaultMessage:"View"}),width:"60px",render:t=>{const a=y.i18n.translate("xpack.ml.timeSeriesExplorer.forecastsList.viewForecastAriaLabel",{defaultMessage:"View forecast created at {createdDate}",values:{createdDate:Object(Ud.c)(t.forecast_create_timestamp)}});return Object(N.jsx)(te.EuiButtonIcon,{onClick:()=>e(t.forecast_id),iconType:"visLine","aria-label":a})}}]}function Uu({forecasts:e,viewForecast:t}){return Object(N.jsx)(te.EuiText,null,Object(N.jsx)("h3",{"aria-describedby":"ml_aria_description_forecasting_modal_view_list",style:{display:"inline",paddingRight:"5px"}},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.forecastsList.previousForecastsTitle",defaultMessage:"Previous forecasts"})),Object(N.jsx)(te.EuiToolTip,{position:"right",content:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.forecastsList.listsOfFiveRecentlyRunForecastsTooltip",defaultMessage:"Lists a maximum of five of the most recently run forecasts."})},Object(N.jsx)(te.EuiIcon,{type:"questionInCircle",size:"s"})),Object(N.jsx)(te.EuiInMemoryTable,{items:e,columns:Vu(t),pagination:!1,"data-test-subj":"mlModalForecastTable",rowProps:e=>({"data-test-subj":`mlForecastsListRow row-${e.rowId}`})}))}Uu.propType={forecasts:mn.a.array,viewForecast:mn.a.func.isRequired};const Gu=-1,qu=0,Hu=1,Wu=-10;function $u({state:e}){return e===qu?Object(N.jsx)(te.EuiLoadingSpinner,{size:"m"}):e===Hu?Object(N.jsx)(te.EuiIcon,{type:"check",size:"m",color:"primary"}):e===Wu?Object(N.jsx)(te.EuiIcon,{type:"cross",size:"m",color:"danger"}):void 0}function Yu({forecastProgress:e,jobOpeningState:t,jobClosingState:a}){return Object(N.jsx)("div",null,t!==Gu&&Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(te.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiText,{size:"xs"},Object(N.jsx)("h3",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.forecastingModal.openingJobTitle",defaultMessage:"Opening job…"})))),Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)($u,{state:t}))),Object(N.jsx)(te.EuiSpacer,{size:"s"})),e!==Gu&&Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(te.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiText,{size:"xs"},Object(N.jsx)("h3",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.forecastingModal.runningForecastTitle",defaultMessage:"Running forecast…"})))),e>=0&&Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(te.EuiToolTip,{position:"top",content:e+"%"},Object(N.jsx)(te.EuiProgress,{size:"l",value:e,max:100}))),e===Wu&&Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)($u,{state:Wu}))),Object(N.jsx)(te.EuiSpacer,{size:"s"})),a!==Gu&&Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(te.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiText,{size:"xs"},Object(N.jsx)("h3",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.forecastingModal.closingJobTitle",defaultMessage:"Closing job…"})))),Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)($u,{state:a})))))}function Xu({job:e,newForecastDuration:t,isNewForecastDurationValid:a,newForecastDurationErrors:i,onNewForecastDurationChange:n,runForecast:s,isForecastRequested:r,forecastProgress:o,jobOpeningState:l,jobClosingState:c}){const d=function(e,t){return!1===Object($.b)()?{isDisabled:!0,isDisabledToolTipText:y.i18n.translate("xpack.ml.timeSeriesExplorer.runControls.noMLNodesAvailableTooltip",{defaultMessage:"There are no ML nodes available."})}:!1===Object(I.e)("canForecastJob")?{isDisabled:!0,isDisabledToolTipText:Object(I.f)("canForecastJob")}:e.state!==Bn.c.OPENED&&e.state!==Bn.c.CLOSED?{isDisabled:!0,isDisabledToolTipText:y.i18n.translate("xpack.ml.timeSeriesExplorer.runControls.forecastsCanNotBeRunOnJobsTooltip",{defaultMessage:"Forecasts cannot be run on {jobState} jobs",values:{jobState:e.state}})}:{isDisabled:t}}(e,r),u=Object(N.jsx)(te.EuiFieldText,{name:"forecastDuration",value:t,disabled:d.isDisabled,isInvalid:!a,onChange:n,fullWidth:!0}),p=Object(N.jsx)(te.EuiButton,{onClick:s,isDisabled:d.isDisabled||!a,"data-test-subj":"mlModalForecastButtonRun"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.runControls.runButtonLabel",defaultMessage:"Run"}));return Object(N.jsx)("div",null,Object(N.jsx)(te.EuiText,null,Object(N.jsx)("h3",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.runControls.runNewForecastTitle",defaultMessage:"Run a new forecast"}))),Object(N.jsx)(te.EuiSpacer,{size:"s"}),Object(N.jsx)(te.EuiForm,null,Object(N.jsx)(te.EuiFlexGroup,null,Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)(te.EuiFormRow,{label:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.runControls.durationLabel",defaultMessage:"Duration"}),fullWidth:!0,isInvalid:!a,error:i,helpText:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.runControls.forecastMaximumLengthHelpText",defaultMessage:"Length of forecast, up to a maximum of {maximumForecastDurationDays} days. Use s for seconds, m for minutes, h for hours, d for days, w for weeks.",values:{maximumForecastDurationDays:Zu}})},void 0===d.isDisabledToolTipText?u:Object(N.jsx)(te.EuiToolTip,{position:"right",content:d.isDisabledToolTipText},u))),Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiFormRow,{hasEmptyLabelSpace:!0},void 0===d.isDisabledToolTipText?p:Object(N.jsx)(te.EuiToolTip,{position:"left",content:d.isDisabledToolTipText},p))))),Object(N.jsx)(te.EuiSpacer,{size:"s"}),!0===r&&Object(N.jsx)(Yu,{forecastProgress:o,jobOpeningState:l,jobClosingState:c}))}function Qu(e){return Object(N.jsx)(te.EuiModal,{onClose:e.close,maxWidth:860,"data-test-subj":"mlModalForecast"},Object(N.jsx)(te.EuiModalHeader,null,Object(N.jsx)(te.EuiModalHeaderTitle,null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.forecastingModal.forecastingTitle",defaultMessage:"Forecasting"}))),Object(N.jsx)(te.EuiModalBody,null,e.messages.map(((e,t)=>Object(N.jsx)(s.a.Fragment,{key:t},Object(N.jsx)(Ju,e),Object(N.jsx)(te.EuiSpacer,{size:"m"})))),e.forecasts.length>0&&Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(Uu,{forecasts:e.forecasts,viewForecast:e.viewForecast}),Object(N.jsx)(te.EuiSpacer,null)),Object(N.jsx)(Xu,e)),Object(N.jsx)(te.EuiModalFooter,null,Object(N.jsx)(te.EuiButtonEmpty,{onClick:e.close,size:"s","data-test-subj":"mlModalForecastButtonClose"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.forecastingModal.closeButtonLabel",defaultMessage:"Close"}))))}Yu.propType={forecastProgress:mn.a.number,jobOpeningState:mn.a.number,jobClosingState:mn.a.number},Xu.propType={job:mn.a.object,newForecastDuration:mn.a.string,isNewForecastDurationValid:mn.a.bool,newForecastDurationErrors:mn.a.array,onNewForecastDurationChange:mn.a.func.isRequired,runForecast:mn.a.func.isRequired,isForecastRequested:mn.a.bool,forecastProgress:mn.a.number,jobOpeningState:mn.a.number,jobClosingState:mn.a.number},Qu.propType={job:mn.a.object,forecasts:mn.a.array,close:mn.a.func.isRequired,viewForecast:mn.a.func.isRequired,runForecast:mn.a.func.isRequired,newForecastDuration:mn.a.string,isNewForecastDurationValid:mn.a.bool,newForecastDurationErrors:mn.a.array,onNewForecastDurationChange:mn.a.func.isRequired,isForecastRequested:mn.a.bool,forecastProgress:mn.a.number,jobOpeningState:mn.a.number,jobClosingState:mn.a.number,messages:mn.a.array};var Ku=a(156);const Zu=3650,ep="6.1.0",tp=864e5*Zu,ap=12e4;function ip(){return{isModalVisible:!1,previousForecasts:[],isForecastRequested:!1,forecastProgress:Gu,jobOpeningState:Gu,jobClosingState:Gu,newForecastDuration:"1d",isNewForecastDurationValid:!0,newForecastDurationErrors:[],messages:[]}}class forecasting_modal_ForecastingModalUI extends n.Component{constructor(e){super(e),Ce()(this,"addMessage",((e,t,a=!1)=>{const i={message:e,status:t};this.setState((e=>({messages:a?[i]:[...e.messages,i]})))})),Ce()(this,"viewForecast",(e=>{this.props.setForecastId(e),this.closeModal()})),Ce()(this,"onNewForecastDurationChange",(e=>{const t=[];let a=!0;const i=Object(tu.a)(e.target.value);null===i?(a=!1,t.push(y.i18n.translate("xpack.ml.timeSeriesExplorer.forecastingModal.invalidDurationFormatErrorMessage",{defaultMessage:"Invalid duration format"}))):i.asMilliseconds()>tp?(a=!1,t.push(y.i18n.translate("xpack.ml.timeSeriesExplorer.forecastingModal.forecastDurationMustNotBeGreaterThanMaximumErrorMessage",{defaultMessage:"Forecast duration must not be greater than {maximumForecastDurationDays} days",values:{maximumForecastDurationDays:Zu}}))):0===i.asMilliseconds()&&(a=!1,t.push(y.i18n.translate("xpack.ml.timeSeriesExplorer.forecastingModal.forecastDurationMustNotBeZeroErrorMessage",{defaultMessage:"Forecast duration must not be zero"}))),this.setState({newForecastDuration:e.target.value,isNewForecastDurationValid:a,newForecastDurationErrors:t})})),Ce()(this,"checkJobStateAndRunForecast",(()=>{this.setState({isForecastRequested:!0,messages:[]}),this.props.job.state===Bn.c.CLOSED?this.openJobAndRunForecast():this.runForecast(!1)})),Ce()(this,"openJobAndRunForecast",(()=>{this.setState({jobOpeningState:qu}),re.a.openJob(this.props.job.job_id).then((()=>{this.setState({jobOpeningState:Hu}),this.runForecast(!0)})).catch((e=>{console.log("Time series forecast modal - could not open job:",e),this.addMessage(y.i18n.translate("xpack.ml.timeSeriesExplorer.forecastingModal.errorWithOpeningJobBeforeRunningForecastErrorMessage",{defaultMessage:"Error opening job before running forecast"}),Pu),this.setState({jobOpeningState:Wu})}))})),Ce()(this,"runForecastErrorHandler",((e,t)=>{this.setState({forecastProgress:Wu}),console.log("Time series forecast modal - error running forecast:",e),e&&e.message?this.addMessage(e.message,Pu,!0):this.addMessage(y.i18n.translate("xpack.ml.timeSeriesExplorer.forecastingModal.unexpectedResponseFromRunningForecastErrorMessage",{defaultMessage:"Unexpected response from running forecast. The request may have failed."}),Pu,!0),!0===t&&(this.setState({jobClosingState:qu}),re.a.closeJob(this.props.job.job_id).then((()=>{this.setState({jobClosingState:Hu})})).catch((e=>{console.log("Time series forecast modal - could not close job:",e),this.addMessage(y.i18n.translate("xpack.ml.timeSeriesExplorer.forecastingModal.errorWithClosingJobErrorMessage",{defaultMessage:"Error closing job"}),Pu),this.setState({jobClosingState:Wu})})))})),Ce()(this,"runForecast",(e=>{this.setState({forecastProgress:0});const t=Object(tu.a)(this.state.newForecastDuration).asSeconds();Ku.a.runForecast(this.props.job.job_id,`${t}s`).then((t=>{void 0!==t.forecast_id?this.waitForForecastResults(t.forecast_id,e):this.runForecastErrorHandler(t,e)})).catch((t=>this.runForecastErrorHandler(t,e)))})),Ce()(this,"waitForForecastResults",((e,t)=>{let a=0,i=0;this.forecastChecker=setInterval((()=>{Ku.a.getForecastRequestStats(this.props.job,e).then((n=>{const s=Object(E.get)(n,["stats","forecast_progress"],a),r=Object(E.get)(n,["stats","forecast_status"]);s>a&&this.setState({forecastProgress:Math.round(100*s)});let o=Object(E.get)(n,["stats","forecast_messages"],[]);o=o.map((e=>({message:e,status:Bu}))),this.setState({messages:o}),r===Bn.b.FINISHED?(clearInterval(this.forecastChecker),!0===t?(this.setState({jobClosingState:qu}),re.a.closeJob(this.props.job.job_id).then((()=>{this.setState({jobClosingState:Hu}),this.props.setForecastId(e),this.closeAfterRunningForecast()})).catch((t=>{console.log("Time series forecast modal - could not close job:",t),this.addMessage(y.i18n.translate("xpack.ml.timeSeriesExplorer.forecastingModal.errorWithClosingJobAfterRunningForecastErrorMessage",{defaultMessage:"Error closing job after running forecast"}),Pu),this.setState({jobClosingState:Wu}),this.props.setForecastId(e)}))):(this.props.setForecastId(e),this.closeAfterRunningForecast())):s===a?(i+=250,i>ap&&(console.log("Forecast request has not progressed for 120000ms. Cancelling check."),this.addMessage(y.i18n.translate("xpack.ml.timeSeriesExplorer.forecastingModal.noProgressReportedForNewForecastErrorMessage",{defaultMessage:"No progress reported for the new forecast for {WarnNoProgressMs}ms.An error may have occurred whilst running the forecast.",values:{WarnNoProgressMs:ap}}),Pu),this.props.setForecastId(e),this.setState({forecastProgress:Wu}),clearInterval(this.forecastChecker))):(s>a&&(a=s),i=0)})).catch((e=>{console.log("Time series forecast modal - error loading stats of forecast from elasticsearch:",e),this.addMessage(y.i18n.translate("xpack.ml.timeSeriesExplorer.forecastingModal.errorWithLoadingStatsOfRunningForecastErrorMessage",{defaultMessage:"Error loading stats of running forecast."}),Pu),this.setState({forecastProgress:Wu}),clearInterval(this.forecastChecker)}))}),250)})),Ce()(this,"openModal",(()=>{const e=this.props.job;if("object"==typeof e){const{timefilter:t}=this.props.kibana.services.data.query.timefilter,a=t.getActiveBounds(),i={term:{forecast_status:Bn.b.FINISHED}};Ku.a.getForecastsSummary(e,i,a.min.valueOf(),5).then((e=>{this.setState({previousForecasts:e.forecasts})})).catch((e=>{console.log("Time series forecast modal - error obtaining forecasts summary:",e),this.addMessage(y.i18n.translate("xpack.ml.timeSeriesExplorer.forecastingModal.errorWithObtainingListOfPreviousForecastsErrorMessage",{defaultMessage:"Error obtaining list of previous forecasts"}),Pu)}));const n=this.props.entities.map((e=>e.fieldName));n.length>0&&ge.ml.getCardinalityOfFields({index:e.datafeed_config.indices,fieldNames:n,query:e.datafeed_config.query,timeFieldName:e.data_description.time_field,earliestMs:e.data_counts.earliest_record_timestamp,latestMs:e.data_counts.latest_record_timestamp}).then((e=>{let t=1;Object.values(e).forEach((e=>{t*=e})),t>100&&this.addMessage(y.i18n.translate("xpack.ml.timeSeriesExplorer.forecastingModal.dataContainsMorePartitionsMessage",{defaultMessage:"Note that this data contains more than {warnNumPartitions} partitions so running a forecast may take a long time and consume a high amount of resource",values:{warnNumPartitions:100}}),Bu)})).catch((e=>{console.log("Time series forecast modal - error obtaining cardinality of fields:",e)})),this.setState({isModalVisible:!0})}})),Ce()(this,"closeAfterRunningForecast",(()=>{0===this.state.messages.length&&setTimeout((()=>{this.closeModal()}),1e3)})),Ce()(this,"closeModal",(()=>{null!==this.forecastChecker&&clearInterval(this.forecastChecker),this.setState(ip())})),this.state=ip(),this.forecastChecker=null}render(){let e=!1,t=null;const{job:a}=this.props;if(void 0!==a){void 0!==a.analysis_config.detectors[this.props.detectorIndex].over_field_name?(e=!0,t=y.i18n.translate("xpack.ml.timeSeriesExplorer.forecastingModal.forecastingNotAvailableForPopulationDetectorsMessage",{defaultMessage:"Forecasting is not available for population detectors with an over field"})):!1===Object(Te.j)(a,ep)&&(e=!0,t=y.i18n.translate("xpack.ml.timeSeriesExplorer.forecastingModal.forecastingOnlyAvailableForJobsCreatedInSpecifiedVersionMessage",{defaultMessage:"Forecasting is only available for jobs created in version {minVersion} or later",values:{minVersion:ep}}))}const i=Object(N.jsx)(te.EuiButton,{onClick:this.openModal,isDisabled:e,"data-test-subj":"mlSingleMetricViewerButtonForecast"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.forecastingModal.forecastButtonLabel",defaultMessage:"Forecast"}));return Object(N.jsx)("div",null,e?Object(N.jsx)(te.EuiToolTip,{position:"left",content:t},i):i,this.state.isModalVisible&&Object(N.jsx)(Qu,{job:this.props.job,forecasts:this.state.previousForecasts,close:this.closeModal,viewForecast:this.viewForecast,runForecast:this.checkJobStateAndRunForecast,newForecastDuration:this.state.newForecastDuration,onNewForecastDurationChange:this.onNewForecastDurationChange,isNewForecastDurationValid:this.state.isNewForecastDurationValid,newForecastDurationErrors:this.state.newForecastDurationErrors,isForecastRequested:this.state.isForecastRequested,forecastProgress:this.state.forecastProgress,jobOpeningState:this.state.jobOpeningState,jobClosingState:this.state.jobClosingState,messages:this.state.messages}))}}const np=Object(c.withKibana)(forecasting_modal_ForecastingModalUI);var sp=a(229);const rp=[{value:"auto",text:y.i18n.translate("xpack.ml.controls.selectInterval.autoLabel",{defaultMessage:"Auto"})},{value:"hour",text:y.i18n.translate("xpack.ml.controls.selectInterval.hourLabel",{defaultMessage:"1 hour"})},{value:"day",text:y.i18n.translate("xpack.ml.controls.selectInterval.dayLabel",{defaultMessage:"1 day"})},{value:"second",text:y.i18n.translate("xpack.ml.controls.selectInterval.showAllLabel",{defaultMessage:"Show all"})}];function op(e){const t=rp.find((t=>t.value===e));let a={display:rp[0].text,val:rp[0].value};return void 0!==t&&(a={display:t.text,val:t.value}),a}const lp=op("auto"),cp=()=>Object(j.b)("mlSelectInterval",lp),dp=()=>{const[e,t]=cp();return Object(N.jsx)(up,{interval:e,onChange:t})},up=({interval:e,onChange:t})=>Object(N.jsx)(te.EuiSelect,{prepend:y.i18n.translate("xpack.ml.explorer.intervalLabel",{defaultMessage:"Interval"}),append:Object(N.jsx)(te.EuiToolTip,{content:y.i18n.translate("xpack.ml.explorer.intervalTooltip",{defaultMessage:"Show only the highest severity anomaly for each interval (such as hour or day) or show all anomalies in the selected time period."})},Object(N.jsx)(te.EuiIcon,{type:"questionInCircle",color:"subdued"})),compressed:!0,id:"selectInterval",options:rp,value:e.val,onChange:e=>{t(op(e.target.value))}});var pp=a(128);const mp=({dataNotChartable:e,entities:t})=>Object(N.jsx)(te.EuiEmptyPrompt,{iconType:"iInCircle",title:Object(N.jsx)("h2",null,y.i18n.translate("xpack.ml.timeSeriesExplorer.noResultsFoundLabel",{defaultMessage:"No results found"})),body:e?Object(N.jsx)("p",null,y.i18n.translate("xpack.ml.timeSeriesExplorer.dataNotChartableDescription",{defaultMessage:"Model plot is not collected for the selected {entityCount, plural, one {entity} other {entities}}\nand the source data cannot be plotted for this detector.",values:{entityCount:t.length}})):Object(N.jsx)("p",null,y.i18n.translate("xpack.ml.timeSeriesExplorer.tryWideningTheTimeSelectionDescription",{defaultMessage:"Try widening the time selection or moving further back in time."}))}),bp=({viewId:e})=>{const t=Object(f.d)(),a=Object(f.e)(),i=Object(n.useMemo)((()=>[{id:"timeseriesexplorer",label:y.i18n.translate("xpack.ml.anomalyResultsViewSelector.singleMetricViewerLabel",{defaultMessage:"View results in the Single Metric Viewer"}),iconType:"visLine",value:T.b.SINGLE_METRIC_VIEWER,"data-test-subj":"mlAnomalyResultsViewSelectorSingleMetricViewer"},{id:"explorer",label:y.i18n.translate("xpack.ml.anomalyResultsViewSelector.anomalyExplorerLabel",{defaultMessage:"View results in the Anomaly Explorer"}),iconType:"visTable",value:T.b.ANOMALY_EXPLORER,"data-test-subj":"mlAnomalyResultsViewSelectorExplorer"}]),[]),[s]=Object(j.c)("_g");return Object(N.jsx)(te.EuiButtonGroup,{legend:y.i18n.translate("xpack.ml.anomalyResultsViewSelector.buttonGroupLegend",{defaultMessage:"Anomaly results view selector"}),name:"anomalyResultsViewSelector","data-test-subj":"mlAnomalyResultsViewSelector",options:i,idSelected:e,onChange:e=>(async e=>{const i=await t.getUrl({page:e,pageState:{globalState:s}});await a(i)})(e),isIconOnly:!0})};var hp=a(189),fp=a(190);const gp=({children:e,dateFormatTz:t,resizeRef:a})=>{const{services:{docLinks:i}}=Object(f.b)(),n=i.links.ml.anomalyDetection;return Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(cr.a,{tabId:"anomaly_detection"}),Object(N.jsx)("div",{className:"ml-time-series-explorer",ref:a,"data-test-subj":"mlPageSingleMetricViewer"},Object(N.jsx)(te.EuiPage,{style:{background:"none"}},Object(N.jsx)(te.EuiPageBody,null,Object(N.jsx)(te.EuiPageHeader,null,Object(N.jsx)(te.EuiPageHeaderSection,null,Object(N.jsx)(te.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(bp,{viewId:"timeseriesexplorer"})),Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiTitle,{className:"eui-textNoWrap"},Object(N.jsx)("h1",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.pageTitle",defaultMessage:"Single Metric Viewer"})))))),Object(N.jsx)(te.EuiPageHeaderSection,null,Object(N.jsx)(te.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(fp.a,null))))),Object(N.jsx)(te.EuiHorizontalRule,{margin:"none"}),Object(N.jsx)(hp.a,{dateFormatTz:t,singleSelection:!0,timeseriesOnly:!0}),Object(N.jsx)(te.EuiHorizontalRule,{margin:"none"}),Object(N.jsx)(te.EuiSpacer,{size:"s"}),e)),Object(N.jsx)(dr.a,{docLink:n})))},jp="CLEAR",xp="SET_DETECTOR_INDEX",vp="SET_ENTITIES",yp="SET_FORECAST_ID",Op="SET_ZOOM",Ep="UNSET_ZOOM",wp="SET_FUNCTION_DESCRIPTION",_p=500;function Sp(e,t){const a=e.analysis_config,i=a.detectors[t],n={jobId:e.job_id,detectorIndex:t,metricFunction:i.function===Lt.b.LAT_LONG?Lt.b.LAT_LONG:Object(Te.q)(i.function),timeField:e.data_description.time_field,interval:e.analysis_config.bucket_span,datafeedConfig:e.datafeed_config,summaryCountFieldName:e.analysis_config.summary_count_field_name};void 0!==i.field_name&&(n.metricFieldName=i.field_name);const s=a.summary_count_field_name;if(n.metricFunction===Lt.a.COUNT&&void 0!==s&&s!==Ct.a&&s!==Ct.d){let t;const a=Object(E.get)(e.datafeed_config,"aggregations")||Object(E.get)(e.datafeed_config,"aggs");void 0!==a&&Object.values(a).length>0&&(t=Object(E.get)(Object.values(a)[0],["aggregations",s,Lt.a.CARDINALITY,"field"])||Object(E.get)(Object.values(a)[0],["aggs",s,Lt.a.CARDINALITY,"field"])),i.function!==Lt.b.NON_ZERO_COUNT&&i.function!==Lt.b.LOW_NON_ZERO_COUNT&&i.function!==Lt.b.HIGH_NON_ZERO_COUNT&&i.function!==Lt.b.COUNT&&i.function!==Lt.b.HIGH_COUNT&&i.function!==Lt.b.LOW_COUNT||void 0===t?(n.metricFunction=Lt.a.SUM,n.metricFieldName=s):(n.metricFunction=Lt.a.CARDINALITY,n.metricFieldName=void 0)}return n}const Mp={getMetricData:function(e,t,a,i,n,s,r){if(Object(Te.l)(e,t)&&Object(Te.m)(e,t,a)){const r=[],o=e.analysis_config.detectors[t];if(void 0!==o.partition_field_name){const e=Object(E.find)(a,{fieldName:o.partition_field_name});void 0!==e&&r.push({fieldName:"partition_field_name",fieldValue:e.fieldName},{fieldName:"partition_field_value",fieldValue:e.fieldValue})}if(void 0!==o.over_field_name){const e=Object(E.find)(a,{fieldName:o.over_field_name});void 0!==e&&r.push({fieldName:"over_field_name",fieldValue:e.fieldName},{fieldName:"over_field_value",fieldValue:e.fieldValue})}if(void 0!==o.by_field_name){const e=Object(E.find)(a,{fieldName:o.by_field_name});void 0!==e&&r.push({fieldName:"by_field_name",fieldValue:e.fieldName},{fieldName:"by_field_value",fieldValue:e.fieldValue})}return js.mlResultsService.getModelPlotOutput(e.job_id,t,r,i,n,s)}{const o={success:!0,results:{}},l=Sp(e,t);return js.mlResultsService.getMetricData(l.datafeedConfig.indices,a,l.datafeedConfig.query,null!=r?r:l.metricFunction,l.metricFieldName,l.summaryCountFieldName,l.timeField,i,n,s,null==l?void 0:l.datafeedConfig).pipe(Object(Me.map)((e=>(Object(E.each)(e.results,((e,t)=>{o.results[t]={actual:e}})),o))))}},getChartDetails:function(e,t,a,i,n){return new Promise(((s,r)=>{const o={success:!0,results:{functionLabel:"",entityData:{entities:[]}}},l=Sp(e,t);let c=l.metricFunction;void 0!==l.metricFieldName&&(c+=" ",c+=l.metricFieldName),o.results.functionLabel=c;const d=Object(E.filter)(a,(e=>null===e.fieldValue));if(0===d.length)o.results.entityData.count=1,o.results.entityData.entities=a,s(o);else{const e=d.map((e=>e.fieldName));ge.ml.getCardinalityOfFields({index:l.datafeedConfig.indices,fieldNames:e,query:l.datafeedConfig.query,timeFieldName:l.timeField,earliestMs:i,latestMs:n}).then((e=>{Object(E.each)(d,(t=>{o.results.entityData.entities.push({fieldName:t.fieldName,cardinality:Object(E.get)(e,t.fieldName,0)})})),s(o)})).catch((e=>{r(e)}))}}))}};function kp(e){return e.filter(Te.p).map((e=>{const t=Object(tu.a)(e.analysis_config.bucket_span);return{id:e.job_id,selected:!1,bucketSpanSeconds:t.asSeconds()}}))}function Cp(e,t){const a=[];return!0===t?Object(E.each)(e,((e,t)=>{a.push({date:new Date(+t),lower:e.modelLower,value:e.actual,upper:e.modelUpper})})):Object(E.each)(e,((e,t)=>{a.push({date:new Date(+t),value:e.actual})})),a}function Tp(e){const t=[];return Object(E.each)(e,((e,a)=>{t.push({date:new Date(+a),isForecast:!0,lower:e.forecastLower,value:e.prediction,upper:e.forecastUpper})})),t}function Fp(e,t){return void 0!==t&&Object(E.each)(t,((t,a)=>{const i=function(e,t){let a;if(void 0===e)return a;for(let i=0;i<e.length;i++)if(e[i].date.getTime()===t){a=e[i];break}if(void 0===a){let i;for(let a=0;a<e.length;a++){const n=e[a].date.getTime();if(n>t){const s=e[a],r=e[a-1],o=Math.abs(t-r.date.getTime()),l=Math.abs(t-n);i=void 0===r||o>l?s:r;break}}a=i}return a}(e,a);void 0!==i&&(i.scheduledEvents=t)})),e}function Ip(e,t,a){let i;if(void 0===e)return i;for(let a=0;a<e.length;a++)if(e[a].date.getTime()===t){i=e[a];break}if(void 0===i){let n;const s=a.asMilliseconds();for(let a=0;a<e.length;a++){if(t-e[a].date.getTime()<s){n=e[a];break}}i=n}return i}function Dp(e,t,a,i){const n=void 0!==t?t:100,s=Math.floor(1.1*n),r=Object(Ss.c)();r.setInterval("auto"),r.setBounds(e),r.setBarTarget(Math.floor(n)),r.setMaxBars(s);const o=Object(E.find)(a,{id:i.job_id}).bucketSpanSeconds;let l=r.getIntervalToNearestMultiple(o);return l.asSeconds()<o&&(r.setInterval(o+"s"),l=r.getInterval()),l}function Ap(e,t,a,i,n,s,r,o,l){const c=void 0!==l?$d.c.toES(l):l;return Object(Se.forkJoin)([Mp.getMetricData(o,t,s,r.min.valueOf(),r.max.valueOf(),a.asMilliseconds(),c),js.mlResultsService.getRecordsForCriteria([o.job_id],e,0,r.min.valueOf(),r.max.valueOf(),S.b,l),js.mlResultsService.getScheduledEventsByBucket([o.job_id],r.min.valueOf(),r.max.valueOf(),a.asMilliseconds(),1,10),ge.ml.annotations.getAnnotations$({jobIds:[o.job_id],earliestMs:r.min.valueOf(),latestMs:r.max.valueOf(),maxAnnotations:S.a,detectorIndex:t,entities:s}).pipe(Object(Me.catchError)((e=>Object(Se.of)({annotations:{},totalCount:0,error:Object(ze.b)(e),success:!1})))),void 0!==i?(()=>{let e;const l=o.analysis_config.detectors[t],c=Object(Te.q)(l.function);return n||"sum"!==c&&"count"!==c||(e={avg:"sum",max:"sum",min:"sum"}),Ku.a.getForecastData(o,t,i,s,r.min.valueOf(),r.max.valueOf(),a.asMilliseconds(),e)})():Object(Se.of)(null)]).pipe(Object(Me.map)((([e,t,i,s,r])=>{const c=t.records.sort(((e,t)=>e.timestamp-t.timestamp)).reverse(),d=i.events[o.job_id];let u=Cp(e.results,n);u=function(e,t,a,i,n){const s=[],r=a.asMilliseconds();let o;return void 0!==e&&e.length>0&&(o=e[e.length-1].date.getTime()),t.forEach((t=>{const i=t.timestamp;if(void 0===Ip(e,i,a)){const e=Math.floor(i/r)*r;-1===s.indexOf(e)&&e!==o&&s.push(e)}})),s.sort(((e,t)=>e-t)),s.forEach((t=>{const a={date:new Date(t),value:null};!0===i&&(a.upper=null,a.lower=null),e.push(a)})),t.forEach((t=>{const i=t.timestamp;if(t.function===Lt.b.METRIC&&t.function_description!==n)return;const s=Ip(e,i,a);if(void 0!==s){const e=t.record_score,a=s.anomalyScore;if(void 0===a||a<e){if(s.anomalyScore=e,s.function=t.function,void 0!==t.actual)null===s.value&&(s.value=t.actual),t.function===Lt.b.METRIC&&(s.value=Array.isArray(t.actual)?t.actual[0]:t.actual),s.actual=t.actual,s.typical=t.typical;else{const e=Object(E.get)(t,"causes",[]);if(e.length>0&&(s.byFieldName=t.by_field_name,s.numberOfCauses=e.length,1===e.length)){const e=t.causes[0];s.actual=e.actual,s.typical=e.typical,null===s.value&&(s.value=e.actual)}}void 0!==t.multi_bucket_impact&&(s.multiBucketImpact=t.multi_bucket_impact)}}})),e}(u,c,a,n,l),u=Fp(u,d);const p={scheduledEvents:d,anomalyRecords:c,focusChartData:u};var m;s&&(void 0!==s.error?(p.focusAnnotationError=s.error,p.focusAnnotationData=[]):p.focusAnnotationData=(null!==(m=s.annotations[o.job_id])&&void 0!==m?m:[]).sort(((e,t)=>e.timestamp-t.timestamp)).map(((e,t)=>(e.key=(t+1).toString(),e))));return r&&(p.focusForecastData=Tp(r.results),p.showForecastCheckbox=p.focusForecastData.length>0),p})))}var Lp=a(230);var Rp=a(207);function Pp(e,t,a){const i=re.a.getJob(a),n=[];if(void 0===i)return n;const s=e,r=i.analysis_config.detectors[s],o=t,l=null==r?void 0:r.partition_field_name,c=null==r?void 0:r.over_field_name,d=null==r?void 0:r.by_field_name;if(void 0!==l){var u;const e=null!==(u=null==o?void 0:o[l])&&void 0!==u?u:null;n.push({fieldType:"partition_field",fieldName:l,fieldValue:e})}if(void 0!==c){var p;const e=null!==(p=null==o?void 0:o[c])&&void 0!==p?p:null;n.push({fieldType:"over_field",fieldName:c,fieldValue:e})}if(void 0!==d&&void 0===c){var m;const e=null!==(m=null==o?void 0:o[d])&&void 0!==m?m:null;n.push({fieldType:"by_field",fieldName:d,fieldValue:e})}return n}var Np=a(331),zp=a(330);function Bp(e){const t=e.analysis_config.detectors,a=[];return t.forEach(((t,i)=>{Object(Te.o)(e,i)&&a.push({index:i,detector_description:t.detector_description,function:t.function})})),a}function Jp(e,t){const a=Bp(e);if(Array.isArray(a)&&a.length>=t){const a=e.analysis_config.detectors[t];if((null==a?void 0:a.function)===Lt.b.METRIC)return!0}return!1}const Vp=[{value:"mean",text:y.i18n.translate("xpack.ml.timeSeriesExplorer.plotByAvgOptionLabel",{defaultMessage:"mean"})},{value:"min",text:y.i18n.translate("xpack.ml.timeSeriesExplorer.plotByMinOptionLabel",{defaultMessage:"min"})},{value:"max",text:y.i18n.translate("xpack.ml.timeSeriesExplorer.plotByMaxOptionLabel",{defaultMessage:"max"})}],Up=({functionDescription:e,setFunctionDescription:t,selectedDetectorIndex:a,selectedJobId:i,selectedEntities:s,entityControlsCount:r})=>{const o=Object(Et.c)(),l=Object(n.useCallback)((async(e,a,i,n)=>{const s=await(async({selectedDetectorIndex:e,selectedEntities:t,selectedJobId:a,selectedJob:i},n)=>{if(!Jp(i,e))return;const s=Pp(e,t,a),r=[{fieldName:"detector_index",fieldValue:e},...s.filter((e=>null!==e.fieldValue))];try{const e=await js.mlResultsService.getRecordsForCriteria([i.job_id],r,0,null,null,1).toPromise();if(Array.isArray(null==e?void 0:e.records)&&1===e.records.length){const t=e.records[0];return null==t?void 0:t.function_description}return Lt.a.AVG}catch(e){n.displayErrorToast(e,y.i18n.translate("xpack.ml.timeSeriesExplorer.highestAnomalyScoreErrorToastTitle",{defaultMessage:"An error occurred getting record with the highest anomaly score"}))}})({selectedDetectorIndex:e,selectedEntities:a,selectedJobId:i,selectedJob:n},o);t(s)}),[t,o]);return Object(n.useEffect)((()=>{if(void 0!==e)return;const t=re.a.getJob(i);if((0===r||r>0&&void 0!==s)&&void 0===e&&Jp(t,a)){const e=t.analysis_config.detectors[a];(null==e?void 0:e.function)===Lt.b.METRIC&&l(a,s,i,t)}}),[t,a,s,i,e,r]),void 0===e?null:Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiFormRow,{label:y.i18n.translate("xpack.ml.timeSeriesExplorer.metricPlotByOption",{defaultMessage:"Function"})},Object(N.jsx)(te.EuiSelect,{options:Vp,value:e,onChange:e=>t(e.target.value),"aria-label":y.i18n.translate("xpack.ml.timeSeriesExplorer.metricPlotByOptionLabel",{defaultMessage:"Pick function to plot by (min, max, or average) if metric function"})})))};const Gp=({bounds:e,selectedDetectorIndex:t,selectedJobId:a,appStateHandler:i,children:s,selectedEntities:r,functionDescription:o,setFunctionDescription:l})=>{var c;const{services:{mlServices:{mlApiServices:{results:d}}}}=Object(f.b)(),u=Object(n.useMemo)((()=>re.a.getJob(a)),[a]),p=!(null===(c=u.model_plot_config)||void 0===c||!c.enabled),[m,b]=Object(n.useState)(!1),[h,g]=Object(n.useState)({}),j=Object(n.useMemo)((()=>Bp(u)),[u]),x=Object(n.useMemo)((()=>Pp(t,r,a)),[t,r,a]),[v,y]=Object(zp.a)(Np.b),O=Object(n.useMemo)((()=>{return{...(e=x.map((e=>e.fieldType)),t=!v||Object.values(v).some((e=>!(null==e||!e.anomalousOnly))),a=!v||Object.values(v).some((e=>!(null==e||!e.applyTimeRange))),e.reduce(((e,i)=>(e[i]={applyTimeRange:a,anomalousOnly:t,sort:{by:"anomaly_score",order:"desc"}},e)),{})),...v||{}};var e,t,a}),[x,v]),w=async(a={})=>{b(!0);const i=t,n=O?Object.fromEntries(Object.entries(O).filter((([e])=>x.some((t=>t.fieldType===e))))):void 0,{partition_field:s,over_field:r,by_field:o}=await d.fetchPartitionFieldsValues(u.job_id,a,[{fieldName:"detector_index",fieldValue:i}],e.min.valueOf(),e.max.valueOf(),n).toPromise(),l={};x.forEach((e=>{let t;(null==s?void 0:s.name)===e.fieldName&&(t=s.values),(null==r?void 0:r.name)===e.fieldName&&(t=r.values),(null==o?void 0:o.name)===e.fieldName&&(t=o.values),l[e.fieldName]=t})),b(!1),g(l)};Object(n.useEffect)((()=>{w()}),[a,t,JSON.stringify(r),O]);const _=Object(E.debounce)((async(e,t)=>{await w({[e.fieldType]:t})}),500),S=(e,t)=>{const a={...x.reduce(((e,t)=>(e[t.fieldName]=t.fieldValue,e)),{}),[e.fieldName]:t};i(vp,a)},M=Object(n.useCallback)((e=>{const t=e.target.value;void 0!==t&&i(xp,+t)}),[i]),k=j.map((e=>({value:e.index,text:e.detector_description}))),C=Object(n.useCallback)(((e,t)=>{var a,i;const n={...O[e]?O[e]:{},...t},s={...O};if((null===(a=O[e])||void 0===a?void 0:a.anomalousOnly)!==n.anomalousOnly)for(const e in s)s.hasOwnProperty(e)&&(s[e].anomalousOnly=n.anomalousOnly);if((null===(i=O[e])||void 0===i?void 0:i.applyTimeRange)!==n.applyTimeRange)for(const e in s)s.hasOwnProperty(e)&&(s[e].applyTimeRange=n.applyTimeRange);y({...s,[e]:n})}),[O,y]);let T=!1;return Object(N.jsx)("div",{"data-test-subj":"mlSingleMetricViewerSeriesControls"},Object(N.jsx)(te.EuiFlexGroup,null,Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiFormRow,{label:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.detectorLabel",defaultMessage:"Detector"})},Object(N.jsx)(te.EuiSelect,{onChange:M,value:t,options:k,"data-test-subj":"mlSingleMetricViewerDetectorSelect"}))),x.map((e=>{const t=`${e.fieldName}`,a=!T&&null===e.fieldValue;return T=!T&&a,Object(N.jsx)(Wd.b,{entity:e,entityFieldValueChanged:S,isLoading:m,onSearchChange:_,config:O[e.fieldType],onConfigChange:C,forceSelection:a,key:t,options:(i=h[e.fieldName],Array.isArray(i)?i.map((e=>({label:""===e.value?Wd.a:e.value,value:e}))):[]),isModelPlotEnabled:p});var i})),Object(N.jsx)(Up,{selectedJobId:a,selectedDetectorIndex:t,selectedEntities:r,functionDescription:o,setFunctionDescription:l,entityControlsCount:x.length}),s))};var qp=a(231),Hp=a(106),Wp=a.n(Hp),$p=a(148);function Yp(e,t,a,i){this.contextGroup=e,this.data=t,this.drawBounds=a,this.swimlaneHeight=i,this.mask=this.contextGroup.append("g").attr("class","mask"),this.leftGroup=this.mask.append("g").attr("class","left-mask"),this.rightGroup=this.mask.append("g").attr("class","right-mask"),this.leftPolygon=this.leftGroup.append("polygon"),this.rightPolygon=this.rightGroup.append("polygon"),!0===this.drawBounds&&(this.leftGroup.append("path").attr("class","left area bounds"),this.rightGroup.append("path").attr("class","right area bounds")),this.leftGroup.append("path").attr("class","left values-line"),this.rightGroup.append("path").attr("class","right values-line"),this._x=null,this._y=null}Yp.prototype.style=function(e,t){return this.leftGroup.style(e,t),this.rightGroup.style(e,t),this},Yp.prototype.x=function(e){return null==e?this._x:(this._x=e,this)},Yp.prototype.y=function(e){return null==e?this._y:(this._y=e,this)},Yp.prototype.redraw=function(){const e=this._y.domain(),t=e[0],a=e[1],i=this._x.domain(),n=i[0],s=i[1],r=this,o=this.data.filter((function(e){return e.date<r.from})),l=this.data.filter((function(e){return e.date>r.to}));if(!0===this.drawBounds){const e=Wp.a.svg.area().x((function(e){return r._x(e.date)||1})).y0((function(e){return r._y(Math.min(a,Math.max(e.lower,t)))})).y1((function(e){return r._y(Math.max(t,Math.min(e.upper,a)))})).defined((e=>null!==e.lower&&null!==e.upper));this.leftGroup.select(".left.area.bounds").attr("d",e(o)),this.rightGroup.select(".right.area.bounds").attr("d",e(l))}const c=Wp.a.svg.line().x((function(e){return r._x(e.date)})).y((function(e){return r._y(e.value)})).defined((e=>null!==e.value));this.leftGroup.select(".left.values-line").attr("d",c(o)),Object($p.g)(o,this.leftGroup,c,1),this.rightGroup.select(".right.values-line").attr("d",c(l)),Object($p.g)(l,this.rightGroup,c,1);const d=this._x(n),u=this._y(t)+this.swimlaneHeight,p=this._x(this.from),m=0,b=this._x(this.to),h=this._y(t)+this.swimlaneHeight,f=this._x(s),g=0;return this.leftPolygon.attr("points",d+","+u+"  "+p+","+u+"  "+p+","+m+"  "+d+","+m),this.rightPolygon.attr("points",b+","+h+"  "+f+","+h+"  "+f+","+g+"  "+b+","+g),this},Yp.prototype.reveal=function(e){return this.from=e[0],this.to=e[1],this.redraw(),this};var Xp=a(173);const Qp="mlAnnotationMask";function Kp(){const{annotationUpdatesService:e}=this.props,t=this.focusXScale,a=Wp.a.svg.brush().x(t).on("brushend",function(){const{selectedJob:t}=this.props,i=a.extent(),n=i[0].getTime(),s=i[1].getTime();if(n===s)return void e.setValue(null);const r={timestamp:n,end_timestamp:s,annotation:"",job_id:t.job_id,type:Xp.d.ANNOTATION};e.setValue(r)}.bind(this));return a}function Zp(e){const t={};return e.forEach(((a,i)=>{if(void 0!==a.key){const n=e.filter(((e,t)=>t<i));t[a.key]=n.reduce(((e,i)=>void 0===a.end_timestamp||void 0===i.end_timestamp||void 0===i.key||i.timestamp<a.timestamp&&i.end_timestamp<a.timestamp||i.timestamp>a.end_timestamp&&i.end_timestamp>a.end_timestamp?e:t[i.key]+1),0)}})),t}function em(e){Wp.a.selectAll(".mlAnnotation").each((function(t){const a=Wp.a.select(this);t._id===e._id?a.selectAll(".mlAnnotationRect").classed("mlAnnotationRect-isHighlight",!0):(a.selectAll(".mlAnnotationTextRect").classed("mlAnnotationTextRect-isBlur",!0),a.selectAll(".mlAnnotationText").classed("mlAnnotationText-isBlur",!0),a.selectAll(".mlAnnotationRect").classed("mlAnnotationRect-isBlur",!0))}))}function tm(){Wp.a.selectAll(".mlAnnotation").each((function(){const e=Wp.a.select(this);e.selectAll(".mlAnnotationTextRect").classed("mlAnnotationTextRect-isBlur",!1),e.selectAll(".mlAnnotationRect").classed("mlAnnotationRect-isHighlight",!1).classed("mlAnnotationRect-isBlur",!1),e.selectAll(".mlAnnotationText").classed("mlAnnotationText-isBlur",!1)}))}const am=25,im=310,nm=335,sm=25,rm=$p.a+4,om={top:10,right:10,bottom:15,left:40},lm=[{duration:qe.a.duration(1,"h"),label:"1h"},{duration:qe.a.duration(12,"h"),label:"12h"},{duration:qe.a.duration(1,"d"),label:"1d"},{duration:qe.a.duration(1,"w"),label:"1w"},{duration:qe.a.duration(2,"w"),label:"2w"},{duration:qe.a.duration(1,"M"),label:"1M"}],cm=Wp.a.scale.threshold().domain([3,25,50,75,100]).range(["#d2e9f7","#8bc8fb","#ffdd00","#ff7e00","#fe5050"]),dm=Wp.a.scale.threshold().domain([3,25,50,75,100]).range(["#dce7ed","#b0c5d6","#b1a34e","#b17f4e","#c88686"]);class timeseries_chart_TimeseriesChartIntl extends n.Component{constructor(...e){super(...e),Ce()(this,"rowMouseenterSubscriber",null),Ce()(this,"rowMouseleaveSubscriber",null),Ce()(this,"contextChartInitialized",!1),Ce()(this,"drawContextBrush",(e=>{const{contextChartSelected:t}=this.props,a=this.brush,i=this.contextXScale,n=this.mask;a.x(i).on("brush",c).on("brushend",(function(){const n=a.empty()?i.domain():a.extent(),s=n[0].getTime(),r=n[1].getTime();if(void 0!==d.selectedBounds&&d.selectedBounds.min.valueOf()===s&&d.selectedBounds.max.valueOf()===r)return;e.selectAll(".swimlane-cell").style("fill",(e=>{const t=e.date.getTime();return t<s||t>r?dm(e.score):cm(e.score)})),d.selectedBounds={min:qe()(s),max:qe()(r)},t({from:n[0],to:n[1]})})),e.append("g").attr("class","x brush").call(a).selectAll("rect").attr("y",-1).attr("height",91).attr("width",this.vizWidth);const s=a.extent();e.selectAll(".w rect").attr("x",-10).attr("width",10),e.selectAll(".e rect").attr("transform",null).attr("width",10);const r=e.append("rect").attr("class","top-border").attr("y",-2).attr("height",3),o=e.append("foreignObject").attr("width",10).attr("height",90).attr("class","brush-handle").attr("x",i(s[0])-10).html('\n        <div class="brush-handle-inner brush-handle-inner-left" style="padding-top: 27px">\n          <svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="6" height="9">\n            <polygon points="5,0 5,8 0,4" />\n          </svg>\n        </div>'),l=e.append("foreignObject").attr("width",10).attr("height",90).attr("class","brush-handle").attr("x",i(s[1])+0).html('\n        <div class="brush-handle-inner brush-handle-inner-right" style="padding-top: 27px">\n          <svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="6" height="9">\n            <polygon points="0,0 0,8 5,4" />\n          </svg>\n        </div>');function c(){const e=a.extent();n.reveal(e),o.attr("x",i(e[0])-10),l.attr("x",i(e[1])+0),r.attr("x",i(e[0])+1);const t=Math.max(0,i(e[1])-i(e[0])-2);r.attr("width",t);const s=a.empty();Wp.a.selectAll(".brush-handle").style("visibility",s?"hidden":"visible")}c();const d=this})),Ce()(this,"drawSwimlane",((e,t,a)=>{const{contextAggregationInterval:i,swimlaneData:n}=this.props,s=n;if(void 0===s)return;const r=this.calculateContextXAxisDomain(),o=Wp.a.time.scale().range([0,t]).domain(r),l=Wp.a.scale.linear().range([a,0]).domain([0,a]),c=Wp.a.svg.axis().scale(o).orient("bottom").innerTickSize(-a).outerTickSize(0),d=Wp.a.svg.axis().scale(l).orient("left").tickValues(l.domain()).innerTickSize(-t).outerTickSize(0),u=e.append("g");u.append("g").attr("class","x axis").attr("transform","translate(0,"+a+")").call(c),u.append("g").attr("class","y axis").call(d);const p=r[0].getTime();let m=t/((r[1].getTime()-p)/i.asMilliseconds());m<1&&(m=1);e.append("g").attr("class","swimlane-cells").selectAll("rect").data(s).enter().append("rect").attr("x",(e=>o(e.date))).attr("y",0).attr("rx",0).attr("ry",0).attr("class",(e=>e.score>0?"swimlane-cell":"swimlane-cell-hidden")).attr("width",m).attr("height",a).style("fill",(e=>cm(e.score)))})),Ce()(this,"calculateContextXAxisDomain",(()=>{const{bounds:e,contextAggregationInterval:t,swimlaneData:a}=this.props;let i=e.min.valueOf();void 0!==a&&a.length>0&&(i=Math.min(a[0].date.getTime(),e.min.valueOf()));const n=t.asMilliseconds(),s=Math.floor(i/n)*n,r=Math.ceil(e.max.valueOf()/n)*n;return[new Date(s),new Date(r)]})),Ce()(this,"setContextBrushExtent",((e,t)=>{const a=this.brush,i=a.extent(),n=[e,t];a.extent(n),a(Wp.a.select(".brush")),n[0].getTime()===i[0].getTime()&&n[1].getTime()===i[1].getTime()||a.event(Wp.a.select(".brush"))}))}componentWillUnmount(){Wp.a.select(this.rootNode).html(""),null!==this.rowMouseenterSubscriber&&this.rowMouseenterSubscriber.unsubscribe(),null!==this.rowMouseleaveSubscriber&&this.rowMouseleaveSubscriber.unsubscribe()}componentDidMount(){const{svgWidth:e}=this.props;this.vizWidth=e-om.left-om.right;const t=this.vizWidth;this.focusXScale=Wp.a.time.scale().range([0,t]),this.focusYScale=Wp.a.scale.linear().range([nm,am]);const a=this.focusXScale,i=this.focusYScale;this.focusXAxis=Wp.a.svg.axis().scale(a).orient("bottom").innerTickSize(-310).outerTickSize(0).tickPadding(10),this.focusYAxis=Wp.a.svg.axis().scale(i).orient("left").innerTickSize(-t).outerTickSize(0).tickPadding(10),this.focusValuesLine=Wp.a.svg.line().x((function(e){return a(e.date)})).y((function(e){return i(e.value)})).defined((e=>null!==e.value)),this.focusBoundedArea=Wp.a.svg.area().x((function(e){return a(e.date)||1})).y0((function(e){return i(e.upper)})).y1((function(e){return i(e.lower)})).defined((e=>null!==e.lower&&null!==e.upper)),this.contextXScale=Wp.a.time.scale().range([0,t]),this.contextYScale=Wp.a.scale.linear().range([60,3]),this.fieldFormat=void 0,this.annotateBrush=Kp.call(this),this.brush=Wp.a.svg.brush(),this.mask=void 0;const n=this.highlightFocusChartAnomaly.bind(this),s=em.bind(this);const r=this.unhighlightFocusChartAnomaly.bind(this),o=tm.bind(this);this.rowMouseenterSubscriber=bu.a.rowMouseenter$.subscribe((function({record:e,type:t="anomaly"}){"anomaly"===t?n(e):"annotation"===t&&s(e)})),this.rowMouseleaveSubscriber=bu.a.rowMouseleave$.subscribe((function({record:e,type:t="anomaly"}){"anomaly"===t?r(e):o(e)})),this.renderChart(),this.drawContextChartSelection(),this.renderFocusChart()}componentDidUpdate(e){if(!1!==this.props.renderFocusChartOnly&&e.svgWidth===this.props.svgWidth&&e.showAnnotations===this.props.showAnnotations&&e.annotationData===this.props.annotationData||(this.renderChart(),this.drawContextChartSelection()),this.renderFocusChart(),null===this.props.annotation){Wp.a.select(this.rootNode).select("g.mlAnnotationBrush").call(this.annotateBrush.extent([0,0]))}}renderChart(){const{contextChartData:e,contextForecastData:t,detectorIndex:a,modelPlotEnabled:i,selectedJob:n,svgWidth:s,showAnnotations:r}=this.props,o=this.createFocusChart.bind(this),l=this.drawContextElements.bind(this),c=this.focusXScale,d=this.focusYAxis,u=this.focusYScale,p=function(e){return 425+(e?rm:0)+sm+om.top+om.bottom}(r),m=Wp.a.select(this.rootNode);if(m.selectAll("*").remove(),void 0===n)return;if(this.fieldFormat=nu.a.getFieldFormat(n.job_id,a),void 0===e)return;const b=this.fieldFormat,h=m.append("svg").attr("width",s).attr("height",p);let f,g;if(!0===i||void 0!==t&&t.length>0){const a=void 0===t?e:e.concat(t);f=Wp.a.min(a,(e=>Math.min(e.value,e.lower))),g=Wp.a.max(a,(e=>Math.max(e.value,e.upper)))}else f=Wp.a.min(e,(e=>e.value)),g=Wp.a.max(e,(e=>e.value));const j=g>0?Math.pow(10,Math.ceil(Math.log10(Math.abs(g)))):g,x=f>=0?f:-1*Math.pow(10,Math.ceil(Math.log10(Math.abs(f))));u.domain([x,j]);let v=0;h.append("g").attr("class","temp-axis-label tick").selectAll("text.temp.axis").data(u.ticks()).enter().append("text").text((e=>void 0!==b?b.convert(e,"text"):u.tickFormat()(e))).each((function(){v=Math.max(this.getBBox().width+d.tickPadding(),v)})).remove(),Wp.a.select(".temp-axis-label").remove(),om.left=Math.max(v,40),this.vizWidth=Math.max(s-om.left-om.right,0),c.range([0,this.vizWidth]),d.innerTickSize(-this.vizWidth);const y=h.append("g").attr("class","focus-chart").attr("transform","translate("+om.left+","+om.top+")"),O=h.append("g").attr("class","context-chart").attr("transform","translate("+om.left+","+(nm+om.top+sm)+")");h.append("defs").append("mask").attr("id",Qp).append("rect").attr("x",0).attr("y",0).attr("width",this.vizWidth).attr("height",nm).style("fill","white"),o(y,this.vizWidth,nm),l(O,this.vizWidth,60,30,rm)}drawContextChartSelection(){const{contextChartData:e,contextForecastData:t,zoomFrom:a,zoomTo:i}=this.props;if(void 0===e)return;let n,s;const r=this.contextXScale.domain()[0].getTime(),o=this.contextXScale.domain()[1].getTime();let l=e;if(void 0!==t&&(l=l.concat(t)),n=a?a.getTime():Object(E.reduce)(l,((e,t)=>Math.min(e,t.date.getTime())),new Date(2099,12,31).getTime()),n=Math.max(n,r),s=i?i.getTime():Object(E.reduce)(l,((e,t)=>Math.max(e,t.date.getTime())),0),s=Math.min(s,o),n!==r||s!==o){this.setContextBrushExtent(new Date(n),new Date(s));const e={min:qe()(new Date(n)),max:qe()(n)};this.selectedBounds=e}else{const e=this.contextXScale.domain(),t={min:qe()(new Date(e[0])),max:qe()(e[1])};Object(E.isEqual)(t,this.selectedBounds)||(this.selectedBounds=t,this.setContextBrushExtent(new Date(e[0]),new Date(e[1])))}}createFocusChart(e,t,a){const{contextForecastData:i}=this.props,n=e.append("g").attr("class","focus-zoom");n.append("rect").attr("x",0).attr("y",0).attr("width",t).attr("height",am).attr("class","chart-border"),this.createZoomInfoElements(n,t);const s=this.annotateBrush.bind(this);let r=0,o=0;null!==this.props.annotation&&(r=this.focusXScale(this.props.annotation.timestamp),o=function(e,t){const a=t(e.timestamp)+1,i=void 0!==e.end_timestamp?t(e.end_timestamp)-1:a+8;return Math.max(8,i-a)}(this.props.annotation,this.focusXScale)),e.append("g").attr("class","mlAnnotationBrush").call(s).selectAll("rect").attr("x",r).attr("y",am).attr("width",o).attr("height",im),e.append("g").classed("mlAnnotations",!0),e.append("rect").attr("x",0).attr("y",am).attr("width",t).attr("height",im).attr("class","chart-border");const l=e.append("g").attr("class","x-axis-background");l.append("rect").attr("x",0).attr("y",a).attr("width",t).attr("height",sm),l.append("line").attr("x1",0).attr("y1",a).attr("x2",0).attr("y2",a+sm),l.append("line").attr("x1",t).attr("y1",a).attr("x2",t).attr("y2",a+sm),l.append("line").attr("x1",0).attr("y1",a+sm).attr("x2",t).attr("y2",a+sm);const c=e.append("g");c.append("g").attr("class","x axis").attr("transform","translate(0,"+a+")"),c.append("g").attr("class","y axis"),e.append("path").attr("class","area bounds"),e.append("path").attr("class","values-line"),e.append("g").attr("class","focus-chart-markers"),i&&(e.append("path").attr("class","area forecast").attr("data-test-subj","mlForecastArea"),e.append("path").attr("class","values-line forecast").attr("data-test-subj","mlForecastValuesline"),e.append("g").attr("class","focus-chart-markers forecast").attr("data-test-subj","mlForecastMarkers")),e.append("rect").attr("x",0).attr("y",0).attr("width",t).attr("height",a+24).attr("class","chart-border chart-border-highlight")}renderFocusChart(){const{focusAggregationInterval:e,focusAnnotationData:t,focusChartData:a,focusForecastData:i,modelPlotEnabled:n,selectedJob:s,showAnnotations:r,showForecast:o,showModelBounds:l,zoomFromFocusLoaded:c,zoomToFocusLoaded:d}=this.props,u=Array.isArray(t)?t:[];if(void 0===a)return;const p=a,m=this.contextYScale,b=this.showFocusChartTooltip.bind(this),h=this.props.tooltipService.hide.bind(this.props.tooltipService),f=Wp.a.select(".focus-chart"),g=e.expression,j=s.analysis_config.bucket_span;if(Wp.a.select(this.rootNode).select(".zoom-aggregation-interval").text(y.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.zoomAggregationIntervalLabel",{defaultMessage:"(aggregation interval: {focusAggInt}, bucket span: {bucketSpan})",values:{focusAggInt:g,bucketSpan:j}})),void 0===c||void 0===d)return;const x={min:qe()(c.getTime()),max:qe()(d.getTime())},v=e.asMilliseconds(),O=qe()(Math.floor(x.min.valueOf()/v)*v),E=qe()(Math.ceil(x.max.valueOf()/v)*v);if(this.focusXScale.domain([O.toDate(),E.toDate()]),a.length>0||void 0!==i&&i.length>0){void 0!==this.fieldFormat?this.focusYAxis.tickFormat((e=>this.fieldFormat.convert(e,"text"))):this.focusYAxis.tickFormat(null);let e=0,t=0,a=p;if(o&&void 0!==i&&i.length>0&&(a=p.concat(i)),e=Wp.a.min(a,(e=>{let t=e.value;return null===t&&void 0!==e.anomalyScore&&void 0!==e.actual&&(t=Array.isArray(e.actual)?e.actual[0]:e.actual),void 0!==e.lower?null!=t?Math.min(t,e.lower):e.lower:t})),t=Wp.a.max(a,(e=>{let t=e.value;return null===t&&void 0!==e.anomalyScore&&void 0!==e.actual&&(t=Array.isArray(e.actual)?e.actual[0]:e.actual),void 0!==e.upper?Math.max(t,e.upper):t})),t===e&&(this.contextYScale.domain()[0]!==m.domain()[1]&&e>=m.domain()[0]&&t<=m.domain()[1]?(e=m.domain()[0],t=m.domain()[1]):(e-=.05*e,t+=.05*t)),r&&u&&u.length>0){const a=Zp(u),i=Wp.a.max(Object.keys(a).map((e=>a[e])));t+=Math.abs(t-e)*((i+1)/5)}this.focusYScale.domain([e,t])}else this.focusYScale.domain([0,10]),this.focusYAxis.tickFormat("");const w=Object(Ss.c)();w.setInterval("auto"),w.setBounds(x);const _=w.getScaledDateFormat();f.select(".x.axis").call(this.focusXAxis.ticks(Object($p.m)(this.vizWidth),_).tickFormat((e=>qe()(e).format(_)))),f.select(".y.axis").call(this.focusYAxis),Object($p.h)(f.select(".x.axis"),this.vizWidth),!0===n&&f.select(".area.bounds").attr("d",this.focusBoundedArea(p)).classed("hidden",!l),function(e,t,a,i,n,s,r,o,l){const c={};t.forEach((e=>{if(void 0!==e.key){const t=(e.end_timestamp||0)-e.timestamp;c[e.key]=t}})),t.sort(((e,t)=>void 0===e.key||void 0===t.key?0:c[t.key]-c[e.key]));const d=Zp(t),u=function(e){r(e,this)},p=e=>{l.setValue(null),l.setValue(e)},m=e.select(".mlAnnotations").selectAll("g.mlAnnotation").data(t||[],(e=>e._id||""));m.enter().append("g").classed("mlAnnotation",!0);const b=m.selectAll(".mlAnnotationRect").data((e=>[e]));b.enter().append("rect").classed("mlAnnotationRect",!0).attr("mask","url(#mlAnnotationMask)").on("mouseover",u).on("mouseout",o).on("click",p),b.attr("x",(e=>{const t=qe()(e.timestamp);return n(t)})).attr("y",(e=>{const t=void 0!==e.key?d[e.key]:1;return a+1+0+28*t})).attr("height",(e=>{const t=void 0!==e.key?d[e.key]:1;return i-2-0-28*t})).attr("width",(e=>{const t=n(qe()(e.timestamp))+1,a=void 0!==e.end_timestamp?n(qe()(e.end_timestamp))-1:t+8;return Math.max(8,a-t)})),b.exit().remove();const h=m.selectAll(".mlAnnotationTextRect").data((e=>[e])),f=m.selectAll(".mlAnnotationText").data((e=>[e]));function g(e){const t=n.domain()[0],a=n.domain()[1],i=qe()(e),s=Math.max(n(t),n(i));return Math.min(n(a)-32,s)}h.enter().append("rect").classed("mlAnnotationTextRect",!0).attr("width",24).attr("height",20).on("mouseover",u).on("mouseout",o).on("click",p),f.enter().append("text").classed("mlAnnotationText",!0).on("mouseover",u).on("mouseout",o).on("click",p),f.attr("x",(e=>g(e.timestamp)+17)).attr("y",(e=>{const t=void 0!==e.key?d[e.key]:1;return a+-7+26+28*t})).text((e=>e.key)),h.attr("x",(e=>g(e.timestamp)+5)).attr("y",(e=>{const t=void 0!==e.key?d[e.key]:1;return a+-7+12+28*t})),h.exit().remove(),f.exit().remove(),m.classed("mlAnnotationHidden",!s),m.exit().remove()}(f,u,am,im,this.focusXScale,r,b,h,this.props.annotationUpdatesService),f.select(".mlAnnotationBrush").style("display",r?null:"none"),f.select(".values-line").attr("d",this.focusValuesLine(p)),Object($p.g)(p,f,this.focusValuesLine);const S=Wp.a.select(".focus-chart-markers").selectAll(".metric-value").data(p.filter((e=>(null!==e.value||"number"==typeof e.anomalyScore)&&!Object($p.o)(e))));S.exit().remove(),S.enter().append("circle").attr("r",$p.b).on("mouseover",(function(e){b(e,this)})).on("mouseout",(()=>this.props.tooltipService.hide())),S.attr("cx",(e=>this.focusXScale(e.date))).attr("cy",(e=>this.focusYScale(e.value))).attr("class",(e=>{let t="metric-value";return void 0!==e.anomalyScore&&(t+=` anomaly-marker ${Object($d.l)(e.anomalyScore).id}`),t}));const M=Wp.a.select(".focus-chart-markers").selectAll(".multi-bucket").data(p.filter((e=>null!==e.anomalyScore&&!0===Object($p.o)(e))));M.exit().remove(),M.enter().append("path").attr("d",Wp.a.svg.symbol().size($p.c).type("cross")).on("mouseover",(function(e){b(e,this)})).on("mouseout",(()=>this.props.tooltipService.hide())),M.attr("transform",(e=>`translate(${this.focusXScale(e.date)}, ${this.focusYScale(e.value)})`)).attr("class",(e=>`anomaly-marker multi-bucket ${Object($d.l)(e.anomalyScore).id}`));const k=Wp.a.select(".focus-chart-markers").selectAll(".scheduled-event-marker").data(p.filter((e=>void 0!==e.scheduledEvents)));if(k.exit().remove(),k.enter().append("rect").attr("width",2*$p.b).attr("height",$p.d).attr("class","scheduled-event-marker").attr("rx",1).attr("ry",1),k.attr("x",(e=>this.focusXScale(e.date)-$p.b)).attr("y",(e=>this.focusYScale(e.value)-3)),void 0!==i){f.select(".area.forecast").attr("d",this.focusBoundedArea(i)).classed("hidden",!o),f.select(".values-line.forecast").attr("d",this.focusValuesLine(i)).classed("hidden",!o);const e=Wp.a.select(".focus-chart-markers.forecast").selectAll(".metric-value").data(i);e.exit().remove(),e.enter().append("circle").attr("r",$p.b).on("mouseover",(function(e){b(e,this)})).on("mouseout",(()=>this.props.tooltipService.hide())),e.attr("cx",(e=>this.focusXScale(e.date))).attr("cy",(e=>this.focusYScale(e.value))).attr("class","metric-value").classed("hidden",!o)}}createZoomInfoElements(e,t){const{autoZoomDuration:a,bounds:i,modelPlotEnabled:n}=this.props,s=this.setZoomInterval.bind(this),r=i.max.unix()-i.min.unix(),o=10/this.vizWidth*r;let l=10;const c=e.append("text").attr("x",l).attr("y",17).attr("class","zoom-info-text").text(y.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.zoomLabel",{defaultMessage:"Zoom:"})),d=[{durationMs:a,label:"auto"}];if(Object(E.each)(lm,(e=>{e.duration.asSeconds()>o&&e.duration.asSeconds()<r&&d.push({durationMs:e.duration.asMilliseconds(),label:e.label})})),l+=c.node().getBBox().width+4,Object(E.each)(d,(t=>{const a=e.append("a").attr("data-ms",t.durationMs).attr("href","").append("text").attr("x",l).attr("y",17).attr("class","zoom-info-text").text(t.label);l+=a.node().getBBox().width+4})),e.append("text").attr("x",l+6).attr("y",17).attr("class","zoom-info-text zoom-aggregation-interval").text(y.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.zoomGroupAggregationIntervalLabel",{defaultMessage:"(aggregation interval: , bucket span: )"})),!1===n){const a=e.append("text").attr("x",300).attr("y",17).attr("class","zoom-info-text").text(y.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.modelBoundsNotAvailableLabel",{defaultMessage:"Model bounds are not available"}));a.attr("x",t-(a.node().getBBox().width+10))}Wp.a.select(this.rootNode).selectAll(".focus-zoom a").on("click",(function(){Wp.a.event.preventDefault(),s(Wp.a.select(this).attr("data-ms"))}))}drawContextElements(e,t,a,i){const{bounds:n,contextChartData:s,contextForecastData:r,modelPlotEnabled:o,annotationData:l}=this.props,c=s,d=this.showFocusChartTooltip.bind(this),u=this.props.tooltipService.hide.bind(this.props.tooltipService);this.contextXScale=Wp.a.time.scale().range([0,t]).domain(this.calculateContextXAxisDomain());const p=void 0===r?c:c.concat(r),m={min:Number.MAX_VALUE,max:Number.MIN_VALUE};Object(E.each)(p,(e=>{var t,a;const i=null!==(t=e.lower)&&void 0!==t?t:Number.MAX_VALUE,n=null!==(a=e.upper)&&void 0!==a?a:Number.MIN_VALUE;m.min=Math.min(e.value,i,m.min),m.max=Math.max(e.value,n,m.max)}));let b=m.min,h=m.max;const f={min:b,max:h};if(!0===o||void 0!==r&&r.length>0){const e={min:Number.MAX_VALUE,max:Number.MIN_VALUE};Object(E.each)(p,(t=>{e.min=Math.min(t.lower,e.min),e.max=Math.max(t.upper,e.max)})),b=Math.min(b,e.min),h=Math.max(h,e.max),m.max-m.min<.5*(h-b)&&(m.min>b&&(f.min=m.min-.5*(m.max-m.min)),m.max<h&&(f.max=m.max+.5*(m.max-m.min)))}this.contextYScale=Wp.a.scale.linear().range([a,3]).domain([f.min,f.max]);const g=e.append("g").attr("class","axis"),j=a+i+rm;g.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",j),g.append("line").attr("x1",t).attr("y1",0).attr("x2",t).attr("y2",j),g.append("line").attr("x1",0).attr("y1",j).attr("x2",t).attr("y2",j);const x=Object(Ss.c)();x.setInterval("auto"),x.setBounds(n);const v=x.getScaledDateFormat(),y=Wp.a.svg.axis().scale(this.contextXScale).orient("top").innerTickSize(-a).outerTickSize(0).tickPadding(0).ticks(Object($p.m)(t,v)).tickFormat((e=>qe()(e).format(v)));e.datum(c);const O=Wp.a.svg.area().x((e=>this.contextXScale(e.date))).y0((e=>this.contextYScale(Math.min(f.max,Math.max(e.lower,f.min))))).y1((e=>this.contextYScale(Math.max(f.min,Math.min(e.upper,f.max))))).defined((e=>null!==e.lower&&null!==e.upper));!0===o&&e.append("path").datum(c).attr("class","area bounds").attr("d",O);const w=Wp.a.svg.line().x((e=>this.contextXScale(e.date))).y((e=>this.contextYScale(e.value))).defined((e=>null!==e.value));e.append("path").datum(c).attr("class","values-line").attr("d",w),Object($p.g)(c,e,w,1),e.append("g").classed("mlContextAnnotations",!0);const[_,S]=this.contextXScale.range(),M=e.select(".mlContextAnnotations").selectAll("g.mlContextAnnotation").data(l,(e=>e._id||""));M.enter().append("g").classed("mlContextAnnotation",!0);const k=M.selectAll(".mlContextAnnotationRect").data((e=>[e]));k.enter().append("rect").on("mouseover",(function(e){d(e,this)})).on("mouseout",(()=>u())).classed("mlContextAnnotationRect",!0),k.attr("x",(e=>{const t=qe()(e.timestamp);let a=this.contextXScale(t);return a-$p.a<=_&&(a=0),a+$p.a>=S&&(a=S-$p.a),a})).attr("y",a+i+2).attr("height",$p.a).attr("width",(e=>{const t=Math.max(this.contextXScale(qe()(e.timestamp))+1,_),a=Math.min(S,void 0!==e.end_timestamp?this.contextXScale(qe()(e.end_timestamp))-1:t+8);return Math.max(8,a-t)})),k.exit().remove(),void 0!==r&&(e.append("path").datum(r).attr("class","area forecast").attr("d",O),e.append("path").datum(r).attr("class","values-line forecast").attr("d",w));const C=e.append("g").attr("class","swimlane").attr("transform","translate(0,"+a+")");this.drawSwimlane(C,t,i),this.mask=new Yp(e,s,o,i).x(this.contextXScale).y(this.contextYScale),e.append("g").attr("class","x axis context-chart-axis").call(y),e.selectAll(".x.context-chart-axis text").attr("dy",a-5),Object($p.h)(e.selectAll(".x.context-chart-axis"),t),this.drawContextBrush(e)}setZoomInterval(e){const{bounds:t,zoomTo:a}=this.props,i=t.min.valueOf(),n=t.max.valueOf(),s=+e;let r=a.getTime(),o=r-s;o<i&&(o=i,r=Math.min(i+s,n)),this.setContextBrushExtent(new Date(o),new Date(r))}showFocusChartTooltip(e,t){const{modelPlotEnabled:a}=this.props,i=this.fieldFormat,n="single_metric_viewer",s=[{label:Object(Ud.c)(e.date)}];if(void 0!==e.anomalyScore){const t=parseInt(e.anomalyScore);if(s.push({label:y.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.anomalyScoreLabel",{defaultMessage:"anomaly score"}),value:Object($d.g)(t),color:cm(t),seriesIdentifier:{key:n},valueAccessor:"anomaly_score"}),!0===Object($p.p)(e)&&s.push({label:y.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.multiBucketImpactLabel",{defaultMessage:"multi-bucket impact"}),value:Object($d.h)(e.multiBucketImpact),seriesIdentifier:{key:n},valueAccessor:"multi_bucket_impact"}),e.metricFunction&&s.push({label:y.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.metricActualPlotFunctionLabel",{defaultMessage:"function"}),value:e.metricFunction,seriesIdentifier:{key:n},valueAccessor:"metric_function"}),!1===a){if(void 0!==e.actual&&"rare"!==e.function)s.push({label:y.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.actualLabel",{defaultMessage:"actual"}),value:Object(su.b)(e.actual,e.function,i),seriesIdentifier:{key:n},valueAccessor:"actual"}),s.push({label:y.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.typicalLabel",{defaultMessage:"typical"}),value:Object(su.b)(e.typical,e.function,i),seriesIdentifier:{key:n},valueAccessor:"typical"});else if(s.push({label:y.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.valueLabel",{defaultMessage:"value"}),value:Object(su.b)(e.value,e.function,i),seriesIdentifier:{key:n},valueAccessor:"value"}),void 0!==e.byFieldName&&void 0!==e.numberOfCauses){const t=e.numberOfCauses,a=Object(da.d)(e.byFieldName);s.push({label:y.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.moreThanOneUnusualByFieldValuesLabel",{defaultMessage:"{numberOfCauses}{plusSign} unusual {byFieldName} values",values:{numberOfCauses:t,byFieldName:a,plusSign:t<10?"":"+"}}),seriesIdentifier:{key:n},valueAccessor:"numberOfCauses"})}}else s.push({label:y.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.modelPlotEnabled.actualLabel",{defaultMessage:"actual"}),value:Object(su.b)(e.actual,e.function,i),seriesIdentifier:{key:n},valueAccessor:"actual"}),s.push({label:y.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.modelPlotEnabled.upperBoundsLabel",{defaultMessage:"upper bounds"}),value:Object(su.b)(e.upper,e.function,i),seriesIdentifier:{key:n},valueAccessor:"upper_bounds"}),s.push({label:y.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.modelPlotEnabled.lowerBoundsLabel",{defaultMessage:"lower bounds"}),value:Object(su.b)(e.lower,e.function,i),seriesIdentifier:{key:n},valueAccessor:"lower_bounds"})}else!0===Object(E.get)(e,"isForecast",!1)?s.push({label:y.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.withoutAnomalyScore.predictionLabel",{defaultMessage:"prediction"}),value:Object(su.b)(e.value,e.function,i),seriesIdentifier:{key:n},valueAccessor:"prediction"}):s.push({label:y.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.withoutAnomalyScore.valueLabel",{defaultMessage:"value"}),value:Object(su.b)(e.value,e.function,i),seriesIdentifier:{key:n},valueAccessor:"value"}),!0===a&&(s.push({label:y.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.withoutAnomalyScoreAndModelPlotEnabled.upperBoundsLabel",{defaultMessage:"upper bounds"}),value:Object(su.b)(e.upper,e.function,i),seriesIdentifier:{key:n},valueAccessor:"upper_bounds"}),s.push({label:y.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.withoutAnomalyScoreAndModelPlotEnabled.lowerBoundsLabel",{defaultMessage:"lower bounds"}),value:Object(su.b)(e.lower,e.function,i),seriesIdentifier:{key:n},valueAccessor:"lower_bounds"}));if(void 0!==e.scheduledEvents&&e.scheduledEvents.forEach(((t,a)=>{s.push({label:y.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.scheduledEventsLabel",{defaultMessage:"scheduled event{counter}",values:{counter:e.scheduledEvents.length>1?` #${a+1}`:""}}),value:t,seriesIdentifier:{key:n},valueAccessor:`scheduled_events_${a+1}`})})),void 0!==e.annotation){s.length=0,s.push({label:e.annotation});let t=qe()(e.timestamp).format("MMMM Do YYYY, HH:mm");void 0!==e.end_timestamp&&(t+=` - ${qe()(e.end_timestamp).format("MMMM Do YYYY, HH:mm")}`),s.push({label:t,seriesIdentifier:{key:n},valueAccessor:"timespan"})}let r=2*$p.b;if("rect"===t.tagName.toLowerCase()){const e=Number(t.getAttribute("x"));e<0&&(r=Math.abs(e))}this.props.tooltipService.show(s,t,{x:r,y:0})}highlightFocusChartAnomaly(e){const{focusChartData:t,focusAggregationInterval:a}=this.props,i=this.focusXScale,n=this.focusYScale,s=this.showFocusChartTooltip.bind(this),r=Ip(t,e.source.timestamp,a);if(void 0!==r){const e=Wp.a.select(".focus-chart-markers").selectAll(".focus-chart-highlighted-marker").data([r]);!0===Object($p.o)(r)?e.enter().append("path").attr("d",Wp.a.svg.symbol().size($p.c).type("cross")).attr("transform",(e=>`translate(${i(e.date)}, ${n(e.value)})`)).attr("class",(e=>`anomaly-marker multi-bucket ${Object($d.l)(e.anomalyScore).id} highlighted`)):e.enter().append("circle").attr("r",$p.b).attr("cx",(e=>i(e.date))).attr("cy",(e=>n(e.value))).attr("class",(e=>`anomaly-marker metric-value ${Object($d.l)(e.anomalyScore).id} highlighted`));const t=Wp.a.select(this.rootNode).selectAll(".focus-chart-markers .anomaly-marker.highlighted");t.length&&s(r,t[0][0])}}unhighlightFocusChartAnomaly(){Wp.a.select(".focus-chart-markers").selectAll(".anomaly-marker.highlighted").remove(),this.props.tooltipService.hide()}shouldComponentUpdate(){return!0}setRef(e){this.rootNode=e}render(){return Object(N.jsx)("div",{className:"ml-timeseries-chart-react",ref:this.setRef.bind(this)})}}const um=e=>{const t=Object(n.useContext)(K.a),a=q()(t.isAnnotationInitialized$());return void 0===a?null:Object(N.jsx)(timeseries_chart_TimeseriesChartIntl,v()({annotation:a},e,{annotationUpdatesService:t}))},pm=({bounds:e,detectorIndex:t,renderFocusChartOnly:a,selectedJob:i,selectedEntities:s,showAnnotations:r,showForecast:o,showModelBounds:l,chartProps:c,lastRefresh:d,contextAggregationInterval:u})=>{const{toasts:p}=Object(f.f)(),{services:{mlServices:{mlApiServices:m}}}=Object(f.b)(),b=Object(n.useContext)(K.a),[h,g]=Object(n.useState)([]),j=Object(n.useCallback)((e=>{p.addDanger({title:y.i18n.translate("xpack.ml.timeSeriesExplorer.mlSingleMetricViewerChart.annotationsErrorTitle",{defaultMessage:"An error occurred fetching annotations"}),...e?{text:Object(ze.b)(e)}:{}})}),[]);return Object(n.useEffect)((()=>{let a=!1;const n=Pp(t,s,i.job_id),r=Array.isArray(n)?n.filter((e=>null!==e.fieldValue)):void 0,o=Object(Ss.b)(e,u,!1);return(async e=>{try{const i=await m.annotations.getAnnotations({jobIds:[e],earliestMs:o.min.valueOf(),latestMs:o.max.valueOf(),maxAnnotations:S.a,detectorIndex:t,entities:r});a||Array.isArray(i.annotations[e])&&g(i.annotations[e])}catch(e){j(e)}})(i.job_id),()=>{a=!0}}),[i.job_id,t,d,s,e,u]),Object(N.jsx)("div",{className:"ml-timeseries-chart","data-test-subj":"mlSingleMetricViewerChart"},Object(N.jsx)(qp.a,null,(n=>Object(N.jsx)(um,v()({},c,{annotationUpdatesService:b,annotationData:h,bounds:e,detectorIndex:t,renderFocusChartOnly:a,selectedJob:i,showAnnotations:r,showForecast:o,showModelBounds:l,tooltipService:n})))))},mm=({errorMsg:e})=>Object(N.jsx)(te.EuiEmptyPrompt,{iconType:"alert",title:Object(N.jsx)("h2",null,e)}),bm=y.i18n.translate("xpack.ml.timeSeriesExplorer.allPartitionValuesLabel",{defaultMessage:"all"});class timeseriesexplorer_TimeSeriesExplorer extends s.a.Component{constructor(...e){super(...e),Ce()(this,"state",{chartDetails:void 0,contextAggregationInterval:void 0,contextChartData:void 0,contextForecastData:void 0,dataNotChartable:!1,entitiesLoading:!1,entityValues:{},focusAnnotationData:[],focusAggregationInterval:{},focusChartData:void 0,focusForecastData:void 0,fullRefresh:!0,hasResults:!1,loadCounter:0,loading:!1,modelPlotEnabled:!1,showAnnotations:!0,showAnnotationsCheckbox:!0,showForecast:!0,showForecastCheckbox:!1,showModelBounds:!0,showModelBoundsCheckbox:!1,svgWidth:0,tableData:void 0,zoomFrom:void 0,zoomTo:void 0,zoomFromFocusLoaded:void 0,zoomToFocusLoaded:void 0,chartDataError:void 0}),Ce()(this,"subscriptions",new Se.Subscription),Ce()(this,"resizeRef",Object(n.createRef)()),Ce()(this,"resizeChecker",void 0),Ce()(this,"resizeHandler",(()=>{this.setState({svgWidth:null!==this.resizeRef.current?this.resizeRef.current.offsetWidth-34:0})})),Ce()(this,"unmounted",!1),Ce()(this,"contextChart$",new Se.Subject),Ce()(this,"getFieldNamesWithEmptyValues",(()=>this.getControlsForDetector().filter((({fieldValue:e})=>null===e)).map((({fieldName:e})=>e)))),Ce()(this,"arePartitioningFieldsProvided",(()=>0===this.getFieldNamesWithEmptyValues().length)),Ce()(this,"toggleShowAnnotationsHandler",(()=>{this.setState((e=>({showAnnotations:!e.showAnnotations})))})),Ce()(this,"toggleShowForecastHandler",(()=>{this.setState((e=>({showForecast:!e.showForecast})))})),Ce()(this,"toggleShowModelBoundsHandler",(()=>{this.setState({showModelBounds:!this.state.showModelBounds})})),Ce()(this,"setFunctionDescription",(e=>{this.props.appStateHandler(wp,e)})),Ce()(this,"previousChartProps",{}),Ce()(this,"previousShowAnnotations",void 0),Ce()(this,"previousShowForecast",void 0),Ce()(this,"previousShowModelBounds",void 0),Ce()(this,"tableFilter",((e,t,a)=>{const i=this.getControlsForDetector(),n=i.find((({fieldName:t})=>t===e));if(void 0===n)return;const{appStateHandler:s}=this.props;let r="";if("+"===a&&n.fieldValue!==t)r=t;else{if("-"!==a||n.fieldValue!==t)return;r=null}const o={...i.reduce(((e,t)=>(e[t.fieldName]=t.fieldValue,e)),{}),[n.fieldName]:r};s(vp,o)})),Ce()(this,"contextChartSelectedInitCallDone",!1),Ce()(this,"contextChartSelected",(e=>{const t={from:e.from.toISOString(),to:e.to.toISOString()};Object(E.isEqual)(this.props.zoom,t)&&void 0!==this.state.focusChartData&&this.props.previousRefresh===this.props.lastRefresh||(this.contextChart$.next(e),this.props.appStateHandler(Op,t))})),Ce()(this,"loadAnomaliesTableData",((e,t)=>{const{dateFormatTz:a,selectedDetectorIndex:i,selectedJobId:n,tableInterval:s,tableSeverity:r,functionDescription:o}=this.props,l=re.a.getJob(n),c=this.getControlsForDetector();return ge.ml.results.getAnomaliesTableData([l.job_id],this.getCriteriaFields(i,c),[],s,r,e,t,a,S.b,void 0,void 0,o).pipe(Object(Me.map)((e=>{const t=e.anomalies,a=re.a.detectorsByJob;return t.forEach((e=>{const t=e.jobId,i=Object(E.get)(a,[t,e.detectorIndex]);e.detector=Object(E.get)(i,["detector_description"],e.source.function_description);const n=i.custom_rules;void 0!==n&&(e.rulesLength=n.length),Object(E.has)(re.a.customUrlsByJob,t)&&(e.customUrls=re.a.customUrlsByJob[t])})),{tableData:{anomalies:t,interval:e.interval,examplesByJobId:e.examplesByJobId,showViewSeriesLink:!1}}})))})),Ce()(this,"setForecastId",(e=>{this.props.appStateHandler(yp,e)})),Ce()(this,"displayErrorToastMessages",((e,t)=>{this.props.toastNotificationService&&this.props.toastNotificationService.displayErrorToast(e,t,2e3),this.setState({loading:!1,chartDataError:t})})),Ce()(this,"loadSingleMetricData",((e=!0)=>{const{autoZoomDuration:t,bounds:a,selectedDetectorIndex:i,selectedForecastId:n,selectedJobId:s,zoom:r,functionDescription:o}=this.props,{loadCounter:l}=this.state,c=re.a.getJob(s);if(void 0===c)return;if(Jp(c,i)&&void 0===o)return;const d=$d.c.toES(o);this.contextChartSelectedInitCallDone=!1;const u=this.getControlsForDetector();this.setState({fullRefresh:e,loadCounter:l+1,loading:!0,chartDataError:void 0,...e?{chartDetails:void 0,contextChartData:void 0,contextForecastData:void 0,focusChartData:void 0,focusForecastData:void 0,modelPlotEnabled:Object(Te.l)(c,i)&&Object(Te.m)(c,i,u),hasResults:!1,dataNotChartable:!1}:{}},(()=>{const{loadCounter:e,modelPlotEnabled:o}=this.state,l=kp(re.a.jobs),c=re.a.getJob(s),p=i;let m=3;const b={},h=i=>{if(m--,0===m&&i===e){if(b.hasResults=Array.isArray(b.contextChartData)&&b.contextChartData.length>0||Array.isArray(b.contextForecastData)&&b.contextForecastData.length>0,b.loading=!1,b.contextChartData.length&&!0===this.arePartitioningFieldsProvided()){let e=function(e,t,a){if(void 0!==e){const i=zd()(e.from,"YYYY-MM-DDTHH:mm:ss.SSSZ",!0),n=zd()(e.to,"YYYY-MM-DDTHH:mm:ss.SSSZ",!0),s=Object(Ss.b)(a,t,!0),r=s.min,o=s.max;if(i.isValid()&&n.isValid&&n.isAfter(i)&&i.isBetween(r,o,null,"[]")&&n.isBetween(r,o,null,"[]"))return[i.toDate(),n.toDate()]}}(r,b.contextAggregationInterval,a);void 0!==e&&this.previousSelectedForecastId===this.props.selectedForecastId||(e=function(e,t,a,i){const n=void 0!==i&&i.length>0,s=!1===n?a:a.concat(i),r=s[0].date,o=s[s.length-1].date;let l,c;if(!0===n){const t=i[0].date,a=i[i.length-1].date;c=Math.min(t.getTime()+e/2,a.getTime()),l=Math.max(c-e,r.getTime())}else c=o.getTime()+t.asMilliseconds(),l=Math.max(r.getTime(),c-e);return[new Date(l),new Date(c)]}(t,b.contextAggregationInterval,b.contextChartData,b.contextForecastData),this.previousSelectedForecastId=this.props.selectedForecastId),this.contextChartSelected({from:e[0],to:e[1]})}this.setState(b)}},f=u.filter((e=>null!==e.fieldValue));if(!1===o&&!1===Object(Te.n)(c,p)&&f.length>0)return b.hasResults=!1,b.loading=!1,b.dataNotChartable=!0,void this.setState(b);b.contextAggregationInterval=Dp(a,_p,l,c);const g=Object(Ss.b)(a,b.contextAggregationInterval,!1),j=e;if(Mp.getMetricData(c,p,f,g.min.valueOf(),g.max.valueOf(),b.contextAggregationInterval.asMilliseconds(),d).toPromise().then((e=>{const t=Cp(e.results,o);b.contextChartData=t,h(j)})).catch((e=>{const t=y.i18n.translate("xpack.ml.timeSeriesExplorer.metricDataErrorMessage",{defaultMessage:"Error getting metric data"});this.displayErrorToastMessages(e,t)})),js.mlResultsService.getRecordMaxScoreByTime(c.job_id,this.getCriteriaFields(p,u),g.min.valueOf(),g.max.valueOf(),b.contextAggregationInterval.asMilliseconds(),d).then((e=>{const t=function(e){const t=[];return Object(E.each)(e,((e,a)=>{t.push({date:new Date(+a),score:e.score})})),t}(e.results);b.swimlaneData=t,h(j)})).catch((e=>{const t=y.i18n.translate("xpack.ml.timeSeriesExplorer.bucketAnomalyScoresErrorMessage",{defaultMessage:"Error getting bucket anomaly scores"});this.displayErrorToastMessages(e,t)})),Mp.getChartDetails(c,p,u,g.min.valueOf(),g.max.valueOf()).then((e=>{b.chartDetails=e.results,h(j)})).catch((e=>{this.displayErrorToastMessages(e,y.i18n.translate("xpack.ml.timeSeriesExplorer.entityCountsErrorMessage",{defaultMessage:"Error getting entity counts"}))})),void 0!==n){let e;m++;const t=c.analysis_config.detectors[p],a=Object(Te.q)(t.function);!1!==o||"sum"!==a&&"count"!==a||(e={avg:"sum",max:"sum",min:"sum"}),Ku.a.getForecastData(c,p,n,f,g.min.valueOf(),g.max.valueOf(),b.contextAggregationInterval.asMilliseconds(),e).toPromise().then((e=>{b.contextForecastData=Tp(e.results),h(j)})).catch((e=>{this.displayErrorToastMessages(e,y.i18n.translate("xpack.ml.timeSeriesExplorer.forecastDataErrorMessage",{defaultMessage:"Error loading forecast data for forecast ID {forecastId}",values:{forecastId:n}}))}))}}))})),Ce()(this,"getControlsForDetector",(()=>{const{selectedDetectorIndex:e,selectedEntities:t,selectedJobId:a}=this.props;return Pp(e,t,a)}))}getFocusAggregationInterval(e){const{selectedJobId:t}=this.props,a=kp(re.a.jobs),i=re.a.getJob(t);return Dp({min:zd()(e.from),max:zd()(e.to)},_p,a,i)}getFocusData(e){const{selectedJobId:t,selectedForecastId:a,selectedDetectorIndex:i,functionDescription:n}=this.props,{modelPlotEnabled:s}=this.state,r=re.a.getJob(t);if(Jp(r,i)&&void 0===n)return;const o=this.getControlsForDetector(),l={min:zd()(e.from),max:zd()(e.to)},c=this.getFocusAggregationInterval(e),d=Object(Ss.b)(l,c,!1);return Ap(this.getCriteriaFields(i,o),i,c,a,s,o.filter((e=>null!==e.fieldValue)),d,r,n)}getCriteriaFields(e,t){return[{fieldName:"detector_index",fieldValue:e},...t.filter((e=>null!==e.fieldValue))]}loadForJobId(e){const{appStateHandler:t,selectedDetectorIndex:a}=this.props,i=re.a.getJob(e);if(void 0===i)return;const n=Bp(i);let s=void 0!==a?a:n[0].index;if(void 0===Object(E.find)(n,{index:s})){const e=y.i18n.translate("xpack.ml.timeSeriesExplorer.requestedDetectorIndexNotValidWarningMessage",{defaultMessage:"Requested detector index {detectorIndex} is not valid for job {jobId}",values:{detectorIndex:s,jobId:i.job_id}});this.props.toastNotificationService&&this.props.toastNotificationService.displayWarningToast(e),s=n[0].index}s!==a&&t(xp,s),nu.a.populateFormats([e]).catch((e=>{console.log("Error populating field formats:",e)}))}componentDidMount(){const{invalidTimeRangeError:e}=this.props;e&&this.props.toastNotificationService&&this.props.toastNotificationService.displayWarningToast(y.i18n.translate("xpack.ml.timeSeriesExplorer.invalidTimeRangeInUrlCallout",{defaultMessage:"The time filter was changed to the full range for this job due to an invalid default time filter. Check the advanced settings for {field}.",values:{field:Rp.a}})),this.resizeChecker=new l.ResizeChecker(this.resizeRef.current),this.resizeChecker.on("resize",(()=>{this.resizeHandler()})),this.resizeHandler(),this.subscriptions.add(this.contextChart$.pipe(Object(Me.tap)((e=>{this.setState({zoomFrom:e.from,zoomTo:e.to})})),Object(Me.debounceTime)(500),Object(Me.tap)((e=>{const{contextChartData:t,contextForecastData:a,focusChartData:i,zoomFromFocusLoaded:n,zoomToFocusLoaded:s}=this.state;(void 0!==t&&0!==t.length||void 0!==a&&0!==a.length)&&(!1===this.contextChartSelectedInitCallDone&&void 0===i||n.getTime()!==e.from.getTime()||s.getTime()!==e.to.getTime())&&(this.contextChartSelectedInitCallDone=!0,this.setState({loading:!0,fullRefresh:!1}))})),Object(Me.switchMap)((e=>{const{selectedJobId:t}=this.props,a=kp(re.a.jobs),i=re.a.getJob(t),n={min:zd()(e.from),max:zd()(e.to)},s=Dp(n,_p,a,i),r=Object(Ss.b)(n,s,!1);return Object(Se.forkJoin)([this.getFocusData(e),this.loadAnomaliesTableData(r.min.valueOf(),r.max.valueOf())])})),Object(Me.withLatestFrom)(this.contextChart$)).subscribe((([[e,t],a])=>{const{modelPlotEnabled:i}=this.state;this.setState({focusAggregationInterval:this.getFocusAggregationInterval({from:a.from,to:a.to}),loading:!1,showModelBoundsCheckbox:i&&e.focusChartData.length>0,zoomFromFocusLoaded:a.from,zoomToFocusLoaded:a.to,...e,...t})}))),this.componentDidUpdate()}componentDidUpdate(e){if(void 0!==e&&e.selectedJobId===this.props.selectedJobId||(this.contextChartSelectedInitCallDone=!1,this.setState({fullRefresh:!1,loading:!0},(()=>{this.loadForJobId(this.props.selectedJobId)}))),void 0!==e&&e.selectedForecastId===this.props.selectedForecastId||void 0!==this.props.selectedForecastId&&(this.setState({showForecast:!0}),void 0!==e&&(this.previousSelectedForecastId=e.selectedForecastId)),void 0===e||!Object(E.isEqual)(e.bounds,this.props.bounds)||!Object(E.isEqual)(e.lastRefresh,this.props.lastRefresh)&&0!==e.lastRefresh||!Object(E.isEqual)(e.selectedDetectorIndex,this.props.selectedDetectorIndex)||!Object(E.isEqual)(e.selectedEntities,this.props.selectedEntities)||e.selectedForecastId!==this.props.selectedForecastId||e.selectedJobId!==this.props.selectedJobId||e.functionDescription!==this.props.functionDescription){const t=void 0===e||!Object(E.isEqual)(e.bounds,this.props.bounds)||!Object(E.isEqual)(e.selectedDetectorIndex,this.props.selectedDetectorIndex)||!Object(E.isEqual)(e.selectedEntities,this.props.selectedEntities)||e.selectedForecastId!==this.props.selectedForecastId||e.selectedJobId!==this.props.selectedJobId||e.functionDescription!==this.props.functionDescription;this.loadSingleMetricData(t)}if(void 0===e)return;const t=()=>{const{zoomFrom:e,zoomTo:t}=this.state;void 0!==e&&void 0!==t&&this.loadAnomaliesTableData(e.getTime(),t.getTime()).subscribe((e=>this.setState(e)))};e.tableInterval===this.props.tableInterval&&e.tableSeverity===this.props.tableSeverity||t()}componentWillUnmount(){this.subscriptions.unsubscribe(),this.resizeChecker.destroy(),this.unmounted=!0}render(){const{autoZoomDuration:e,bounds:t,dateFormatTz:a,lastRefresh:i,selectedDetectorIndex:r,selectedJobId:o}=this.props,{chartDetails:l,contextAggregationInterval:c,contextChartData:d,contextForecastData:u,dataNotChartable:p,focusAggregationInterval:m,focusAnnotationError:b,focusAnnotationData:h,focusChartData:f,focusForecastData:g,fullRefresh:j,hasResults:x,loading:v,modelPlotEnabled:O,showAnnotations:w,showAnnotationsCheckbox:_,showForecast:S,showForecastCheckbox:M,showModelBounds:k,showModelBoundsCheckbox:C,svgWidth:T,swimlaneData:F,tableData:I,zoomFrom:D,zoomTo:A,zoomFromFocusLoaded:L,zoomToFocusLoaded:R,chartDataError:P}=this.state,z={modelPlotEnabled:O,contextChartData:d,contextChartSelected:this.contextChartSelected,contextForecastData:u,contextAggregationInterval:c,swimlaneData:F,focusAnnotationData:h,focusChartData:f,focusForecastData:g,focusAggregationInterval:m,svgWidth:T,zoomFrom:D,zoomTo:A,zoomFromFocusLoaded:L,zoomToFocusLoaded:R,autoZoomDuration:e},B=kp(re.a.jobs);if(void 0===r||void 0===re.a.getJob(o))return Object(N.jsx)(gp,{dateFormatTz:a,resizeRef:this.resizeRef});const J=re.a.getJob(o),V=this.getControlsForDetector(),U=this.getFieldNamesWithEmptyValues(),G=this.arePartitioningFieldsProvided(),q=Bp(J);let H=!0;return Object(E.isEqual)(this.previousChartProps.focusForecastData,z.focusForecastData)&&Object(E.isEqual)(this.previousChartProps.focusChartData,z.focusChartData)&&Object(E.isEqual)(this.previousChartProps.focusAnnotationData,z.focusAnnotationData)&&this.previousShowForecast===S&&this.previousShowModelBounds===k&&this.props.previousRefresh===i&&(H=!1),this.previousChartProps=z,this.previousShowForecast=S,this.previousShowModelBounds=k,Object(N.jsx)(gp,{dateFormatTz:a,resizeRef:this.resizeRef},U.length>0&&Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(te.EuiCallOut,{title:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.singleMetricRequiredMessage",defaultMessage:"To view a single metric, select {missingValuesCount, plural, one {a value for {fieldName1}} other {values for {fieldName1} and {fieldName2}}}.",values:{missingValuesCount:U.length,fieldName1:U[0],fieldName2:U[1]}}),iconType:"help",size:"s"}),Object(N.jsx)(te.EuiSpacer,{size:"m"})),Object(N.jsx)(Gp,{selectedJobId:o,appStateHandler:this.props.appStateHandler,selectedDetectorIndex:r,selectedEntities:this.props.selectedEntities,bounds:t,functionDescription:this.props.functionDescription,setFunctionDescription:this.setFunctionDescription},G&&Object(N.jsx)(te.EuiFlexItem,{style:{textAlign:"right"}},Object(N.jsx)(te.EuiFormRow,{hasEmptyLabelSpace:!0,style:{maxWidth:"100%"}},Object(N.jsx)(np,{job:J,detectorIndex:r,entities:V,setForecastId:this.setForecastId,className:"forecast-controls"})))),Object(N.jsx)(te.EuiSpacer,{size:"m"}),j&&!0===v&&Object(N.jsx)(sp.a,{label:y.i18n.translate("xpack.ml.timeSeriesExplorer.loadingLabel",{defaultMessage:"Loading"})}),!1===v&&void 0!==P&&Object(N.jsx)(mm,{errorMsg:P}),G&&B.length>0&&(!1===j||!1===v)&&!1===x&&void 0===P&&Object(N.jsx)(mp,{dataNotChartable:p,entities:V}),G&&B.length>0&&(!1===j||!1===v)&&!0===x&&Object(N.jsx)("div",null,Object(N.jsx)("div",{className:"results-container"},Object(N.jsx)(te.EuiFlexGroup,{gutterSize:"xs",alignItems:"center"},Object(N.jsx)(te.EuiTitle,{className:"panel-title"},Object(N.jsx)("h2",{style:{display:"inline"}},Object(N.jsx)("span",null,y.i18n.translate("xpack.ml.timeSeriesExplorer.singleTimeSeriesAnalysisTitle",{defaultMessage:"Single time series analysis of {functionLabel}",values:{functionLabel:l.functionLabel}}))," ",1===l.entityData.count&&Object(N.jsx)("span",{className:"entity-count-text"},l.entityData.entities.length>0&&"(",l.entityData.entities.map((e=>`${e.fieldName}: ${e.fieldValue}`)).join(", "),l.entityData.entities.length>0&&")"),1!==l.entityData.count&&Object(N.jsx)("span",{className:"entity-count-text"},l.entityData.entities.map(((e,t)=>Object(N.jsx)(n.Fragment,{key:e.fieldName},y.i18n.translate("xpack.ml.timeSeriesExplorer.countDataInChartDetailsDescription",{defaultMessage:"{openBrace}{cardinalityValue} distinct {fieldName} {cardinality, plural, one {} other { values}}{closeBrace}",values:{openBrace:0===t?"(":"",closeBrace:t===l.entityData.entities.length-1?")":"",cardinalityValue:0===e.cardinality?bm:e.cardinality,cardinality:e.cardinality,fieldName:e.fieldName}}),t!==l.entityData.entities.length-1?", ":"")))))),Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(Bd,null))),Object(N.jsx)(te.EuiFlexGroup,{style:{float:"right"}},C&&Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiCheckbox,{id:"toggleModelBoundsCheckbox",label:y.i18n.translate("xpack.ml.timeSeriesExplorer.showModelBoundsLabel",{defaultMessage:"show model bounds"}),checked:k,onChange:this.toggleShowModelBoundsHandler})),_&&Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiCheckbox,{id:"toggleAnnotationsCheckbox",label:y.i18n.translate("xpack.ml.timeSeriesExplorer.annotationsLabel",{defaultMessage:"annotations"}),checked:w,onChange:this.toggleShowAnnotationsHandler})),M&&Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiCheckbox,{id:"toggleShowForecastCheckbox",label:Object(N.jsx)("span",{"data-test-subj":"mlForecastCheckbox"},y.i18n.translate("xpack.ml.timeSeriesExplorer.showForecastLabel",{defaultMessage:"show forecast"})),checked:S,onChange:this.toggleShowForecastHandler}))),Object(N.jsx)(pm,{chartProps:z,contextAggregationInterval:c,bounds:t,detectorIndex:r,renderFocusChartOnly:H,selectedJob:J,selectedEntities:this.props.selectedEntities,showAnnotations:w,showForecast:S,showModelBounds:k,lastRefresh:i}),void 0!==b&&Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(te.EuiTitle,{className:"panel-title","data-test-subj":"mlAnomalyExplorerAnnotations error"},Object(N.jsx)("h2",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.annotationsErrorTitle",defaultMessage:"Annotations"}))),Object(N.jsx)(te.EuiPanel,null,Object(N.jsx)(te.EuiCallOut,{title:y.i18n.translate("xpack.ml.timeSeriesExplorer.annotationsErrorCallOutTitle",{defaultMessage:"An error occurred loading annotations:"}),color:"danger",iconType:"alert"},Object(N.jsx)("p",null,b))),Object(N.jsx)(te.EuiSpacer,{size:"m"})),h&&h.length>0&&Object(N.jsx)(te.EuiAccordion,{id:"mlAnnotationsAccordion",buttonContent:Object(N.jsx)(te.EuiTitle,{className:"panel-title"},Object(N.jsx)("h2",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.annotationsTitle",defaultMessage:"Annotations {badge}",values:{badge:Object(N.jsx)(te.EuiBadge,{color:"hollow"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.explorer.annotationsTitleTotalCount",defaultMessage:"Total: {count}",values:{count:h.length}}))}}))),"data-test-subj":"mlAnomalyExplorerAnnotations loaded"},Object(N.jsx)(Vd.a,{chartDetails:l,detectorIndex:r,detectors:q,jobIds:[this.props.selectedJobId],annotations:h,isSingleMetricViewerLinkVisible:!1,isNumberBadgeVisible:!0}),Object(N.jsx)(te.EuiSpacer,{size:"l"})),Object(N.jsx)(Jd.a,{chartDetails:l,detectorIndex:r,detectors:q}),Object(N.jsx)(te.EuiTitle,{className:"panel-title"},Object(N.jsx)("h2",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.anomaliesTitle",defaultMessage:"Anomalies"}))),Object(N.jsx)(te.EuiFlexGroup,{direction:"row",gutterSize:"l",responsive:!0},Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(pp.a,null)),Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(dp,null))),Object(N.jsx)(te.EuiSpacer,{size:"m"}))),G&&B.length>0&&!0===x&&Object(N.jsx)(Ru,{bounds:t,tableData:I,filter:this.tableFilter}))}}const hm=()=>{const e=Object(f.d)(),t=Object(f.e)();return Object(N.jsx)(te.EuiEmptyPrompt,{"data-test-subj":"mlNoSingleMetricJobsFound",iconType:"alert",title:Object(N.jsx)("h2",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.noSingleMetricJobsFoundLabel",defaultMessage:"No single metric jobs found"})),actions:Object(N.jsx)(te.EuiButton,{color:"primary",fill:!0,onClick:async()=>{if(!e)return;const a=await e.getUrl({page:T.b.ANOMALY_DETECTION_JOBS_MANAGE});await t(a,!0)}},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.createNewSingleMetricJobLinkText",defaultMessage:"Create new single metric job"}))})};var fm=a(213);const gm=(e,t)=>({path:"/timeseriesexplorer",render:(e,t)=>Object(N.jsx)(jm,v()({},e,{deps:t})),breadcrumbs:[P("ML_BREADCRUMB",e,t),P("ANOMALY_DETECTION_BREADCRUMB",e,t),{text:y.i18n.translate("xpack.ml.anomalyDetection.singleMetricViewerLabel",{defaultMessage:"Single Metric Viewer"}),href:""}]}),jm=({deps:e})=>{const{context:t,results:a}=F(void 0,void 0,e.config,{...Y(e),jobs:re.a.loadJobsWrapper,jobsWithTimeRange:()=>ge.ml.jobs.jobsWithTimerange(Object(Zo.e)())}),i=Object(n.useMemo)((()=>new Q.a),[]);return Object(N.jsx)(Vb,{context:t},Object(N.jsx)(K.a.Provider,{value:i},Object(N.jsx)(xm,{config:e.config,jobsWithTimeRange:a.jobsWithTimeRange.jobs})))},xm=({config:e,jobsWithTimeRange:t})=>{var a,i,s,r,o,l,c,d,u,p,m,b,h;const{toasts:g}=Object(f.f)(),x=Object(Et.c)(),[v,O]=Object(j.b)(T.b.SINGLE_METRIC_VIEWER),[w,_]=Object(j.c)("_g"),[S,M]=Object(n.useState)(0),k=Pd()(S),[C,F]=Object(n.useState)(),I=Object(f.g)({timeRangeSelector:!0,autoRefreshSelector:!0}),[D,A]=Object(n.useState)(!1),L=Object(fm.a)();Object(n.useEffect)((()=>{if(void 0!==L&&L.lastRefresh!==S&&(M(null==L?void 0:L.lastRefresh),void 0!==L.timeRange)){const{start:e,end:t}=L.timeRange;_("time",{from:e,to:t,..."now"===e||"now"===t?{ts:Date.now()}:{}})}}),[null==L?void 0:L.lastRefresh,S,_]);const[R,P]=Object(n.useState)(void 0);Object(n.useEffect)((()=>{if(void 0!==(null==w?void 0:w.time)){"invalid"===w.time.mode&&A(!0),I.setTime({from:w.time.from,to:w.time.to});const e=I.getBounds();void 0!==(null==e?void 0:e.min)&&void 0!==(null==e?void 0:e.max)&&P(I.getBounds())}}),[null==w||null===(a=w.time)||void 0===a?void 0:a.from,null==w||null===(i=w.time)||void 0===i?void 0:i.to,null==w||null===(s=w.time)||void 0===s?void 0:s.ts]);const z=null==w||null===(r=w.ml)||void 0===r?void 0:r.jobIds;Array.isArray(z)&&z.sort();const B=Pd()(z),J=!Object(E.isEqual)(B,z),V=J?0:null!==(o=null==v||null===(l=v.mlTimeSeriesExplorer)||void 0===l?void 0:l.detectorIndex)&&void 0!==o?o:0,U=J||null==v||null===(c=v.mlTimeSeriesExplorer)||void 0===c?void 0:c.entities,G=J||null==v||null===(d=v.mlTimeSeriesExplorer)||void 0===d?void 0:d.forecastId,q=J||null==v||null===(u=v.mlTimeSeriesExplorer)||void 0===u?void 0:u.functionDescription,H=J||null==v||null===(p=v.mlTimeSeriesExplorer)||void 0===p?void 0:p.zoom,W=void 0!==C?re.a.getJob(C):void 0,$=kp(re.a.jobs);let Y;void 0!==C&&void 0!==W&&(Y=function(e,t){const a=Object(E.find)(e,{id:t.job_id}).bucketSpanSeconds;let i=1e3*a*499;const n=Math.floor(550),s=Object(Ss.c)();s.setInterval("auto"),s.setBarTarget(Math.floor(_p)),s.setMaxBars(n);const r=(new Date).getTime(),o=zd()(r),l=zd()(r-i);s.setBounds({min:l,max:o});const c=s.getIntervalToNearestMultiple(a).asSeconds();return c!==a&&(i*=a/c),i}($,W));const X=Object(n.useCallback)(((e,t)=>{var a;const i=void 0===(null==v||null===(a=v.mlTimeSeriesExplorer)||void 0===a?void 0:a.zoom),n=void 0!==(null==v?void 0:v.mlTimeSeriesExplorer)?{...v.mlTimeSeriesExplorer}:{};switch(e){case jp:delete n.detectorIndex,delete n.entities,delete n.forecastId,delete n.zoom,delete n.functionDescription;break;case xp:n.detectorIndex=t,delete n.functionDescription;break;case vp:n.entities=t,delete n.functionDescription;break;case yp:n.forecastId=t,delete n.zoom;break;case Op:n.zoom=t;break;case Ep:delete n.zoom;break;case wp:n.functionDescription=t}O({mlTimeSeriesExplorer:n},i)}),[JSON.stringify(null==v?void 0:v.mlTimeSeriesExplorer),O]);Object(n.useEffect)((()=>{void 0!==z&&void 0!==B&&(M(Date.now()),X(jp));const e=function(e,t,a,i){const n=kp(re.a.jobs),s=n.map((e=>e.id)),r=Object(E.difference)(t,s),o=Object(E.without)(t,...r);if(1===r.length){const t=r[0],a=e.find((e=>e.id===t));if(void 0!==a&&void 0!==a.isNotSingleMetricViewerJobMessage){const e=y.i18n.translate("xpack.ml.timeSeriesExplorer.canNotViewRequestedJobsWarningWithReasonMessage",{defaultMessage:"You can't view {selectedJobId} in this dashboard because {reason}.",values:{selectedJobId:t,reason:a.isNotSingleMetricViewerJobMessage}});i.addWarning({title:e,"data-test-subj":"mlTimeSeriesExplorerDisabledJobReasonWarningToast"})}}if(r.length>1){let e=y.i18n.translate("xpack.ml.timeSeriesExplorer.canNotViewRequestedJobsWarningMessage",{defaultMessage:"You can't view requested {invalidIdsCount, plural, one {job} other {jobs}} {invalidIds} in this dashboard",values:{invalidIdsCount:r.length,invalidIds:r.join(", ")}});0===o.length&&s.length>0&&(e+=y.i18n.translate("xpack.ml.timeSeriesExplorer.autoSelectingFirstJobText",{defaultMessage:", auto selecting first job"})),i.addWarning(e)}if(o.length>1)return i.addWarning(y.i18n.translate("xpack.ml.timeSeriesExplorer.youCanViewOneJobAtTimeWarningMessage",{defaultMessage:"You can only view one job at a time in this dashboard"})),a("ml",{jobIds:[o[0]]}),!0;if(r.length>0&&o.length>0)return a("ml",{jobIds:[o[0]]}),!0;if(1===o.length)return o[0];if(0===o.length&&n.length>0){const t=[n[0].id],i=Object(Lp.b)(e,t);return a({ml:{jobIds:t},...void 0!==i?{time:i}:{}}),!0}return!1}(t,z,_,g);"string"==typeof e&&F(e)}),[JSON.stringify(z)]);const Q=null==R||null===(m=R.min)||void 0===m?void 0:m.valueOf(),K=null==R||null===(b=R.max)||void 0===b?void 0:b.valueOf(),[Z,ee]=Object(n.useState)(null==v||null===(h=v.mlTimeSeriesExplorer)||void 0===h?void 0:h.forecastId);Object(n.useEffect)((()=>{void 0!==Y&&void 0!==Q&&void 0!==K&&void 0!==W&&void 0!==G&&(Z!==G&&ee(void 0),Ku.a.getForecastDateRange(W,G).then((e=>{if(void 0===Y)return;const t=qe()(e.earliest||Q),a=qe()(e.latest||K);if(t.isBefore(qe()(Q))||a.isAfter(qe()(K))){const e=Math.min(t.valueOf(),Q),i=Math.max(a.valueOf(),K);_("time",{from:qe()(e).toISOString(),to:qe()(i).toISOString()})}ee(G)})).catch((e=>{console.error("Time series explorer - error loading time range of forecast from elasticsearch:",e)})))}),[G]);const[te]=cp(),[ae]=Object(pp.d)(),ie=e.get("dateFormat:tz"),ne="Browser"!==ie?ie:qe.a.tz.guess();if(0===$.length)return Object(N.jsx)(gp,{dateFormatTz:ne},Object(N.jsx)(hm,null));if(void 0===C||void 0===Y||void 0===R)return null;const se="string"==typeof G&&void 0===Z?void 0:H;return Object(N.jsx)(timeseriesexplorer_TimeSeriesExplorer,{toastNotificationService:x,appStateHandler:X,autoZoomDuration:Y,bounds:R,dateFormatTz:ne,lastRefresh:S,previousRefresh:k,selectedJobId:C,selectedDetectorIndex:V,selectedEntities:U,selectedForecastId:Z,tableInterval:te.val,tableSeverity:ae.val,timefilter:I,zoom:se,invalidTimeRangeError:D,functionDescription:q})},vm=({viewBySwimlaneFieldName:e,showFilterMessage:t=!1})=>!1===t?Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.explorer.noInfluencersFoundTitle",defaultMessage:"No {viewBySwimlaneFieldName} influencers found",values:{viewBySwimlaneFieldName:e}}):Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.explorer.noInfluencersFoundTitleFilterMessage",defaultMessage:"No {viewBySwimlaneFieldName} influencers found for specified filter",values:{viewBySwimlaneFieldName:e}}),ym=()=>{const e=Object(C.b)({page:T.b.ANOMALY_DETECTION_JOBS_MANAGE},{absolute:!0});return Object(N.jsx)(te.EuiEmptyPrompt,{iconType:"alert",title:Object(N.jsx)("h2",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.explorer.noJobsFoundLabel",defaultMessage:"No jobs found"})),actions:Object(N.jsx)(te.EuiButton,{color:"primary",href:e,fill:!0},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.explorer.createNewJobLinkText",defaultMessage:"Create job"})),"data-test-subj":"mlNoJobsFound"})},Om=({hasResults:e,selectedJobsRunning:t})=>{const a=!0===e,i=!1===e;return Object(N.jsx)(te.EuiEmptyPrompt,{iconType:"iInCircle",title:Object(N.jsx)("h2",null,a&&Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.explorer.noAnomaliesFoundLabel",defaultMessage:"No anomalies found"}),i&&Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.explorer.noResultsFoundLabel",defaultMessage:"No results found"})),body:Object(N.jsx)(s.a.Fragment,null,t&&i&&Object(N.jsx)("p",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.explorer.selectedJobsRunningLabel",defaultMessage:"One or more selected jobs are still running and results may not be available yet."})),!t&&Object(N.jsx)("p",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.explorer.tryWideningTimeSelectionLabel",defaultMessage:"Try widening the time selection or moving further back in time"})))})};var Em=a(52),wm=a.n(Em);const _m=({influencerFieldName:e,influencerFilter:t,valueData:a})=>{const i=Math.floor(a.maxAnomalyScore),n=Object($d.g)(a.maxAnomalyScore),r=Object($d.i)(i),o=Math.floor(a.sumAnomalyScore),l=Object($d.g)(a.sumAnomalyScore),c={width:`${0!==i?i:1}%`},d=function(e,t){return Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)("p",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.influencersList.maxAnomalyScoreTooltipDescription",defaultMessage:"Maximum anomaly score: {maxScoreLabel}",values:{maxScoreLabel:e}})),Object(N.jsx)("p",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.influencersList.totalAnomalyScoreTooltipDescription",defaultMessage:"Total anomaly score: {totalScoreLabel}",values:{totalScoreLabel:t}})))}(n,l);return Object(N.jsx)("div",{"data-test-subj":`mlInfluencerEntry field-${e}`},Object(N.jsx)("div",{className:"field-label","data-test-subj":"mlInfluencerEntryFieldLabel"},Object(N.jsx)(Kd,{entityName:e,entityValue:a.influencerFieldValue,filter:t})),Object(N.jsx)("div",{className:`progress ${r.id}`},Object(N.jsx)("div",{className:"progress-bar-holder"},Object(N.jsx)("div",{className:"progress-bar",style:c})),Object(N.jsx)("div",{className:"score-label"},Object(N.jsx)(te.EuiToolTip,{position:"right",className:"ml-influencers-list-tooltip",title:`${e}: ${a.influencerFieldValue}`,content:d},Object(N.jsx)("span",null,n)))),Object(N.jsx)("div",{className:"total-score-label"},Object(N.jsx)(te.EuiToolTip,{position:"right",className:"ml-influencers-list-tooltip",title:`${e}: ${a.influencerFieldValue}`,content:d},Object(N.jsx)("span",null,o>0?function(e,t=3){return Math.abs(e)<Math.pow(10,t)?e:wm()(e).format("0a")}(o,4):l))))},Sm=({influencerFieldName:e,influencerFilter:t,fieldValues:a})=>{const i=a.map((a=>Object(N.jsx)(_m,{key:a.influencerFieldValue,influencerFieldName:e,influencerFilter:t,valueData:a})));return Object(N.jsx)(s.a.Fragment,{key:e},Object(N.jsx)(te.EuiTitle,{size:"xs","data-test-subj":`mlInfluencerFieldName ${e}`},Object(N.jsx)("h3",null,e)),Object(N.jsx)(te.EuiSpacer,{size:"xs"}),i)},Mm=({influencers:e,influencerFilter:t})=>{if(void 0===e||0===Object.keys(e).length)return Object(N.jsx)(te.EuiFlexGroup,{justifyContent:"spaceAround",className:"ml-influencers-list"},Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiSpacer,{size:"xxl"}),Object(N.jsx)(te.EuiTitle,{size:"xs",className:"influencer-title"},Object(N.jsx)("h3",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.influencersList.noInfluencersFoundTitle",defaultMessage:"No influencers found"})))));const a=Object.keys(e).map((a=>Object(N.jsx)(Sm,{key:a,influencerFieldName:a,influencerFilter:t,fieldValues:e[a]})));return Object(N.jsx)("div",{className:"ml-influencers-list"},a)};var km=a(78);var Cm=a(237),Tm=a(152),Fm=a(186);const Im=(e,t)=>Object(E.isEqual)(e,t),Dm=(e,t)=>gs()(((e,t=null)=>function(a,...i){return e.apply(t,i)})(e,t),Im),Am=Dm(Zo.q),Lm=Dm(Zo.n),Rm=Dm(Zo.p),Pm=Dm(Zo.r),Nm=Dm(Zo.o),zm=()=>{const e=Object(f.g)(),{services:{mlServices:{mlApiServices:t},uiSettings:a}}=Object(f.b)(),i=Object(n.useMemo)((()=>{const i=Object(js.mlResultsServiceProvider)(t);return((e,t,a,i)=>{const n=Dm(t.loadOverallData,t),s=Dm(t.loadViewBySwimlane,t),r=Dm(a.getAnomalyData,a);return o=>{if(void 0===(l=o)||void 0===l.selectedJobs||null===l.selectedJobs||void 0===l.viewBySwimlaneFieldName)return Object(Se.of)({});var l;const{lastRefresh:c,influencersFilterQuery:d,noInfluencersConfigured:u,selectedCells:p,selectedJobs:m,swimlaneBucketInterval:b,swimlaneLimit:h,tableInterval:f,tableSeverity:g,viewBySwimlaneFieldName:j,swimlaneContainerWidth:x,viewByFromPage:v,viewByPerPage:y,swimLaneSeverity:O}=o,E=m.reduce(((e,t)=>({...e,[t.id]:re.a.getJob(t.id)})),{}),w=Object(Zo.i)(p,j),_=Object(Zo.j)(p,m),S=i.getBounds(),M=Object(Zo.k)(p,b.asSeconds(),S),k=Object(Zo.e)(),C=b.asSeconds();return Object(Se.forkJoin)({overallAnnotations:Am(c,m,C,S),annotationsData:Lm(c,p,m,b.asSeconds(),S),anomalyChartRecords:a.loadDataForCharts$(_,M.earliestMs,M.latestMs,w,p,d),influencers:0===w.length?Pm(c,e,_,M.earliestMs,M.latestMs,[],u,d):Promise.resolve({}),overallState:n(c,m,x,void 0,O),tableData:Nm(c,p,m,k,b.asSeconds(),S,j,f,g,d),topFieldValues:void 0!==p&&!0===p.showTopFieldValues?t.loadViewByTopFieldValuesForSelectedTime(M.earliestMs,M.latestMs,m,j,h,y,v,x,w,d):Promise.resolve([])}).pipe(Object(Me.tap)(Ym.setViewBySwimlaneLoading),Object(Me.tap)((({anomalyChartRecords:e,topFieldValues:t})=>{r(c,Ym,E,x,void 0!==p&&Array.isArray(e)?e:[],M.earliestMs,M.latestMs,i,g)})),Object(Me.mergeMap)((({overallAnnotations:t,anomalyChartRecords:a,influencers:i,overallState:n,topFieldValues:r,annotationsData:o,tableData:l})=>Object(Se.forkJoin)({filteredTopInfluencers:(w.length>0||void 0!==d)&&void 0!==a&&a.length>0?Rm(c,e,_,M.earliestMs,M.latestMs,a,w,u,d):Promise.resolve(i),viewBySwimlaneState:s(c,r,{earliest:n.earliest,latest:n.latest},m,j,km.a,y,v,x,d,void 0,O)}).pipe(Object(Me.map)((({viewBySwimlaneState:e,filteredTopInfluencers:a})=>({overallAnnotations:t,annotations:o,influencers:a,loading:!1,viewBySwimlaneDataLoading:!1,anomalyChartsDataLoading:!1,overallSwimlaneData:n,viewBySwimlaneData:e,tableData:l,swimlaneLimit:Object(Tm.c)(e)?e.cardinality:void 0})))))))}})(i,new Cm.AnomalyTimelineService(e,a,i),new Fm.a(e,t,i),e)}),[]),s=Object(n.useMemo)((()=>new Se.Subject),[]),r=Object(n.useMemo)((()=>s.pipe(Object(Me.switchMap)(i))),[]);return[q()(r),Object(n.useCallback)((e=>{s.next(e)}),[])]},Bm=".ml-anomalies-*";var Jm=a(238);const Vm=e=>{const{filterActive:t,loading:a,selectedCells:i,viewBySwimlaneData:n,viewBySwimlaneDataLoading:s}=e;if(a||s)return{};let r=!1;return null!=i&&i.type===km.h.VIEW_BY&&void 0!==n&&void 0!==n.points&&n.points.length>0&&(r=!1===t&&!i.lanes.some((e=>n.points.some((t=>t.laneLabel===e&&t.time>=i.times[0]&&t.time<=i.times[1]))))),!0===r?{...Object(Zo.d)()}:{}};const Um=(e,t)=>{const{selectedJobs:a}=t,i={...e,noInfluencersConfigured:0===Object(Zo.g)(a).length,overallSwimlaneData:Object(Zo.f)(),selectedJobs:a,viewByFromPage:!e.selectedJobs||Object(E.isEqual)(e.selectedJobs,a)?e.viewByFromPage:1};if(!0===i.noInfluencersConfigured){const e={filterActive:!1,filteredFields:[],influencersFilterQuery:void 0,maskAll:!1,queryString:"",tableQueryString:""};Object.assign(i,e)}else i.indexPattern=function(e){return{title:Bm,fields:Object(Zo.g)(e).map((e=>({name:e,type:"string",aggregatable:!0,searchable:!0})))}}(a);return i.loading=!0,i};function Gm(){return{overallAnnotations:{error:void 0,annotationsData:[]},annotations:{error:void 0,annotationsData:[]},anomalyChartsDataLoading:!0,chartsData:Object(Jm.a)(),fieldFormatsLoading:!1,filterActive:!1,filteredFields:[],filterPlaceHolder:void 0,indexPattern:{title:Bm,fields:[]},influencersFilterQuery:void 0,influencers:{},isAndOperator:!1,loading:!0,maskAll:!1,noInfluencersConfigured:!0,overallSwimlaneData:Object(Zo.f)(),queryString:"",selectedCells:void 0,selectedJobs:null,swimlaneBucketInterval:void 0,swimlaneContainerWidth:0,tableData:{anomalies:[],examplesByJobId:[""],interval:0,jobIds:[],showViewSeriesLink:!1},tableQueryString:"",viewByLoadedForTimeFormatted:null,viewBySwimlaneData:Object(Zo.f)(),viewBySwimlaneDataLoading:!1,viewBySwimlaneFieldName:void 0,viewBySwimlaneOptions:[],viewByPerPage:km.i,viewByFromPage:1,swimlaneLimit:void 0,showCharts:!0}}const qm=e=>{const{influencers:t,noInfluencersConfigured:a}=e;if(void 0!==t&&!a)for(const e in t)if(t[e][0]&&t[e][0].influencerFieldValue)return{filterPlaceHolder:y.i18n.translate("xpack.ml.explorer.kueryBar.filterPlaceholder",{defaultMessage:"Filter by influencer fields… ({queryExample})",values:{queryExample:`${e} : ${t[e][0].influencerFieldValue}`}})};return{}};const Hm=new Se.Subject,Wm=Hm.pipe(Object(Me.flatMap)((e=>Object(Se.isObservable)(e)?e:Object(Se.from)([e]))),Object(Me.distinctUntilChanged)(E.isEqual)).pipe(Object(Me.scan)(((e,t)=>{const{type:a,payload:i}=t;let n;switch(a){case km.c.CLEAR_EXPLORER_DATA:n=Gm();break;case km.c.CLEAR_INFLUENCER_FILTER_SETTINGS:n=function(e){return{...e,filterActive:!1,filteredFields:[],influencersFilterQuery:void 0,isAndOperator:!1,maskAll:!1,queryString:"",tableQueryString:"",...Object(Zo.d)(),viewByFromPage:1}}(e);break;case km.c.CLEAR_JOBS:n={...e,...Object(Zo.d)(),loading:!1,viewByFromPage:1,selectedJobs:[]};break;case km.c.JOB_SELECTION_CHANGE:n=Um(e,i);break;case km.c.SET_CHARTS_DATA_LOADING:n={...e,anomalyChartsDataLoading:!0,chartsData:Object(Jm.a)()};break;case km.c.SET_CHARTS:n={...e,chartsData:{...Object(Jm.a)(),chartsPerRow:i.chartsPerRow,seriesToPlot:i.seriesToPlot,tooManyBuckets:!!i.tooManyBuckets,errorMessages:i.errorMessages}};break;case km.c.SET_INFLUENCER_FILTER_SETTINGS:n=function(e,t){const{filterQuery:a,isAndOperator:i,filteredFields:n,queryString:s,tableQueryString:r}=t,{selectedCells:o,viewBySwimlaneOptions:l}=e;let c=e.viewBySwimlaneFieldName;const d=l.filter((e=>n.includes(e)));if(i&&void 0===o)c=km.j;else for(let e=0;e<n.length;e++)if(d.includes(n[e])&&(void 0===o||o&&"overall"===o.type)){c=n[e];break}return{...e,filterActive:!0,filteredFields:n,influencersFilterQuery:a,isAndOperator:i,queryString:s,tableQueryString:r,maskAll:c===km.j||!1===n.includes(c),viewBySwimlaneFieldName:c,viewBySwimlaneOptions:d,viewByFromPage:1}}(e,i);break;case km.c.SET_SELECTED_CELLS:const t=i;n={...e,selectedCells:t};break;case km.c.SET_EXPLORER_DATA:case km.c.SET_FILTER_DATA:n={...e,...i};break;case km.c.SET_SWIMLANE_CONTAINER_WIDTH:n={...e,swimlaneContainerWidth:i};break;case km.c.SET_VIEW_BY_SWIMLANE_FIELD_NAME:const{filteredFields:a,influencersFilterQuery:s}=e,r=i;let o=!1;void 0!==s&&(o=r===km.j||!1===a.includes(r)),n={...e,...Object(Zo.d)(),maskAll:o,viewBySwimlaneFieldName:r,viewBySwimlaneData:Object(Zo.f)(),viewByFromPage:1,viewBySwimlaneDataLoading:!0};break;case km.c.SET_VIEW_BY_SWIMLANE_LOADING:const{annotationsData:l,overallState:c,tableData:d}=i;n={...e,annotations:l,overallSwimlaneData:c,tableData:d,viewBySwimlaneData:{...Object(Zo.f)()},viewBySwimlaneDataLoading:!0};break;case km.c.SET_VIEW_BY_FROM_PAGE:n={...e,viewByFromPage:i};break;case km.c.SET_VIEW_BY_PER_PAGE:n={...e,viewByFromPage:1,viewByPerPage:i};break;case km.c.SET_SWIM_LANE_SEVERITY:n={...e,viewByFromPage:1,swimLaneSeverity:i};break;case km.c.SET_SHOW_CHARTS:n={...e,showCharts:i};break;default:n=e}if(null===n.selectedJobs)return n;const s=Object(Zo.l)(n.selectedJobs,n.swimlaneContainerWidth),{viewBySwimlaneFieldName:r,viewBySwimlaneOptions:o}=Object(Zo.m)({currentViewBySwimlaneFieldName:n.viewBySwimlaneFieldName,filterActive:n.filterActive,filteredFields:n.filteredFields,isAndOperator:n.isAndOperator,selectedJobs:n.selectedJobs,selectedCells:n.selectedCells}),{selectedCells:l}=n,c=function(e){if(void 0!==(null==e?void 0:e.times))return{earliestMs:1e3*e.times[0],latestMs:1e3*e.times[1]-1}}(l);return{...n,swimlaneBucketInterval:s,viewByLoadedForTimeFormatted:c?`${Object(Ud.b)(c.earliestMs)} - ${Object(Ud.b)(c.latestMs)}`:null,viewBySwimlaneFieldName:r,viewBySwimlaneOptions:o,...Vm(n),...qm(n)}}),Gm()),Object(Me.shareReplay)(1)),$m=Wm.pipe(Object(Me.map)((e=>{const t={mlExplorerFilter:{},mlExplorerSwimlane:{}};if(void 0!==e.selectedCells){const a=e.selectedCells;t.mlExplorerSwimlane.selectedType=a.type,t.mlExplorerSwimlane.selectedLanes=a.lanes,t.mlExplorerSwimlane.selectedTimes=a.times,t.mlExplorerSwimlane.showTopFieldValues=a.showTopFieldValues}return void 0!==e.viewBySwimlaneFieldName&&(t.mlExplorerSwimlane.viewByFieldName=e.viewBySwimlaneFieldName),void 0!==e.viewByFromPage&&(t.mlExplorerSwimlane.viewByFromPage=e.viewByFromPage),void 0!==e.viewByPerPage&&(t.mlExplorerSwimlane.viewByPerPage=e.viewByPerPage),void 0!==e.swimLaneSeverity&&(t.mlExplorerSwimlane.severity=e.swimLaneSeverity),void 0!==e.showCharts&&(t.mlShowCharts=e.showCharts),e.filterActive&&(t.mlExplorerFilter.influencersFilterQuery=e.influencersFilterQuery,t.mlExplorerFilter.filterActive=e.filterActive,t.mlExplorerFilter.filteredFields=e.filteredFields,t.mlExplorerFilter.queryString=e.queryString),t})),Object(Me.distinctUntilChanged)(E.isEqual)),Ym={appState$:$m,state$:Wm,clearExplorerData:()=>{Hm.next({type:km.c.CLEAR_EXPLORER_DATA})},clearInfluencerFilterSettings:()=>{Hm.next({type:km.c.CLEAR_INFLUENCER_FILTER_SETTINGS})},clearJobs:()=>{Hm.next({type:km.c.CLEAR_JOBS})},updateJobSelection:e=>{Hm.next(function(e){return Object(Se.from)(nu.a.populateFormats(e)).pipe(Object(Me.map)((t=>{if(t.err)return console.log("Error populating field formats:",t.err),null;const a=Object(Zo.a)(re.a.jobs).map((t=>(t.selected=e.some((e=>t.id===e)),t))).filter((e=>e.selected));return{type:km.c.JOB_SELECTION_CHANGE,payload:{loading:!1,selectedJobs:a}}})))}(e))},setCharts:e=>{Hm.next({type:km.c.SET_CHARTS,payload:e})},setInfluencerFilterSettings:e=>{Hm.next({type:km.c.SET_INFLUENCER_FILTER_SETTINGS,payload:e})},setSelectedCells:e=>{Hm.next({type:km.c.SET_SELECTED_CELLS,payload:e})},setExplorerData:e=>{Hm.next((e=>({type:km.c.SET_EXPLORER_DATA,payload:e}))(e))},setFilterData:e=>{Hm.next((e=>({type:km.c.SET_FILTER_DATA,payload:e}))(e))},setChartsDataLoading:()=>{Hm.next({type:km.c.SET_CHARTS_DATA_LOADING})},setSwimlaneContainerWidth:e=>{Hm.next({type:km.c.SET_SWIMLANE_CONTAINER_WIDTH,payload:e})},setViewBySwimlaneFieldName:e=>{Hm.next({type:km.c.SET_VIEW_BY_SWIMLANE_FIELD_NAME,payload:e})},setViewBySwimlaneLoading:e=>{Hm.next({type:km.c.SET_VIEW_BY_SWIMLANE_LOADING,payload:e})},setViewByFromPage:e=>{Hm.next({type:km.c.SET_VIEW_BY_FROM_PAGE,payload:e})},setViewByPerPage:e=>{Hm.next({type:km.c.SET_VIEW_BY_PER_PAGE,payload:e})},setSwimLaneSeverity:e=>{Hm.next({type:km.c.SET_SWIM_LANE_SEVERITY,payload:e})},setShowCharts:e=>{Hm.next({type:km.c.SET_SHOW_CHARTS,payload:e})}},Xm=({showCharts:e,setShowCharts:t})=>{const a=Object(n.useCallback)((e=>{t(e.target.checked)}),[t]),i=Object(n.useMemo)((()=>Object(te.htmlIdGenerator)()()),[]);return Object(N.jsx)(te.EuiCheckbox,{id:i,label:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.controls.checkboxShowCharts.showChartsCheckboxLabel",defaultMessage:"Show charts"}),checked:e,onChange:a})},Qm=S.c.KUERY;function Km({inputString:e,queryLanguage:t,indexPattern:a}){var i;let n={};const s=[],r=Object(w.d)(e),o=r&&"and"===r.function;r&&Array.isArray(r.arguments)&&r.arguments.forEach((e=>{void 0!==e.arguments?e.arguments.forEach((e=>{"string"==typeof e.value&&s.push(e.value)})):"string"==typeof e.value&&s.push(e.value)})),t===S.c.KUERY?n=Object(w.f)(Object(w.d)(e),a):t===S.c.LUCENE&&(n=Object(w.e)(e));return{clearSettings:Boolean((null===(i=n)||void 0===i?void 0:i.match_all)&&0===Object.keys(n.match_all).length),settings:{filterQuery:n,queryString:e,tableQueryString:e,isAndOperator:o,filteredFields:s}}}function Zm({filterActive:e,queryString:t}){return void 0!==t&&!0===e?{language:S.c.KUERY,query:t}:{query:"",language:Qm}}const eb=({filterActive:e,filterPlaceHolder:t,indexPattern:a,queryString:i,updateLanguage:s})=>{const[r,o]=Object(n.useState)(Zm({filterActive:e,queryString:i})),[l,c]=Object(n.useState)(void 0);Object(n.useEffect)((function(){o(Zm({filterActive:e,queryString:i}))}),[e,i]);return Object(N.jsx)(te.EuiInputPopover,{style:{maxWidth:"100%"},closePopover:()=>c(void 0),input:Object(N.jsx)(_.QueryStringInput,{bubbleSubmitEvent:!1,query:r,indexPatterns:[a],onChange:e=>{r.language!==e.language&&s(e.language),o(e)},onSubmit:e=>{try{const{clearSettings:t,settings:i}=Km({inputString:e.query,queryLanguage:e.language,indexPattern:a});!0===t?Ym.clearInfluencerFilterSettings():Ym.setInfluencerFilterSettings(i)}catch(t){console.log("Invalid query syntax in search bar",t),c({query:e.query,message:t.message})}},placeholder:t,disableAutoFocus:!0,dataTestSubj:"explorerQueryInput",languageSwitcherPopoverAnchorPosition:"rightDown"}),isOpen:(null==l?void 0:l.query)===r.query&&""!==(null==l?void 0:l.message)},Object(N.jsx)(te.EuiCode,null,y.i18n.translate("xpack.ml.explorer.invalidKuerySyntaxErrorMessageQueryBar",{defaultMessage:"Invalid query"}),": ",null==l?void 0:l.message.split("\n")[0]))};var tb=a(187),ab=a.n(tb),ib=a(253),nb=a(103),sb=a(55),rb=a(45);function ob(){const{services:{savedObjects:{client:e},kibanaVersion:t,share:{urlGenerators:a}}}=Object(f.b)();return Object(n.useMemo)((()=>function(e,t,a){const i=Object(te.htmlIdGenerator)();return{fetchDashboards:async t=>await e.find({type:"dashboard",perPage:1e3,search:t?`${t}*`:"",searchFields:["title^3","description"]}),getLastPanel:e=>e.length>0?e.reduce(((e,t)=>e.gridData.y>=t.gridData.y?e.gridData.y===t.gridData.y?e.gridData.x>t.gridData.x?e:t:e:t)):null,async attachPanels(a,n,s){const r=JSON.parse(n.panelsJSON),o=t;for(const e of s){const t=i(),a=this.getLastPanel(r),n=a?a.gridData.w+a.gridData.x:0,s=48-n-24>=0?n:0;r.push({panelIndex:t,embeddableConfig:e.embeddableConfig,title:e.title,type:e.type,version:o,gridData:{h:15,i:t,w:24,x:s,y:a?s>0?a.gridData.y:a.gridData.y+a.gridData.h:0}})}await e.update("dashboard",a,{...n,panelsJSON:JSON.stringify(r)})},getDashboardEditUrl:async e=>await a.createUrl({dashboardId:e,useHash:!1,viewMode:rb.ViewMode.EDIT})}}(e,t,a.getUrlGenerator(sb.DASHBOARD_APP_URL_GENERATOR))),[e,t])}const lb=()=>{const{notifications:{toasts:e}}=Object(f.b)(),t=ob(),[a,i]=Object(n.useState)(!1);Object(n.useEffect)((()=>(d(),()=>{d.cancel()})),[]);const s=Object(n.useMemo)((()=>({onChange:({queryText:e})=>{i(!0),d(e)},box:{incremental:!0,"data-test-subj":"mlDashboardsSearchBox"}})),[]),[r,o]=Object(n.useState)([]),[l,c]=Object(n.useState)([]),d=Object(n.useCallback)(Object(E.debounce)((async a=>{try{const e=(await t.fetchDashboards(a)).savedObjects.map((e=>({id:e.id,title:e.attributes.title,description:e.attributes.description,attributes:e.attributes})));o(e)}catch(t){e.danger({body:t})}i(!1)}),500),[]);return{dashboardItems:r,selectedItems:l,selection:{onSelectionChange:c},search:s,isLoading:a}},cb=[{field:"title",name:y.i18n.translate("xpack.ml.explorer.dashboardsTable.titleColumnHeader",{defaultMessage:"Title"}),sortable:!0,truncateText:!0},{field:"description",name:y.i18n.translate("xpack.ml.explorer.dashboardsTable.descriptionColumnHeader",{defaultMessage:"Description"}),truncateText:!0}],db=({onClose:e,selection:t,dashboardItems:a,isLoading:i,search:n,addToDashboardAndEditCallback:s,addToDashboardCallback:r,title:o,disabled:l,children:c})=>Object(N.jsx)(te.EuiModal,{onClose:e.bind(null,void 0),"data-test-subj":"mlAddToDashboardModal"},Object(N.jsx)(te.EuiModalHeader,null,Object(N.jsx)(te.EuiModalHeaderTitle,null,o)),Object(N.jsx)(te.EuiModalBody,null,c,Object(N.jsx)(te.EuiFormRow,{fullWidth:!0,label:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.explorer.addToDashboard.selectDashboardsLabel",defaultMessage:"Select dashboards:"}),"data-test-subj":"mlDashboardSelectionContainer"},Object(N.jsx)(te.EuiInMemoryTable,{itemId:"id",isSelectable:!0,selection:t,items:a,loading:i,columns:cb,search:n,pagination:!0,sorting:!0,"data-test-subj":"mlDashboardSelectionTable"+(i?" loading":" loaded")}))),Object(N.jsx)(te.EuiModalFooter,null,Object(N.jsx)(te.EuiButtonEmpty,{onClick:e.bind(null,void 0)},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.explorer.addToDashboard.cancelButtonLabel",defaultMessage:"Cancel"})),Object(N.jsx)(te.EuiButton,{disabled:l,onClick:e.bind(null,s),"data-test-subj":"mlAddAndEditDashboardButton"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.explorer.dashboardsTable.addAndEditDashboardLabel",defaultMessage:"Add and edit dashboard"})),Object(N.jsx)(te.EuiButton,{fill:!0,onClick:e.bind(null,r),disabled:l,"data-test-subj":"mlAddToDashboardsButton"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.explorer.dashboardsTable.addToDashboardLabel",defaultMessage:"Add to dashboards"})))),ub=({onClose:e,getPanelsData:t,selectedDashboards:a})=>{const{notifications:{toasts:i},services:{application:{navigateToUrl:s}}}=Object(f.b)(),r=ob(),o=Object(n.useCallback)((async()=>{const e=await t(a);for(const t of a)try{await r.attachPanels(t.id,t.attributes,e),i.success({title:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.explorer.dashboardsTable.savedSuccessfullyTitle",defaultMessage:'Dashboard "{dashboardTitle}" updated successfully',values:{dashboardTitle:t.title}}),toastLifeTimeMs:3e3})}catch(e){i.danger({body:e})}}),[a,t]),l=Object(n.useCallback)((async()=>{e((async()=>{await o();const e=a[0].id;await s(await r.getDashboardEditUrl(e))}))}),[o,a,s]);return{addToDashboardCallback:o,addToDashboardAndEditCallback:l}};const pb=({onClose:e,jobIds:t,viewBy:a})=>{const{selectedItems:i,selection:r,dashboardItems:o,isLoading:l,search:c}=lb(),[d,u]=Object(n.useState)({[km.h.OVERALL]:!0,[km.h.VIEW_BY]:!1}),p=Object(n.useCallback)((async()=>Object.entries(d).filter((([,e])=>e)).map((([e])=>e)).map((e=>{const i=function(e){return{type:nb.b,title:Object(ib.getDefaultSwimlanePanelTitle)(e)}}(t);return e===km.h.VIEW_BY?{...i,embeddableConfig:{jobIds:t,swimlaneType:e,viewBy:a}}:{...i,embeddableConfig:{jobIds:t,swimlaneType:e}}}))),[d,i]),{addToDashboardAndEditCallback:m,addToDashboardCallback:b}=ub({onClose:e,getPanelsData:p,selectedDashboards:i}),h=[{id:km.h.OVERALL,label:y.i18n.translate("xpack.ml.explorer.overallLabel",{defaultMessage:"Overall"})},{id:km.h.VIEW_BY,label:y.i18n.translate("xpack.ml.explorer.viewByFieldLabel",{defaultMessage:"View by {viewByField}",values:{viewByField:a}})}],f=Object.values(d).every((e=>!e)),g=Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(te.EuiFormRow,{label:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.explorer.addToDashboard.swimlanes.selectSwimlanesLabel",defaultMessage:"Select swim lane view:"})},Object(N.jsx)(te.EuiCheckboxGroup,{options:h,idToSelectedMap:d,onChange:e=>{const t={...d,[e]:!d[e]};u(t)},"data-test-subj":"mlAddToDashboardSwimlaneTypeSelector"})),Object(N.jsx)(te.EuiSpacer,{size:"m"})),j=Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.explorer.addToDashboard.swimlanes.dashboardsTitle",defaultMessage:"Add swim lanes to dashboards"}),x=f||0===i.length;return Object(N.jsx)(db,{onClose:e,selectedItems:i,selection:r,dashboardItems:o,isLoading:l,search:c,addToDashboardAndEditCallback:m,addToDashboardCallback:b,disabled:x,title:j},g)};var mb=a(28);const bb=({filteredFields:e=[],swimlaneData:t})=>{const a=e.find((e=>/\@kuery-wildcard\@$/.test(e))),i=void 0!==a?a.replace(/\@kuery-wildcard\@$/,""):null;return null!==i&&t.points.some((e=>e.laneLabel.includes(i)))},hb=()=>Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.anomalySwimLane.noOverallDataMessage",defaultMessage:"No anomalies found in the overall bucket results for this time range"});var fb=a(254);const gb=()=>{const[e,t]=Object(n.useState)(!1);return Object(N.jsx)(Xl,{anchorPosition:"upCenter",button:Object(N.jsx)(Yl,{onClick:()=>{t(!e)}}),closePopover:()=>t(!1),isOpen:e,title:y.i18n.translate("xpack.ml.explorer.anomalyTimelinePopoverTitle",{defaultMessage:"Anomaly timelines"})},Object(N.jsx)("p",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.explorer.anomalyTimelinePopoverBasicExplanation",defaultMessage:"Swim lanes provide an overview of the buckets of data that have been analyzed within the selected time period. You can view an overall swim lane or view them by job or influencer."})),Object(N.jsx)("p",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.explorer.anomalyTimelinePopoverScoreExplanation",defaultMessage:"Each block in a swim lane is colored according to its anomaly score, which is a value from 0 to 100. The blocks with high scores are shown in red and low scores are indicated in blue."})),Object(N.jsx)("p",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.explorer.anomalyTimelinePopoverAdvancedExplanation",defaultMessage:"The anomaly scores that you see in each section of the Anomaly Explorer might differ slightly. This disparity occurs because for each job there are bucket results, overall bucket results, influencer results, and record results. Anomaly scores are generated for each type of result. The overall swim lane shows the maximum overall bucket score for each block. When you view a swim lane by job, it shows the maximum bucket score in each block. When you view by influencer, it shows the maximum influencer score in each block."})),Object(N.jsx)("p",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.explorer.anomalyTimelinePopoverSelectionExplanation",defaultMessage:"When you select one or more blocks in the swim lanes, the list of anomalies and top influencers is likewise filtered to provide information relative to that selection."})))};var jb=a(120),xb=a(343);const vb=s.a.memo((({explorerState:e,setSelectedCells:t})=>{var a,i,r;const{services:{uiSettings:o,application:{capabilities:l}}}=Object(f.b)(),[c,d]=Object(n.useState)(!1),[u,p]=Object(n.useState)(!1),m=null!==(a=null===(i=l.dashboard)||void 0===i?void 0:i.createNew)&&void 0!==a&&a,b=Object(n.useMemo)((()=>new Ss.a({"histogram:maxBars":o.get(mb.UI_SETTINGS.HISTOGRAM_MAX_BARS),"histogram:barTarget":o.get(mb.UI_SETTINGS.HISTOGRAM_BAR_TARGET),dateFormat:o.get("dateFormat"),"dateFormat:scaled":o.get("dateFormat:scaled")})),[o]),{filterActive:h,filteredFields:g,maskAll:j,selectedCells:x,viewByLoadedForTimeFormatted:v,viewBySwimlaneDataLoading:O,viewBySwimlaneFieldName:E,viewBySwimlaneOptions:w,selectedJobs:_,viewByFromPage:S,viewByPerPage:M,swimlaneLimit:k,loading:C,overallAnnotations:T,swimLaneSeverity:F,overallSwimlaneData:I,viewBySwimlaneData:D,swimlaneContainerWidth:A}=e,[L,R]=Object(n.useState)(F);ab()((()=>{L!==F&&Ym.setSwimLaneSeverity(L)}),500,[L,F]);const P=Object(n.useMemo)((()=>T.annotationsData),[T]),z=Object(n.useMemo)((()=>{const e=[];return m&&e.push(Object(N.jsx)(te.EuiContextMenuItem,{key:"addToDashboard",onClick:p.bind(null,!0),"data-test-subj":"mlAnomalyTimelinePanelAddToDashboardButton"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.explorer.addToDashboardLabel",defaultMessage:"Add to dashboard"}))),e}),[m]),B=Object(n.useMemo)((()=>{if(x)return x.type===km.h.OVERALL?x:{type:km.h.OVERALL,lanes:[km.g],times:x.times}}),[x]),J=Object(n.useMemo)((()=>Cm.AnomalyTimelineService.isOverallSwimlaneData(I)?{min:1e3*I.earliest,max:1e3*I.latest,minInterval:1e3*I.interval}:void 0),[I]);return Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(te.EuiPanel,{paddingSize:"m"},Object(N.jsx)(te.EuiFlexGroup,{direction:"row",gutterSize:"xs",responsive:!1,alignItems:"baseline"},Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiTitle,{className:"panel-title"},Object(N.jsx)("h2",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.explorer.anomalyTimelineTitle",defaultMessage:"Anomaly timeline"})))),Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(gb,null)),z.length>0&&Object(N.jsx)(te.EuiFlexItem,{grow:!1,style:{marginLeft:"auto",alignSelf:"baseline"}},Object(N.jsx)(te.EuiPopover,{button:Object(N.jsx)(te.EuiButtonIcon,{size:"s","aria-label":y.i18n.translate("xpack.ml.explorer.swimlaneActions",{defaultMessage:"Actions"}),color:"subdued",iconType:"boxesHorizontal",onClick:d.bind(null,!c),"data-test-subj":"mlAnomalyTimelinePanelMenu"}),isOpen:c,closePopover:d.bind(null,!1),panelPaddingSize:"none",anchorPosition:"downLeft"},Object(N.jsx)(te.EuiContextMenuPanel,{items:z})))),Object(N.jsx)(te.EuiSpacer,{size:"m"}),Object(N.jsx)(te.EuiFlexGroup,{direction:"row",gutterSize:"m",responsive:!1,alignItems:"baseline"},w.length>0&&Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiSelect,{prepend:y.i18n.translate("xpack.ml.explorer.viewByLabel",{defaultMessage:"View by"}),compressed:!0,id:"selectViewBy",options:(V=w,V.map((e=>({value:e,text:e})))),value:E,onChange:e=>Ym.setViewBySwimlaneFieldName(e.target.value)}))),Object(N.jsx)(te.EuiFlexItem,{grow:!0},Object(N.jsx)(fb.a,{value:null!=L?L:0,onChange:Object(n.useCallback)((e=>{R(e)}),[])}))),Object(N.jsx)(te.EuiSpacer,{size:"m"}),Object(N.jsx)(te.EuiFlexGroup,{direction:"row",gutterSize:"m",responsive:!1,alignItems:"center"},Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)("div",{className:"panel-sub-title"},v&&Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.explorer.sortedByMaxAnomalyScoreForTimeFormattedLabel",defaultMessage:"(Sorted by max anomaly score for {viewByLoadedForTimeFormatted})",values:{viewByLoadedForTimeFormatted:v}}),Object(jb.a)(v)?null:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.explorer.sortedByMaxAnomalyScoreLabel",defaultMessage:"(Sorted by max anomaly score)"}),!0===h&&E===km.j&&Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.explorer.jobScoreAcrossAllInfluencersLabel",defaultMessage:"(Job score across all influencers)"}))),x?Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiButtonEmpty,{size:"xs",onClick:t.bind(null,void 0),"data-test-subj":"mlAnomalyTimelineClearSelection"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.explorer.clearSelectionLabel",defaultMessage:"Clear selection"}))):null),Object(N.jsx)(te.EuiSpacer,{size:"m"}),J&&Array.isArray(P)&&P.length>0?Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(qp.a,null,(e=>Object(N.jsx)(xb.a,{chartWidth:A,domain:J,annotationsData:P,tooltipService:e}))),Object(N.jsx)(te.EuiSpacer,{size:"m"})):null,Object(N.jsx)(Tm.b,{id:"overall","data-test-subj":"mlAnomalyExplorerSwimlaneOverall",filterActive:h,maskAll:j,timeBuckets:b,swimlaneData:I,swimlaneType:km.h.OVERALL,selection:B,onCellsSelection:t,onResize:Ym.setSwimlaneContainerWidth,isLoading:C,noDataWarning:Object(N.jsx)(hb,null),showTimeline:!1,annotationsData:P,showLegend:!1}),Object(N.jsx)(te.EuiSpacer,{size:"m"}),w.length>0&&Object(N.jsx)(Tm.b,{id:"view_by","data-test-subj":"mlAnomalyExplorerSwimlaneViewBy",filterActive:h,maskAll:j&&!bb({filteredFields:g,swimlaneData:D}),timeBuckets:b,showLegend:!1,swimlaneData:D,swimlaneType:km.h.VIEW_BY,selection:x,onCellsSelection:t,onResize:Ym.setSwimlaneContainerWidth,fromPage:S,perPage:M,swimlaneLimit:k,onPaginationChange:({perPage:e,fromPage:t})=>{e&&Ym.setViewByPerPage(e),t&&Ym.setViewByFromPage(t)},isLoading:C||O,noDataWarning:"string"==typeof E?E===km.j?Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.explorer.noResultForSelectedJobsMessage",defaultMessage:"No results found for selected {jobsCount, plural, one {job} other {jobs}}",values:{jobsCount:null!==(r=null==_?void 0:_.length)&&void 0!==r?r:1}}):Object(N.jsx)(vm,{viewBySwimlaneFieldName:E,showFilterMessage:!0===h}):null})),u&&_&&Object(N.jsx)(pb,{onClose:async e=>{p(!1),e&&await e()},jobIds:_.map((({id:e})=>e)),viewBy:E}));var V}),((e,t)=>Object(E.isEqual)(e.explorerState,t.explorerState)));var yb=a(348),Ob=a(57),Eb=a(359);function wb(e,t){const a={};for(let i=0;i<e.length;i++){const n=e[i],s=n.entityValue;n.jobId===t&&(void 0===a[s]?a[s]={count:1,entityValue:s,max_severity:Math.floor(n.severity)}:(a[s].count+=1,n.severity>a[s].max_severity&&(a[s].max_severity=Math.floor(n.severity))))}return Object.values(a)}const _b=({anomalies:e,jobIds:t})=>{const[a,i]=Object(n.useState)(),{services:{maps:r}}=Object(f.b)(),o=Object(n.useCallback)((async()=>{if(!r)return;const a=await Promise.all(t.map((async t=>{const a=new Set;let i;for(let n=0;n<e.length&&(t===e[n].jobId&&""!==e[n].entityValue&&void 0!==e[n].entityValue&&""!==e[n].entityName&&void 0!==e[n].entityName&&(a.add(e[n].entityValue),i||(i=e[n].entityName)),3!==a.size);n++);const n=await r.suggestEMSTermJoinConfig({sampleValues:Array.from(a),sampleValuesColumnName:i||""});return n?{jobId:t,...n}:n})));i(a.filter(jb.a))}),[...t]);Object(n.useEffect)((function(){e&&e.length>0&&o()}),[...t]);const l=Object(n.useMemo)((()=>null!=a&&a.length?a.map((t=>((e,{layerId:t,field:a,jobId:i})=>({id:Object(te.htmlIdGenerator)()(),label:y.i18n.translate("xpack.ml.explorer.anomaliesMap.anomaliesCount",{defaultMessage:"Anomalies count: {jobId}",values:{jobId:i}}),joins:[{leftField:a,right:{id:"anomaly_count",type:Ob.SOURCE_TYPES.TABLE_SOURCE,__rows:wb(e,i),__columns:[{name:"entityValue",type:"string"},{name:"count",type:"number"},{name:"max_severity",type:"number"}],term:"entityValue"}}],sourceDescriptor:{type:"EMS_FILE",id:t},style:{type:"VECTOR",properties:{icon:{type:Ob.STYLE_TYPE.STATIC,options:{value:"marker"}},fillColor:{type:Ob.STYLE_TYPE.DYNAMIC,options:{color:"Blue to Red",colorCategory:"palette_0",fieldMetaOptions:{isEnabled:!0,sigma:3},type:Ob.COLOR_MAP_TYPE.ORDINAL,field:{name:"count",origin:Ob.FIELD_ORIGIN.JOIN},useCustomColorRamp:!1}},lineColor:{type:Ob.STYLE_TYPE.DYNAMIC,options:{fieldMetaOptions:{isEnabled:!0}}},lineWidth:{type:Ob.STYLE_TYPE.STATIC,options:{size:1}}},isTimeAware:!0},visible:!1,type:Ob.LAYER_TYPE.VECTOR}))(e,t)),[]):[]),[a,e]),c=l.filter((e=>{var t,a;return(Array.isArray(e.joins)?null===(t=e.joins[0])||void 0===t||null===(a=t.right)||void 0===a?void 0:a.__rows:[]).length}));return c.length>0&&(c[0].visible=!0),0===(null==a?void 0:a.length)||0===c.length?null:Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(te.EuiPanel,{"data-test-subj":"mlAnomaliesMapContainer"},Object(N.jsx)(te.EuiAccordion,{id:"mlAnomalyExplorerAnomaliesMapAccordionId",initialIsOpen:!0,buttonContent:Object(N.jsx)(te.EuiTitle,{className:"panel-title"},Object(N.jsx)("h2",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.explorer.mapTitle",defaultMessage:"Anomaly count by location {infoTooltip}",values:{infoTooltip:Object(N.jsx)(te.EuiIconTip,{content:"Map colors indicate the number of anomalies in each area.",position:"top",type:"iInCircle"})}})))},Object(N.jsx)("div",{"data-test-subj":"mlAnomalyExplorerAnomaliesMap",style:{width:"100%",height:300}},Object(N.jsx)(Eb.a,{layerList:l})))),Object(N.jsx)(te.EuiSpacer,{size:"m"}))};var Sb=a(255),Mb=a(345);const kb=({onClose:e,jobIds:t,selectedCells:a,bounds:i,interval:s})=>{const[r]=Object(pp.d)(),[o,l]=Object(n.useState)(Fm.b),c=Object(n.useCallback)((async()=>{var e;let n;if(void 0!==a&&void 0!==s&&void 0!==i){const{earliestMs:e,latestMs:t}=Object(Zo.k)(a,s,i);n={from:Object(te.formatDate)(e,"MMM D, YYYY @ HH:mm:ss.SSS"),to:Object(te.formatDate)(t,"MMM D, YYYY @ HH:mm:ss.SSS"),mode:"absolute"}}const l=function(e){return{type:nb.a,title:Object(Sb.getDefaultExplorerChartsPanelTitle)(e)}}(t);return[{...l,embeddableConfig:{jobIds:t,maxSeriesToPlot:null!=o?o:Fm.b,severityThreshold:r.val,...null!==(e=n)&&void 0!==e?e:{}}}]}),[a,s,i,t,o,r]),{selectedItems:d,selection:u,dashboardItems:p,isLoading:m,search:b}=lb(),{addToDashboardAndEditCallback:h,addToDashboardCallback:f}=ub({onClose:e,getPanelsData:c,selectedDashboards:d}),g=Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.explorer.addToDashboard.anomalyCharts.dashboardsTitle",defaultMessage:"Add anomaly charts to dashboards"}),j=d.length<1&&!Array.isArray(void 0===t),x=Object(N.jsx)(te.EuiFormRow,{label:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.explorer.addToDashboard.anomalyCharts.maxSeriesToPlotLabel",defaultMessage:"Maximum number of series to plot"})},Object(N.jsx)(te.EuiFieldNumber,{"data-test-subj":"mlAnomalyChartsInitializerMaxSeries",id:"selectMaxSeriesToPlot",name:"selectMaxSeriesToPlot",value:o,onChange:e=>l(parseInt(e.target.value,10)),min:0,max:Mb.b}));return Object(N.jsx)(db,{onClose:e,selectedItems:d,selection:u,dashboardItems:p,isLoading:m,search:b,addToDashboardAndEditCallback:h,addToDashboardCallback:f,disabled:j,title:g},x)},Cb=({selectedJobs:e,selectedCells:t,bounds:a,interval:i,chartsCount:r})=>{var o,l;const{services:{application:{capabilities:c}}}=Object(f.b)(),[d,u]=Object(n.useState)(!1),[p,m]=Object(n.useState)(!1),b=null!==(o=null===(l=c.dashboard)||void 0===l?void 0:l.createNew)&&void 0!==o&&o,h=Object(n.useMemo)((()=>{const e=[];return b&&e.push(Object(N.jsx)(te.EuiContextMenuItem,{key:"addToDashboard",onClick:m.bind(null,!0),"data-test-subj":"mlAnomalyAddChartsToDashboardButton"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.explorer.anomalies.addToDashboardLabel",defaultMessage:"Add anomaly charts to dashboard"}))),e}),[b]),g=e.map((({id:e})=>e));return Object(N.jsx)(s.a.Fragment,null,h.length>0&&r>0&&Object(N.jsx)(te.EuiFlexItem,{grow:!1,style:{marginLeft:"auto",alignSelf:"baseline"}},Object(N.jsx)(te.EuiPopover,{button:Object(N.jsx)(te.EuiButtonIcon,{size:"s","aria-label":y.i18n.translate("xpack.ml.explorer.anomalies.actionsAriaLabel",{defaultMessage:"Actions"}),color:"subdued",iconType:"boxesHorizontal",onClick:u.bind(null,!d),"data-test-subj":"mlExplorerAnomalyPanelMenu",disabled:r<1}),isOpen:d,closePopover:u.bind(null,!1),panelPaddingSize:"none",anchorPosition:"downLeft"},Object(N.jsx)(te.EuiContextMenuPanel,{items:h}))),p&&e&&Object(N.jsx)(kb,{onClose:async e=>{m(!1),e&&await e()},selectedCells:t,bounds:a,interval:i,jobIds:g}))},Tb=({children:e,jobSelectorProps:t,noInfluencersConfigured:a,influencers:i,filterActive:n,filterPlaceHolder:s,indexPattern:r,queryString:o,updateLanguage:l})=>Object(N.jsx)("div",{"data-test-subj":"mlPageAnomalyExplorer"},Object(N.jsx)(cr.a,{tabId:"anomaly_detection"}),Object(N.jsx)(te.EuiPage,{style:{background:"none"}},Object(N.jsx)(te.EuiPageBody,null,Object(N.jsx)(te.EuiPageHeader,null,Object(N.jsx)(te.EuiPageHeaderSection,null,Object(N.jsx)(te.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(bp,{viewId:"explorer"})),Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiTitle,{className:"eui-textNoWrap"},Object(N.jsx)("h1",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.explorer.pageTitle",defaultMessage:"Anomaly Explorer"})))))),Object(N.jsx)(te.EuiPageHeaderSection,{style:{width:"100%"}},Object(N.jsx)(te.EuiFlexGroup,{alignItems:"center",justifyContent:"flexEnd",gutterSize:"s"},!1===a&&void 0!==i&&Object(N.jsx)(te.EuiFlexItem,null,Object(N.jsx)("div",{className:"mlAnomalyExplorer__filterBar"},Object(N.jsx)(eb,{filterActive:n,filterPlaceHolder:s,indexPattern:r,queryString:o,updateLanguage:l}))),Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(fp.a,null))))),Object(N.jsx)(te.EuiHorizontalRule,{margin:"none"}),Object(N.jsx)(hp.a,t),Object(N.jsx)(te.EuiHorizontalRule,{margin:"none"}),e)));class explorer_ExplorerUI extends s.a.Component{constructor(...e){super(...e),Ce()(this,"state",{language:Qm}),Ce()(this,"htmlIdGen",Object(te.htmlIdGenerator)()),Ce()(this,"applyFilter",((e,t,a)=>{const{filterActive:i,indexPattern:n,queryString:s}=this.props.explorerState;let r="";const o=Object(Zo.c)(e),l=Object(Zo.b)(t);if(a===km.d.ADD){const a=Object(Zo.h)(e,t);if(null!==s.match(a))return;r=`${s?`${s} and `:""}${o}:"${l}"`}else if(a===km.d.REMOVE){if(!1===i)return;r=Object(Zo.s)(s,o,l)}try{const{clearSettings:e,settings:t}=Km({inputString:`${r}`,queryLanguage:this.state.language,indexPattern:n});!0===e?Ym.clearInfluencerFilterSettings():Ym.setInfluencerFilterSettings(t)}catch(e){console.log("Invalid query syntax from table",e);Object(d.k)().addDanger(y.i18n.translate("xpack.ml.explorer.invalidKuerySyntaxErrorMessageFromTable",{defaultMessage:"Invalid syntax in query bar. The input must be valid Kibana Query Language (KQL)"}))}})),Ce()(this,"updateLanguage",(e=>this.setState({language:e})))}componentDidMount(){const{invalidTimeRangeError:e}=this.props;if(e){Object(d.k)().addWarning(y.i18n.translate("xpack.ml.explorer.invalidTimeRangeInUrlCallout",{defaultMessage:"The time filter was changed to the full range due to an invalid default time filter. Check the advanced settings for {field}.",values:{field:Rp.a}}))}}render(){var e,t;const{share:a}=this.props.kibana.services,i=a.url.locators.get(T.a),{showCharts:n,severity:r,stoppedPartitions:o,selectedJobsRunning:l,timefilter:c,timeBuckets:d}=this.props,{annotations:u,chartsData:p,filterActive:m,filterPlaceHolder:b,indexPattern:h,influencers:f,loading:g,noInfluencersConfigured:j,overallSwimlaneData:x,queryString:O,selectedCells:E,selectedJobs:w,tableData:_,swimLaneSeverity:S}=this.props.explorerState,{annotationsData:M,totalCount:k,error:C}=u,F=Array.isArray(M)?M.length:0,I=k>F?Object(N.jsx)(te.EuiBadge,{color:"hollow"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.explorer.annotationsOutOfTotalCountTitle",defaultMessage:"First {visibleCount} out of a total of {totalCount}",values:{visibleCount:F,totalCount:k}})):Object(N.jsx)(te.EuiBadge,{color:"hollow"},Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.explorer.annotationsTitleTotalCount",defaultMessage:"Total: {count}",values:{count:F}})),D={dateFormatTz:Object(Zo.e)()},A=null===w||0===w.length,L=x.points&&x.points.length>0,R=L&&x.points.some((e=>e.value>0))||(null===(e=_.anomalies)||void 0===e?void 0:e.length)>0,P=Object(jb.a)(S);if(A&&!g)return Object(N.jsx)(Tb,{jobSelectorProps:D},Object(N.jsx)(ym,null));if(!R&&!g&&!P)return Object(N.jsx)(Tb,{jobSelectorProps:D},Object(N.jsx)(Om,{hasResults:L,selectedJobsRunning:l}));const z=`column ${!0===j?"col-xs-12":"col-xs-10"}`,B=c.getActiveBounds(),J=Array.isArray(w)?w.map((e=>e.id)):[];return Object(N.jsx)(Tb,{jobSelectorProps:D,noInfluencersConfigured:j,influencers:f,filterActive:m,filterPlaceHolder:b,indexPattern:h,queryString:O,updateLanguage:this.updateLanguage},Object(N.jsx)("div",{className:"results-container"},j&&Object(N.jsx)("div",{className:"no-influencers-warning"},Object(N.jsx)(te.EuiIconTip,{content:y.i18n.translate("xpack.ml.explorer.noConfiguredInfluencersTooltip",{defaultMessage:"The Top Influencers list is hidden because no influencers have been configured for the selected jobs."}),position:"right",type:"iInCircle"})),!1===j&&Object(N.jsx)("div",{className:"column col-xs-2","data-test-subj":"mlAnomalyExplorerInfluencerList"},Object(N.jsx)(te.EuiTitle,{className:"panel-title"},Object(N.jsx)("h2",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.explorer.topInfuencersTitle",defaultMessage:"Top influencers"}),Object(N.jsx)(te.EuiIconTip,{content:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.explorer.topInfluencersTooltip",defaultMessage:"View the relative impact of the top influencers in the selected time period and add them as filters on the results. Each influencer has a maximum anomaly score between 0-100 and a total anomaly score for that period."}),position:"right"}))),g?Object(N.jsx)(te.EuiLoadingContent,{lines:10}):Object(N.jsx)(Mm,{influencers:f,influencerFilter:this.applyFilter})),Object(N.jsx)("div",{className:z},Object(N.jsx)(te.EuiSpacer,{size:"m"}),o&&Object(N.jsx)(te.EuiCallOut,{size:"s",title:Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.explorer.stoppedPartitionsExistCallout",defaultMessage:"There may be fewer results than there could have been because stop_on_warn is turned on. Both categorization and subsequent anomaly detection have stopped for some partitions in {jobsWithStoppedPartitions, plural, one {job} other {jobs}} [{stoppedPartitions}] where the categorization status has changed to warn.",values:{jobsWithStoppedPartitions:o.length,stoppedPartitions:o.join(", ")}})}),Object(N.jsx)(vb,{explorerState:this.props.explorerState,setSelectedCells:this.props.setSelectedCells}),Object(N.jsx)(te.EuiSpacer,{size:"m"}),void 0!==C&&Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(te.EuiTitle,{className:"panel-title","data-test-subj":"mlAnomalyExplorerAnnotationsPanel error"},Object(N.jsx)("h2",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.explorer.annotationsErrorTitle",defaultMessage:"Annotations"}))),Object(N.jsx)(te.EuiPanel,null,Object(N.jsx)(te.EuiCallOut,{title:y.i18n.translate("xpack.ml.explorer.annotationsErrorCallOutTitle",{defaultMessage:"An error occurred loading annotations:"}),color:"danger",iconType:"alert"},Object(N.jsx)("p",null,C))),Object(N.jsx)(te.EuiSpacer,{size:"m"})),!1===g&&null!==(t=_.anomalies)&&void 0!==t&&t.length?Object(N.jsx)(_b,{anomalies:_.anomalies,jobIds:J}):null,F>0&&Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(te.EuiPanel,{"data-test-subj":"mlAnomalyExplorerAnnotationsPanel loaded"},Object(N.jsx)(te.EuiAccordion,{id:this.htmlIdGen(),buttonContent:Object(N.jsx)(te.EuiTitle,{className:"panel-title","data-test-subj":"mlAnomalyExplorerAnnotationsPanelButton"},Object(N.jsx)("h2",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.explorer.annotationsTitle",defaultMessage:"Annotations {badge}",values:{badge:I}})))},Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(Vd.a,{jobIds:J,annotations:M,drillDown:!0,numberBadge:!1})))),Object(N.jsx)(Jd.a,null),Object(N.jsx)(te.EuiSpacer,{size:"m"})),!1===g&&Object(N.jsx)(te.EuiPanel,null,Object(N.jsx)(te.EuiFlexGroup,{direction:"row",gutterSize:"m",responsive:!1,alignItems:"center"},Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiTitle,{className:"panel-title"},Object(N.jsx)("h2",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.explorer.anomaliesTitle",defaultMessage:"Anomalies"})))),Object(N.jsx)(te.EuiFlexItem,{grow:!1,style:{marginLeft:"auto",alignSelf:"baseline"}},Object(N.jsx)(Cb,{selectedJobs:w,selectedCells:E,bounds:B,interval:this.props.explorerState.swimlaneBucketInterval?this.props.explorerState.swimlaneBucketInterval.asSeconds():void 0,chartsCount:p.seriesToPlot.length}))),Object(N.jsx)(te.EuiFlexGroup,{direction:"row",gutterSize:"l",responsive:!0,alignItems:"center"},Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(pp.a,null)),Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(dp,null)),p.seriesToPlot.length>0&&void 0!==E&&Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(Xm,{showCharts:n,setShowCharts:Ym.setShowCharts}))),Object(N.jsx)(te.EuiSpacer,{size:"m"}),Object(N.jsx)("div",{className:"euiText explorer-charts"},n?Object(N.jsx)(yb.a,v()({},p,{severity:r,timefilter:c,mlLocator:i,timeBuckets:d,onSelectEntity:this.applyFilter})):null),Object(N.jsx)(Ru,{bounds:B,tableData:_,influencerFilter:this.applyFilter})))))}}const Fb=Object(c.withKibana)(explorer_ExplorerUI);var Ib=a(1);const Db=(e,t)=>({path:"/explorer",render:(e,t)=>Object(N.jsx)(Ab,v()({},e,{deps:t})),breadcrumbs:[P("ML_BREADCRUMB",e,t),P("ANOMALY_DETECTION_BREADCRUMB",e,t),{text:y.i18n.translate("xpack.ml.anomalyDetection.anomalyExplorerLabel",{defaultMessage:"Anomaly Explorer"}),href:""}]}),Ab=({deps:e})=>{const{context:t,results:a}=F(void 0,void 0,e.config,{...Y(e),jobs:re.a.loadJobsWrapper,jobsWithTimeRange:()=>ge.ml.jobs.jobsWithTimerange(Object(Zo.e)())}),i=Object(n.useMemo)((()=>new Q.a),[]);return Object(N.jsx)(Vb,{context:t},Object(N.jsx)(K.a.Provider,{value:i},Object(N.jsx)(Lb,{jobsWithTimeRange:a.jobsWithTimeRange.jobs})))},Lb=({jobsWithTimeRange:e})=>{var t,a,i,s;const[r,o]=function(){const[e]=Object(j.b)("mlExplorerSwimlane");return Object(j.b)(T.b.ANOMALY_EXPLORER,{mlExplorerSwimlane:e,mlExplorerFilter:{}})}(),[l,c]=Object(j.c)("_g"),[d,u]=Object(n.useState)(0),[p,m]=Object(n.useState)(),[b,h]=Object(n.useState)(!1),g=(()=>{const e=Object(f.h)();return Object(n.useMemo)((()=>new Ss.a({"histogram:maxBars":e.get(mb.UI_SETTINGS.HISTOGRAM_MAX_BARS),"histogram:barTarget":e.get(mb.UI_SETTINGS.HISTOGRAM_BAR_TARGET),dateFormat:e.get("dateFormat"),"dateFormat:scaled":e.get("dateFormat:scaled")})),[e])})(),x=Object(f.g)({timeRangeSelector:!0,autoRefreshSelector:!0}),{jobIds:v}=(e=>{var t,a;const[i,s]=Object(j.c)("_g"),{toasts:r}=Object(f.f)(),o=Object(n.useMemo)((()=>{var e;const t=(null==i||null===(e=i.ml)||void 0===e?void 0:e.jobIds)||[];return("string"==typeof t?[t]:t).map((e=>String(e)))}),[null==i||null===(t=i.ml)||void 0===t?void 0:t.jobIds]),l=Object(n.useMemo)((()=>function(e,t){return t.filter((t=>!1===e.some((e=>e.job_id===t))&&"*"!==t))}(e,o)),[o]),c=Object(n.useMemo)((()=>{const e=Object(E.difference)(o,l);return e.sort(),e}),[o,l]),d=Object(n.useMemo)((()=>{var e,t;const a=null!==(e=null==i||null===(t=i.ml)||void 0===t?void 0:t.groups)&&void 0!==e?e:[];return{jobIds:c,selectedGroups:a}}),[c,null==i||null===(a=i.ml)||void 0===a?void 0:a.groups]);return Object(n.useEffect)((()=>{l.length>0&&r.addWarning(y.i18n.translate("xpack.ml.jobSelect.requestedJobsDoesNotExistWarningMessage",{defaultMessage:"Requested\n{invalidIdsLength, plural, one {job {invalidIds} does not exist} other {jobs {invalidIds} do not exist}}",values:{invalidIdsLength:l.length,invalidIds:l.join()}}))}),[l]),Object(n.useEffect)((()=>{if(0===c.length&&e.length>0){r.addWarning(y.i18n.translate("xpack.ml.jobSelect.noJobsSelectedWarningMessage",{defaultMessage:"No jobs selected, auto selecting first job"}));const t=(null==i?void 0:i.ml)||{};t.jobIds=[e[0].job_id];const a=Object(Lp.b)(e,t.jobIds);s({ml:t,...void 0!==a?{time:a}:{}})}}),[e,c,s,null==i?void 0:i.ml]),d})(e),O=e.some((e=>v.includes(e.id)&&!0===e.isRunning)),w=q()(Ym.appState$),_=q()(Ym.state$),S=Object(fm.a)();Object(n.useEffect)((()=>{if(void 0!==S&&d!==S.lastRefresh&&(u(null==S?void 0:S.lastRefresh),void 0!==S.timeRange)){const{start:e,end:t}=S.timeRange;c("time",{from:e,to:t,..."now"===e||"now"===t?{ts:Date.now()}:{}})}}),[null==S?void 0:S.lastRefresh,d,u,c]),Object(n.useEffect)((()=>{void 0!==(null==l?void 0:l.time)&&("invalid"===l.time.mode&&h(!0),x.setTime({from:l.time.from,to:l.time.to}))}),[null==l||null===(t=l.time)||void 0===t?void 0:t.from,null==l||null===(a=l.time)||void 0===a?void 0:a.to,null==l||null===(i=l.time)||void 0===i?void 0:i.ts]);const M=Object(n.useCallback)((async e=>{try{const t=await ge.ml.results.getCategoryStoppedPartitions(e,Ib.d);t&&Array.isArray(t.jobs)&&t.jobs.length>0?m(t.jobs):m(void 0)}catch(e){console.error(e)}}),[]);Object(n.useEffect)((()=>{v.length>0?(Ym.updateJobSelection(v),M(v)):Ym.clearJobs()}),[JSON.stringify(v)]),Object(n.useEffect)((()=>()=>{Ym.clearExplorerData()}),[]),Object(n.useEffect)((()=>{var e;const t=null==r?void 0:r.mlExplorerFilter;void 0!==t&&Ym.setFilterData(t);const{viewByFieldName:a,viewByFromPage:i,viewByPerPage:n,severity:s}=null!==(e=null==r?void 0:r.mlExplorerSwimlane)&&void 0!==e?e:{};void 0!==a&&Ym.setViewBySwimlaneFieldName(a),void 0!==n&&Ym.setViewByPerPage(n),void 0!==i&&Ym.setViewByFromPage(i),void 0!==s&&Ym.setSwimLaneSeverity(s),void 0!==r.mlShowCharts&&Ym.setShowCharts(r.mlShowCharts)}),[]),Object(n.useEffect)((()=>{var e,t;const a=void 0===(null==r||null===(e=r.mlExplorerSwimlane)||void 0===e?void 0:e.viewByFieldName);void 0!==(null==w||null===(t=w.mlExplorerSwimlane)||void 0===t?void 0:t.viewByFieldName)&&o(w,a)}),[w]);const[k,C]=zm();Object(n.useEffect)((()=>{void 0!==k&&Object.keys(k).length>0&&Ym.setExplorerData(k)}),[k]);const[F]=cp(),[I]=Object(pp.d)(),[D,A]=((e,t,a)=>{var i,s;const r=Object(f.g)().getBounds(),o=Object(n.useMemo)((()=>{var t,i,n;if(null==e||null===(t=e.mlExplorerSwimlane)||void 0===t||!t.selectedType)return;let s=null!==(i=e.mlExplorerSwimlane.selectedTimes)&&void 0!==i?i:e.mlExplorerSwimlane.selectedTime;"number"==typeof s&&(s=[s,s+a]);let r=null!==(n=e.mlExplorerSwimlane.selectedLanes)&&void 0!==n?n:e.mlExplorerSwimlane.selectedLane;return"string"==typeof r&&(r=[r]),{type:e.mlExplorerSwimlane.selectedType,lanes:r,times:s,showTopFieldValues:e.mlExplorerSwimlane.showTopFieldValues,viewByFieldName:e.mlExplorerSwimlane.viewByFieldName}}),[JSON.stringify(null==e?void 0:e.mlExplorerSwimlane),a]),l=Object(n.useCallback)((a=>{const i={...e.mlExplorerSwimlane};if(void 0!==a){a.showTopFieldValues=!1;const e=null==o?void 0:o.type,n=null==o?void 0:o.showTopFieldValues,s=null==a?void 0:a.type;(e===km.h.OVERALL&&s===km.h.VIEW_BY||s===km.h.OVERALL||!0===n)&&(a.showTopFieldValues=!0),i.selectedType=a.type,i.selectedLanes=a.lanes,i.selectedTimes=a.times,i.showTopFieldValues=a.showTopFieldValues,t({mlExplorerSwimlane:i})}else delete i.selectedType,delete i.selectedLanes,delete i.selectedTimes,delete i.showTopFieldValues,t({mlExplorerSwimlane:i})}),[null==e?void 0:e.mlExplorerSwimlane,o,t]);return Object(n.useEffect)((function(){if(void 0===(null==o?void 0:o.times)||void 0===a)return;const[e,t]=o.times,i=r.min.unix()-a,n=r.max.unix()+a,s=Math.max(e,i),c=Math.min(t,n);i>c||n<s?l():e===s&&t===c||s===i&&c===n||l({...o,times:[s,c]})}),[null===(i=r.min)||void 0===i?void 0:i.unix(),null===(s=r.max)||void 0===s?void 0:s.unix(),o,a]),[o,l]})(r,o,null==_||null===(s=_.swimlaneBucketInterval)||void 0===s?void 0:s.asSeconds());Object(n.useEffect)((()=>{Ym.setSelectedCells(D)}),[JSON.stringify(D)]);const L=void 0!==_?{lastRefresh:d,influencersFilterQuery:_.influencersFilterQuery,noInfluencersConfigured:_.noInfluencersConfigured,selectedCells:D,selectedJobs:_.selectedJobs,swimlaneBucketInterval:_.swimlaneBucketInterval,tableInterval:F.val,tableSeverity:I.val,viewBySwimlaneFieldName:_.viewBySwimlaneFieldName,swimlaneContainerWidth:_.swimlaneContainerWidth,viewByPerPage:_.viewByPerPage,viewByFromPage:_.viewByFromPage,swimLaneSeverity:_.swimLaneSeverity}:void 0;return Object(n.useEffect)((()=>{const e=!Object(Tm.c)(null==_?void 0:_.viewBySwimlaneData)||null!=D&&D.showTopFieldValues||null==_?void 0:_.viewBySwimlaneData.cardinality;_&&_.swimlaneContainerWidth>0&&C({...L,swimlaneLimit:e})}),[JSON.stringify(L),null==D?void 0:D.showTopFieldValues]),void 0===_||void 0===S||void 0===(null==w?void 0:w.mlShowCharts)?null:Object(N.jsx)("div",{className:"ml-explorer"},Object(N.jsx)(Fb,{explorerState:_,setSelectedCells:A,showCharts:_.showCharts,severity:I.val,stoppedPartitions:p,invalidTimeRangeError:b,selectedJobsRunning:O,timeBuckets:g,timefilter:x}))},Rb=()=>{const{services:{docLinks:e}}=Object(f.b)(),t=e.links.ml.guide;return Object(N.jsx)(s.a.Fragment,null,Object(N.jsx)(cr.a,{tabId:"access-denied"}),Object(N.jsx)(te.EuiSpacer,{size:"xxl"}),Object(N.jsx)(te.EuiFlexGroup,{justifyContent:"spaceAround"},Object(N.jsx)(te.EuiFlexItem,{grow:!1},Object(N.jsx)(te.EuiPageContent,{verticalPosition:"center",horizontalPosition:"center",color:"danger"},Object(N.jsx)(te.EuiEmptyPrompt,{iconType:"alert",title:Object(N.jsx)("h2",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.management.jobsList.accessDeniedTitle",defaultMessage:"Access denied"})),body:Object(N.jsx)("p",null,Object(N.jsx)(ae.FormattedMessage,{id:"xpack.ml.accessDenied.description",defaultMessage:"You don’t have permission to view the Machine Learning plugin. Access to the plugin requires the Machine Learning feature to be visible in this space."}))})))),Object(N.jsx)(dr.a,{docLink:t}))},Pb=[{text:y.i18n.translate("xpack.ml.accessDeniedLabel",{defaultMessage:"Access denied"}),href:""}],Nb=()=>({path:"/access-denied",render:(e,t)=>Object(N.jsx)(zb,v()({},e,{deps:t})),breadcrumbs:Pb}),zb=({deps:e})=>{const{context:t}=F(void 0,void 0,e.config,{});return Object(N.jsx)(Vb,{context:t},Object(N.jsx)(Rb,null))};var Bb=a(64);const Jb=({path:e,children:t})=>Object(N.jsx)(Bb.TrackApplicationView,{viewId:e},t),Vb=({context:e,children:t})=>null===e?null:Object(N.jsx)(g.a.Provider,{value:e},t),Ub=({children:e})=>{const t=Object(h.useHistory)(),a=Object(h.useLocation)();return Object(n.useEffect)((()=>{a.hash.startsWith("#/")&&t.push(a.hash.replace("#",""))}),[a.hash]),Object(N.jsx)(s.a.Fragment,null,e)},Gb=({pageDeps:e})=>{const t=Object(f.e)(),{services:{http:{basePath:a}}}=Object(f.b)();return Object(N.jsx)(s.a.Fragment,null,Object.entries(i).map((([i,n])=>{const s=n(t,a.get());return Object(N.jsx)(h.Route,{key:i,path:s.path,exact:!0,render:t=>(window.setTimeout((()=>{e.setBreadcrumbs(s.breadcrumbs)})),Object(N.jsx)(Jb,{path:s.path},s.render(t,e)))})})))},qb=({pageDeps:e})=>Object(N.jsx)(h.Router,{history:e.history},Object(N.jsx)(Ub,null,Object(N.jsx)(j.a,null,Object(N.jsx)("div",{className:"ml-app","data-test-subj":"mlApp"},Object(N.jsx)(Gb,{pageDeps:e})))));var Hb=a(100);const Wb=new l.Storage(window.localStorage);function $b(e,t){const a=new Hb.a(e);return{httpService:a,mlApiServices:Object(ge.mlApiServicesProvider)(a),mlUsageCollection:b(t)}}const Yb=({coreStart:e,deps:t,appMountParams:a})=>{var i,n;const r={history:a.history,indexPatterns:t.data.indexPatterns,config:e.uiSettings,setBreadcrumbs:e.chrome.setBreadcrumbs,redirectToMlAccessDeniedPage:async()=>{const a=await t.share.url.locators.get(T.a).getUrl({page:T.b.ACCESS_DENIED});await e.application.navigateToUrl(a)}},o={kibanaVersion:t.kibanaVersion,share:t.share,data:t.data,security:t.security,licenseManagement:t.licenseManagement,storage:Wb,embeddable:t.embeddable,maps:t.maps,triggersActionsUi:t.triggersActionsUi,dataVisualizer:t.dataVisualizer,usageCollection:t.usageCollection,...e},l=e.i18n.Context,d=null!==(i=null===(n=t.usageCollection)||void 0===n?void 0:n.components.ApplicationUsageTrackingProvider)&&void 0!==i?i:s.a.Fragment;return Object(N.jsx)(c.RedirectAppLinks,{application:e.application},Object(N.jsx)(d,null,Object(N.jsx)(l,null,Object(N.jsx)(c.KibanaContextProvider,{services:{...o,mlServices:$b(e.http,t.usageCollection)}},Object(N.jsx)(qb,{pageDeps:r})))))},Xb=(e,t,a)=>{Object(d.m)({indexPatterns:t.data.indexPatterns,timefilter:t.data.query.timefilter,fieldFormats:t.data.fieldFormats,autocomplete:t.data.autocomplete,config:e.uiSettings,chrome:e.chrome,docLinks:e.docLinks,toastNotifications:e.notifications.toasts,overlays:e.overlays,recentlyAccessed:e.chrome.recentlyAccessed,basePath:e.http.basePath,savedObjectsClient:e.savedObjects.client,application:e.application,http:e.http,security:t.security,urlGenerators:t.share.urlGenerators,maps:t.maps,dataVisualizer:t.dataVisualizer,dataViews:t.data.dataViews}),a.onAppLeave((e=>e.default()));const i=Object(u.e)(t.licensing,[()=>o.a.render(Object(N.jsx)(Yb,{coreStart:e,deps:t,appMountParams:a}),a.element)]);return()=>{i.unsubscribe(),Object(d.a)(),o.a.unmountComponentAtNode(a.element)}}},function(e,t,a){"use strict";a.d(t,"b",(function(){return U})),a.d(t,"a",(function(){return G})),a.d(t,"c",(function(){return q})),a.d(t,"d",(function(){return W}));var i=a(15),n=a.n(i),s=a(2),r=a(41),o=a(40),l=a(75),c=a(94),d=a(72),u=a(261),p=a(362),m=a(353),b=a(66),h=a(67),f=a(73),g=a(17),j=a(70),x=a(11);let v;const y=({closeFlyout:e,item:t})=>{const{id:a,config:n}=t,{state:r}=t.stats,l=void 0!==n.allow_lazy_start?String(n.allow_lazy_start):"",[d,u]=Object(i.useState)(l),[p,m]=Object(i.useState)(n.description||""),[y,O]=Object(i.useState)(n.model_memory_limit),[E,w]=Object(i.useState)(),[_,S]=Object(i.useState)(n.max_num_threads),{services:{notifications:M}}=Object(b.b)(),{refresh:k}=Object(j.E)(),C=Object(f.c)(),T=void 0!==E||0===_;Object(i.useEffect)((()=>{if(void 0===v&&(v=Object(g.c)()),""!==y){const e=v(y);null!==e&&e.invalidUnits?w(s.i18n.translate("xpack.ml.dataframe.analytics.create.modelMemoryUnitsInvalidError",{defaultMessage:"Model memory limit data unit unrecognized. It must be {str}",values:{str:e.invalidUnits.allowedUnits}})):w(void 0)}else w(s.i18n.translate("xpack.ml.dataframe.analytics.create.modelMemoryEmptyError",{defaultMessage:"Model memory limit must not be empty"}))}),[y]);return Object(x.jsx)(o.EuiFlyout,{onClose:e,hideCloseButton:!0,"aria-labelledby":"analyticsEditFlyoutTitle","data-test-subj":"mlAnalyticsEditFlyout"},Object(x.jsx)(o.EuiFlyoutHeader,{hasBorder:!0},Object(x.jsx)(o.EuiTitle,{size:"m"},Object(x.jsx)("h2",{id:"analyticsEditFlyoutTitle"},s.i18n.translate("xpack.ml.dataframe.analyticsList.editFlyoutTitle",{defaultMessage:"Edit {jobId}",values:{jobId:a}})))),Object(x.jsx)(o.EuiFlyoutBody,null,Object(x.jsx)(o.EuiForm,null,Object(x.jsx)(o.EuiFormRow,{label:s.i18n.translate("xpack.ml.dataframe.analyticsList.editFlyout.allowLazyStartLabel",{defaultMessage:"Allow lazy start"})},Object(x.jsx)(o.EuiSelect,{"aria-label":s.i18n.translate("xpack.ml.dataframe.analyticsList.editFlyout.allowLazyStartAriaLabel",{defaultMessage:"Update allow lazy start."}),"data-test-subj":"mlAnalyticsEditFlyoutAllowLazyStartInput",options:[{value:"true",text:s.i18n.translate("xpack.ml.dataframe.analyticsList.editFlyout.allowLazyStartTrueValue",{defaultMessage:"True"})},{value:"false",text:s.i18n.translate("xpack.ml.dataframe.analyticsList.editFlyout.allowLazyStartFalseValue",{defaultMessage:"False"})}],value:d,onChange:e=>u(e.target.value)})),Object(x.jsx)(o.EuiFormRow,{label:s.i18n.translate("xpack.ml.dataframe.analyticsList.editFlyout.descriptionLabel",{defaultMessage:"Description"})},Object(x.jsx)(o.EuiFieldText,{"data-test-subj":"mlAnalyticsEditFlyoutDescriptionInput",value:p,onChange:e=>m(e.target.value),"aria-label":s.i18n.translate("xpack.ml.dataframe.analyticsList.editFlyout.descriptionAriaLabel",{defaultMessage:"Update the job description."})})),Object(x.jsx)(o.EuiFormRow,{helpText:r!==c.b.STOPPED&&s.i18n.translate("xpack.ml.dataframe.analyticsList.editFlyout.modelMemoryHelpText",{defaultMessage:"Model memory limit cannot be edited until the job has stopped."}),label:s.i18n.translate("xpack.ml.dataframe.analyticsList.editFlyout.modelMemoryLimitLabel",{defaultMessage:"Model memory limit"}),isInvalid:void 0!==E,error:E},Object(x.jsx)(o.EuiFieldText,{"data-test-subj":"mlAnalyticsEditFlyoutmodelMemoryLimitInput",isInvalid:void 0!==E,readOnly:r!==c.b.STOPPED,value:y,onChange:e=>O(e.target.value),"aria-label":s.i18n.translate("xpack.ml.dataframe.analyticsList.editFlyout.modelMemoryLimitAriaLabel",{defaultMessage:"Update the model memory limit."})})),Object(x.jsx)(o.EuiFormRow,{helpText:r!==c.b.STOPPED&&s.i18n.translate("xpack.ml.dataframe.analyticsList.editFlyout.maxNumThreadsHelpText",{defaultMessage:"Maximum number of threads cannot be edited until the job has stopped."}),label:s.i18n.translate("xpack.ml.dataframe.analyticsList.editFlyout.maxNumThreadsLabel",{defaultMessage:"Maximum number of threads"}),isInvalid:0===_,error:0===_&&s.i18n.translate("xpack.ml.dataframe.analyticsList.editFlyout.maxNumThreadsError",{defaultMessage:"The minimum value is 1."})},Object(x.jsx)(o.EuiFieldNumber,{"aria-label":s.i18n.translate("xpack.ml.dataframe.analyticsList.editFlyout.maxNumThreadsAriaLabel",{defaultMessage:"Update the maximum number of threads to be used by the analysis."}),"data-test-subj":"mlAnalyticsEditFlyoutMaxNumThreadsLimitInput",onChange:e=>S(""===e.target.value?void 0:+e.target.value),step:1,min:1,readOnly:r!==c.b.STOPPED,value:_})))),Object(x.jsx)(o.EuiFlyoutFooter,null,Object(x.jsx)(o.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(x.jsx)(o.EuiFlexItem,{grow:!1},Object(x.jsx)(o.EuiButtonEmpty,{iconType:"cross",onClick:e,flush:"left"},s.i18n.translate("xpack.ml.dataframe.analyticsList.editFlyoutCancelButtonText",{defaultMessage:"Cancel"}))),Object(x.jsx)(o.EuiFlexItem,{grow:!1},Object(x.jsx)(o.EuiButton,{"data-test-subj":"mlAnalyticsEditFlyoutUpdateButton",onClick:async()=>{const t=Object.assign({allow_lazy_start:d,description:p},y&&{model_memory_limit:y},_&&{max_num_threads:_});try{await h.ml.dataFrameAnalytics.updateDataFrameAnalytics(a,t),M.toasts.addSuccess(s.i18n.translate("xpack.ml.dataframe.analyticsList.editFlyoutSuccessMessage",{defaultMessage:"Analytics job {jobId} has been updated.",values:{jobId:a}})),k(),e()}catch(e){console.error(e),C.displayErrorToast(e,s.i18n.translate("xpack.ml.dataframe.analyticsList.editFlyoutErrorMessage",{defaultMessage:"Could not save changes to analytics job {jobId}",values:{jobId:a}}))}},fill:!0,isDisabled:T},s.i18n.translate("xpack.ml.dataframe.analyticsList.editFlyoutUpdateButtonText",{defaultMessage:"Update"}))))))},O=s.i18n.translate("xpack.ml.dataframe.analyticsList.editActionNameText",{defaultMessage:"Edit"}),E=({isDisabled:e})=>e?Object(x.jsx)(o.EuiToolTip,{position:"top",content:s.i18n.translate("xpack.ml.dataframe.analyticsList.editActionPermissionTooltip",{defaultMessage:"You do not have permission to edit analytics jobs."})},Object(x.jsx)(n.a.Fragment,null,O)):Object(x.jsx)(n.a.Fragment,null,O);var w=a(163);const _=s.i18n.translate("xpack.ml.dataframe.analyticsList.startActionNameText",{defaultMessage:"Start"}),S=({canStartStopDataFrameAnalytics:e,isDisabled:t,item:a})=>t?Object(x.jsx)(o.EuiToolTip,{position:"top",content:e?s.i18n.translate("xpack.ml.dataframe.analyticsList.completeBatchAnalyticsToolTip",{defaultMessage:"{analyticsId} is a completed analytics job and cannot be restarted.",values:{analyticsId:a.config.id}}):Object(d.f)("canStartStopDataFrameAnalytics")},Object(x.jsx)(n.a.Fragment,null,_)):Object(x.jsx)(n.a.Fragment,null,_),M=({closeModal:e,item:t,startAndCloseModal:a})=>Object(x.jsx)(n.a.Fragment,null,void 0!==t&&Object(x.jsx)(o.EuiConfirmModal,{title:s.i18n.translate("xpack.ml.dataframe.analyticsList.startModalTitle",{defaultMessage:"Start {analyticsId}?",values:{analyticsId:t.config.id}}),onCancel:e,onConfirm:a,cancelButtonText:s.i18n.translate("xpack.ml.dataframe.analyticsList.startModalCancelButton",{defaultMessage:"Cancel"}),confirmButtonText:s.i18n.translate("xpack.ml.dataframe.analyticsList.startModalStartButton",{defaultMessage:"Start"}),defaultFocusedButton:o.EUI_MODAL_CONFIRM_BUTTON,buttonColor:"primary"},Object(x.jsx)("p",null,s.i18n.translate("xpack.ml.dataframe.analyticsList.startModalBody",{defaultMessage:"A data frame analytics job increases search and indexing load in your cluster. If excessive load occurs, stop the job."})))),k=s.i18n.translate("xpack.ml.dataframe.analyticsList.stopActionNameText",{defaultMessage:"Stop"}),C=({isDisabled:e})=>e?Object(x.jsx)(o.EuiToolTip,{position:"top",content:Object(d.f)("canStartStopDataFrameAnalytics")},Object(x.jsx)(n.a.Fragment,null,k)):Object(x.jsx)(n.a.Fragment,null,k),T=({closeModal:e,item:t,forceStopAndCloseModal:a})=>Object(x.jsx)(n.a.Fragment,null,void 0!==t&&Object(x.jsx)(o.EuiConfirmModal,{title:s.i18n.translate("xpack.ml.dataframe.analyticsList.forceStopModalTitle",{defaultMessage:"Force this job to stop?"}),onCancel:e,onConfirm:a,cancelButtonText:s.i18n.translate("xpack.ml.dataframe.analyticsList.forceStopModalCancelButton",{defaultMessage:"Cancel"}),confirmButtonText:s.i18n.translate("xpack.ml.dataframe.analyticsList.forceStopModalStartButton",{defaultMessage:"Force stop"}),defaultFocusedButton:o.EUI_MODAL_CONFIRM_BUTTON,buttonColor:"primary"},Object(x.jsx)("p",null,Object(x.jsx)(r.FormattedMessage,{id:"xpack.ml.dataframe.analyticsList.forceStopModalBody",defaultMessage:"{analyticsId} is in a failed state. You must stop the job and fix the failure.",values:{analyticsId:t.config.id}}))));var F=a(179);const I=s.i18n.translate("xpack.ml.dataframe.analyticsList.viewActionName",{defaultMessage:"View"}),D=({item:e})=>{const{disabled:t,tooltipContent:a}=Object(F.a)(e);return t?Object(x.jsx)(o.EuiToolTip,{position:"top",content:a},Object(x.jsx)(n.a.Fragment,null,I)):Object(x.jsx)(n.a.Fragment,null,I)};var A=a(0);const L=()=>{const e=Object(b.d)(),t=Object(b.e)(),a=Object(i.useCallback)((a=>{const i=Object(j.m)(a.config.analysis);(async(a,i)=>{const n=await e.getUrl({page:A.b.DATA_FRAME_ANALYTICS_EXPLORATION,pageState:{jobId:a,analysisType:i}});await t(n,!1)})(a.id,i)}),[]);return{action:Object(i.useMemo)((()=>({isPrimary:!0,name:e=>Object(x.jsx)(D,{item:e}),enabled:e=>!Object(F.a)(e).disabled,description:I,icon:"visTable",type:"icon",onClick:a,"data-test-subj":"mlAnalyticsJobViewButton"})),[a])}},R=s.i18n.translate("xpack.ml.dataframe.analyticsList.mapActionName",{defaultMessage:"Map"}),P=({item:e})=>{if(!Object(j.y)(e.config.analysis)&&!Object(j.x)(e.config.analysis)&&!Object(j.v)(e.config.analysis)){const e=s.i18n.translate("xpack.ml.dataframe.analyticsList.mapActionDisabledTooltipContent",{defaultMessage:"Unknown analysis type."});return Object(x.jsx)(o.EuiToolTip,{position:"top",content:e},Object(x.jsx)(n.a.Fragment,null,R))}return Object(x.jsx)(n.a.Fragment,null,R)};var N=a(8),z=a(81);const B=e=>{const t=Object(d.e)("canCreateDataFrameAnalytics"),a=Object(d.e)("canDeleteDataFrameAnalytics"),s=Object(d.e)("canStartStopDataFrameAnalytics"),r=L(),o=(()=>{const e=Object(b.d)(),t=Object(b.e)(),[a]=Object(z.c)("_g"),n=Object(i.useCallback)((async i=>{const n=Object(N.cloneDeep)(a||{});delete n.ml;const s=await e.getUrl({page:A.b.DATA_FRAME_ANALYTICS_MAP,pageState:{jobId:i.id,globalState:n}});await t(s,!1)}),[a]);return{action:Object(i.useMemo)((()=>({isPrimary:!0,name:e=>Object(x.jsx)(P,{item:e}),enabled:e=>!Object(F.a)(e).disabled,description:R,icon:"graphApp",type:"icon",onClick:n,"data-test-subj":"mlAnalyticsJobMapButton"})),[n])}})(),l=Object(p.c)(t),h=Object(m.b)(a),g=(e=>{const[t,a]=Object(i.useState)(),[n,s]=Object(i.useState)(!1),r=e=>{a(e),s(!0)};return{action:Object(i.useMemo)((()=>({name:()=>Object(x.jsx)(E,{isDisabled:!e}),enabled:()=>e,description:O,icon:"pencil",type:"icon",onClick:e=>r(e),"data-test-subj":"mlAnalyticsJobEditButton"})),[e]),isFlyoutVisible:n,item:t,closeFlyout:()=>s(!1),openFlyout:r}})(s),v=(e=>{const[t,a]=Object(i.useState)(!1),[n,s]=Object(i.useState)(),r=Object(f.c)(),o=e=>{s(e),a(!0)},l=t=>{if(!Object(c.g)(t.stats.state)){const a=Object(c.e)(t.stats);return e&&!a}return e};return{action:Object(i.useMemo)((()=>({name:t=>Object(x.jsx)(S,{isDisabled:!l(t),item:t,canStartStopDataFrameAnalytics:e}),available:e=>!Object(c.g)(e.stats.state)&&!Object(c.f)(e.stats.state),enabled:l,description:_,icon:"play",type:"icon",onClick:o,"data-test-subj":"mlAnalyticsJobStartButton"})),[]),closeModal:()=>a(!1),isModalVisible:t,item:n,openModal:o,startAndCloseModal:()=>{void 0!==n&&(a(!1),Object(w.e)(n,r))}}})(s),I=(e=>{const[t,a]=Object(i.useState)(!1),[n,s]=Object(i.useState)(),r=e=>{s(e),a(!0)},o=Object(i.useCallback)((t=>{e&&(Object(c.f)(t.stats.state)?r(t):Object(w.f)(t))}),[w.f]);return{action:Object(i.useMemo)((()=>({name:()=>Object(x.jsx)(C,{isDisabled:!e}),available:e=>Object(c.g)(e.stats.state)||Object(c.f)(e.stats.state),enabled:()=>e,description:k,icon:"stop",type:"icon",onClick:o,"data-test-subj":"mlAnalyticsJobStopButton"})),[o]),closeModal:()=>a(!1),isModalVisible:t,item:n,openModal:r,forceStopAndCloseModal:()=>{void 0!==n&&(a(!1),Object(w.f)(n))}}})(s),{refresh:D}=Object(j.E)();let B=null;const J=[r.action,o.action];var V;!1===e&&(B=Object(x.jsx)(n.a.Fragment,null,v.isModalVisible&&Object(x.jsx)(M,v),I.isModalVisible&&Object(x.jsx)(T,I),h.isDeleteJobCheckModalVisible&&(null==h||null===(V=h.item)||void 0===V?void 0:V.config)&&Object(x.jsx)(u.a,{onCloseCallback:h.closeDeleteJobCheckModal,canDeleteCallback:()=>{h.openModal(h.item),h.closeDeleteJobCheckModal()},refreshJobsCallback:D,jobType:h.jobType,jobIds:[h.item.config.id]}),h.isModalVisible&&Object(x.jsx)(m.a,h),(e=>!0===e.isFlyoutVisible&&void 0!==e.item)(g)&&Object(x.jsx)(y,g)),J.push(v.action,I.action,g.action,l.action,h.action));return{actions:J,modals:B}};var J,V=a(357);!function(e){e.analyzing="primary",e.failed="danger",e.reindexing="primary",e.started="primary",e.starting="primary",e.stopped="hollow"}(J||(J={}));const U=(e,t)=>{const a=J[e];return Object(c.f)(e)&&void 0!==t?Object(x.jsx)(o.EuiToolTip,{content:t},Object(x.jsx)(o.EuiBadge,{className:"mlTaskStateBadge",color:a},e)):Object(x.jsx)(o.EuiBadge,{className:"mlTaskStateBadge",color:a},e)},G=e=>Object(x.jsx)(o.EuiBadge,{className:"mlTaskStateBadge",color:"hollow"},e),q={name:s.i18n.translate("xpack.ml.dataframe.analyticsList.progress",{defaultMessage:"Progress"}),truncateText:!0,render(e){const{currentPhase:t,progress:a,totalPhases:n}=Object(c.d)(e.stats);return Object(x.jsx)(o.EuiFlexGroup,{alignItems:"center",gutterSize:"xs"},Object(x.jsx)(i.Fragment,null,Object(x.jsx)(o.EuiFlexItem,{style:{width:"60px"},grow:!1},Object(x.jsx)(o.EuiText,{size:"xs"},"Phase ",t,"/",n)),Object(x.jsx)(o.EuiFlexItem,{style:{width:"40px"},grow:!1},Object(x.jsx)(o.EuiToolTip,{content:s.i18n.translate("xpack.ml.dataframe.analyticsList.progressOfPhase",{defaultMessage:"Progress of phase {currentPhase}: {progress}%",values:{currentPhase:t,progress:a}})},Object(x.jsx)(o.EuiProgress,{value:a,max:100,color:"primary",size:"m","data-test-subj":"mlAnalyticsTableProgress"})))),!1)},width:"130px","data-test-subj":"mlAnalyticsTableColumnProgress"},H=({jobId:e})=>{const t=Object(b.c)({page:A.b.DATA_FRAME_ANALYTICS_JOBS_MANAGE,pageState:{jobId:e}});return Object(x.jsx)(o.EuiLink,{href:t},e)},W=(e,t,a=!1,i=!0,n,d=(()=>{}))=>{const{actions:u,modals:p}=B(a);const m=[{name:Object(x.jsx)(o.EuiScreenReaderOnly,null,Object(x.jsx)("p",null,Object(x.jsx)(r.FormattedMessage,{id:"xpack.ml.dataframe.analyticsList.showDetailsColumn.screenReaderDescription",defaultMessage:"This column contains clickable controls for showing more details on each job"}))),align:o.RIGHT_ALIGNMENT,width:"40px",isExpander:!0,render:a=>Object(x.jsx)(o.EuiButtonIcon,{onClick:()=>function(a){const i=e.indexOf(a.config.id);-1!==i?(e.splice(i,1),t([...e])):e.push(a.config.id),t([...e])}(a),"aria-label":e.includes(a.config.id)?s.i18n.translate("xpack.ml.dataframe.analyticsList.rowCollapse",{defaultMessage:"Hide details for {analyticsId}",values:{analyticsId:a.config.id}}):s.i18n.translate("xpack.ml.dataframe.analyticsList.rowExpand",{defaultMessage:"Show details for {analyticsId}",values:{analyticsId:a.config.id}}),iconType:e.includes(a.config.id)?"arrowUp":"arrowDown"}),"data-test-subj":"mlAnalyticsTableRowDetailsToggle"},{field:c.c.id,name:s.i18n.translate("xpack.ml.dataframe.analyticsList.id",{defaultMessage:"ID"}),sortable:e=>e.id,truncateText:!0,"data-test-subj":"mlAnalyticsTableColumnId",scope:"row",render:e=>a?Object(x.jsx)(H,{jobId:e}):e},{field:c.c.description,name:s.i18n.translate("xpack.ml.dataframe.analyticsList.description",{defaultMessage:"Description"}),sortable:!0,truncateText:!0,"data-test-subj":"mlAnalyticsTableColumnJobDescription"},{field:c.c.memoryStatus,name:s.i18n.translate("xpack.ml.dataframe.analyticsList.memoryStatus",{defaultMessage:"Memory status"}),truncateText:!0,"data-test-subj":"mlAnalyticsTableColumnJobMemoryStatus"},{field:c.c.configSourceIndex,name:s.i18n.translate("xpack.ml.dataframe.analyticsList.sourceIndex",{defaultMessage:"Source index"}),sortable:!0,truncateText:!0,"data-test-subj":"mlAnalyticsTableColumnSourceIndex"},{field:c.c.configDestIndex,name:s.i18n.translate("xpack.ml.dataframe.analyticsList.destinationIndex",{defaultMessage:"Destination index"}),sortable:!0,truncateText:!0,"data-test-subj":"mlAnalyticsTableColumnDestIndex"},{name:s.i18n.translate("xpack.ml.dataframe.analyticsList.type",{defaultMessage:"Type"}),sortable:e=>Object(l.h)(e.config.analysis),truncateText:!0,render:e=>G(Object(l.h)(e.config.analysis)),width:"150px","data-test-subj":"mlAnalyticsTableColumnType"},{name:s.i18n.translate("xpack.ml.dataframe.analyticsList.status",{defaultMessage:"Status"}),sortable:e=>e.stats.state,truncateText:!0,render:e=>U(e.stats.state,e.stats.failure_reason),width:"100px","data-test-subj":"mlAnalyticsTableColumnStatus"},q,{name:s.i18n.translate("xpack.ml.dataframe.analyticsList.tableActionLabel",{defaultMessage:"Actions"}),actions:u,width:!0===a?"100px":"150px","data-test-subj":"mlAnalyticsTableColumnActions"}];return!0===a&&(n&&m.splice(m.length-1,0,{name:s.i18n.translate("xpack.ml.jobsList.analyticsSpacesLabel",{defaultMessage:"Spaces"}),render:e=>{var t;return Array.isArray(e.spaceIds)?Object(x.jsx)(V.a,{spacesApi:n,spaceIds:null!==(t=e.spaceIds)&&void 0!==t?t:[],jobId:e.id,jobType:"data-frame-analytics",refresh:d}):null},width:"90px","data-test-subj":"mlAnalyticsTableColumnSpaces"}),!1===i&&m.pop()),{columns:m,modals:p}}},function(e,t,a){"use strict";a.d(t,"b",(function(){return ye})),a.d(t,"a",(function(){return Oe}));var i=a(15),n=a.n(i),s=a(41),r=a(40),o=a(46),l=a(81),c=a(98),d=a(190),u=a(349),p=a(66),m=a(155),b=a(75);const h=e=>{const{services:t}=Object(p.b)(),[a]=Object(l.c)("_g"),{timefilter:n}=t.data.query.timefilter,{refresh:s}=Object(b.w)();Object(i.useEffect)((()=>{let t=null;const i=n.getRefreshIntervalUpdate$().subscribe(r);function r(){const{value:a,pause:i}=n.getRefreshInterval();i?o():function(a){if(o(),a>=m.c){e(!1);const i=window.setInterval((()=>{s()}),a);t=i}}(a),s()}function o(){e(!0),null!==t&&window.clearInterval(t)}return n.disableTimeRangeSelector(),n.enableAutoRefreshSelector(),function(){var e;const t=null!==(e=null==a?void 0:a.refreshInterval)&&void 0!==e?e:n.getRefreshInterval(),{value:i}=t;0===i&&n.setRefreshInterval({pause:!1,value:m.a});r()}(),()=>{i.unsubscribe(),o()}}),[])};var f=a(355),g=a(257),j=a(258),x=a(259),v=a(2),y=a(11);const O=({jobId:e,modelId:t,selectedTabId:a})=>{const n=Object(p.e)(),s=Object(i.useMemo)((()=>{const a=[{id:"data_frame_analytics",name:v.i18n.translate("xpack.ml.dataframe.jobsTabLabel",{defaultMessage:"Jobs"}),path:"/data_frame_analytics",testSubj:"mlAnalyticsJobsTab"},{id:"models",name:v.i18n.translate("xpack.ml.dataframe.modelsTabLabel",{defaultMessage:"Models"}),path:"/data_frame_analytics/models",testSubj:"mlTrainedModelsTab"}];return void 0===e&&void 0===t||a.push({id:"map",name:v.i18n.translate("xpack.ml.dataframe.mapTabLabel",{defaultMessage:"Map"}),path:"/data_frame_analytics/map",testSubj:""}),a}),[void 0!==e]),o=Object(i.useCallback)((async e=>{await n(e.path,!0)}),[n]);return Object(y.jsx)(r.EuiTabs,null,s.map((e=>Object(y.jsx)(r.EuiTab,{key:`tab-${e.id}`,isSelected:e.id===a,onClick:o.bind(null,e),"data-test-subj":e.testSubj},e.name))))};var E=a(164),w=a(201);const _=({models:e,onClose:t})=>{const a=e.filter((e=>!!e.pipelines)).map((e=>e.model_id));return Object(y.jsx)(r.EuiModal,{onClose:t.bind(null,!1),initialFocus:"[name=cancelModelDeletion]","data-test-subj":"mlModelsDeleteModal"},Object(y.jsx)(r.EuiModalHeader,null,Object(y.jsx)(r.EuiModalHeaderTitle,null,Object(y.jsx)(s.FormattedMessage,{id:"xpack.ml.trainedModels.modelsList.deleteModal.header",defaultMessage:"Delete {modelsCount, plural, one {{modelId}} other {# models}}?",values:{modelId:e[0].model_id,modelsCount:e.length}}))),Object(y.jsx)(r.EuiModalBody,null,a.length>0&&Object(y.jsx)(r.EuiCallOut,{"data-test-subj":"modelsWithPipelinesWarning",color:"danger",iconType:"alert",size:"s"},Object(y.jsx)(s.FormattedMessage,{id:"xpack.ml.trainedModels.modelsList.deleteModal.modelsWithPipelinesWarningMessage",defaultMessage:"{modelsWithPipelinesCount, plural, one{Model} other {Models}} {modelsWithPipelines} {modelsWithPipelinesCount, plural, one{has} other {have}} associated pipelines!",values:{modelsWithPipelinesCount:a.length,modelsWithPipelines:a.join(", ")}}))),Object(y.jsx)(r.EuiModalFooter,null,Object(y.jsx)(r.EuiButtonEmpty,{onClick:t.bind(null,!1),name:"cancelModelDeletion"},Object(y.jsx)(s.FormattedMessage,{id:"xpack.ml.trainedModels.modelsList.deleteModal.cancelButtonLabel",defaultMessage:"Cancel"})),Object(y.jsx)(r.EuiButton,{onClick:t.bind(null,!0),fill:!0,color:"danger","data-test-subj":"mlModelsDeleteModalConfirmButton"},Object(y.jsx)(s.FormattedMessage,{id:"xpack.ml.trainedModels.modelsList.deleteModal.deleteButtonLabel",defaultMessage:"Delete"}))))};var S=a(76),M=a(120),k=a(16);const C={tags:e=>{if(0!==e.length)return Object(y.jsx)("div",null,e.map((e=>Object(y.jsx)(r.EuiBadge,{key:e,color:"hollow"},e))))},create_time:S.d,timestamp:S.d},T=({item:e})=>{var t,a;const{inference_config:o,stats:l,metadata:c,tags:d,version:u,estimated_operations:m,estimated_heap_memory_usage_bytes:b,default_field_map:h,license_level:f,pipelines:g,description:j}=e,{analytics_config:x,...v}=null!=c?c:{},O={description:j,tags:d,version:u,estimated_operations:m,estimated_heap_memory_usage_bytes:b,default_field_map:h,license_level:f};function E(e){return Object.entries(e).filter((([,e])=>Object(M.a)(e))).map((([e,t])=>e in C?{title:e,description:C[e](t)}:{title:e,description:"object"==typeof t?Object(y.jsx)(r.EuiCodeBlock,{language:"json",fontSize:"s",paddingSize:"s",overflowHeight:300,isCopyable:!1},JSON.stringify(t,null,2)):t.toString()}))}const{services:{share:w}}=Object(p.b)(),_=[{id:"details",name:Object(y.jsx)(s.FormattedMessage,{id:"xpack.ml.trainedModels.modelsList.expandedRow.detailsTabLabel",defaultMessage:"Details"}),content:Object(y.jsx)(n.a.Fragment,null,Object(y.jsx)(r.EuiSpacer,{size:"m"}),Object(y.jsx)(r.EuiFlexGrid,{columns:2,gutterSize:"m"},Object(y.jsx)(r.EuiFlexItem,null,Object(y.jsx)(r.EuiPanel,null,Object(y.jsx)(r.EuiTitle,{size:"xs"},Object(y.jsx)("h5",null,Object(y.jsx)(s.FormattedMessage,{id:"xpack.ml.trainedModels.modelsList.expandedRow.detailsTitle",defaultMessage:"Details"}))),Object(y.jsx)(r.EuiSpacer,{size:"m"}),Object(y.jsx)(r.EuiDescriptionList,{compressed:!0,type:"column",listItems:E(O)}))),Object(k.isPopulatedObject)(v)?Object(y.jsx)(r.EuiFlexItem,null,Object(y.jsx)(r.EuiPanel,null,Object(y.jsx)(r.EuiTitle,{size:"xs"},Object(y.jsx)("h5",null,Object(y.jsx)(s.FormattedMessage,{id:"xpack.ml.trainedModels.modelsList.expandedRow.metadataTitle",defaultMessage:"Metadata"}))),Object(y.jsx)(r.EuiSpacer,{size:"m"}),Object(y.jsx)(r.EuiDescriptionList,{compressed:!0,type:"column",listItems:E(v)}))):null))},...o?[{id:"config",name:Object(y.jsx)(s.FormattedMessage,{id:"xpack.ml.trainedModels.modelsList.expandedRow.configTabLabel",defaultMessage:"Config"}),content:Object(y.jsx)(n.a.Fragment,null,Object(y.jsx)(r.EuiSpacer,{size:"m"}),Object(y.jsx)(r.EuiFlexGrid,{columns:2,gutterSize:"m"},Object(y.jsx)(r.EuiFlexItem,null,Object(y.jsx)(r.EuiPanel,null,Object(y.jsx)(r.EuiTitle,{size:"xs"},Object(y.jsx)("h5",null,Object(y.jsx)(s.FormattedMessage,{id:"xpack.ml.trainedModels.modelsList.expandedRow.inferenceConfigTitle",defaultMessage:"Inference configuration"}))),Object(y.jsx)(r.EuiSpacer,{size:"m"}),Object(y.jsx)(r.EuiDescriptionList,{compressed:!0,type:"column",listItems:E(o[Object.keys(o)[0]])}))),x&&Object(y.jsx)(r.EuiFlexItem,null,Object(y.jsx)(r.EuiPanel,null,Object(y.jsx)(r.EuiTitle,{size:"xs"},Object(y.jsx)("h5",null,Object(y.jsx)(s.FormattedMessage,{id:"xpack.ml.trainedModels.modelsList.expandedRow.analyticsConfigTitle",defaultMessage:"Analytics configuration"}))),Object(y.jsx)(r.EuiSpacer,{size:"m"}),Object(y.jsx)(r.EuiDescriptionList,{compressed:!0,type:"column",listItems:E(x)})))))}]:[],{id:"stats",name:Object(y.jsx)(s.FormattedMessage,{id:"xpack.ml.trainedModels.modelsList.expandedRow.statsTabLabel",defaultMessage:"Stats"}),content:Object(y.jsx)(n.a.Fragment,null,Object(y.jsx)(r.EuiSpacer,{size:"m"}),Object(y.jsx)(r.EuiFlexGrid,{columns:2},l.inference_stats&&Object(y.jsx)(r.EuiFlexItem,null,Object(y.jsx)(r.EuiPanel,null,Object(y.jsx)(r.EuiTitle,{size:"xs"},Object(y.jsx)("h5",null,Object(y.jsx)(s.FormattedMessage,{id:"xpack.ml.trainedModels.modelsList.expandedRow.inferenceStatsTitle",defaultMessage:"Inference stats"}))),Object(y.jsx)(r.EuiSpacer,{size:"m"}),Object(y.jsx)(r.EuiDescriptionList,{compressed:!0,type:"column",listItems:E(l.inference_stats)}))),(null===(t=l.ingest)||void 0===t?void 0:t.total)&&Object(y.jsx)(r.EuiFlexItem,null,Object(y.jsx)(r.EuiPanel,{style:{maxHeight:"400px",overflow:"auto"}},Object(y.jsx)(r.EuiTitle,{size:"xs"},Object(y.jsx)("h5",null,Object(y.jsx)(s.FormattedMessage,{id:"xpack.ml.trainedModels.modelsList.expandedRow.ingestStatsTitle",defaultMessage:"Ingest stats"}))),Object(y.jsx)(r.EuiSpacer,{size:"m"}),Object(y.jsx)(r.EuiDescriptionList,{compressed:!0,type:"column",listItems:E(l.ingest.total)}),(null===(a=l.ingest)||void 0===a?void 0:a.pipelines)&&Object(y.jsx)(n.a.Fragment,null,Object(y.jsx)(r.EuiSpacer,{size:"m"}),Object(y.jsx)(r.EuiTitle,{size:"xs"},Object(y.jsx)("h5",null,Object(y.jsx)(s.FormattedMessage,{id:"xpack.ml.trainedModels.modelsList.expandedRow.byPipelineTitle",defaultMessage:"By pipeline"}))),Object(y.jsx)(r.EuiSpacer,{size:"s"}),Object.entries(l.ingest.pipelines).map((([e,{processors:t,...a}],o)=>Object(y.jsx)(i.Fragment,{key:e},Object(y.jsx)(r.EuiFlexGroup,null,Object(y.jsx)(r.EuiFlexItem,{grow:!1},Object(y.jsx)(r.EuiTitle,{size:"xs"},Object(y.jsx)(r.EuiTextColor,{color:"subdued"},Object(y.jsx)("h5",null,o+1,". ",e)))),Object(y.jsx)(r.EuiFlexItem,null,Object(y.jsx)(r.EuiHorizontalRule,{size:"full",margin:"s"}))),Object(y.jsx)(r.EuiSpacer,{size:"m"}),Object(y.jsx)(r.EuiDescriptionList,{compressed:!0,type:"column",listItems:E(a)}),Object(y.jsx)(r.EuiSpacer,{size:"m"}),Object(y.jsx)(r.EuiTitle,{size:"xxs"},Object(y.jsx)("h6",null,Object(y.jsx)(s.FormattedMessage,{id:"xpack.ml.trainedModels.modelsList.expandedRow.byProcessorTitle",defaultMessage:"By processor"}))),Object(y.jsx)(r.EuiSpacer,{size:"s"}),Object(y.jsx)(n.a.Fragment,null,t.map((e=>{const t=Object.keys(e)[0],{stats:a}=e[t];return Object(y.jsx)(i.Fragment,{key:t},Object(y.jsx)(r.EuiFlexGroup,null,Object(y.jsx)(r.EuiFlexItem,{grow:!1},Object(y.jsx)(r.EuiTitle,{size:"xxs"},Object(y.jsx)(r.EuiTextColor,{color:"subdued"},Object(y.jsx)("h6",null,t)))),Object(y.jsx)(r.EuiFlexItem,null,Object(y.jsx)(r.EuiHorizontalRule,{size:"full",margin:"s"}))),Object(y.jsx)(r.EuiSpacer,{size:"m"}),Object(y.jsx)(r.EuiDescriptionList,{compressed:!0,type:"column",listItems:E(a)}))})))))))))))},...g&&Object.keys(g).length>0?[{id:"pipelines",name:Object(y.jsx)(n.a.Fragment,null,Object(y.jsx)(s.FormattedMessage,{id:"xpack.ml.trainedModels.modelsList.expandedRow.pipelinesTabLabel",defaultMessage:"Pipelines"})," ",Object(y.jsx)(r.EuiNotificationBadge,null,l.pipeline_count)),content:Object(y.jsx)(n.a.Fragment,null,Object(y.jsx)(r.EuiSpacer,{size:"m"}),Object(y.jsx)(r.EuiFlexGrid,{columns:2,gutterSize:"m"},Object.entries(g).map((([e,{processors:t,description:a}])=>Object(y.jsx)(r.EuiFlexItem,{key:e},Object(y.jsx)(r.EuiPanel,null,Object(y.jsx)(r.EuiFlexGroup,{alignItems:"center",justifyContent:"spaceBetween"},Object(y.jsx)(r.EuiFlexItem,{grow:!1},Object(y.jsx)(r.EuiTitle,{size:"xs"},Object(y.jsx)("h5",null,e))),Object(y.jsx)(r.EuiFlexItem,{grow:!1},Object(y.jsx)(r.EuiButtonEmpty,{onClick:()=>{const t=w.url.locators.get("INGEST_PIPELINES_APP_LOCATOR");t&&t.navigate({page:"pipeline_edit",pipelineId:e,absolute:!0})}},Object(y.jsx)(s.FormattedMessage,{id:"xpack.ml.trainedModels.modelsList.expandedRow.editPipelineLabel",defaultMessage:"Edit"})))),a&&Object(y.jsx)(r.EuiText,null,a),Object(y.jsx)(r.EuiSpacer,{size:"m"}),Object(y.jsx)(r.EuiTitle,{size:"xxs"},Object(y.jsx)("h6",null,Object(y.jsx)(s.FormattedMessage,{id:"xpack.ml.trainedModels.modelsList.expandedRow.processorsTitle",defaultMessage:"Processors"}))),Object(y.jsx)(r.EuiCodeBlock,{language:"json",fontSize:"m",paddingSize:"m",overflowHeight:300,isCopyable:!0},JSON.stringify(t,null,2))))))))}]:[]];return Object(y.jsx)(r.EuiTabbedContent,{size:"s",style:{width:"100%"},tabs:_,initialSelectedTab:_[0],autoFocus:"selected",onTabClick:e=>{}})};var F=a(0),I=a(82),D=a(287);const A=v.i18n.translate("xpack.ml.trainedModels.modelsList.builtInModelLabel",{defaultMessage:"built-in"}),L=()=>{var e;const{services:{application:{navigateToUrl:t,capabilities:a}}}=Object(p.b)(),o=Object(p.d)(),[c,d]=Object(l.b)(F.b.DATA_FRAME_ANALYTICS_MODELS_MANAGE,{pageIndex:0,pageSize:10,sortField:R.id,sortDirection:"asc"}),u=null!==(e=c.queryText)&&void 0!==e?e:"",m=a.ml.canDeleteDataFrameAnalytics,h=Object(w.a)(),{toasts:f}=Object(p.f)(),[g,j]=Object(i.useState)(!1),[x,O]=Object(i.useState)([]),[M,C]=Object(i.useState)([]),[L,P]=Object(i.useState)([]),[N,z]=Object(i.useState)({}),B=Object(p.e)(),J=Object(i.useCallback)((e=>e.tags.includes(I.b)),[]),V=Object(i.useCallback)((async()=>{try{const e=await h.getTrainedModels(void 0,{with_pipelines:!0,size:1e3}),t=[],a=[];for(const i of e){const e={...i,..."object"==typeof i.inference_config?{type:[...Object.keys(i.inference_config),...J(i)?[A]:[]]}:{}};t.push(e),N[i.model_id]&&a.push(e)}O(t),a.length>0&&(await G(a),z(a.reduce(((e,t)=>(e[t.model_id]=Object(y.jsx)(T,{item:t}),e)),{})))}catch(t){var e;f.addError(new Error(null===(e=t.body)||void 0===e?void 0:e.message),{title:v.i18n.translate("xpack.ml.trainedModels.modelsList.fetchFailedErrorMessage",{defaultMessage:"Models fetch failed"})})}j(!1),b.u.next(b.e.IDLE)}),[N]);Object(b.w)({isLoading:j,onRefresh:V});const U=Object(i.useMemo)((()=>({total:{show:!0,value:x.length,label:v.i18n.translate("xpack.ml.trainedModels.modelsList.totalAmountLabel",{defaultMessage:"Total trained models"})}})),[x]),G=Object(i.useCallback)((async e=>{const t=e.map((e=>e.model_id));try{const{trained_model_stats:a}=await h.getTrainedModelStats(t);for(const{model_id:t,...i}of a){e.find((e=>e.model_id===t)).stats=i}return!0}catch(e){f.addError(new Error(e.body.message),{title:v.i18n.translate("xpack.ml.trainedModels.modelsList.fetchModelStatsErrorMessage",{defaultMessage:"Fetch model stats failed"})})}}),[]),q=Object(i.useMemo)((()=>[...x.reduce(((e,t)=>{const a=t.inference_config&&Object.keys(t.inference_config)[0];return a&&e.add(a),e}),new Set)].map((e=>({value:e,name:e})))),[x]);async function H(e){await G(e)?P(e):f.addDanger(v.i18n.translate("xpack.ml.trainedModels.modelsList.unableToDeleteModelsErrorMessage",{defaultMessage:"Unable to delete models"}))}const W=[{name:v.i18n.translate("xpack.ml.trainedModels.modelsList.viewTrainingDataActionLabel",{defaultMessage:"View training data"}),description:v.i18n.translate("xpack.ml.trainedModels.modelsList.viewTrainingDataActionLabel",{defaultMessage:"View training data"}),icon:"visTable",type:"icon",available:e=>{var t,a;return!(null===(t=e.metadata)||void 0===t||null===(a=t.analytics_config)||void 0===a||!a.id)},onClick:async e=>{var a,i,n,s;if(void 0===(null===(a=e.metadata)||void 0===a?void 0:a.analytics_config))return;const r=Object(b.h)(null===(i=e.metadata)||void 0===i?void 0:i.analytics_config.analysis),l=await o.getUrl({page:F.b.DATA_FRAME_ANALYTICS_EXPLORATION,pageState:{jobId:null===(n=e.metadata)||void 0===n?void 0:n.analytics_config.id,analysisType:r,..."classification"===r||"regression"===r?{queryText:`${null===(s=e.metadata)||void 0===s?void 0:s.analytics_config.dest.results_field}.is_training : true`}:{}}});await t(l)},isPrimary:!0},{name:v.i18n.translate("xpack.ml.inference.modelsList.analyticsMapActionLabel",{defaultMessage:"Analytics map"}),description:v.i18n.translate("xpack.ml.inference.modelsList.analyticsMapActionLabel",{defaultMessage:"Analytics map"}),icon:"graphApp",type:"icon",isPrimary:!0,available:e=>{var t,a;return!(null===(t=e.metadata)||void 0===t||null===(a=t.analytics_config)||void 0===a||!a.id)},onClick:async e=>{const t=await o.getUrl({page:F.b.DATA_FRAME_ANALYTICS_MAP,pageState:{modelId:e.model_id}});await B(t,!1)}},{name:v.i18n.translate("xpack.ml.trainedModels.modelsList.deleteModelActionLabel",{defaultMessage:"Delete model"}),description:v.i18n.translate("xpack.ml.trainedModels.modelsList.deleteModelActionLabel",{defaultMessage:"Delete model"}),"data-test-subj":"mlModelsTableRowDeleteAction",icon:"trash",type:"icon",color:"danger",isPrimary:!1,onClick:async e=>{await H([e])},available:e=>m&&!J(e),enabled:e=>!Object(k.isPopulatedObject)(e.pipelines)}],$=async e=>{const t={...N};t[e.model_id]?delete t[e.model_id]:(await G([e]),t[e.model_id]=Object(y.jsx)(T,{item:e})),z(t)},Y=[{align:"left",width:"40px",isExpander:!0,render:e=>Object(y.jsx)(r.EuiButtonIcon,{onClick:$.bind(null,e),"aria-label":N[e.model_id]?v.i18n.translate("xpack.ml.trainedModels.modelsList.collapseRow",{defaultMessage:"Collapse"}):v.i18n.translate("xpack.ml.trainedModels.modelsList.expandRow",{defaultMessage:"Expand"}),iconType:N[e.model_id]?"arrowUp":"arrowDown"}),"data-test-subj":"mlModelsTableRowDetailsToggle"},{field:R.id,name:v.i18n.translate("xpack.ml.trainedModels.modelsList.modelIdHeader",{defaultMessage:"ID"}),sortable:!0,truncateText:!0,"data-test-subj":"mlModelsTableColumnId"},{field:R.description,width:"350px",name:v.i18n.translate("xpack.ml.trainedModels.modelsList.modelDescriptionHeader",{defaultMessage:"Description"}),sortable:!1,truncateText:!0,"data-test-subj":"mlModelsTableColumnDescription"},{field:R.type,name:v.i18n.translate("xpack.ml.trainedModels.modelsList.typeHeader",{defaultMessage:"Type"}),sortable:!0,align:"left",render:e=>Object(y.jsx)(r.EuiFlexGroup,{gutterSize:"xs",wrap:!0},e.map((e=>Object(y.jsx)(r.EuiFlexItem,{key:e,grow:!1},Object(y.jsx)(r.EuiBadge,{color:"hollow","data-test-subj":"mlModelType"},e))))),"data-test-subj":"mlModelsTableColumnType"},{field:R.createdAt,name:v.i18n.translate("xpack.ml.trainedModels.modelsList.createdAtHeader",{defaultMessage:"Created at"}),dataType:"date",render:S.d,sortable:!0,"data-test-subj":"mlModelsTableColumnCreatedAt"},{name:v.i18n.translate("xpack.ml.trainedModels.modelsList.actionsHeader",{defaultMessage:"Actions"}),actions:W,"data-test-subj":"mlModelsTableColumnActions"}],X=q&&q.length>0?[{type:"field_value_selection",field:"type",name:v.i18n.translate("xpack.ml.dataframe.analyticsList.typeFilter",{defaultMessage:"Type"}),multiSelect:"or",options:q}]:[],Q=Object(y.jsx)(r.EuiFlexItem,{grow:!1},Object(y.jsx)(r.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"center"},Object(y.jsx)(r.EuiFlexItem,{grow:!1},Object(y.jsx)(r.EuiTitle,{size:"s"},Object(y.jsx)("h5",null,Object(y.jsx)(s.FormattedMessage,{id:"xpack.ml.trainedModels.modelsList.selectedModelsMessage",defaultMessage:"{modelsCount, plural, one{# model} other {# models}} selected",values:{modelsCount:M.length}})))),Object(y.jsx)(r.EuiFlexItem,null,Object(y.jsx)(r.EuiButton,{color:"danger",onClick:H.bind(null,M)},Object(y.jsx)(s.FormattedMessage,{id:"xpack.ml.trainedModels.modelsList.deleteModelsButtonLabel",defaultMessage:"Delete"}))))),K=m?{selectableMessage:(e,t)=>e?v.i18n.translate("xpack.ml.trainedModels.modelsList.selectableMessage",{defaultMessage:"Select a model"}):Object(k.isPopulatedObject)(t.pipelines)?v.i18n.translate("xpack.ml.trainedModels.modelsList.disableSelectableMessage",{defaultMessage:"Model has associated pipelines"}):J(t)?v.i18n.translate("xpack.ml.trainedModels.modelsList.builtInModelMessage",{defaultMessage:"Built-in model"}):"",selectable:e=>!Object(k.isPopulatedObject)(e.pipelines)&&!J(e),onSelectionChange:e=>{C(e)}}:void 0,{onTableChange:Z,pagination:ee,sorting:te}=Object(D.a)(x,c,d),ae={query:u,onChange:e=>null===e.error&&(d({queryText:e.queryText,pageIndex:0}),!0),box:{incremental:!0},...q&&q.length>0?{filters:X}:{},...M.length>0?{toolsLeft:Q}:{}};return Object(y.jsx)(n.a.Fragment,null,Object(y.jsx)(r.EuiSpacer,{size:"m"}),Object(y.jsx)(r.EuiFlexGroup,{justifyContent:"spaceBetween"},U&&Object(y.jsx)(r.EuiFlexItem,{grow:!1},Object(y.jsx)(E.a,{stats:U,dataTestSub:"mlInferenceModelsStatsBar"}))),Object(y.jsx)(r.EuiSpacer,{size:"m"}),Object(y.jsx)("div",{"data-test-subj":"mlModelsTableContainer"},Object(y.jsx)(r.EuiInMemoryTable,{allowNeutralSort:!1,columns:Y,hasActions:!0,isExpandable:!0,itemIdToExpandedRowMap:N,isSelectable:!1,items:x,itemId:R.id,loading:g,search:ae,selection:K,rowProps:e=>({"data-test-subj":`mlModelsTableRow row-${e.model_id}`}),pagination:ee,onTableChange:Z,sorting:te,"data-test-subj":g?"mlModelsTable loading":"mlModelsTable loaded"})),L.length>0&&Object(y.jsx)(_,{onClose:async e=>{e&&await async function(){const e=L.map((e=>e.model_id));try{await Promise.all(e.map((e=>h.deleteTrainedModel(e)))),O(x.filter((e=>!L.some((t=>t.model_id===e.model_id))))),f.addSuccess(v.i18n.translate("xpack.ml.trainedModels.modelsList.successfullyDeletedMessage",{defaultMessage:"{modelsCount, plural, one {Model {modelsToDeleteIds}} other {# models}} {modelsCount, plural, one {has} other {have}} been successfully deleted",values:{modelsCount:e.length,modelsToDeleteIds:e.join(", ")}}))}catch(a){var t;f.addError(new Error(null==a||null===(t=a.body)||void 0===t?void 0:t.message),{title:v.i18n.translate("xpack.ml.trainedModels.modelsList.fetchDeletionErrorMessage",{defaultMessage:"{modelsCount, plural, one {Model} other {Models}} deletion failed",values:{modelsCount:e.length}})})}}(),P([])},models:L}))},R={id:"model_id",description:"description",createdAt:"create_time",type:"type"};var P=a(463),N=a.n(P),z=a(469),B=a.n(z),J=a(594),V=a.n(J),U=a(595),G=a.n(U),q=a(596),H=a.n(q);const W="#C5CCD7",$="ellipse",Y="rectangle",X="diamond",Q="triangle";const K=e=>({autoungrabify:!0,boxSelectionEnabled:!1,maxZoom:3,minZoom:.2,style:[{selector:"node",style:{"background-color":t=>t.data("isRoot")?e.euiColorWarning:e.euiColorGhost,"background-height":"60%","background-width":"60%","border-color":t=>function(e,t){if(e.selected())return t.euiColorPrimary;switch(e.data("type")){case I.e.ANALYTICS:return t.euiColorSecondary;case I.e.TRANSFORM:return t.euiColorVis1;case I.e.INDEX:return t.euiColorVis2;case I.e.TRAINED_MODEL:return t.euiColorVis3;default:return t.euiColorMediumShade}}(t,e),"border-style":"solid","background-image":e=>function(e){switch(e.data("analysisType")){case I.a.OUTLIER_DETECTION:return G.a;case I.a.CLASSIFICATION:return V.a;case I.a.REGRESSION:return H.a;default:return}}(e),"border-width":e=>e.selected()?4:3,color:e.euiTextColors.default,"font-family":"Inter UI, Segoe UI, Helvetica, Arial, sans-serif","font-size":e.euiFontSizeXS,"min-zoomed-font-size":parseInt(e.euiSizeL,10),label:"data(label)",shape:e=>function(e,t){switch(e.data("type")){case I.e.ANALYTICS:return $;case I.e.TRANSFORM:return Y;case I.e.INDEX:return X;case I.e.TRAINED_MODEL:return Q;default:return $}}(e),"text-background-color":e.euiColorLightestShade,"text-background-opacity":0,"text-background-padding":e.paddingSizes.xs,"text-background-shape":"roundrectangle","text-margin-y":parseInt(e.paddingSizes.s,10),"text-max-width":"200px","text-valign":"bottom","text-wrap":"wrap"}},{selector:"edge",style:{"curve-style":"taxi","taxi-direction":"rightward","line-color":W,"overlay-opacity":0,"target-arrow-color":W,"target-arrow-shape":"triangle","target-distance-from-node":e.paddingSizes.xs,width:1,"source-arrow-shape":"none"}}]});N.a.use(B.a);const Z=Object(i.createContext)(void 0);function ee({children:e,elements:t,theme:a,height:n,itemsDeleted:s,resetCy:r,style:o,width:l}){const[c,d]=function(e){const[t,a]=Object(i.useState)(),n=Object(i.useRef)(null);return Object(i.useEffect)((()=>{t||a(N()({...e,container:n.current}))}),[e,t]),Object(i.useEffect)((()=>()=>{t&&t.destroy()}),[t]),[n,t]}({...K(a),elements:t}),u={...o,height:n},p=Object(i.useCallback)((e=>{d&&n>0&&setTimeout((()=>d.layout(function(e,t){return{name:"dagre",rankDir:"LR",fit:!0,padding:20,spacingFactor:.95,boundingBox:{x1:0,y1:0,w:e,h:t}}}(l,n)).run()),150)}),[d,n,l]);return Object(i.useEffect)((()=>(d&&d.on("data",p),()=>{d&&d.removeListener("data",void 0,p)})),[d,t,n,l]),Object(i.useEffect)((()=>{d&&(!1===s||d.elements().remove(),d.add(t),d.trigger("data"))}),[d,t]),Object(i.useEffect)((()=>{d&&d.reset()}),[d,r]),Object(y.jsx)(Z.Provider,{value:d},Object(y.jsx)("div",{ref:c,style:u,"data-test-subj":"mlPageDataFrameAnalyticsMapCytoscape"},e))}var te=a(48),ae=a.n(te),ie=a(72),ne=a(87),se=a(146),re=a(353),oe=a(261);function le(e){return Object.entries(e).map((([e,t])=>{let a;return a="create_time"===e?Object(S.c)(1e3*ae()(t).unix()):"object"==typeof t?Object(y.jsx)(r.EuiCodeBlock,{language:"json",fontSize:"s",paddingSize:"s"},JSON.stringify(t,null,2)):t,{title:e,description:a}}))}const ce=n.a.memo((({details:e,getNodeData:t,modelId:a,refreshJobsCallback:n,updateElements:o})=>{const[l,c]=Object(i.useState)(!1),[d,u]=Object(i.useState)(),[m,b]=Object(i.useState)(!1),[h,f]=Object(i.useState)(!1),g=Object(ie.e)("canCreateDataFrameAnalytics"),j=Object(ie.e)("canDeleteDataFrameAnalytics"),x=Object(re.b)(j),{closeDeleteJobCheckModal:O,deleteItem:E,deleteTargetIndex:w,isModalVisible:_,isDeleteJobCheckModalVisible:S,item:M,jobType:k,openModal:C,openDeleteJobCheckModal:T}=x,{toasts:D}=Object(p.f)(),A=Object(p.d)(),L=Object(p.e)(),R=Object(se.e)(),P=Object(i.useContext)(Z),N=Object(i.useCallback)((()=>{P&&P.elements().unselect(),c(!1),u(void 0)}),[P,u]),z=null==d?void 0:d.data("id"),B=null==d?void 0:d.data("label"),J=null==d?void 0:d.data("type"),V=Object(i.useCallback)((async()=>{const e=Object(ne.c)(B);if(e){const t=await A.getUrl({page:F.b.DATA_FRAME_ANALYTICS_CREATE_JOB,pageState:{index:e}});await L(t)}else D.addDanger(v.i18n.translate("xpack.ml.dataframe.analyticsMap.flyout.indexPatternMissingMessage",{defaultMessage:"To create a job from this index please create an index pattern for {indexTitle}.",values:{indexTitle:B}}))}),[B]),U=Object(i.useCallback)((async()=>{var t;R({config:e[z],stats:null===(t=e[z])||void 0===t?void 0:t.stats})}),[z]);if(Object(i.useEffect)((()=>{const e=e=>{u(e.target),c(!0)};return P&&(P.on("select","node",e),P.on("unselect","node",N)),()=>{P&&(P.removeListener("select","node",e),P.removeListener("unselect","node",N))}}),[P,N]),Object(i.useEffect)((function(){if(!1===_&&!0===E||!0===h){let t;if(!0===w||!0===h){t=`${e[z].dest.index}-${I.e.INDEX}`}o(z,B,t),c(!1)}}),[_,E,h]),!1===l)return null;const G=Object(y.jsx)(r.EuiButton,{size:"s",iconType:"arrowDown",iconSide:"right",onClick:()=>{b(!m)}},Object(y.jsx)(s.FormattedMessage,{id:"xpack.ml.dataframe.analyticsMap.flyout.nodeActionsButton",defaultMessage:"Node actions"})),q=[...J===I.e.ANALYTICS?[Object(y.jsx)(r.EuiContextMenuItem,{key:`${z}-delete`,icon:"trash",disabled:!j,onClick:()=>{var t;T({config:e[z],stats:null===(t=e[z])||void 0===t?void 0:t.stats})}},Object(y.jsx)(s.FormattedMessage,{id:"xpack.ml.dataframe.analyticsMap.flyout.deleteJobButton",defaultMessage:"Delete job"})),Object(y.jsx)(r.EuiContextMenuItem,{key:`${z}-clone`,icon:"copy",disabled:!g,onClick:U},Object(y.jsx)(s.FormattedMessage,{id:"xpack.ml.dataframe.analyticsMap.flyout.cloneJobButton",defaultMessage:"Clone job"}))]:[],...J===I.e.INDEX?[Object(y.jsx)(r.EuiContextMenuItem,{disabled:!g,key:`${z}-create`,icon:"plusInCircle",onClick:V},Object(y.jsx)(s.FormattedMessage,{id:"xpack.ml.dataframe.analyticsMap.flyout.createJobButton",defaultMessage:"Create job from this index"}))]:[],...a===B||J!==I.e.ANALYTICS&&J!==I.e.INDEX?[]:[Object(y.jsx)(r.EuiContextMenuItem,{key:`${z}-fetch-related`,icon:"branch",onClick:()=>{t({id:B,type:J}),P&&P.elements().unselect(),c(!1),b(!1)}},Object(y.jsx)(s.FormattedMessage,{id:"xpack.ml.dataframe.analyticsMap.flyout.fetchRelatedNodesButton",defaultMessage:"Fetch related nodes"}))]];return Object(y.jsx)(r.EuiPortal,null,Object(y.jsx)(r.EuiFlyout,{ownFocus:!0,size:"m",onClose:N,"data-test-subj":"mlAnalyticsJobMapFlyout"},Object(y.jsx)(r.EuiFlyoutHeader,null,Object(y.jsx)(r.EuiFlexGroup,{direction:"column",gutterSize:"xs"},Object(y.jsx)(r.EuiFlexItem,{grow:!1},Object(y.jsx)(r.EuiTitle,{size:"s"},Object(y.jsx)("h3",{"data-test-subj":"mlDataFrameAnalyticsNodeDetailsTitle"},Object(y.jsx)(s.FormattedMessage,{id:"xpack.ml.dataframe.analyticsMap.flyoutHeaderTitle",defaultMessage:"Details for {type} {id}",values:{id:B,type:J}})))))),Object(y.jsx)(r.EuiFlyoutBody,null,Object(y.jsx)(r.EuiFlexGroup,{direction:"column",gutterSize:"s"},Object(y.jsx)(r.EuiFlexItem,{grow:!1},Object(y.jsx)(r.EuiDescriptionList,{compressed:!0,type:"column",listItems:le("index-pattern"===J?e[z][B]:e[z])})))),Object(y.jsx)(r.EuiFlyoutFooter,null,J!==I.e.TRAINED_MODEL&&Object(y.jsx)(r.EuiPopover,{button:G,isOpen:m,closePopover:()=>{b(!1)},panelPaddingSize:"s",anchorPosition:"downLeft"},Object(y.jsx)(r.EuiContextMenuPanel,{items:q})))),S&&M&&Object(y.jsx)(oe.a,{jobType:k,jobIds:[M.config.id],onCloseCallback:O,canDeleteCallback:()=>{C(x.item),O()},refreshJobsCallback:n,setDidUntag:f}),_&&Object(y.jsx)(re.a,x))})),de=({theme:e})=>{const[t,a]=Object(i.useState)(!1);return Object(y.jsx)(r.EuiFlexGroup,{className:"mlJobMapLegend__container",alignItems:"center","data-test-subj":"mlPageDataFrameAnalyticsMapLegend"},Object(y.jsx)(r.EuiFlexItem,{grow:!1},Object(y.jsx)(r.EuiFlexGroup,{gutterSize:"xs",alignItems:"center"},Object(y.jsx)(r.EuiFlexItem,{grow:!1},Object(y.jsx)("span",{className:"mlJobMapLegend__sourceNode"})),Object(y.jsx)(r.EuiFlexItem,{grow:!1},Object(y.jsx)(r.EuiText,{size:"xs",color:"subdued"},Object(y.jsx)(s.FormattedMessage,{id:"xpack.ml.dataframe.analyticsMap.legend.rootNodeLabel",defaultMessage:"source node"}))))),Object(y.jsx)(r.EuiFlexItem,{grow:!1},Object(y.jsx)(r.EuiFlexGroup,{gutterSize:"xs",alignItems:"center"},Object(y.jsx)(r.EuiFlexItem,{grow:!1},Object(y.jsx)("span",{className:"mlJobMapLegend__indexPattern"})),Object(y.jsx)(r.EuiFlexItem,{grow:!1},Object(y.jsx)(r.EuiText,{size:"xs",color:"subdued"},Object(y.jsx)(s.FormattedMessage,{id:"xpack.ml.dataframe.analyticsMap.legend.indexLabel",defaultMessage:"index"}))))),Object(y.jsx)(r.EuiFlexItem,{grow:!1},Object(y.jsx)(r.EuiFlexGroup,{gutterSize:"xs",alignItems:"center"},Object(y.jsx)(r.EuiFlexItem,{grow:!1},Object(y.jsx)("span",{className:"mlJobMapLegend__transform"})),Object(y.jsx)(r.EuiFlexItem,{grow:!1},Object(y.jsx)(r.EuiText,{size:"xs",color:"subdued"},I.e.TRANSFORM)))),Object(y.jsx)(r.EuiFlexItem,{grow:!1},Object(y.jsx)(r.EuiFlexGroup,{gutterSize:"xs",alignItems:"center"},Object(y.jsx)(r.EuiFlexItem,{grow:!1},Object(y.jsx)("span",{style:{display:"inline-block",width:"0px",height:"0px",borderLeft:`${e.euiSizeS} solid ${e.euiPageBackgroundColor}`,borderRight:`${e.euiSizeS} solid ${e.euiPageBackgroundColor}`,borderBottom:`${e.euiSizeM} solid ${e.euiColorVis3}`}})),Object(y.jsx)(r.EuiFlexItem,{grow:!1},Object(y.jsx)(r.EuiText,{size:"xs",color:"subdued"},Object(y.jsx)(s.FormattedMessage,{id:"xpack.ml.dataframe.analyticsMap.legend.trainedModelLabel",defaultMessage:"trained model"}))))),Object(y.jsx)(r.EuiFlexItem,{grow:!1},Object(y.jsx)(r.EuiFlexGroup,{gutterSize:"xs",alignItems:"center"},Object(y.jsx)(r.EuiFlexItem,{grow:!1},Object(y.jsx)("span",{className:"mlJobMapLegend__analytics"})),Object(y.jsx)(r.EuiFlexItem,{grow:!1},Object(y.jsx)(r.EuiFlexGroup,{gutterSize:"xs",alignItems:"center"},Object(y.jsx)(r.EuiFlexItem,{grow:!1},Object(y.jsx)(r.EuiText,{size:"xs",color:"subdued"},Object(y.jsx)(s.FormattedMessage,{id:"xpack.ml.dataframe.analyticsMap.legend.analyticsJobLabel",defaultMessage:"analytics jobs"}))),Object(y.jsx)(r.EuiFlexItem,{grow:!1},Object(y.jsx)(r.EuiPopover,{ownFocus:!0,button:Object(y.jsx)(r.EuiButtonIcon,{iconSize:"s",onClick:()=>a(!t),iconType:t?"arrowUp":"arrowDown","aria-label":v.i18n.translate("xpack.ml.dataframe.analyticsMap.legend.showJobTypesAriaLabel",{defaultMessage:"Show job types"})}),isOpen:t,closePopover:()=>a(!1)},Object(y.jsx)(n.a.Fragment,null,Object(y.jsx)(r.EuiListGroup,{flush:!0},Object(y.jsx)(r.EuiListGroupItem,{iconType:"outlierDetectionJob",label:"Outlier detection",size:"xs"}),Object(y.jsx)(r.EuiListGroupItem,{iconType:"regressionJob",label:"Regression",size:"xs"}),Object(y.jsx)(r.EuiListGroupItem,{iconType:"classificationJob",label:"Classification",size:"xs"}))))))))))};var ue=a(116),pe=a(597),me=a.n(pe);var be=a(8),he=a(67);const fe=()=>{const[e,t]=Object(i.useState)(!1),[a,n]=Object(i.useState)([]),[s,r]=Object(i.useState)({}),[o,l]=Object(i.useState)(),[c,d]=Object(i.useState)();return{elements:a,error:o,fetchAndSetElementsWrapper:async e=>{const{analyticsId:i,id:o,modelId:c,type:u}=null!=e?e:{},p=void 0!==o;let m;m=void 0!==o?o:void 0!==c?c:i,await(async(e,i,o)=>{t(!0);const c=await he.ml.dataFrameAnalytics.getDataFrameAnalyticsMap(e,i,o),{elements:u,details:p,error:m}=c;if(null!==m&&(t(!1),l(m)),0===(null==u?void 0:u.length)&&d(v.i18n.translate("xpack.ml.dataframe.analyticsMap.emptyResponseMessage",{defaultMessage:"No related analytics jobs found for {id}.",values:{id:e}})),(null==u?void 0:u.length)>0)if(!1===i)n(u),r(p);else{const e=Object(be.uniqWith)([...u,...a],be.isEqual);n(e),r({...p,...s})}t(!1)})(m,p,void 0!==c&&!1===p?I.e.TRAINED_MODEL:u)},isLoading:e,message:c,nodeDetails:s,setElements:n,setError:l}},ge=({analyticsId:e,modelId:t})=>Object(y.jsx)(r.EuiTitle,{size:"xs"},Object(y.jsx)("span",{"data-test-subj":"mlPageDataFrameAnalyticsMapTitle"},e?Object(y.jsx)(s.FormattedMessage,{id:"xpack.ml.dataframe.analyticsMap.analyticsIdTitle",defaultMessage:"Map for analytics ID {analyticsId}",values:{analyticsId:e}}):Object(y.jsx)(s.FormattedMessage,{id:"xpack.ml.dataframe.analyticsMap.modelIdTitle",defaultMessage:"Map for trained model ID {modelId}",values:{modelId:t}}))),je=({analyticsId:e,modelId:t})=>{const[a,n]=Object(i.useState)(!1),[o,l]=Object(i.useState)(!1),{elements:c,error:d,fetchAndSetElementsWrapper:u,isLoading:m,message:b,nodeDetails:h,setElements:f,setError:g}=fe(),{services:{notifications:j,application:{navigateToUrl:x}}}=Object(p.b)(),O=Object(p.d)(),{euiTheme:E}=Object(ue.e)();Object(i.useEffect)((()=>{u({analyticsId:e,modelId:t})}),[e,t]),Object(i.useEffect)((()=>{void 0!==b&&j.toasts.add(b)}),[b]),void 0!==d&&(j.toasts.addDanger(v.i18n.translate("xpack.ml.dataframe.analyticsMap.fetchDataErrorMessage",{defaultMessage:"Unable to fetch some data. An error occurred: {error}",values:{error:JSON.stringify(d)}})),g(void 0));const{ref:w,width:_,height:S}=function(){const e=Object(i.useRef)(null),t=me()().height;if(!e.current)return{ref:e,width:0,height:0};const{top:a,width:n}=e.current.getBoundingClientRect();return{ref:e,width:n,height:t-a}}(),M=()=>u({analyticsId:e,modelId:t});return Object(y.jsx)("div",{"data-test-subj":"mlPageDataFrameAnalyticsMap"},Object(y.jsx)(r.EuiSpacer,{size:"m"}),Object(y.jsx)(r.EuiFlexGroup,{direction:"column",gutterSize:"none",justifyContent:"spaceBetween"},Object(y.jsx)(r.EuiFlexItem,{grow:!1},Object(y.jsx)(r.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"center"},Object(y.jsx)(r.EuiFlexItem,{grow:!1},Object(y.jsx)(ge,{analyticsId:e,modelId:t})),Object(y.jsx)(r.EuiFlexItem,{grow:!1},Object(y.jsx)(de,{theme:E})))),Object(y.jsx)(r.EuiFlexItem,{grow:!1},Object(y.jsx)(r.EuiFlexGroup,{gutterSize:"xs",component:"span"},Object(y.jsx)(r.EuiFlexItem,{grow:!1},Object(y.jsx)(r.EuiButtonEmpty,{size:"xs","data-test-subj":"mlAnalyticsRefreshMapButton"+(m?" loading":" loaded"),onClick:M,isLoading:m},Object(y.jsx)(s.FormattedMessage,{id:"xpack.ml.dataframe.analyticsList.refreshMapButtonLabel",defaultMessage:"Refresh"}))),Object(y.jsx)(r.EuiFlexItem,{grow:!1},Object(y.jsx)(r.EuiButtonEmpty,{size:"xs","data-test-subj":"mlAnalyticsResetGraphButton",onClick:()=>l(!o)},Object(y.jsx)(s.FormattedMessage,{id:"xpack.ml.dataframe.analyticsList.resetMapButtonLabel",defaultMessage:"Reset"})))))),Object(y.jsx)("div",{style:{height:S-parseInt(E.gutterTypes.gutterLarge,10)-20},ref:w},Object(y.jsx)(ee,{theme:E,height:S-20,elements:c,width:_,style:(k=E,{background:`linear-gradient(\n  90deg,\n  ${k.euiPageBackgroundColor}\n    calc(${k.euiSizeL} - calc(${k.euiSizeXS} / 2)),\n  transparent 1%\n)\ncenter,\nlinear-gradient(\n  ${k.euiPageBackgroundColor}\n    calc(${k.euiSizeL} - calc(${k.euiSizeXS} / 2)),\n  transparent 1%\n)\ncenter,\n${k.euiColorLightShade}`,backgroundSize:`${k.euiSizeL} ${k.euiSizeL}`,margin:`-${k.gutterTypes.gutterLarge}`,marginTop:0}),itemsDeleted:a,resetCy:o},Object(y.jsx)(ce,{details:h,getNodeData:u,modelId:t,updateElements:(t,a,i)=>{if(a===e)(async()=>{const e=await O.getUrl({page:F.b.DATA_FRAME_ANALYTICS_JOBS_MANAGE});await x(e)})();else{const e=c.filter((e=>{let n=e.data.id!==t&&e.data.target!==t&&e.data.source!==t;var s,r,o;void 0!==e.data.id&&e.data.type===I.e.TRAINED_MODEL&&(n=n&&(null===(s=h[e.data.id])||void 0===s||null===(r=s.metadata)||void 0===r||null===(o=r.analytics_config)||void 0===o?void 0:o.id)!==a);return void 0!==i?n&&e.data.id!==i&&e.data.target!==i&&e.data.source!==i:n}));n(!0),f(e)}},refreshJobsCallback:M}))));var k};var xe=a(94),ve=a(104);const ye=()=>({pageIndex:0,pageSize:10,sortField:xe.c.id,sortDirection:"asc"}),Oe=()=>{var e,t;const[a,m]=Object(i.useState)(!1),[v]=Object(l.c)("_g"),[E,w]=Object(l.b)(F.b.DATA_FRAME_ANALYTICS_JOBS_MANAGE,ye());h(m);const[_,S]=Object(i.useState)(!1),{refresh:M}=Object(b.w)({isLoading:S}),k=Object(o.useLocation)(),C=Object(i.useMemo)((()=>k.pathname.split("/").pop()),[k]),T=null==v||null===(e=v.ml)||void 0===e?void 0:e.jobId,I=null==v||null===(t=v.ml)||void 0===t?void 0:t.modelId,{services:{docLinks:D}}=Object(p.b)(),A=D.links.ml.dataFrameAnalytics;return Object(y.jsx)(i.Fragment,null,Object(y.jsx)(c.a,{tabId:"data_frame_analytics"}),Object(y.jsx)(r.EuiPage,{"data-test-subj":"mlPageDataFrameAnalytics"},Object(y.jsx)(r.EuiPageBody,null,Object(y.jsx)(r.EuiPageHeader,null,Object(y.jsx)(r.EuiPageHeaderSection,null,Object(y.jsx)(r.EuiTitle,null,Object(y.jsx)("h1",null,Object(y.jsx)(s.FormattedMessage,{id:"xpack.ml.dataframe.analyticsList.title",defaultMessage:"Data frame analytics"})))),Object(y.jsx)(r.EuiPageHeaderSection,null,Object(y.jsx)(r.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},"map"!==C&&Object(y.jsx)(n.a.Fragment,null,Object(y.jsx)(r.EuiFlexItem,{grow:!1},Object(y.jsx)(f.a,null)),Object(y.jsx)(r.EuiFlexItem,{grow:!1},Object(y.jsx)(d.a,null)))))),Object(y.jsx)(g.a,null),Object(y.jsx)(j.a,{jobType:"data-frame-analytics",onCloseFlyout:M,forceRefresh:_}),Object(y.jsx)(x.a,null),Object(y.jsx)(r.EuiPageContent,null,Object(y.jsx)(O,{selectedTabId:C,jobId:T,modelId:I}),"map"===C&&(T||I)&&Object(y.jsx)(je,{analyticsId:T,modelId:I}),"data_frame_analytics"===C&&Object(y.jsx)(u.a,{blockRefresh:a,pageState:E,updatePageState:w}),"models"===C&&Object(y.jsx)(L,null)))),Object(y.jsx)(ve.a,{docLink:A}))}},function(e,t,a){"use strict";a.d(t,"a",(function(){return y})),a.d(t,"b",(function(){return O}));var i=a(15),n=a.n(i),s=a(2),r=a(40),o=a(191),l=a(11);const c=({limit:e,maps:t,newSelection:a,onDeleteClick:i,onLinkClick:c,showAllBadges:d})=>{const u=[];for(let n=0;n<a.length&&!(n>=e&&!1===d);n++)u.push(Object(l.jsx)(r.EuiFlexItem,{grow:!1,key:a[n]},Object(l.jsx)(o.a,{id:a[n],icon:!0,isGroup:void 0!==t.groupsMap[a[n]],removeId:i})));return!1===d&&a.length>e?u.push(Object(l.jsx)(r.EuiLink,{key:"more-badges-link",onClick:c},Object(l.jsx)(r.EuiText,{grow:!1,size:"xs"},s.i18n.translate("xpack.ml.jobSelector.showFlyoutBadges",{defaultMessage:"And {overFlow} more",values:{overFlow:a.length-e}})))):!0===d&&a.length>e&&u.push(Object(l.jsx)(r.EuiLink,{key:"hide-badges-link",onClick:c},Object(l.jsx)(r.EuiText,{grow:!1,size:"xs"},s.i18n.translate("xpack.ml.jobSelector.hideFlyoutBadges",{defaultMessage:"Hide"})))),Object(l.jsx)(n.a.Fragment,null,u)};var d=a(363);function u({isRunning:e,timerange:t,ganttBarWidth:a}){const n={width:t.widthPx,marginLeft:t.fromPx},s="mlJobSelector__ganttBar"+(e?" mlJobSelector__ganttBarRunning":"");return Object(l.jsx)(r.EuiToolTip,{position:"top",content:t.label},Object(l.jsx)(i.Fragment,null,Object(l.jsx)("div",{className:"mlJobSelector__ganttBarBackEdge"},Object(l.jsx)("div",{className:"mlJobSelector__ganttBarDashed",style:{width:`${a}px`}})),Object(l.jsx)("div",{style:n,className:s})))}var p=a(41),m=a(54),b=a(66),h=a(0),f=a(6);const g=["job_id","groups"],j=["id"];function x({ganttBarWidth:e,groupsList:t,jobs:a,onSelection:n,selectedIds:c,singleSelection:x,timeseriesOnly:v,withTimeRangeSelector:y}){const[O,E]=Object(i.useState)(),[w,_]=Object(i.useState)("Jobs"),{services:{application:{navigateToApp:S}}}=Object(b.b)();Object(i.useEffect)((()=>{let e=[],t="job_id";"Jobs"===w||x?e=[{name:"job_id",getValue:e=>e.job_id.toLowerCase(),isAscending:!0},{name:"groups",getValue:e=>e.groups&&e.groups[0]?e.groups[0].toLowerCase():"",isAscending:!0}]:"Groups"===w&&(t="id",e=[{name:"id",getValue:e=>e.id.toLowerCase(),isAscending:!0}]);const a=new m.SortableProperties(e,t);E(a)}),[a,w]);const M=[{id:"Jobs",name:s.i18n.translate("xpack.ml.jobSelector.jobsTab",{defaultMessage:"Jobs"}),content:k()},{id:"Groups",name:s.i18n.translate("xpack.ml.jobSelector.groupsTab",{defaultMessage:"Groups"}),content:function(){const a=[{id:"checkbox",isCheckbox:!0,textOnly:!1,width:"32px"},{label:"group ID",id:"id",isSortable:!0,alignment:m.LEFT_ALIGNMENT,render:({id:e})=>Object(l.jsx)(o.a,{id:e,isGroup:!0})},{id:"jobs in group",label:"jobs in group",isSortable:!1,alignment:m.CENTER_ALIGNMENT,render:({jobIds:e=[]})=>e.length}];y&&a.push({label:"time range",id:"timerange",alignment:m.LEFT_ALIGNMENT,render:({timeRange:t={}})=>Object(l.jsx)(u,{timerange:t,ganttBarWidth:e})});return Object(l.jsx)(d.a,{columns:a,filterDefaultFields:x?void 0:j,items:t,onTableChange:e=>n({selectionFromTable:e}),selectedIds:c,sortableProperties:O})}()}];function k(){const p=[{id:"checkbox",isCheckbox:!0,textOnly:!1,width:"32px"},{label:"job ID",id:"job_id",isSortable:!0,alignment:m.LEFT_ALIGNMENT},{id:"groups",label:"groups",isSortable:!0,alignment:m.LEFT_ALIGNMENT,render:({groups:e=[]})=>e.map((e=>Object(l.jsx)(o.a,{key:`${e}-key`,id:e,isGroup:!0})))}];y&&p.push({label:"time range",id:"timerange",alignment:m.LEFT_ALIGNMENT,render:({timeRange:t={},isRunning:a})=>Object(l.jsx)(u,{timerange:t,isRunning:a,ganttBarWidth:e})});const b=[{type:"field_value_selection",field:"groups",name:s.i18n.translate("xpack.ml.jobSelector.filterBar.groupLabel",{defaultMessage:"Group"}),loadingMessage:"Loading...",noOptionsMessage:"No groups found.",multiSelect:"or",cache:1e4,options:t.map((e=>({value:e.id,view:Object(l.jsx)(i.Fragment,null,Object(l.jsx)(r.EuiFlexGroup,{gutterSize:"s"},Object(l.jsx)(r.EuiFlexItem,{key:e.id,grow:!1},Object(l.jsx)(o.a,{id:e.id,isGroup:!0})),Object(l.jsx)(r.EuiFlexItem,{grow:!1},s.i18n.translate("xpack.ml.jobSelector.filterBar.jobGroupTitle",{defaultMessage:"({jobsCount, plural, one {# job} other {# jobs}})",values:{jobsCount:e.jobIds.length}}))))})))}];return Object(l.jsx)(d.a,{columns:p,filters:b,filterDefaultFields:x?void 0:g,items:a,onTableChange:e=>n({selectionFromTable:e}),radioDisabledCheck:e=>v&&!1===e.isSingleMetricViewerJob,selectedIds:c,singleSelection:x,sortableProperties:O,timeseriesOnly:v})}return Object(l.jsx)(i.Fragment,null,0===a.length&&Object(l.jsx)(r.EuiCallOut,{title:Object(l.jsx)(p.FormattedMessage,{id:"xpack.ml.jobSelector.noJobsFoundTitle",defaultMessage:"No anomaly detection jobs found"}),iconType:"iInCircle"},Object(l.jsx)(r.EuiText,{textAlign:"center"},Object(l.jsx)(r.EuiButton,{color:"primary",onClick:async()=>{await S(f.e,{path:h.b.ANOMALY_DETECTION_CREATE_JOB})}},Object(l.jsx)(p.FormattedMessage,{id:"xpack.ml.jobSelector.createJobButtonLabel",defaultMessage:"Create job"})))),0!==a.length&&!0===x&&k(),0!==a.length&&!x&&Object(l.jsx)(r.EuiTabbedContent,{size:"s",tabs:M,initialSelectedTab:M[0],onTabClick:e=>{_(e.id)}}))}var v=a(230);const y=10,O=({dateFormatTz:e,selectedIds:t=[],singleSelection:a,timeseriesOnly:o,onJobsFetched:d,onSelectionConfirmed:u,onFlyoutClose:p,maps:m,applyTimeRangeConfig:h,onTimeRangeConfigChange:f,withTimeRangeSelector:g=!0})=>{const{services:{notifications:j,mlServices:{mlApiServices:O}}}=Object(b.b)(),[E,w]=Object(i.useState)(t),[_,S]=Object(i.useState)(!0),[M,k]=Object(i.useState)(!1),[C,T]=Object(i.useState)([]),[F,I]=Object(i.useState)([]),[D,A]=Object(i.useState)(299),[L,R]=Object(i.useState)(m),P=Object(i.useRef)(null),N=Object(i.useCallback)((()=>{const e=[],t=[];E.forEach((a=>{void 0!==L.groupsMap[a]?(e.push(...L.groupsMap[a]),t.push({groupId:a,jobIds:L.groupsMap[a]})):e.push(a)}));const a=Array.from(new Set(e)),i=h?Object(v.b)(C,a):void 0;u({newSelection:a,jobIds:a,groups:t,time:i})}),[u,E,L,h]);function z(e){w(E.filter((t=>t!==e)))}function B(){f&&f(!h)}function J(){w([])}function V({selectionFromTable:e}){w(e)}const U=Object(i.useCallback)((()=>{if(0===C.length||!P.current)return;const t=P.current.querySelectorAll("table thead th"),a=t[t.length-1].offsetWidth-16,i=Object(v.c)(C,e,a);T(i);const{groups:n}=Object(v.a)(i);I(n),A(a)}),[e,C]);return Object(i.useEffect)((()=>{!async function(){try{const t=await O.jobs.jobsWithTimerange(e),a=Object(v.c)(t.jobs,e,299),{groups:i,groupsMap:n}=Object(v.a)(a);T(a),I(i),R({groupsMap:n,jobsMap:t.jobsMap}),d&&d({groupsMap:n,jobsMap:t.jobsMap})}catch(e){console.error("Error fetching jobs with time range",e);const{toasts:t}=j;t.addDanger({title:s.i18n.translate("xpack.ml.jobSelector.jobFetchErrorMessage",{defaultMessage:"An error occurred fetching jobs. Refresh and try again."})})}S(!1)}()}),[]),Object(l.jsx)(n.a.Fragment,null,Object(l.jsx)(r.EuiFlyoutHeader,{hasBorder:!0},Object(l.jsx)(r.EuiTitle,{size:"m"},Object(l.jsx)("h2",{id:"flyoutTitle"},s.i18n.translate("xpack.ml.jobSelector.flyoutTitle",{defaultMessage:"Job selection"})))),Object(l.jsx)(r.EuiFlyoutBody,{className:"mlJobSelectorFlyoutBody"},Object(l.jsx)(r.EuiResizeObserver,{onResize:U},(e=>Object(l.jsx)("div",{ref:t=>{P.current=t,e(t)}},_?Object(l.jsx)(r.EuiProgress,{size:"xs",color:"accent"}):Object(l.jsx)(n.a.Fragment,null,Object(l.jsx)(r.EuiFlexGroup,{direction:"column",responsive:!1},Object(l.jsx)(r.EuiFlexItem,{grow:!1},Object(l.jsx)(r.EuiFlexGroup,{wrap:!0,responsive:!1,gutterSize:"xs",alignItems:"center"},Object(l.jsx)(c,{limit:y,maps:L,newSelection:E,onDeleteClick:z,onLinkClick:()=>k(!M),showAllBadges:M}))),Object(l.jsx)(r.EuiFlexItem,{grow:!1},Object(l.jsx)(r.EuiFlexGroup,{direction:"row",justifyContent:"spaceBetween",responsive:!1},Object(l.jsx)(r.EuiFlexItem,{grow:!1},!a&&E.length>0&&Object(l.jsx)(r.EuiButtonEmpty,{onClick:J,size:"xs","data-test-subj":"mlFlyoutJobSelectorButtonClearSelection"},s.i18n.translate("xpack.ml.jobSelector.clearAllFlyoutButton",{defaultMessage:"Clear all"}))),g&&void 0!==h&&Object(l.jsx)(r.EuiFlexItem,{grow:!1},Object(l.jsx)(r.EuiSwitch,{label:s.i18n.translate("xpack.ml.jobSelector.applyTimerangeSwitchLabel",{defaultMessage:"Apply time range"}),checked:h,onChange:B,"data-test-subj":"mlFlyoutJobSelectorSwitchApplyTimeRange"}))))),Object(l.jsx)(x,{jobs:C,ganttBarWidth:D,groupsList:F,onSelection:V,selectedIds:E,singleSelection:a,timeseriesOnly:o,withTimeRangeSelector:g})))))),Object(l.jsx)(r.EuiFlyoutFooter,null,Object(l.jsx)(r.EuiFlexGroup,null,Object(l.jsx)(r.EuiFlexItem,{grow:!1},Object(l.jsx)(r.EuiButton,{onClick:N,fill:!0,isDisabled:0===E.length,"data-test-subj":"mlFlyoutJobSelectorButtonApply"},s.i18n.translate("xpack.ml.jobSelector.applyFlyoutButton",{defaultMessage:"Apply"}))),Object(l.jsx)(r.EuiFlexItem,{grow:!1},Object(l.jsx)(r.EuiButtonEmpty,{iconType:"cross",onClick:p,"data-test-subj":"mlFlyoutJobSelectorButtonClose"},s.i18n.translate("xpack.ml.jobSelector.closeFlyoutButton",{defaultMessage:"Close"}))))))}},function(e,t,a){"use strict";a.d(t,"a",(function(){return N}));var i=a(4),n=a.n(i),s=a(15),r=a.n(s),o=a(40),l=a(41),c=a(2),d=a(66),u=a(145);const p="KIBANA_DASHBOARD",m="KIBANA_DISCOVER",b="OTHER",h={AUTO:"auto",INTERVAL:"interval"};var f=a(53),g=a.n(f),j=a(423),x=a.n(j),v=a(55),y=a(74),O=a(26),E=a(87),w=a(67),_=a(88),S=a(22);function M(e,t,a){const i={queryFieldNames:[]};let n=b;void 0!==t&&t.length>0?(n=p,i.dashboardId=t[0].id):void 0!==a&&a.length>0&&(n=m);const s=e.datafeed_config;if(void 0!==a&&a.length>0&&void 0!==s&&void 0!==s.indices&&s.indices.length>0){var r;const e=null!==(r=Object(E.c)(s.indices.join()))&&void 0!==r?r:a[0].id;i.discoverIndexPatternId=e}return{label:"",type:n,timeRange:{type:h.AUTO,interval:""},kibanaSettings:i,otherUrlSettings:{urlValue:""}}}function k(e){const t=e.analysis_config.influencers,a=e.analysis_config.detectors,i=[];return void 0!==t&&i.push(...t),a.forEach(((t,a)=>{Object(y.h)(e,a).forEach((e=>{-1===i.indexOf(e)&&i.push(e)}))})),i}function C(e){if(e.type===h.INTERVAL){return null!==Object(O.a)(e.interval)}return!0}function T(e){if(e.type===p)return function(e){return new Promise(((t,a)=>{const{dashboardId:i,queryFieldNames:n}=e.kibanaSettings;Object(S.i)().get("dashboard",i).then((a=>{let s,r=[];const o=a.get("kibanaSavedObjectMeta.searchSourceJSON");if(void 0!==o){const e=JSON.parse(o);void 0!==e.filter&&(r=e.filter),s=e.query}const l=F(n);void 0!==l&&(s=l);return Object(S.e)()(v.DASHBOARD_APP_URL_GENERATOR).createUrl({dashboardId:i,timeRange:{from:"$earliest$",to:"$latest$",mode:"absolute"},filters:r,query:s,useHash:!1}).then((a=>{const i={url_name:e.label,url_value:decodeURIComponent(`dashboards${x.a.parse(a).hash}`),time_range:h.AUTO};e.timeRange.type===h.INTERVAL&&(i.time_range=e.timeRange.interval),t(i)}))})).catch((e=>{a(e)}))}))}(e);if(e.type===m)return Promise.resolve(function(e){const{discoverIndexPatternId:t,queryFieldNames:a}=e.kibanaSettings,i=g.a.encode({time:{from:"$earliest$",to:"$latest$",mode:"absolute"}}),n={index:t},s=F(a);void 0!==s&&(n.query=s);const r=g.a.encode(n),o=`discover#/?_g=${i}&_a=${r}`,l={url_name:e.label,url_value:o,time_range:h.AUTO};e.timeRange.type===h.INTERVAL&&(l.time_range=e.timeRange.interval);return l}(e));{const t={url_name:e.label,url_value:e.otherUrlSettings.urlValue};return Promise.resolve(t)}}function F(e){let t;if(void 0!==e&&e.length>0){let a="";e.forEach(((e,t)=>{t>0&&(a+=" and "),a+=`${Object(_.c)(e)}:"$${e}$"`})),t={language:"kuery",query:a}}return t}async function I(e,t){const a=Object(O.a)(e.analysis_config.bucket_span).asSeconds();let i=t.url_value;const n={query:{bool:{must:[{term:{job_id:e.job_id}},{term:{result_type:"record"}}]}},size:1,_source:{excludes:[]},sort:[{record_score:{order:"desc"}}]};let s;try{s=await w.ml.results.anomalySearch({body:n},[e.job_id])}catch(e){}if(s&&s.hits.total.value>0){const e=s.hits.hits[0]._source;return i=Object(u.e)(t,a,e,"timestamp"),i}{let{datafeed_config:n,...s}=e;try{const[{jobs:t},{datafeeds:a}]=await Promise.all([w.ml.getJobs({jobId:e.job_id}),w.ml.getDatafeeds({datafeedId:e.datafeed_config.datafeed_id})]);n=a[0],s=t[0]}catch(e){}if(void 0===s||void 0===n)return i;const r=await w.ml.jobs.datafeedPreview(void 0,s,n),o=e.data_description.time_field,l=r[0];return void 0!==l&&(i=Object(u.e)(t,a,l,o)),i}}var D=a(11);const A=({job:e,customUrls:t,setCustomUrls:a})=>{const{services:{http:i,notifications:n}}=Object(d.b)(),[r,p]=Object(s.useState)(null),m=t.map(((s,d)=>{const m=s.url_name,b=[...t];b.splice(d,1);const f=!Object(u.b)(m,b),g=f?[c.i18n.translate("xpack.ml.customUrlEditorList.labelIsNotUniqueErrorMessage",{defaultMessage:"A unique label must be supplied"})]:[],j=!function(e){return void 0===e||0===e.length||e===h.AUTO||null!==Object(O.a)(e)}(s.time_range),x=j?[c.i18n.translate("xpack.ml.customUrlEditorList.invalidTimeRangeFormatErrorMessage",{defaultMessage:"Invalid format"})]:[];return Object(D.jsx)(o.EuiFlexGroup,{key:`url_${d}`,"data-test-subj":`mlJobEditCustomUrlItem_${d}`},Object(D.jsx)(o.EuiFlexItem,{grow:!1},Object(D.jsx)(o.EuiFormRow,{label:Object(D.jsx)(l.FormattedMessage,{id:"xpack.ml.customUrlEditorList.labelLabel",defaultMessage:"Label"}),isInvalid:f,error:g,"data-test-subj":"mlJobEditCustomUrlItemLabel"},Object(D.jsx)(o.EuiFieldText,{value:m,isInvalid:f,onChange:e=>((e,i)=>{i<t.length&&(t[i]={...t[i],url_name:e.target.value},a(t))})(e,d),"data-test-subj":`mlJobEditCustomUrlLabelInput_${d}`}))),Object(D.jsx)(o.EuiFlexItem,null,Object(D.jsx)(o.EuiFormRow,{fullWidth:!0,label:Object(D.jsx)(l.FormattedMessage,{id:"xpack.ml.customUrlEditorList.urlLabel",defaultMessage:"URL"})},d===r?Object(D.jsx)(o.EuiTextArea,{inputRef:e=>{e&&e.focus()},fullWidth:!0,value:s.url_value,onChange:e=>((e,i)=>{i<t.length&&(t[i]={...t[i],url_value:e.target.value},a(t))})(e,d),onBlur:()=>{p(null)},"data-test-subj":`mlJobEditCustomUrlTextarea_${d}`}):Object(D.jsx)(o.EuiFieldText,{fullWidth:!0,value:s.url_value,readOnly:!0,onFocus:()=>p(d),"data-test-subj":`mlJobEditCustomUrlInput_${d}`}))),Object(D.jsx)(o.EuiFlexItem,{grow:!1},Object(D.jsx)(o.EuiFormRow,{label:Object(D.jsx)(l.FormattedMessage,{id:"xpack.ml.customUrlEditorList.timeRangeLabel",defaultMessage:"Time range"}),error:x,isInvalid:j},Object(D.jsx)(o.EuiFieldText,{value:s.time_range||"",isInvalid:j,placeholder:h.AUTO,onChange:e=>((e,i)=>{if(i<t.length){t[i]={...t[i]};const n=e.target.value;void 0!==n&&n.length>0?t[i].time_range=n:delete t[i].time_range,a(t)}})(e,d)}))),Object(D.jsx)(o.EuiFlexItem,{grow:!1},Object(D.jsx)(o.EuiFormRow,{hasEmptyLabelSpace:!0},Object(D.jsx)(o.EuiToolTip,{content:Object(D.jsx)(l.FormattedMessage,{id:"xpack.ml.customUrlEditorList.testCustomUrlTooltip",defaultMessage:"Test custom URL"})},Object(D.jsx)(o.EuiButtonIcon,{size:"s",color:"primary",onClick:()=>(a=>{a<t.length&&I(e,t[a]).then((e=>{Object(u.d)(e,t[a],i.basePath.get())})).catch((e=>{console.error("Error obtaining URL for test:",e);const{toasts:t}=n;t.addDanger(c.i18n.translate("xpack.ml.customUrlEditorList.obtainingUrlToTestConfigurationErrorMessage",{defaultMessage:"An error occurred obtaining the URL to test the configuration"}))}))})(d),iconType:"popout","aria-label":c.i18n.translate("xpack.ml.customUrlEditorList.testCustomUrlAriaLabel",{defaultMessage:"Test custom URL"}),"data-test-subj":"mlJobEditTestCustomUrlButton"})))),Object(D.jsx)(o.EuiFlexItem,{grow:!1},Object(D.jsx)(o.EuiFormRow,{hasEmptyLabelSpace:!0},Object(D.jsx)(o.EuiToolTip,{content:Object(D.jsx)(l.FormattedMessage,{id:"xpack.ml.customUrlEditorList.deleteCustomUrlTooltip",defaultMessage:"Delete custom URL"})},Object(D.jsx)(o.EuiButtonIcon,{size:"s",color:"danger",onClick:()=>(e=>{e<t.length&&(t.splice(e,1),a(t))})(d),iconType:"trash","aria-label":c.i18n.translate("xpack.ml.customUrlEditorList.deleteCustomUrlAriaLabel",{defaultMessage:"Delete custom URL"}),"data-test-subj":`mlJobEditDeleteCustomUrlButton_${d}`})))))}));return Object(D.jsx)("div",{"data-test-subj":"mlJobEditCustomUrlsList"},m)};const L=({customUrl:e,setEditCustomUrl:t,savedCustomUrls:a,dashboards:i,indexPatterns:n,queryEntityFieldNames:s})=>{if(void 0===e)return null;const{label:d,type:f,timeRange:g,kibanaSettings:j,otherUrlSettings:x}=e,v=i.map((e=>({value:e.id,text:e.title}))),y=n.map((e=>({value:e.id,text:e.title}))),O=s.map((e=>({label:e})));let E=[];if(void 0!==j&&void 0!==j.queryFieldNames){E=j.queryFieldNames.map((e=>({label:e})))}const w=Object.values(h).map((e=>({value:e,text:e}))),_=!Object(u.b)(d,a),S=_?[c.i18n.translate("xpack.ml.customUrlsEditor.invalidLabelErrorMessage",{defaultMessage:"A unique label must be supplied"})]:[],M=!C(g),k=M?[c.i18n.translate("xpack.ml.customUrlsList.invalidIntervalFormatErrorMessage",{defaultMessage:"Invalid interval format"})]:[];return Object(D.jsx)(r.a.Fragment,null,Object(D.jsx)(o.EuiTitle,{size:"xs"},Object(D.jsx)("h4",null,Object(D.jsx)(l.FormattedMessage,{id:"xpack.ml.customUrlsEditor.createNewCustomUrlTitle",defaultMessage:"Create new custom URL"}))),Object(D.jsx)(o.EuiSpacer,{size:"m"}),Object(D.jsx)(o.EuiForm,{className:"ml-edit-url-form","data-test-subj":"mlJobCustomUrlForm"},Object(D.jsx)(o.EuiFormRow,{label:Object(D.jsx)(l.FormattedMessage,{id:"xpack.ml.customUrlsEditor.labelLabel",defaultMessage:"Label"}),className:"url-label",error:S,isInvalid:_,display:"rowCompressed"},Object(D.jsx)(o.EuiFieldText,{name:"label",value:d,onChange:a=>{t({...e,label:a.target.value})},isInvalid:_,compressed:!0,"data-test-subj":"mlJobCustomUrlLabelInput"})),Object(D.jsx)(o.EuiFormRow,{label:Object(D.jsx)(l.FormattedMessage,{id:"xpack.ml.customUrlsEditor.linkToLabel",defaultMessage:"Link to"}),display:"rowCompressed"},Object(D.jsx)(o.EuiRadioGroup,{options:[{id:p,label:c.i18n.translate("xpack.ml.customUrlEditor.kibanaDashboardLabel",{defaultMessage:"Kibana dashboard"})},{id:m,label:c.i18n.translate("xpack.ml.customUrlEditor.discoverLabel",{defaultMessage:"Discover"})},{id:b,label:c.i18n.translate("xpack.ml.customUrlEditor.otherLabel",{defaultMessage:"Other"})}],idSelected:f,onChange:a=>{t({...e,type:a})},className:"url-link-to-radio","data-test-subj":"mlJobCustomUrlLinkToTypeInput"})),f===p&&Object(D.jsx)(o.EuiFormRow,{label:Object(D.jsx)(l.FormattedMessage,{id:"xpack.ml.customUrlsEditor.dashboardNameLabel",defaultMessage:"Dashboard name"}),display:"rowCompressed"},Object(D.jsx)(o.EuiSelect,{options:v,value:j.dashboardId,onChange:a=>{const i=e.kibanaSettings;t({...e,kibanaSettings:{...i,dashboardId:a.target.value}})},"data-test-subj":"mlJobCustomUrlDashboardNameInput",compressed:!0})),f===m&&Object(D.jsx)(o.EuiFormRow,{label:Object(D.jsx)(l.FormattedMessage,{id:"xpack.ml.customUrlsEditor.indexPatternLabel",defaultMessage:"Index pattern"}),display:"rowCompressed"},Object(D.jsx)(o.EuiSelect,{options:y,value:j.discoverIndexPatternId,onChange:a=>{const i=e.kibanaSettings;t({...e,kibanaSettings:{...i,discoverIndexPatternId:a.target.value}})},"data-test-subj":"mlJobCustomUrlDiscoverIndexPatternInput",compressed:!0})),(f===p||f===m)&&O.length>0&&Object(D.jsx)(o.EuiFormRow,{label:Object(D.jsx)(l.FormattedMessage,{id:"xpack.ml.customUrlsEditor.queryEntitiesLabel",defaultMessage:"Query entities"})},Object(D.jsx)(o.EuiComboBox,{placeholder:c.i18n.translate("xpack.ml.customUrlsEditor.selectEntitiesPlaceholder",{defaultMessage:"Select entities"}),options:O,selectedOptions:E,onChange:a=>{const i=a.map((e=>e.label)),n=e.kibanaSettings;t({...e,kibanaSettings:{...n,queryFieldNames:i}})},isClearable:!0,"data-test-subj":"mlJobCustomUrlQueryEntitiesInput"})),(f===p||f===m)&&Object(D.jsx)(r.a.Fragment,null,Object(D.jsx)(o.EuiSpacer,{size:"m"}),Object(D.jsx)(o.EuiFlexGroup,null,Object(D.jsx)(o.EuiFlexItem,{grow:!1},Object(D.jsx)(o.EuiFormRow,{label:Object(D.jsx)(l.FormattedMessage,{id:"xpack.ml.customUrlsEditor.timeRangeLabel",defaultMessage:"Time range"}),className:"url-time-range",display:"rowCompressed"},Object(D.jsx)(o.EuiSelect,{options:w,value:g.type,onChange:a=>{const i=e.timeRange;t({...e,timeRange:{...i,type:a.target.value}})},"data-test-subj":"mlJobCustomUrlTimeRangeInput",compressed:!0}))),g.type===h.INTERVAL&&Object(D.jsx)(o.EuiFlexItem,null,Object(D.jsx)(o.EuiFormRow,{label:Object(D.jsx)(l.FormattedMessage,{id:"xpack.ml.customUrlsEditor.intervalLabel",defaultMessage:"Interval"}),className:"url-time-range",error:k,isInvalid:M,display:"rowCompressed"},Object(D.jsx)(o.EuiFieldText,{value:g.interval,onChange:a=>{const i=e.timeRange;t({...e,timeRange:{...i,interval:a.target.value}})},isInvalid:M,"data-test-subj":"mlJobCustomUrlTimeRangeIntervalInput",compressed:!0}))))),f===b&&Object(D.jsx)(o.EuiFormRow,{label:Object(D.jsx)(l.FormattedMessage,{id:"xpack.ml.customUrlsEditor.urlLabel",defaultMessage:"URL"}),display:"rowCompressed",fullWidth:!0},Object(D.jsx)(o.EuiTextArea,{fullWidth:!0,rows:2,value:x.urlValue,onChange:a=>{t({...e,otherUrlSettings:{urlValue:a.target.value}})},"data-test-subj":"mlJobCustomUrlOtherTypeUrlInput",compressed:!0}))))};var R=a(42),P=a(281);class custom_urls_CustomUrlsUI extends s.Component{constructor(e){super(e),n()(this,"editNewCustomUrl",(()=>{this.setState((e=>{const{dashboards:t,indexPatterns:a}=e;return{editorOpen:!0,editorSettings:M(this.props.job,t,a)}}))})),n()(this,"setEditCustomUrl",(e=>{this.setState({editorSettings:e})})),n()(this,"addNewCustomUrl",(()=>{T(this.state.editorSettings).then((e=>{const t=[...this.state.customUrls,e];this.props.setCustomUrls(t),this.setState({editorOpen:!1})})).catch((e=>{console.error("Error building custom URL from settings:",e);const{toasts:t}=this.props.kibana.services.notifications;t.addDanger(c.i18n.translate("xpack.ml.jobsList.editJobFlyout.customUrls.addNewUrlErrorNotificationMessage",{defaultMessage:"An error occurred building the new custom URL from the supplied settings"}))}))})),n()(this,"onTestButtonClick",(()=>{const{http:{basePath:e},notifications:{toasts:t}}=this.props.kibana.services,a=this.props.job;T(this.state.editorSettings).then((i=>{I(a,i).then((t=>{Object(u.d)(t,i,e.get())})).catch((e=>{console.error("Error obtaining URL for test:",e),t.addWarning(c.i18n.translate("xpack.ml.jobsList.editJobFlyout.customUrls.getTestUrlErrorNotificationMessage",{defaultMessage:"An error occurred obtaining the URL to test the configuration"}))}))})).catch((e=>{console.error("Error building custom URL from settings:",e),t.addWarning(c.i18n.translate("xpack.ml.jobsList.editJobFlyout.customUrls.buildUrlErrorNotificationMessage",{defaultMessage:"An error occurred building the custom URL for testing from the supplied settings"}))}))})),n()(this,"closeEditor",(()=>{this.setState({editorOpen:!1})})),this.state={customUrls:[],dashboards:[],indexPatterns:[],queryEntityFieldNames:[],editorOpen:!1}}static getDerivedStateFromProps(e){return{job:e.job,customUrls:e.jobCustomUrls,queryEntityFieldNames:k(e.job)}}componentDidMount(){const{toasts:e}=this.props.kibana.services.notifications;Object(P.b)(1e3).then((e=>{this.setState({dashboards:e})})).catch((t=>{console.error("Error loading list of dashboards:",t),e.addDanger(c.i18n.translate("xpack.ml.jobsList.editJobFlyout.customUrls.loadSavedDashboardsErrorNotificationMessage",{defaultMessage:"An error occurred loading the list of saved Kibana dashboards"}))})),Object(P.a)(1e3).then((e=>{this.setState({indexPatterns:e})})).catch((t=>{console.error("Error loading list of dashboards:",t),e.addDanger(c.i18n.translate("xpack.ml.jobsList.editJobFlyout.customUrls.loadIndexPatternsErrorNotificationMessage",{defaultMessage:"An error occurred loading the list of saved index patterns"}))}))}renderEditor(){var e;const{customUrls:t,editorOpen:a,editorSettings:i,dashboards:n,indexPatterns:s,queryEntityFieldNames:r}=this.state,d=null!==(e=this.props.editMode)&&void 0!==e?e:"inline",p=Object(D.jsx)(L,{customUrl:i,setEditCustomUrl:this.setEditCustomUrl,savedCustomUrls:t,dashboards:n,indexPatterns:s,queryEntityFieldNames:r}),m=!a||void 0===i||function(e,t){let a=Object(u.b)(e.label,t);return!0===a&&(a=C(e.timeRange)),a}(i,t),b=Object(D.jsx)(o.EuiButton,{onClick:this.addNewCustomUrl,isDisabled:!m,"data-test-subj":"mlJobAddCustomUrl"},Object(D.jsx)(l.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.customUrls.addButtonLabel",defaultMessage:"Add"})),h=Object(D.jsx)(o.EuiButtonEmpty,{iconType:"popout",iconSide:"right",onClick:this.onTestButtonClick,isDisabled:!m},Object(D.jsx)(l.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.customUrls.testButtonLabel",defaultMessage:"Test"}));return"inline"===d?Object(D.jsx)(o.EuiPanel,{className:"edit-custom-url-panel"},Object(D.jsx)(o.EuiButtonIcon,{color:"text",onClick:this.closeEditor,iconType:"cross","aria-label":c.i18n.translate("xpack.ml.jobsList.editJobFlyout.customUrls.closeEditorAriaLabel",{defaultMessage:"Close custom URL editor"}),className:"close-editor-button"}),p,Object(D.jsx)(o.EuiSpacer,{size:"m"}),Object(D.jsx)(o.EuiFlexGroup,null,Object(D.jsx)(o.EuiFlexItem,{grow:!1},b),Object(D.jsx)(o.EuiFlexItem,{grow:!1},h))):Object(D.jsx)(o.EuiModal,{onClose:this.closeEditor,initialFocus:"[name=label]",style:{width:500},"data-test-subj":"mlJobNewCustomUrlFormModal"},Object(D.jsx)(o.EuiModalHeader,null,Object(D.jsx)(o.EuiModalHeaderTitle,null,Object(D.jsx)(l.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.customUrls.addCustomUrlButtonLabel",defaultMessage:"Add custom URL"}))),Object(D.jsx)(o.EuiModalBody,null,p),Object(D.jsx)(o.EuiModalFooter,null,h,b))}render(){const{customUrls:e,editorOpen:t}=this.state,{editMode:a="inline"}=this.props;return Object(D.jsx)(r.a.Fragment,null,Object(D.jsx)(o.EuiSpacer,{size:"m"}),(!t||"modal"===a)&&Object(D.jsx)(o.EuiButton,{size:"s",onClick:this.editNewCustomUrl,"data-test-subj":"mlJobOpenCustomUrlFormButton"},Object(D.jsx)(l.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.customUrls.addCustomUrlButtonLabel",defaultMessage:"Add custom URL"})),t&&this.renderEditor(),Object(D.jsx)(o.EuiSpacer,{size:"l"}),Object(D.jsx)(A,{job:this.props.job,customUrls:e,setCustomUrls:this.props.setCustomUrls}))}}const N=Object(R.withKibana)(custom_urls_CustomUrlsUI)},function(e,t,a){"use strict";a.d(t,"a",(function(){return M}));var i=a(71),n=a.n(i),s=a(4),r=a.n(s),o=a(15),l=a.n(o),c=a(135),d=a.n(c),u=a(8),p=a(40),m=a(2),b=a(41),h=a(173),f=a(136),g=a(76),j=a(11);const x=({annotation:e,detectorDescription:t})=>{const a=[{title:m.i18n.translate("xpack.ml.timeSeriesExplorer.annotationDescriptionList.jobIdTitle",{defaultMessage:"Job ID"}),description:e.job_id},{title:m.i18n.translate("xpack.ml.timeSeriesExplorer.annotationDescriptionList.startTitle",{defaultMessage:"Start"}),description:Object(g.c)(e.timestamp)}];var i,n,s,r,o;(void 0!==e.end_timestamp&&a.push({title:m.i18n.translate("xpack.ml.timeSeriesExplorer.annotationDescriptionList.endTitle",{defaultMessage:"End"}),description:Object(g.c)(e.end_timestamp)}),void 0!==e.create_time&&void 0!==e.modified_time)&&(a.push({title:m.i18n.translate("xpack.ml.timeSeriesExplorer.annotationDescriptionList.createdTitle",{defaultMessage:"Created"}),description:Object(g.c)(e.create_time)}),a.push({title:m.i18n.translate("xpack.ml.timeSeriesExplorer.annotationDescriptionList.createdByTitle",{defaultMessage:"Created by"}),description:null!==(i=e.create_username)&&void 0!==i?i:""}),a.push({title:m.i18n.translate("xpack.ml.timeSeriesExplorer.annotationDescriptionList.lastModifiedTitle",{defaultMessage:"Last modified"}),description:Object(g.c)(e.modified_time)}),a.push({title:m.i18n.translate("xpack.ml.timeSeriesExplorer.annotationDescriptionList.modifiedByTitle",{defaultMessage:"Modified by"}),description:null!==(n=e.modified_username)&&void 0!==n?n:""}));(void 0!==t&&a.push({title:m.i18n.translate("xpack.ml.timeSeriesExplorer.annotationDescriptionList.detectorTitle",{defaultMessage:"Detector"}),description:t}),void 0!==e.partition_field_name)&&a.push({title:e.partition_field_name,description:null!==(s=e.partition_field_value)&&void 0!==s?s:""});void 0!==e.over_field_name&&a.push({title:e.over_field_name,description:null!==(r=e.over_field_value)&&void 0!==r?r:""});void 0!==e.by_field_name&&a.push({title:e.by_field_name,description:null!==(o=e.by_field_value)&&void 0!==o?o:""});return Object(j.jsx)(p.EuiDescriptionList,{"data-test-subj":"mlAnnotationDescriptionList",className:"ml-annotation-description-list",type:"column",listItems:a})},v=({cancelAction:e,deleteAction:t,isVisible:a})=>Object(j.jsx)(o.Fragment,null,!0===a&&Object(j.jsx)(p.EuiConfirmModal,{title:Object(j.jsx)(b.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.deleteAnnotationModal.deleteAnnotationTitle",defaultMessage:"Delete this annotation?"}),onCancel:e,onConfirm:t,cancelButtonText:Object(j.jsx)(b.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.deleteAnnotationModal.cancelButtonLabel",defaultMessage:"Cancel"}),confirmButtonText:Object(j.jsx)(b.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.deleteAnnotationModal.deleteButtonLabel",defaultMessage:"Delete"}),buttonColor:"danger",defaultFocusedButton:p.EUI_MODAL_CONFIRM_BUTTON,className:"eui-textBreakWord","data-test-subj":"mlAnnotationFlyoutConfirmDeleteModal"}));var y=a(67),O=a(22);function E(e){return`${e}_name`}function w(e){return`${e}_value`}var _=a(1),S=a(137);class annotation_flyout_AnnotationFlyoutUI extends o.Component{constructor(...e){super(...e),r()(this,"state",{isDeleteModalVisible:!1,applyAnnotationToSeries:!0,annotationState:null}),r()(this,"annotationSub",null),r()(this,"annotationTextChangeHandler",(e=>{if(null===this.state.annotationState)return;const{annotationUpdatesService:t}=this.props;t.setValue({...this.state.annotationState,annotation:e.target.value})})),r()(this,"cancelEditingHandler",(()=>{const{annotationUpdatesService:e}=this.props;e.setValue(null)})),r()(this,"deleteConfirmHandler",(()=>{this.setState({isDeleteModalVisible:!0})})),r()(this,"deleteHandler",(async()=>{const{annotationState:e}=this.state,t=Object(O.k)();if(null===e||void 0===e._id)return;try{await y.ml.annotations.deleteAnnotation(e._id),t.addSuccess(m.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.deletedAnnotationNotificationMessage",{defaultMessage:"Deleted annotation for job with ID {jobId}.",values:{jobId:e.job_id}}))}catch(a){t.addDanger(m.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.errorWithDeletingAnnotationNotificationErrorMessage",{defaultMessage:"An error occurred deleting the annotation for job with ID {jobId}: {error}",values:{jobId:e.job_id,error:JSON.stringify(a)}}))}this.closeDeleteModal();const{annotationUpdatesService:a}=this.props;a.setValue(null),Object(f.c)()})),r()(this,"closeDeleteModal",(()=>{this.setState({isDeleteModalVisible:!1})})),r()(this,"validateAnnotationText",(()=>{const{annotationState:e}=this.state,t=[];if(null===e)return t;0===e.annotation.trim().length&&t.push(m.i18n.translate("xpack.ml.timeSeriesExplorer.annotationFlyout.noAnnotationTextError",{defaultMessage:"Enter annotation text"}));const a=e.annotation.length;if(a>h.c){const e=a-h.c;t.push(m.i18n.translate("xpack.ml.timeSeriesExplorer.annotationFlyout.maxLengthError",{defaultMessage:"{charsOver, number} {charsOver, plural, one {character} other {characters}} above maximum length of {maxChars}",values:{maxChars:h.c,charsOver:e}}))}return t})),r()(this,"saveOrUpdateAnnotation",(()=>{var e,t;const{annotationState:a}=this.state,{chartDetails:i,detectorIndex:n,annotationUpdatesService:s}=this.props;if(null===a)return;const r=Object(u.cloneDeep)(a);this.state.applyAnnotationToSeries&&null!=i&&null!==(e=i.entityData)&&void 0!==e&&e.entities&&(i.entityData.entities.forEach((e=>{const{fieldName:t,fieldValue:a}=e,i=e.fieldType;r[E(i)]=t,r[w(i)]=a})),r.detector_index=n),this.state.applyAnnotationToSeries||(delete r.detector_index,_.e.forEach((e=>{delete r[E(e)],delete r[w(e)]}))),r.event=null!==(t=r.event)&&void 0!==t?t:h.b,s.setValue(null),y.ml.annotations.indexAnnotation(r).then((()=>{Object(f.c)();const e=Object(O.k)();void 0===r._id?e.addSuccess(m.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.addedAnnotationNotificationMessage",{defaultMessage:"Added an annotation for job with ID {jobId}.",values:{jobId:r.job_id}})):e.addSuccess(m.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.updatedAnnotationNotificationMessage",{defaultMessage:"Updated annotation for job with ID {jobId}.",values:{jobId:r.job_id}}))})).catch((e=>{const t=Object(O.k)();void 0===r._id?t.addDanger(m.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.errorWithCreatingAnnotationNotificationErrorMessage",{defaultMessage:"An error occurred creating the annotation for job with ID {jobId}: {error}",values:{jobId:r.job_id,error:JSON.stringify(e)}})):t.addDanger(m.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.errorWithUpdatingAnnotationNotificationErrorMessage",{defaultMessage:"An error occurred updating the annotation for job with ID {jobId}: {error}",values:{jobId:r.job_id,error:JSON.stringify(e)}}))}))}))}componentDidMount(){const{annotationUpdatesService:e}=this.props;this.annotationSub=e.update$().subscribe((e=>{this.setState({annotationState:e})}))}componentWillUnmount(){this.annotationSub.unsubscribe()}render(){const{detectors:e,detectorIndex:t}=this.props,{annotationState:a,isDeleteModalVisible:i}=this.state;if(!a)return null;const n=void 0!==a._id,s=this.validateAnnotationText(),r=s.length>0;let o=null;!1===r&&a.annotation.length>.95*h.c&&(o=m.i18n.translate("xpack.ml.timeSeriesExplorer.annotationFlyout.approachingMaxLengthWarning",{defaultMessage:"{charsRemaining, number} {charsRemaining, plural, one {character} other {characters}} remaining",values:{charsRemaining:h.c-a.annotation.length}}));const c=e?e.find((e=>e.index===t)):void 0,d=c&&"detector_description"in c?c.detector_description:"";return Object(j.jsx)(l.a.Fragment,null,Object(j.jsx)(p.EuiFlyoutBody,null,Object(j.jsx)(x,{annotation:a,detectorDescription:d}),Object(j.jsx)(p.EuiSpacer,{size:"m"}),Object(j.jsx)(p.EuiFormRow,{label:Object(j.jsx)(b.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.annotationFlyout.annotationTextLabel",defaultMessage:"Annotation text"}),fullWidth:!0,helpText:o,isInvalid:r,error:s},Object(j.jsx)(p.EuiTextArea,{fullWidth:!0,isInvalid:r,onChange:this.annotationTextChangeHandler,placeholder:"...",value:a.annotation,"data-test-subj":"mlAnnotationsFlyoutTextInput"})),Object(j.jsx)(p.EuiFormRow,null,Object(j.jsx)(p.EuiCheckbox,{id:"xpack.ml.annotationFlyout.applyToPartition",label:Object(j.jsx)(b.FormattedMessage,{id:"xpack.ml.annotationFlyout.applyToPartitionTextLabel",defaultMessage:"Apply annotation to this series"}),checked:this.state.applyAnnotationToSeries,onChange:()=>this.setState({applyAnnotationToSeries:!this.state.applyAnnotationToSeries}),"data-test-subj":"mlAnnotationsFlyoutApplyToSeriesButton"}))),Object(j.jsx)(p.EuiFlyoutFooter,null,Object(j.jsx)(p.EuiFlexGroup,null,Object(j.jsx)(p.EuiFlexItem,{grow:!1},Object(j.jsx)(p.EuiButtonEmpty,{onClick:this.cancelEditingHandler,flush:"left","data-test-subj":"mlAnnotationsFlyoutCancelButton"},Object(j.jsx)(b.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.annotationFlyout.cancelButtonLabel",defaultMessage:"Cancel"}))),Object(j.jsx)(p.EuiFlexItem,{grow:!1,style:{marginLeft:"auto"}},n&&Object(j.jsx)(p.EuiButtonEmpty,{color:"danger",onClick:this.deleteConfirmHandler,"data-test-subj":"mlAnnotationsFlyoutDeleteButton"},Object(j.jsx)(b.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.annotationFlyout.deleteButtonLabel",defaultMessage:"Delete"}))),Object(j.jsx)(p.EuiFlexItem,{grow:!1},Object(j.jsx)(p.EuiButton,{fill:!0,isDisabled:!0===r,onClick:this.saveOrUpdateAnnotation,"data-test-subj":"annotationFlyoutUpdateOrCreateButton"},n?Object(j.jsx)(b.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.annotationFlyout.updateButtonLabel",defaultMessage:"Update"}):Object(j.jsx)(b.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.annotationFlyout.createButtonLabel",defaultMessage:"Create"}))))),Object(j.jsx)(v,{cancelAction:this.closeDeleteModal,deleteAction:this.deleteHandler,isVisible:i}))}}const M=e=>{const t=Object(o.useContext)(S.a),a=d()(t.isAnnotationInitialized$()),i=Object(o.useCallback)((()=>{t.setValue(null)}),[]);if(null==a)return null;const s=void 0!==a._id;return Object(j.jsx)(p.EuiFlyout,{onClose:i,size:"m","aria-labelledby":"Add annotation","data-test-subj":"mlAnnotationFlyout",className:"mlAnnotationFlyout"},Object(j.jsx)(p.EuiFlyoutHeader,{hasBorder:!0},Object(j.jsx)(p.EuiTitle,{size:"s","data-test-subj":"mlAnnotationFlyoutTitle"},Object(j.jsx)("h2",{id:"mlAnnotationFlyoutTitle"},s?Object(j.jsx)(b.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.annotationFlyout.editAnnotationTitle",defaultMessage:"Edit annotation"}):Object(j.jsx)(b.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.annotationFlyout.addAnnotationTitle",defaultMessage:"Add annotation"})))),Object(j.jsx)(annotation_flyout_AnnotationFlyoutUI,n()({},e,{annotationUpdatesService:t})))}},function(e,t,a){"use strict";a.r(t),a.d(t,"getDefaultSwimlanePanelTitle",(function(){return j})),a.d(t,"AnomalySwimlaneEmbeddable",(function(){return anomaly_swimlane_embeddable_AnomalySwimlaneEmbeddable}));var i=a(4),n=a.n(i),s=a(15),r=a.n(s),o=a(49),l=a.n(o),c=a(2),d=a(23),u=a(42),p=a(45);const m=r.a.lazy((()=>Promise.all([a.e(1),a.e(19)]).then(a.bind(null,763))));var b=a(162),h=a(103),f=a(149),g=a(11);const j=e=>c.i18n.translate("xpack.ml.swimlaneEmbeddable.title",{defaultMessage:"ML anomaly swim lane for {jobIds}",values:{jobIds:e.join(", ")}});class anomaly_swimlane_embeddable_AnomalySwimlaneEmbeddable extends p.Embeddable{constructor(e,t,a){super(e,{defaultTitle:e.title},a),n()(this,"node",void 0),n()(this,"reload$",new d.Subject),n()(this,"type",h.b),this.services=t}onLoading(){this.renderComplete.dispatchInProgress(),this.updateOutput({loading:!0,error:void 0})}onError(e){this.renderComplete.dispatchError(),this.updateOutput({loading:!1,error:{name:e.name,message:e.message}})}onRenderComplete(){this.renderComplete.dispatchComplete(),this.updateOutput({loading:!1,error:void 0})}render(e){super.render(e),this.node=e,this.node.setAttribute("data-shared-item","");const t=this.services[0].i18n.Context;l.a.render(Object(g.jsx)(t,null,Object(g.jsx)(u.KibanaContextProvider,{services:{...this.services[0]}},Object(g.jsx)(s.Suspense,{fallback:Object(g.jsx)(f.a,null)},Object(g.jsx)(m,{id:this.input.id,embeddableContext:this,embeddableInput:this.getInput$(),services:this.services,refresh:this.reload$.asObservable(),onInputChange:this.updateInput.bind(this),onOutputChange:this.updateOutput.bind(this),onRenderComplete:this.onRenderComplete.bind(this),onLoading:this.onLoading.bind(this),onError:this.onError.bind(this)})))),e)}destroy(){super.destroy(),this.node&&l.a.unmountComponentAtNode(this.node)}reload(){this.reload$.next()}supportedTriggers(){return[b.a]}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var i=a(15),n=a.n(i),s=a(2),r=a(40),o=a(16),l=a(11);const c=n.a.memo((({value:e,onChange:t})=>{const a=[{min:o.ANOMALY_THRESHOLD.LOW,max:o.ANOMALY_THRESHOLD.MINOR,color:"#8BC8FB"},{min:o.ANOMALY_THRESHOLD.MINOR,max:o.ANOMALY_THRESHOLD.MAJOR,color:"#FDEC25"},{min:o.ANOMALY_THRESHOLD.MAJOR,max:o.ANOMALY_THRESHOLD.CRITICAL,color:"#FBA740"},{min:o.ANOMALY_THRESHOLD.CRITICAL,max:100,color:"#FE5050"}],i=s.i18n.translate("xpack.ml.severitySelector.formControlLabel",{defaultMessage:"Severity"}),n=null!=e?e:o.ANOMALY_THRESHOLD.LOW,c=e=>{t(Number(e.target.value))},d=new Array(5).fill(null).map(((e,t)=>{const a=25*t;return{value:a,label:a}}));return Object(l.jsx)(r.EuiFormRow,{fullWidth:!0},Object(l.jsx)(r.EuiFlexGroup,null,Object(l.jsx)(r.EuiFlexItem,{grow:!1},Object(l.jsx)(r.EuiFieldNumber,{id:"severityControl",style:{width:"70px"},compressed:!0,prepend:i,value:n,onChange:c,min:o.ANOMALY_THRESHOLD.LOW,max:100})),Object(l.jsx)(r.EuiFlexItem,{grow:!0},Object(l.jsx)(r.EuiRange,{className:"mlSeverityControl",fullWidth:!0,min:o.ANOMALY_THRESHOLD.LOW,max:100,value:n,onChange:c,"aria-label":s.i18n.translate("xpack.ml.severitySelector.formControlAriaLabel",{defaultMessage:"Select severity threshold"}),showTicks:!0,ticks:d,showRange:!1,levels:a,"data-test-subj":"mlAnomalyAlertScoreSelection"}))))}))},function(e,t,a){"use strict";a.r(t),a.d(t,"getDefaultExplorerChartsPanelTitle",(function(){return g})),a.d(t,"AnomalyChartsEmbeddable",(function(){return anomaly_charts_embeddable_AnomalyChartsEmbeddable}));var i=a(4),n=a.n(i),s=a(15),r=a.n(s),o=a(49),l=a.n(o),c=a(2),d=a(23),u=a(42),p=a(45);const m=r.a.lazy((()=>Promise.all([a.e(0),a.e(1),a.e(2),a.e(4),a.e(18)]).then(a.bind(null,760))));var b=a(103),h=a(149),f=a(11);const g=e=>c.i18n.translate("xpack.ml.anomalyChartsEmbeddable.title",{defaultMessage:"ML anomaly charts for {jobIds}",values:{jobIds:e.join(", ")}});class anomaly_charts_embeddable_AnomalyChartsEmbeddable extends p.Embeddable{constructor(e,t,a){super(e,{defaultTitle:e.title},a),n()(this,"node",void 0),n()(this,"reload$",new d.Subject),n()(this,"type",b.a),this.services=t,this.initializeOutput(e)}async initializeOutput(e){const{anomalyExplorerService:t}=this.services[2],{jobIds:a}=e;try{const e=await t.getCombinedJobs(a),i=this.services[1].data.indexPatterns,n=new Set(e.map((e=>e.datafeed_config.indices)).flat()),s={};for(const e of n){const t=(await i.find(`"${e}"`)).find((t=>t.title.toLowerCase()===e.toLowerCase()));void 0!==t&&(s[t.id]=t)}this.updateOutput({...this.getOutput(),indexPatterns:Object.values(s)})}catch(e){console.error(`Unable to load index patterns for ${a}`,e)}}onLoading(){this.renderComplete.dispatchInProgress(),this.updateOutput({loading:!0,error:void 0})}onError(e){this.renderComplete.dispatchError(),this.updateOutput({loading:!1,error:{name:e.name,message:e.message}})}onRenderComplete(){this.renderComplete.dispatchComplete(),this.updateOutput({loading:!1,error:void 0})}render(e){super.render(e),this.node=e,this.node.setAttribute("data-shared-item","");const t=this.services[0].i18n.Context;l.a.render(Object(f.jsx)(t,null,Object(f.jsx)(u.KibanaContextProvider,{services:{...this.services[0]}},Object(f.jsx)(s.Suspense,{fallback:Object(f.jsx)(h.a,null)},Object(f.jsx)(m,{id:this.input.id,embeddableContext:this,embeddableInput:this.getInput$(),services:this.services,refresh:this.reload$.asObservable(),onInputChange:this.updateInput.bind(this),onOutputChange:this.updateOutput.bind(this),onRenderComplete:this.onRenderComplete.bind(this),onLoading:this.onLoading.bind(this),onError:this.onError.bind(this)})))),e)}destroy(){super.destroy(),this.node&&l.a.unmountComponentAtNode(this.node)}reload(){this.reload$.next()}supportedTriggers(){return[]}}},,function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var i=a(15),n=a(40),s=a(41),r=a(154),o=a(83),l=a(11);const c=()=>{if(!0===Object(r.c)()||!1===Object(r.d)())return null;const e=Object(o.b)();return Object(l.jsx)(i.Fragment,null,Object(l.jsx)(n.EuiCallOut,{title:Object(l.jsx)(s.FormattedMessage,{id:"xpack.ml.jobsList.nodeAvailableWarning.noMLNodesAvailableTitle",defaultMessage:"No ML nodes available"}),color:"warning",iconType:"alert"},Object(l.jsx)("div",null,Object(l.jsx)(s.FormattedMessage,{id:"xpack.ml.jobsList.nodeAvailableWarning.noMLNodesAvailableDescription",defaultMessage:"There are no ML nodes available."})),Object(l.jsx)("div",null,Object(l.jsx)(s.FormattedMessage,{id:"xpack.ml.jobsList.nodeAvailableWarning.unavailableCreateOrRunJobsDescription",defaultMessage:"You will not be able to create or run jobs."})),Object(o.e)()&&null!==e&&Object(l.jsx)("div",null,Object(l.jsx)(s.FormattedMessage,{id:"xpack.ml.jobsList.nodeAvailableWarning.linkToCloudDescription",defaultMessage:"Please edit your {link}. You may enable a free 1GB machine learning node or expand your existing ML configuration.",values:{link:Object(l.jsx)(n.EuiLink,{href:`https://cloud.elastic.co/deployments?q=${e}`},Object(l.jsx)(s.FormattedMessage,{id:"xpack.ml.jobsList.nodeAvailableWarning.linkToCloud.hereLinkText",defaultMessage:"Elastic Cloud deployment"}))}}))),Object(l.jsx)(n.EuiSpacer,{size:"m"}))}},function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var i=a(15),n=a.n(i),s=a(40),r=a(41),o=a(66),l=a(354),c=a(72),d=a(11);const u=({jobType:e,onCloseFlyout:t,forceRefresh:a})=>{const{savedObjects:{syncCheck:u}}=Object(o.a)(),p=Object(i.useRef)(!1),[m,b]=Object(i.useState)(!1),[h,f]=Object(i.useState)(!1),g=Object(i.useMemo)((()=>Object(c.e)("canCreateJob")),[]),j=Object(i.useCallback)((async()=>{try{if(!1===p.current)return;const{result:t}=await u(e);!0===p.current&&b(h||t)}catch(e){console.log("Saved object synchronization check could not be performed.")}}),[h,b]);Object(i.useEffect)((function(){return p.current=!0,void 0!==a&&!0!==a||j(),()=>{p.current=!1}}),[a,p]);const x=Object(i.useCallback)((()=>{void 0===a&&j(),f(!1),"function"==typeof t&&t()}),[j,t,f]);return Object(i.useEffect)((function(){!1===m&&!0===p.current&&f(!1)}),[m,f]),!1===m?null:Object(d.jsx)(n.a.Fragment,null,Object(d.jsx)(s.EuiCallOut,{title:Object(d.jsx)(r.FormattedMessage,{id:"xpack.ml.jobsList.missingSavedObjectWarning.title",defaultMessage:"ML job synchronization required"}),color:"warning",iconType:"alert","data-test-subj":"mlJobSyncRequiredWarning"},Object(d.jsx)(n.a.Fragment,null,Object(d.jsx)(r.FormattedMessage,{id:"xpack.ml.jobsList.missingSavedObjectWarning.description",defaultMessage:"Some jobs are missing or have incomplete saved objects. "}),g?Object(d.jsx)(r.FormattedMessage,{id:"xpack.ml.jobsList.missingSavedObjectWarning.link",defaultMessage:" {link}",values:{link:Object(d.jsx)(s.EuiLink,{onClick:f.bind(null,!0)},Object(d.jsx)(r.FormattedMessage,{id:"xpack.ml.jobsList.missingSavedObjectWarning.linkToManagement.link",defaultMessage:"Synchronize your jobs."}))}}):Object(d.jsx)(r.FormattedMessage,{id:"xpack.ml.jobsList.missingSavedObjectWarning.noPermission",defaultMessage:"An Administrator can synchronize the jobs in Stack Management."}),h&&Object(d.jsx)(l.a,{onClose:x}))),Object(d.jsx)(s.EuiSpacer,{size:"m"}))}},function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var i=a(15),n=a.n(i),s=a(40),r=a(41),o=a(269),l=a(11);const c=()=>!0===Object(o.a)()?Object(l.jsx)(n.a.Fragment,null,Object(l.jsx)(s.EuiCallOut,{title:Object(l.jsx)(r.FormattedMessage,{id:"xpack.ml.upgrade.upgradeWarning.upgradeInProgressWarningTitle",defaultMessage:"Index migration in progress"}),color:"warning",iconType:"alert"},Object(l.jsx)("p",null,Object(l.jsx)(r.FormattedMessage,{id:"xpack.ml.upgrade.upgradeWarning.upgradeInProgressWarningDescription",defaultMessage:"Indices related to Machine Learning are currently being upgraded."}),Object(l.jsx)("br",null),Object(l.jsx)(r.FormattedMessage,{id:"xpack.ml.upgrade.upgradeWarning.upgradeInProgressWarningDescriptionExtra",defaultMessage:"Some actions will not be available during this time."}))),Object(l.jsx)(s.EuiSpacer,{size:"m"})):null},function(e,t,a){"use strict";a.d(t,"a",(function(){return I}));var i=a(71),n=a.n(i),s=a(4),r=a.n(s),o=a(8),l=a(15),c=a(211),d=a.n(c),u=a(40),p=a(2),m=a(41),b=a(54),h=a(172),f=a(67),g=a(79),j=a(210),x=a(108),v=a(74),y=a(136),O=a(173),E=a(42),w=a(0),_=a(76),S=a(137),M=a(352),k=a(11);const C=Object(k.jsx)(m.FormattedMessage,{id:"xpack.ml.annotationsTable.editAnnotationsTooltip",defaultMessage:"Edit annotation"}),T=Object(k.jsx)(m.FormattedMessage,{id:"xpack.ml.annotationsTable.datafeedChartTooltip",defaultMessage:"Datafeed chart"}),F="current_series";class annotations_table_AnnotationsTableUI extends l.Component{constructor(e){super(e),r()(this,"getAnnotationsWithExtraInfo",d()((e=>{var t,a;return Array.isArray(null===(t=this.props.chartDetails)||void 0===t||null===(a=t.entityData)||void 0===a?void 0:a.entities)?e.map((e=>{var t,a;const i=null===(t=this.props.chartDetails)||void 0===t||null===(a=t.entityData)||void 0===a?void 0:a.entities.every((({fieldType:t,fieldValue:a})=>{const i=`${t}_value`;return!(!e[i]||e[i]!==a)}));return{...e,[F]:i}})):e}))),r()(this,"annotationsRefreshSubscription",null),r()(this,"previousJobId",void 0),r()(this,"openSingleMetricView",(async(e={})=>{const{services:{application:{navigateToUrl:t},share:a}}=this.props.kibana,i=this.getJob(e.job_id),n=i.data_counts,s=Object(v.g)(n.latest_record_timestamp,n.latest_bucket_timestamp),r={from:new Date(n.earliest_record_timestamp).toISOString(),to:new Date(s).toISOString(),mode:"absolute"};let o={};const l={};void 0!==e.timestamp&&void 0!==e.end_timestamp&&(o={zoom:{from:new Date(e.timestamp).toISOString(),to:new Date(e.end_timestamp).toISOString()}},e.timestamp<n.earliest_record_timestamp&&(r.from=new Date(e.timestamp).toISOString()),e.end_timestamp>n.latest_record_timestamp&&(r.to=new Date(e.end_timestamp).toISOString())),void 0!==e.detector_index&&(o.detectorIndex=e.detector_index),void 0!==e.partition_field_value&&(l[e.partition_field_name]=e.partition_field_value),void 0!==e.over_field_value&&(l[e.over_field_name]=e.over_field_value),void 0!==e.by_field_value&&(l[e.by_field_name]=e.by_field_value),o.entities=l;const c=a.url.locators.get(w.a),d=await c.getUrl({page:w.b.SINGLE_METRIC_VIEWER,pageState:{timeRange:r,refreshInterval:{display:"Off",pause:!0,value:0},jobIds:[i.job_id],query:{query_string:{analyze_wildcard:!0,query:"*"}},...o}},{absolute:!0});Object(h.a)("timeseriesexplorer",i.job_id,d),await t(d)})),r()(this,"onMouseOverRow",(e=>{void 0!==this.mouseOverRecord?this.mouseOverRecord.rowId!==e.rowId&&(j.a.rowMouseleave$.next({record:this.mouseOverRecord,type:"annotation"}),j.a.rowMouseenter$.next({record:e,type:"annotation"})):j.a.rowMouseenter$.next({record:e,type:"annotation"}),this.mouseOverRecord=e})),r()(this,"onMouseLeaveRow",(()=>{void 0!==this.mouseOverRecord&&(j.a.rowMouseleave$.next({record:this.mouseOverRecord,type:"annotation"}),this.mouseOverRecord=void 0)})),this.state={annotations:[],isLoading:!1,queryText:`event:(${O.b} or ${O.a})`,searchError:void 0,jobId:Array.isArray(this.props.jobs)&&this.props.jobs.length>0&&void 0!==this.props.jobs[0]?this.props.jobs[0].job_id:void 0,datafeedFlyoutVisible:!1,datafeedEnd:null},this.sorting={sort:{field:"timestamp",direction:"asc"}}}getAnnotations(){const e=this.props.jobs[0],t=e.data_counts;this.setState({isLoading:!0}),t.processed_record_count>0?f.ml.annotations.getAnnotations$({jobIds:[e.job_id],earliestMs:null,latestMs:null,maxAnnotations:x.a}).toPromise().then((e=>{this.setState(((t,a)=>({annotations:e.annotations[a.jobs[0].job_id]||[],errorMessage:void 0,isLoading:!1,jobId:a.jobs[0].job_id})))})).catch((e=>{console.log("Error loading list of annotations for jobs list:",e),this.setState({annotations:[],errorMessage:"Error loading the list of annotations for this job",isLoading:!1,jobId:void 0})})):this.setState({annotations:[],isLoading:!1,jobId:void 0})}getJob(e){if(Array.isArray(this.props.jobs)&&this.props.jobs.length>0){const t=this.props.jobs[0];if(void 0===e||t.job_id===e)return t}return g.a.getJob(e)}componentDidMount(){void 0===this.props.annotations&&Array.isArray(this.props.jobs)&&this.props.jobs.length>0&&(this.annotationsRefreshSubscription=y.b.subscribe((()=>{this.getAnnotations()})),Object(y.c)())}componentDidUpdate(){Array.isArray(this.props.jobs)&&this.props.jobs.length>0&&this.previousJobId!==this.props.jobs[0].job_id&&void 0===this.props.annotations&&!1===this.state.isLoading&&this.state.jobId!==this.props.jobs[0].job_id&&(Object(y.c)(),this.previousJobId=this.props.jobs[0].job_id)}componentWillUnmount(){null!==this.annotationsRefreshSubscription&&this.annotationsRefreshSubscription.unsubscribe()}render(){var e,t;const{isSingleMetricViewerLinkVisible:a=!0,isNumberBadgeVisible:i=!1,annotationUpdatesService:n}=this.props,{queryText:s,searchError:r}=this.state;if(void 0===this.props.annotations){if(!0===this.state.isLoading)return Object(k.jsx)(u.EuiFlexGroup,{justifyContent:"spaceAround"},Object(k.jsx)(u.EuiFlexItem,{grow:!1},Object(k.jsx)(u.EuiLoadingSpinner,{size:"l"})));if(void 0!==this.state.errorMessage)return Object(k.jsx)(u.EuiCallOut,{title:this.state.errorMessage,color:"danger",iconType:"cross"})}const c=this.props.annotations||this.state.annotations;if(0===c.length)return Object(k.jsx)(u.EuiCallOut,{title:Object(k.jsx)(m.FormattedMessage,{id:"xpack.ml.annotationsTable.annotationsNotCreatedTitle",defaultMessage:"No annotations created for this job"}),iconType:"iInCircle",role:"alert"},this.state.jobId&&Object(v.p)(this.getJob(this.state.jobId))&&Object(k.jsx)("p",null,Object(k.jsx)(m.FormattedMessage,{id:"xpack.ml.annotationsTable.howToCreateAnnotationDescription",defaultMessage:"To create an annotation, open the {linkToSingleMetricView}",values:{linkToSingleMetricView:Object(k.jsx)(u.EuiLink,{onClick:()=>this.openSingleMetricView()},Object(k.jsx)(m.FormattedMessage,{id:"xpack.ml.annotationsTable.howToCreateAnnotationDescription.singleMetricViewerLinkText",defaultMessage:"Single Metric Viewer"}))}})));const d=[{field:"annotation",name:p.i18n.translate("xpack.ml.annotationsTable.annotationColumnName",{defaultMessage:"Annotation"}),sortable:!0,width:"40%",scope:"row","data-test-subj":"mlAnnotationsColumnAnnotation"},{field:"timestamp",name:p.i18n.translate("xpack.ml.annotationsTable.fromColumnName",{defaultMessage:"From"}),dataType:"date",render:_.d,sortable:!0,"data-test-subj":"mlAnnotationsColumnFrom"},{field:"end_timestamp",name:p.i18n.translate("xpack.ml.annotationsTable.toColumnName",{defaultMessage:"To"}),dataType:"date",render:_.d,sortable:!0,"data-test-subj":"mlAnnotationsColumnTo"},{field:"modified_time",name:p.i18n.translate("xpack.ml.annotationsTable.lastModifiedDateColumnName",{defaultMessage:"Last modified date"}),dataType:"date",render:_.d,sortable:!0,"data-test-subj":"mlAnnotationsColumnModifiedDate"},{field:"modified_username",name:p.i18n.translate("xpack.ml.annotationsTable.lastModifiedByColumnName",{defaultMessage:"Last modified by"}),sortable:!0,"data-test-subj":"mlAnnotationsColumnModifiedBy"},{field:"event",name:p.i18n.translate("xpack.ml.annotationsTable.eventColumnName",{defaultMessage:"Event"}),sortable:!0,width:"10%","data-test-subj":"mlAnnotationsColumnEvent"}];Object(o.uniq)(c.map((e=>e.job_id))).length>1&&d.unshift({field:"job_id",name:p.i18n.translate("xpack.ml.annotationsTable.jobIdColumnName",{defaultMessage:"job ID"}),sortable:!0,"data-test-subj":"mlAnnotationsColumnJobId"}),i&&d.unshift({field:"key",name:p.i18n.translate("xpack.ml.annotationsTable.labelColumnName",{defaultMessage:"Label"}),sortable:e=>+e,width:"60px",render:e=>Object(k.jsx)(u.EuiBadge,{color:"default"},e),"data-test-subj":"mlAnnotationsColumnLabel"});const h=[];h.push({name:C,description:C,icon:"pencil",type:"icon",onClick:e=>{const t=e._id,a=c.find((e=>e._id===t));n.setValue(null!=a?a:e)},"data-test-subj":"mlAnnotationsActionEdit"}),this.state.jobId&&this.props.jobs[0].analysis_config.bucket_span&&h.push({name:T,description:T,icon:"visAreaStacked",type:"icon",onClick:e=>{this.setState({datafeedFlyoutVisible:!0,datafeedEnd:e.end_timestamp})},"data-test-subj":"mlAnnotationsActionViewDatafeed"}),a&&h.push({name:e=>Object(v.p)(this.getJob(e.job_id))?Object(k.jsx)(m.FormattedMessage,{id:"xpack.ml.annotationsTable.openInSingleMetricViewerTooltip",defaultMessage:"Open in Single Metric Viewer"}):Object(k.jsx)(u.EuiToolTip,{content:Object(k.jsx)(m.FormattedMessage,{id:"xpack.ml.annotationsTable.jobConfigurationNotSupportedInSingleMetricViewerTooltip",defaultMessage:"Job configuration not supported in Single Metric Viewer"})},Object(k.jsx)(m.FormattedMessage,{id:"xpack.ml.annotationsTable.openInSingleMetricViewerTooltip",defaultMessage:"Open in Single Metric Viewer"})),description:e=>Object(v.p)(this.getJob(e.job_id))?p.i18n.translate("xpack.ml.annotationsTable.openInSingleMetricViewerAriaLabel",{defaultMessage:"Open in Single Metric Viewer"}):p.i18n.translate("xpack.ml.annotationsTable.jobConfigurationNotSupportedInSingleMetricViewerAriaLabel",{defaultMessage:"Job configuration not supported in Single Metric Viewer"}),enabled:e=>Object(v.p)(this.getJob(e.job_id)),icon:"visLine",type:"icon",onClick:e=>this.openSingleMetricView(e),"data-test-subj":"mlAnnotationsActionOpenInSingleMetricViewer"});const f={[O.b]:0,[O.a]:0};c.forEach((e=>{var t;const a=null!==(t=e.event)&&void 0!==t?t:O.b;void 0===f[a]&&(f[a]=0),f[a]++}));const g=[{type:"field_value_selection",field:"event",name:"Event",multiSelect:"or",options:Object.entries(f).map((([e,t])=>({value:e,name:e,view:`${e} (${t})`}))),"data-test-subj":"mlAnnotationTableEventFilter"}];var j,x;(this.props.detectors&&d.push({name:p.i18n.translate("xpack.ml.annotationsTable.detectorColumnName",{defaultMessage:"Detector"}),width:"10%",render:e=>"detector_index"in e?this.props.detectors[e.detector_index].detector_description:""}),Array.isArray(null===(e=this.props.chartDetails)||void 0===e||null===(t=e.entityData)||void 0===t?void 0:t.entities))?(null===(j=this.props.chartDetails)||void 0===j||null===(x=j.entityData)||void 0===x||x.entities.forEach((e=>{"partition_field"===e.fieldType&&d.push({field:"partition_field_value",name:p.i18n.translate("xpack.ml.annotationsTable.partitionSMVColumnName",{defaultMessage:"Partition"}),sortable:!0}),"over_field"===e.fieldType&&d.push({field:"over_field_value",name:p.i18n.translate("xpack.ml.annotationsTable.overColumnSMVName",{defaultMessage:"Over"}),sortable:!0}),"by_field"===e.fieldType&&d.push({field:"by_field_value",name:p.i18n.translate("xpack.ml.annotationsTable.byColumnSMVName",{defaultMessage:"By"}),sortable:!0})})),g.push({type:"is",field:F,name:p.i18n.translate("xpack.ml.annotationsTable.seriesOnlyFilterName",{defaultMessage:"Filter to series"})})):(d.push({field:"partition_field_value",name:p.i18n.translate("xpack.ml.annotationsTable.partitionAEColumnName",{defaultMessage:"Partition"}),sortable:!0}),d.push({field:"over_field_value",name:p.i18n.translate("xpack.ml.annotationsTable.overAEColumnName",{defaultMessage:"Over"}),sortable:!0}),d.push({field:"by_field_value",name:p.i18n.translate("xpack.ml.annotationsTable.byAEColumnName",{defaultMessage:"By"}),sortable:!0}));const y={defaultQuery:s,box:{incremental:!0,schema:!0},filters:g};d.push({align:b.RIGHT_ALIGNMENT,width:"60px",name:p.i18n.translate("xpack.ml.annotationsTable.actionsColumnName",{defaultMessage:"Actions"}),actions:h,"data-test-subj":"mlAnnotationsColumnActions"},{field:F,name:F,dataType:"boolean",width:"0px",render:()=>""});const E=this.getAnnotationsWithExtraInfo(c);return Object(k.jsx)(l.Fragment,null,Object(k.jsx)(u.EuiInMemoryTable,{"data-test-subj":"mlAnnotationsTable",error:r,className:"eui-textOverflowWrap",compressed:!0,items:E,columns:d,pagination:{pageSizeOptions:[5,10,25]},sorting:this.sorting,search:y,rowProps:e=>({"data-test-subj":`mlAnnotationsTableRow row-${e._id}`,onMouseOver:()=>this.onMouseOverRow(e),onMouseLeave:()=>this.onMouseLeaveRow()})}),this.state.jobId&&this.state.datafeedFlyoutVisible&&this.state.datafeedEnd?Object(k.jsx)(M.a,{onClose:()=>{this.setState({datafeedFlyoutVisible:!1})},end:this.state.datafeedEnd,jobId:this.state.jobId}):null)}}const I=Object(E.withKibana)((e=>{const t=Object(l.useContext)(S.a);return Object(k.jsx)(annotations_table_AnnotationsTableUI,n()({annotationUpdatesService:t},e))}))},function(e,t,a){"use strict";a.d(t,"a",(function(){return p}));var i=a(15),n=a.n(i),s=a(41),r=a(2),o=a(40),l=a(66),c=a(73),d=a(11);const u=r.i18n.translate("xpack.ml.deleteJobCheckModal.shouldUnTagLabel",{defaultMessage:"Remove job from current space"});const p=({canDeleteCallback:e,onCloseCallback:t,refreshJobsCallback:a,jobType:p,jobIds:m,setDidUntag:b})=>{const[h,f]=Object(i.useState)(),[g,j]=Object(i.useState)(),[x,v]=Object(i.useState)(!1),[y,O]=Object(i.useState)(!1),[E,w]=Object(i.useState)(!1),[_,S]=Object(i.useState)(),{savedObjects:{canDeleteJob:M,removeJobFromCurrentSpace:k}}=Object(l.a)(),{displayErrorToast:C,displaySuccessToast:T}=Object(c.c)();Object(i.useEffect)((()=>{w(!0),M(p,m).then((t=>{const a=function(e){const t=Object.keys(e),{canDelete:a,canRemoveFromSpace:i}=e[t[0]];let n=!0;return t.length>1&&(n=t.every((t=>e[t].canDelete===a&&e[t].canRemoveFromSpace===i))),{canDelete:a,canRemoveFromSpace:i,canTakeAnyAction:n}}(t),{canDelete:i,canRemoveFromSpace:n,canTakeAnyAction:r}=a;if(r&&i&&!n)return void e();S(a);const{buttonText:l,modalText:c}=function(e,t){const{canDelete:a,canRemoveFromSpace:i,canTakeAnyAction:n}=t;if(!1===n)return{buttonText:Object(d.jsx)(s.FormattedMessage,{id:"xpack.ml.deleteJobCheckModal.buttonTextNoAction",defaultMessage:"Close"}),modalText:Object(d.jsx)(o.EuiText,null,Object(d.jsx)(s.FormattedMessage,{id:"xpack.ml.deleteJobCheckModal.modalTextNoAction",defaultMessage:"{ids} have different space permissions. When you delete multiple jobs, they must have the same permissions. Deselect the jobs and try deleting each job individually.",values:{ids:e.join(", ")}}))};const r={buttonText:Object(d.jsx)(s.FormattedMessage,{id:"xpack.ml.deleteJobCheckModal.buttonTextClose",defaultMessage:"Close"}),modalText:Object(d.jsx)(o.EuiText,null,Object(d.jsx)(s.FormattedMessage,{id:"xpack.ml.deleteJobCheckModal.modalTextClose",defaultMessage:"{ids} cannot be deleted and cannot be removed from the current space. This job is assigned to the * space and you do not have access to all spaces.",values:{ids:e.join(", ")}}))};return a?{buttonText:Object(d.jsx)(s.FormattedMessage,{id:"xpack.ml.deleteJobCheckModal.buttonTextCanDelete",defaultMessage:"Continue to delete {length, plural, one {# job} other {# jobs}}",values:{length:e.length}}),modalText:Object(d.jsx)(o.EuiText,null,Object(d.jsx)(s.FormattedMessage,{id:"xpack.ml.deleteJobCheckModal.modalTextCanDelete",defaultMessage:"{ids} can be deleted.",values:{ids:e.join(", ")}}))}:i?{buttonText:Object(d.jsx)(s.FormattedMessage,{id:"xpack.ml.deleteJobCheckModal.buttonTextCanUnTagConfirm",defaultMessage:"Remove from current space"}),modalText:Object(d.jsx)(o.EuiText,null,Object(d.jsx)(s.FormattedMessage,{id:"xpack.ml.deleteJobCheckModal.modalTextCanUnTag",defaultMessage:"{ids} cannot be deleted but can be removed from the current space.",values:{ids:e.join(", ")}}))}:r}(m,a);f(l),j(c)})),"function"==typeof b&&b(!1),w(!1)}),[]);const F=async()=>{O(!0);const e=await k(p,m);O(!1),"function"==typeof b&&b(!0),Object.entries(e).forEach((([e,{success:t,error:a}])=>{if(!1===t){const t=r.i18n.translate("xpack.ml.deleteJobCheckModal.unTagErrorTitle",{defaultMessage:"Error updating {id}",values:{id:e}});C(a,t)}else{v(!0);const t=r.i18n.translate("xpack.ml.deleteJobCheckModal.unTagSuccessTitle",{defaultMessage:"Successfully updated {id}",values:{id:e}});T(t)}})),t(),"function"==typeof a&&a()};return Object(d.jsx)(o.EuiModal,{onClose:t,"data-test-subj":"mlAnalyticsJobDeleteCheckOverlay"},!0===E&&Object(d.jsx)(n.a.Fragment,null,Object(d.jsx)(o.EuiModalBody,null,Object(d.jsx)(o.EuiFlexGroup,{justifyContent:"spaceAround"},Object(d.jsx)(o.EuiFlexItem,{grow:!1},Object(d.jsx)(o.EuiLoadingSpinner,{size:"xl"}))))),!1===E&&Object(d.jsx)(n.a.Fragment,null,Object(d.jsx)(o.EuiModalHeader,null,Object(d.jsx)(o.EuiModalHeaderTitle,null,Object(d.jsx)(s.FormattedMessage,{id:"xpack.ml.deleteJobCheckModal.modalTitle",defaultMessage:"Checking space permissions"}))),Object(d.jsx)(o.EuiModalBody,null,g),Object(d.jsx)(o.EuiModalFooter,null,Object(d.jsx)(o.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(d.jsx)(o.EuiFlexItem,{grow:!1},!x&&(null==_?void 0:_.canTakeAnyAction)&&(null==_?void 0:_.canRemoveFromSpace)&&(null==_?void 0:_.canDelete)&&Object(d.jsx)(o.EuiButtonEmpty,{isLoading:y,color:"primary",size:"s",onClick:F},u)),Object(d.jsx)(o.EuiFlexItem,{grow:!1},Object(d.jsx)(o.EuiButton,{size:"s",onClick:null==_||!_.canTakeAnyAction||null==_||!_.canRemoveFromSpace||null!=_&&_.canDelete?async()=>{null!=_&&_.canTakeAnyAction&&null!=_&&_.canDelete?e():t()}:F,fill:!0},h))))))}},function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var i=a(15),n=a(40),s=a(11);const r=({hasData:e,loading:t=!1,height:a,children:r})=>{const o=!0===t?!0===e?.3:0:1;return Object(s.jsx)(i.Fragment,null,Object(s.jsx)("div",{style:{height:"100%",opacity:o,transition:"opacity 0.2s"}},t&&!e?null:r),!0===t&&Object(s.jsx)(n.EuiFlexGroup,{justifyContent:"spaceAround",alignItems:"center",style:void 0!==a?{height:a,marginTop:`-${a}`}:{}},Object(s.jsx)(n.EuiFlexItem,{grow:!1},Object(s.jsx)(n.EuiLoadingSpinner,{size:"xl"}))))}},,,,,,,function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"a",(function(){return s}));let i=!1;function n(e){i=e}function s(){return i}},,function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));a(2);const i={DELETE:"delete",RESET:"reset",REVERT:"revert"};const n={"cluster:admin/xpack/ml/job/delete":i.DELETE,"cluster:admin/xpack/ml/job/reset":i.RESET,"cluster:admin/xpack/ml/job/model_snapshots/revert":i.REVERT};Object.keys(n)},function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var i=a(2),n=a(67);const s=new class CalendarService{async assignNewJobId(e,t){const{calendar_id:a}=e;try{await n.ml.updateCalendar({...e,calendarId:a,job_ids:[...e.job_ids,t]})}catch(e){throw new Error(i.i18n.translate("xpack.ml.calendarService.assignNewJobIdErrorMessage",{defaultMessage:"Unable to assign {jobId} to {calendarId}",values:{calendarId:a,jobId:t}}))}}async fetchCalendarsByIds(e){try{const t=await n.ml.calendars({calendarIds:e});return Array.isArray(t)?t:[t]}catch(t){throw new Error(i.i18n.translate("xpack.ml.calendarService.fetchCalendarsByIdsErrorMessage",{defaultMessage:"Unable to fetch calendars: {calendarIds}",values:{calendarIds:e.join(", ")}}))}}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"ElasticsearchSqlHighlightRules",{enumerable:!0,get:function(){return i.ElasticsearchSqlHighlightRules}}),Object.defineProperty(t,"ScriptHighlightRules",{enumerable:!0,get:function(){return i.ScriptHighlightRules}}),Object.defineProperty(t,"XJsonHighlightRules",{enumerable:!0,get:function(){return i.XJsonHighlightRules}}),Object.defineProperty(t,"XJsonMode",{enumerable:!0,get:function(){return n.XJsonMode}}),Object.defineProperty(t,"addXJsonToRules",{enumerable:!0,get:function(){return i.addXJsonToRules}}),Object.defineProperty(t,"installXJsonMode",{enumerable:!0,get:function(){return n.installXJsonMode}});var i=a(415),n=a(419)},function(e,t,a){"use strict";var i=a(122);Object.defineProperty(t,"__esModule",{value:!0}),t.ElasticsearchSqlHighlightRules=void 0;var n=i(a(171));const{TextHighlightRules:s}=n.default.acequire("ace/mode/text_highlight_rules"),r=n.default.acequire("ace/lib/oop"),o=function(){const e=this.createKeywordMapper({keyword:["describe|between|in|like|not|and|or|desc|select|from|where|having|group|by|orderasc|desc|pivot|for|in|as|show|columns|include|frozen|tables|escape|limit|rlike|all|distinct|is","avg|count|first|first_value|last|last_value|max|min|sum|kurtosis|mad|percentile|percentile_rank|skewness|stddev_pop|sum_of_squares|var_pop|histogram|case|coalesce|greatest|ifnull|iif|isnull|least|nullif|nvl|curdate|current_date|current_time|current_timestamp|curtime|dateadd|datediff|datepart|datetrunc|date_add|date_diff|date_part|date_trunc|day|dayname|dayofmonth|dayofweek|dayofyear|day_name|day_of_month|day_of_week|day_of_year|dom|dow|doy|hour|hour_of_day|idow|isodayofweek|isodow|isoweek|isoweekofyear|iso_day_of_week|iso_week_of_year|iw|iwoy|minute|minute_of_day|minute_of_hour|month|monthname|month_name|month_of_year|now|quarter|second|second_of_minute|timestampadd|timestampdiff|timestamp_add|timestamp_diff|today|week|week_of_year|year|abs|acos|asin|atan|atan2|cbrt|ceil|ceiling|cos|cosh|cot|degrees|e|exp|expm1|floor|log|log10|mod|pi|power|radians|rand|random|round|sign|signum|sin|sinh|sqrt|tan|truncate|ascii|bit_length|char|character_length|char_length|concat|insert|lcase|left|length|locate|ltrim|octet_length|position|repeat|replace|right|rtrim|space|substring|ucase|cast|convert|database|user|st_astext|st_aswkt|st_distance|st_geometrytype|st_geomfromtext|st_wkttosql|st_x|st_y|st_z|score","true|false","null|boolean|byte|short|integer|long|double|float|half_float|scaled_float|keyword|text|binary|date|ip|object|nested|time|interval_year|interval_month|interval_day|interval_hour|interval_minute|interval_second|interval_year_to_monthinteval_day_to_hour|interval_day_to_minute|interval_day_to_second|interval_hour_to_minute|interval_hour_to_secondinterval_minute_to_second|geo_point|geo_shape|shape"].join("|")},"identifier",!0);this.$rules={start:[{token:"comment",regex:"--.*$"},{token:"comment",start:"/\\*",end:"\\*/"},{token:"string",regex:'".*?"'},{token:"constant",regex:"'.*?'"},{token:"string",regex:"`.*?`"},{token:"entity.name.function",regex:"[+-]?\\d+(?:(?:\\.\\d*)?(?:[eE][+-]?\\d+)?)?\\b"},{token:e,regex:"[a-zA-Z_$][a-zA-Z0-9_$]*\\b"},{token:"keyword.operator",regex:"⇐|<⇒|\\*|\\.|\\:\\:|\\+|\\-|\\/|\\/\\/|%|&|\\^|~|<|>|<=|=>|==|!=|<>|="},{token:"paren.lparen",regex:"[\\(]"},{token:"paren.rparen",regex:"[\\)]"},{token:"text",regex:"\\s+"}]},this.normalizeRules()};t.ElasticsearchSqlHighlightRules=o,r.inherits(o,s)},function(e,t,a){"use strict";var i=a(122);Object.defineProperty(t,"__esModule",{value:!0}),t.ScriptHighlightRules=o;var n=i(a(171));const s=n.default.acequire("ace/lib/oop"),{TextHighlightRules:r}=n.default.acequire("ace/mode/text_highlight_rules");function o(){this.name="ScriptHighlightRules",this.$rules={start:[{token:"script.comment",regex:"\\/\\/.*$"},{token:"script.string.regexp",regex:"[/](?:(?:\\[(?:\\\\]|[^\\]])+\\])|(?:\\\\/|[^\\]/]))*[/]\\w*\\s*(?=[).,;]|$)"},{token:"script.string",regex:"['](?:(?:\\\\.)|(?:[^'\\\\]))*?[']"},{token:"script.constant.numeric",regex:"0[xX][0-9a-fA-F]+\\b"},{token:"script.constant.numeric",regex:"[+-]?\\d+(?:(?:\\.\\d*)?(?:[eE][+-]?\\d+)?)?\\b"},{token:"script.constant.language.boolean",regex:"(?:true|false)\\b"},{token:"script.keyword",regex:"def|int|long|byte|String|float|double|char|null|if|else|while|do|for|continue|break|new|try|catch|throw|this|instanceof|return|ctx"},{token:"script.text",regex:"[a-zA-Z_$][a-zA-Z0-9_$]*\\b"},{token:"script.keyword.operator",regex:"\\?\\.|\\*\\.|=~|==~|!|%|&|\\*|\\-\\-|\\-|\\+\\+|\\+|~|===|==|=|!=|!==|<=|>=|<<=|>>=|>>>=|<>|<|>|->|!|&&|\\|\\||\\?\\:|\\*=|%=|\\+=|\\-=|&=|\\^=|\\b(?:in|instanceof|new|typeof|void)"},{token:"script.lparen",regex:"[[({]"},{token:"script.rparen",regex:"[\\])}]"},{token:"script.text",regex:"\\s+"}]}}s.inherits(o,r)},function(e,t,a){"use strict";a.d(t,"a",(function(){return h}));var i=a(15),n=a.n(i),s=a(40),r=a(2),o=a(41),l=a(67),c=a(361),d=a(24),u=a(73),p=a(66),m=a(72),b=a(11);const h=n.a.memo((({jobId:e,start:t,end:a,actionHandler:h,refreshJobList:f,showClearButton:g})=>{const j=Object(m.e)("canCreateJob"),[x,v]=Object(i.useState)([]),[y,O]=Object(i.useState)([]),[E,w]=Object(i.useState)(!1),[_,S]=Object(i.useState)(""),[M,k]=Object(i.useState)(!1),C=Object(u.c)(),{jobs:{clearJobAuditMessages:T}}=Object(p.a)(),F=async()=>{w(!0);try{const i=await l.ml.jobs.jobAuditMessages({jobId:e,start:t,end:a});v(i.messages),O(i.notificationIndices),w(!1)}catch(e){w(!1),C.displayErrorToast(e,r.i18n.translate("xpack.ml.jobService.jobAuditMessagesErrorTitle",{defaultMessage:"Error loading job messages"})),S(Object(d.b)(e))}},I=Object(i.useCallback)(F,[e]),D=Object(i.useCallback)((async()=>{k(!0);try{await T(e,y),k(!1),"function"==typeof f&&f()}catch(e){k(!1),C.displayErrorToast(e,r.i18n.translate("xpack.ml.jobMessages.clearJobAuditMessagesErrorTitle",{defaultMessage:"Error clearing job message warnings and errors"}))}}),[e,JSON.stringify(y)]);Object(i.useEffect)((()=>{F()}),[]);const A=0===y.length,L=Object(b.jsx)(s.EuiButton,{size:"s",isLoading:M,isDisabled:A,onClick:D,"data-test-subj":"mlJobMessagesClearButton"},Object(b.jsx)(o.FormattedMessage,{id:"xpack.ml.jobMessages.clearMessagesLabel",defaultMessage:"Clear notifications"}));return Object(b.jsx)(n.a.Fragment,null,j&&g?Object(b.jsx)(s.EuiSpacer,null):null,Object(b.jsx)(s.EuiFlexGroup,{direction:"column"},j&&g?Object(b.jsx)(s.EuiFlexItem,{grow:!1},Object(b.jsx)("div",null,!0===A?Object(b.jsx)(s.EuiToolTip,{content:r.i18n.translate("xpack.ml.jobMessages.clearJobAuditMessagesDisabledTooltip",{defaultMessage:"Notification clearing not supported."})},L):Object(b.jsx)(s.EuiToolTip,{content:r.i18n.translate("xpack.ml.jobMessages.clearJobAuditMessagesTooltip",{defaultMessage:"Clears warning icon from jobs list for messages produced in the last 24 hours."})},L))):null,Object(b.jsx)(s.EuiFlexItem,{grow:!1},Object(b.jsx)(c.a,{refreshMessage:I,messages:x,loading:E,error:_,actionHandler:h}))))}))},function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var i=a(15),n=a(44),s=a(278),r=a(11);const o=Object(n.timeFormatter)(Object(n.niceTimeFormatByDay)(3));function l(e){return(Math.round(100*e)/100).toString()}const c=({chartData:e})=>{const t=Object(s.b)(e);return Object(r.jsx)(i.Fragment,null,Object(r.jsx)(n.Axis,{id:"bottom",position:n.Position.Bottom,showOverlappingTicks:!0,tickFormat:o}),Object(r.jsx)(n.Axis,{id:"left",position:n.Position.Left,tickFormat:l,domain:t}))}},function(e,t,a){"use strict";function i(e){const t=!1;if(void 0===e)return{fit:t,min:NaN,max:NaN};if(0===e.length)return{min:0,max:0,fit:t};let a=Number.MIN_VALUE,i=Number.MAX_VALUE;e.forEach((e=>{a=Math.max(e.value,a),i=Math.min(e.value,i)}));const n=.1*(a-i);return a+=n,i-=n,{min:i,max:a,fit:t}}function n(e){return 0===e.length?{min:0,max:0}:{min:e[0].time,max:e[e.length-1].time}}a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return n}))},function(e,t,a){"use strict";let i;a.d(t,"a",(function(){return i})),function(e){e[e.NO_EXAMPLES=0]="NO_EXAMPLES",e[e.FAILED_TO_TOKENIZE=1]="FAILED_TO_TOKENIZE",e[e.TOO_MANY_TOKENS=2]="TOO_MANY_TOKENS",e[e.TOKEN_COUNT=3]="TOKEN_COUNT",e[e.MEDIAN_LINE_LENGTH=4]="MEDIAN_LINE_LENGTH",e[e.NULL_VALUES=5]="NULL_VALUES",e[e.INSUFFICIENT_PRIVILEGES=6]="INSUFFICIENT_PRIVILEGES"}(i||(i={}))},function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var i=a(15),n=a(44),s=a(7),r=a(1),o=a(11);function l(e){return{line:{stroke:Object(s.j)(e),strokeWidth:3,opacity:1}}}const c=({anomalyData:e})=>{const t=function(e){const t={critical:[],major:[],minor:[],warning:[],unknown:[],low:[]};return e.forEach((e=>{0!==e.value&&t[e.severity].push({dataValue:e.time})})),t}(void 0===e?[]:e);return Object(o.jsx)(i.Fragment,null,Object(o.jsx)(n.LineAnnotation,{id:"low",domainType:n.AnnotationDomainType.XDomain,dataValues:t.low,style:l(r.c.LOW),hideTooltips:!0}),Object(o.jsx)(n.LineAnnotation,{id:"warning",domainType:n.AnnotationDomainType.XDomain,dataValues:t.warning,style:l(r.c.WARNING),hideTooltips:!0}),Object(o.jsx)(n.LineAnnotation,{id:"minor",domainType:n.AnnotationDomainType.XDomain,dataValues:t.minor,style:l(r.c.MINOR),hideTooltips:!0}),Object(o.jsx)(n.LineAnnotation,{id:"major",domainType:n.AnnotationDomainType.XDomain,dataValues:t.major,style:l(r.c.MAJOR),hideTooltips:!0}),Object(o.jsx)(n.LineAnnotation,{id:"critical",domainType:n.AnnotationDomainType.XDomain,dataValues:t.critical,style:l(r.c.CRITICAL),hideTooltips:!0}))}},function(e,t,a){"use strict";a.d(t,"c",(function(){return l})),a.d(t,"b",(function(){return c})),a.d(t,"a",(function(){return d}));var i=a(8),n=a(83),s=a(74),r=a(22),o=a(67);function l(e,t,a){return new Promise(((a,i)=>{const n={...u(e,t),...p(e,t),...m(e,t),...b(e,t),...h(e,t),...f(e,t),...g(e,t)},r={...j(e,t)};void 0!==n.custom_settings&&(n.custom_settings=function(e,t){let a={};void 0!==e.custom_settings&&(a={...e.custom_settings},void 0===e.custom_settings.created_by||void 0===e.detectors&&!Object.keys(t).length||Object(s.r)(a));return a}(n,r));const l=()=>{(function(e,t){return new Promise(((a,i)=>{if(Object.keys(e).length){const n=t.datafeed_config.datafeed_id;o.ml.updateDatafeed({datafeedId:n,datafeedConfig:e}).then((()=>{a()})).catch((e=>{i(e)}))}else a()}))})(r,e).then((()=>{a()})).catch((e=>{i(e)}))};Object.keys(n).length?o.ml.updateJob({jobId:e.job_id,job:n}).then((()=>{l()})).catch((e=>{i(e)})):l()}))}function c(e){return new Promise(((t,a)=>{Object(r.i)().find({type:"dashboard",fields:["title"],perPage:e}).then((e=>{const a=e.savedObjects;if(void 0!==a){const e=a.map((e=>({id:e.id,title:e.attributes.title})));e.sort(((e,t)=>e.title.localeCompare(t.title))),t(e)}})).catch((e=>{a(e)}))}))}function d(e){return new Promise(((t,a)=>{Object(r.b)().find("*",e).then((e=>{const a=e.sort(((e,t)=>e.title.localeCompare(t.title)));t(a)})).catch((e=>{a(e)}))}))}function u(e,t){const a=t.description;return t.description!==e.description?{description:a}:{}}function p(e,t){const a=t.groups;if(void 0!==t.groups){return 0===Object(i.difference)(e.groups,a).length+Object(i.difference)(a,e.groups).length?{}:{groups:a}}return{}}function m(e,t){const a=Object(n.d)(),i={};if(void 0!==e.analysis_limits.model_memory_limit){let{mml:n}=t;""===n&&(n=a.max_model_memory_limit),n!==e.analysis_limits.model_memory_limit&&(i.analysis_limits={model_memory_limit:n})}return i}function b(e,t){const a=t.modelSnapshotRetentionDays;return a!==e.model_snapshot_retention_days?{model_snapshot_retention_days:a}:{}}function h(e,t){const a=t.dailyModelSnapshotRetentionAfterDays;return a!==e.daily_model_snapshot_retention_after_days?{daily_model_snapshot_retention_after_days:a}:{}}function f(e,t){const a=[],i=t.detectorDescriptions.map(((e,t)=>({detector_index:t,description:e})));return e.analysis_config.detectors.forEach((e=>{i[e.detector_index].description!==e.detector_description&&a.push(i[e.detector_index])})),a.length?{detectors:a}:{}}function g(e,t){const a={};return t&&t.customUrls&&(a.custom_settings=e.custom_settings||{},a.custom_settings.custom_urls=t.customUrls),a}function j(e,t){const a={};if(void 0!==e.datafeed_config){const i=JSON.stringify(e.datafeed_config.query),n=JSON.parse(t.datafeedQuery);i!==JSON.stringify(n)&&(a.query=n),e.datafeed_config.query_delay!==t.datafeedQueryDelay&&(a.query_delay=t.datafeedQueryDelay),e.datafeed_config.frequency!==t.datafeedFrequency&&""!==t.datafeedFrequency&&(a.frequency=t.datafeedFrequency),e.datafeed_config.scroll_size!==t.datafeedScrollSize&&(a.scroll_size=t.datafeedScrollSize)}return a}},function(e,t,a){t.format_value=a(157).format_value,t.parse_value=a(157).parse_value,t.RRule=a(177).RRule,t.parse_calendar=a(283).parse_calendar,t.ParseError=a(283).ParseError,t.CalendarObject=a(109).CalendarObject,t.CalendarProperty=a(109).CalendarProperty,t.iCalendar=a(178).iCalendar,t.VEvent=a(443).VEvent,t.VTimezone=a(444).VTimezone,t.PRODID="-//Tri Tech Computers//node-icalendar//EN"},function(e,t,a){a(212);var i=a(158),n=a(157),s=a(109).CalendarObject,r=a(109).schema,o=a(109).properties,l=a(178).iCalendar,c=n.parse_value,d=(n.format_value,t.ParseError=function(){Error.apply(this,arguments)});function u(e,t){var a=e.calendar;return function i(n,l,d){if("BEGIN"==n){var p=(r[l]||{}).factory,m=void 0!==p?new p(a):new s(a,l);return u(m,(function(){return e.addComponent(m),i.apply(this,arguments)}))}if("END"==n)return t;var b=o[n]||{};return l=c(b.type,l,d,a,b.list),e.addProperty(n,l,d),i}}function p(e){var t,a,i={},n=PROP_NAME,s=0;function r(e){n=e,s=l+1}function o(){return e.substr(s,l-s)}for(var l=0,c=e.length;l<c;++l){var d=e[l];switch(n){case PROP_NAME:":"!=d&&";"!=d||(t=o(),n=PARAM_OR_VALUE,--l);break;case PARAM_OR_VALUE:if(":"==d)r(PROP_VALUE);else{if(";"!=d)throw new Error("Parse error");r(PARAM_NAME)}break;case PARAM_NAME:"="==d&&(a=o(),r(MAYBE_QUOTED_PARAM));break;case MAYBE_QUOTED_PARAM:'"'==d?r(QUOTED_PARAM_VALUE):n=PARAM_VALUE;break;case PARAM_VALUE:":"!=d&&";"!=d||(i[a]=o(),n=PARAM_OR_VALUE,--l);break;case QUOTED_PARAM_VALUE:'"'==d&&(i[a]=o(),n=PARAM_OR_VALUE);break;case PROP_VALUE:l=c;break;default:throw new Error("Invalid parser state")}}return[t,o(),i]}i.inherits(d,Error),PROP_NAME=0,PARAM_NAME=1,PARAM_VALUE=2,MAYBE_QUOTED_PARAM=3,QUOTED_PARAM_VALUE=4,PARAM_OR_VALUE=5,PROP_VALUE=6,t.parse_calendar=function(e,a){e=e.split(/\r?\n/);var i=new l(!0);if(a)if("string"==typeof a&&(a=t.parse_calendar(a)),a instanceof l)for(var n=a.getComponents("VTIMEZONE"),s=0;s<n.length;++s)i.addComponent(n[s]);else i.addComponent(n[s]);var r,o,c,m=(r="BEGIN",o="VCALENDAR",c=u(i),function(e,t,a){if(e!=r)throw new d("Expected "+r+" got "+e);if(o&&o!=t)throw new d("Expected "+o+" got "+t);return c});for(s=0;s<e.length-1;++s)if(e[s].length){if(void 0===m)throw new d("Mismatched BEGIN/END tags");for(var b=s;b+1<e.length&&(" "===e[b+1][0]||"\t"===e[b+1][0]);)++b;var h=e[s];if(b!=s){for(var f=e.slice(s,b+1),g=1;g<f.length;++g)f[g]=f[g].substr(1);h=f.join(""),s=b}m=m.apply(null,p(h))}if(void 0!==m)throw new d("Unable to parse calendar data; END:VCALENDAR not found!");return i}},function(e,t,a){"use strict";let i;a.d(t,"a",(function(){return i})),function(e){e[e.ADD_REQUEST_MESSAGE=0]="ADD_REQUEST_MESSAGE",e[e.RESET_REQUEST_MESSAGES=1]="RESET_REQUEST_MESSAGES",e[e.CLOSE_MODAL=2]="CLOSE_MODAL",e[e.OPEN_MODAL=3]="OPEN_MODAL",e[e.RESET_ADVANCED_EDITOR_MESSAGES=4]="RESET_ADVANCED_EDITOR_MESSAGES",e[e.RESET_FORM=5]="RESET_FORM",e[e.SET_ADVANCED_EDITOR_RAW_STRING=6]="SET_ADVANCED_EDITOR_RAW_STRING",e[e.SET_FORM_STATE=7]="SET_FORM_STATE",e[e.SET_INDEX_PATTERN_TITLES=8]="SET_INDEX_PATTERN_TITLES",e[e.SET_IS_JOB_CREATED=9]="SET_IS_JOB_CREATED",e[e.SET_IS_JOB_STARTED=10]="SET_IS_JOB_STARTED",e[e.SET_IS_MODAL_BUTTON_DISABLED=11]="SET_IS_MODAL_BUTTON_DISABLED",e[e.SET_IS_MODAL_VISIBLE=12]="SET_IS_MODAL_VISIBLE",e[e.SET_JOB_CONFIG=13]="SET_JOB_CONFIG",e[e.SET_JOB_IDS=14]="SET_JOB_IDS",e[e.SWITCH_TO_ADVANCED_EDITOR=15]="SWITCH_TO_ADVANCED_EDITOR",e[e.SWITCH_TO_FORM=16]="SWITCH_TO_FORM",e[e.SET_ESTIMATED_MODEL_MEMORY_LIMIT=17]="SET_ESTIMATED_MODEL_MEMORY_LIMIT",e[e.SET_JOB_CLONE=18]="SET_JOB_CLONE"}(i||(i={}))},function(e,t,a){"use strict";a.d(t,"a",(function(){return v})),a.d(t,"b",(function(){return k}));var i=a(2),n=a(8),s=a(52),r=a.n(s),o=a(286),l=a(170),c=a(284),d=a(118),u=a(74),p=a(17),m=a(27),b=a(82),h=a(70),f=a(43),g=a(146);const j=`${m.a.slice(0,m.a.length-1).join(", ")} or ${[...m.a].pop()}`,x=i.i18n.translate("xpack.ml.dataframe.analytics.create.modelMemoryUnitsInvalidError",{defaultMessage:"Model memory limit data unit unrecognized. It must be {str}",values:{str:j}});function v(e){return null===e?null:Object.keys(e).reduce(((t,a)=>("min"===a&&t.push(i.i18n.translate("xpack.ml.dataframe.analytics.create.modelMemoryUnitsMinError",{defaultMessage:"Model memory limit is lower than estimated value {mml}",values:{mml:e.min.minValue}})),"invalidUnits"===a&&t.push(i.i18n.translate("xpack.ml.dataframe.analytics.create.modelMemoryUnitsInvalidError",{defaultMessage:"Model memory limit data unit unrecognized. It must be {str}",values:{str:j}})),t)),[])}const y=e=>{var t;const{jobConfig:a}=e,i=null==a||null===(t=a.source)||void 0===t?void 0:t.index;return"string"==typeof i?i:Array.isArray(i)?i.join(","):""},O=(e,t)=>{let a=0===Object.keys(f.indexPatterns.validate(e)).length;return a&&("string"==typeof t&&(a=!t.includes(",")),Array.isArray(t)&&(a=!t.some((e=>null==e?void 0:e.includes(","))))),a},E=e=>"number"==typeof e&&e>=h.e&&Number.isInteger(e),w=e=>{var t,a,n,s,r,l;const{jobIdEmpty:c,jobIdValid:d,jobIdExists:p,jobType:m,createIndexPattern:f}=e.form,{jobConfig:g}=e;e.advancedEditorMessages=[];const j=y(e),v=""===j,w=null==g||null===(t=g.source)||void 0===t?void 0:t.index,_=O(j,w),S=null!==(a=null==g||null===(n=g.dest)||void 0===n?void 0:n.index)&&void 0!==a?a:"",M=""===S,k=Object(o.a)(S),C=void 0!==e.indexPatternsMap[S],T=(null==g||null===(s=g.analyzed_fields)||void 0===s?void 0:s.includes)||[],F="string"==typeof(null==g||null===(r=g.dest)||void 0===r?void 0:r.results_field)&&""===(null==g||null===(l=g.dest)||void 0===l?void 0:l.results_field.trim()),I=g.model_memory_limit,D=""===I||void 0===I;if(!D&&void 0!==I){const{valid:t}=Object(u.w)(I);e.form.modelMemoryLimitUnitValid=t}let A=!1,L=!0,R=!0,P=!0;if(void 0!==g.analysis||m!==b.a.CLASSIFICATION&&m!==b.a.REGRESSION||(A=!0),void 0!==g.analysis&&(Object(h.y)(g.analysis)||Object(h.v)(g.analysis))){const t=Object(h.o)(g.analysis)||"";A=""===t,!A&&T.length>0&&!T.includes(t)&&(L=!1,e.advancedEditorMessages.push({error:i.i18n.translate("xpack.ml.dataframe.analytics.create.advancedEditorMessage.includesInvalid",{defaultMessage:"The dependent variable must be included."}),message:""}));const a=Object(h.t)(g.analysis);void 0!==a&&(isNaN(a)||"number"!=typeof a||a<h.k||a>h.j)&&(R=!1,e.advancedEditorMessages.push({error:i.i18n.translate("xpack.ml.dataframe.analytics.create.advancedEditorMessage.trainingPercentInvalid",{defaultMessage:"The training percent must be a number between {min} and {max}.",values:{min:h.k,max:h.j}}),message:""}));const n=Object(h.q)(g.analysis);void 0!==n&&(P=E(n),!1===P&&e.advancedEditorMessages.push({error:i.i18n.translate("xpack.ml.dataframe.analytics.create.advancedEditorMessage.numTopFeatureImportanceValuesInvalid",{defaultMessage:"The value for num_top_feature_importance_values must be an integer of {min} or higher.",values:{min:0}}),message:""}))}return v?e.advancedEditorMessages.push({error:i.i18n.translate("xpack.ml.dataframe.analytics.create.advancedEditorMessage.sourceIndexNameEmpty",{defaultMessage:"The source index name must not be empty."}),message:""}):_||e.advancedEditorMessages.push({error:i.i18n.translate("xpack.ml.dataframe.analytics.create.advancedEditorMessage.sourceIndexNameValid",{defaultMessage:"Invalid source index name."}),message:""}),M?e.advancedEditorMessages.push({error:i.i18n.translate("xpack.ml.dataframe.analytics.create.advancedEditorMessage.destinationIndexNameEmpty",{defaultMessage:"The destination index name must not be empty."}),message:""}):C&&!f?e.advancedEditorMessages.push({error:i.i18n.translate("xpack.ml.dataframe.analytics.create.advancedEditorMessage.destinationIndexNameExistsWarn",{defaultMessage:"An index with this destination index name already exists. Be aware that running this analytics job will modify this destination index."}),message:""}):k||e.advancedEditorMessages.push({error:i.i18n.translate("xpack.ml.dataframe.analytics.create.advancedEditorMessage.destinationIndexNameValid",{defaultMessage:"Invalid destination index name."}),message:""}),F&&e.advancedEditorMessages.push({error:i.i18n.translate("xpack.ml.dataframe.analytics.create.advancedEditorMessage.resultsFieldEmptyString",{defaultMessage:"The results field must not be an empty string."}),message:""}),A&&e.advancedEditorMessages.push({error:i.i18n.translate("xpack.ml.dataframe.analytics.create.advancedEditorMessage.dependentVariableEmpty",{defaultMessage:"The dependent variable field must not be empty."}),message:""}),D&&e.advancedEditorMessages.push({error:i.i18n.translate("xpack.ml.dataframe.analytics.create.advancedEditorMessage.modelMemoryLimitEmpty",{defaultMessage:"The model memory limit field must not be empty."}),message:""}),e.form.modelMemoryLimitUnitValid||e.advancedEditorMessages.push({error:x,message:""}),e.form.destinationIndexPatternTitleExists=C,e.isValid=L&&R&&e.form.modelMemoryLimitUnitValid&&!c&&d&&!p&&!v&&_&&!M&&k&&!F&&!A&&!D&&P&&(!C||!f),e};const _=Object(n.memoize)((e=>Object(p.a)(Object(p.f)(),function(e){return t=>{if(!t||!e)return null;const a=r()(t.toUpperCase()).value();return r()(e.toUpperCase()).value()>a?{min:{minValue:e,actualValue:t}}:null}}(e),Object(p.c)()))),S=Object(n.memoize)(((e,t)=>_(e)(t)),((...e)=>e.join("_"))),M=e=>{const{jobIdEmpty:t,jobIdValid:a,jobIdExists:i,jobType:n,sourceIndexNameEmpty:s,sourceIndexNameValid:r,destinationIndexNameEmpty:o,destinationIndexNameValid:l,destinationIndexPatternTitleExists:c,createIndexPattern:d,dependentVariable:u,modelMemoryLimit:p,numTopFeatureImportanceValuesValid:m}=e.form,{estimatedModelMemoryLimit:h}=e,f=void 0===n,g=(n===b.a.REGRESSION||n===b.a.CLASSIFICATION)&&""===u,j=S(h,p),x=null!==j&&(void 0!==j.invalidUnits||!0===j.required);return e.form.modelMemoryLimitValidationResult=j,e.isValid=!f&&!x&&!t&&a&&!i&&!s&&r&&!o&&l&&!g&&m&&(!c||!d),e};function k(e,t){var a;switch(t.type){case c.a.ADD_REQUEST_MESSAGE:const i=e.requestMessages;return i.push(t.requestMessage),{...e,requestMessages:i};case c.a.RESET_REQUEST_MESSAGES:return{...e,requestMessages:[]};case c.a.RESET_ADVANCED_EDITOR_MESSAGES:return{...e,advancedEditorMessages:[]};case c.a.RESET_FORM:return Object(d.e)();case c.a.SET_ADVANCED_EDITOR_RAW_STRING:let s,r=!1;try{s=JSON.parse(Object(l.b)(t.advancedEditorRawString));const a=e.form.runtimeMappings&&s.source.runtime_mappings&&!Object(n.isEqual)(e.form.runtimeMappings,s.source.runtime_mappings);r=Object(g.d)(s)||a}catch(a){return{...e,advancedEditorRawString:t.advancedEditorRawString,isAdvancedEditorValidJson:!1,disableSwitchToForm:!0,advancedEditorMessages:[]}}return{...w({...e,jobConfig:s}),advancedEditorRawString:t.advancedEditorRawString,isAdvancedEditorValidJson:!0,disableSwitchToForm:r};case c.a.SET_FORM_STATE:const b={...e.form,...t.payload};if(void 0!==t.payload.destinationIndex&&(b.destinationIndexNameEmpty=""===b.destinationIndex,b.destinationIndexNameValid=Object(o.a)(b.destinationIndex),b.destinationIndexPatternTitleExists=void 0!==e.indexPatternsMap[b.destinationIndex]),void 0!==t.payload.jobId&&(b.jobIdEmpty=""===b.jobId,b.jobIdValid=Object(u.i)(b.jobId),b.jobIdInvalidMaxLength=!!Object(p.b)(m.b)(b.jobId)),void 0!==t.payload.sourceIndex){b.sourceIndexNameEmpty=""===b.sourceIndex;const e=f.indexPatterns.validate(b.sourceIndex);b.sourceIndexNameValid=0===Object.keys(e).length}return void 0!==t.payload.numTopFeatureImportanceValues&&(b.numTopFeatureImportanceValuesValid=E(null==b?void 0:b.numTopFeatureImportanceValues)),e.isAdvancedEditorEnabled?w({...e,form:b}):M({...e,form:b});case c.a.SET_INDEX_PATTERN_TITLES:{const a={...e,...t.payload};return a.form.destinationIndexPatternTitleExists=void 0!==a.indexPatternsMap[a.form.destinationIndex],a}case c.a.SET_IS_JOB_CREATED:return{...e,isJobCreated:t.isJobCreated};case c.a.SET_IS_JOB_STARTED:return{...e,isJobStarted:t.isJobStarted};case c.a.SET_JOB_CONFIG:return w({...e,jobConfig:t.payload});case c.a.SWITCH_TO_ADVANCED_EDITOR:const h=Object(d.f)(e.form),j=Object(g.d)(h);return w({...e,advancedEditorRawString:JSON.stringify(h,null,2),isAdvancedEditorEnabled:!0,disableSwitchToForm:j,hasSwitchedToEditor:!0,jobConfig:h});case c.a.SWITCH_TO_FORM:const{jobConfig:x}=e,{jobId:v}=e.form,_=Object(d.d)(x,!1);"string"==typeof v&&""!==v.trim()&&(_.jobId=v),_.jobIdEmpty=""===v,_.jobIdValid=Object(u.i)(v),_.jobIdInvalidMaxLength=!!Object(p.b)(m.b)(v),_.destinationIndexNameEmpty=""===_.destinationIndex,_.destinationIndexNameValid=Object(o.a)(_.destinationIndex||""),_.destinationIndexPatternTitleExists=void 0!==e.indexPatternsMap[_.destinationIndex||""],void 0!==_.numTopFeatureImportanceValues&&(_.numTopFeatureImportanceValuesValid=E(_.numTopFeatureImportanceValues));const S=y(e),k=null==x||null===(a=x.source)||void 0===a?void 0:a.index,C=O(S,k);return _.sourceIndexNameValid=C,M({...e,form:_,isAdvancedEditorEnabled:!1,advancedEditorRawString:JSON.stringify(x,null,2),jobConfig:x});case c.a.SET_ESTIMATED_MODEL_MEMORY_LIMIT:return{...e,estimatedModelMemoryLimit:t.value};case c.a.SET_JOB_CLONE:return{...e,cloneJob:t.cloneJob}}return e}},function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const i=window;function n(e){return"string"==typeof e&&e===e.toLowerCase()&&/^[^\*\\/\?"<>|\s,#:]+$/.test(e)&&/^[^-_\+]+$/.test(e.charAt(0))&&"."!==e&&".."!==e&&function(e){return!(i.TextEncoder&&new i.TextEncoder("utf-8").encode(e).length>255)&&e.length<=255}(e)}},function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var i=a(15);const n=[10,25,50];function s(e,t,a){const{pageIndex:s,pageSize:r,sortField:o,sortDirection:l}=t;return{onTableChange:Object(i.useCallback)((({page:e,sort:i})=>{var n,s,r,o;const l={pageIndex:null!==(n=null==e?void 0:e.index)&&void 0!==n?n:t.pageIndex,pageSize:null!==(s=null==e?void 0:e.size)&&void 0!==s?s:t.pageSize,sortField:null!==(r=null==i?void 0:i.field)&&void 0!==r?r:t.sortField,sortDirection:null!==(o=null==i?void 0:i.direction)&&void 0!==o?o:t.sortDirection};a(l)}),[t,a]),pagination:Object(i.useMemo)((()=>({pageIndex:s,pageSize:r,totalItemCount:e.length,pageSizeOptions:n})),[e,s,r]),sorting:Object(i.useMemo)((()=>({sort:{field:o,direction:l}})),[o,l])}}},function(e,t,a){e.exports=a(20)(2972)},function(e,t,a){e.exports=a(20)(3021)},function(e,t,a){e.exports=a(291)},function(e,t,a){var i=a(292),n=a(180),s=a(293),r=a(114);e.exports=function(e,t){return(r(e)?i:n)(e,s(t))}},function(e,t,a){e.exports=a(20)(2978)},function(e,t,a){e.exports=a(20)(2938)},function(e,t,a){var i=a(476),n=a(477),s=a(123),r=a(114);e.exports=function(e,t){return(r(e)?i:n)(e,s(t,3))}},function(e,t,a){e.exports=a(20)(1246)},function(e,t,a){e.exports=a(20)(3025)},function(e,t,a){var i=a(160);e.exports=function(e){return e==e&&!i(e)}},function(e,t){e.exports=function(e,t){return function(a){return null!=a&&(a[e]===t&&(void 0!==t||e in Object(a)))}}},function(e,t,a){var i=a(483),n=a(300);e.exports=function(e,t){return null!=e&&n(e,t,i)}},function(e,t,a){var i=a(217),n=a(218),s=a(114),r=a(301),o=a(484),l=a(181);e.exports=function(e,t,a){for(var c=-1,d=(t=i(t,e)).length,u=!1;++c<d;){var p=l(t[c]);if(!(u=null!=e&&a(e,p)))break;e=e[p]}return u||++c!=d?u:!!(d=null==e?0:e.length)&&o(d)&&r(p,d)&&(s(e)||n(e))}},function(e,t,a){e.exports=a(20)(1252)},function(e,t,a){e.exports=a(20)(2967)},function(e,t){e.exports=function(e){return function(t){return null==t?void 0:t[e]}}},function(e,t,a){var i=a(487),n=a(300);e.exports=function(e,t){return null!=e&&n(e,t,i)}},function(e,t,a){e.exports=a(20)(2983)},function(e,t,a){e.exports=a(20)(642)},function(e,t){e.exports=function(e){return void 0===e}},function(e,t,a){var i=a(223),n=a(123),s=a(309),r=a(114);e.exports=function(e,t){return(r(e)?i:s)(e,n(t,3))}},function(e,t,a){var i=a(180),n=a(147);e.exports=function(e,t){var a=-1,s=n(e)?Array(e.length):[];return i(e,(function(e,i,n){s[++a]=t(e,i,n)})),s}},function(e,t,a){var i=a(490),n=a(180),s=a(123),r=a(491),o=a(114);e.exports=function(e,t,a){var l=o(e)?i:r,c=arguments.length<3;return l(e,s(t,4),a,c,n)}},function(e,t,a){e.exports=a(20)(3017)},function(e,t){e.exports=function(e,t,a,i){for(var n=e.length,s=a+(i?1:-1);i?s--:++s<n;)if(t(e[s],s,e))return s;return-1}},function(e,t,a){e.exports=a(20)(3034)},function(e,t,a){var i=a(147),n=a(513);e.exports=function(e){return n(e)&&i(e)}},function(e,t,a){var i=a(514),n=a(159);e.exports=function(e){return null==e?[]:i(e,n(e))}},function(e,t,a){var i=a(110),n=a(317);e.exports=function(e,t,a,i){return function(e,t,a,i){var s,r,o={},l=new n,c=function(e){var t=e.v!==s?e.v:e.w,i=o[t],n=a(e),c=r.distance+n;if(n<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+e+" Weight: "+n);c<i.distance&&(i.distance=c,i.predecessor=s,l.decrease(t,c))};e.nodes().forEach((function(e){var a=e===t?0:Number.POSITIVE_INFINITY;o[e]={distance:a},l.add(e,a)}));for(;l.size()>0&&(s=l.removeMin(),(r=o[s]).distance!==Number.POSITIVE_INFINITY);)i(s).forEach(c);return o}(e,String(t),a||s,i||function(t){return e.outEdges(t)})};var s=i.constant(1)},function(e,t,a){var i=a(110);function n(){this._arr=[],this._keyIndices={}}e.exports=n,n.prototype.size=function(){return this._arr.length},n.prototype.keys=function(){return this._arr.map((function(e){return e.key}))},n.prototype.has=function(e){return i.has(this._keyIndices,e)},n.prototype.priority=function(e){var t=this._keyIndices[e];if(void 0!==t)return this._arr[t].priority},n.prototype.min=function(){if(0===this.size())throw new Error("Queue underflow");return this._arr[0].key},n.prototype.add=function(e,t){var a=this._keyIndices;if(e=String(e),!i.has(a,e)){var n=this._arr,s=n.length;return a[e]=s,n.push({key:e,priority:t}),this._decrease(s),!0}return!1},n.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var e=this._arr.pop();return delete this._keyIndices[e.key],this._heapify(0),e.key},n.prototype.decrease=function(e,t){var a=this._keyIndices[e];if(t>this._arr[a].priority)throw new Error("New priority is greater than current priority. Key: "+e+" Old: "+this._arr[a].priority+" New: "+t);this._arr[a].priority=t,this._decrease(a)},n.prototype._heapify=function(e){var t=this._arr,a=2*e,i=a+1,n=e;a<t.length&&(n=t[a].priority<t[n].priority?a:n,i<t.length&&(n=t[i].priority<t[n].priority?i:n),n!==e&&(this._swap(e,n),this._heapify(n)))},n.prototype._decrease=function(e){for(var t,a=this._arr,i=a[e].priority;0!==e&&!(a[t=e>>1].priority<i);)this._swap(e,t),e=t},n.prototype._swap=function(e,t){var a=this._arr,i=this._keyIndices,n=a[e],s=a[t];a[e]=s,a[t]=n,i[s.key]=e,i[n.key]=t}},function(e,t,a){var i=a(110);e.exports=function(e){var t=0,a=[],n={},s=[];function r(o){var l=n[o]={onStack:!0,lowlink:t,index:t++};if(a.push(o),e.successors(o).forEach((function(e){i.has(n,e)?n[e].onStack&&(l.lowlink=Math.min(l.lowlink,n[e].index)):(r(e),l.lowlink=Math.min(l.lowlink,n[e].lowlink))})),l.lowlink===l.index){var c,d=[];do{c=a.pop(),n[c].onStack=!1,d.push(c)}while(o!==c);s.push(d)}}return e.nodes().forEach((function(e){i.has(n,e)||r(e)})),s}},function(e,t,a){var i=a(110);function n(e){var t={},a={},n=[];if(i.each(e.sinks(),(function r(o){if(i.has(a,o))throw new s;i.has(t,o)||(a[o]=!0,t[o]=!0,i.each(e.predecessors(o),r),delete a[o],n.push(o))})),i.size(t)!==e.nodeCount())throw new s;return n}function s(){}e.exports=n,n.CycleException=s,s.prototype=new Error},function(e,t,a){var i=a(110);function n(e,t,a,s,r,o){i.has(s,t)||(s[t]=!0,a||o.push(t),i.each(r(t),(function(t){n(e,t,a,s,r,o)})),a&&o.push(t))}e.exports=function(e,t,a){i.isArray(t)||(t=[t]);var s=(e.isDirected()?e.successors:e.neighbors).bind(e),r=[],o={};return i.each(t,(function(t){if(!e.hasNode(t))throw new Error("Graph does not have node: "+t);n(e,t,"post"===a,o,s,r)})),r}},function(e,t,a){e.exports=a(20)(1248)},function(e,t,a){e.exports=a(20)(636)},function(e,t,a){var i=a(321),n=a(541);e.exports=function(e,t,a){(void 0!==a&&!n(e[t],a)||void 0===a&&!(t in e))&&i(e,t,a)}},function(e,t){e.exports=function(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}},function(e,t,a){e.exports=a(20)(1276)},function(e,t){e.exports=function(e,t){return e<t}},function(e,t,a){e.exports=a(20)(1247)},function(e,t,a){"use strict";var i=a(80),n=a(113).Graph,s=a(183).slack;function r(e,t){return i.forEach(e.nodes(),(function a(n){i.forEach(t.nodeEdges(n),(function(i){var r=i.v,o=n===r?i.w:r;e.hasNode(o)||s(t,i)||(e.setNode(o,{}),e.setEdge(n,o,{}),a(o))}))})),e.nodeCount()}function o(e,t){return i.minBy(t.edges(),(function(a){if(e.hasNode(a.v)!==e.hasNode(a.w))return s(t,a)}))}function l(e,t,a){i.forEach(e.nodes(),(function(e){t.node(e).rank+=a}))}e.exports=function(e){var t,a,i=new n({directed:!1}),c=e.nodes()[0],d=e.nodeCount();i.setNode(c,{});for(;r(i,e)<d;)t=o(i,e),a=i.hasNode(t.v)?s(e,t):-s(e,t),l(i,e,a);return i}},function(e,t,a){switch(window.__kbnThemeTag__){case"v7dark":return a(611);case"v7light":return a(613);case"v8dark":return a(615);case"v8light":return a(617)}},function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var i=a(15),n=a(66);function s(e,t){var a;const{services:{storage:s}}=Object(n.b)(),[r,o]=Object(i.useState)(null!==(a=s.get(e))&&void 0!==a?a:t);return[r,Object(i.useCallback)((t=>{try{s.set(e,t),o(t)}catch(e){throw new Error("Unable to update storage with provided value")}}),[])]}},function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return n}));const i="ml.singleMetricViewer.partitionFields",n="ml.jobSelectorFlyout.applyTimeRange"},,,,,,,,,,,,,,function(e,t,a){"use strict";a.d(t,"b",(function(){return l})),a.d(t,"a",(function(){return c}));var i=a(15),n=a(40),s=a(41),r=a(186),o=a(11);const l=48,c=({defaultTitle:e,initialInput:t,onCreate:a,onCancel:c})=>{var d;const[u,p]=Object(i.useState)(e),[m,b]=Object(i.useState)(null!==(d=null==t?void 0:t.maxSeriesToPlot)&&void 0!==d?d:r.b),h=u.length>0,f=h&&m>0;return Object(o.jsx)(n.EuiModal,{initialFocus:"[name=panelTitle]",onClose:c,"data-test-subj":"mlAnomalyChartsEmbeddableInitializer"},Object(o.jsx)(n.EuiModalHeader,null,Object(o.jsx)(n.EuiModalHeaderTitle,null,Object(o.jsx)("h2",null,Object(o.jsx)(s.FormattedMessage,{id:"xpack.ml.anomalyChartsEmbeddable.setupModal.title",defaultMessage:"Anomaly explorer charts configuration"})))),Object(o.jsx)(n.EuiModalBody,null,Object(o.jsx)(n.EuiForm,null,Object(o.jsx)(n.EuiFormRow,{label:Object(o.jsx)(s.FormattedMessage,{id:"xpack.ml.anomalyChartsEmbeddable.panelTitleLabel",defaultMessage:"Panel title"}),isInvalid:!h},Object(o.jsx)(n.EuiFieldText,{"data-test-subj":"panelTitleInput",id:"panelTitle",name:"panelTitle",value:u,onChange:e=>p(e.target.value),isInvalid:!h})),Object(o.jsx)(n.EuiFormRow,{label:Object(o.jsx)(s.FormattedMessage,{id:"xpack.ml.anomalyChartsEmbeddable.maxSeriesToPlotLabel",defaultMessage:"Maximum number of series to plot"})},Object(o.jsx)(n.EuiFieldNumber,{"data-test-subj":"mlAnomalyChartsInitializerMaxSeries",id:"selectMaxSeriesToPlot",name:"selectMaxSeriesToPlot",value:m,onChange:e=>b(parseInt(e.target.value,10)),min:0,max:l})))),Object(o.jsx)(n.EuiModalFooter,null,Object(o.jsx)(n.EuiButtonEmpty,{onClick:c,"data-test-subj":"mlAnomalyChartsInitializerCancelButton"},Object(o.jsx)(s.FormattedMessage,{id:"xpack.ml.anomalyChartsEmbeddable.setupModal.cancelButtonLabel",defaultMessage:"Cancel"})),Object(o.jsx)(n.EuiButton,{"data-test-subj":"mlAnomalyChartsInitializerConfirmButton",isDisabled:!f,onClick:a.bind(null,{panelTitle:u,maxSeriesToPlot:m}),fill:!0},Object(o.jsx)(s.FormattedMessage,{id:"xpack.ml.anomalyChartsEmbeddable.setupModal.confirmButtonLabel",defaultMessage:"Confirm configurations"}))))}},,function(e,t,a){"use strict";a.d(t,"a",(function(){return jobs_list_view_JobsListView}));var i=a(4),n=a.n(i),s=a(15),r=a.n(s),o=a(41),l=a(40),c=a(67),d=a(126),u=a(8),p=a(21),m=a.n(p),b=a(88),h=a(72),f=a(85),g=a(87),j=a(271),x=a(22),v=a(2);function y(e,t,a,i,n,s){const r=Object(h.e)("canCreateJob")&&Object(f.e)(),o=Object(h.e)("canUpdateJob"),l=Object(h.e)("canDeleteJob"),c=Object(h.e)("canUpdateDatafeed"),u=Object(h.e)("canStartStopDatafeed")&&Object(f.e)(),p=Object(h.e)("canCloseJob")&&Object(f.e)(),m=Object(h.e)("canResetJob")&&Object(f.e)(),b=Object(h.e)("canCreateMlAlerts");return[{name:v.i18n.translate("xpack.ml.jobsList.managementActions.startDatafeedLabel",{defaultMessage:"Start datafeed"}),description:v.i18n.translate("xpack.ml.jobsList.managementActions.startDatafeedDescription",{defaultMessage:"Start datafeed"}),icon:"play",enabled:e=>!1===O(e)&&u,available:e=>Object(d.i)([e]),onClick:e=>{i([e]),E()},"data-test-subj":"mlActionButtonStartDatafeed"},{name:v.i18n.translate("xpack.ml.jobsList.managementActions.stopDatafeedLabel",{defaultMessage:"Stop datafeed"}),description:v.i18n.translate("xpack.ml.jobsList.managementActions.stopDatafeedDescription",{defaultMessage:"Stop datafeed"}),icon:"stop",enabled:e=>!1===O(e)&&u,available:e=>Object(d.j)([e]),onClick:e=>{Object(d.m)([e],n),E(!0)},"data-test-subj":"mlActionButtonStopDatafeed"},{name:v.i18n.translate("xpack.ml.jobsList.managementActions.createAlertLabel",{defaultMessage:"Create alert rule"}),description:v.i18n.translate("xpack.ml.jobsList.managementActions.createAlertLabel",{defaultMessage:"Create alert rule"}),icon:"bell",enabled:e=>!1===O(e),available:()=>b,onClick:e=>{s([e.id]),E(!0)},"data-test-subj":"mlActionButtonCreateAlert"},{name:v.i18n.translate("xpack.ml.jobsList.managementActions.closeJobLabel",{defaultMessage:"Close job"}),description:v.i18n.translate("xpack.ml.jobsList.managementActions.closeJobDescription",{defaultMessage:"Close job"}),icon:"cross",enabled:e=>!1===O(e)&&p,available:e=>Object(d.g)([e]),onClick:e=>{Object(d.c)([e],n),E(!0)},"data-test-subj":"mlActionButtonCloseJob"},{name:v.i18n.translate("xpack.ml.jobsList.managementActions.resetJobLabel",{defaultMessage:"Reset job"}),description:v.i18n.translate("xpack.ml.jobsList.managementActions.resetJobDescription",{defaultMessage:"Reset job"}),icon:"refresh",enabled:e=>function(e){if(void 0===e.blocked||e.blocked.reason===j.a.RESET)return!0;return!1}(e)&&m,available:e=>Object(d.h)([e]),onClick:e=>{a([e]),E(!0)},"data-test-subj":"mlActionButtonResetJob"},{name:v.i18n.translate("xpack.ml.jobsList.managementActions.cloneJobLabel",{defaultMessage:"Clone job"}),description:v.i18n.translate("xpack.ml.jobsList.managementActions.cloneJobDescription",{defaultMessage:"Clone job"}),icon:"copy",enabled:e=>!1===O(e)&&r,onClick:e=>{const t=Object(g.d)(),a=e.datafeedIndices.join(",");t.includes(a)?Object(d.b)(e.id):Object(x.k)().addDanger(v.i18n.translate("xpack.ml.jobsList.managementActions.noSourceIndexPatternForClone",{defaultMessage:"Unable to clone the anomaly detection job {jobId}. No index pattern exists for index {indexPatternTitle}.",values:{jobId:e.id,indexPatternTitle:a}})),E(!0)},"data-test-subj":"mlActionButtonCloneJob"},{name:v.i18n.translate("xpack.ml.jobsList.managementActions.editJobLabel",{defaultMessage:"Edit job"}),description:v.i18n.translate("xpack.ml.jobsList.managementActions.editJobDescription",{defaultMessage:"Edit job"}),icon:"pencil",enabled:e=>!1===O(e)&&o&&c,onClick:t=>{e(t),E()},"data-test-subj":"mlActionButtonEditJob"},{name:v.i18n.translate("xpack.ml.jobsList.managementActions.deleteJobLabel",{defaultMessage:"Delete job"}),description:v.i18n.translate("xpack.ml.jobsList.managementActions.deleteJobDescription",{defaultMessage:"Delete job"}),icon:"trash",color:"danger",enabled:()=>l,onClick:e=>{t([e]),E()},"data-test-subj":"mlActionButtonDeleteJob"}]}function O(e){return void 0!==e.blocked}function E(e=!1){e?document.querySelector(".euiTable").click():window.setTimeout((()=>{const e=document.querySelector(".euiModalBody");e?e.click():document.querySelector(".euiTable").click()}),500)}var w=a(206),_=a(11);function S({jobs:e}){const t=v.i18n.translate("xpack.ml.jobsList.resultActions.openJobsInSingleMetricViewerText",{defaultMessage:"Open {jobsCount, plural, one {{jobId}} other {# jobs}} in Single Metric Viewer",values:{jobsCount:e.length,jobId:e[0].id}}),a=v.i18n.translate("xpack.ml.jobsList.resultActions.openJobsInAnomalyExplorerText",{defaultMessage:"Open {jobsCount, plural, one {{jobId}} other {# jobs}} in Anomaly Explorer",values:{jobsCount:e.length,jobId:e[0].id}}),i=e.length<2,n=1===e.length&&e[0].isSingleMetricViewerJob,r=1===e.length&&e[0].isNotSingleMetricViewerJobMessage,o=void 0!==r?v.i18n.translate("xpack.ml.jobsList.resultActions.singleMetricDisabledMessageText",{defaultMessage:"Disabled because {reason}.",values:{reason:r}}):void 0,c=1===e.length&&void 0!==e[0].blocked,{createLinkWithUserDefaults:d}=Object(w.a)(),u=Object(s.useMemo)((()=>d("timeseriesexplorer",e)),[e]),p=Object(s.useMemo)((()=>d("explorer",e)),[e]);return Object(_.jsx)(l.EuiFlexGroup,{gutterSize:"xs",justifyContent:"flexEnd",alignItems:"center",wrap:!1,direction:"row",responsive:!1},i&&Object(_.jsx)(l.EuiFlexItem,{grow:!1},Object(_.jsx)(l.EuiToolTip,{position:"bottom",content:null!=o?o:t},Object(_.jsx)(l.EuiButtonIcon,{href:u,iconType:"visLine","aria-label":t,className:"results-button",isDisabled:!1===n||!0===c,"data-test-subj":"mlOpenJobsInSingleMetricViewerButton"}))),Object(_.jsx)(l.EuiFlexItem,{grow:!1},Object(_.jsx)(l.EuiToolTip,{position:"bottom",content:a},Object(_.jsx)(l.EuiButtonIcon,{href:p,iconType:"visTable","aria-label":a,className:"results-button",isDisabled:!0===c,"data-test-subj":"mlOpenJobsInAnomalyExplorerButton"}))))}var M=a(143);const k=({name:e})=>Object(_.jsx)(l.EuiBadge,{key:`${e}-id`,"data-test-subj":"mlJobGroup",color:Object(M.a)(e)},e);var C=a(66),T=a(0);function F(e){return void 0!==e.groupId}const I=e=>{const t=Object(C.d)(),[a,i]=Object(s.useState)("");return Object(s.useEffect)((()=>{let a=!1;return(async()=>{const n={};if(F(e)?n.groupIds=[e.groupId]:n.jobId=e.id,t){const e=await t.getUrl({page:T.b.ANOMALY_DETECTION_JOBS_MANAGE,pageState:n});a||i(e)}})(),()=>{a=!0}}),[e,t]),F(e)?Object(_.jsx)(l.EuiLink,{style:{marginLeft:"4px"},key:e.groupId,href:a},Object(_.jsx)(k,{name:e.groupId})):Object(_.jsx)(l.EuiLink,{key:e.id,href:a},e.id)};function D({job:e,isManagementTable:t}){return Object(_.jsx)(r.a.Fragment,null,Object(_.jsx)("div",{className:"job-description"},e.description,"  ",e.groups.map((e=>!0===t?Object(_.jsx)(I,{key:e,groupId:e}):Object(_.jsx)(k,{key:e,name:e})))))}var A=a(360),L=a(357),R=a(131);const P=[10,25,50];class jobs_list_JobsList extends s.Component{constructor(e){super(e),n()(this,"onTableChange",(({page:e={},sort:t={}})=>{const{index:a,size:i}=e,{field:n,direction:s}=t;this.props.onJobsViewStateUpdate({pageIndex:a,pageSize:i,sortField:n,sortDirection:s})})),n()(this,"toggleRow",(e=>{this.props.toggleRow(e.id)})),this.state={jobsSummaryList:e.jobsSummaryList,itemIdToExpandedRowMap:{}}}static getDerivedStateFromProps(e){return{itemIdToExpandedRowMap:e.itemIdToExpandedRowMap,jobsSummaryList:e.jobsSummaryList}}getJobIdLink(e){return!1===this.props.isMlEnabledInSpace?e:Object(_.jsx)(I,{key:e,id:e})}getPageOfJobs(e,t,a,i){let n=this.state.jobsSummaryList;n=Object(u.sortBy)(this.state.jobsSummaryList,(e=>e[a])),n="asc"===i?n:n.reverse();const s=n.length;let r=e*t;return r>=s&&0!==s&&(r=Math.floor((s-1)/t)*t,setTimeout((()=>{this.props.onJobsViewStateUpdate({pageIndex:r/t})}),0)),{pageOfItems:n.slice(r,r+t),totalItemCount:s}}render(){const{loading:e,isManagementTable:t,spacesApi:a}=this.props,i={selectable:e=>void 0===e.blocked,selectableMessage:(e,t)=>!1===e?v.i18n.translate("xpack.ml.jobsList.cannotSelectRowForJobMessage",{defaultMessage:"Cannot select job ID {jobId}",values:{jobId:t.id}}):v.i18n.translate("xpack.ml.jobsList.selectRowForJobMessage",{defaultMessage:"Select the row for job ID {jobId}",values:{jobId:t.id}}),onSelectionChange:this.props.selectJobChange},n=[{name:Object(_.jsx)(l.EuiScreenReaderOnly,null,Object(_.jsx)("p",null,Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.showDetailsColumn.screenReaderDescription",defaultMessage:"This column contains clickable controls for showing more details on each job"}))),render:e=>Object(_.jsx)(l.EuiButtonIcon,{onClick:()=>this.toggleRow(e),isDisabled:void 0!==e.blocked,iconType:this.state.itemIdToExpandedRowMap[e.id]?"arrowDown":"arrowRight","aria-label":this.state.itemIdToExpandedRowMap[e.id]?v.i18n.translate("xpack.ml.jobsList.collapseJobDetailsAriaLabel",{defaultMessage:"Hide details for {itemId}",values:{itemId:e.id}}):v.i18n.translate("xpack.ml.jobsList.expandJobDetailsAriaLabel",{defaultMessage:"Show details for {itemId}",values:{itemId:e.id}}),"data-row-id":e.id,"data-test-subj":"mlJobListRowDetailsToggle"}),width:"3%"},{field:"id","data-test-subj":"mlJobListColumnId",name:v.i18n.translate("xpack.ml.jobsList.idLabel",{defaultMessage:"ID"}),sortable:!0,truncateText:!1,width:"15%",scope:"row",render:t?e=>this.getJobIdLink(e):void 0},{field:"auditMessage",name:Object(_.jsx)(l.EuiScreenReaderOnly,null,Object(_.jsx)("p",null,Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.auditMessageColumn.screenReaderDescription",defaultMessage:"This column displays icons when there are errors or warnings for the job in the past 24 hours"}))),render:e=>Object(_.jsx)(A.a,{message:e,showTooltip:!0})},{field:"alertingRules",name:Object(_.jsx)(l.EuiScreenReaderOnly,null,Object(_.jsx)("p",null,Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.alertingRules.screenReaderDescription",defaultMessage:"This column displays icons when there are alert rules associated with a job"}))),width:"30px",render:e=>Array.isArray(e)?Object(_.jsx)(l.EuiToolTip,{position:"bottom",content:Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.alertingRules.tooltipContent",defaultMessage:"Job has {rulesCount} associated alert {rulesCount, plural, one { rule} other { rules}}",values:{rulesCount:e.length}})},Object(_.jsx)(l.EuiIcon,{type:"bell"})):Object(_.jsx)("span",null)},{name:v.i18n.translate("xpack.ml.jobsList.descriptionLabel",{defaultMessage:"Description"}),sortable:!0,field:"description","data-test-subj":"mlJobListColumnDescription",render:(e,a)=>Object(_.jsx)(D,{job:a,isManagementTable:t}),textOnly:!0,width:"20%"},{field:"processed_record_count","data-test-subj":"mlJobListColumnRecordCount",name:v.i18n.translate("xpack.ml.jobsList.processedRecordsLabel",{defaultMessage:"Processed records"}),sortable:!0,truncateText:!1,dataType:"number",render:e=>Object(b.g)(e),width:"10%"},{field:"memory_status","data-test-subj":"mlJobListColumnMemoryStatus",name:v.i18n.translate("xpack.ml.jobsList.memoryStatusLabel",{defaultMessage:"Memory status"}),sortable:!0,truncateText:!1,width:"5%"},{field:"jobState","data-test-subj":"mlJobListColumnJobState",name:v.i18n.translate("xpack.ml.jobsList.jobStateLabel",{defaultMessage:"Job state"}),sortable:!0,truncateText:!1,width:"8%"},{field:"datafeedState","data-test-subj":"mlJobListColumnDatafeedState",name:v.i18n.translate("xpack.ml.jobsList.datafeedStateLabel",{defaultMessage:"Datafeed state"}),sortable:!0,truncateText:!1,width:"8%"},{name:v.i18n.translate("xpack.ml.jobsList.actionsLabel",{defaultMessage:"Actions"}),render:e=>Object(_.jsx)(S,{jobs:[e]}),width:"8%"}];!0===t?(a&&n.splice(n.length-1,0,{name:v.i18n.translate("xpack.ml.jobsList.spacesLabel",{defaultMessage:"Spaces"}),render:e=>Object(_.jsx)(L.a,{spacesApi:a,spaceIds:e.spaceIds,jobId:e.id,jobType:"anomaly-detector",refresh:this.props.refreshJobs}),"data-test-subj":"mlJobListColumnSpaces"}),!1===this.props.isMlEnabledInSpace&&n.pop()):(n.splice(n.length-1,0,{name:v.i18n.translate("xpack.ml.jobsList.latestTimestampLabel",{defaultMessage:"Latest timestamp"}),truncateText:!1,field:"latestTimestampSortValue","data-test-subj":"mlJobListColumnLatestTimestamp",sortable:!0,render:(e,t)=>Object(_.jsx)("span",{className:"euiTableCellContent__text"},void 0===t.latestTimestampMs?"":m()(t.latestTimestampMs).format(R.a)),textOnly:!0,width:"15%"}),n.push({name:Object(_.jsx)(l.EuiScreenReaderOnly,null,Object(_.jsx)("p",null,Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.jobActionsColumn.screenReaderDescription",defaultMessage:"This column contains extra actions in a menu that can be performed on each job"}))),actions:y(this.props.showEditJobFlyout,this.props.showDeleteJobModal,this.props.showResetJobModal,this.props.showStartDatafeedModal,this.props.refreshJobs,this.props.showCreateAlertFlyout),width:"40px"}));const{pageIndex:s,pageSize:r,sortField:c,sortDirection:d}=this.props.jobsViewState,{pageOfItems:u,totalItemCount:p}=this.getPageOfJobs(s,r,c,d),h={pageIndex:s,pageSize:r,totalItemCount:p,pageSizeOptions:P},f={sort:{field:c,direction:d}},g=this.props.selectedJobsCount?"jobs-selected":"";return Object(_.jsx)(l.EuiBasicTable,{"data-test-subj":e?"mlJobListTable loading":"mlJobListTable loaded",loading:!0===e,noItemsMessage:e?v.i18n.translate("xpack.ml.jobsList.loadingJobsLabel",{defaultMessage:"Loading jobs…"}):v.i18n.translate("xpack.ml.jobsList.noJobsFoundLabel",{defaultMessage:"No jobs found"}),itemId:"id",className:`jobs-list-table ${g}`,items:u,columns:n,pagination:h,onChange:this.onTableChange,selection:t?void 0:i,itemIdToExpandedRowMap:this.state.itemIdToExpandedRowMap,isExpandable:!0,sorting:f,hasActions:!0,rowProps:e=>({"data-test-subj":`mlJobListRow row-${e.id}`})})}}jobs_list_JobsList.defaultProps={isManagementTable:!1,isMlEnabledInSpace:!0,loading:!1};var N=a(52),z=a.n(N);function B(e,t=2){if(void 0===e)return"";if(e%1==0)return e;if(Math.abs(e)<Math.pow(10,-t))return Number.parseFloat(String(e)).toExponential(2);const a=Math.pow(10,t);return Math.round(e*a)/a}var J=a(76);function V(e){if(!e)return["",""];const[t,a]=e;switch(t){case"finished_time":case"create_time":case"log_time":case"timestamp":case"earliest_record_timestamp":case"latest_record_timestamp":case"last_data_time":case"latest_empty_bucket_timestamp":case"latest_sparse_bucket_timestamp":case"latest_bucket_timestamp":return[t,Object(J.d)(a)];case"established_model_memory":case"input_bytes":case"model_bytes":case"model_bytes_exceeded":case"model_bytes_memory_limit":case"peak_model_bytes":return[t,(i=a,z()(i).format("0.0 b"))];case"processed_record_count":case"processed_field_count":case"input_field_count":case"invalid_date_count":case"missing_field_count":case"out_of_order_timestamp_count":case"empty_bucket_count":case"sparse_bucket_count":case"bucket_count":case"input_record_count":case"total_by_field_count":case"total_over_field_count":case"total_partition_field_count":case"bucket_allocation_failures_count":case"search_count":return[t,Object(b.g)(a)];case"average_search_time_per_bucket_ms":case"exponential_average_search_time_per_hour_ms":case"total_bucket_processing_time_ms":case"minimum_bucket_processing_time_ms":case"maximum_bucket_processing_time_ms":case"average_bucket_processing_time_ms":case"exponential_average_bucket_processing_time_ms":case"exponential_average_bucket_processing_time_per_hour_ms":return[t,"number"==typeof a?B(a,3).toLocaleString():a];default:return[t,a]}var i}function U(e,t,a){return Object.keys(e).filter((i=>a||"object"!=typeof e[i]||t&&Array.isArray(e[i]))).map((t=>{let a=e[t];return Array.isArray(a)?a=a.join(", "):"object"==typeof e[t]&&(a=JSON.stringify(a)),[t,a]}))}var G=a(208);var q=a(130);function H({job:e}){const t=JSON.stringify(e,null,2);return Object(_.jsx)(r.a.Fragment,null,Object(_.jsx)(l.EuiSpacer,{size:"s"}),Object(_.jsx)(q.a,{value:t,readOnly:!0,mode:q.b.XJSON}))}var W=a(74);class datafeed_preview_tab_DatafeedPreviewPane extends s.Component{constructor(e){super(e),this.state={previewJson:"",loading:!0,canPreviewDatafeed:!0}}renderContent(){const{previewJson:e,loading:t,canPreviewDatafeed:a}=this.state;return!1===a?Object(_.jsx)(l.EuiCallOut,{title:Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.jobDetails.noPermissionToViewDatafeedPreviewTitle",defaultMessage:"You do not have permission to view the datafeed preview"}),color:"warning",iconType:"alert"},Object(_.jsx)("p",null,Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.jobDetails.pleaseContactYourAdministratorLabel",defaultMessage:"Please contact your administrator"}))):!0===t?Object(_.jsx)(l.EuiLoadingSpinner,{size:"xl"}):Object(_.jsx)(q.a,{value:e,readOnly:!0})}componentDidMount(){const e=Object(h.e)("canPreviewDatafeed")&&void 0!==this.props.job.datafeed_config;this.setState({canPreviewDatafeed:e}),function(e,t){return new Promise(((a,i)=>{t&&c.ml.jobs.datafeedPreview(e.datafeed_config.datafeed_id).then((e=>{Array.isArray(e)?a(JSON.stringify(e.slice(0,W.a),null,2)):(a(""),console.log("Datafeed preview could not be loaded",e))})).catch((e=>{i(e)}))}))}(this.props.job,e).then((e=>{this.setState({previewJson:e,loading:!1})})).catch((e=>{console.log("Datafeed preview could not be loaded",e),this.setState({loading:!1})}))}render(){return Object(_.jsx)(r.a.Fragment,null,Object(_.jsx)(l.EuiSpacer,{size:"s"}),this.renderContent())}}var $=a(260),Y=a(352),X=a(252);const Q=({snapshot:e,job:t,closeFlyout:a})=>{const{toasts:i}=Object(C.f)(),[n,d]=Object(s.useState)(e.description),[u,p]=Object(s.useState)(e.retain),[m,b]=Object(s.useState)(!1),[h,f]=Object(s.useState)(e.snapshot_id===t.model_snapshot_id);Object(s.useEffect)((()=>{f(e.snapshot_id===t.model_snapshot_id)}),[e]);const g=Object(s.useCallback)((async()=>{try{await c.ml.updateModelSnapshot(e.job_id,e.snapshot_id,{description:n,retain:u}),x()}catch(e){i.addError(new Error(e.body.message),{title:v.i18n.translate("xpack.ml.editModelSnapshotFlyout.saveErrorTitle",{defaultMessage:"Model snapshot update failed"})})}}),[u,n,e]),j=Object(s.useCallback)((async()=>{try{await c.ml.deleteModelSnapshot(e.job_id,e.snapshot_id),O(),x()}catch(e){i.addError(new Error(e.body.message),{title:v.i18n.translate("xpack.ml.editModelSnapshotFlyout.deleteErrorTitle",{defaultMessage:"Model snapshot deletion failed"})})}}),[e]);function x(){a(!0)}function y(){a(!1)}function O(){b(!1)}return Object(_.jsx)(r.a.Fragment,null,Object(_.jsx)(l.EuiFlyout,{onClose:y,hideCloseButton:!0,size:"m"},Object(_.jsx)(l.EuiFlyoutBody,null,Object(_.jsx)(l.EuiFlexItem,null,Object(_.jsx)(l.EuiTitle,{size:"s"},Object(_.jsx)("h5",null,Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.editModelSnapshotFlyout.title",defaultMessage:"Edit snapshot {ssId}",values:{ssId:e.snapshot_id}}))),h&&Object(_.jsx)(r.a.Fragment,null,Object(_.jsx)(l.EuiSpacer,{size:"m"}),Object(_.jsx)(l.EuiCallOut,{size:"s",title:v.i18n.translate("xpack.ml.editModelSnapshotFlyout.calloutTitle",{defaultMessage:"Current snapshot"})},Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.editModelSnapshotFlyout.calloutText",defaultMessage:"This is the current snapshot being used by job {jobId} and so cannot be deleted.",values:{jobId:t.job_id}}))),Object(_.jsx)(l.EuiSpacer,{size:"l"}),Object(_.jsx)(l.EuiFormRow,{label:v.i18n.translate("xpack.ml.editModelSnapshotFlyout.descriptionTitle",{defaultMessage:"Description"}),fullWidth:!0},Object(_.jsx)(l.EuiTextArea,{fullWidth:!0,value:n,onChange:e=>d(e.target.value)})),Object(_.jsx)(l.EuiSpacer,{size:"m"}),Object(_.jsx)(l.EuiFormRow,{fullWidth:!0},Object(_.jsx)(l.EuiSwitch,{label:v.i18n.translate("xpack.ml.editModelSnapshotFlyout.retainSwitchLabel",{defaultMessage:"Retain snapshot during automatic snapshot cleanup process"}),checked:u,onChange:e=>p(e.target.checked)})))),Object(_.jsx)(l.EuiFlyoutFooter,null,Object(_.jsx)(l.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(_.jsx)(l.EuiFlexItem,{grow:!1},Object(_.jsx)(l.EuiButtonEmpty,{iconType:"cross",onClick:y,flush:"left"},Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.editModelSnapshotFlyout.closeButton",defaultMessage:"Close"}))),Object(_.jsx)(l.EuiFlexItem,{grow:!0}),Object(_.jsx)(l.EuiFlexItem,{grow:!1},Object(_.jsx)(l.EuiButtonEmpty,{onClick:function(){b(!0)},color:"danger",disabled:!0===h},Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.editModelSnapshotFlyout.useDefaultButton",defaultMessage:"Delete"}))),Object(_.jsx)(l.EuiFlexItem,{grow:!1},Object(_.jsx)(l.EuiButton,{onClick:g,fill:!0},Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.editModelSnapshotFlyout.saveButton",defaultMessage:"Save"})))))),m&&Object(_.jsx)(l.EuiConfirmModal,{title:v.i18n.translate("xpack.ml.editModelSnapshotFlyout.deleteTitle",{defaultMessage:"Delete snapshot?"}),onCancel:O,onConfirm:j,cancelButtonText:v.i18n.translate("xpack.ml.editModelSnapshotFlyout.cancelButton",{defaultMessage:"Cancel"}),confirmButtonText:v.i18n.translate("xpack.ml.editModelSnapshotFlyout.deleteButton",{defaultMessage:"Delete"}),buttonColor:"danger",defaultFocusedButton:"confirm"}))};var K=a(7);var Z=a(129),ee=a(192),te=a(26),ae=a(116);const ie=({calendarEvents:e,setCalendarEvents:t,minSelectableTimeStamp:a,maxSelectableTimeStamp:i,eventRateData:n,anomalies:c,chartReady:d})=>{const u=m()(i),p=m()(a),{euiTheme:b}=Object(ae.e)(),h=Object(s.useCallback)((({x:i})=>{if(i&&2===i.length){const n=i[1]<a?null:i[1];if(null!==n){const s=i[0]<a?a:i[0];t([...e,{start:m()(s),end:m()(n),description:re(e.length+1)}])}}}),[e]),f=Object(s.useCallback)(((a,i)=>{const n=e[i];void 0===n?t([...e,{start:a,end:null,description:re(i)}]):(n.start=a,t([...e]))}),[e]),g=Object(s.useCallback)(((a,i)=>{const n=e[i];void 0===n?t([...e,{start:null,end:a,description:re(i)}]):(n.end=a,t([...e]))}),[e]),j=Object(s.useCallback)(((a,i)=>{const n=e[i];void 0!==n&&(n.description=a,t([...e]))}),[e]),x=Object(s.useCallback)((a=>{if(void 0!==e[a]){const i=[...e];i.splice(a,1),t(i)}}),[e]);return Object(_.jsx)(r.a.Fragment,null,Object(_.jsx)(l.EuiSpacer,{size:"l"}),Object(_.jsx)("div",null,Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.revertModelSnapshotFlyout.createCalendar.title",defaultMessage:"Select time range for calendar event."})),Object(_.jsx)(l.EuiSpacer,{size:"m"}),Object(_.jsx)(ne,{eventRateData:n,anomalies:c,loading:!1===d,overlayRanges:e.filter(se).map((e=>({start:e.start.valueOf(),end:e.end.valueOf()}))),onBrushEnd:h,overlayColor:b.euiColorPrimary}),Object(_.jsx)(l.EuiSpacer,{size:"s"}),e.map(((e,t)=>{var a,i;return Object(_.jsx)(s.Fragment,{key:t},Object(_.jsx)(l.EuiPanel,{paddingSize:"s"},Object(_.jsx)(l.EuiFlexGroup,null,Object(_.jsx)(l.EuiFlexItem,null,Object(_.jsx)(l.EuiFlexGroup,null,Object(_.jsx)(l.EuiFlexItem,null,Object(_.jsx)(l.EuiFormRow,{label:v.i18n.translate("xpack.ml.revertModelSnapshotFlyout.createCalendar.fromLabel",{defaultMessage:"From"})},Object(_.jsx)(l.EuiDatePicker,{showTimeSelect:!0,selected:e.start,minDate:p,maxDate:null!==(a=e.end)&&void 0!==a?a:u,onChange:e=>f(e,t)}))),Object(_.jsx)(l.EuiFlexItem,null,Object(_.jsx)(l.EuiFormRow,{label:v.i18n.translate("xpack.ml.revertModelSnapshotFlyout.createCalendar.toLabel",{defaultMessage:"To"})},Object(_.jsx)(l.EuiDatePicker,{showTimeSelect:!0,selected:e.end,minDate:null!==(i=e.start)&&void 0!==i?i:p,maxDate:u,onChange:e=>g(e,t)})))),Object(_.jsx)(l.EuiSpacer,{size:"s"}),Object(_.jsx)(l.EuiFlexGroup,null,Object(_.jsx)(l.EuiFlexItem,null,Object(_.jsx)(l.EuiFormRow,{fullWidth:!0,label:v.i18n.translate("xpack.ml.revertModelSnapshotFlyout.createCalendar.descriptionLabel",{defaultMessage:"Description"})},Object(_.jsx)(l.EuiFieldText,{fullWidth:!0,value:e.description,onChange:e=>j(e.target.value,t)}))))),Object(_.jsx)(l.EuiFlexItem,{grow:!1,style:{borderLeft:`1px solid ${b.euiColorLightShade}`,marginRight:"0px"}}),Object(_.jsx)(l.EuiFlexItem,{grow:!1},Object(_.jsx)(l.EuiButtonIcon,{style:{margin:"auto"},color:"danger",onClick:()=>x(t),iconType:"trash","aria-label":v.i18n.translate("xpack.ml.revertModelSnapshotFlyout.createCalendar.deleteLabel",{defaultMessage:"Delete event"})})))),Object(_.jsx)(l.EuiSpacer,{size:"m"}))})))},ne=Object(s.memo)((({eventRateData:e,anomalies:t,loading:a,onBrushEnd:i,overlayRanges:n,overlayColor:s})=>Object(_.jsx)(ee.a,{eventRateChartData:e,anomalyData:t,loading:a,height:"100px",width:"100%",fadeChart:!0,overlayRanges:n.map((e=>({start:e.start,end:e.end,color:s,showMarker:!1}))),onBrushEnd:i})),((e,t)=>e.overlayRanges.length===t.overlayRanges.length&&JSON.stringify(e.overlayRanges)===JSON.stringify(t.overlayRanges)));function se(e){return null!==e.start&&null!==e.end}function re(e){return v.i18n.translate("xpack.ml.revertModelSnapshotFlyout.createCalendar.defaultEventDescription",{defaultMessage:"Auto created event {index}",values:{index:e}})}var oe=a(73);const le=({snapshot:e,snapshots:t,job:a,closeFlyout:i,refresh:n})=>{const{toasts:d}=Object(C.f)(),{loadAnomalyDataForJob:u,loadEventRateForJob:p}=Object(s.useMemo)((()=>{return e=Z.mlResultsService,{loadEventRateForJob:async function(t,a,i){const n=Math.max(Math.floor((t.data_counts.latest_record_timestamp-t.data_counts.earliest_record_timestamp)/i),a),s=await e.getEventRateData(t.datafeed_config.indices.join(),t.datafeed_config.query,t.data_description.time_field,t.data_counts.earliest_record_timestamp,t.data_counts.latest_record_timestamp,n,t.datafeed_config.runtime_mappings,t.datafeed_config.indices_options);if(void 0!==s.error)throw s.error;const r=Object.entries(s.results).map((([e,t])=>({time:+e,value:t})));return r.length&&r.push({time:r[r.length-1].time+n,value:0}),r},loadAnomalyDataForJob:async function(t,a,i){const n=Math.max(Math.floor((t.data_counts.latest_record_timestamp-t.data_counts.earliest_record_timestamp)/i),a),s=(await e.getScoresByBucket([t.job_id],t.data_counts.earliest_record_timestamp,t.data_counts.latest_record_timestamp,n,1)).results[t.job_id];if(void 0===s)return[];const r={};return r[0]=Object.entries(s).map((([e,t])=>({time:+e,value:t,severity:Object(K.k)(t)}))),r}};var e}),[]),[m,b]=Object(s.useState)(e),[h,f]=Object(s.useState)(!1),[g,j]=Object(s.useState)(!1),[x,y]=Object(s.useState)(!1),[O,E]=Object(s.useState)(!1),[w,S]=Object(s.useState)([]),[M,k]=Object(s.useState)(!0),[T,F]=Object(s.useState)([]),[I,D]=Object(s.useState)([]),[A,L]=Object(s.useState)(!1);Object(s.useEffect)((()=>{R()}),[m]),Object(s.useEffect)((()=>{const e=w.some((e=>""===e.description||null===e.end||null===e.start));k(!1===e);const t=[...new Map(w.map((e=>{var t,a;return[`${null===(t=e.start)||void 0===t?void 0:t.valueOf()}${null===(a=e.end)||void 0===a?void 0:a.valueOf()}`,e]}))).values()];t.length<w.length&&S(t)}),[w]);const R=Object(s.useCallback)((async()=>{const e=Object(te.a)(a.analysis_config.bucket_span).asMilliseconds(),t=await p(a,e,100),i=await u(a,e,100);F(t),void 0!==i[0]&&D(i[0]),L(!0)}),[a]);function P(){f(!1)}return Object(_.jsx)(r.a.Fragment,null,Object(_.jsx)(l.EuiFlyout,{onClose:i,hideCloseButton:!0,size:"m"},Object(_.jsx)(l.EuiFlyoutHeader,{hasBorder:!0},Object(_.jsx)(l.EuiTitle,{size:"s"},Object(_.jsx)("h5",null,Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.newJob.wizard.revertModelSnapshotFlyout.title",defaultMessage:"Revert to model snapshot {ssId}",values:{ssId:m.snapshot_id}}))),Object(_.jsx)(l.EuiText,{size:"s"},Object(_.jsx)("p",null,m.description))),Object(_.jsx)(l.EuiFlyoutBody,null,!1,Object(_.jsx)(ee.a,{eventRateChartData:T,anomalyData:I,loading:!1===A,height:"100px",width:"100%",fadeChart:!0,overlayRanges:[{start:m.latest_record_time_stamp,end:a.data_counts.latest_record_timestamp,color:"#ff0000"}]}),Object(_.jsx)(l.EuiSpacer,{size:"l"}),Object(_.jsx)(l.EuiSpacer,{size:"l"}),Object(_.jsx)(l.EuiCallOut,{title:v.i18n.translate("xpack.ml.newJob.wizard.revertModelSnapshotFlyout.warningCallout.title",{defaultMessage:"Anomaly data will be deleted"}),color:"warning",iconType:"alert"},Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.newJob.wizard.revertModelSnapshotFlyout.warningCallout.contents",defaultMessage:"All anomaly detection results after {date} will be deleted.",values:{date:Object(J.d)(m.latest_record_time_stamp)}})),Object(_.jsx)(l.EuiHorizontalRule,{margin:"xl"}),Object(_.jsx)(l.EuiFormRow,{fullWidth:!0,helpText:v.i18n.translate("xpack.ml.newJob.wizard.revertModelSnapshotFlyout.replaySwitchHelp",{defaultMessage:"Reopen job and replay analysis after the revert has been applied."})},Object(_.jsx)(l.EuiSwitch,{id:"replaySwitch",label:v.i18n.translate("xpack.ml.newJob.wizard.revertModelSnapshotFlyout.replaySwitchLabel",{defaultMessage:"Replay analysis"}),checked:g,onChange:e=>j(e.target.checked)})),g&&Object(_.jsx)(r.a.Fragment,null,Object(_.jsx)(l.EuiFormRow,{fullWidth:!0,helpText:v.i18n.translate("xpack.ml.newJob.wizard.revertModelSnapshotFlyout.realTimeSwitchHelp",{defaultMessage:"Job will continue to run until manually stopped. All new data added to the index will be analyzed."})},Object(_.jsx)(l.EuiSwitch,{id:"realTimeSwitch",label:v.i18n.translate("xpack.ml.newJob.wizard.revertModelSnapshotFlyout.realTimeSwitchLabel",{defaultMessage:"Run job in real time"}),checked:x,onChange:e=>y(e.target.checked)})),Object(_.jsx)(l.EuiFormRow,{fullWidth:!0,helpText:v.i18n.translate("xpack.ml.newJob.wizard.revertModelSnapshotFlyout.createCalendarSwitchHelp",{defaultMessage:"Create a new calendar and event to skip over a period of time when analyzing the data."})},Object(_.jsx)(l.EuiSwitch,{id:"createCalendarSwitch",label:v.i18n.translate("xpack.ml.newJob.wizard.revertModelSnapshotFlyout.createCalendarSwitchLabel",{defaultMessage:"Create calendar to skip a range of time"}),checked:O,onChange:e=>E(e.target.checked)})),O&&Object(_.jsx)(ie,{calendarEvents:w,setCalendarEvents:S,minSelectableTimeStamp:e.latest_record_time_stamp,maxSelectableTimeStamp:a.data_counts.latest_record_timestamp,eventRateData:T,anomalies:I,chartReady:A}))),Object(_.jsx)(l.EuiFlyoutFooter,null,Object(_.jsx)(l.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(_.jsx)(l.EuiFlexItem,{grow:!1},Object(_.jsx)(l.EuiButtonEmpty,{iconType:"cross",onClick:i,flush:"left"},Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.newJob.wizard.revertModelSnapshotFlyout.closeButton",defaultMessage:"Close"}))),Object(_.jsx)(l.EuiFlexItem,{grow:!0}),Object(_.jsx)(l.EuiFlexItem,{grow:!1},Object(_.jsx)(l.EuiButton,{onClick:function(){f(!0)},disabled:!0===O&&!1===M,fill:!0},Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.newJob.wizard.revertModelSnapshotFlyout.saveButton",defaultMessage:"Apply"})))))),h&&Object(_.jsx)(l.EuiConfirmModal,{title:v.i18n.translate("xpack.ml.newJob.wizard.revertModelSnapshotFlyout.deleteTitle",{defaultMessage:"Apply snapshot revert"}),onCancel:P,onConfirm:async function(){const e=g&&!1===x?a.data_counts.latest_record_timestamp:void 0;try{const t=g&&O?w.filter(ce).map((e=>({start:e.start.valueOf(),end:e.end.valueOf(),description:e.description}))):void 0;c.ml.jobs.revertModelSnapshot(a.job_id,m.snapshot_id,g,e,t).then((()=>{d.addSuccess(v.i18n.translate("xpack.ml.revertModelSnapshotFlyout.revertSuccessTitle",{defaultMessage:"Model snapshot revert successful"})),n()})).catch((e=>{const{displayErrorToast:t}=Object(oe.b)(d);t(e)})),P(),i()}catch(e){d.addError(new Error(e.body.message),{title:v.i18n.translate("xpack.ml.revertModelSnapshotFlyout.revertErrorTitle",{defaultMessage:"Model snapshot revert failed"})})}},cancelButtonText:v.i18n.translate("xpack.ml.newJob.wizard.revertModelSnapshotFlyout.cancelButton",{defaultMessage:"Cancel"}),confirmButtonText:v.i18n.translate("xpack.ml.newJob.wizard.revertModelSnapshotFlyout.deleteButton",{defaultMessage:"Apply"}),buttonColor:"danger",defaultFocusedButton:"confirm"},Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.newJob.wizard.revertModelSnapshotFlyout.modalBody",defaultMessage:"The snapshot revert will be carried out in the background and may take some time."})))};function ce(e){return null!==e.start&&null!==e.end}var de=a(95);const ue=({combinedJobState:e,hideCloseJobModalVisible:t,forceCloseJob:a})=>Object(_.jsx)(l.EuiConfirmModal,{title:e===pe.OPEN_AND_RUNNING?v.i18n.translate("xpack.ml.modelSnapshotTable.closeJobConfirm.stopAndClose.title",{defaultMessage:"Stop datafeed and close job?"}):v.i18n.translate("xpack.ml.modelSnapshotTable.closeJobConfirm.close.title",{defaultMessage:"Close job?"}),onCancel:t,onConfirm:a,cancelButtonText:v.i18n.translate("xpack.ml.modelSnapshotTable.closeJobConfirm.cancelButton",{defaultMessage:"Cancel"}),confirmButtonText:e===pe.OPEN_AND_RUNNING?v.i18n.translate("xpack.ml.modelSnapshotTable.closeJobConfirm.stopAndClose.button",{defaultMessage:"Force stop and close"}):v.i18n.translate("xpack.ml.modelSnapshotTable.closeJobConfirm.close.button",{defaultMessage:"Force close"}),defaultFocusedButton:"confirm"},Object(_.jsx)("p",null,e===pe.OPEN_AND_RUNNING&&Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.modelSnapshotTable.closeJobConfirm.contentOpenAndRunning",defaultMessage:"Job is currently open and running."}),e===pe.OPEN_AND_STOPPED&&Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.modelSnapshotTable.closeJobConfirm.contentOpen",defaultMessage:"Job is currently open."}),Object(_.jsx)("br",null),Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.modelSnapshotTable.closeJobConfirm.content",defaultMessage:"Snapshot revert can only happen on jobs which are closed."})));let pe;!function(e){e[e.OPEN_AND_RUNNING=0]="OPEN_AND_RUNNING",e[e.OPEN_AND_STOPPED=1]="OPEN_AND_STOPPED",e[e.CLOSED=2]="CLOSED",e[e.UNKNOWN=3]="UNKNOWN"}(pe||(pe={}));const me=({job:e,refreshJobList:t})=>{const a=Object(h.e)("canCreateJob"),i=Object(h.e)("canStartStopDatafeed"),[n,o]=Object(s.useState)([]),[d,u]=Object(s.useState)(!1),[p,m]=Object(s.useState)(null),[b,f]=Object(s.useState)(null),[g,j]=Object(s.useState)(null),[x,y]=Object(s.useState)(null),O=Object(s.useRef)(!0);async function E(){if(!1===O.current)return;const{model_snapshots:t}=await c.ml.getModelSnapshots(e.job_id);o(t),u(!0)}Object(s.useEffect)((()=>(E(),()=>{O.current=!1})),[]);const w=Object(s.useCallback)((async t=>{const a=await be(e.job_id);a!==pe.UNKNOWN?(y(a),a===pe.CLOSED?f(t):j(t)):console.error(`Error retrieving state for job ${e.job_id}`)}),[e]);function S(){y(null),j(null)}const M=Object(s.useCallback)((async()=>{if(await c.ml.jobs.forceStopAndCloseJob(e.job_id),null!==g){await be(e.job_id)===pe.CLOSED&&f(g)}S()}),[e,g]),k=Object(s.useCallback)((e=>{m(null),e&&E()}),[]),C=Object(s.useCallback)((()=>{f(null)}),[]),T=Object(s.useCallback)((()=>{E(),setTimeout(t,500)}),[]),F=[{field:"snapshot_id",name:v.i18n.translate("xpack.ml.modelSnapshotTable.id",{defaultMessage:"ID"}),sortable:!0},{field:"description",name:v.i18n.translate("xpack.ml.modelSnapshotTable.description",{defaultMessage:"Description"}),sortable:!0},{field:"timestamp",name:v.i18n.translate("xpack.ml.modelSnapshotTable.time",{defaultMessage:"Date created"}),dataType:"date",render:J.d,sortable:!0},{field:"latest_record_time_stamp",name:v.i18n.translate("xpack.ml.modelSnapshotTable.latestTimestamp",{defaultMessage:"Latest timestamp"}),dataType:"date",render:J.d,sortable:!0},{field:"retain",name:v.i18n.translate("xpack.ml.modelSnapshotTable.retain",{defaultMessage:"Retain"}),width:"100px",sortable:!0},{field:"",width:"100px",name:v.i18n.translate("xpack.ml.modelSnapshotTable.actions",{defaultMessage:"Actions"}),actions:[{name:v.i18n.translate("xpack.ml.modelSnapshotTable.actions.revert.name",{defaultMessage:"Revert"}),description:v.i18n.translate("xpack.ml.modelSnapshotTable.actions.revert.description",{defaultMessage:"Revert to this snapshot"}),enabled:()=>a&&i,type:"icon",icon:"crosshairs",onClick:w},{name:v.i18n.translate("xpack.ml.modelSnapshotTable.actions.edit.name",{defaultMessage:"Edit"}),description:v.i18n.translate("xpack.ml.modelSnapshotTable.actions.edit.description",{defaultMessage:"Edit this snapshot"}),enabled:()=>a,type:"icon",icon:"pencil",onClick:m}]}];return!1===d?Object(_.jsx)(r.a.Fragment,null,Object(_.jsx)(l.EuiFlexGroup,{justifyContent:"spaceAround"},Object(_.jsx)(l.EuiFlexItem,{grow:!1},Object(_.jsx)(l.EuiLoadingSpinner,{size:"l"})))):Object(_.jsx)(r.a.Fragment,null,Object(_.jsx)(l.EuiInMemoryTable,{className:"eui-textOverflowWrap",compressed:!0,items:n,columns:F,pagination:{pageSizeOptions:[5,10,25]},sorting:{sort:{field:"timestamp",direction:"asc"}}}),null!==p&&Object(_.jsx)(Q,{snapshot:p,job:e,closeFlyout:k}),null!==b&&Object(_.jsx)(le,{snapshot:b,snapshots:n,job:e,closeFlyout:C,refresh:T}),null!==g&&null!==x&&Object(_.jsx)(ue,{combinedJobState:x,hideCloseJobModalVisible:S,forceCloseJob:M}))};async function be(e){const t=await c.ml.jobs.jobs([e]);return 1!==t.length?pe.UNKNOWN:t[0].state!==de.c.CLOSED?t[0].datafeed_config.state!==de.a.STOPPED?pe.OPEN_AND_RUNNING:pe.OPEN_AND_STOPPED:pe.CLOSED}var he=a(63),fe=a(172),ge=a(156),je=a(42);class forecasts_table_ForecastsTableUI extends s.Component{constructor(e){super(e),this.state={isLoading:0!==e.job.data_counts.processed_record_count,forecasts:[]}}componentDidMount(){const e=this.props.job.data_counts;e.processed_record_count>0&&ge.a.getForecastsSummary(this.props.job,null,e.earliest_record_timestamp,500).then((e=>{this.setState({isLoading:!1,forecasts:e.forecasts})})).catch((e=>{console.log("Error loading list of forecasts for jobs list:",e),this.setState({isLoading:!1,errorMessage:v.i18n.translate("xpack.ml.jobsList.jobDetails.forecastsTable.loadingErrorMessage",{defaultMessage:"Error loading the list of forecasts run on this job"}),forecasts:[]})}))}async openSingleMetricView(e){const{services:{application:{navigateToUrl:t},share:a}}=this.props.kibana,i=this.props.job.data_counts,n=i.earliest_record_timestamp,s=Object(W.g)(i.latest_record_timestamp,i.latest_bucket_timestamp),r=new Date(i.earliest_record_timestamp).toISOString(),o=void 0!==e?new Date(e.forecast_end_timestamp).toISOString():new Date(s).toISOString();let l={};if(void 0!==e){const t=e.forecast_end_timestamp-e.forecast_start_timestamp,a=Math.max(e.forecast_start_timestamp-t,n);l={forecastId:e.forecast_id,zoom:{from:new Date(a).toISOString(),to:new Date(e.forecast_end_timestamp).toISOString()}}}const c=a.url.locators.get(T.a),d=await c.getUrl({page:T.b.SINGLE_METRIC_VIEWER,pageState:{timeRange:{from:r,to:o,mode:"absolute"},refreshInterval:{display:"Off",pause:!0,value:0},jobIds:[this.props.job.job_id],query:{query_string:{analyze_wildcard:!0,query:"*"}},...l}},{absolute:!0});Object(fe.a)("timeseriesexplorer",this.props.job.job_id,d),await t(d)}render(){if(!0===this.state.isLoading)return Object(_.jsx)(l.EuiFlexGroup,{justifyContent:"spaceAround"},Object(_.jsx)(l.EuiFlexItem,{grow:!1},Object(_.jsx)(l.EuiLoadingSpinner,{size:"l"})));if(void 0!==this.state.errorMessage)return Object(_.jsx)(l.EuiCallOut,{title:this.state.errorMessage,color:"danger",iconType:"cross"});const e=this.state.forecasts;if(0===e.length)return Object(_.jsx)(l.EuiCallOut,{title:Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.jobDetails.forecastsTable.noForecastsTitle",defaultMessage:"No forecasts have been run for this job"}),iconType:"iInCircle",role:"alert"},Object(W.p)(this.props.job)&&Object(_.jsx)("p",null,Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.jobDetails.forecastsTable.noForecastsDescription",defaultMessage:"To run a forecast, open the {singleMetricViewerLink}",values:{singleMetricViewerLink:Object(_.jsx)(l.EuiLink,{onClick:()=>this.openSingleMetricView()},Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.jobDetails.forecastsTable.noForecastsDescription.linkText",defaultMessage:"Single Metric Viewer"}))}})));const t=[{field:"forecast_create_timestamp",name:v.i18n.translate("xpack.ml.jobsList.jobDetails.forecastsTable.createdLabel",{defaultMessage:"Created"}),dataType:"date",render:J.d,textOnly:!0,sortable:!0,scope:"row"},{field:"forecast_start_timestamp",name:v.i18n.translate("xpack.ml.jobsList.jobDetails.forecastsTable.fromLabel",{defaultMessage:"From"}),dataType:"date",render:J.d,textOnly:!0,sortable:!0},{field:"forecast_end_timestamp",name:v.i18n.translate("xpack.ml.jobsList.jobDetails.forecastsTable.toLabel",{defaultMessage:"To"}),dataType:"date",render:J.d,textOnly:!0,sortable:!0},{field:"forecast_status",name:v.i18n.translate("xpack.ml.jobsList.jobDetails.forecastsTable.statusLabel",{defaultMessage:"Status"}),sortable:!0},{field:"forecast_memory_bytes",name:v.i18n.translate("xpack.ml.jobsList.jobDetails.forecastsTable.memorySizeLabel",{defaultMessage:"Memory size"}),render:e=>Object(he.formatNumber)(e,"0b"),sortable:!0},{field:"processing_time_ms",name:v.i18n.translate("xpack.ml.jobsList.jobDetails.forecastsTable.processingTimeLabel",{defaultMessage:"Processing time"}),render:e=>v.i18n.translate("xpack.ml.jobsList.jobDetails.forecastsTable.msTimeUnitLabel",{defaultMessage:"{ms} ms",values:{ms:e}}),sortable:!0},{field:"forecast_expiry_timestamp",name:v.i18n.translate("xpack.ml.jobsList.jobDetails.forecastsTable.expiresLabel",{defaultMessage:"Expires"}),render:J.d,textOnly:!0,sortable:!0},{field:"forecast_messages",name:v.i18n.translate("xpack.ml.jobsList.jobDetails.forecastsTable.messagesLabel",{defaultMessage:"Messages"}),sortable:!1,render:e=>Object(_.jsx)("div",null,e.map(((e,t)=>Object(_.jsx)("p",{key:t},e)))),textOnly:!0},{name:v.i18n.translate("xpack.ml.jobsList.jobDetails.forecastsTable.viewLabel",{defaultMessage:"View"}),width:"60px",render:e=>{const t=v.i18n.translate("xpack.ml.jobsList.jobDetails.forecastsTable.viewAriaLabel",{defaultMessage:"View forecast created at {createdDate}",values:{createdDate:Object(J.d)(e.forecast_create_timestamp)}});return Object(_.jsx)(l.EuiButtonIcon,{onClick:()=>this.openSingleMetricView(e),isDisabled:e.forecast_status!==de.b.FINISHED,iconType:"visLine","aria-label":t})}}];return Object(_.jsx)(l.EuiInMemoryTable,{compressed:!0,items:e,columns:t,pagination:{pageSizeOptions:[5,10,25]},sorting:!0})}}const xe=Object(je.withKibana)(forecasts_table_ForecastsTableUI);function ve({item:e}){return Object(_.jsx)(l.EuiTableRow,null,""!==e[0]&&Object(_.jsx)(l.EuiTableRowCell,null,Object(_.jsx)("span",{className:"job-item header"},e[0])),Object(_.jsx)(l.EuiTableRowCell,null,Object(_.jsx)("span",{className:"job-item"},e[1])))}function ye({section:e}){return 0===e.items.length?Object(_.jsx)("div",null):Object(_.jsx)(r.a.Fragment,null,Object(_.jsx)(l.EuiFlexGroup,{gutterSize:"xs"},Object(_.jsx)(l.EuiFlexItem,{grow:!1},Object(_.jsx)(l.EuiTitle,{size:"xs"},Object(_.jsx)("h4",null,e.title))),Object(_.jsx)(l.EuiFlexItem,{grow:!1},e.titleAction)),Object(_.jsx)("div",{className:"job-section","data-test-subj":`mlJobRowDetailsSection-${e.id}`},Object(_.jsx)(l.EuiTable,{compressed:!0},Object(_.jsx)(l.EuiTableBody,null,e.items.map(((e,t)=>Object(_.jsx)(ve,{item:e,key:t})))))))}class job_details_pane_JobDetailsPane extends s.Component{constructor(e){super(e),this.state={}}static getDerivedStateFromProps(e){const{sections:t,time:a}=e;return{sections:t,time:a}}render(){const{sections:e,time:t}=this.state;return Object(_.jsx)(r.a.Fragment,null,Object(_.jsx)(l.EuiSpacer,{size:"s"}),Object(_.jsx)("div",{className:"row",time:t,"data-test-subj":this.props["data-test-subj"]},Object(_.jsx)("div",{className:"col-md-6"},e.filter((e=>"left"===e.position)).map(((e,t)=>Object(_.jsx)(ye,{section:e,key:t})))),Object(_.jsx)("div",{className:"col-md-6"},e.filter((e=>"right"===e.position)).map(((e,t)=>Object(_.jsx)(ye,{section:e,key:t}))))))}}var Oe=a(276);class job_details_JobDetailsUI extends s.Component{constructor(e){super(e),this.state={datafeedChartFlyoutVisible:!1},this.props.addYourself&&this.props.addYourself(e.jobId,(e=>this.updateJob(e)))}componentWillUnmount(){this.props.removeYourself(this.props.jobId)}updateJob(e){this.setState({job:e})}render(){var e;const t=null!==(e=this.state.job)&&void 0!==e?e:this.props.job,{services:{http:{basePath:a}}}=this.props.kibana;if(void 0===t)return Object(_.jsx)("div",{className:"job-loading-spinner","data-test-subj":"mlJobDetails loading"},Object(_.jsx)(l.EuiLoadingSpinner,{size:"l"}));{const{showFullDetails:e,refreshJobList:i,showClearButton:n}=this.props,{general:c,customUrl:d,node:u,calendars:p,detectors:m,influencers:h,analysisConfig:f,analysisLimits:g,dataDescription:j,customSettings:x,jobTags:y,datafeed:O,counts:E,modelSizeStats:w,jobTimingStats:S,datafeedTimingStats:M,alertRules:k}=function(e,t,a){var i,n;if(0===Object.keys(e).length)return{};const s={id:"general",title:v.i18n.translate("xpack.ml.jobsList.jobDetails.generalTitle",{defaultMessage:"General"}),position:"left",items:U(e,!0).map(V)},{job_tags:r,custom_urls:o,...c}=null!==(i=e.custom_settings)&&void 0!==i?i:{},d={id:"customUrl",title:v.i18n.translate("xpack.ml.jobsList.jobDetails.customUrlsTitle",{defaultMessage:"Custom URLs"}),position:"right",items:o?o.map((e=>[e.url_name,e.url_value,e.time_range])):[]},u={id:"analysisConfig",title:v.i18n.translate("xpack.ml.jobsList.jobDetails.customSettingsTitle",{defaultMessage:"Custom settings"}),position:"right",items:c?U(c,!0,!0):[]},p={id:"analysisConfig",title:v.i18n.translate("xpack.ml.jobsList.jobDetails.jobTagsTitle",{defaultMessage:"Job tags"}),position:"right",items:r?U(r):[]},m={id:"node",title:v.i18n.translate("xpack.ml.jobsList.jobDetails.nodeTitle",{defaultMessage:"Node"}),position:"right",items:[]};e.node&&m.items.push(["name",e.node.name]);const h={id:"calendars",title:v.i18n.translate("xpack.ml.jobsList.jobDetails.calendarsTitle",{defaultMessage:"Calendars"}),position:"right",items:[]};if(e.calendars){h.items=e.calendars.map((e=>["",Object(_.jsx)(l.EuiLink,{href:t.prepend(`/app/ml/settings/calendars_list/edit_calendar/${e}?_g=()`)},e)]));const a=s.items.findIndex((e=>"calendars"===e[0]));a>=0&&s.items.splice(a,1)}const f={id:"alertRules",title:v.i18n.translate("xpack.ml.jobsList.jobDetails.alertRulesTitle",{defaultMessage:"Alert rules"}),position:"right",items:(null!==(n=e.alerting_rules)&&void 0!==n?n:[]).map((e=>["",Object(_.jsx)(G.a,{initialAlert:e,onSave:a})]))},g={id:"detectors",title:v.i18n.translate("xpack.ml.jobsList.jobDetails.detectorsTitle",{defaultMessage:"Detectors"}),position:"left",items:[]};e.analysis_config&&e.analysis_config.detectors&&g.items.push(...e.analysis_config.detectors.map((e=>{const t=Object(b.b)(e);return[t,t!==e.detector_description?e.detector_description:""]})));const j={id:"influencers",title:v.i18n.translate("xpack.ml.jobsList.jobDetails.influencersTitle",{defaultMessage:"Influencers"}),position:"left",items:e.analysis_config.influencers.map((e=>["",e]))},x={id:"analysisConfig",title:v.i18n.translate("xpack.ml.jobsList.jobDetails.analysisConfigTitle",{defaultMessage:"Analysis config"}),position:"left",items:U(e.analysis_config)},y={id:"analysisLimits",title:v.i18n.translate("xpack.ml.jobsList.jobDetails.analysisLimitsTitle",{defaultMessage:"Analysis limits"}),position:"left",items:U(e.analysis_limits)},O={id:"dataDescription",title:v.i18n.translate("xpack.ml.jobsList.jobDetails.dataDescriptionTitle",{defaultMessage:"Data description"}),position:"right",items:U(e.data_description)},E={id:"datafeed",title:v.i18n.translate("xpack.ml.jobsList.jobDetails.datafeedTitle",{defaultMessage:"Datafeed"}),position:"left",items:U(e.datafeed_config||{},!0,!0)};if(e.node&&E.items.push(["node",JSON.stringify(e.node)]),e.datafeed_config&&e.datafeed_config.timing_stats){const e=E.items.findIndex((e=>"timing_stats"===e[0]));e>=0&&E.items.splice(e,1)}return{general:s,customUrl:d,node:m,calendars:h,detectors:g,influencers:j,analysisConfig:x,analysisLimits:y,dataDescription:O,customSettings:u,jobTags:p,datafeed:E,counts:{id:"counts",title:v.i18n.translate("xpack.ml.jobsList.jobDetails.countsTitle",{defaultMessage:"Counts"}),position:"left",items:U(e.data_counts).map(V)},modelSizeStats:{id:"modelSizeStats",title:v.i18n.translate("xpack.ml.jobsList.jobDetails.modelSizeStatsTitle",{defaultMessage:"Model size stats"}),position:"right",items:U(e.model_size_stats).map(V)},jobTimingStats:{id:"jobTimingStats",title:v.i18n.translate("xpack.ml.jobsList.jobDetails.jobTimingStatsTitle",{defaultMessage:"Job timing stats"}),position:"left",items:U(e.timing_stats).map(V)},datafeedTimingStats:{id:"datafeedTimingStats",title:v.i18n.translate("xpack.ml.jobsList.jobDetails.datafeedTimingStatsTitle",{defaultMessage:"Timing stats"}),position:"right",items:e.datafeed_config&&e.datafeed_config.timing_stats?U(e.datafeed_config.timing_stats).filter((e=>"total_search_time_ms"!==e[0])).map(V):[]},alertRules:f}}(t,a,i);O.titleAction=Object(_.jsx)(l.EuiToolTip,{content:Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.jobDetails.datafeedChartTooltipText",defaultMessage:"Datafeed chart"})},Object(_.jsx)(l.EuiButtonIcon,{size:"xs","aria-label":v.i18n.translate("xpack.ml.jobDetails.datafeedChartAriaLabel",{defaultMessage:"Datafeed chart"}),iconType:"visAreaStacked",onClick:()=>this.setState({datafeedChartFlyoutVisible:!0})}));const C=[{id:"job-settings","data-test-subj":"mlJobListTab-job-settings",name:v.i18n.translate("xpack.ml.jobsList.jobDetails.tabs.jobSettingsLabel",{defaultMessage:"Job settings"}),content:Object(_.jsx)(job_details_pane_JobDetailsPane,{"data-test-subj":"mlJobDetails-job-settings",sections:[c,x,d,y,u,p,k]}),time:t.open_time},{id:"job-config","data-test-subj":"mlJobListTab-job-config",name:v.i18n.translate("xpack.ml.jobsList.jobDetails.tabs.jobConfigLabel",{defaultMessage:"Job config"}),content:Object(_.jsx)(job_details_pane_JobDetailsPane,{"data-test-subj":"mlJobDetails-job-config",sections:[m,h,f,g,j]})},{id:"datafeed","data-test-subj":"mlJobListTab-datafeed",name:v.i18n.translate("xpack.ml.jobsList.jobDetails.tabs.datafeedLabel",{defaultMessage:"Datafeed"}),content:Object(_.jsx)(r.a.Fragment,null,Object(_.jsx)(job_details_pane_JobDetailsPane,{"data-test-subj":"mlJobDetails-datafeed",sections:[O,M]}),this.props.jobId&&this.state.datafeedChartFlyoutVisible?Object(_.jsx)(Y.a,{onClose:()=>{this.setState({datafeedChartFlyoutVisible:!1})},end:t.data_counts.latest_bucket_timestamp,jobId:this.props.jobId}):null)},{id:"counts","data-test-subj":"mlJobListTab-counts",name:v.i18n.translate("xpack.ml.jobsList.jobDetails.tabs.countsLabel",{defaultMessage:"Counts"}),content:Object(_.jsx)(job_details_pane_JobDetailsPane,{"data-test-subj":"mlJobDetails-counts",sections:[E,w,S]})},{id:"json","data-test-subj":"mlJobListTab-json",name:v.i18n.translate("xpack.ml.jobsList.jobDetails.tabs.jsonLabel",{defaultMessage:"JSON"}),content:Object(_.jsx)(H,{job:t})},{id:"job-messages","data-test-subj":"mlJobListTab-job-messages",name:v.i18n.translate("xpack.ml.jobsList.jobDetails.tabs.jobMessagesLabel",{defaultMessage:"Job messages"}),content:Object(_.jsx)(Oe.a,{jobId:t.job_id,refreshJobList:i,showClearButton:n})}];return e&&O.items.length&&C.push({id:"datafeed-preview","data-test-subj":"mlJobListTab-datafeed-preview",name:v.i18n.translate("xpack.ml.jobsList.jobDetails.tabs.datafeedPreviewLabel",{defaultMessage:"Datafeed preview"}),content:Object(_.jsx)(datafeed_preview_tab_DatafeedPreviewPane,{job:t})},{id:"forecasts","data-test-subj":"mlJobListTab-forecasts",name:v.i18n.translate("xpack.ml.jobsList.jobDetails.tabs.forecastsLabel",{defaultMessage:"Forecasts"}),content:Object(_.jsx)(xe,{job:t})}),e&&(C.push({id:"annotations","data-test-subj":"mlJobListTab-annotations",name:v.i18n.translate("xpack.ml.jobsList.jobDetails.tabs.annotationsLabel",{defaultMessage:"Annotations"}),content:Object(_.jsx)(s.Fragment,null,Object(_.jsx)($.a,{jobs:[t],drillDown:!0}),Object(_.jsx)(X.a,null))}),C.push({id:"modelSnapshots","data-test-subj":"mlJobListTab-modelSnapshots",name:v.i18n.translate("xpack.ml.jobsList.jobDetails.tabs.modelSnapshotsLabel",{defaultMessage:"Model snapshots"}),content:Object(_.jsx)(s.Fragment,null,Object(_.jsx)(me,{job:t,refreshJobList:i}))})),Object(_.jsx)("div",{className:"tab-contents","data-test-subj":`mlJobListRowDetails details-${t.job_id}`},Object(_.jsx)(l.EuiTabbedContent,{tabs:C,initialSelectedTab:C[0],onTabClick:()=>{}}))}}}const Ee=Object(je.withKibana)(job_details_JobDetailsUI),we=({queryText:e,setFilters:t})=>{const[a,i]=Object(s.useState)(null),{services:{mlServices:{mlApiServices:n}}}=Object(C.b)(),r=Object(s.useCallback)((async()=>{try{return(await n.jobs.groups()).map((e=>({value:e.id,view:Object(_.jsx)("div",{className:"group-item"},Object(_.jsx)(k,{name:e.id})," ",Object(_.jsx)("span",null,Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.jobFilterBar.jobGroupTitle",defaultMessage:"({jobsCount, plural, one {# job} other {# jobs}})",values:{jobsCount:e.jobIds.length}})))})))}catch(e){return[]}}),[]),c=Object(s.useMemo)((()=>l.EuiSearchBar.Query.parse(null!=e?e:"")),[e]);Object(s.useEffect)((()=>{t(c)}),[e]);const d=Object(s.useMemo)((()=>[{type:"field_value_toggle_group",field:"job_state",items:[{value:"opened",name:v.i18n.translate("xpack.ml.jobsList.jobFilterBar.openedLabel",{defaultMessage:"Opened"})},{value:"closed",name:v.i18n.translate("xpack.ml.jobsList.jobFilterBar.closedLabel",{defaultMessage:"Closed"})},{value:"failed",name:v.i18n.translate("xpack.ml.jobsList.jobFilterBar.failedLabel",{defaultMessage:"Failed"})}]},{type:"field_value_toggle_group",field:"datafeed_state",items:[{value:"started",name:v.i18n.translate("xpack.ml.jobsList.jobFilterBar.startedLabel",{defaultMessage:"Started"})},{value:"stopped",name:v.i18n.translate("xpack.ml.jobsList.jobFilterBar.stoppedLabel",{defaultMessage:"Stopped"})}]},{type:"field_value_selection",field:"groups",name:v.i18n.translate("xpack.ml.jobsList.jobFilterBar.groupLabel",{defaultMessage:"Group"}),multiSelect:"or",cache:1e4,options:()=>r()}]),[]),u=Object(s.useMemo)((()=>null===a?"":v.i18n.translate("xpack.ml.jobsList.jobFilterBar.invalidSearchErrorMessage",{defaultMessage:"Invalid search: {errorMessage}",values:{errorMessage:a.message}})),[a]);return Object(_.jsx)(l.EuiFlexGroup,{direction:"column"},Object(_.jsx)(l.EuiFlexItem,{"data-test-subj":"mlJobListSearchBar",grow:!1},Object(_.jsx)(l.EuiSearchBar,{box:{incremental:!0},query:c,filters:d,onChange:({query:e,error:a})=>{a?i(a):(t(e),i(null))},className:"mlJobFilterBar"}),Object(_.jsx)(l.EuiFormRow,{fullWidth:!0,isInvalid:null!==a,error:u,style:{maxHeight:0}},Object(_.jsx)(s.Fragment,null))))};class tabs_job_details_JobDetails extends s.Component{constructor(e){super(e),n()(this,"onDescriptionChange",(e=>{this.setJobDetails({jobDescription:e.target.value})})),n()(this,"onMmlChange",(e=>{this.setJobDetails({jobModelMemoryLimit:e.target.value})})),n()(this,"onModelSnapshotRetentionDaysChange",(e=>{const t=Math.floor(+e.target.value);this.setJobDetails({jobModelSnapshotRetentionDays:t,...this.state.dailyModelSnapshotRetentionAfterDays>t?{jobDailyModelSnapshotRetentionAfterDays:t}:{}})})),n()(this,"onDailyModelSnapshotRetentionAfterDaysChange",(e=>{const t=Math.floor(+e.target.value);t<=this.state.modelSnapshotRetentionDays&&this.setJobDetails({jobDailyModelSnapshotRetentionAfterDays:t})})),n()(this,"onGroupsChange",(e=>{this.setJobDetails({jobGroups:e.map((e=>e.label))})})),n()(this,"onCreateGroup",((e,t)=>{const a=e.trim().toLowerCase();if(!a)return;const i={label:e},n=this.state.groups;-1===t.findIndex((e=>e.label.trim().toLowerCase()===a))&&n.push(i);const s=this.state.selectedGroups.concat(i);this.setState({groups:n},(()=>this.onGroupsChange(s)))})),this.state={description:"",groups:[],selectedGroups:[],mml:"",mmlValidationError:"",groupsValidationError:"",modelSnapshotRetentionDays:1,dailyModelSnapshotRetentionAfterDays:1},this.setJobDetails=e.setJobDetails}componentDidMount(){c.ml.jobs.groups().then((e=>{const t=e.map((e=>({label:e.id,color:Object(M.a)(e.id)})));this.setState({groups:t})})).catch((e=>{console.error("Could not load groups",e)}))}static getDerivedStateFromProps(e){const t=void 0!==e.jobGroups?e.jobGroups.map((e=>({label:e,color:Object(M.a)(e)}))):[],{datafeedRunning:a,jobClosed:i}=e;let n=null;return i||(n=Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.jobDetails.modelMemoryLimitJobOpenLabelHelp",defaultMessage:"Model memory limit cannot be edited while the job is open."})),a&&(n=Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.jobDetails.modelMemoryLimitLabelHelp",defaultMessage:"Model memory limit cannot be edited while the datafeed is running."})),{description:e.jobDescription,selectedGroups:t,mml:e.jobModelMemoryLimit,mmlHelpText:n,mmlValidationError:e.jobModelMemoryLimitValidationError,groupsValidationError:e.jobGroupsValidationError,modelSnapshotRetentionDays:e.jobModelSnapshotRetentionDays,dailyModelSnapshotRetentionAfterDays:e.jobDailyModelSnapshotRetentionAfterDays}}render(){const{description:e,selectedGroups:t,mml:a,groups:i,mmlValidationError:n,groupsValidationError:s,modelSnapshotRetentionDays:c,dailyModelSnapshotRetentionAfterDays:d,mmlHelpText:u}=this.state,{datafeedRunning:p,jobClosed:m}=this.props;return Object(_.jsx)(r.a.Fragment,null,Object(_.jsx)(l.EuiSpacer,{size:"m"}),Object(_.jsx)(l.EuiForm,null,Object(_.jsx)(l.EuiFormRow,{label:Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.jobDetails.jobDescriptionLabel",defaultMessage:"Job description"})},Object(_.jsx)(l.EuiFieldText,{value:e,onChange:this.onDescriptionChange})),Object(_.jsx)(l.EuiFormRow,{label:Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.jobDetails.jobGroupsLabel",defaultMessage:"Job groups"}),isInvalid:""!==s,error:s},Object(_.jsx)(l.EuiComboBox,{placeholder:v.i18n.translate("xpack.ml.jobsList.editJobFlyout.jobDetails.jobGroupsPlaceholder",{defaultMessage:"Select or create groups"}),options:i,selectedOptions:t,onChange:this.onGroupsChange,onCreateOption:this.onCreateGroup,isClearable:!0,isInvalid:""!==s,error:s})),Object(_.jsx)(l.EuiFormRow,{label:Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.jobDetails.modelMemoryLimitLabel",defaultMessage:"Model memory limit"}),helpText:u,isInvalid:""!==n,error:n},Object(_.jsx)(l.EuiFieldText,{value:a,onChange:this.onMmlChange,isInvalid:""!==n,error:n,disabled:p||!m})),Object(_.jsx)(l.EuiFormRow,{label:Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.jobDetails.modelSnapshotRetentionDaysLabel",defaultMessage:"Model snapshot retention days"})},Object(_.jsx)(l.EuiFieldNumber,{min:0,value:c,onChange:this.onModelSnapshotRetentionDaysChange})),Object(_.jsx)(l.EuiFormRow,{label:Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.jobDetails.dailyModelSnapshotRetentionAfterDaysLabel",defaultMessage:"Daily model snapshot retention after days"})},Object(_.jsx)(l.EuiFieldNumber,{min:0,max:c,value:d,onChange:this.onDailyModelSnapshotRetentionAfterDaysChange}))))}}var _e=a(79);class detectors_Detectors extends s.Component{constructor(e){super(e),n()(this,"onDescriptionChange",((e,t)=>{const a=this.state.detectorDescriptions;a[t]=e.target.value,this.setDetectorDescriptions({jobDetectorDescriptions:a})})),this.detectors=_e.a.getJobGroups().map((e=>({label:e.id}))),this.state={detectors:[],detectorDescriptions:[]},this.setDetectorDescriptions=e.setDetectorDescriptions}static getDerivedStateFromProps(e){return{detectors:e.jobDetectors,detectorDescriptions:e.jobDetectorDescriptions}}render(){const{detectors:e,detectorDescriptions:t}=this.state;return Object(_.jsx)(r.a.Fragment,null,Object(_.jsx)(l.EuiSpacer,{size:"m"}),Object(_.jsx)(l.EuiTitle,{size:"xs"},Object(_.jsx)("h4",null,Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.detectors.title",defaultMessage:"Edit detector descriptions"}))),Object(_.jsx)(l.EuiSpacer,{size:"m"}),Object(_.jsx)(l.EuiForm,null,t.map(((t,a)=>Object(_.jsx)(l.EuiFormRow,{label:Object(b.b)(e[a]),key:a},Object(_.jsx)(l.EuiFieldText,{value:t,onChange:e=>this.onDescriptionChange(e,a)}))))))}}var Se=a(83);function Me(e,t){const a=void 0!==e?Object(te.a)(e).asSeconds():"";return{queryDelay:"60s",frequency:Object(W.f)(a)+"s",scrollSize:t.datafeeds.scroll_size}}class datafeed_Datafeed extends s.Component{constructor(e){super(e),n()(this,"onQueryChange",(e=>{this.setDatafeed({datafeedQuery:e})})),n()(this,"onQueryDelayChange",(e=>{this.setDatafeed({datafeedQueryDelay:e.target.value})})),n()(this,"onFrequencyChange",(e=>{this.setDatafeed({datafeedFrequency:e.target.value})})),n()(this,"onScrollSizeChange",(e=>{this.setDatafeed({datafeedScrollSize:+e.target.value})})),this.state={query:"",queryDelay:"",frequency:"",scrollSize:"",defaults:{queryDelay:"",frequency:"",scrollSize:0},jobDefaults:Object(Se.c)()},this.setDatafeed=e.setDatafeed}static getDerivedStateFromProps(e,t){return{query:e.datafeedQuery,queryDelay:e.datafeedQueryDelay,frequency:e.datafeedFrequency,scrollSize:e.datafeedScrollSize,defaults:Me(e.jobBucketSpan,t.jobDefaults)}}render(){const{query:e,queryDelay:t,frequency:a,scrollSize:i,defaults:n}=this.state,{datafeedRunning:s}=this.props;return Object(_.jsx)(r.a.Fragment,null,Object(_.jsx)(l.EuiSpacer,{size:"m"}),s&&Object(_.jsx)(r.a.Fragment,null,Object(_.jsx)(l.EuiCallOut,{color:"warning"},Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.datafeed.readOnlyCalloutText",defaultMessage:"Datafeed settings cannot be edited while the datafeed is running. Please stop the job if you wish to edit these settings."})),Object(_.jsx)(l.EuiSpacer,{size:"l"})),Object(_.jsx)(l.EuiForm,null,Object(_.jsx)(l.EuiFormRow,{label:Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.datafeed.queryLabel",defaultMessage:"Query"}),style:{maxWidth:"inherit"}},Object(_.jsx)(q.a,{mode:q.b.XJSON,value:e,onChange:this.onQueryChange,height:"200px",readOnly:s})),Object(_.jsx)(l.EuiFormRow,{label:Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.datafeed.queryDelayLabel",defaultMessage:"Query delay"})},Object(_.jsx)(l.EuiFieldText,{value:t,placeholder:n.queryDelay,onChange:this.onQueryDelayChange,disabled:s})),Object(_.jsx)(l.EuiFormRow,{label:Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.datafeed.frequencyLabel",defaultMessage:"Frequency"})},Object(_.jsx)(l.EuiFieldText,{value:a,placeholder:n.frequency,onChange:this.onFrequencyChange,disabled:s})),Object(_.jsx)(l.EuiFormRow,{label:Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.datafeed.scrollSizeLabel",defaultMessage:"Scroll size"})},Object(_.jsx)(l.EuiFieldNumber,{value:i,placeholder:n.scrollSize,onChange:this.onScrollSizeChange,disabled:s}))))}}var ke=a(251),Ce=a(281),Te=a(139),Fe=a(145);function Ie(e){const t={groups:e},a=Object(W.u)(t),{valid:i}=a,n={valid:i,message:""};return Object(Te.b)(a,{groupIds:n}),n}var De=a(170);class edit_job_flyout_EditJobFlyoutUI extends s.Component{constructor(e){super(e),n()(this,"_initialJobFormState",null),n()(this,"closeFlyout",((e=!1)=>{!this.containsUnsavedChanges()||e?(this.setState({isConfirmationModalVisible:!1}),this.setState({isFlyoutVisible:!1})):this.setState({isConfirmationModalVisible:!0})})),n()(this,"showFlyout",(e=>{const t=e.hasDatafeed;Object(d.k)(e.id).then((e=>{this.extractJob(e,t),this.setState({job:e,isFlyoutVisible:!0})})).catch((e=>{console.error(e)}))})),n()(this,"setJobDetails",(e=>{let{jobModelMemoryLimitValidationError:t,jobGroupsValidationError:a}=this.state;void 0!==e.jobModelMemoryLimit&&(t=function(e){const t=Object(Se.d)(),a={analysis_limits:{model_memory_limit:e}};let i=Object(W.w)(e),{valid:n}=i;n&&(i=Object(W.v)(a,t),n=i.valid);const s={valid:n,message:""};return Object(Te.b)(i,{modelMemoryLimit:s}),s}(e.jobModelMemoryLimit).message),void 0!==e.jobGroups&&(a=Ie(e.jobGroups).message,""===a&&c.ml.jobs.jobsExist(e.jobGroups,!0).then((e=>{!1===(!1===Object.values(e).some((e=>!0===e.exists&&!1===e.isGroup)))&&this.setState({jobGroupsValidationError:v.i18n.translate("xpack.ml.jobsList.editJobFlyout.groupsAndJobsHasSameIdErrorMessage",{defaultMessage:"A job with this ID already exists. Groups and jobs cannot use the same ID."}),isValidJobDetails:!1})})));const i=""===t&&""===a;this.setState({...e,jobModelMemoryLimitValidationError:t,jobGroupsValidationError:a,isValidJobDetails:i})})),n()(this,"setDetectorDescriptions",(e=>{this.setState({...e})})),n()(this,"setDatafeed",(e=>{this.setState({...e})})),n()(this,"setCustomUrls",(e=>{const t=void 0===(a=e)||0===a.length||!a.some(((e,t)=>{const i=e.url_name,n=[...a];n.splice(t,1);let s=Object(Fe.b)(i,n);if(!0===s){const t=e.time_range;s=Object(Fe.c)(t)}return!s}));var a;this.setState({jobCustomUrls:e,isValidJobCustomUrls:t})})),n()(this,"save",(()=>{const e={description:this.state.jobDescription,groups:this.state.jobGroups,mml:this.state.jobModelMemoryLimit,modelSnapshotRetentionDays:this.state.jobModelSnapshotRetentionDays,dailyModelSnapshotRetentionAfterDays:this.state.jobDailyModelSnapshotRetentionAfterDays,detectorDescriptions:this.state.jobDetectorDescriptions,datafeedQuery:Object(De.b)(this.state.datafeedQuery),datafeedQueryDelay:this.state.datafeedQueryDelay,datafeedFrequency:this.state.datafeedFrequency,datafeedScrollSize:this.state.datafeedScrollSize,customUrls:this.state.jobCustomUrls},{toasts:t}=this.props.kibana.services.notifications,a=Object(oe.b)(t);Object(Ce.c)(this.state.job,e).then((()=>{t.addSuccess(v.i18n.translate("xpack.ml.jobsList.editJobFlyout.changesSavedNotificationMessage",{defaultMessage:"Changes to {jobId} saved",values:{jobId:this.state.job.job_id}})),this.refreshJobs(),this.closeFlyout(!0)})).catch((e=>{console.error(e),a.displayErrorToast(e,v.i18n.translate("xpack.ml.jobsList.editJobFlyout.changesNotSavedNotificationMessage",{defaultMessage:"Could not save changes to {jobId}",values:{jobId:this.state.job.job_id}}))}))})),this.state={job:{},hasDatafeed:!1,datafeedRunning:!1,isFlyoutVisible:!1,isConfirmationModalVisible:!1,jobDescription:"",jobGroups:[],jobModelMemoryLimit:"",jobModelSnapshotRetentionDays:10,jobDailyModelSnapshotRetentionAfterDays:10,jobDetectors:[],jobDetectorDescriptions:[],jobCustomUrls:[],datafeedQuery:"",datafeedQueryDelay:"",datafeedFrequency:"",datafeedScrollSize:"",jobModelMemoryLimitValidationError:"",jobGroupsValidationError:"",isValidJobDetails:!0,isValidJobCustomUrls:!0},this.refreshJobs=this.props.refreshJobs}componentDidMount(){"function"==typeof this.props.setShowFunction&&this.props.setShowFunction(this.showFlyout)}componentWillUnmount(){"function"==typeof this.props.unsetShowFunction&&this.props.unsetShowFunction()}containsUnsavedChanges(){return!Object(u.isEqual)(this._initialJobFormState,Object(u.pick)(this.state,["jobDescription","jobGroups","jobModelMemoryLimit","jobModelSnapshotRetentionDays","jobDailyModelSnapshotRetentionAfterDays","jobCustomUrls","jobDetectors","jobDetectorDescriptions","jobBucketSpan","datafeedQuery","datafeedQueryDelay","datafeedFrequency","datafeedScrollSize"]))}extractInitialJobFormState(e,t){const a=e.analysis_limits&&e.analysis_limits.model_memory_limit?e.analysis_limits.model_memory_limit:"",i=void 0!==e.model_snapshot_retention_days?e.model_snapshot_retention_days:10,n=void 0!==e.daily_model_snapshot_retention_after_days?e.daily_model_snapshot_retention_after_days:i,s=e.analysis_config&&e.analysis_config.detectors?[...e.analysis_config.detectors]:[],r=e.analysis_config?e.analysis_config.bucket_span:"",o={...e.datafeed_config},l=void 0!==o.frequency?o.frequency:"",c=e.custom_settings&&e.custom_settings.custom_urls?[...e.custom_settings.custom_urls]:[];this._initialJobFormState=Object.freeze({jobDescription:e.description,jobGroups:void 0!==e.groups?e.groups:[],jobModelMemoryLimit:a,jobModelSnapshotRetentionDays:i,jobDailyModelSnapshotRetentionAfterDays:n,jobDetectors:s,jobDetectorDescriptions:s.map((e=>e.detector_description)),jobBucketSpan:r,jobCustomUrls:c,datafeedQuery:t?JSON.stringify(o.query,null,2):"",datafeedQueryDelay:t?o.query_delay:"",datafeedFrequency:t?l:"",datafeedScrollSize:t?+o.scroll_size:null})}extractJob(e,t){this.extractInitialJobFormState(e,t);const a=t&&e.datafeed_config.state!==de.a.STOPPED,i=e.state===de.c.CLOSED;this.setState({job:e,hasDatafeed:t,datafeedRunning:a,jobClosed:i,jobModelMemoryLimitValidationError:"",jobGroupsValidationError:"",...Object(u.cloneDeep)(this._initialJobFormState)})}render(){let e,t;if(this.state.isFlyoutVisible){const{job:t,jobDescription:a,jobGroups:i,jobModelMemoryLimit:n,jobModelSnapshotRetentionDays:s,jobDailyModelSnapshotRetentionAfterDays:r,jobDetectors:c,jobDetectorDescriptions:d,jobBucketSpan:u,jobCustomUrls:p,datafeedQuery:m,datafeedQueryDelay:b,datafeedFrequency:h,datafeedScrollSize:f,jobGroupsValidationError:g,jobModelMemoryLimitValidationError:j,isValidJobDetails:x,isValidJobCustomUrls:y,datafeedRunning:O,jobClosed:E}=this.state,w=[{id:"job-details","data-test-subj":"mlEditJobFlyout-jobDetails",name:v.i18n.translate("xpack.ml.jobsList.editJobFlyout.jobDetailsTitle",{defaultMessage:"Job details"}),content:Object(_.jsx)(tabs_job_details_JobDetails,{jobClosed:E,datafeedRunning:O,jobDescription:a,jobGroups:i,jobModelMemoryLimit:n,jobModelSnapshotRetentionDays:s,jobDailyModelSnapshotRetentionAfterDays:r,setJobDetails:this.setJobDetails,jobGroupsValidationError:g,jobModelMemoryLimitValidationError:j})},{id:"detectors","data-test-subj":"mlEditJobFlyout-detectors",name:v.i18n.translate("xpack.ml.jobsList.editJobFlyout.detectorsTitle",{defaultMessage:"Detectors"}),content:Object(_.jsx)(detectors_Detectors,{jobDetectors:c,jobDetectorDescriptions:d,setDetectorDescriptions:this.setDetectorDescriptions})},{id:"datafeed","data-test-subj":"mlEditJobFlyout-datafeed",name:v.i18n.translate("xpack.ml.jobsList.editJobFlyout.datafeedTitle",{defaultMessage:"Datafeed"}),content:Object(_.jsx)(datafeed_Datafeed,{datafeedQuery:m,datafeedQueryDelay:b,datafeedFrequency:h,datafeedScrollSize:f,jobBucketSpan:u,setDatafeed:this.setDatafeed,datafeedRunning:O})},{id:"custom-urls","data-test-subj":"mlEditJobFlyout-customUrls",name:v.i18n.translate("xpack.ml.jobsList.editJobFlyout.customUrlsTitle",{defaultMessage:"Custom URLs"}),content:Object(_.jsx)(ke.a,{job:t,jobCustomUrls:p,setCustomUrls:this.setCustomUrls})}];e=Object(_.jsx)(l.EuiFlyout,{onClose:()=>{this.closeFlyout()},size:"m","data-test-subj":"mlJobEditFlyout"},Object(_.jsx)(l.EuiFlyoutHeader,null,Object(_.jsx)(l.EuiTitle,null,Object(_.jsx)("h2",null,Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.pageTitle",defaultMessage:"Edit {jobId}",values:{jobId:t.job_id}})))),Object(_.jsx)(l.EuiFlyoutBody,null,Object(_.jsx)(l.EuiTabbedContent,{tabs:w,initialSelectedTab:w[0],onTabClick:()=>{}})),Object(_.jsx)(l.EuiFlyoutFooter,null,Object(_.jsx)(l.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(_.jsx)(l.EuiFlexItem,{grow:!1},Object(_.jsx)(l.EuiButtonEmpty,{iconType:"cross",onClick:()=>{this.closeFlyout()},flush:"left","data-test-subj":"mlEditJobFlyoutCloseButton"},Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.closeButtonLabel",defaultMessage:"Close"}))),Object(_.jsx)(l.EuiFlexItem,{grow:!1},Object(_.jsx)(l.EuiButton,{onClick:this.save,fill:!0,isDisabled:!1===x||!1===y,"data-test-subj":"mlEditJobFlyoutSaveButton"},Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.saveButtonLabel",defaultMessage:"Save"}))))))}return this.state.isConfirmationModalVisible&&(t=Object(_.jsx)(l.EuiConfirmModal,{title:Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.unsavedChangesDialogTitle",defaultMessage:"Save changes before leaving?"}),onCancel:()=>this.closeFlyout(!0),onConfirm:()=>this.save(),cancelButtonText:Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.leaveAnywayButtonLabel",defaultMessage:"Leave anyway"}),confirmButtonText:Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.saveChangesButtonLabel",defaultMessage:"Save changes"}),defaultFocusedButton:"confirm"},Object(_.jsx)("p",null,Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.unsavedChangesDialogMessage",defaultMessage:"If you don't save, your changes will be lost."})))),Object(_.jsx)("div",null,e,t)}}const Ae=Object(je.withKibana)(edit_job_flyout_EditJobFlyoutUI);var Le=a(155),Re=a(261);const Pe=({setShowFunction:e,unsetShowFunction:t,refreshJobs:a})=>{const[i,n]=Object(s.useState)(!1),[c,u]=Object(s.useState)(!1),[p,m]=Object(s.useState)([]),[b,h]=Object(s.useState)(!1);Object(s.useEffect)((()=>("function"==typeof e&&e(f),()=>{"function"==typeof t&&t()})),[]);const f=Object(s.useCallback)((e=>{m(e.map((({id:e})=>e))),u(!0),n(!1)}),[]),g=Object(s.useCallback)((()=>{u(!1),h(!1)}),[]),j=Object(s.useCallback)((()=>{n(!0),Object(d.d)(p.map((e=>({id:e})))),setTimeout((()=>{g(),a()}),Le.b)}),[p,a]);return!1===c||0===p.length?null:b?Object(_.jsx)(l.EuiModal,{"data-test-subj":"mlDeleteJobConfirmModal",onClose:g},Object(_.jsx)(l.EuiModalHeader,null,Object(_.jsx)(l.EuiModalHeaderTitle,null,Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.deleteJobModal.deleteJobsTitle",defaultMessage:"Delete {jobsCount, plural, one {{jobId}} other {# jobs}}?",values:{jobsCount:p.length,jobId:p[0]}}))),Object(_.jsx)(l.EuiModalBody,null,Object(_.jsx)("p",null,!0===i?Object(_.jsx)("div",null,Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.deleteJobModal.deletingJobsStatusLabel",defaultMessage:"Deleting jobs"}),Object(_.jsx)(l.EuiSpacer,null),Object(_.jsx)("div",{style:{textAlign:"center"}},Object(_.jsx)(l.EuiLoadingSpinner,{size:"l"}))):Object(_.jsx)(l.EuiText,null,Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.deleteJobModal.deleteMultipleJobsDescription",defaultMessage:"Deleting {jobsCount, plural, one {a job} other {multiple jobs}} can be time consuming. {jobsCount, plural, one {It} other {They}} will be deleted in the background and may not disappear from the jobs list instantly.",values:{jobsCount:p.length}})))),Object(_.jsx)(r.a.Fragment,null,Object(_.jsx)(l.EuiSpacer,null),Object(_.jsx)(l.EuiModalFooter,null,Object(_.jsx)(l.EuiButtonEmpty,{onClick:g,disabled:i},Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.deleteJobModal.cancelButtonLabel",defaultMessage:"Cancel"})),Object(_.jsx)(l.EuiButton,{onClick:j,fill:!0,disabled:i,color:"danger","data-test-subj":"mlDeleteJobConfirmModalButton"},Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.deleteJobModal.deleteButtonLabel",defaultMessage:"Delete"}))))):Object(_.jsx)(r.a.Fragment,null,Object(_.jsx)(Re.a,{jobIds:p,jobType:"anomaly-detector",canDeleteCallback:()=>{h(!0)},onCloseCallback:g,refreshJobsCallback:a}))},Ne=({jobs:e})=>{const t=Object(s.useMemo)((()=>e.filter((e=>e.jobState!==de.c.CLOSED)).length),[e]);return 0===t?null:Object(_.jsx)(r.a.Fragment,null,Object(_.jsx)(l.EuiCallOut,{title:Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.resetJobModal.openJobsWarningCallout.title",defaultMessage:"{openJobsCount, plural, one {# job is} other {# jobs are}} not closed",values:{openJobsCount:t}}),color:"warning"},Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.resetJobModal.openJobsWarningCallout.description1",defaultMessage:"{openJobsCount, plural, one {This job} other {These jobs}} must be closed before {openJobsCount, plural, one {it} other {they}} can be reset. ",values:{openJobsCount:t}}),Object(_.jsx)("br",null),Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.resetJobModal.openJobsWarningCallout.description2",defaultMessage:"{openJobsCount, plural, one {This job} other {These jobs}} will not be reset when clicking the Reset button below.",values:{openJobsCount:t}})),Object(_.jsx)(l.EuiSpacer,{size:"m"}))},ze=({setShowFunction:e,unsetShowFunction:t,refreshJobs:a})=>{const[i,n]=Object(s.useState)(!1),[c,u]=Object(s.useState)(!1),[p,m]=Object(s.useState)([]),[b,h]=Object(s.useState)([]);Object(s.useEffect)((()=>("function"==typeof e&&e(f),()=>{"function"==typeof t&&t()})),[]);const f=Object(s.useCallback)((e=>{m(e.map((({id:e})=>e))),h(e),u(!0),n(!1)}),[]),g=Object(s.useCallback)((()=>{u(!1)}),[]),j=Object(s.useCallback)((async()=>{n(!0),await Object(d.l)(p),g(),setTimeout((()=>{a()}),Le.d)}),[p,a]);return!1===c||0===p.length?null:Object(_.jsx)(l.EuiModal,{"data-test-subj":"mlResetJobConfirmModal",onClose:g},Object(_.jsx)(l.EuiModalHeader,null,Object(_.jsx)(l.EuiModalHeaderTitle,null,Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.resetJobModal.resetJobsTitle",defaultMessage:"Reset {jobsCount, plural, one {{jobId}} other {# jobs}}?",values:{jobsCount:p.length,jobId:p[0]}}))),Object(_.jsx)(l.EuiModalBody,null,Object(_.jsx)(r.a.Fragment,null,Object(_.jsx)(Ne,{jobs:b}),Object(_.jsx)(l.EuiText,null,Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.resetJobModal.resetMultipleJobsDescription",defaultMessage:"Resetting {jobsCount, plural, one {a job} other {multiple jobs}} can be time consuming. {jobsCount, plural, one {It} other {They}} will be reset in the background and may not be updated in the jobs list instantly.",values:{jobsCount:p.length}})))),Object(_.jsx)(r.a.Fragment,null,Object(_.jsx)(l.EuiSpacer,null),Object(_.jsx)(l.EuiModalFooter,null,Object(_.jsx)(l.EuiButtonEmpty,{onClick:g,disabled:i},Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.resetJobModal.cancelButtonLabel",defaultMessage:"Cancel"})),Object(_.jsx)(l.EuiButton,{onClick:j,fill:!0,disabled:i,color:"danger","data-test-subj":"mlResetJobConfirmModalButton"},Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.resetJobModal.resetButtonLabel",defaultMessage:"Reset"})))))};a(429);class time_range_selector_TimeRangeSelector extends s.Component{constructor(e){super(e),n()(this,"setStartTab",(e=>{switch(this.setState({startTab:e}),e){case 0:this.setStartTime(void 0);break;case 1:this.setStartTime(this.now)}})),n()(this,"setEndTab",(e=>{switch(this.setState({endTab:e}),e){case 0:this.setEndTime(void 0);break;case 1:this.setEndTime(this.now)}})),n()(this,"setStartTime",(e=>{this.props.setStartTime(e)})),n()(this,"setEndTime",(e=>{this.props.setEndTime(e)})),this.state={startTab:0,endTab:1},this.latestTimestamp=this.props.startTime,this.now=this.props.now}getTabItems(){const e={start:m.a.isMoment(this.props.startTime)?this.props.startTime:this.latestTimestamp,end:m.a.isMoment(this.props.endTime)?this.props.endTime:this.now},t=this.latestTimestamp.format(R.a),a=!0===this.latestTimestamp.valueOf()>0?[Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.startDatafeedModal.continueFromStartTimeLabel",defaultMessage:"Continue from {formattedLatestStartTime}",values:{formattedLatestStartTime:t}}),Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.startDatafeedModal.continueFromNowLabel",defaultMessage:"Continue from now"}),Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.startDatafeedModal.continueFromSpecifiedTimeLabel",defaultMessage:"Continue from specified time"})]:[Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.startDatafeedModal.startAtBeginningOfDataLabel",defaultMessage:"Start at beginning of data"}),Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.startDatafeedModal.startFromNowLabel",defaultMessage:"Start from now"}),Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.startDatafeedModal.specifyStartTimeLabel",defaultMessage:"Specify start time"})];return{startItems:[{index:0,label:a[0]},{index:1,label:a[1]},{index:2,label:a[2],body:Object(_.jsx)(Je,{date:e.start,onChange:this.setStartTime,maxDate:e.end,setIsValid:this.props.setTimeRangeValid,tab:this.state.startTab})}],endItems:[{index:0,label:Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.startDatafeedModal.noEndTimeLabel",defaultMessage:"No end time (Real-time search)"})},{index:1,label:Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.startDatafeedModal.specifyEndTimeLabel",defaultMessage:"Specify end time"}),body:Object(_.jsx)(Je,{date:e.end,onChange:this.setEndTime,minDate:e.start,setIsValid:this.props.setTimeRangeValid,tab:this.state.endTab})}]}}render(){const{startItems:e,endItems:t}=this.getTabItems();return Object(_.jsx)("div",{className:"time-range-selector"},Object(_.jsx)("div",{className:"time-range-section-container"},Object(_.jsx)(Be,{title:Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.startDatafeedModal.searchStartTimeTitle",defaultMessage:"Search start time"}),items:e,switchState:this.state.startTab,switchFunc:this.setStartTab}),Object(_.jsx)(Be,{title:Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.startDatafeedModal.searchEndTimeTitle",defaultMessage:"Search end time"}),items:t,switchState:this.state.endTab,switchFunc:this.setEndTab})))}}function Be({title:e,items:t,switchState:a,switchFunc:i}){return Object(_.jsx)("div",{className:"time-range-section"},Object(_.jsx)("div",{className:"time-range-section-title"},e),Object(_.jsx)("ul",{className:"tab-stack"},t.map(((e,t)=>{let n="";return a===e.index&&(n+="active "),void 0!==e.body&&(n+="has-body "),Object(_.jsx)("li",{key:t,className:n},Object(_.jsx)("a",{onClick:()=>i(e.index),onKeyUp:()=>{}},e.label),void 0!==e.body&&Object(_.jsx)("div",{className:"body"},e.body))}))))}const Je=({date:e,onChange:t,minDate:a,setIsValid:i,tab:n})=>{const[o,c]=Object(s.useState)(e.format(R.a)),[d,u]=Object(s.useState)(n);return Object(s.useEffect)((()=>{d!==n&&(c(e.format(R.a)),u(n))}),[n]),Object(_.jsx)(r.a.Fragment,null,Object(_.jsx)(l.EuiFieldText,{value:o,onChange:function(e){const a=e.target.value;c(a);const n=m()(a);n.isValid()?(i(!0),t(n)):i(!1)},placeholder:R.a,"aria-label":v.i18n.translate('xpack.ml.jobsList.startDatafeedModal.enterDateText"',{defaultMessage:"Enter date"})}),Object(_.jsx)(l.EuiDatePicker,{selected:e,onChange:function(e){c(e.format(R.a)),i(!0),t(e)},minDate:a,inline:!0,showTimeSelect:!0}))};class start_datafeed_modal_StartDatafeedModal extends s.Component{constructor(e){super(e),n()(this,"setStartTime",(e=>{this.setState({startTime:e})})),n()(this,"setEndTime",(e=>{this.setState({endTime:e})})),n()(this,"setCreateAlert",(e=>{this.setState({createAlert:e.target.checked})})),n()(this,"closeModal",(()=>{this.setState({isModalVisible:!1})})),n()(this,"setTimeRangeValid",(e=>{this.setState({timeRangeValid:e})})),n()(this,"showModal",((e,t)=>{const a=m()(),i=a,n=function(e){const t=e.map((e=>e.earliestStartTimestampMs||0));return m()(Math.min(...t))}(e),s=e.length>0;this.setState({jobs:e,isModalVisible:!0,startTime:undefined,endTime:i,initialSpecifiedStartTime:n,showCreateAlertFlyout:t,allowCreateAlert:s,createAlert:!1,now:a})})),n()(this,"save",(()=>{const{jobs:e}=this.state,t=m.a.isMoment(this.state.startTime)?this.state.startTime.valueOf():this.state.startTime,a=m.a.isMoment(this.state.endTime)?this.state.endTime.valueOf():this.state.endTime;Object(d.f)(e,t,a,(()=>{this.state.createAlert&&e.length>0&&this.getShowCreateAlertFlyoutFunction()(e.map((e=>e.id))),this.refreshJobs()})),this.closeModal()}));const t=m()();this.state={jobs:this.props.jobs,isModalVisible:!1,startTime:t,endTime:t,createAlert:!1,allowCreateAlert:!1,initialSpecifiedStartTime:t,now:t,timeRangeValid:!0},this.initialSpecifiedStartTime=t,this.refreshJobs=this.props.refreshJobs,this.getShowCreateAlertFlyoutFunction=this.props.getShowCreateAlertFlyoutFunction}componentDidMount(){"function"==typeof this.props.setShowFunction&&this.props.setShowFunction(this.showModal)}componentWillUnmount(){"function"==typeof this.props.unsetShowFunction&&this.props.unsetShowFunction()}render(){const{jobs:e,initialSpecifiedStartTime:t,startTime:a,endTime:i,createAlert:n,now:s,timeRangeValid:r}=this.state,c=void 0!==e?e.filter((e=>e.hasDatafeed)):[],d=!1===r||void 0!==a&&a===i;let u;return this.state.isModalVisible&&(u=Object(_.jsx)(l.EuiModal,{onClose:this.closeModal,style:{width:"850px"},maxWidth:!1,"data-test-subj":"mlStartDatafeedModal"},Object(_.jsx)(l.EuiModalHeader,null,Object(_.jsx)(l.EuiModalHeaderTitle,null,Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.startDatafeedModal.startJobsTitle",defaultMessage:"Start {jobsCount, plural, one {{jobId}} other {# jobs}}",values:{jobsCount:c.length,jobId:c[0].id}}))),Object(_.jsx)(l.EuiModalBody,null,Object(_.jsx)(time_range_selector_TimeRangeSelector,{startTime:void 0===a?t:a,endTime:i,setStartTime:this.setStartTime,setEndTime:this.setEndTime,now:s,setTimeRangeValid:this.setTimeRangeValid}),void 0===this.state.endTime&&Object(_.jsx)("div",{className:"create-watch"},Object(_.jsx)(l.EuiHorizontalRule,null),Object(_.jsx)(l.EuiCheckbox,{id:"createAlert",label:Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.startDatafeedModal.createAlertDescription",defaultMessage:"Create alert rule after datafeed has started"}),checked:n,onChange:this.setCreateAlert}))),Object(_.jsx)(l.EuiModalFooter,null,Object(_.jsx)(l.EuiButtonEmpty,{onClick:this.closeModal,"data-test-subj":"mlStartDatafeedModalCancelButton"},Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.startDatafeedModal.cancelButtonLabel",defaultMessage:"Cancel"})),Object(_.jsx)(l.EuiButton,{onClick:this.save,isDisabled:d,fill:!0,"data-test-subj":"mlStartDatafeedModalStartButton"},Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.startDatafeedModal.startButtonLabel",defaultMessage:"Start"}))))),Object(_.jsx)("div",null,u)}}class actions_menu_MultiJobActionsMenuUI extends s.Component{constructor(e){super(e),n()(this,"onButtonClick",(()=>{this.setState((e=>({isOpen:!e.isOpen})))})),n()(this,"closePopover",(()=>{this.setState({isOpen:!1})})),this.state={isOpen:!1},this.canDeleteJob=Object(h.e)("canDeleteJob"),this.canStartStopDatafeed=Object(h.e)("canStartStopDatafeed")&&Object(f.e)(),this.canCloseJob=Object(h.e)("canCloseJob")&&Object(f.e)(),this.canResetJob=Object(h.e)("canResetJob")&&Object(f.e)(),this.canCreateMlAlerts=Object(h.e)("canCreateMlAlerts")}render(){const e=this.props.jobs.some((e=>void 0!==e.blocked)),t=Object(_.jsx)(l.EuiButtonIcon,{size:"s",onClick:this.onButtonClick,iconType:"gear","aria-label":v.i18n.translate("xpack.ml.jobsList.multiJobActionsMenu.managementActionsAriaLabel",{defaultMessage:"Management actions"}),color:"text",disabled:e||!1===this.canDeleteJob&&!1===this.canStartStopDatafeed,"data-test-subj":"mlADJobListMultiSelectManagementActionsButton"}),a=[Object(_.jsx)(l.EuiContextMenuItem,{key:"delete",icon:"trash",disabled:!1===this.canDeleteJob,onClick:()=>{this.props.showDeleteJobModal(this.props.jobs),this.closePopover()},"data-test-subj":"mlADJobListMultiSelectDeleteJobActionButton"},Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.multiJobsActions.deleteJobsLabel",defaultMessage:"Delete {jobsCount, plural, one {job} other {jobs}}",values:{jobsCount:this.props.jobs.length}}))];return Object(d.g)(this.props.jobs)&&a.push(Object(_.jsx)(l.EuiContextMenuItem,{key:"close job",icon:"cross",disabled:!1===this.canCloseJob,onClick:()=>{Object(d.c)(this.props.jobs),this.closePopover()},"data-test-subj":"mlADJobListMultiSelectCloseJobActionButton"},Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.multiJobsActions.closeJobsLabel",defaultMessage:"Close {jobsCount, plural, one {job} other {jobs}}",values:{jobsCount:this.props.jobs.length}}))),Object(d.h)(this.props.jobs)&&a.push(Object(_.jsx)(l.EuiContextMenuItem,{key:"reset job",icon:"refresh",disabled:!1===this.canCloseJob,onClick:()=>{this.props.showResetJobModal(this.props.jobs),this.closePopover()},"data-test-subj":"mlADJobListMultiSelectResetJobActionButton"},Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.multiJobsActions.resetJobsLabel",defaultMessage:"Reset {jobsCount, plural, one {job} other {jobs}}",values:{jobsCount:this.props.jobs.length}}))),Object(d.j)(this.props.jobs)&&a.push(Object(_.jsx)(l.EuiContextMenuItem,{key:"stop datafeed",icon:"stop",disabled:!1===this.canStartStopDatafeed,onClick:()=>{Object(d.m)(this.props.jobs,this.props.refreshJobs),this.closePopover()},"data-test-subj":"mlADJobListMultiSelectStopDatafeedActionButton"},Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.multiJobsActions.stopDatafeedsLabel",defaultMessage:"Stop {jobsCount, plural, one {datafeed} other {datafeeds}}",values:{jobsCount:this.props.jobs.length}}))),Object(d.i)(this.props.jobs)&&a.push(Object(_.jsx)(l.EuiContextMenuItem,{key:"start datafeed",icon:"play",disabled:!1===this.canStartStopDatafeed,onClick:()=>{this.props.showStartDatafeedModal(this.props.jobs),this.closePopover()},"data-test-subj":"mlADJobListMultiSelectStartDatafeedActionButton"},Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.multiJobsActions.startDatafeedsLabel",defaultMessage:"Start {jobsCount, plural, one {datafeed} other {datafeeds}}",values:{jobsCount:this.props.jobs.length}}))),this.canCreateMlAlerts&&1===this.props.jobs.length&&a.push(Object(_.jsx)(l.EuiContextMenuItem,{key:"create alert",icon:"bell",disabled:!1,onClick:()=>{this.props.showCreateAlertFlyout(this.props.jobs.map((({id:e})=>e))),this.closePopover()},"data-test-subj":"mlADJobListMultiSelectCreateAlertActionButton"},Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.multiJobsActions.createAlertsLabel",defaultMessage:"Create alert rule"}))),Object(_.jsx)(l.EuiPopover,{button:t,isOpen:this.state.isOpen,closePopover:this.closePopover,panelPaddingSize:"none",anchorPosition:"downCenter"},Object(_.jsx)(l.EuiContextMenuPanel,{items:a.reverse()}))}}const Ve=actions_menu_MultiJobActionsMenuUI;function Ue({group:e,selectedGroups:t}){return void 0!==t[e.id]?t[e.id].partial?Object(_.jsx)("div",{className:"check selected"},Object(_.jsx)("span",null,"—")):Object(_.jsx)("div",{className:"check selected"},Object(_.jsx)(l.EuiIcon,{type:"check"})):Object(_.jsx)("div",{className:"check"})}class group_list_GroupList extends s.Component{constructor(e){super(e),n()(this,"selectGroup",(e=>{this.props.selectGroup(e)})),n()(this,"moveUp",((e,t)=>{e.preventDefault(),t<0||t>0&&this.selectItems[t-1].focus()})),n()(this,"moveDown",((e,t)=>{e.preventDefault(),t<this.selectItems.length-1&&this.selectItems[t+1].focus()})),n()(this,"handleKeyDown",((e,t,a)=>{switch(e.key){case l.keys.ENTER:case l.keys.SPACE:this.selectGroup(t);break;case l.keys.ARROW_DOWN:this.moveDown(e,a);break;case l.keys.ARROW_UP:this.moveUp(e,a)}})),n()(this,"setRef",((e,t)=>{this.selectItems[t]=e})),this.state={groups:[]},this.selectItems=[]}render(){const{selectedGroups:e,groups:t}=this.props;return Object(_.jsx)("div",{className:"group-list"},t.map(((t,a)=>Object(_.jsx)("div",{tabIndex:"0",onKeyDown:e=>this.handleKeyDown(e,t,a),key:t.id,className:"group-item",onClick:()=>this.selectGroup(t),ref:e=>this.setRef(e,a)},Object(_.jsx)(l.EuiFlexGroup,null,Object(_.jsx)(l.EuiFlexItem,{grow:!1},Object(_.jsx)(k,{name:t.id})),Object(_.jsx)(l.EuiFlexItem,{grow:!1},Object(_.jsx)(Ue,{group:t,selectedGroups:e})))))))}}class new_group_input_NewGroupInput extends s.Component{constructor(e){super(e),n()(this,"changeTempNewGroup",(e=>{const t=e.target.value;let a="";a=""===t?"":this.props.allJobIds.includes(t)?v.i18n.translate("xpack.ml.jobsList.multiJobActions.groupSelector.groupsAndJobsCanNotUseSameIdErrorMessage",{defaultMessage:"A job with this ID already exists. Groups and jobs cannot use the same ID."}):Ie([t]).message,this.setState({tempNewGroupName:t,groupsValidationError:a})})),n()(this,"newGroupKeyPress",(e=>{e.key===l.keys.ENTER&&""===this.state.groupsValidationError&&""!==this.state.tempNewGroupName&&this.addNewGroup()})),n()(this,"addNewGroup",(()=>{this.props.addNewGroup(this.state.tempNewGroupName),this.setState({tempNewGroupName:""})})),this.state={tempNewGroupName:"",groupsValidationError:""}}render(){const{tempNewGroupName:e,groupsValidationError:t}=this.state;return Object(_.jsx)("div",null,Object(_.jsx)(l.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},Object(_.jsx)(l.EuiFlexItem,null,Object(_.jsx)(l.EuiFormRow,{display:"rowCompressed",isInvalid:""!==t,error:t,className:"new-group-input"},Object(_.jsx)(l.EuiFieldText,{compressed:!0,placeholder:v.i18n.translate("xpack.ml.jobsList.multiJobActions.groupSelector.addNewGroupPlaceholder",{defaultMessage:"Add new group"}),value:e,onChange:this.changeTempNewGroup,onKeyDown:this.newGroupKeyPress,isInvalid:""!==t,error:t}))),Object(_.jsx)(l.EuiFlexItem,{grow:!1},Object(_.jsx)(l.EuiFormRow,{className:"new-group-input"},Object(_.jsx)(l.EuiButtonIcon,{onClick:this.addNewGroup,iconType:"plusInCircle","aria-label":v.i18n.translate("xpack.ml.jobsList.multiJobActions.groupSelector.addButtonAriaLabel",{defaultMessage:"Add"}),disabled:""===e||""!==t})))))}}function Ge(e,t){const a=e.map((e=>e.id)),i={};e.forEach((e=>{e.groups.forEach((e=>{void 0===i[e]&&(i[e]=0),i[e]++}))}));return t.reduce(((e,t)=>(t.jobIds.some((e=>a.includes(e)))&&(e[t.id]={partial:i[t.id]!==a.length}),e)),{})}class group_selector_GroupSelector extends s.Component{constructor(e){super(e),n()(this,"togglePopover",(()=>{this.state.isPopoverOpen?this.closePopover():c.ml.jobs.groups().then((e=>{const t=Ge(this.props.jobs,e);this.setState({isPopoverOpen:!0,edited:!1,selectedGroups:t,groups:e})})).catch((e=>{console.error(e)}))})),n()(this,"closePopover",(()=>{this.setState({edited:!1,isPopoverOpen:!1})})),n()(this,"selectGroup",(e=>{const t=Object(u.cloneDeep)(this.state.selectedGroups);void 0===t[e.id]?t[e.id]={partial:!1}:!0===t[e.id].partial?t[e.id].partial=!1:delete t[e.id],this.setState({selectedGroups:t,edited:!0})})),n()(this,"applyChanges",(()=>{const{selectedGroups:e}=this.state,{jobs:t}=this.props,a=t.map((e=>({id:e.id,oldGroups:e.groups,newGroups:[]})));for(const t in e)if(e.hasOwnProperty(t)){const i=e[t];a.forEach((e=>{(!1===i.partial||!0===i.partial&&e.oldGroups.includes(t))&&e.newGroups.push(t)}))}const i=a.map((e=>({jobId:e.id,groups:e.newGroups})));c.ml.jobs.updateGroups(i).then((e=>{let t=!0;for(const a in e)e.hasOwnProperty(a)&&!1===e[a].success&&(Object(oe.a)().displayErrorToast(e[a].error),t=!1);t?(this.refreshJobs(),this.closePopover()):console.error(e)})).catch((e=>{Object(oe.a)().displayErrorToast(e),console.error(e)}))})),n()(this,"addNewGroup",(e=>{const t={id:e,calendarIds:[],jobIds:[]},a=this.state.groups;!1===a.some((e=>e.id===t.id))&&a.push(t),this.setState({groups:a})})),this.state={isPopoverOpen:!1,groups:[],selectedGroups:{},edited:!1},this.refreshJobs=this.props.refreshJobs,this.canUpdateJob=Object(h.e)("canUpdateJob")}static getDerivedStateFromProps(e,t){if(!1===t.edited){return{selectedGroups:Ge(e.jobs,t.groups)}}return{}}render(){const{groups:e,selectedGroups:t,edited:a}=this.state,i=Object(_.jsx)(l.EuiToolTip,{position:"bottom",content:Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.multiJobActions.groupSelector.editJobGroupsButtonTooltip",defaultMessage:"Edit job groups"})},Object(_.jsx)(l.EuiButtonIcon,{iconType:"indexEdit","aria-label":v.i18n.translate("xpack.ml.jobsList.multiJobActions.groupSelector.editJobGroupsButtonAriaLabel",{defaultMessage:"Edit job groups"}),onClick:()=>this.togglePopover(),disabled:!1===this.canUpdateJob,"data-test-subj":"mlADJobListMultiSelectEditJobGroupsButton"}));return Object(_.jsx)(l.EuiPopover,{id:"trapFocus",ownFocus:!0,button:i,isOpen:this.state.isPopoverOpen,closePopover:()=>this.closePopover()},Object(_.jsx)("div",{className:"group-selector"},Object(_.jsx)(l.EuiPopoverTitle,null,Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.multiJobActions.groupSelector.applyGroupsToJobTitle",defaultMessage:"Apply groups to {jobsCount, plural, one {job} other {jobs}}",values:{jobsCount:this.props.jobs.length}})),Object(_.jsx)(group_list_GroupList,{groups:e,selectedGroups:t,selectGroup:this.selectGroup}),Object(_.jsx)(l.EuiHorizontalRule,{margin:"xs"}),Object(_.jsx)(l.EuiSpacer,{size:"s"}),Object(_.jsx)(new_group_input_NewGroupInput,{addNewGroup:this.addNewGroup,allJobIds:this.props.allJobIds}),Object(_.jsx)(l.EuiHorizontalRule,{margin:"m"}),Object(_.jsx)("div",null,Object(_.jsx)(l.EuiFlexGroup,null,Object(_.jsx)(l.EuiFlexItem,{grow:!1},Object(_.jsx)(l.EuiButton,{size:"s",onClick:this.applyChanges,isDisabled:!1===a},Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.multiJobActions.groupSelector.applyButtonLabel",defaultMessage:"Apply"})))))))}}class multi_job_actions_MultiJobActions extends s.Component{constructor(e){super(e),this.state={}}render(){const e=this.props.selectedJobs.length>0;return Object(_.jsx)("div",{className:"multi-select-actions"+(e?"":"-no-display"),"data-test-subj":"mlADJobListMultiSelectActionsArea "+(e?"active":"inactive")},e&&Object(_.jsx)(l.EuiFlexGroup,{gutterSize:"xs",alignItems:"center",wrap:!1,direction:"row",responsive:!1},Object(_.jsx)(l.EuiFlexItem,{grow:!1},Object(_.jsx)(l.EuiTitle,{size:"s"},Object(_.jsx)("h3",null,Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.multiJobsActions.jobsSelectedLabel",defaultMessage:"{selectedJobsCount, plural, one {# job} other {# jobs}}   selected",values:{selectedJobsCount:this.props.selectedJobs.length}})))),Object(_.jsx)(l.EuiFlexItem,{grow:!1},Object(_.jsx)("div",{className:"actions-border-large"})),Object(_.jsx)(l.EuiFlexItem,{grow:!1},Object(_.jsx)(S,{jobs:this.props.selectedJobs})),Object(_.jsx)(l.EuiFlexItem,{grow:!1},Object(_.jsx)(group_selector_GroupSelector,{jobs:this.props.selectedJobs,allJobIds:this.props.allJobIds,refreshJobs:this.props.refreshJobs})),Object(_.jsx)(l.EuiFlexItem,{grow:!1},Object(_.jsx)(Ve,{jobs:this.props.selectedJobs,showStartDatafeedModal:this.props.showStartDatafeedModal,showDeleteJobModal:this.props.showDeleteJobModal,showResetJobModal:this.props.showResetJobModal,refreshJobs:this.props.refreshJobs,showCreateAlertFlyout:this.props.showCreateAlertFlyout}))))}}var qe=a(101);function He(){const e=Object(h.e)("canCreateJob")&&Object(f.e)(),t=Object(qe.a)(T.b.ANOMALY_DETECTION_CREATE_JOB_SELECT_INDEX);return Object(_.jsx)(l.EuiButton,{"data-test-subj":"mlCreateNewJobButton",onClick:t,size:"s",disabled:!1===e,fill:!0,iconType:"plusInCircle"},Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.createNewJobButtonLabel",defaultMessage:"Create job"}))}var We=a(164);const $e=({jobsSummaryList:e})=>{const t=function(e){const t={activeNodes:{label:v.i18n.translate("xpack.ml.jobsList.statsBar.activeMLNodesLabel",{defaultMessage:"Active ML nodes"}),value:0,show:!0},total:{label:v.i18n.translate("xpack.ml.jobsList.statsBar.totalJobsLabel",{defaultMessage:"Total jobs"}),value:0,show:!0},open:{label:v.i18n.translate("xpack.ml.jobsList.statsBar.openJobsLabel",{defaultMessage:"Open jobs"}),value:0,show:!0},closed:{label:v.i18n.translate("xpack.ml.jobsList.statsBar.closedJobsLabel",{defaultMessage:"Closed jobs"}),value:0,show:!0},failed:{label:v.i18n.translate("xpack.ml.jobsList.statsBar.failedJobsLabel",{defaultMessage:"Failed jobs"}),value:0,show:!1},activeDatafeeds:{label:v.i18n.translate("xpack.ml.jobsList.statsBar.activeDatafeedsLabel",{defaultMessage:"Active datafeeds"}),value:0,show:!0}};if(void 0===e)return t;const a={};let i=0;return e.forEach((e=>{e.jobState===de.c.OPENED?t.open.value++:e.jobState===de.c.CLOSED?t.closed.value++:e.jobState===de.c.FAILED&&i++,e.hasDatafeed&&e.datafeedState===de.a.STARTED&&t.activeDatafeeds.value++,void 0!==e.nodeName&&(a[e.nodeName]={})})),t.total.value=e.length,i?(t.failed.value=i,t.failed.show=!0):t.failed.show=!1,t.activeNodes.value=Object.keys(a).length,t}(e);return Object(_.jsx)(We.a,{stats:t,dataTestSub:"mlJobStatsBar"})};var Ye=a(257),Xe=a(151),Qe=a(258),Ke=a(190),Ze=a(259);const et=({onRefreshClick:e,isRefreshing:t})=>Object(_.jsx)(l.EuiButtonEmpty,{"data-test-subj":"mlRefreshJobListButton"+(t?" loading":" loaded"),onClick:e,isLoading:t},Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.refreshButtonLabel",defaultMessage:"Refresh"}));let tt=null;class jobs_list_view_JobsListView extends s.Component{constructor(e){super(e),n()(this,"toggleRow",(e=>{if(this.state.itemIdToExpandedRowMap[e]){const t={...this.state.itemIdToExpandedRowMap};delete t[e],this.setState({itemIdToExpandedRowMap:t})}else{const t=this.state.jobsSummaryList.filter((t=>t.id===e)),a=t.length>0&&void 0!==t[0].auditMessage;let i={...this.state.itemIdToExpandedRowMap};void 0!==this.state.fullJobsList[e]?i[e]=Object(_.jsx)(Ee,{jobId:e,job:this.state.fullJobsList[e],addYourself:this.addUpdateFunction,removeYourself:this.removeUpdateFunction,showFullDetails:!0!==this.props.isManagementTable,refreshJobList:this.onRefreshClick,showClearButton:a}):i[e]=Object(_.jsx)(Ee,{jobId:e,addYourself:this.addUpdateFunction,removeYourself:this.removeUpdateFunction,showFullDetails:!0!==this.props.isManagementTable,refreshJobList:this.onRefreshClick,showClearButton:a}),this.setState({itemIdToExpandedRowMap:i},(()=>{Object(d.k)(e).then((t=>{const n={...this.state.fullJobsList};n[e]=t,this.setState({fullJobsList:n},(()=>{i={...this.state.itemIdToExpandedRowMap},void 0!==i[e]&&(i[e]=Object(_.jsx)(Ee,{jobId:e,job:t,addYourself:this.addUpdateFunction,removeYourself:this.removeUpdateFunction,showFullDetails:!0!==this.props.isManagementTable,refreshJobList:this.onRefreshClick,showClearButton:a})),this.setState({itemIdToExpandedRowMap:i},(()=>{this.updateFunctions[e](t)}))}))})).catch((e=>{console.error(e)}))}))}})),n()(this,"addUpdateFunction",((e,t)=>{this.updateFunctions[e]=t})),n()(this,"removeUpdateFunction",(e=>{delete this.updateFunctions[e]})),n()(this,"setShowEditJobFlyoutFunction",(e=>{this.showEditJobFlyout=e})),n()(this,"unsetShowEditJobFlyoutFunction",(()=>{this.showEditJobFlyout=()=>{}})),n()(this,"setShowDeleteJobModalFunction",(e=>{this.showDeleteJobModal=e})),n()(this,"unsetShowDeleteJobModalFunction",(()=>{this.showDeleteJobModal=()=>{}})),n()(this,"setShowResetJobModalFunction",(e=>{this.showResetJobModal=e})),n()(this,"unsetShowResetJobModalFunction",(()=>{this.showResetJobModal=()=>{}})),n()(this,"setShowStartDatafeedModalFunction",(e=>{this.showStartDatafeedModal=e})),n()(this,"unsetShowStartDatafeedModalFunction",(()=>{this.showStartDatafeedModal=()=>{}})),n()(this,"setShowCreateAlertFlyoutFunction",(e=>{this.showCreateAlertFlyout=e})),n()(this,"unsetShowCreateAlertFlyoutFunction",(()=>{this.showCreateAlertFlyout=()=>{}})),n()(this,"getShowCreateAlertFlyoutFunction",(()=>this.showCreateAlertFlyout)),n()(this,"selectJobChange",(e=>{this.setState({selectedJobs:e})})),n()(this,"setFilters",(async e=>{if(null===e)return void this.setState({filteredJobsSummaryList:this.state.jobsSummaryList,filterClauses:[]},(()=>{this.refreshSelectedJobs()}));this.props.onJobsViewStateUpdate({queryText:null==e?void 0:e.text},!1===this._isFiltersSet);const t=e&&e.ast&&e.ast.clauses||[];if(0===t.length)return void this.setState({filteredJobsSummaryList:this.state.jobsSummaryList,filterClauses:t},(()=>{this.refreshSelectedJobs()}));const a=Object(d.e)(this.state.jobsSummaryList,t);this.setState({filteredJobsSummaryList:a,filterClauses:t},(()=>{this.refreshSelectedJobs()})),this._isFiltersSet=!0})),n()(this,"onRefreshClick",(()=>{this.setState({isRefreshing:!0}),this.refreshJobSummaryList(!0)})),n()(this,"isDoneRefreshing",(()=>{this.setState({isRefreshing:!1})})),this.state={isRefreshing:!1,loading:null,jobsSummaryList:[],filteredJobsSummaryList:[],fullJobsList:{},selectedJobs:[],itemIdToExpandedRowMap:{},filterClauses:[],blockingJobIds:[],jobsAwaitingNodeCount:0},this.updateFunctions={},this.showEditJobFlyout=()=>{},this.showDeleteJobModal=()=>{},this.showResetJobModal=()=>{},this.showStartDatafeedModal=()=>{},this.showCreateAlertFlyout=()=>{},this._isMounted=!1,this._isFiltersSet=!1}componentDidMount(){this._isMounted=!0,this.refreshJobSummaryList(!0),!0!==this.props.isManagementTable&&this.openAutoStartDatafeedModal()}componentDidUpdate(e){e.lastRefresh!==this.props.lastRefresh&&(this.setState({isRefreshing:!0}),this.refreshJobSummaryList())}componentWillUnmount(){void 0===this.props.isManagementTable&&(tt=null),this._isMounted=!1}openAutoStartDatafeedModal(){const e=Object(d.a)();void 0!==e&&this.showStartDatafeedModal([e])}refreshSelectedJobs(){var e;const t=this.state.selectedJobs.map((e=>e.id)),a=(null!==(e=this.state.filteredJobsSummaryList)&&void 0!==e?e:[]).map((e=>e.id)),i=this.state.jobsSummaryList.filter((e=>t.find((t=>t===e.id)))).filter((e=>a.find((t=>t===e.id))));this.setState({selectedJobs:i})}async refreshJobSummaryList(e=!1){if(this._isMounted&&(!0===e||!0!==this.props.blockRefresh)){null===this.state.loading&&this.setState({loading:!0});const t=Object.keys(this.state.itemIdToExpandedRowMap);try{let a={};if(this.props.spacesApi&&this.props.isManagementTable){const e=await c.ml.savedObjects.jobsSpaces();a=e["anomaly-detector"]}let i=0;const n=await c.ml.jobs.jobsSummary(t),s={},r=n.map((e=>(void 0!==e.fullJob&&(s[e.id]=e.fullJob,delete e.fullJob),e.latestTimestampSortValue=e.latestTimestampMs||0,e.spaceIds=this.props.spacesApi&&this.props.isManagementTable&&a&&void 0!==a[e.id]?a[e.id]:[],!0===e.awaitingNodeAssignment&&i++,e))),o=Object(d.e)(r,this.state.filterClauses);this.setState({jobsSummaryList:r,filteredJobsSummaryList:o,fullJobsList:s,loading:!1,jobsAwaitingNodeCount:i},(()=>{this.refreshSelectedJobs()})),Object.keys(this.updateFunctions).forEach((e=>{this.updateFunctions[e](s[e])})),n.forEach((e=>{void 0!==e.blocked&&this.state.itemIdToExpandedRowMap[e.id]&&this.toggleRow(e.id)})),this.isDoneRefreshing(),r.some((e=>void 0!==e.blocked))&&this.checkBlockingJobTasks(e)}catch(e){console.error(e),this.setState({loading:!1})}}}async checkBlockingJobTasks(e=!1){if(!1===this._isMounted)return;const{jobs:t}=await c.ml.jobs.blockingJobTasks(),a=t.map((e=>Object.keys(e)[0])).sort(),i=a.join()!==this.state.blockingJobIds.join();this.setState({blockingJobIds:a}),(i||e)&&this.refreshJobSummaryList(),a.length>0&&null===tt&&(tt=setTimeout((()=>{tt=null,this.checkBlockingJobTasks()}),Le.b))}renderManagementJobsListComponents(){const{isRefreshing:e,loading:t,itemIdToExpandedRowMap:a,jobsSummaryList:i,filteredJobsSummaryList:n,fullJobsList:s,selectedJobs:r}=this.state;return Object(_.jsx)("div",{className:"job-management","data-test-subj":"ml-jobs-list"},Object(_.jsx)(Ye.a,null),Object(_.jsx)(Ze.a,null),Object(_.jsx)(l.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(_.jsx)(l.EuiFlexItem,{grow:!1},Object(_.jsx)($e,{jobsSummaryList:i})),Object(_.jsx)(l.EuiFlexItem,{grow:!1},Object(_.jsx)(l.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},Object(_.jsx)(l.EuiFlexItem,{grow:!1},Object(_.jsx)(et,{onRefreshClick:this.onRefreshClick,isRefreshing:e}))))),Object(_.jsx)(l.EuiSpacer,{size:"s"}),Object(_.jsx)("div",{className:"managementJobsList"},Object(_.jsx)("div",null,Object(_.jsx)(we,{setFilters:this.setFilters,queryText:this.props.jobsViewState.queryText})),Object(_.jsx)(jobs_list_JobsList,{jobsSummaryList:n,fullJobsList:s,itemIdToExpandedRowMap:a,toggleRow:this.toggleRow,selectJobChange:this.selectJobChange,selectedJobsCount:r.length,loading:t,isManagementTable:!0,isMlEnabledInSpace:this.props.isMlEnabledInSpace,spacesApi:this.props.spacesApi,jobsViewState:this.props.jobsViewState,onJobsViewStateUpdate:this.props.onJobsViewStateUpdate,refreshJobs:()=>this.refreshJobSummaryList(!0)})))}renderJobsListComponents(){const{isRefreshing:e,loading:t,jobsSummaryList:a,jobsAwaitingNodeCount:i}=this.state,n=a.map((e=>e.id));return Object(_.jsx)(l.EuiPage,{"data-test-subj":"ml-jobs-list"},Object(_.jsx)(l.EuiPageBody,null,Object(_.jsx)(l.EuiPageHeader,null,Object(_.jsx)(l.EuiPageHeaderSection,null,Object(_.jsx)(l.EuiTitle,null,Object(_.jsx)("h1",null,Object(_.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.title",defaultMessage:"Anomaly detection jobs"})))),Object(_.jsx)(l.EuiPageHeaderSection,null,Object(_.jsx)(l.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},Object(_.jsx)(l.EuiFlexItem,{grow:!1},Object(_.jsx)(et,{onRefreshClick:this.onRefreshClick,isRefreshing:e})),Object(_.jsx)(l.EuiFlexItem,{grow:!1},Object(_.jsx)(Ke.a,null))))),Object(_.jsx)(Ye.a,null),Object(_.jsx)(Xe.a,{jobCount:i}),Object(_.jsx)(Qe.a,{jobType:"anomaly-detector",onCloseFlyout:this.onRefreshClick,forceRefresh:t||e}),Object(_.jsx)(Ze.a,null),Object(_.jsx)(l.EuiPageContent,null,Object(_.jsx)(l.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(_.jsx)(l.EuiFlexItem,{grow:!1},Object(_.jsx)($e,{jobsSummaryList:a})),Object(_.jsx)(l.EuiFlexItem,{grow:!1},Object(_.jsx)(He,null))),Object(_.jsx)(l.EuiSpacer,{size:"s"}),Object(_.jsx)("div",null,Object(_.jsx)("div",{className:"actions-bar"},Object(_.jsx)(multi_job_actions_MultiJobActions,{selectedJobs:this.state.selectedJobs,allJobIds:n,showStartDatafeedModal:this.showStartDatafeedModal,showDeleteJobModal:this.showDeleteJobModal,showResetJobModal:this.showResetJobModal,showCreateAlertFlyout:this.showCreateAlertFlyout,refreshJobs:()=>this.refreshJobSummaryList(!0)}),Object(_.jsx)(we,{setFilters:this.setFilters,queryText:this.props.jobsViewState.queryText})),Object(_.jsx)(jobs_list_JobsList,{jobsSummaryList:this.state.filteredJobsSummaryList,fullJobsList:this.state.fullJobsList,itemIdToExpandedRowMap:this.state.itemIdToExpandedRowMap,toggleRow:this.toggleRow,selectJobChange:this.selectJobChange,showEditJobFlyout:this.showEditJobFlyout,showDeleteJobModal:this.showDeleteJobModal,showResetJobModal:this.showResetJobModal,showStartDatafeedModal:this.showStartDatafeedModal,refreshJobs:()=>this.refreshJobSummaryList(!0),jobsViewState:this.props.jobsViewState,onJobsViewStateUpdate:this.props.onJobsViewStateUpdate,selectedJobsCount:this.state.selectedJobs.length,showCreateAlertFlyout:this.showCreateAlertFlyout,loading:t}),Object(_.jsx)(Ae,{setShowFunction:this.setShowEditJobFlyoutFunction,unsetShowFunction:this.unsetShowEditJobFlyoutFunction,refreshJobs:()=>this.refreshJobSummaryList(!0),allJobIds:n}),Object(_.jsx)(Pe,{setShowFunction:this.setShowDeleteJobModalFunction,unsetShowFunction:this.unsetShowDeleteJobModalFunction,refreshJobs:()=>this.refreshJobSummaryList(!0)}),Object(_.jsx)(ze,{setShowFunction:this.setShowResetJobModalFunction,unsetShowFunction:this.unsetShowResetJobModalFunction,refreshJobs:()=>this.refreshJobSummaryList(!0)}),Object(_.jsx)(start_datafeed_modal_StartDatafeedModal,{setShowFunction:this.setShowStartDatafeedModalFunction,unsetShowFunction:this.unsetShowDeleteJobModalFunction,getShowCreateAlertFlyoutFunction:this.getShowCreateAlertFlyoutFunction,refreshJobs:()=>this.refreshJobSummaryList(!0)}),Object(_.jsx)(G.b,{setShowFunction:this.setShowCreateAlertFlyoutFunction,unsetShowFunction:this.unsetShowCreateAlertFlyoutFunction,onSave:this.onRefreshClick})))))}render(){const{isManagementTable:e}=this.props;return Object(_.jsx)("div",null,e?this.renderManagementJobsListComponents():this.renderJobsListComponents())}}},,function(e,t,a){"use strict";a.d(t,"a",(function(){return w}));var i=a(15),n=a(2),s=a(40),r=a(82),o=a(75),l=a(72),c=a(94),d=a(163),u=a(248),p=a(350),m=a(164),b=a(11);const h=({isDisabled:e,setIsSourceIndexModalVisible:t})=>{const a=Object(b.jsx)(s.EuiButton,{disabled:e,fill:!0,onClick:()=>{t(!0)},iconType:"plusInCircle",size:"s","data-test-subj":"mlAnalyticsButtonCreate"},n.i18n.translate("xpack.ml.dataframe.analyticsList.createDataFrameAnalyticsButton",{defaultMessage:"Create job"}));return e?Object(b.jsx)(s.EuiToolTip,{position:"top",content:Object(l.f)("canCreateDataFrameAnalytics")},a):a};var f=a(356),g=a(88);const j=({disabled:e,isManagementTable:t,onCreateFirstJobClick:a})=>Object(b.jsx)(s.EuiEmptyPrompt,{iconType:"createAdvancedJob",title:Object(b.jsx)("h2",null,n.i18n.translate("xpack.ml.dataFrame.analyticsList.emptyPromptTitle",{defaultMessage:"Create your first data frame analytics job"})),actions:t?[]:[Object(b.jsx)(s.EuiButton,{onClick:a,isDisabled:e,color:"primary",iconType:"plusInCircle",fill:!0,"data-test-subj":"mlAnalyticsCreateFirstButton"},n.i18n.translate("xpack.ml.dataFrame.analyticsList.emptyPromptButtonText",{defaultMessage:"Create job"}))],"data-test-subj":"mlNoDataFrameAnalyticsFound"});var x=a(287),v=a(355),y=a(151),O=a(213);const E=[{type:"field_value_selection",field:"job_type",name:n.i18n.translate("xpack.ml.dataframe.analyticsList.typeFilter",{defaultMessage:"Type"}),multiSelect:"or",options:Object.values(r.a).map((e=>({value:e,name:e,view:Object(u.a)(e)})))},{type:"field_value_selection",field:"state",name:n.i18n.translate("xpack.ml.dataframe.analyticsList.statusFilter",{defaultMessage:"Status"}),multiSelect:"or",options:Object.values(c.b).map((e=>({value:e,name:e,view:Object(u.b)(e)})))}];const w=({isManagementTable:e=!1,isMlEnabledInSpace:t=!0,spacesApi:a,blockRefresh:r=!1,pageState:w,updatePageState:_})=>{var S;const M=null!==(S=w.queryText)&&void 0!==S?S:"",k=Object(i.useCallback)((e=>{_({queryText:e})}),[_]),[C,T]=Object(i.useState)(!1),[F,I]=Object(i.useState)(!1),[D,A]=Object(i.useState)(!1),[L,R]=Object(i.useState)([]),[P,N]=Object(i.useState)(),[z,B]=Object(i.useState)([]),[J,V]=Object(i.useState)(void 0),[U,G]=Object(i.useState)([]),[q,H]=Object(i.useState)(void 0),[W,$]=Object(i.useState)(0),Y=Object(O.a)(),X=!Object(l.e)("canCreateDataFrameAnalytics")||!Object(l.e)("canStartStopDataFrameAnalytics"),Q=Object(d.d)(B,V,H,T,$,r,e),K=Object(i.useCallback)((e=>{if(e.length){const t=function(e,t){if(0===t.length)return e;const a=e.reduce(((e,t)=>(e[t.id]={job:t,count:0},e)),{});return t.forEach((t=>{const i="must"===t.match;let n=[];n="term"===t.type?!0===i?e.filter((e=>{var a,n;return Object(g.f)(e.id,t.value)===i||Object(g.f)(e.config.description,t.value)===i||Object(g.f)(null===(a=e.stats)||void 0===a||null===(n=a.memory_usage)||void 0===n?void 0:n.status,t.value)===i})):e.filter((e=>{var a,n;return Object(g.f)(e.id,t.value)===i&&Object(g.f)(e.config.description,t.value)===i&&Object(g.f)(null===(a=e.stats)||void 0===a||null===(n=a.memory_usage)||void 0===n?void 0:n.status,t.value)===i})):Array.isArray(t.value)?e.filter((e=>t.value.includes(e[t.field]))):e.filter((e=>e[t.field]===t.value)),n.forEach((e=>a[e.id].count++))})),Object.values(a).filter((e=>(e&&e.count)>=t.length)).map((e=>e.job))}(z,e);R(t)}else R(z)}),[z]);Object(i.useEffect)((()=>{(()=>{if(""!==M){const e=s.EuiSearchBar.Query.parse(M);let t=[];e&&void 0!==e.ast&&void 0!==e.ast.clauses&&(t=e.ast.clauses),K(t)}else K([])})()}),[M]);const Z=Object(i.useCallback)((()=>Q(!0)),[]),{refresh:ee}=Object(o.w)({isLoading:A,onRefresh:Z},e);Object(i.useEffect)((function(){Z()}),[Y]);const{columns:te,modals:ae}=Object(u.d)(U,G,e,t,a,ee),{onTableChange:ie,pagination:ne,sorting:se}=Object(x.a)(L,w,_);if(!C)return null;if(void 0!==q)return Object(b.jsx)(s.EuiCallOut,{title:n.i18n.translate("xpack.ml.dataFrame.analyticsList.errorPromptTitle",{defaultMessage:"An error occurred getting the data frame analytics list."}),color:"danger",iconType:"alert"},Object(b.jsx)("pre",null,JSON.stringify(q)));if(0===z.length)return Object(b.jsx)("div",{"data-test-subj":"mlAnalyticsJobList"},Object(b.jsx)(j,{isManagementTable:e,disabled:X,onCreateFirstJobClick:()=>I(!0)}),!0===F&&Object(b.jsx)(f.a,{onClose:()=>I(!1)}));const re=(oe=z,U.reduce(((e,t)=>{const a=oe.find((e=>e.config.id===t));return void 0!==a&&(e[t]=Object(b.jsx)(p.a,{item:a})),e}),{}));var oe;const le=J&&Object(b.jsx)(s.EuiFlexItem,{grow:!1},Object(b.jsx)(m.a,{stats:J,dataTestSub:"mlAnalyticsStatsBar"})),ce=Object(b.jsx)(s.EuiFlexItem,null,Object(b.jsx)(s.EuiFlexGroup,{justifyContent:"spaceBetween"},le,Object(b.jsx)(s.EuiFlexItem,{grow:!1},Object(b.jsx)(v.a,null)))),de={query:M,onChange:e=>{null===e.error?(N(void 0),k(e.queryText)):N(e.error.message)},box:{incremental:!0},filters:E};return Object(b.jsx)("div",{"data-test-subj":"mlAnalyticsJobList"},ae,!e&&Object(b.jsx)(s.EuiSpacer,{size:"m"}),Object(b.jsx)(y.a,{jobCount:W}),Object(b.jsx)(s.EuiFlexGroup,{justifyContent:"spaceBetween"},!e&&le,e&&ce,Object(b.jsx)(s.EuiFlexItem,{grow:!1},Object(b.jsx)(s.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},!e&&Object(b.jsx)(s.EuiFlexItem,{grow:!1},Object(b.jsx)(h,{isDisabled:X,setIsSourceIndexModalVisible:I}))))),Object(b.jsx)(s.EuiSpacer,{size:"m"}),Object(b.jsx)("div",{"data-test-subj":"mlAnalyticsTableContainer"},Object(b.jsx)(s.EuiInMemoryTable,{allowNeutralSort:!1,columns:te,hasActions:!1,isExpandable:!0,itemIdToExpandedRowMap:re,isSelectable:!1,items:z,itemId:c.c.id,loading:D,onTableChange:ie,pagination:ne,sorting:se,search:de,"data-test-subj":D?"mlAnalyticsTable loading":"mlAnalyticsTable loaded",rowProps:e=>({"data-test-subj":`mlAnalyticsTableRow row-${e.id}`}),error:P})),!0===F&&Object(b.jsx)(f.a,{onClose:()=>I(!1)}))}},function(e,t,a){"use strict";a.d(t,"a",(function(){return S}));var i=a(15),n=a.n(i),s=a(48),r=a.n(s),o=a(40),l=a(2),c=a(76),d=(a(445),a(11));const u=({section:e})=>{if(0===e.items.length)return null;const t=[{field:"title",name:"",render:e=>Object(d.jsx)("strong",null,e)},{field:"description",name:"",render:e=>Object(d.jsx)(n.a.Fragment,null,e)}];return Object(d.jsx)("div",{"data-test-subj":e.dataTestSubj},Object(d.jsx)(o.EuiTitle,{size:"xs"},Object(d.jsx)("span",null,e.title)),Object(d.jsx)(o.EuiBasicTable,{compressed:!0,items:e.items,columns:t,tableCaption:e.title,tableLayout:"auto",className:"mlExpandedRowDetailsSection","data-test-subj":`${e.dataTestSubj}-table`}))},p=({sections:e,dataTestSubj:t})=>Object(d.jsx)(o.EuiFlexGroup,{className:"mlExpandedRowDetails","data-test-subj":t},Object(d.jsx)(o.EuiFlexItem,{style:{width:"50%"}},e.filter((e=>"left"===e.position)).map((e=>Object(d.jsx)(i.Fragment,{key:e.title},Object(d.jsx)(o.EuiSpacer,{size:"s"}),Object(d.jsx)(u,{section:e}))))),Object(d.jsx)(o.EuiFlexItem,{style:{width:"50%"}},e.filter((e=>"right"===e.position)).map((e=>Object(d.jsx)(i.Fragment,{key:e.title},Object(d.jsx)(o.EuiSpacer,{size:"s"}),Object(d.jsx)(u,{section:e})))))),m=({json:e,dataTestSubj:t})=>Object(d.jsx)(o.EuiFlexGroup,{"data-test-subj":t},Object(d.jsx)(o.EuiFlexItem,null,Object(d.jsx)(o.EuiSpacer,{size:"s"}),Object(d.jsx)(o.EuiCodeBlock,{"aria-label":l.i18n.translate("xpack.ml.dataframe.analyticsList.analyticsDetails.expandedRowJsonPane",{defaultMessage:"JSON of data frame analytics configuration"}),style:{width:"100%"},language:"json",fontSize:"s",paddingSize:"s",overflowHeight:300,isCopyable:!0,"data-test-subj":"mlAnalyticsDetailsJsonPreview"},JSON.stringify(e,null,2))),Object(d.jsx)(o.EuiFlexItem,{grow:!1}," ")),b=({progress:e})=>Object(d.jsx)(o.EuiFlexGroup,{alignItems:"center",gutterSize:"xs"},Object(d.jsx)(o.EuiFlexItem,{style:{width:"100px"},grow:!1},Object(d.jsx)(o.EuiProgress,{value:e,max:100,color:"primary",size:"m"},e,"%")),Object(d.jsx)(o.EuiFlexItem,{style:{width:"35px"},grow:!1},Object(d.jsx)(o.EuiText,{size:"xs"},`${e}%`)));var h=a(75),f=a(248),g=a(94),j=a(70),x=(a(454),a(67)),v=a(361),y=a(73);const O=({analyticsId:e,dataTestSubj:t})=>{const[a,n]=Object(i.useState)([]),[s,r]=Object(i.useState)(!1),[o,c]=Object(i.useState)(""),u=Object(y.c)(),p=Object(i.useCallback)((async()=>{try{r(!0);const t=await x.ml.dataFrameAnalytics.getAnalyticsAuditMessages(e);r(!1),n(t)}catch(e){r(!1),u.displayErrorToast(e,l.i18n.translate("xpack.ml.dfAnalyticsList.analyticsDetails.messagesPane.errorToastMessageTitle",{defaultMessage:"Error loading job messages"})),c(l.i18n.translate("xpack.ml.dfAnalyticsList.analyticsDetails.messagesPane.errorMessage",{defaultMessage:"Messages could not be loaded"}))}}),[]);return Object(i.useEffect)((()=>{p()}),[]),Object(h.w)({onRefresh:p}),Object(d.jsx)("div",{className:"mlExpandedRowJobMessages","data-test-subj":t},Object(d.jsx)(v.a,{messages:a,loading:s,error:o,refreshMessage:p}))};function E(e){return"object"==typeof e?JSON.stringify(e):e.toString()}const w=({isLoading:e,evalData:t,resultProperty:a})=>Object(d.jsx)(i.Fragment,null,!1===e&&null!==t.error&&Object(d.jsx)(o.EuiIcon,{type:"alert",size:"s"}),!0===e&&Object(d.jsx)(o.EuiLoadingSpinner,{size:"s"}),!1===e&&null===t.error&&t[a]),_={mse:"",msle:"",huber:"",rSquared:"",error:null},S=({item:e})=>{var t,a,n;const[s,u]=Object(i.useState)(_),[x,v]=Object(i.useState)(_),[y,S]=Object(i.useState)(!1),[M,k]=Object(i.useState)(!1),C=null==e||null===(t=e.config)||void 0===t||null===(a=t.dest)||void 0===a?void 0:a.index,T=Object(h.k)(e.config.analysis),F=Object(h.o)(e.config.analysis),I=e.config.dest.results_field,D=Object(g.e)(e.stats),A=Object(j.y)(e.config.analysis),L=Object(j.m)(e.config.analysis);Object(i.useEffect)((()=>{D&&A&&(async()=>{k(!0),S(!0);const e=await Object(h.t)({isTraining:!1,index:C,dependentVariable:T,resultsField:I,predictionFieldName:F,jobType:j.b.REGRESSION});if(!0===e.success&&e.eval&&Object(j.z)(e.eval)){const{mse:t,msle:a,huber:i,r_squared:n}=Object(h.q)(e.eval);v({mse:t,msle:a,huber:i,rSquared:n,error:null}),k(!1)}else k(!1),v({mse:"",msle:"",huber:"",rSquared:"",error:e.error});const t=await Object(h.t)({isTraining:!0,index:C,dependentVariable:T,resultsField:I,predictionFieldName:F,jobType:j.b.REGRESSION});if(!0===t.success&&t.eval&&Object(j.z)(t.eval)){const{mse:e,msle:a,huber:i,r_squared:n}=Object(h.q)(t.eval);u({mse:e,msle:a,huber:i,rSquared:n,error:null}),S(!1)}else S(!1),u({mse:"",msle:"",huber:"",rSquared:"",error:e.error})})()}),[D]);const R={...e.stats},P=R.analysis_stats?R.analysis_stats[`${L}_stats`]:void 0;null!==(n=e.config)&&void 0!==n&&n.description&&(R.description=e.config.description),delete R.progress;const N=Object.entries(R).map((([e,t])=>{const a=e.toString();return"state"===a?{title:a,description:Object(f.b)(E(t))}:"analysis_stats"!==a?{title:a,description:E(t)}:void 0})).filter((e=>void 0!==e)),z={title:l.i18n.translate("xpack.ml.dataframe.analyticsList.expandedRow.tabs.jobSettings.state",{defaultMessage:"State"}),items:N,position:"left",dataTestSubj:"mlAnalyticsTableRowDetailsSection state"},{currentPhase:B,totalPhases:J}=Object(g.d)(e.stats),V={title:l.i18n.translate("xpack.ml.dataframe.analyticsList.expandedRow.tabs.jobSettings.progress",{defaultMessage:"Progress"}),items:[{title:l.i18n.translate("xpack.ml.dataframe.analyticsList.expandedRow.tabs.jobSettings.phase",{defaultMessage:"Phase"}),description:`${B}/${J}`},...e.stats.progress.map((e=>({title:e.phase,description:Object(d.jsx)(b,{progress:e.progress_percent})})))],position:"right",dataTestSubj:"mlAnalyticsTableRowDetailsSection progress"},U={title:l.i18n.translate("xpack.ml.dataframe.analyticsList.expandedRow.tabs.jobSettings.stats",{defaultMessage:"Stats"}),items:[{title:"create_time",description:Object(c.c)(1e3*r()(e.config.create_time).unix())},{title:"model_memory_limit",description:e.config.model_memory_limit},{title:"version",description:e.config.version}],position:"left",dataTestSubj:"mlAnalyticsTableRowDetailsSection stats"},G=P?{title:l.i18n.translate("xpack.ml.dataframe.analyticsList.expandedRow.tabs.jobSettings.analysisStats",{defaultMessage:"Analysis stats"}),items:[{title:"timestamp",description:Object(c.c)(1e3*r()(P.timestamp).unix())},{title:"timing_stats",description:E(P.timing_stats)},...Object.entries(P.parameters||P.hyperparameters||{}).map((([e,t])=>({title:e.toString(),description:E(t)})))],position:"right",dataTestSubj:"mlAnalyticsTableRowDetailsSection analysisStats"}:void 0;D&&A&&U.items.push({title:"generalization mean squared error",description:Object(d.jsx)(w,{isLoading:M,evalData:x,resultProperty:j.h.MSE})},{title:"generalization mean squared logarithmic error",description:Object(d.jsx)(w,{isLoading:M,evalData:x,resultProperty:j.h.MSLE})},{title:"generalization r squared",description:Object(d.jsx)(w,{isLoading:M,evalData:x,resultProperty:j.h.R_SQUARED})},{title:"generalization pseudo huber loss function",description:Object(d.jsx)(w,{isLoading:y,evalData:x,resultProperty:j.h.HUBER})},{title:"training mean squared error",description:Object(d.jsx)(w,{isLoading:y,evalData:s,resultProperty:j.h.MSE})},{title:"training mean squared logarithmic error",description:Object(d.jsx)(w,{isLoading:y,evalData:s,resultProperty:j.h.MSLE})},{title:"training r squared",description:Object(d.jsx)(w,{isLoading:y,evalData:s,resultProperty:j.h.R_SQUARED})},{title:"training pseudo huber loss function",description:Object(d.jsx)(w,{isLoading:y,evalData:s,resultProperty:j.h.HUBER})});const q=[z,V],H=[U];void 0!==G&&H.push(G);const W=[{id:"ml-analytics-job-details",name:l.i18n.translate("xpack.ml.dataframe.analyticsList.expandedRow.tabs.jobSettingsLabel",{defaultMessage:"Job details"}),content:Object(d.jsx)(p,{sections:q,dataTestSubj:`mlAnalyticsTableRowDetailsTabContent job-details ${e.config.id}`}),"data-test-subj":`mlAnalyticsTableRowDetailsTab job-details ${e.config.id}`},{id:"ml-analytics-job-stats",name:l.i18n.translate("xpack.ml.dataframe.analyticsList.analyticsDetails.tabs.analyticsStatsLabel",{defaultMessage:"Job stats"}),content:Object(d.jsx)(p,{sections:H,dataTestSubj:`mlAnalyticsTableRowDetailsTabContent job-stats ${e.config.id}`}),"data-test-subj":`mlAnalyticsTableRowDetailsTab job-stats ${e.config.id}`},{id:"ml-analytics-job-json",name:"JSON",content:Object(d.jsx)(m,{json:e.config,dataTestSubj:`mlAnalyticsTableRowDetailsTabContent json ${e.config.id}`}),"data-test-subj":`mlAnalyticsTableRowDetailsTab json ${e.config.id}`},{id:"ml-analytics-job-messages",name:l.i18n.translate("xpack.ml.dataframe.analyticsList.analyticsDetails.tabs.analyticsMessagesLabel",{defaultMessage:"Job messages"}),content:Object(d.jsx)(O,{analyticsId:e.id,dataTestSubj:`mlAnalyticsTableRowDetailsTabContent job-messages ${e.config.id}`}),"data-test-subj":`mlAnalyticsTableRowDetailsTab job-messages ${e.config.id}`}];return Object(d.jsx)(o.EuiTabbedContent,{size:"s",tabs:W,initialSelectedTab:W[0],onTabClick:()=>{},expand:!1,style:{width:"100%"},"data-test-subj":`mlAnalyticsTableRowDetails-${e.config.id}`})}},function(e,t,a){"use strict";a.d(t,"b",(function(){return results_loader_ResultsLoader})),a.d(t,"a",(function(){return categorization_examples_loader_CategorizationExamplesLoader}));var i=a(4),n=a.n(i),s=a(23),r=a(90),o=a(129),l=a(7),c=a(26),d=a(8),u=a(88),p=a(67);var m=a(77),b=a(86);const h={time:0,actual:0,modelUpper:0,modelLower:0};class results_loader_ResultsLoader{constructor(e,t,a){n()(this,"_results$",void 0),n()(this,"_resultsSearchRunning",!1),n()(this,"_jobCreator",void 0),n()(this,"_chartInterval",void 0),n()(this,"_lastModelTimeStamp",0),n()(this,"_lastResultsTimeout",null),n()(this,"_chartLoader",void 0),n()(this,"_results",{progress:0,model:[],anomalies:[]}),n()(this,"_detectorSplitFieldFilters",null),n()(this,"_splitFieldFiltersLoaded",!1),n()(this,"progressSubscriber",(async e=>{!1===this._resultsSearchRunning&&(e-this._results.progress>5||100===e)&&(!1===this._splitFieldFiltersLoaded&&(this._splitFieldFiltersLoaded=!0,await this._populateDetectorSplitFieldFilters()),this._updateData(e,!1),100===e&&(clearTimeout(this._lastResultsTimeout),this._lastResultsTimeout=setTimeout((()=>{this._updateData(e,!0)}),500)))})),this._jobCreator=e,this._chartInterval=t,this._results$=new s.BehaviorSubject(this._results),this._chartLoader=a,e.subscribeToProgress(this.progressSubscriber)}async _updateData(e,t){this._resultsSearchRunning=!0,!0===t&&this._clearResults(),this._results.progress=e;const a=this._jobCreator.type===m.f.SINGLE_METRIC?()=>this._loadJobAnomalyData(0):()=>this._loadDetectorsAnomalyData(),[i,n]=await Promise.all([this._loadModelData(0),a()]);this._results.model=i,this._results.anomalies=n,this._resultsSearchRunning=!1,this._results$.next(this._results)}get results$(){return this._results$}subscribeToResults(e){return this._results$.subscribe(e)}get progress(){return this._results.progress}_clearResults(){this._results.model={},this._results.anomalies={},this._results.progress=0,this._lastModelTimeStamp=0}async _loadModelData(e){if(!1===this._jobCreator.modelPlot)return[];const t=this._jobCreator.getAggregation(e);if(null===t)return{[e]:[h]};const a=await o.mlResultsService.getModelPlotOutput(this._jobCreator.jobId,e,[],this._lastModelTimeStamp,this._jobCreator.end,this._chartInterval.getInterval().asMilliseconds(),t.mlModelPlotAgg).toPromise();return this._createModel(a,e)}_createModel({results:e},t){void 0===this._results.model[t]&&(this._results.model[t]=[]);const a=this._jobCreator.aggregations[t].dslName,i=a===b.a.COUNT||a===b.a.CARDINALITY?this._calculateModelScale():1,n=Object.entries(e).map((([e,{actual:t,modelLower:a,modelUpper:n}])=>({time:+e,actual:t,modelUpper:(null===n?0:n)*i,modelLower:(null===a?0:a)*i})));if(n.length>10){this._lastModelTimeStamp=n[n.length-5].time;for(let e=0;e<5;e++)this._results.model[t].pop()}return{[t]:this._results.model[t].concat(n)}}async _loadJobAnomalyData(e){const t=(await o.mlResultsService.getScoresByBucket([this._jobCreator.jobId],this._jobCreator.start,this._jobCreator.end,this._chartInterval.getInterval().asMilliseconds(),1)).results[this._jobCreator.jobId];if(void 0===t)return[];const a={};return a[0]=Object.entries(t).map((([e,t])=>({time:+e,value:t,severity:Object(l.k)(t)}))),a}async _loadDetectorsAnomalyData(){const e=await(t=this._jobCreator.jobId,a=this._jobCreator.start,i=this._jobCreator.end,n=this._chartInterval.getInterval().asMilliseconds(),s=this._detectorSplitFieldFilters,new Promise(((e,r)=>{const o={success:!0,results:{},totalResults:0};let l="job_id: "+t;s&&void 0!==s.value&&(l+=` AND ${Object(u.c)(s.name)}:`,l+=`"${String(s.value).replace(/\\/g,"\\\\")}"`),p.ml.results.anomalySearch({size:0,body:{query:{bool:{filter:[{query_string:{query:"result_type:record"}},{bool:{must:[{range:{timestamp:{gte:a,lte:i,format:"epoch_millis"}}},{query_string:{query:l}}]}}]}},aggs:{detector_index:{terms:{field:"detector_index",order:{recordScore:"desc"}},aggs:{recordScore:{max:{field:"record_score"}},byTime:{date_histogram:{field:"timestamp",fixed_interval:`${n}ms`,min_doc_count:1,extended_bounds:{min:a,max:i}},aggs:{recordScore:{max:{field:"record_score"}}}}}}}}},[t]).then((t=>{Object(d.get)(t,["aggregations","detector_index","buckets"],[]).forEach((e=>{const t=[],a=+e.key,i=Object(d.get)(e,["byTime","buckets"],[]);for(let e=0;e<i.length;e++){const a=i[e],n=a.key;t.push({time:n,value:Object(d.get)(a,["recordScore","value"])})}o.results[a]=t})),e(o)})).catch((e=>{r(e)}))})));var t,a,i,n,s;const r={};return Object.entries(e.results).forEach((([e,t])=>{r[+e]=t.map((e=>({...e,severity:Object(l.k)(e.value)})))})),r}async _populateDetectorSplitFieldFilters(){if(Object(r.c)(this._jobCreator)&&null!==this._jobCreator.splitField){const e=await this._chartLoader.loadFieldExampleValues(this._jobCreator.splitField,this._jobCreator.runtimeMappings,this._jobCreator.datafeedConfig.indices_options);e.length>0&&(this._detectorSplitFieldFilters={name:this._jobCreator.splitField.name,value:e[0]})}else this._detectorSplitFieldFilters=null}_calculateModelScale(){const e=Object(c.a)(this._jobCreator.bucketSpan),t=null!==e?e.asMilliseconds():0;return this._chartInterval.getInterval().asMilliseconds()/t}}var f=a(144);class categorization_examples_loader_CategorizationExamplesLoader{constructor(e,t,a){n()(this,"_jobCreator",void 0),n()(this,"_indexPatternTitle",""),n()(this,"_timeFieldName",""),n()(this,"_query",{}),this._jobCreator=e,this._indexPatternTitle=t.title,this._query=a,"string"==typeof t.timeFieldName&&(this._timeFieldName=t.timeFieldName)}async loadExamples(){var e;const t=this._jobCreator.categorizationAnalyzer,a=this._jobCreator.categorizationFieldName;if(null===a)return{examples:[],sampleSize:0,overallValidStatus:f.a.INVALID,validationChecks:[]};return await p.ml.jobs.categorizationFieldExamples(this._indexPatternTitle,this._query,f.b,a,this._timeFieldName,this._jobCreator.start,this._jobCreator.end,t,null!==(e=this._jobCreator.runtimeMappings)&&void 0!==e?e:void 0,this._jobCreator.datafeedConfig.indices_options)}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return C}));var i=a(71),n=a.n(i),s=a(15),r=a.n(s),o=a(41),l=a(2),c=a(21),d=a.n(c),u=a(40),p=a(44),m=a(95),b=a(73),h=a(66),f=a(116),g=a(276),j=a(11);const x=l.i18n.translate("xpack.ml.jobsList.datafeedChart.editQueryDelay.tooltipContent",{defaultMessage:"To edit the query delay, you must have permission to edit the datafeed and the datafeed cannot be running."}),v=({datafeedId:e,queryDelay:t,isEnabled:a})=>{const[i,n]=Object(s.useState)(),[c,d]=Object(s.useState)(!1),{updateDatafeed:p}=Object(h.a)(),{displaySuccessToast:m,displayErrorToast:f}=Object(b.c)(),g=Object(s.useCallback)((async()=>{try{await p({datafeedId:e,datafeedConfig:{query_delay:i}}),m(l.i18n.translate("xpack.ml.jobsList.datafeedChart.editQueryDelay.changesSavedNotificationMessage",{defaultMessage:"Changes to query delay for {datafeedId} saved",values:{datafeedId:e}}))}catch(t){f(t,l.i18n.translate("xpack.ml.jobsList.datafeedChart.editQueryDelay.changesNotSavedNotificationMessage",{defaultMessage:"Could not save changes to query delay for {datafeedId}",values:{datafeedId:e}}))}d(!1)}),[e,i]),v=Object(j.jsx)(u.EuiButtonEmpty,{color:"primary",size:"xs",isDisabled:!1===a,onClick:()=>{d(!0)},iconType:"pencil"},Object(j.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.datafeedChart.queryDelayLinkLabel",defaultMessage:"Query delay: {queryDelay}",values:{queryDelay:i||t}})),y=Object(j.jsx)(u.EuiToolTip,{content:x},v);return Object(j.jsx)(r.a.Fragment,null,!1===c?!1===a?y:v:null,!0===c?Object(j.jsx)(u.EuiFormRow,{label:Object(j.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.datafeedChart.queryDelayLabel",defaultMessage:"Query delay"})},Object(j.jsx)(u.EuiFlexGroup,{gutterSize:"none",alignItems:"center"},Object(j.jsx)(u.EuiFlexItem,{grow:!1},Object(j.jsx)(u.EuiFieldText,{value:i||t,placeholder:t,onChange:e=>{n(e.target.value)}})),Object(j.jsx)(u.EuiFlexItem,{grow:!1},Object(j.jsx)(u.EuiFlexGroup,{gutterSize:"none",direction:"column"},Object(j.jsx)(u.EuiFlexItem,{grow:!1},Object(j.jsx)(u.EuiButtonEmpty,{color:"primary",size:"xs",onClick:g},Object(j.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.datafeedChart.applyQueryDelayLabel",defaultMessage:"Apply"}))),Object(j.jsx)(u.EuiFlexItem,{grow:!1},Object(j.jsx)(u.EuiButtonEmpty,{color:"text",size:"xs",onClick:()=>d(!1)},Object(j.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.datafeedChart.cancelQueryDelayUpdateLabel",defaultMessage:"Cancel"}))))))):null)},y="forward",O="back",E=["100%",380],w="messages";l.i18n.translate("xpack.ml.jobsList.datafeedChart.chartTabName",{defaultMessage:"Chart"}),l.i18n.translate("xpack.ml.jobsList.datafeedChart.messagesTabName",{defaultMessage:"Messages"});var _=a(126),S=a(72);const M=Object(p.timeFormatter)("MM-DD HH:mm:ss");function k(e){return e.header=M(e.dataValue),e}const C=({jobId:e,end:t,onClose:a})=>{const[i,c]=Object(s.useState)({datafeedConfig:void 0,bucketSpan:void 0,isInitialized:!1}),[x,w]=Object(s.useState)(d()(t)),[C,T]=Object(s.useState)(!1),[F,I]=Object(s.useState)([]),[D,A]=Object(s.useState)({rect:[],line:[]}),[L,R]=Object(s.useState)([]),[P,N]=Object(s.useState)([]),[z,B]=Object(s.useState)([]),[J,V]=Object(s.useState)(!0),[U,G]=Object(s.useState)(!0),[q,H]=Object(s.useState)(),W=Object(s.useMemo)((()=>Object(S.e)("canUpdateDatafeed")),[]),{results:{getDatafeedResultChartData:$}}=Object(h.a)(),{displayErrorToast:Y}=Object(b.c)(),{euiTheme:X}=Object(f.e)(),Q=e=>{if(void 0===i.bucketSpan)return;const t=x.clone(),a=i.bucketSpan.match(/[d | h| m | s]/g)[0],n=Number(i.bucketSpan.replace(/[^0-9]/g,""));e===y?t.add(480*n,a):t.subtract(480*n,a),w(t)},K=Object(s.useCallback)((async()=>{if(void 0===i.bucketSpan)return;const t=d()(x).valueOf(),a=i.bucketSpan.match(/[d | h| m | s]/g)[0],n=Number(i.bucketSpan.replace(/[^0-9]/g,"")),s=x.clone().subtract(480*n,a),r=d()(s).valueOf();H({start:String(r),end:String(t)});try{const a=await $(e,r,t);B(a.datafeedResults),I(a.bucketResults),A({rect:a.annotationResultsRect,line:a.annotationResultsLine.map(k)}),R(a.modelSnapshotResultsLine.map(k))}catch(e){const t=l.i18n.translate("xpack.ml.jobsList.datafeedChart.errorToastTitle",{defaultMessage:"Error fetching data"});Y(e,t)}T(!1)}),[x,i.bucketSpan]),Z=Object(s.useCallback)((async()=>{try{const t=await Object(_.k)(e);c({datafeedConfig:t.datafeed_config,bucketSpan:t.analysis_config.bucket_span,isInitialized:!0})}catch(e){Y(e)}}),[e]);Object(s.useEffect)((function(){Z()}),[]),Object(s.useEffect)((function(){void 0!==i.bucketSpan&&(T(!0),K())}),[x,i.bucketSpan]);const{datafeedConfig:ee,bucketSpan:te,isInitialized:ae}=i,ie=Object(s.useMemo)((()=>Object(u.htmlIdGenerator)()()),[]),ne=Object(s.useMemo)((()=>Object(u.htmlIdGenerator)()()),[]);return Object(j.jsx)(u.EuiPortal,null,Object(j.jsx)(u.EuiFlyout,{size:"m",ownFocus:!0,onClose:a.bind(null,!1),"aria-label":l.i18n.translate("xpack.ml.jobsList.datafeedChart.datafeedChartFlyoutAriaLabel",{defaultMessage:"Datafeed chart flyout"}),"data-test-subj":"mlAnnotationsViewDatafeedFlyout"},Object(j.jsx)(u.EuiFlyoutHeader,{hasBorder:!0,"data-test-subj":"mlAnnotationsViewDatafeedFlyoutTitle"},Object(j.jsx)(u.EuiFlexGroup,{alignItems:"center",justifyContent:"spaceBetween",gutterSize:"xl"},Object(j.jsx)(u.EuiFlexItem,{grow:!1},Object(j.jsx)(u.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},Object(j.jsx)(u.EuiFlexItem,{grow:!1},Object(j.jsx)(u.EuiIconTip,{color:"primary",type:"help",content:Object(j.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.datafeedChart.headerTooltipContent",defaultMessage:"Charts the event counts of the job and the source data to identify where missing data has occurred."})})),Object(j.jsx)(u.EuiFlexItem,{grow:!1},Object(j.jsx)(u.EuiTitle,{size:"xs"},Object(j.jsx)("h4",null,Object(j.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.datafeedChart.header",defaultMessage:"Datafeed chart for {jobId}",values:{jobId:e}})))))),Object(j.jsx)(u.EuiFlexItem,{grow:!1,style:{padding:"10px"}},Object(j.jsx)(u.EuiDatePicker,{"aria-label":l.i18n.translate("xpack.ml.jobsList.datafeedChart.chartIntervalEndTime",{defaultMessage:"Chart interval end time"}),showTimeSelect:!0,selected:x,onChange:e=>w(e),popoverPlacement:"left-start"})))),Object(j.jsx)(u.EuiFlyoutBody,null,C||!1===ae?Object(j.jsx)(u.EuiLoadingChart,{size:"l"}):null,!C&&ae&&void 0!==ee&&te?Object(j.jsx)(u.EuiFlexGroup,{direction:"column"},Object(j.jsx)(u.EuiFlexItem,{grow:!1},Object(j.jsx)(u.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(j.jsx)(u.EuiFlexItem,{grow:!1},Object(j.jsx)(v,{datafeedId:ee.datafeed_id,queryDelay:ee.query_delay,isEnabled:ee.state===m.a.STOPPED&&W})),Object(j.jsx)(u.EuiFlexItem,{grow:!1},Object(j.jsx)(u.EuiFlexGroup,null,Object(j.jsx)(u.EuiFlexItem,{grow:!1},Object(j.jsx)(u.EuiCheckbox,{id:ie,label:Object(j.jsx)(u.EuiText,{size:"xs"},Object(j.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.datafeedChart.showAnnotationsCheckboxLabel",defaultMessage:"Show annotations"})),checked:J,onChange:()=>V(!J)})),Object(j.jsx)(u.EuiFlexItem,{grow:!1},Object(j.jsx)(u.EuiCheckbox,{id:ne,label:Object(j.jsx)(u.EuiText,{size:"xs"},Object(j.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.datafeedChart.showModelSnapshotsCheckboxLabel",defaultMessage:"Show model snapshots"})),checked:U,onChange:()=>G(!U)})))))),Object(j.jsx)(u.EuiFlexItem,null,Object(j.jsx)(u.EuiFlexGroup,{gutterSize:"none",alignItems:"center"},Object(j.jsx)(u.EuiFlexItem,{grow:!1},Object(j.jsx)(u.EuiToolTip,{content:Object(j.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.datafeedChart.chartLeftArrowTooltip",defaultMessage:"Previous time window"})},Object(j.jsx)(u.EuiButtonEmpty,{"aria-label":l.i18n.translate("xpack.ml.jobsList.datafeedChart.chartIntervalLeftArrow",{defaultMessage:"Previous time window"}),color:"primary",onClick:()=>{Q(O)},iconType:"arrowLeft"}))),Object(j.jsx)(u.EuiFlexItem,null,Object(j.jsx)("div",{"data-test-subj":"mlAnnotationsViewDatafeedFlyoutChart"},Object(j.jsx)(p.Chart,{size:E},Object(j.jsx)(p.Settings,{showLegend:!0,legendPosition:p.Position.Bottom,theme:{lineSeriesStyle:{point:{visible:!1}}}}),Object(j.jsx)(p.Axis,{id:"bottom",position:p.Position.Bottom,showOverlappingTicks:!0,tickFormat:M,title:l.i18n.translate("xpack.ml.jobsList.datafeedChart.xAxisTitle",{defaultMessage:"Bucket span ({bucketSpan})",values:{bucketSpan:te}})}),Object(j.jsx)(p.Axis,{id:"left",title:l.i18n.translate("xpack.ml.jobsList.datafeedChart.yAxisTitle",{defaultMessage:"Count"}),position:p.Position.Left}),U?Object(j.jsx)(p.LineAnnotation,{id:l.i18n.translate("xpack.ml.jobsList.datafeedChart.modelSnapshotsLineSeriesId",{defaultMessage:"Model snapshots"}),key:"model-snapshots-results-line",domainType:p.AnnotationDomainType.XDomain,dataValues:L,marker:Object(j.jsx)(u.EuiIcon,{type:"asterisk"}),markerPosition:p.Position.Top,style:{line:{strokeWidth:3,stroke:X.euiColorVis1,opacity:.5}}}):null,J?Object(j.jsx)(r.a.Fragment,null,Object(j.jsx)(p.LineAnnotation,{id:l.i18n.translate("xpack.ml.jobsList.datafeedChart.annotationLineSeriesId",{defaultMessage:"Annotations line result"}),key:"annotation-results-line",domainType:p.AnnotationDomainType.XDomain,dataValues:D.line,marker:Object(j.jsx)(u.EuiIcon,{type:"annotation"}),markerPosition:p.Position.Top,style:{line:{strokeWidth:3,stroke:X.euiColorDangerText,opacity:.5}}}),Object(j.jsx)(p.RectAnnotation,{key:"annotation-results-rect",dataValues:D.rect,id:l.i18n.translate("xpack.ml.jobsList.datafeedChart.annotationRectSeriesId",{defaultMessage:"Annotations rectangle result"}),style:{fill:X.euiColorDangerText}})):null,P.length>0?Object(j.jsx)(r.a.Fragment,null,Object(j.jsx)(p.LineAnnotation,{id:l.i18n.translate("xpack.ml.jobsList.datafeedChart.messageLineAnnotationId",{defaultMessage:"Job messages line result"}),key:"messages-results-line",domainType:p.AnnotationDomainType.XDomain,dataValues:P,marker:Object(j.jsx)(u.EuiIcon,{type:"tableDensityNormal"}),markerPosition:p.Position.Top,style:{line:{strokeWidth:3,stroke:X.euiColorAccent,opacity:.5}}})):null,Object(j.jsx)(p.LineSeries,{key:"source-results",color:X.euiColorPrimary,id:l.i18n.translate("xpack.ml.jobsList.datafeedChart.sourceSeriesId",{defaultMessage:"Source indices"}),xScaleType:p.ScaleType.Time,yScaleType:p.ScaleType.Linear,xAccessor:0,yAccessors:[1],data:z,curve:p.CurveType.LINEAR}),Object(j.jsx)(p.LineSeries,{key:"job-results",color:X.euiColorAccentText,id:l.i18n.translate("xpack.ml.jobsList.datafeedChart.bucketSeriesId",{defaultMessage:"Job results"}),xScaleType:p.ScaleType.Time,yScaleType:p.ScaleType.Linear,xAccessor:0,yAccessors:[1],data:F,curve:p.CurveType.LINEAR})))),Object(j.jsx)(u.EuiFlexItem,{grow:!1},Object(j.jsx)(u.EuiToolTip,{content:Object(j.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.datafeedChart.chartRightArrowTooltip",defaultMessage:"Next time window"})},Object(j.jsx)(u.EuiButtonEmpty,{"aria-label":l.i18n.translate("xpack.ml.jobsList.datafeedChart.chartIntervalRightArrow",{defaultMessage:"Next time window"}),color:"primary",onClick:()=>{Q(y)},iconType:"arrowRight"}))))),void 0!==q?Object(j.jsx)(u.EuiFlexItem,{grow:!1},Object(j.jsx)(u.EuiFlexGroup,{direction:"column"},Object(j.jsx)(u.EuiTitle,{size:"xs"},Object(j.jsx)("h4",null,Object(j.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.datafeedChart.messagesTableTitle",defaultMessage:"Job messages"}))),Object(j.jsx)(g.a,n()({jobId:e},q,{actionHandler:function(e){if(P.length>0&&P[0].dataValue===e.timestamp)N([]);else{const t=k({dataValue:e.timestamp,details:e.message});N([t])}}})))):null):null)))}},function(e,t,a){"use strict";a.d(t,"a",(function(){return p})),a.d(t,"b",(function(){return g}));var i=a(15),n=a.n(i),s=a(2),r=a(40),o=a(72),l=a(94),c=a(11);const d=s.i18n.translate("xpack.ml.dataframe.analyticsList.deleteActionNameText",{defaultMessage:"Delete"}),u=({isDisabled:e,item:t})=>e?Object(c.jsx)(r.EuiToolTip,{position:"top",content:Object(l.g)(t.stats.state)?s.i18n.translate("xpack.ml.dataframe.analyticsList.deleteActionDisabledToolTipContent",{defaultMessage:"Stop the data frame analytics job in order to delete it."}):Object(o.f)("canStartStopDataFrameAnalytics")},Object(c.jsx)(n.a.Fragment,null,d)):Object(c.jsx)(n.a.Fragment,null,d),p=({closeModal:e,deleteAndCloseModal:t,deleteTargetIndex:a,deleteIndexPattern:i,indexPatternExists:n,isLoading:o,item:l,toggleDeleteIndex:d,toggleDeleteIndexPattern:u,userCanDeleteIndex:p})=>{if(void 0===l)return null;const m=l.config.dest.index;return Object(c.jsx)(r.EuiConfirmModal,{"data-test-subj":"mlAnalyticsJobDeleteModal",title:s.i18n.translate("xpack.ml.dataframe.analyticsList.deleteModalTitle",{defaultMessage:"Delete {analyticsId}?",values:{analyticsId:l.config.id}}),onCancel:e,onConfirm:t,cancelButtonText:s.i18n.translate("xpack.ml.dataframe.analyticsList.deleteModalCancelButton",{defaultMessage:"Cancel"}),confirmButtonText:s.i18n.translate("xpack.ml.dataframe.analyticsList.deleteModalDeleteButton",{defaultMessage:"Delete"}),defaultFocusedButton:r.EUI_MODAL_CONFIRM_BUTTON,buttonColor:"danger",confirmButtonDisabled:o},Object(c.jsx)(r.EuiFlexGroup,{direction:"column",gutterSize:"none"},Object(c.jsx)(r.EuiFlexItem,null,p&&Object(c.jsx)(r.EuiSwitch,{"data-test-subj":"mlAnalyticsJobDeleteIndexSwitch",style:{paddingBottom:10},label:s.i18n.translate("xpack.ml.dataframe.analyticsList.deleteDestinationIndexTitle",{defaultMessage:"Delete destination index {indexName}",values:{indexName:m}}),checked:a,onChange:d})),Object(c.jsx)(r.EuiFlexItem,null,p&&n&&Object(c.jsx)(r.EuiSwitch,{"data-test-subj":"mlAnalyticsJobDeleteIndexPatternSwitch",label:s.i18n.translate("xpack.ml.dataframe.analyticsList.deleteTargetIndexPatternTitle",{defaultMessage:"Delete index pattern {indexPattern}",values:{indexPattern:m}}),checked:i,onChange:u}))))};var m=a(24),b=a(66),h=a(73),f=a(163);const g=e=>{var t;const[a,n]=Object(i.useState)(),[r,o]=Object(i.useState)(!1),[p,g]=Object(i.useState)(!1),[j,x]=Object(i.useState)(!1),[v,y]=Object(i.useState)(!0),[O,E]=Object(i.useState)(!0),[w,_]=Object(i.useState)(!1),[S,M]=Object(i.useState)(!1),[k,C]=Object(i.useState)(!1),{data:{dataViews:T}}=Object(b.b)().services,F=null!==(t=null==a?void 0:a.config.dest.index)&&void 0!==t?t:"",I=Object(h.c)();Object(i.useEffect)((()=>{C(!0),(async()=>{try{const e=(await T.find(F)).find((({title:e})=>e===F));M(void 0!==e),C(!1)}catch(e){const t=Object(m.b)(e);C(!1),I.displayDangerToast(s.i18n.translate("xpack.ml.dataframe.analyticsList.errorWithCheckingIfIndexPatternExistsNotificationErrorMessage",{defaultMessage:"An error occurred checking if index pattern {indexPattern} exists: {error}",values:{indexPattern:F,error:t}}))}})(),(async()=>{try{await Object(f.a)(F,I)&&_(!0)}catch(e){const t=Object(m.b)(e);C(!1),I.displayDangerToast(s.i18n.translate("xpack.ml.dataframe.analyticsList.errorWithCheckingIfUserCanDeleteIndexNotificationErrorMessage",{defaultMessage:"An error occurred checking if user can delete {destinationIndex}: {error}",values:{destinationIndex:F,error:t}}))}})()}),[r]);const D=e=>{n(e),g(!0)};return{action:Object(i.useMemo)((()=>({name:t=>Object(c.jsx)(u,{isDisabled:Object(l.g)(t.stats.state)||!e,item:t}),enabled:t=>!Object(l.g)(t.stats.state)&&e,description:d,icon:"trash",type:"icon",onClick:e=>D(e),"data-test-subj":"mlAnalyticsJobDeleteButton"})),[]),closeDeleteJobCheckModal:()=>g(!1),closeModal:()=>o(!1),deleteAndCloseModal:()=>{x(!0),o(!1),void 0!==a&&(w&&v||w&&O?Object(f.c)(a.config,a.stats,v,S&&O,I):Object(f.b)(a.config,a.stats,I))},deleteTargetIndex:v,deleteIndexPattern:O,deleteItem:j,indexPatternExists:S,isDeleteJobCheckModalVisible:p,isModalVisible:r,isLoading:k,item:a,jobType:"data-frame-analytics",openModal:e=>{n(e),o(!0)},openDeleteJobCheckModal:D,toggleDeleteIndex:()=>y(!v),toggleDeleteIndexPattern:()=>E(!O),userCanDeleteIndex:w}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return g}));var i=a(15),n=a.n(i),s=a(2),r=a(41),o=a(40),l=a(67),c=a(11);const d=({syncItems:e})=>null===e?null:Object(c.jsx)(n.a.Fragment,null,Object(c.jsx)(u,{syncItems:e}),Object(c.jsx)(o.EuiHorizontalRule,{margin:"l"}),Object(c.jsx)(p,{syncItems:e}),Object(c.jsx)(o.EuiHorizontalRule,{margin:"l"}),Object(c.jsx)(m,{syncItems:e}),Object(c.jsx)(o.EuiHorizontalRule,{margin:"l"}),Object(c.jsx)(b,{syncItems:e}),Object(c.jsx)(o.EuiHorizontalRule,{margin:"l"})),u=({syncItems:e})=>{const t=Object.keys(e.savedObjectsCreated),a=Object(c.jsx)(n.a.Fragment,null,Object(c.jsx)(o.EuiTitle,{size:"xs","data-test-subj":"mlJobMgmtSyncFlyoutMissingObjectsTitle"},Object(c.jsx)("h3",null,Object(c.jsx)(o.EuiTextColor,{color:t.length?"default":"subdued"},Object(c.jsx)(r.FormattedMessage,{id:"xpack.ml.management.syncSavedObjectsFlyout.savedObjectsCreated.title",defaultMessage:"Missing saved objects ({count})",values:{count:t.length}})))),Object(c.jsx)(o.EuiText,{size:"s"},Object(c.jsx)("p",null,Object(c.jsx)(o.EuiTextColor,{color:"subdued"},Object(c.jsx)(r.FormattedMessage,{id:"xpack.ml.management.syncSavedObjectsFlyout.savedObjectsCreated.description",defaultMessage:"If there are jobs that do not have accompanying saved objects, they will be created in the current space."})))));return Object(c.jsx)(h,{id:"savedObjectsCreated",title:a,items:t})},p=({syncItems:e})=>{const t=Object.keys(e.savedObjectsDeleted),a=Object(c.jsx)(n.a.Fragment,null,Object(c.jsx)(o.EuiTitle,{size:"xs","data-test-subj":"mlJobMgmtSyncFlyoutUnmatchedObjectsTitle"},Object(c.jsx)("h3",null,Object(c.jsx)(o.EuiTextColor,{color:t.length?"default":"subdued"},Object(c.jsx)(r.FormattedMessage,{id:"xpack.ml.management.syncSavedObjectsFlyout.savedObjectsDeleted.title",defaultMessage:"Unmatched saved objects ({count})",values:{count:t.length}})))),Object(c.jsx)(o.EuiText,{size:"s"},Object(c.jsx)("p",null,Object(c.jsx)(o.EuiTextColor,{color:"subdued"},Object(c.jsx)(r.FormattedMessage,{id:"xpack.ml.management.syncSavedObjectsFlyout.savedObjectsDeleted.description",defaultMessage:"If there are saved objects that do not have an accompanying job, they will be deleted."})))));return Object(c.jsx)(h,{id:"savedObjectsDeleted",title:a,items:t})},m=({syncItems:e})=>{const t=Object.keys(e.datafeedsAdded),a=Object(c.jsx)(n.a.Fragment,null,Object(c.jsx)(o.EuiTitle,{size:"xs","data-test-subj":"mlJobMgmtSyncFlyoutObjectsMissingDatafeedTitle"},Object(c.jsx)("h3",null,Object(c.jsx)(o.EuiTextColor,{color:t.length?"default":"subdued"},Object(c.jsx)(r.FormattedMessage,{id:"xpack.ml.management.syncSavedObjectsFlyout.datafeedsAdded.title",defaultMessage:"Saved objects with missing datafeeds ({count})",values:{count:t.length}})))),Object(c.jsx)(o.EuiText,{size:"s"},Object(c.jsx)("p",null,Object(c.jsx)(o.EuiTextColor,{color:"subdued"},Object(c.jsx)(r.FormattedMessage,{id:"xpack.ml.management.syncSavedObjectsFlyout.datafeedsAdded.description",defaultMessage:"If there are saved objects that are missing the datafeed ID for anomaly detection jobs, the ID will be added."})))));return Object(c.jsx)(h,{id:"datafeedsAdded",title:a,items:t})},b=({syncItems:e})=>{const t=Object.keys(e.datafeedsRemoved),a=Object(c.jsx)(n.a.Fragment,null,Object(c.jsx)(o.EuiTitle,{size:"xs","data-test-subj":"mlJobMgmtSyncFlyoutObjectsUnmatchedDatafeedTitle"},Object(c.jsx)("h3",null,Object(c.jsx)(o.EuiTextColor,{color:t.length?"default":"subdued"},Object(c.jsx)(r.FormattedMessage,{id:"xpack.ml.management.syncSavedObjectsFlyout.datafeedsRemoved.title",defaultMessage:"Saved objects with unmatched datafeed IDs ({count})",values:{count:t.length}})))),Object(c.jsx)(o.EuiText,{size:"s"},Object(c.jsx)("p",null,Object(c.jsx)(o.EuiTextColor,{color:"subdued"},Object(c.jsx)(r.FormattedMessage,{id:"xpack.ml.management.syncSavedObjectsFlyout.datafeedsRemoved.description",defaultMessage:"If there are saved objects that use a datafeed that does not exist, they will be deleted."})))));return Object(c.jsx)(h,{id:"datafeedsRemoved",title:a,items:t})},h=({id:e,title:t,items:a})=>Object(c.jsx)(o.EuiAccordion,{id:e,buttonContent:t,paddingSize:"l"},Object(c.jsx)(o.EuiText,{size:"s"},Object(c.jsx)("ul",null,a.map((e=>Object(c.jsx)("li",{key:e},e))))));var f=a(73);const g=({onClose:e})=>{const{displayErrorToast:t,displaySuccessToast:a}=Object(f.c)(),[u,p]=Object(i.useState)(!1),[m,b]=Object(i.useState)(!1),[h,g]=Object(i.useState)(null);async function j(e=!0){p(!0);try{const t=await l.ml.savedObjects.syncSavedObjects(e);g(t);const a=Object.values(t).reduce(((e,t)=>e+Object.keys(t).length),0);return b(a>0),p(!1),t}catch(e){t(e),p(!1)}return null}return Object(i.useEffect)((()=>{j()}),[]),Object(c.jsx)(n.a.Fragment,null,Object(c.jsx)(o.EuiFlyout,{maxWidth:600,onClose:e,"data-test-subj":"mlJobMgmtSyncFlyout"},Object(c.jsx)(o.EuiFlyoutHeader,{hasBorder:!0},Object(c.jsx)(o.EuiTitle,{size:"m"},Object(c.jsx)("h2",null,Object(c.jsx)(r.FormattedMessage,{id:"xpack.ml.management.syncSavedObjectsFlyout.headerLabel",defaultMessage:"Synchronize saved objects"})))),Object(c.jsx)(o.EuiFlyoutBody,null,Object(c.jsx)(o.EuiCallOut,{color:"primary"},Object(c.jsx)(o.EuiText,{size:"s"},Object(c.jsx)(r.FormattedMessage,{id:"xpack.ml.management.syncSavedObjectsFlyout.description",defaultMessage:"Synchronize the saved objects if they are out of sync with the machine learning jobs in Elasticsearch."}))),Object(c.jsx)(o.EuiSpacer,null),Object(c.jsx)(d,{syncItems:h})),Object(c.jsx)(o.EuiFlyoutFooter,null,Object(c.jsx)(o.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(c.jsx)(o.EuiFlexItem,{grow:!1},Object(c.jsx)(o.EuiButtonEmpty,{iconType:"cross",onClick:e,flush:"left","data-test-subj":"mlJobMgmtSyncFlyoutCloseButton"},Object(c.jsx)(r.FormattedMessage,{id:"xpack.ml.management.syncSavedObjectsFlyout.closeButton",defaultMessage:"Close"}))),Object(c.jsx)(o.EuiFlexItem,{grow:!1},Object(c.jsx)(o.EuiButton,{onClick:async function(){if(m){const e=await j(!1);if(await j(!0),null===e)return;const{successCount:i,errorCount:n}=function(e){let t=0,a=0;return Object.values(e).forEach((e=>{Object.values(e).forEach((({success:e,error:i})=>{!0===e?t++:void 0!==i&&a++}))})),{successCount:t,errorCount:a}}(e);if(n>0){const a=s.i18n.translate("xpack.ml.management.syncSavedObjectsFlyout.sync.error",{defaultMessage:"Some jobs cannot be synchronized."});return void t(e,a)}a(s.i18n.translate("xpack.ml.management.syncSavedObjectsFlyout.sync.success",{defaultMessage:"{successCount} {successCount, plural, one {job} other {jobs}} synchronized",values:{successCount:i}}))}},fill:!0,isDisabled:!1===m||!0===u,"data-test-subj":"mlJobMgmtSyncFlyoutSyncButton"},Object(c.jsx)(r.FormattedMessage,{id:"xpack.ml.management.syncSavedObjectsFlyout.syncButton",defaultMessage:"Synchronize"})))))))}},function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var i=a(15),n=a(40),s=a(41),r=a(75),o=a(11);const l=()=>{const[e,t]=Object(i.useState)(!1),{refresh:a}=Object(r.w)({isLoading:t});return Object(o.jsx)(n.EuiButtonEmpty,{"data-test-subj":"mlAnalyticsRefreshListButton"+(e?" loading":" loaded"),onClick:a,isLoading:e},Object(o.jsx)(s.FormattedMessage,{id:"xpack.ml.dataframe.analyticsList.refreshButtonLabel",defaultMessage:"Refresh"}))}},function(e,t,a){"use strict";a.d(t,"a",(function(){return m}));var i=a(15),n=a.n(i),s=a(2),r=a(41),o=a(40),l=a(56),c=a(66),d=a(196),u=a(87),p=a(11);const m=({onClose:e})=>{const{services:{savedObjects:t,uiSettings:a}}=Object(c.b)(),m=Object(c.e)(),[b,h]=Object(i.useState)(!1),[f,g]=Object(i.useState)();return Object(p.jsx)(o.EuiModal,{className:"dataFrameAnalyticsCreateSearchDialog",onClose:e,"data-test-subj":"analyticsCreateSourceIndexModal"},Object(p.jsx)(o.EuiModalHeader,null,Object(p.jsx)(o.EuiModalHeaderTitle,null,Object(p.jsx)(r.FormattedMessage,{id:"xpack.ml.dataframe.analytics.create.newAnalyticsTitle",defaultMessage:"New analytics job"})," ","/"," ",Object(p.jsx)(r.FormattedMessage,{id:"xpack.ml.dataframe.analytics.create.chooseSourceTitle",defaultMessage:"Choose a source index pattern"}))),Object(p.jsx)(o.EuiModalBody,null,b&&Object(p.jsx)(n.a.Fragment,null,Object(p.jsx)(o.EuiCallOut,{"data-test-subj":"analyticsCreateSourceIndexModalCcsErrorCallOut",title:s.i18n.translate("xpack.ml.dataFrame.analytics.create.searchSelection.CcsErrorCallOutTitle",{defaultMessage:"Index patterns using cross-cluster search are not supported."}),color:"danger"},"string"==typeof f&&Object(p.jsx)("p",null,f)),Object(p.jsx)(o.EuiSpacer,{size:"m"})),Object(p.jsx)(l.SavedObjectFinderUi,{key:"searchSavedObjectFinder",onChoose:async(e,t,a,i)=>{let n="";if("index-pattern"===t)n=Object(d.a)(i,"attributes.title");else if("search"===t){var r,o;n=null!==(r=null===(o=(await Object(u.a)(e)).indexPattern)||void 0===o?void 0:o.title)&&void 0!==r?r:""}if(Object(u.g)(n))return h(!0),void g("search"===t?s.i18n.translate("xpack.ml.dataFrame.analytics.create.searchSelection.CcsErrorCallOutBody",{defaultMessage:"The saved search '{savedSearchTitle}' uses the index pattern '{indexPatternTitle}'.",values:{savedSearchTitle:Object(d.a)(i,"attributes.title"),indexPatternTitle:n}}):void 0);await m(`/data_frame_analytics/new_job?${"index-pattern"===t?"index":"savedSearchId"}=${encodeURIComponent(e)}`)},showFilter:!0,noItemsMessage:s.i18n.translate("xpack.ml.dataFrame.analytics.create.searchSelection.notFoundLabel",{defaultMessage:"No matching indices or saved searches found."}),savedObjectMetaData:[{type:"search",getIconForSavedObject:()=>"search",name:s.i18n.translate("xpack.ml.dataFrame.analytics.create.searchSelection.savedObjectType.search",{defaultMessage:"Saved search"})},{type:"index-pattern",getIconForSavedObject:()=>"indexPatternApp",name:s.i18n.translate("xpack.ml.dataFrame.analytics.create.searchSelection.savedObjectType.indexPattern",{defaultMessage:"Index pattern"})}],fixedPageSize:8,uiSettings:a,savedObjects:t})))}},function(e,t,a){"use strict";a.d(t,"a",(function(){return p}));var i=a(15),n=a.n(i),s=a(40),r=a(2),o=a(263),l=a(67),c=a(73),d=a(11);const u=r.i18n.translate("xpack.ml.management.jobsSpacesList.objectNoun",{defaultMessage:"job"}),p=({spacesApi:e,spaceIds:t,jobId:a,jobType:p,refresh:m})=>{const{displayErrorToast:b}=Object(c.c)(),[h,f]=Object(i.useState)(!1);function g(){f(!1),m()}const j=Object(i.useCallback)(e.ui.components.getSpaceList,[e]),x=Object(i.useCallback)(e.ui.components.getShareToSpaceFlyout,[e]),v={savedObjectTarget:{type:o.a,id:a,namespaces:t,title:a,noun:u},behaviorContext:"outside-space",changeSpacesHandler:async function(e,t,i){const n=t.includes("*")?[]:i;if(t.length||n.length){!function(e){Object.entries(e).forEach((([e,{success:t,error:a}])=>{if(!1===t){const t=r.i18n.translate("xpack.ml.management.jobsSpacesList.updateSpaces.error",{defaultMessage:"Error updating {id}",values:{id:e}});b(a,t)}}))}(await l.ml.savedObjects.updateJobsSpaces(p,[a],t,n))}g()},onClose:g};return Object(d.jsx)(n.a.Fragment,null,Object(d.jsx)(s.EuiButtonEmpty,{onClick:()=>f(!0),style:{height:"auto"},"data-test-subj":"mlJobListRowManageSpacesButton"},Object(d.jsx)(j,{namespaces:t,displayLimit:0,behaviorContext:"outside-space"})),h&&Object(d.jsx)(x,v))}},function(e,t,a){"use strict";a.d(t,"a",(function(){return i.b})),a.d(t,"b",(function(){return b}));var i=a(118),n=a(15),s=a(2),r=a(24),o=a(67),l=a(92),c=a(43),d=a(75),u=a(362),p=a(284),m=a(285);const b=()=>{const e=Object(l.b)(),[t,a]=Object(n.useReducer)(m.b,Object(i.e)()),{refresh:b}=Object(d.w)(),{form:h,jobConfig:f,isAdvancedEditorEnabled:g}=t,{createIndexPattern:j,jobId:x}=h;let{destinationIndex:v}=h;const y=e=>a({type:p.a.ADD_REQUEST_MESSAGE,requestMessage:e}),O=async()=>{const t=v;try{await e.indexPatterns.createAndSave({title:t},!1,!0),y({message:s.i18n.translate("xpack.ml.dataframe.analytics.create.createIndexPatternSuccessMessage",{defaultMessage:"Kibana index pattern {indexPatternName} created.",values:{indexPatternName:t}})})}catch(e){e instanceof c.DuplicateDataViewError?y({error:s.i18n.translate("xpack.ml.dataframe.analytics.create.duplicateIndexPatternErrorMessageError",{defaultMessage:"The index pattern {indexPatternName} already exists.",values:{indexPatternName:t}}),message:s.i18n.translate("xpack.ml.dataframe.analytics.create.duplicateIndexPatternErrorMessage",{defaultMessage:"An error occurred creating the Kibana index pattern:"})}):y({error:Object(r.b)(e),message:s.i18n.translate("xpack.ml.dataframe.analytics.create.createIndexPatternErrorMessage",{defaultMessage:"An error occurred creating the Kibana index pattern:"})})}},E=async()=>{try{const i={};(await e.indexPatterns.getCache()||[]).forEach((e=>{var t;const a=null==e||null===(t=e.attributes)||void 0===t?void 0:t.title;if(void 0!==a){const t=(null==e?void 0:e.id)||"";i[a]={label:a,value:t}}})),t={indexPatternsMap:i},a({type:p.a.SET_INDEX_PATTERN_TITLES,payload:t})}catch(e){y({error:Object(r.b)(e),message:s.i18n.translate("xpack.ml.dataframe.analytics.create.errorGettingIndexPatternTitles",{defaultMessage:"An error occurred getting the existing index pattern titles:"})})}var t},w=e=>{a({type:p.a.SET_FORM_STATE,payload:e})},_=()=>{a({type:p.a.SWITCH_TO_ADVANCED_EDITOR})},S=e=>{a({type:p.a.SET_ESTIMATED_MODEL_MEMORY_LIMIT,value:e})};return{state:t,actions:{closeModal:()=>a({type:p.a.CLOSE_MODAL}),createAnalyticsJob:async()=>{a({type:p.a.RESET_REQUEST_MESSAGES});const e=g?f:Object(i.f)(h);g&&(v=e.dest.index);try{return await o.ml.dataFrameAnalytics.createDataFrameAnalytics(x,e),y({message:s.i18n.translate("xpack.ml.dataframe.stepCreateForm.createDataFrameAnalyticsSuccessMessage",{defaultMessage:"Request to create data frame analytics {jobId} acknowledged.",values:{jobId:x}})}),t=!0,a({type:p.a.SET_IS_JOB_CREATED,isJobCreated:t}),j&&O(),b(),!0}catch(e){return y({error:Object(r.b)(e),message:s.i18n.translate("xpack.ml.dataframe.analytics.create.errorCreatingDataFrameAnalyticsJob",{defaultMessage:"An error occurred creating the data frame analytics job:"})}),!1}var t},initiateWizard:async()=>{await e.indexPatterns.clearCache(),await E()},resetAdvancedEditorMessages:()=>a({type:p.a.RESET_ADVANCED_EDITOR_MESSAGES}),setAdvancedEditorRawString:e=>a({type:p.a.SET_ADVANCED_EDITOR_RAW_STRING,advancedEditorRawString:e}),setFormState:w,setJobConfig:e=>{a({type:p.a.SET_JOB_CONFIG,payload:e})},startAnalyticsJob:async()=>{try{const t=await o.ml.dataFrameAnalytics.startDataFrameAnalytics(x);if(!0!==t.acknowledged)throw new Error(t);y({message:s.i18n.translate("xpack.ml.dataframe.analytics.create.startDataFrameAnalyticsSuccessMessage",{defaultMessage:"Request to start data frame analytics {jobId} acknowledged.",values:{jobId:x}})}),e=!0,a({type:p.a.SET_IS_JOB_STARTED,isJobStarted:e}),b()}catch(e){y({error:Object(r.b)(e),message:s.i18n.translate("xpack.ml.dataframe.analytics.create.errorStartingDataFrameAnalyticsJob",{defaultMessage:"An error occurred starting the data frame analytics job:"})})}var e},switchToAdvancedEditor:_,switchToForm:()=>{a({type:p.a.SWITCH_TO_FORM})},setEstimatedModelMemoryLimit:S,setJobClone:async e=>{a({type:p.a.RESET_FORM});const t=Object(u.a)(e);Object(u.b)(t)?(w(Object(i.d)(t)),_()):(w(Object(i.d)(t)),S(t.model_memory_limit)),a({type:p.a.SET_JOB_CLONE,cloneJob:e})}}}}},,function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));a(15);var i=a(40),n=a(11);const[s,r,o]=["info","warning","error"],l=({message:e,showTooltip:t=!1})=>{if(void 0===e)return Object(n.jsx)("span",null);let a="primary",l="alert";return e.level===s?l="iInCircle":e.level===r?a="warning":e.level===o&&(a="danger"),t?Object(n.jsx)(i.EuiToolTip,{position:"bottom",content:e.text},Object(n.jsx)(i.EuiIcon,{type:l,color:a})):Object(n.jsx)(i.EuiIcon,{type:l,color:a})}},function(e,t,a){"use strict";a.d(t,"a",(function(){return p}));var i=a(15),n=a.n(i),s=a(40),r=a(2),o=a(41),l=a(51),c=a(360),d=a(76),u=a(11);const p=({messages:e,loading:t,error:a,refreshMessage:i,actionHandler:p})=>{const m=[{name:i?Object(u.jsx)(s.EuiToolTip,{content:r.i18n.translate("xpack.ml.jobMessages.refreshLabel",{defaultMessage:"Refresh"})},Object(u.jsx)(s.EuiButtonIcon,{onClick:i,iconType:"refresh","aria-label":r.i18n.translate("xpack.ml.jobMessages.refreshAriaLabel",{defaultMessage:"Refresh"})})):"",render:e=>Object(u.jsx)(c.a,{message:e}),width:`${l.euiLightVars.euiSizeL}`},{field:"timestamp",name:r.i18n.translate("xpack.ml.jobMessages.timeLabel",{defaultMessage:"Time"}),render:d.d,width:"120px",sortable:!0},{field:"node_name",name:r.i18n.translate("xpack.ml.jobMessages.nodeLabel",{defaultMessage:"Node"}),width:"150px"},{field:"message",name:r.i18n.translate("xpack.ml.jobMessages.messageLabel",{defaultMessage:"Message"}),width:"50%"}];"function"==typeof p&&m.push({name:r.i18n.translate("xpack.ml.jobMessages.actionsLabel",{defaultMessage:"Actions"}),width:"10%",actions:[{render:e=>Object(u.jsx)(s.EuiToolTip,{content:Object(u.jsx)(o.FormattedMessage,{id:"xpack.ml.jobMessages.toggleInChartTooltipText",defaultMessage:"Toggle in chart"})},Object(u.jsx)(s.EuiButtonIcon,{size:"xs","aria-label":r.i18n.translate("xpack.ml.jobMessages.toggleInChartAriaLabel",{defaultMessage:"Toggle in chart"}),iconType:"visAreaStacked",onClick:()=>p(e)}))}]});return Object(u.jsx)(n.a.Fragment,null,Object(u.jsx)(s.EuiSpacer,{size:"s"}),Object(u.jsx)(s.EuiInMemoryTable,{className:"job-messages-table",items:e,columns:m,sorting:{sort:{field:"timestamp",direction:"desc"}},compressed:!0,loading:t,error:a,pagination:!0,"data-test-subj":"mlAnalyticsDetailsJobMessagesTable"}))}},function(e,t,a){"use strict";a.d(t,"a",(function(){return i.c})),a.d(t,"b",(function(){return i.d})),a.d(t,"c",(function(){return r}));var i=a(146),n=a(15),s=a(11);const r=e=>{const t=Object(i.e)(),a=Object(n.useCallback)((e=>{t(e)}),[]);return{action:Object(n.useMemo)((()=>({name:()=>Object(s.jsx)(i.a,{isDisabled:!e}),enabled:()=>e,description:i.b,icon:"copy",type:"icon",onClick:a,"data-test-subj":"mlAnalyticsJobCloneButton"})),[])}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var i=a(15),n=a(40),s=a(54),r=a(2),o=a(11);function l(e){return null!==e?r.i18n.translate("xpack.ml.jobSelector.filterBar.invalidSearchErrorMessage",{defaultMessage:"Invalid search: {errorMessage}",values:{errorMessage:e.message}}):""}function c({checkboxDisabledCheck:e,columns:t,currentPage:a=0,filterDefaultFields:c,filters:d,items:u,itemsPerPage:p=20,onTableChange:m,radioDisabledCheck:b,selectedIds:h,setCurrentPaginationData:f,singleSelection:g,sortableProperties:j,tableItemId:x="id"}){const[v,y]=Object(i.useState)(R()),[O,E]=Object(i.useState)(u),[w,_]=Object(i.useState)(h),[S,M]=Object(i.useState)(""),[k,C]=Object(i.useState)(),[T,F]=Object(i.useState)({itemsPerPage:p,firstItemIndex:0,lastItemIndex:1}),[I,D]=Object(i.useState)(n.EuiSearchBar.Query.MATCH_ALL),[A,L]=Object(i.useState)(null);function R(){const e={all:!1};return h.forEach((t=>{e[t]=!0})),e}function P({isSelected:e,itemId:t}){const a=Object.getOwnPropertyNames(v),i=O.map((e=>e[x]));let n=a.filter((e=>!0===v[e]&&e!==t));"all"!==t?!0===e&&n.push(t):!1===e?n=n.filter((e=>!1===i.includes(e))):(n=[...n,...i],n=[...new Set(n)]),f&&f({pageIndex:k.getCurrentPageIndex(),itemsPerPage:T.itemsPerPage}),m(n)}function N({query:e,error:t}){if(t)L(t);else{const t=n.EuiSearchBar.Query.execute(e,u,{defaultFields:c});L(null),E(t),D(e)}}function z(e){return!0===v[e]}function B(){return-1===O.findIndex((e=>!z(e[x])))}Object(i.useEffect)((()=>{E(u),N({query:I})}),[u]),Object(i.useEffect)((()=>{y(R())}),[h]),Object(i.useEffect)((()=>{const e=new s.Pager(O.length,p,a);F({itemsPerPage:p,firstItemIndex:e.getFirstItemIndex(),lastItemIndex:e.getLastItemIndex()}),C(e)}),[O]);const J=Object(i.useMemo)((()=>Object(n.htmlIdGenerator)()()),[]);function V(e){const t=r.i18n.translate("xpack.ml.jobSelector.customTable.selectAllCheckboxLabel",{defaultMessage:"Select all"});return Object(o.jsx)(n.EuiCheckbox,{id:`${e?"mobile-":""}${J}`,label:e?t:null,checked:B(),onChange:G,type:e?null:"inList"})}function U(e){if(g){const t=w[0];y({...v,[t]:!1,[e]:!0}),function(e){m([e])}(e),_([e])}else{const t=!z(e);y({...v,[e]:t}),P({isSelected:t,itemId:e})}}function G(){const e=B()||!0===v.all,t={};O.forEach((a=>t[a[x]]=!e)),y(t),P({isSelected:!e,itemId:"all"})}return Object(o.jsx)(i.Fragment,null,Object(o.jsx)(n.EuiSpacer,{size:"s"}),Object(o.jsx)(n.EuiFlexGroup,{direction:"column"},Object(o.jsx)(n.EuiFlexItem,{grow:!1,"data-test-subj":"mlCustomSelectionTableSearchBar"},Object(o.jsx)(n.EuiSearchBar,{defaultQuery:I,box:{incremental:!0,placeholder:r.i18n.translate("xpack.ml.jobSelector.customTable.searchBarPlaceholder",{defaultMessage:"Search..."})},filters:d,onChange:N}),Object(o.jsx)(n.EuiFormRow,{fullWidth:!0,isInvalid:null!==A,error:l(A),style:{maxHeight:"0px"}},Object(o.jsx)(i.Fragment,null)))),Object(o.jsx)(n.EuiSpacer,{size:"m"}),Object(o.jsx)(n.EuiTableHeaderMobile,null,Object(o.jsx)(n.EuiFlexGroup,{responsive:!1,justifyContent:"spaceBetween",alignItems:"baseline"},Object(o.jsx)(n.EuiFlexItem,{grow:!1},V(!0)))),Object(o.jsx)(n.EuiTable,{"data-test-subj":"mlCustomSelectionTable"},Object(o.jsx)(n.EuiTableHeader,null,function(){const e=[];return t.forEach(((a,i)=>{a.isCheckbox&&!g?e.push(Object(o.jsx)(n.EuiTableHeaderCellCheckbox,{key:a.id,width:a.width},V())):e.push(Object(o.jsx)(n.EuiTableHeaderCell,{key:a.id,align:t[i].alignment,width:a.width,onSort:a.isSortable?()=>function(e){j.sortOn(e);const t=j.sortItems(O);E(t),M(e)}(a.id):void 0,isSorted:S===a.id,isSortAscending:!j||j.isAscendingByName(a.id),mobileOptions:a.mobileOptions},a.label))})),e.length?e:null}()),Object(o.jsx)(n.EuiTableBody,null,function(){const a=a=>{const i=t.map((t=>{const i=a[t.id];let s;return t.isCheckbox?Object(o.jsx)(n.EuiTableRowCellCheckbox,{key:t.id},!g&&Object(o.jsx)(n.EuiCheckbox,{disabled:void 0!==e?e(a):void 0,id:`${a[x]}-checkbox`,"data-test-subj":`${a[x]}-checkbox`,checked:z(a[x]),onChange:()=>U(a[x]),type:"inList"}),g&&Object(o.jsx)(n.EuiRadio,{id:a[x],"data-test-subj":`${a[x]}-radio-button`,checked:z(a[x]),onChange:()=>U(a[x]),disabled:void 0!==b?b(a):void 0})):(s=t.render?t.render(a):i,Object(o.jsx)(n.EuiTableRowCell,{key:t.id,align:t.alignment,truncateText:i&&i.truncateText,textOnly:!i||i.textOnly,mobileOptions:{header:t.label,...t.mobileOptions}},s))}));return Object(o.jsx)(n.EuiTableRow,{key:a[x],isSelected:z(a[x]),isSelectable:!0,hasActions:!0,"data-test-subj":`mlCustomSelectionTableRow row-${a[x]}`},i)},i=[];for(let e=T.firstItemIndex;e<=T.lastItemIndex;e++){const t=O[e];if(void 0===t)break;i.push(a(t))}return i}())),Object(o.jsx)(n.EuiSpacer,{size:"m"}),void 0!==k&&Object(o.jsx)(n.EuiTablePagination,{activePage:k.getCurrentPageIndex(),itemsPerPage:T.itemsPerPage,itemsPerPageOptions:[5,10,20,50],pageCount:k.getTotalPages(),onChangeItemsPerPage:function(e){k.setItemsPerPage(e),F({...T,itemsPerPage:e,firstItemIndex:k.getFirstItemIndex(),lastItemIndex:k.getLastItemIndex()})},onChangePage:e=>function(e){k.goToPageIndex(e),F({...T,firstItemIndex:k.getFirstItemIndex(),lastItemIndex:k.getLastItemIndex()})}(e)}))}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,a){switch(window.__kbnThemeTag__){case"v7dark":return a(393);case"v7light":return a(395);case"v8dark":return a(397);case"v8light":return a(399)}},function(e,t,a){var i=a(68),n=a(394);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var s={insert:"head",singleton:!1};i(n,s);e.exports=n.locals||{}},function(e,t,a){(t=a(69)(!1)).push([e.i,'.ml-app .ml-icon-severity-critical,.ml-app .ml-icon-severity-major,.ml-app .ml-icon-severity-minor,.ml-app .ml-icon-severity-warning,.ml-app .ml-icon-severity-unknown{text-shadow:1px 1px 1px #343741}.ml-app .ml-icon-severity-critical{color:#FE5050}.ml-app .ml-icon-severity-major{color:#FBA740}.ml-app .ml-icon-severity-minor{color:#FDEC25}.ml-app .ml-icon-severity-warning{color:#8BC8FB}.ml-app .ml-icon-severity-unknown{color:#98A2B3}.ml-app .mlDataFrameAnalyticsRegression__evaluateStat{padding-top:24px}.ml-app .mlJobMapLegend__container{background-color:\'#FFFFFF\'}.ml-app .mlJobMapLegend__indexPattern{height:12px;width:12px;background-color:#fff;border:2px solid #D36086;transform:rotate(45deg);display:\'inline-block\'}.ml-app .mlJobMapLegend__transform{height:12px;width:12px;background-color:#fff;border:2px solid #6092C0;display:\'inline-block\'}.ml-app .mlJobMapLegend__analytics{height:12px;width:12px;background-color:#fff;border:2px solid #54B399;border-radius:50%;display:\'inline-block\'}.ml-app .mlJobMapLegend__sourceNode{height:12px;width:12px;background-color:#FFCE7A;border:1px solid #343741;border-radius:4px;display:\'inline-block\'}.ml-app .mlAnalyticsTable .euiTableRow-isExpandedRow .euiTableCellContent{animation:none !important}.ml-app .mlAnalyticsTable .euiTableRow-isExpandedRow .euiTableCellContent .euiTableCellContent__text{width:100%}.ml-app .mlAnalyticsTable .euiIcon-isLoaded{animation:none !important}.ml-app .mlTaskStateBadge,.ml-app .mlTaskModeBadge{max-width:100px}.ml-app .dataFrameAnalyticsCreateSearchDialog{width:720px;min-height:600px}.ml-app .dfAnalyticsCreationWizard__card{width:300px}.ml-app .ml-explorer{width:100%;display:inline-block;color:#98A2B3}.ml-app .ml-explorer .mlAnomalyExplorer__filterBar{padding-right:16px;padding-left:16px}.ml-app .ml-explorer .results-container{padding:0 0 16px 0}.ml-app .ml-explorer .results-container .col-xs-12{width:calc(100% - 32px);padding-left:16px}.ml-app .ml-explorer .results-container .no-influencers-warning{float:left;padding-top:4px;padding-left:16px;color:#98A2B3;font-size:14px}.ml-app .ml-explorer .results-container .panel-title{font-size:18px;font-weight:400;color:#98A2B3;display:inline-block;padding-bottom:4px}.ml-app .ml-explorer .results-container .panel-sub-title{color:#98A2B3;font-size:12px}.ml-app .mlSwimLaneContainer .echLegendListContainer{height:34px !important}.ml-app .mlSwimLaneContainer .echLegendList{display:flex !important;justify-content:space-between !important;flex-wrap:nowrap;position:absolute;right:0}.ml-app .ml-explorer-chart-eui-icon-tip{max-width:none}.ml-app .ml-explorer-chart-label-badges{margin-top:4px;display:flex;align-items:center}.ml-app .ml-reset-font-weight{font-weight:normal}.ml-app .ml-explorer-chart-container{overflow:hidden}.ml-app .ml-explorer-chart-container .ml-explorer-chart-svg{font-size:12px;font-family:"Inter UI",-apple-system,BlinkMacSystemFont,"Segoe UI",Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol"}.ml-app .ml-explorer-chart-container .ml-explorer-chart-svg .line-chart rect{fill:#1D1E24;opacity:1}.ml-app .ml-explorer-chart-container .ml-explorer-chart-svg .line-chart rect.selected-interval{fill:rgba(200,200,200,0.1);stroke:#98A2B3;stroke-width:2px;stroke-opacity:.8}.ml-app .ml-explorer-chart-container .ml-explorer-chart-svg .line-chart rect.scheduled-event-marker{stroke-width:1px;stroke:#98A2B3;fill:#343741;pointer-events:none}.ml-app .ml-explorer-chart-container .axis path,.ml-app .ml-explorer-chart-container .axis line{fill:none;stroke:#343741;shape-rendering:crispEdges}.ml-app .ml-explorer-chart-container .axis .tick line.ml-tick-emphasis{stroke:rgba(0,0,0,0.2)}.ml-app .ml-explorer-chart-container .axis text{fill:#98A2B3}.ml-app .ml-explorer-chart-container .axis .tick line{stroke:#343741;stroke-width:1px}.ml-app .ml-explorer-chart-container .values-line{fill:none;stroke:#1BA9F5;stroke-width:2}.ml-app .ml-explorer-chart-container .values-dots circle,.ml-app .ml-explorer-chart-container .values-dots-circle{fill:#1BA9F5;stroke-width:0}.ml-app .ml-explorer-chart-container .values-dots circle.values-dots-circle-blur{fill:#535966}.ml-app .ml-explorer-chart-container .metric-value{opacity:1;fill:transparent;stroke:#1BA9F5;stroke-width:0}.ml-app .ml-explorer-chart-container .anomaly-marker{stroke-width:1px;stroke:#535966}.ml-app .ml-explorer-chart-container .anomaly-marker:hover{stroke-width:6px;stroke:#1BA9F5}.ml-app .ml-explorer-chart-container .anomaly-marker.critical{fill:#FE5050}.ml-app .ml-explorer-chart-container .anomaly-marker.major{fill:#FBA740}.ml-app .ml-explorer-chart-container .anomaly-marker.minor{fill:#FDEC25}.ml-app .ml-explorer-chart-container .anomaly-marker.warning{fill:#8BC8FB}.ml-app .ml-explorer-chart-container .anomaly-marker.low{fill:#D2E9F7}.ml-app .ml-explorer-chart-container .metric-value:hover,.ml-app .ml-explorer-chart-container .anomaly-marker:hover{stroke-width:6px;stroke-opacity:.65}.ml-app .ml-explorer-chart{overflow:hidden}.ml-app .ml-explorer-chart-content-wrapper{height:215px}.ml-app .ml-explorer-chart-axis-emphasis{font-weight:bold}.ml-app .explorer-charts ml-explorer-charts-container .row{padding:10px}.ml-app .explorer-charts ml-explorer-charts-container label{font-size:12px}.ml-app .explorer-charts ml-explorer-charts-container select{font-size:14px;font-style:400}.ml-app .explorer-charts ml-explorer-charts-container .chart-controls label{padding:0 0 10px 0}.ml-app .explorer-charts ml-explorer-charts-container .no-results-item{text-align:center;padding-top:10px}.ml-app .explorer-charts ml-explorer-charts-container .ml-anomaly-interim-result{font-style:italic;padding-bottom:3px}.ml-app .explorer-charts ml-explorer-charts-container .ml-tablerow-expanded{width:100%;padding:5px 20px;overflow:hidden;font-size:12px}.ml-app .explorer-charts ml-explorer-charts-container .ml-tablerow-expanded td{padding:0 0 2px 0}.ml-app .explorer-charts ml-explorer-charts-container .ml-tablerow-expanded table tr>td:first-child{padding-left:2px;vertical-align:top}.ml-app .explorer-charts ml-explorer-charts-container .ml-tablerow-expanded td:first-child{width:140px}.ml-app .explorer-charts ml-explorer-charts-container .ml-tablerow-expanded td:nth-child(2){padding-left:5px}.ml-app .ml-explorer-chart-icons{float:right;padding-left:5px;margin:2px -8px 0 0}.ml-app .ml-edit-url-form .url-label{width:250px}.ml-app .ml-edit-url-form .url-link-to-radio .euiRadio{display:inline-block;padding-right:24px}.ml-app .ml-edit-url-form .url-time-range{width:150px}.ml-app .new-job-button-container{float:right}.ml-app .edit-custom-url-panel .close-editor-button{position:relative;float:right;top:-4px;right:0}.ml-app .tab-contents{margin:-8px;padding:8px;background-color:#1D1E24}.ml-app .tab-contents .col-md-6:nth-child(1){padding-right:7px}.ml-app .tab-contents .col-md-6:nth-child(2){padding-left:7px}.ml-app .tab-contents .job-section{overflow:auto;padding:5px 15px;background-color:#25262E;border:1px solid #343741;border-radius:4px;margin:4px 0}.ml-app .tab-contents .job-section .euiTable{background-color:transparent}.ml-app .tab-contents .job-section .euiTable .euiTableRow:first-child .euiTableRowCell{border-top:0}.ml-app .tab-contents .job-section .euiTable .euiTableRow:last-child .euiTableRowCell{border-bottom:0}.ml-app .tab-contents .job-section .euiTable .euiTableRow .euiTableRowCell{vertical-align:top;border-bottom:1px solid #343741}.ml-app .tab-contents .job-section .euiTable .euiTableRow .euiTableRowCell .euiTableCellContent__text{word-wrap:break-word}.ml-app .tab-contents .job-section .euiTable .euiTableRow:hover{background-color:inherit}.ml-app .tab-contents .job-section .job-item{font-size:12px}.ml-app .tab-contents .job-section .job-item.header{font-weight:bold}.ml-app .tab-contents .json-textarea{height:500px}.ml-app .job-messages-table{max-height:500px;overflow:auto;text-align:left}.ml-app .job-messages-table tr:last-child td{border-bottom:none}.ml-app .job-messages-table .euiTableRowCell{background-color:#1D1E24}.ml-app .mlJobFilterBar .euiFilterGroup .euiPopover .euiPanel .group-item{padding:8px 16px}.ml-app .mlJobFilterBar .euiFilterGroup .euiPopover .euiPanel .inline-group{border:1px solid #1D1E24;border-radius:4px}.ml-app .mlJobFilterBar .euiFilterGroup .euiPopover .euiPanel .euiFilterSelectItem:hover,.ml-app .mlJobFilterBar .euiFilterGroup .euiPopover .euiPanel .euiFilterSelectItem:focus{text-decoration:none}.ml-app .mlJobFilterBar .euiFilterGroup .euiPopover .euiPanel .euiFilterSelectItem:hover .inline-group,.ml-app .mlJobFilterBar .euiFilterGroup .euiPopover .euiPanel .euiFilterSelectItem:focus .inline-group{border:1px solid #98A2B3;box-shadow:0 1px 2px #535966}.ml-app .inline-group{font-size:12px;background-color:#343741;padding:2px 5px;border-radius:2px;display:inline-block;margin:0 3px;color:#1D1E24;vertical-align:text-top}.ml-app .jobs-list-table>div>.euiTable>thead th{text-align:left;white-space:normal}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(2){width:34px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(3){width:auto}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(4){width:20px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(5){width:auto}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(6){width:100px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(7){width:85px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(8){width:80px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(9){width:80px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(10){width:150px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(11){width:80px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(12){width:30px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(12) .euiTableCellContent__text{display:none}.ml-app .jobs-list-table>div>.euiTable>tbody td:nth-child(4) .euiTableCellContent{padding:0}.ml-app .jobs-list-table>div>.euiTable>tbody td:nth-child(10){white-space:nowrap}.ml-app .jobs-list-table>div>.euiTable>tbody .euiTableCellContent{animation:unset}.ml-app .jobs-list-table>div>.euiTable>tbody .euiTableRow.euiTableRow-isExpandedRow>td>div>.euiTableCellContent__text{width:100%}.ml-app .jobs-list-table>div>.euiTable>tbody .euiTableRow.euiTableRow-isExpandedRow>td>div>.euiTableCellContent__text .euiTableRowCell{background-color:inherit}.ml-app .jobs-list-table>div>.euiTable>tbody .euiTableRow>.euiTableRowCell>.euiTableCellContent>.euiTableCellContent__hoverItem{opacity:1}.ml-app .jobs-list-table>div>.euiTable>tbody .euiContextMenuPanel .euiContextMenuItem{white-space:nowrap}.ml-app .jobs-list-table>div>.euiTable>tbody .euiContextMenuPanel .euiContextMenuItem:last-child:not(.euiContextMenuItem-isDisabled){color:#F66}.ml-app .jobs-list-table>div>.euiTable>tbody .results-button{margin-right:4px;width:18px}.ml-app .jobs-list-table>div>.euiTable>tbody .euiContextMenuItem .euiIcon{margin-right:4px}.ml-app .jobs-list-table>div>.euiTable .job-description{display:inline-block}.ml-app .jobs-list-table>div>.euiTable .job-loading-spinner{text-align:center}.ml-app .jobs-list-table.jobs-selected .results-button{color:#343741;pointer-events:none}.ml-app .actions-bar{min-height:60px;display:flex;align-items:center}.ml-app .job-management{padding:20px}.ml-app .multi-select-actions .actions-border,.ml-app .multi-select-actions .actions-border-large{height:20px;border-right:1px solid #343741;width:1px;display:inline-block;vertical-align:middle;margin:0 5px}.ml-app .multi-select-actions .actions-border-large{height:35px;margin:0 15px}.ml-app .multi-select-actions .results-button{margin-right:5px}.ml-app .multi-select-actions .euiContextMenuPanel .euiContextMenuItem__text{white-space:nowrap}.ml-app .multi-select-actions .euiContextMenuPanel .euiContextMenuItem:last-child:not(.euiContextMenuItem-isDisabled){color:#F66}.ml-app .multi-select-actions-no-display{display:none}.ml-app .group-selector{max-width:300px}.ml-app .group-selector .euiPopoverTitle{margin-bottom:8px !important}.ml-app .group-list{max-height:350px;overflow:auto}.ml-app .group-list .group-item{line-height:18px;padding:6px 0;border-bottom:1px solid #343741;cursor:pointer}.ml-app .group-list .group-item:focus{background-color:#EEF6F9;box-shadow:none}.ml-app .group-list .group-item .check{width:20px;display:inline-block}.ml-app .group-list .group-item .inline-group{border:1px solid #1D1E24;border-radius:4px}.ml-app .group-list .group-item:hover .inline-group{border:1px solid #98A2B3;box-shadow:0 1px 2px #535966}.ml-app .group-list .group-item:last-child{margin-bottom:0;border-bottom:none}.ml-app .new-group-input{padding-bottom:0}.ml-app .ml-custom-urls-selection>.euiFlexGroup>.euiFlexItem:first-child{max-width:388px}.ml-app .ml-custom-urls-selection>.euiFlexGroup>.euiFlexItem:last-child{flex-basis:50%}.ml-app .mlOverviewPanel{padding-top:0}.ml-app .mlOverviewPanel__isLoading{text-align:center;padding:10%}.ml-app .mlOverviewPanel__buttons{float:right}.ml-app .mlOverviewPanel__spinner{display:inline-block}.ml-app .mlOverviewPanel__refreshButton{padding-right:12px}.ml-app .mlOverviewPanel__statsBar{margin-top:0;margin-right:0}.ml-app .mlSettingsPage .mlSettingsPage__header{width:1200px;margin-left:auto;margin-right:auto}.ml-app .mlSettingsPage .mlSettingsPage__content{width:1200px;margin-top:16px;margin-bottom:16px}.ml-app .ml-list-filter-lists .ml-list-filter-lists-content{max-width:1100px;margin-top:16px;margin-bottom:16px}.ml-app .ml-list-filter-lists .ml-filter-lists-table th:last-child,.ml-app .ml-list-filter-lists .ml-filter-lists-table td:last-child{width:70px}.ml-app .ml-edit-filter-lists .ml-edit-filter-lists-content{max-width:1100px;width:100%;margin-top:16px;margin-bottom:16px}.ml-app .ml-edit-filter-lists .ml-filter-list-usage>div{display:inline}.ml-app .ml-edit-filter-lists .ml-filter-list-usage .euiButtonEmpty.euiButtonEmpty--small{padding-bottom:4px}.ml-app .ml-edit-filter-lists .ml-filter-list-usage .euiButtonEmpty .euiButtonEmpty__content{padding:0 4px}.ml-app .ml-add-filter-item-popover .euiFormRow{width:300px;padding-bottom:4px}.ml-app .ml-filter-list-usage-popover li{line-height:24px}.ml-app .mlCalendarEditForm .mlCalendarEditForm__content{max-width:1200px;width:100%;margin-top:16px;margin-bottom:16px}.ml-app .mlCalendarList .mlCalendarList__content{max-width:1200px;margin-top:16px;margin-bottom:16px}.ml-app .ml-time-series-explorer{color:#98A2B3}.ml-app .ml-time-series-explorer .results-container .panel-title{font-size:18px;font-weight:400;color:#98A2B3}.ml-app .ml-time-series-explorer .results-container .entity-count-text{color:#7DE2D1;font-size:14px}.ml-app .ml-time-series-explorer .forecast-controls{float:right}.ml-app .ml-time-series-explorer .ml-timeseries-chart svg{font-size:12px;font-family:"Inter UI",-apple-system,BlinkMacSystemFont,"Segoe UI",Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol"}.ml-app .ml-time-series-explorer .ml-timeseries-chart .axis path,.ml-app .ml-time-series-explorer .ml-timeseries-chart .axis line{fill:none;stroke:#343741;shape-rendering:crispEdges;pointer-events:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .axis text{fill:#DFE5EF}.ml-app .ml-time-series-explorer .ml-timeseries-chart .axis .tick line{stroke:#343741}.ml-app .ml-time-series-explorer .ml-timeseries-chart .chart-border{stroke:#343741;fill:none;stroke-width:1;shape-rendering:crispEdges}.ml-app .ml-time-series-explorer .ml-timeseries-chart .chart-border-highlight{stroke:#98A2B3;stroke-width:2}.ml-app .ml-time-series-explorer .ml-timeseries-chart .chart-border-highlight:hover{opacity:1}.ml-app .ml-time-series-explorer .ml-timeseries-chart .area{stroke-width:1}.ml-app .ml-time-series-explorer .ml-timeseries-chart .area.bounds{fill:rgba(27,169,245,0.2);pointer-events:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .values-line{fill:none;stroke:#1BA9F5;stroke-width:2;pointer-events:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .values-line.forecast{stroke:#D6BF57;pointer-events:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .hidden{visibility:hidden}.ml-app .ml-time-series-explorer .ml-timeseries-chart .area.forecast{fill:rgba(214,191,87,0.3);pointer-events:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .metric-value{opacity:1;fill:transparent;stroke:#1BA9F5;stroke-width:0}.ml-app .ml-time-series-explorer .ml-timeseries-chart .anomaly-marker{stroke-width:1px;stroke:#535966}.ml-app .ml-time-series-explorer .ml-timeseries-chart .anomaly-marker.critical{fill:#FE5050}.ml-app .ml-time-series-explorer .ml-timeseries-chart .anomaly-marker.major{fill:#FBA740}.ml-app .ml-time-series-explorer .ml-timeseries-chart .anomaly-marker.minor{fill:#FDEC25}.ml-app .ml-time-series-explorer .ml-timeseries-chart .anomaly-marker.warning{fill:#8BC8FB}.ml-app .ml-time-series-explorer .ml-timeseries-chart .anomaly-marker.low{fill:#D2E9F7}.ml-app .ml-time-series-explorer .ml-timeseries-chart .metric-value:hover,.ml-app .ml-time-series-explorer .ml-timeseries-chart .anomaly-marker:hover,.ml-app .ml-time-series-explorer .ml-timeseries-chart .anomaly-marker.highlighted{stroke-width:6px;stroke-opacity:.65;stroke:#1BA9F5}.ml-app .ml-time-series-explorer .ml-timeseries-chart rect.scheduled-event-marker{stroke-width:1px;stroke:#98A2B3;fill:#343741;pointer-events:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .forecast .metric-value,.ml-app .ml-time-series-explorer .ml-timeseries-chart .forecast .metric-value:hover{stroke:#D6BF57}.ml-app .ml-time-series-explorer .ml-timeseries-chart .focus-chart .x-axis-background line{fill:none;shape-rendering:crispEdges;stroke:#25262E}.ml-app .ml-time-series-explorer .ml-timeseries-chart .focus-chart .x-axis-background rect{fill:#25262E}.ml-app .ml-time-series-explorer .ml-timeseries-chart .focus-chart .focus-zoom{fill:#98A2B3}.ml-app .ml-time-series-explorer .ml-timeseries-chart .focus-chart .focus-zoom a text{fill:#1BA9F5;cursor:pointer}.ml-app .ml-time-series-explorer .ml-timeseries-chart .focus-chart .focus-zoom a:hover,.ml-app .ml-time-series-explorer .ml-timeseries-chart .focus-chart .focus-zoom a:active,.ml-app .ml-time-series-explorer .ml-timeseries-chart .focus-chart .focus-zoom a:focus{text-decoration:underline}.ml-app .ml-time-series-explorer .ml-timeseries-chart .context-chart .x.axis path{display:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .context-chart .axis text{font-size:10px;fill:#DFE5EF}.ml-app .ml-time-series-explorer .ml-timeseries-chart .context-chart .values-line{stroke-width:1}.ml-app .ml-time-series-explorer .ml-timeseries-chart .context-chart .mask polygon{fill-opacity:.1}.ml-app .ml-time-series-explorer .ml-timeseries-chart .context-chart .mask .area.bounds{fill:#343741}.ml-app .ml-time-series-explorer .ml-timeseries-chart .context-chart .mask .values-line{stroke-width:1;stroke:#535966}.ml-app .ml-time-series-explorer .ml-timeseries-chart .swimlane .axis text{display:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .swimlane rect.swimlane-cell-hidden{display:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .brush .extent{fill-opacity:0;shape-rendering:crispEdges;stroke:#98A2B3;stroke-width:2;cursor:move}.ml-app .ml-time-series-explorer .ml-timeseries-chart .brush .extent:hover{opacity:1}.ml-app .ml-time-series-explorer .ml-timeseries-chart .top-border{fill:#1D1E24}.ml-app .ml-time-series-explorer .ml-timeseries-chart foreignObject.brush-handle{pointer-events:none;padding-top:1px}.ml-app .ml-time-series-explorer .ml-timeseries-chart div.brush-handle-inner{border:1px solid #98A2B3;background-color:#343741;height:70px;width:10px;text-align:center;cursor:ew-resize;margin-top:9px;font-size:14px;fill:#98A2B3}.ml-app .ml-time-series-explorer .ml-timeseries-chart div.brush-handle-inner-left{border-radius:4px 0 0 4px}.ml-app .ml-time-series-explorer .ml-timeseries-chart div.brush-handle-inner-right{border-radius:0 4px 4px 0}.ml-app .ml-time-series-explorer .ml-timeseries-chart rect.brush-handle{stroke-width:1;stroke:#98A2B3;fill:#343741;pointer-events:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart rect.brush-handle:hover{opacity:1}.ml-app .mlTimeSeriesExplorerProgress{background-color:#1D1E24}.ml-app .mlTimeSeriesExplorerProgress::-moz-progress-bar,.ml-app .mlTimeSeriesExplorerProgress::-webkit-progress-bar{background-color:#1D1E24}.ml-app .mlAnnotationBrush .extent{stroke:#343741;stroke-width:2px;stroke-dasharray:2 2;fill:#25262E;shape-rendering:geometricPrecision}.ml-app .mlAnnotationRect{stroke:#fff;stroke-width:2px;stroke-opacity:.2;transition:stroke-opacity 150ms;fill:#fff;fill-opacity:.05;transition:fill-opacity 150ms;shape-rendering:geometricPrecision}.ml-app .mlAnnotationRect-isHighlight{stroke-opacity:.4;transition:stroke-opacity 150ms;fill-opacity:.1;transition:fill-opacity 150ms}.ml-app .mlAnnotationRect-isBlur{stroke-opacity:.1;transition:stroke-opacity 150ms;fill-opacity:.025;transition:fill-opacity 150ms}.ml-app .mlAnnotationText{text-anchor:middle;font-size:12px;font-family:"Inter UI",-apple-system,BlinkMacSystemFont,"Segoe UI",Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";font-weight:500;fill:#fff;transition:fill 150ms;-webkit-user-select:none;user-select:none}.ml-app .mlAnnotationText-isBlur{fill:#535966;transition:fill 150ms}.ml-app .mlAnnotationTextRect{fill:#343741;transition:fill 150ms}.ml-app .mlAnnotationTextRect-isBlur{fill:#25262E;transition:fill 150ms}.ml-app .mlAnnotationHidden{display:none}.ml-app .mlContextAnnotationRect{stroke:#fff;stroke-width:2px;stroke-opacity:.2;transition:stroke-opacity 150ms;fill:#fff;fill-opacity:.05;transition:fill-opacity 150ms;shape-rendering:geometricPrecision}.ml-app .mlContextAnnotationRect-isBlur{stroke-opacity:.1;transition:stroke-opacity 150ms;fill-opacity:.025;transition:fill-opacity 150ms}.ml-app .euiDescriptionList.euiDescriptionList--column.ml-annotation-description-list .euiDescriptionList__title{flex-basis:30%}.ml-app .euiDescriptionList.euiDescriptionList--column.ml-annotation-description-list .euiDescriptionList__description{flex-basis:70%}.ml-app .euiDescriptionList.euiDescriptionList--column.ml-annotation-description-list>*{margin-top:4px}.ml-app .ml-anomalies-table .ml-icon-severity-critical,.ml-app .ml-anomalies-table .ml-icon-severity-major,.ml-app .ml-anomalies-table .ml-icon-severity-minor,.ml-app .ml-anomalies-table .ml-icon-severity-warning,.ml-app .ml-anomalies-table .ml-icon-severity-unknown{color:inherit;text-shadow:none}.ml-app .ml-anomalies-table .ml-icon-severity-critical .euiIcon{fill:#FE5050}.ml-app .ml-anomalies-table .ml-icon-severity-major .euiIcon{fill:#FBA740}.ml-app .ml-anomalies-table .ml-icon-severity-minor .euiIcon{fill:#FDEC25}.ml-app .ml-anomalies-table .ml-icon-severity-warning .euiIcon{fill:#8BC8FB}.ml-app .ml-anomalies-table .ml-icon-severity-unknown .euiIcon{fill:#98A2B3}.ml-app .ml-anomalies-table tr th:first-child,.ml-app .ml-anomalies-table tr td:first-child{width:32px}.ml-app .ml-anomalies-table .euiTableCellContent .euiHealth{font-size:inherit}.ml-app .ml-anomalies-table .euiTableCellContent .detector-rules-icon{margin-left:4px;opacity:.5}.ml-app .ml-anomalies-table .euiContextMenuItem{min-width:150px}.ml-app .ml-anomalies-table .mlAnomalyCategoryExamples__header{display:inline}.ml-app .ml-anomalies-table .mlAnomalyCategoryExamples__link{width:100%}.ml-app .ml-anomalies-table .category-example{display:block;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.ml-app .ml-anomalies-table .mlAnomalyCategoryExamples{padding:24px}.ml-app .ml-anomalies-table .mlAnomalyCategoryExamples__item{display:block;white-space:wrap;font-family:"Roboto Mono",Consolas,Menlo,Courier,monospace}.ml-app .ml-anomalies-table .interim-result{font-style:italic}.ml-app .ml-anomalies-table .ml-anomalies-table-details{padding:4px 32px;max-height:1000px;overflow-y:auto}.ml-app .ml-anomalies-table .ml-anomalies-table-details .anomaly-description-list .euiDescriptionList__title{margin-top:0;flex-basis:15%;font-size:inherit;line-height:1.5rem;max-width:100%;overflow:hidden !important;text-overflow:ellipsis !important;white-space:nowrap !important;word-wrap:normal !important}.ml-app .ml-anomalies-table .ml-anomalies-table-details .anomaly-description-list .euiDescriptionList__description{margin-top:0;flex-basis:85%;font-size:inherit;line-height:1.5rem}.ml-app .mlColorRangeLegend text{font-size:10px;font-size:.625rem;fill:#98A2B3}.ml-app .mlColorRangeLegend .axis path{fill:none;stroke:none}.ml-app .mlColorRangeLegend .axis line{fill:none;stroke:#535966;shape-rendering:crispEdges}.ml-app .ml-table-controls label{font-size:12px;padding:0 0 4px 4px}.ml-app .ml-table-controls .ml-table-controls-element{display:inline-block;padding-left:16px}.ml-app .ml-table-controls select{font-size:12px;font-style:normal}.ml-app .ml-select-severity .euiFormControlLayoutClearButton{display:none}.ml-app .field-value-short{max-width:100%;overflow:hidden !important;text-overflow:ellipsis !important;white-space:nowrap !important;word-wrap:normal !important;display:inline-block;vertical-align:bottom}.ml-app .field-value-long{overflow-wrap:break-word}.ml-app .filter-button{opacity:.5;width:16px;height:16px;transform:translateY(-1px)}.ml-app .filter-button .euiIcon{width:12px;height:12px}.ml-app .filter-button:hover{opacity:1}.ml-app .ml-influencers-list{line-height:1.45}.ml-app .ml-influencers-list .field-label{font-size:12px;text-align:left;max-height:14px;max-width:calc(100% - 102px)}.ml-app .ml-influencers-list .field-label .field-value{max-width:100%;overflow:hidden !important;text-overflow:ellipsis !important;white-space:nowrap !important;word-wrap:normal !important;display:inline-block;vertical-align:bottom}.ml-app .ml-influencers-list .progress{display:inline-block;width:calc(100% - 34px);height:22px;min-width:70px;margin-bottom:0;color:#98A2B3;background-color:transparent}.ml-app .ml-influencers-list .progress .progress-bar-holder{width:calc(100% - 28px)}.ml-app .ml-influencers-list .progress .progress-bar{height:2px;margin-top:12px;text-align:right;line-height:18px;display:inline-block;transition:none}.ml-app .ml-influencers-list .progress.critical .progress-bar{background-color:#FE5050}.ml-app .ml-influencers-list .progress.critical .score-label{border-color:#FE5050}.ml-app .ml-influencers-list .progress.major .progress-bar{background-color:#FBA740}.ml-app .ml-influencers-list .progress.major .score-label{border-color:#FBA740}.ml-app .ml-influencers-list .progress.minor .progress-bar{background-color:#FDEC25}.ml-app .ml-influencers-list .progress.minor .score-label{border-color:#FDEC25}.ml-app .ml-influencers-list .progress.warning .progress-bar{background-color:#8BC8FB}.ml-app .ml-influencers-list .progress.warning .score-label{border-color:#8BC8FB}.ml-app .ml-influencers-list .score-label{text-align:center;line-height:14px;white-space:nowrap;font-size:12px;display:inline;margin-left:4px}.ml-app .ml-influencers-list .total-score-label{width:32px;vertical-align:top;text-align:center;color:#98A2B3;font-size:11px;line-height:14px;border-radius:4px;padding:2px;margin-top:4px;display:inline-block;border:1px solid #343741}.ml-app .ml-influencers-list-tooltip{word-break:break-all}.ml-app .ml-items-grid-page-size-menu{width:140px}.ml-app .mlJobSelectorBar{padding:8px}.ml-app .mlJobSelectorFlyoutBody>.euiFlyoutBody__overflow{padding-top:8px}.ml-app .mlJobSelector__ganttBar{background-color:#79ADDA;height:12px;border-radius:2px}.ml-app .mlJobSelector__ganttBarBackEdge{height:16px;border-left:1px solid #D6D6D6;border-right:1px solid #D6D6D6;margin-bottom:-14px;padding-top:8px}.ml-app .mlJobSelector__ganttBarDashed{height:1px;border-top:1px dashed #D6D6D6}.ml-app .mlJobSelector__ganttBarRunning{background-image:linear-gradient(45deg, rgba(255,255,255,0.15) 25%, transparent 25%, transparent 50%, rgba(255,255,255,0.15) 50%, rgba(255,255,255,0.15) 75%, transparent 75%, transparent);background-size:40px 40px;animation:progress-bar-stripes 2s linear infinite}.ml-app .ml-loading-indicator{text-align:center;font-size:17px;display:flex;flex-direction:column;align-items:center;justify-content:center}.ml-app .ml-rule-editor-flyout{font-size:14px}.ml-app .ml-rule-editor-flyout .select-rule-action .rule-detector-description-list{padding-left:16px}.ml-app .ml-rule-editor-flyout .select-rule-action-panel{padding:8px 0}.ml-app .ml-rule-editor-flyout .select-rule-action-panel .euiDescriptionList .euiDescriptionList__title{flex-basis:15%;padding:0 16px}.ml-app .ml-rule-editor-flyout .select-rule-action-panel .euiDescriptionList .euiDescriptionList__description{flex-basis:85%}.ml-app .ml-rule-editor-flyout .select-rule-action-panel .euiDescriptionList .euiDescriptionList__title:nth-child(1),.ml-app .ml-rule-editor-flyout .select-rule-action-panel .euiDescriptionList .euiDescriptionList__description:nth-child(2){color:#DFE5EF;font-weight:700;border-bottom:1px solid #343741;padding-bottom:12px}.ml-app .ml-rule-editor-flyout .select-rule-action-panel .euiDescriptionList .euiDescriptionList__title:nth-child(3),.ml-app .ml-rule-editor-flyout .select-rule-action-panel .euiDescriptionList .euiDescriptionList__description:nth-child(4){padding-top:8px}.ml-app .ml-rule-editor-flyout .select-rule-action-panel .euiDescriptionList.euiDescriptionList--column>*{margin-top:4px}.ml-app .ml-rule-editor-flyout .scope-enable-checkbox .euiCheckbox__input[disabled] ~ .euiCheckbox__label{color:inherit}.ml-app .ml-rule-editor-flyout .scope-field-checkbox{margin-right:2px}.ml-app .ml-rule-editor-flyout .scope-field-checkbox .euiCheckbox{margin-top:4px}.ml-app .ml-rule-editor-flyout .scope-field-button{pointer-events:none;border-bottom:none}.ml-app .ml-rule-editor-flyout .scope-edit-filter-link{line-height:32px;font-size:12px}.ml-app .ml-rule-editor-flyout .condition-edit-value-field{width:170px;height:28px;margin:0 2px}.ml-app .ml-rule-editor-flyout .condition-edit-value-field input{height:28px}.ml-app .ml-rule-editor-flyout .euiExpressionButton.disabled{pointer-events:none}.ml-app .ml-rule-editor-flyout .euiExpressionButton.disabled .euiExpressionButton__value,.ml-app .ml-rule-editor-flyout .euiExpressionButton.disabled .euiExpressionButton__description{color:#343741}.ml-app .ml-rule-editor-flyout .text-highlight{font-weight:700}.ml-app .euiDescriptionList.euiDescriptionList--column.rule-detector-description-list .euiDescriptionList__title{flex-basis:15%}.ml-app .euiDescriptionList.euiDescriptionList--column.rule-detector-description-list .euiDescriptionList__description{flex-basis:85%}.ml-app .euiDescriptionList.euiDescriptionList--column.rule-detector-description-list>*{margin-top:4px}.ml-app .stat{margin-right:8px}.ml-app .mlStatsBar{height:42px;padding:14px;background-color:#25262E}.ml-app .mlEmbeddedMapContent{width:100%;height:100%;display:flex;flex:1 1 100%;z-index:1;min-height:0}.ml-app .tab-datavisualizer_index_select,.ml-app .tab-timeseriesexplorer,.ml-app .tab-explorer{background-color:#1D1E24}.ml-app .button-wrapper{display:inline}.ml-app .button-wrapper.disabled .kuiButton[disabled]{pointer-events:none}.ml-app .button-wrapper.disabled{cursor:not-allowed}.ml-app .clear,.ml-app .clearfix{clear:both}.ml-app .mlDisableAntiAliasing{-webkit-font-smoothing:none}.ml-app .mlDisableAntiAliasing * canvas{image-rendering:pixelated}\n',""]),e.exports=t},function(e,t,a){var i=a(68),n=a(396);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var s={insert:"head",singleton:!1};i(n,s);e.exports=n.locals||{}},function(e,t,a){(t=a(69)(!1)).push([e.i,'.ml-app .ml-icon-severity-critical,.ml-app .ml-icon-severity-major,.ml-app .ml-icon-severity-minor,.ml-app .ml-icon-severity-warning,.ml-app .ml-icon-severity-unknown{text-shadow:1px 1px 1px #D3DAE6}.ml-app .ml-icon-severity-critical{color:#cf4141}.ml-app .ml-icon-severity-major{color:#9e6929}.ml-app .ml-icon-severity-minor{color:#7c7313}.ml-app .ml-icon-severity-warning{color:#537896}.ml-app .ml-icon-severity-unknown{color:#69707D}.ml-app .mlDataFrameAnalyticsRegression__evaluateStat{padding-top:24px}.ml-app .mlJobMapLegend__container{background-color:\'#FFFFFF\'}.ml-app .mlJobMapLegend__indexPattern{height:12px;width:12px;background-color:#fff;border:2px solid #D36086;transform:rotate(45deg);display:\'inline-block\'}.ml-app .mlJobMapLegend__transform{height:12px;width:12px;background-color:#fff;border:2px solid #6092C0;display:\'inline-block\'}.ml-app .mlJobMapLegend__analytics{height:12px;width:12px;background-color:#fff;border:2px solid #54B399;border-radius:50%;display:\'inline-block\'}.ml-app .mlJobMapLegend__sourceNode{height:12px;width:12px;background-color:#F5A700;border:1px solid #D3DAE6;border-radius:4px;display:\'inline-block\'}.ml-app .mlAnalyticsTable .euiTableRow-isExpandedRow .euiTableCellContent{animation:none !important}.ml-app .mlAnalyticsTable .euiTableRow-isExpandedRow .euiTableCellContent .euiTableCellContent__text{width:100%}.ml-app .mlAnalyticsTable .euiIcon-isLoaded{animation:none !important}.ml-app .mlTaskStateBadge,.ml-app .mlTaskModeBadge{max-width:100px}.ml-app .dataFrameAnalyticsCreateSearchDialog{width:720px;min-height:600px}.ml-app .dfAnalyticsCreationWizard__card{width:300px}.ml-app .ml-explorer{width:100%;display:inline-block;color:#69707D}.ml-app .ml-explorer .mlAnomalyExplorer__filterBar{padding-right:16px;padding-left:16px}.ml-app .ml-explorer .results-container{padding:0 0 16px 0}.ml-app .ml-explorer .results-container .col-xs-12{width:calc(100% - 32px);padding-left:16px}.ml-app .ml-explorer .results-container .no-influencers-warning{float:left;padding-top:4px;padding-left:16px;color:#69707D;font-size:14px}.ml-app .ml-explorer .results-container .panel-title{font-size:18px;font-weight:400;color:#69707D;display:inline-block;padding-bottom:4px}.ml-app .ml-explorer .results-container .panel-sub-title{color:#69707D;font-size:12px}.ml-app .mlSwimLaneContainer .echLegendListContainer{height:34px !important}.ml-app .mlSwimLaneContainer .echLegendList{display:flex !important;justify-content:space-between !important;flex-wrap:nowrap;position:absolute;right:0}.ml-app .ml-explorer-chart-eui-icon-tip{max-width:none}.ml-app .ml-explorer-chart-label-badges{margin-top:4px;display:flex;align-items:center}.ml-app .ml-reset-font-weight{font-weight:normal}.ml-app .ml-explorer-chart-container{overflow:hidden}.ml-app .ml-explorer-chart-container .ml-explorer-chart-svg{font-size:12px;font-family:"Inter UI",-apple-system,BlinkMacSystemFont,"Segoe UI",Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol"}.ml-app .ml-explorer-chart-container .ml-explorer-chart-svg .line-chart rect{fill:#fff;opacity:1}.ml-app .ml-explorer-chart-container .ml-explorer-chart-svg .line-chart rect.selected-interval{fill:rgba(200,200,200,0.1);stroke:#69707D;stroke-width:2px;stroke-opacity:.8}.ml-app .ml-explorer-chart-container .ml-explorer-chart-svg .line-chart rect.scheduled-event-marker{stroke-width:1px;stroke:#69707D;fill:#D3DAE6;pointer-events:none}.ml-app .ml-explorer-chart-container .axis path,.ml-app .ml-explorer-chart-container .axis line{fill:none;stroke:#D3DAE6;shape-rendering:crispEdges}.ml-app .ml-explorer-chart-container .axis .tick line.ml-tick-emphasis{stroke:rgba(0,0,0,0.2)}.ml-app .ml-explorer-chart-container .axis text{fill:#69707D}.ml-app .ml-explorer-chart-container .axis .tick line{stroke:#D3DAE6;stroke-width:1px}.ml-app .ml-explorer-chart-container .values-line{fill:none;stroke:#006BB4;stroke-width:2}.ml-app .ml-explorer-chart-container .values-dots circle,.ml-app .ml-explorer-chart-container .values-dots-circle{fill:#006BB4;stroke-width:0}.ml-app .ml-explorer-chart-container .values-dots circle.values-dots-circle-blur{fill:#98A2B3}.ml-app .ml-explorer-chart-container .metric-value{opacity:1;fill:transparent;stroke:#006BB4;stroke-width:0}.ml-app .ml-explorer-chart-container .anomaly-marker{stroke-width:1px;stroke:#98A2B3}.ml-app .ml-explorer-chart-container .anomaly-marker:hover{stroke-width:6px;stroke:#006BB4}.ml-app .ml-explorer-chart-container .anomaly-marker.critical{fill:#FE5050}.ml-app .ml-explorer-chart-container .anomaly-marker.major{fill:#FBA740}.ml-app .ml-explorer-chart-container .anomaly-marker.minor{fill:#FDEC25}.ml-app .ml-explorer-chart-container .anomaly-marker.warning{fill:#8BC8FB}.ml-app .ml-explorer-chart-container .anomaly-marker.low{fill:#D2E9F7}.ml-app .ml-explorer-chart-container .metric-value:hover,.ml-app .ml-explorer-chart-container .anomaly-marker:hover{stroke-width:6px;stroke-opacity:.65}.ml-app .ml-explorer-chart{overflow:hidden}.ml-app .ml-explorer-chart-content-wrapper{height:215px}.ml-app .ml-explorer-chart-axis-emphasis{font-weight:bold}.ml-app .explorer-charts ml-explorer-charts-container .row{padding:10px}.ml-app .explorer-charts ml-explorer-charts-container label{font-size:12px}.ml-app .explorer-charts ml-explorer-charts-container select{font-size:14px;font-style:400}.ml-app .explorer-charts ml-explorer-charts-container .chart-controls label{padding:0 0 10px 0}.ml-app .explorer-charts ml-explorer-charts-container .no-results-item{text-align:center;padding-top:10px}.ml-app .explorer-charts ml-explorer-charts-container .ml-anomaly-interim-result{font-style:italic;padding-bottom:3px}.ml-app .explorer-charts ml-explorer-charts-container .ml-tablerow-expanded{width:100%;padding:5px 20px;overflow:hidden;font-size:12px}.ml-app .explorer-charts ml-explorer-charts-container .ml-tablerow-expanded td{padding:0 0 2px 0}.ml-app .explorer-charts ml-explorer-charts-container .ml-tablerow-expanded table tr>td:first-child{padding-left:2px;vertical-align:top}.ml-app .explorer-charts ml-explorer-charts-container .ml-tablerow-expanded td:first-child{width:140px}.ml-app .explorer-charts ml-explorer-charts-container .ml-tablerow-expanded td:nth-child(2){padding-left:5px}.ml-app .ml-explorer-chart-icons{float:right;padding-left:5px;margin:2px -8px 0 0}.ml-app .ml-edit-url-form .url-label{width:250px}.ml-app .ml-edit-url-form .url-link-to-radio .euiRadio{display:inline-block;padding-right:24px}.ml-app .ml-edit-url-form .url-time-range{width:150px}.ml-app .new-job-button-container{float:right}.ml-app .edit-custom-url-panel .close-editor-button{position:relative;float:right;top:-4px;right:0}.ml-app .tab-contents{margin:-8px;padding:8px;background-color:#fff}.ml-app .tab-contents .col-md-6:nth-child(1){padding-right:7px}.ml-app .tab-contents .col-md-6:nth-child(2){padding-left:7px}.ml-app .tab-contents .job-section{overflow:auto;padding:5px 15px;background-color:#F5F7FA;border:1px solid #D3DAE6;border-radius:4px;margin:4px 0}.ml-app .tab-contents .job-section .euiTable{background-color:transparent}.ml-app .tab-contents .job-section .euiTable .euiTableRow:first-child .euiTableRowCell{border-top:0}.ml-app .tab-contents .job-section .euiTable .euiTableRow:last-child .euiTableRowCell{border-bottom:0}.ml-app .tab-contents .job-section .euiTable .euiTableRow .euiTableRowCell{vertical-align:top;border-bottom:1px solid #D3DAE6}.ml-app .tab-contents .job-section .euiTable .euiTableRow .euiTableRowCell .euiTableCellContent__text{word-wrap:break-word}.ml-app .tab-contents .job-section .euiTable .euiTableRow:hover{background-color:inherit}.ml-app .tab-contents .job-section .job-item{font-size:12px}.ml-app .tab-contents .job-section .job-item.header{font-weight:bold}.ml-app .tab-contents .json-textarea{height:500px}.ml-app .job-messages-table{max-height:500px;overflow:auto;text-align:left}.ml-app .job-messages-table tr:last-child td{border-bottom:none}.ml-app .job-messages-table .euiTableRowCell{background-color:#fff}.ml-app .mlJobFilterBar .euiFilterGroup .euiPopover .euiPanel .group-item{padding:8px 16px}.ml-app .mlJobFilterBar .euiFilterGroup .euiPopover .euiPanel .inline-group{border:1px solid #fff;border-radius:4px}.ml-app .mlJobFilterBar .euiFilterGroup .euiPopover .euiPanel .euiFilterSelectItem:hover,.ml-app .mlJobFilterBar .euiFilterGroup .euiPopover .euiPanel .euiFilterSelectItem:focus{text-decoration:none}.ml-app .mlJobFilterBar .euiFilterGroup .euiPopover .euiPanel .euiFilterSelectItem:hover .inline-group,.ml-app .mlJobFilterBar .euiFilterGroup .euiPopover .euiPanel .euiFilterSelectItem:focus .inline-group{border:1px solid #69707D;box-shadow:0 1px 2px #98A2B3}.ml-app .inline-group{font-size:12px;background-color:#D3DAE6;padding:2px 5px;border-radius:2px;display:inline-block;margin:0 3px;color:#fff;vertical-align:text-top}.ml-app .jobs-list-table>div>.euiTable>thead th{text-align:left;white-space:normal}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(2){width:34px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(3){width:auto}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(4){width:20px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(5){width:auto}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(6){width:100px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(7){width:85px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(8){width:80px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(9){width:80px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(10){width:150px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(11){width:80px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(12){width:30px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(12) .euiTableCellContent__text{display:none}.ml-app .jobs-list-table>div>.euiTable>tbody td:nth-child(4) .euiTableCellContent{padding:0}.ml-app .jobs-list-table>div>.euiTable>tbody td:nth-child(10){white-space:nowrap}.ml-app .jobs-list-table>div>.euiTable>tbody .euiTableCellContent{animation:unset}.ml-app .jobs-list-table>div>.euiTable>tbody .euiTableRow.euiTableRow-isExpandedRow>td>div>.euiTableCellContent__text{width:100%}.ml-app .jobs-list-table>div>.euiTable>tbody .euiTableRow.euiTableRow-isExpandedRow>td>div>.euiTableCellContent__text .euiTableRowCell{background-color:inherit}.ml-app .jobs-list-table>div>.euiTable>tbody .euiTableRow>.euiTableRowCell>.euiTableCellContent>.euiTableCellContent__hoverItem{opacity:1}.ml-app .jobs-list-table>div>.euiTable>tbody .euiContextMenuPanel .euiContextMenuItem{white-space:nowrap}.ml-app .jobs-list-table>div>.euiTable>tbody .euiContextMenuPanel .euiContextMenuItem:last-child:not(.euiContextMenuItem-isDisabled){color:#BD271E}.ml-app .jobs-list-table>div>.euiTable>tbody .results-button{margin-right:4px;width:18px}.ml-app .jobs-list-table>div>.euiTable>tbody .euiContextMenuItem .euiIcon{margin-right:4px}.ml-app .jobs-list-table>div>.euiTable .job-description{display:inline-block}.ml-app .jobs-list-table>div>.euiTable .job-loading-spinner{text-align:center}.ml-app .jobs-list-table.jobs-selected .results-button{color:#D3DAE6;pointer-events:none}.ml-app .actions-bar{min-height:60px;display:flex;align-items:center}.ml-app .job-management{padding:20px}.ml-app .multi-select-actions .actions-border,.ml-app .multi-select-actions .actions-border-large{height:20px;border-right:1px solid #D3DAE6;width:1px;display:inline-block;vertical-align:middle;margin:0 5px}.ml-app .multi-select-actions .actions-border-large{height:35px;margin:0 15px}.ml-app .multi-select-actions .results-button{margin-right:5px}.ml-app .multi-select-actions .euiContextMenuPanel .euiContextMenuItem__text{white-space:nowrap}.ml-app .multi-select-actions .euiContextMenuPanel .euiContextMenuItem:last-child:not(.euiContextMenuItem-isDisabled){color:#BD271E}.ml-app .multi-select-actions-no-display{display:none}.ml-app .group-selector{max-width:300px}.ml-app .group-selector .euiPopoverTitle{margin-bottom:8px !important}.ml-app .group-list{max-height:350px;overflow:auto}.ml-app .group-list .group-item{line-height:18px;padding:6px 0;border-bottom:1px solid #D3DAE6;cursor:pointer}.ml-app .group-list .group-item:focus{background-color:#EEF6F9;box-shadow:none}.ml-app .group-list .group-item .check{width:20px;display:inline-block}.ml-app .group-list .group-item .inline-group{border:1px solid #fff;border-radius:4px}.ml-app .group-list .group-item:hover .inline-group{border:1px solid #69707D;box-shadow:0 1px 2px #98A2B3}.ml-app .group-list .group-item:last-child{margin-bottom:0;border-bottom:none}.ml-app .new-group-input{padding-bottom:0}.ml-app .ml-custom-urls-selection>.euiFlexGroup>.euiFlexItem:first-child{max-width:388px}.ml-app .ml-custom-urls-selection>.euiFlexGroup>.euiFlexItem:last-child{flex-basis:50%}.ml-app .mlOverviewPanel{padding-top:0}.ml-app .mlOverviewPanel__isLoading{text-align:center;padding:10%}.ml-app .mlOverviewPanel__buttons{float:right}.ml-app .mlOverviewPanel__spinner{display:inline-block}.ml-app .mlOverviewPanel__refreshButton{padding-right:12px}.ml-app .mlOverviewPanel__statsBar{margin-top:0;margin-right:0}.ml-app .mlSettingsPage .mlSettingsPage__header{width:1200px;margin-left:auto;margin-right:auto}.ml-app .mlSettingsPage .mlSettingsPage__content{width:1200px;margin-top:16px;margin-bottom:16px}.ml-app .ml-list-filter-lists .ml-list-filter-lists-content{max-width:1100px;margin-top:16px;margin-bottom:16px}.ml-app .ml-list-filter-lists .ml-filter-lists-table th:last-child,.ml-app .ml-list-filter-lists .ml-filter-lists-table td:last-child{width:70px}.ml-app .ml-edit-filter-lists .ml-edit-filter-lists-content{max-width:1100px;width:100%;margin-top:16px;margin-bottom:16px}.ml-app .ml-edit-filter-lists .ml-filter-list-usage>div{display:inline}.ml-app .ml-edit-filter-lists .ml-filter-list-usage .euiButtonEmpty.euiButtonEmpty--small{padding-bottom:4px}.ml-app .ml-edit-filter-lists .ml-filter-list-usage .euiButtonEmpty .euiButtonEmpty__content{padding:0 4px}.ml-app .ml-add-filter-item-popover .euiFormRow{width:300px;padding-bottom:4px}.ml-app .ml-filter-list-usage-popover li{line-height:24px}.ml-app .mlCalendarEditForm .mlCalendarEditForm__content{max-width:1200px;width:100%;margin-top:16px;margin-bottom:16px}.ml-app .mlCalendarList .mlCalendarList__content{max-width:1200px;margin-top:16px;margin-bottom:16px}.ml-app .ml-time-series-explorer{color:#69707D}.ml-app .ml-time-series-explorer .results-container .panel-title{font-size:18px;font-weight:400;color:#69707D}.ml-app .ml-time-series-explorer .results-container .entity-count-text{color:#017D73;font-size:14px}.ml-app .ml-time-series-explorer .forecast-controls{float:right}.ml-app .ml-time-series-explorer .ml-timeseries-chart svg{font-size:12px;font-family:"Inter UI",-apple-system,BlinkMacSystemFont,"Segoe UI",Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol"}.ml-app .ml-time-series-explorer .ml-timeseries-chart .axis path,.ml-app .ml-time-series-explorer .ml-timeseries-chart .axis line{fill:none;stroke:#D3DAE6;shape-rendering:crispEdges;pointer-events:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .axis text{fill:#343741}.ml-app .ml-time-series-explorer .ml-timeseries-chart .axis .tick line{stroke:#D3DAE6}.ml-app .ml-time-series-explorer .ml-timeseries-chart .chart-border{stroke:#D3DAE6;fill:none;stroke-width:1;shape-rendering:crispEdges}.ml-app .ml-time-series-explorer .ml-timeseries-chart .chart-border-highlight{stroke:#69707D;stroke-width:2}.ml-app .ml-time-series-explorer .ml-timeseries-chart .chart-border-highlight:hover{opacity:1}.ml-app .ml-time-series-explorer .ml-timeseries-chart .area{stroke-width:1}.ml-app .ml-time-series-explorer .ml-timeseries-chart .area.bounds{fill:rgba(0,107,180,0.2);pointer-events:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .values-line{fill:none;stroke:#006BB4;stroke-width:2;pointer-events:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .values-line.forecast{stroke:#D6BF57;pointer-events:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .hidden{visibility:hidden}.ml-app .ml-time-series-explorer .ml-timeseries-chart .area.forecast{fill:rgba(214,191,87,0.3);pointer-events:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .metric-value{opacity:1;fill:transparent;stroke:#006BB4;stroke-width:0}.ml-app .ml-time-series-explorer .ml-timeseries-chart .anomaly-marker{stroke-width:1px;stroke:#98A2B3}.ml-app .ml-time-series-explorer .ml-timeseries-chart .anomaly-marker.critical{fill:#FE5050}.ml-app .ml-time-series-explorer .ml-timeseries-chart .anomaly-marker.major{fill:#FBA740}.ml-app .ml-time-series-explorer .ml-timeseries-chart .anomaly-marker.minor{fill:#FDEC25}.ml-app .ml-time-series-explorer .ml-timeseries-chart .anomaly-marker.warning{fill:#8BC8FB}.ml-app .ml-time-series-explorer .ml-timeseries-chart .anomaly-marker.low{fill:#D2E9F7}.ml-app .ml-time-series-explorer .ml-timeseries-chart .metric-value:hover,.ml-app .ml-time-series-explorer .ml-timeseries-chart .anomaly-marker:hover,.ml-app .ml-time-series-explorer .ml-timeseries-chart .anomaly-marker.highlighted{stroke-width:6px;stroke-opacity:.65;stroke:#006BB4}.ml-app .ml-time-series-explorer .ml-timeseries-chart rect.scheduled-event-marker{stroke-width:1px;stroke:#69707D;fill:#D3DAE6;pointer-events:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .forecast .metric-value,.ml-app .ml-time-series-explorer .ml-timeseries-chart .forecast .metric-value:hover{stroke:#D6BF57}.ml-app .ml-time-series-explorer .ml-timeseries-chart .focus-chart .x-axis-background line{fill:none;shape-rendering:crispEdges;stroke:#F5F7FA}.ml-app .ml-time-series-explorer .ml-timeseries-chart .focus-chart .x-axis-background rect{fill:#F5F7FA}.ml-app .ml-time-series-explorer .ml-timeseries-chart .focus-chart .focus-zoom{fill:#69707D}.ml-app .ml-time-series-explorer .ml-timeseries-chart .focus-chart .focus-zoom a text{fill:#006BB4;cursor:pointer}.ml-app .ml-time-series-explorer .ml-timeseries-chart .focus-chart .focus-zoom a:hover,.ml-app .ml-time-series-explorer .ml-timeseries-chart .focus-chart .focus-zoom a:active,.ml-app .ml-time-series-explorer .ml-timeseries-chart .focus-chart .focus-zoom a:focus{text-decoration:underline}.ml-app .ml-time-series-explorer .ml-timeseries-chart .context-chart .x.axis path{display:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .context-chart .axis text{font-size:10px;fill:#343741}.ml-app .ml-time-series-explorer .ml-timeseries-chart .context-chart .values-line{stroke-width:1}.ml-app .ml-time-series-explorer .ml-timeseries-chart .context-chart .mask polygon{fill-opacity:.1}.ml-app .ml-time-series-explorer .ml-timeseries-chart .context-chart .mask .area.bounds{fill:#D3DAE6}.ml-app .ml-time-series-explorer .ml-timeseries-chart .context-chart .mask .values-line{stroke-width:1;stroke:#98A2B3}.ml-app .ml-time-series-explorer .ml-timeseries-chart .swimlane .axis text{display:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .swimlane rect.swimlane-cell-hidden{display:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .brush .extent{fill-opacity:0;shape-rendering:crispEdges;stroke:#69707D;stroke-width:2;cursor:move}.ml-app .ml-time-series-explorer .ml-timeseries-chart .brush .extent:hover{opacity:1}.ml-app .ml-time-series-explorer .ml-timeseries-chart .top-border{fill:#fff}.ml-app .ml-time-series-explorer .ml-timeseries-chart foreignObject.brush-handle{pointer-events:none;padding-top:1px}.ml-app .ml-time-series-explorer .ml-timeseries-chart div.brush-handle-inner{border:1px solid #69707D;background-color:#D3DAE6;height:70px;width:10px;text-align:center;cursor:ew-resize;margin-top:9px;font-size:14px;fill:#69707D}.ml-app .ml-time-series-explorer .ml-timeseries-chart div.brush-handle-inner-left{border-radius:4px 0 0 4px}.ml-app .ml-time-series-explorer .ml-timeseries-chart div.brush-handle-inner-right{border-radius:0 4px 4px 0}.ml-app .ml-time-series-explorer .ml-timeseries-chart rect.brush-handle{stroke-width:1;stroke:#69707D;fill:#D3DAE6;pointer-events:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart rect.brush-handle:hover{opacity:1}.ml-app .mlTimeSeriesExplorerProgress{background-color:#fff}.ml-app .mlTimeSeriesExplorerProgress::-moz-progress-bar,.ml-app .mlTimeSeriesExplorerProgress::-webkit-progress-bar{background-color:#fff}.ml-app .mlAnnotationBrush .extent{stroke:#D3DAE6;stroke-width:2px;stroke-dasharray:2 2;fill:#F5F7FA;shape-rendering:geometricPrecision}.ml-app .mlAnnotationRect{stroke:#000;stroke-width:2px;stroke-opacity:.2;transition:stroke-opacity 150ms;fill:#000;fill-opacity:.05;transition:fill-opacity 150ms;shape-rendering:geometricPrecision}.ml-app .mlAnnotationRect-isHighlight{stroke-opacity:.4;transition:stroke-opacity 150ms;fill-opacity:.1;transition:fill-opacity 150ms}.ml-app .mlAnnotationRect-isBlur{stroke-opacity:.1;transition:stroke-opacity 150ms;fill-opacity:.025;transition:fill-opacity 150ms}.ml-app .mlAnnotationText{text-anchor:middle;font-size:12px;font-family:"Inter UI",-apple-system,BlinkMacSystemFont,"Segoe UI",Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";font-weight:500;fill:#000;transition:fill 150ms;-webkit-user-select:none;user-select:none}.ml-app .mlAnnotationText-isBlur{fill:#98A2B3;transition:fill 150ms}.ml-app .mlAnnotationTextRect{fill:#D3DAE6;transition:fill 150ms}.ml-app .mlAnnotationTextRect-isBlur{fill:#F5F7FA;transition:fill 150ms}.ml-app .mlAnnotationHidden{display:none}.ml-app .mlContextAnnotationRect{stroke:#000;stroke-width:2px;stroke-opacity:.2;transition:stroke-opacity 150ms;fill:#000;fill-opacity:.05;transition:fill-opacity 150ms;shape-rendering:geometricPrecision}.ml-app .mlContextAnnotationRect-isBlur{stroke-opacity:.1;transition:stroke-opacity 150ms;fill-opacity:.025;transition:fill-opacity 150ms}.ml-app .euiDescriptionList.euiDescriptionList--column.ml-annotation-description-list .euiDescriptionList__title{flex-basis:30%}.ml-app .euiDescriptionList.euiDescriptionList--column.ml-annotation-description-list .euiDescriptionList__description{flex-basis:70%}.ml-app .euiDescriptionList.euiDescriptionList--column.ml-annotation-description-list>*{margin-top:4px}.ml-app .ml-anomalies-table .ml-icon-severity-critical,.ml-app .ml-anomalies-table .ml-icon-severity-major,.ml-app .ml-anomalies-table .ml-icon-severity-minor,.ml-app .ml-anomalies-table .ml-icon-severity-warning,.ml-app .ml-anomalies-table .ml-icon-severity-unknown{color:inherit;text-shadow:none}.ml-app .ml-anomalies-table .ml-icon-severity-critical .euiIcon{fill:#cf4141}.ml-app .ml-anomalies-table .ml-icon-severity-major .euiIcon{fill:#9e6929}.ml-app .ml-anomalies-table .ml-icon-severity-minor .euiIcon{fill:#7c7313}.ml-app .ml-anomalies-table .ml-icon-severity-warning .euiIcon{fill:#537896}.ml-app .ml-anomalies-table .ml-icon-severity-unknown .euiIcon{fill:#69707D}.ml-app .ml-anomalies-table tr th:first-child,.ml-app .ml-anomalies-table tr td:first-child{width:32px}.ml-app .ml-anomalies-table .euiTableCellContent .euiHealth{font-size:inherit}.ml-app .ml-anomalies-table .euiTableCellContent .detector-rules-icon{margin-left:4px;opacity:.5}.ml-app .ml-anomalies-table .euiContextMenuItem{min-width:150px}.ml-app .ml-anomalies-table .mlAnomalyCategoryExamples__header{display:inline}.ml-app .ml-anomalies-table .mlAnomalyCategoryExamples__link{width:100%}.ml-app .ml-anomalies-table .category-example{display:block;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.ml-app .ml-anomalies-table .mlAnomalyCategoryExamples{padding:24px}.ml-app .ml-anomalies-table .mlAnomalyCategoryExamples__item{display:block;white-space:wrap;font-family:"Roboto Mono",Consolas,Menlo,Courier,monospace}.ml-app .ml-anomalies-table .interim-result{font-style:italic}.ml-app .ml-anomalies-table .ml-anomalies-table-details{padding:4px 32px;max-height:1000px;overflow-y:auto}.ml-app .ml-anomalies-table .ml-anomalies-table-details .anomaly-description-list .euiDescriptionList__title{margin-top:0;flex-basis:15%;font-size:inherit;line-height:1.5rem;max-width:100%;overflow:hidden !important;text-overflow:ellipsis !important;white-space:nowrap !important;word-wrap:normal !important}.ml-app .ml-anomalies-table .ml-anomalies-table-details .anomaly-description-list .euiDescriptionList__description{margin-top:0;flex-basis:85%;font-size:inherit;line-height:1.5rem}.ml-app .mlColorRangeLegend text{font-size:10px;font-size:.625rem;fill:#69707D}.ml-app .mlColorRangeLegend .axis path{fill:none;stroke:none}.ml-app .mlColorRangeLegend .axis line{fill:none;stroke:#98A2B3;shape-rendering:crispEdges}.ml-app .ml-table-controls label{font-size:12px;padding:0 0 4px 4px}.ml-app .ml-table-controls .ml-table-controls-element{display:inline-block;padding-left:16px}.ml-app .ml-table-controls select{font-size:12px;font-style:normal}.ml-app .ml-select-severity .euiFormControlLayoutClearButton{display:none}.ml-app .field-value-short{max-width:100%;overflow:hidden !important;text-overflow:ellipsis !important;white-space:nowrap !important;word-wrap:normal !important;display:inline-block;vertical-align:bottom}.ml-app .field-value-long{overflow-wrap:break-word}.ml-app .filter-button{opacity:.5;width:16px;height:16px;transform:translateY(-1px)}.ml-app .filter-button .euiIcon{width:12px;height:12px}.ml-app .filter-button:hover{opacity:1}.ml-app .ml-influencers-list{line-height:1.45}.ml-app .ml-influencers-list .field-label{font-size:12px;text-align:left;max-height:14px;max-width:calc(100% - 102px)}.ml-app .ml-influencers-list .field-label .field-value{max-width:100%;overflow:hidden !important;text-overflow:ellipsis !important;white-space:nowrap !important;word-wrap:normal !important;display:inline-block;vertical-align:bottom}.ml-app .ml-influencers-list .progress{display:inline-block;width:calc(100% - 34px);height:22px;min-width:70px;margin-bottom:0;color:#69707D;background-color:transparent}.ml-app .ml-influencers-list .progress .progress-bar-holder{width:calc(100% - 28px)}.ml-app .ml-influencers-list .progress .progress-bar{height:2px;margin-top:12px;text-align:right;line-height:18px;display:inline-block;transition:none}.ml-app .ml-influencers-list .progress.critical .progress-bar{background-color:#FE5050}.ml-app .ml-influencers-list .progress.critical .score-label{border-color:#FE5050}.ml-app .ml-influencers-list .progress.major .progress-bar{background-color:#FBA740}.ml-app .ml-influencers-list .progress.major .score-label{border-color:#FBA740}.ml-app .ml-influencers-list .progress.minor .progress-bar{background-color:#FDEC25}.ml-app .ml-influencers-list .progress.minor .score-label{border-color:#FDEC25}.ml-app .ml-influencers-list .progress.warning .progress-bar{background-color:#8BC8FB}.ml-app .ml-influencers-list .progress.warning .score-label{border-color:#8BC8FB}.ml-app .ml-influencers-list .score-label{text-align:center;line-height:14px;white-space:nowrap;font-size:12px;display:inline;margin-left:4px}.ml-app .ml-influencers-list .total-score-label{width:32px;vertical-align:top;text-align:center;color:#69707D;font-size:11px;line-height:14px;border-radius:4px;padding:2px;margin-top:4px;display:inline-block;border:1px solid #D3DAE6}.ml-app .ml-influencers-list-tooltip{word-break:break-all}.ml-app .ml-items-grid-page-size-menu{width:140px}.ml-app .mlJobSelectorBar{padding:8px}.ml-app .mlJobSelectorFlyoutBody>.euiFlyoutBody__overflow{padding-top:8px}.ml-app .mlJobSelector__ganttBar{background-color:#79ADDA;height:12px;border-radius:2px}.ml-app .mlJobSelector__ganttBarBackEdge{height:16px;border-left:1px solid #D6D6D6;border-right:1px solid #D6D6D6;margin-bottom:-14px;padding-top:8px}.ml-app .mlJobSelector__ganttBarDashed{height:1px;border-top:1px dashed #D6D6D6}.ml-app .mlJobSelector__ganttBarRunning{background-image:linear-gradient(45deg, rgba(255,255,255,0.15) 25%, transparent 25%, transparent 50%, rgba(255,255,255,0.15) 50%, rgba(255,255,255,0.15) 75%, transparent 75%, transparent);background-size:40px 40px;animation:progress-bar-stripes 2s linear infinite}.ml-app .ml-loading-indicator{text-align:center;font-size:17px;display:flex;flex-direction:column;align-items:center;justify-content:center}.ml-app .ml-rule-editor-flyout{font-size:14px}.ml-app .ml-rule-editor-flyout .select-rule-action .rule-detector-description-list{padding-left:16px}.ml-app .ml-rule-editor-flyout .select-rule-action-panel{padding:8px 0}.ml-app .ml-rule-editor-flyout .select-rule-action-panel .euiDescriptionList .euiDescriptionList__title{flex-basis:15%;padding:0 16px}.ml-app .ml-rule-editor-flyout .select-rule-action-panel .euiDescriptionList .euiDescriptionList__description{flex-basis:85%}.ml-app .ml-rule-editor-flyout .select-rule-action-panel .euiDescriptionList .euiDescriptionList__title:nth-child(1),.ml-app .ml-rule-editor-flyout .select-rule-action-panel .euiDescriptionList .euiDescriptionList__description:nth-child(2){color:#1a1c21;font-weight:700;border-bottom:1px solid #D3DAE6;padding-bottom:12px}.ml-app .ml-rule-editor-flyout .select-rule-action-panel .euiDescriptionList .euiDescriptionList__title:nth-child(3),.ml-app .ml-rule-editor-flyout .select-rule-action-panel .euiDescriptionList .euiDescriptionList__description:nth-child(4){padding-top:8px}.ml-app .ml-rule-editor-flyout .select-rule-action-panel .euiDescriptionList.euiDescriptionList--column>*{margin-top:4px}.ml-app .ml-rule-editor-flyout .scope-enable-checkbox .euiCheckbox__input[disabled] ~ .euiCheckbox__label{color:inherit}.ml-app .ml-rule-editor-flyout .scope-field-checkbox{margin-right:2px}.ml-app .ml-rule-editor-flyout .scope-field-checkbox .euiCheckbox{margin-top:4px}.ml-app .ml-rule-editor-flyout .scope-field-button{pointer-events:none;border-bottom:none}.ml-app .ml-rule-editor-flyout .scope-edit-filter-link{line-height:32px;font-size:12px}.ml-app .ml-rule-editor-flyout .condition-edit-value-field{width:170px;height:28px;margin:0 2px}.ml-app .ml-rule-editor-flyout .condition-edit-value-field input{height:28px}.ml-app .ml-rule-editor-flyout .euiExpressionButton.disabled{pointer-events:none}.ml-app .ml-rule-editor-flyout .euiExpressionButton.disabled .euiExpressionButton__value,.ml-app .ml-rule-editor-flyout .euiExpressionButton.disabled .euiExpressionButton__description{color:#D3DAE6}.ml-app .ml-rule-editor-flyout .text-highlight{font-weight:700}.ml-app .euiDescriptionList.euiDescriptionList--column.rule-detector-description-list .euiDescriptionList__title{flex-basis:15%}.ml-app .euiDescriptionList.euiDescriptionList--column.rule-detector-description-list .euiDescriptionList__description{flex-basis:85%}.ml-app .euiDescriptionList.euiDescriptionList--column.rule-detector-description-list>*{margin-top:4px}.ml-app .stat{margin-right:8px}.ml-app .mlStatsBar{height:42px;padding:14px;background-color:#F5F7FA}.ml-app .mlEmbeddedMapContent{width:100%;height:100%;display:flex;flex:1 1 100%;z-index:1;min-height:0}.ml-app .tab-datavisualizer_index_select,.ml-app .tab-timeseriesexplorer,.ml-app .tab-explorer{background-color:#fff}.ml-app .button-wrapper{display:inline}.ml-app .button-wrapper.disabled .kuiButton[disabled]{pointer-events:none}.ml-app .button-wrapper.disabled{cursor:not-allowed}.ml-app .clear,.ml-app .clearfix{clear:both}.ml-app .mlDisableAntiAliasing{-webkit-font-smoothing:none}.ml-app .mlDisableAntiAliasing * canvas{image-rendering:pixelated}\n',""]),e.exports=t},function(e,t,a){var i=a(68),n=a(398);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var s={insert:"head",singleton:!1};i(n,s);e.exports=n.locals||{}},function(e,t,a){(t=a(69)(!1)).push([e.i,'.ml-app .ml-icon-severity-critical,.ml-app .ml-icon-severity-major,.ml-app .ml-icon-severity-minor,.ml-app .ml-icon-severity-warning,.ml-app .ml-icon-severity-unknown{text-shadow:1px 1px 1px #343741}.ml-app .ml-icon-severity-critical{color:#FE5050}.ml-app .ml-icon-severity-major{color:#FBA740}.ml-app .ml-icon-severity-minor{color:#FDEC25}.ml-app .ml-icon-severity-warning{color:#8BC8FB}.ml-app .ml-icon-severity-unknown{color:#98A2B3}.ml-app .mlDataFrameAnalyticsRegression__evaluateStat{padding-top:24px}.ml-app .mlJobMapLegend__container{background-color:\'#FFFFFF\'}.ml-app .mlJobMapLegend__indexPattern{height:12px;width:12px;background-color:#fff;border:2px solid #D36086;transform:rotate(45deg);display:\'inline-block\'}.ml-app .mlJobMapLegend__transform{height:12px;width:12px;background-color:#fff;border:2px solid #6092C0;display:\'inline-block\'}.ml-app .mlJobMapLegend__analytics{height:12px;width:12px;background-color:#fff;border:2px solid #54B399;border-radius:50%;display:\'inline-block\'}.ml-app .mlJobMapLegend__sourceNode{height:12px;width:12px;background-color:#F3D371;border:1px solid #343741;border-radius:6px;display:\'inline-block\'}.ml-app .mlAnalyticsTable .euiTableRow-isExpandedRow .euiTableCellContent{animation:none !important}.ml-app .mlAnalyticsTable .euiTableRow-isExpandedRow .euiTableCellContent .euiTableCellContent__text{width:100%}.ml-app .mlAnalyticsTable .euiIcon-isLoaded{animation:none !important}.ml-app .mlTaskStateBadge,.ml-app .mlTaskModeBadge{max-width:100px}.ml-app .dataFrameAnalyticsCreateSearchDialog{width:720px;min-height:600px}.ml-app .dfAnalyticsCreationWizard__card{width:300px}.ml-app .ml-explorer{width:100%;display:inline-block;color:#98A2B3}.ml-app .ml-explorer .mlAnomalyExplorer__filterBar{padding-right:16px;padding-left:16px}.ml-app .ml-explorer .results-container{padding:0 0 16px 0}.ml-app .ml-explorer .results-container .col-xs-12{width:calc(100% - 32px);padding-left:16px}.ml-app .ml-explorer .results-container .no-influencers-warning{float:left;padding-top:4px;padding-left:16px;color:#98A2B3;font-size:14px}.ml-app .ml-explorer .results-container .panel-title{font-size:16px;font-weight:400;color:#98A2B3;display:inline-block;padding-bottom:4px}.ml-app .ml-explorer .results-container .panel-sub-title{color:#98A2B3;font-size:12px}.ml-app .mlSwimLaneContainer .echLegendListContainer{height:34px !important}.ml-app .mlSwimLaneContainer .echLegendList{display:flex !important;justify-content:space-between !important;flex-wrap:nowrap;position:absolute;right:0}.ml-app .ml-explorer-chart-eui-icon-tip{max-width:none}.ml-app .ml-explorer-chart-label-badges{margin-top:4px;display:flex;align-items:center}.ml-app .ml-reset-font-weight{font-weight:normal}.ml-app .ml-explorer-chart-container{overflow:hidden}.ml-app .ml-explorer-chart-container .ml-explorer-chart-svg{font-size:12px;font-family:"Inter",-apple-system,BlinkMacSystemFont,"Segoe UI",Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol"}.ml-app .ml-explorer-chart-container .ml-explorer-chart-svg .line-chart rect{fill:#1D1E24;opacity:1}.ml-app .ml-explorer-chart-container .ml-explorer-chart-svg .line-chart rect.selected-interval{fill:rgba(200,200,200,0.1);stroke:#98A2B3;stroke-width:2px;stroke-opacity:.8}.ml-app .ml-explorer-chart-container .ml-explorer-chart-svg .line-chart rect.scheduled-event-marker{stroke-width:1px;stroke:#98A2B3;fill:#343741;pointer-events:none}.ml-app .ml-explorer-chart-container .axis path,.ml-app .ml-explorer-chart-container .axis line{fill:none;stroke:#343741;shape-rendering:crispEdges}.ml-app .ml-explorer-chart-container .axis .tick line.ml-tick-emphasis{stroke:rgba(0,0,0,0.2)}.ml-app .ml-explorer-chart-container .axis text{fill:#98A2B3}.ml-app .ml-explorer-chart-container .axis .tick line{stroke:#343741;stroke-width:1px}.ml-app .ml-explorer-chart-container .values-line{fill:none;stroke:#36A2EF;stroke-width:2}.ml-app .ml-explorer-chart-container .values-dots circle,.ml-app .ml-explorer-chart-container .values-dots-circle{fill:#36A2EF;stroke-width:0}.ml-app .ml-explorer-chart-container .values-dots circle.values-dots-circle-blur{fill:#535966}.ml-app .ml-explorer-chart-container .metric-value{opacity:1;fill:transparent;stroke:#36A2EF;stroke-width:0}.ml-app .ml-explorer-chart-container .anomaly-marker{stroke-width:1px;stroke:#535966}.ml-app .ml-explorer-chart-container .anomaly-marker:hover{stroke-width:6px;stroke:#36A2EF}.ml-app .ml-explorer-chart-container .anomaly-marker.critical{fill:#FE5050}.ml-app .ml-explorer-chart-container .anomaly-marker.major{fill:#FBA740}.ml-app .ml-explorer-chart-container .anomaly-marker.minor{fill:#FDEC25}.ml-app .ml-explorer-chart-container .anomaly-marker.warning{fill:#8BC8FB}.ml-app .ml-explorer-chart-container .anomaly-marker.low{fill:#D2E9F7}.ml-app .ml-explorer-chart-container .metric-value:hover,.ml-app .ml-explorer-chart-container .anomaly-marker:hover{stroke-width:6px;stroke-opacity:.65}.ml-app .ml-explorer-chart{overflow:hidden}.ml-app .ml-explorer-chart-content-wrapper{height:215px}.ml-app .ml-explorer-chart-axis-emphasis{font-weight:bold}.ml-app .explorer-charts ml-explorer-charts-container .row{padding:10px}.ml-app .explorer-charts ml-explorer-charts-container label{font-size:12px}.ml-app .explorer-charts ml-explorer-charts-container select{font-size:14px;font-style:400}.ml-app .explorer-charts ml-explorer-charts-container .chart-controls label{padding:0 0 10px 0}.ml-app .explorer-charts ml-explorer-charts-container .no-results-item{text-align:center;padding-top:10px}.ml-app .explorer-charts ml-explorer-charts-container .ml-anomaly-interim-result{font-style:italic;padding-bottom:3px}.ml-app .explorer-charts ml-explorer-charts-container .ml-tablerow-expanded{width:100%;padding:5px 20px;overflow:hidden;font-size:12px}.ml-app .explorer-charts ml-explorer-charts-container .ml-tablerow-expanded td{padding:0 0 2px 0}.ml-app .explorer-charts ml-explorer-charts-container .ml-tablerow-expanded table tr>td:first-child{padding-left:2px;vertical-align:top}.ml-app .explorer-charts ml-explorer-charts-container .ml-tablerow-expanded td:first-child{width:140px}.ml-app .explorer-charts ml-explorer-charts-container .ml-tablerow-expanded td:nth-child(2){padding-left:5px}.ml-app .ml-explorer-chart-icons{float:right;padding-left:5px;margin:2px -8px 0 0}.ml-app .ml-edit-url-form .url-label{width:250px}.ml-app .ml-edit-url-form .url-link-to-radio .euiRadio{display:inline-block;padding-right:24px}.ml-app .ml-edit-url-form .url-time-range{width:150px}.ml-app .new-job-button-container{float:right}.ml-app .edit-custom-url-panel .close-editor-button{position:relative;float:right;top:-4px;right:0}.ml-app .tab-contents{margin:-8px;padding:8px;background-color:#1D1E24}.ml-app .tab-contents .col-md-6:nth-child(1){padding-right:7px}.ml-app .tab-contents .col-md-6:nth-child(2){padding-left:7px}.ml-app .tab-contents .job-section{overflow:auto;padding:5px 15px;background-color:#25262E;border:1px solid #343741;border-radius:6px;margin:4px 0}.ml-app .tab-contents .job-section .euiTable{background-color:transparent}.ml-app .tab-contents .job-section .euiTable .euiTableRow:first-child .euiTableRowCell{border-top:0}.ml-app .tab-contents .job-section .euiTable .euiTableRow:last-child .euiTableRowCell{border-bottom:0}.ml-app .tab-contents .job-section .euiTable .euiTableRow .euiTableRowCell{vertical-align:top;border-bottom:1px solid #343741}.ml-app .tab-contents .job-section .euiTable .euiTableRow .euiTableRowCell .euiTableCellContent__text{word-wrap:break-word}.ml-app .tab-contents .job-section .euiTable .euiTableRow:hover{background-color:inherit}.ml-app .tab-contents .job-section .job-item{font-size:12px}.ml-app .tab-contents .job-section .job-item.header{font-weight:bold}.ml-app .tab-contents .json-textarea{height:500px}.ml-app .job-messages-table{max-height:500px;overflow:auto;text-align:left}.ml-app .job-messages-table tr:last-child td{border-bottom:none}.ml-app .job-messages-table .euiTableRowCell{background-color:#1D1E24}.ml-app .mlJobFilterBar .euiFilterGroup .euiPopover .euiPanel .group-item{padding:8px 16px}.ml-app .mlJobFilterBar .euiFilterGroup .euiPopover .euiPanel .inline-group{border:1px solid #1D1E24;border-radius:6px}.ml-app .mlJobFilterBar .euiFilterGroup .euiPopover .euiPanel .euiFilterSelectItem:hover,.ml-app .mlJobFilterBar .euiFilterGroup .euiPopover .euiPanel .euiFilterSelectItem:focus{text-decoration:none}.ml-app .mlJobFilterBar .euiFilterGroup .euiPopover .euiPanel .euiFilterSelectItem:hover .inline-group,.ml-app .mlJobFilterBar .euiFilterGroup .euiPopover .euiPanel .euiFilterSelectItem:focus .inline-group{border:1px solid #98A2B3;box-shadow:0 1px 2px #535966}.ml-app .inline-group{font-size:12px;background-color:#343741;padding:2px 5px;border-radius:2px;display:inline-block;margin:0 3px;color:#1D1E24;vertical-align:text-top}.ml-app .jobs-list-table>div>.euiTable>thead th{text-align:left;white-space:normal}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(2){width:34px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(3){width:auto}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(4){width:20px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(5){width:auto}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(6){width:100px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(7){width:85px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(8){width:80px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(9){width:80px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(10){width:150px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(11){width:80px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(12){width:30px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(12) .euiTableCellContent__text{display:none}.ml-app .jobs-list-table>div>.euiTable>tbody td:nth-child(4) .euiTableCellContent{padding:0}.ml-app .jobs-list-table>div>.euiTable>tbody td:nth-child(10){white-space:nowrap}.ml-app .jobs-list-table>div>.euiTable>tbody .euiTableCellContent{animation:unset}.ml-app .jobs-list-table>div>.euiTable>tbody .euiTableRow.euiTableRow-isExpandedRow>td>div>.euiTableCellContent__text{width:100%}.ml-app .jobs-list-table>div>.euiTable>tbody .euiTableRow.euiTableRow-isExpandedRow>td>div>.euiTableCellContent__text .euiTableRowCell{background-color:inherit}.ml-app .jobs-list-table>div>.euiTable>tbody .euiTableRow>.euiTableRowCell>.euiTableCellContent>.euiTableCellContent__hoverItem{opacity:1}.ml-app .jobs-list-table>div>.euiTable>tbody .euiContextMenuPanel .euiContextMenuItem{white-space:nowrap}.ml-app .jobs-list-table>div>.euiTable>tbody .euiContextMenuPanel .euiContextMenuItem:last-child:not(.euiContextMenuItem-isDisabled){color:#F86B63}.ml-app .jobs-list-table>div>.euiTable>tbody .results-button{margin-right:4px;width:18px}.ml-app .jobs-list-table>div>.euiTable>tbody .euiContextMenuItem .euiIcon{margin-right:4px}.ml-app .jobs-list-table>div>.euiTable .job-description{display:inline-block}.ml-app .jobs-list-table>div>.euiTable .job-loading-spinner{text-align:center}.ml-app .jobs-list-table.jobs-selected .results-button{color:#343741;pointer-events:none}.ml-app .actions-bar{min-height:60px;display:flex;align-items:center}.ml-app .job-management{padding:20px}.ml-app .multi-select-actions .actions-border,.ml-app .multi-select-actions .actions-border-large{height:20px;border-right:1px solid #343741;width:1px;display:inline-block;vertical-align:middle;margin:0 5px}.ml-app .multi-select-actions .actions-border-large{height:35px;margin:0 15px}.ml-app .multi-select-actions .results-button{margin-right:5px}.ml-app .multi-select-actions .euiContextMenuPanel .euiContextMenuItem__text{white-space:nowrap}.ml-app .multi-select-actions .euiContextMenuPanel .euiContextMenuItem:last-child:not(.euiContextMenuItem-isDisabled){color:#F86B63}.ml-app .multi-select-actions-no-display{display:none}.ml-app .group-selector{max-width:300px}.ml-app .group-selector .euiPopoverTitle{margin-bottom:8px !important}.ml-app .group-list{max-height:350px;overflow:auto}.ml-app .group-list .group-item{line-height:18px;padding:6px 0;border-bottom:1px solid #343741;cursor:pointer}.ml-app .group-list .group-item:focus{background-color:#EEF6F9;box-shadow:none}.ml-app .group-list .group-item .check{width:20px;display:inline-block}.ml-app .group-list .group-item .inline-group{border:1px solid #1D1E24;border-radius:6px}.ml-app .group-list .group-item:hover .inline-group{border:1px solid #98A2B3;box-shadow:0 1px 2px #535966}.ml-app .group-list .group-item:last-child{margin-bottom:0;border-bottom:none}.ml-app .new-group-input{padding-bottom:0}.ml-app .ml-custom-urls-selection>.euiFlexGroup>.euiFlexItem:first-child{max-width:388px}.ml-app .ml-custom-urls-selection>.euiFlexGroup>.euiFlexItem:last-child{flex-basis:50%}.ml-app .mlOverviewPanel{padding-top:0}.ml-app .mlOverviewPanel__isLoading{text-align:center;padding:10%}.ml-app .mlOverviewPanel__buttons{float:right}.ml-app .mlOverviewPanel__spinner{display:inline-block}.ml-app .mlOverviewPanel__refreshButton{padding-right:12px}.ml-app .mlOverviewPanel__statsBar{margin-top:0;margin-right:0}.ml-app .mlSettingsPage .mlSettingsPage__header{width:1200px;margin-left:auto;margin-right:auto}.ml-app .mlSettingsPage .mlSettingsPage__content{width:1200px;margin-top:16px;margin-bottom:16px}.ml-app .ml-list-filter-lists .ml-list-filter-lists-content{max-width:1100px;margin-top:16px;margin-bottom:16px}.ml-app .ml-list-filter-lists .ml-filter-lists-table th:last-child,.ml-app .ml-list-filter-lists .ml-filter-lists-table td:last-child{width:70px}.ml-app .ml-edit-filter-lists .ml-edit-filter-lists-content{max-width:1100px;width:100%;margin-top:16px;margin-bottom:16px}.ml-app .ml-edit-filter-lists .ml-filter-list-usage>div{display:inline}.ml-app .ml-edit-filter-lists .ml-filter-list-usage .euiButtonEmpty.euiButtonEmpty--small{padding-bottom:4px}.ml-app .ml-edit-filter-lists .ml-filter-list-usage .euiButtonEmpty .euiButtonEmpty__content{padding:0 4px}.ml-app .ml-add-filter-item-popover .euiFormRow{width:300px;padding-bottom:4px}.ml-app .ml-filter-list-usage-popover li{line-height:24px}.ml-app .mlCalendarEditForm .mlCalendarEditForm__content{max-width:1200px;width:100%;margin-top:16px;margin-bottom:16px}.ml-app .mlCalendarList .mlCalendarList__content{max-width:1200px;margin-top:16px;margin-bottom:16px}.ml-app .ml-time-series-explorer{color:#98A2B3}.ml-app .ml-time-series-explorer .results-container .panel-title{font-size:16px;font-weight:400;color:#98A2B3}.ml-app .ml-time-series-explorer .results-container .entity-count-text{color:#7DDED8;font-size:14px}.ml-app .ml-time-series-explorer .forecast-controls{float:right}.ml-app .ml-time-series-explorer .ml-timeseries-chart svg{font-size:12px;font-family:"Inter",-apple-system,BlinkMacSystemFont,"Segoe UI",Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol"}.ml-app .ml-time-series-explorer .ml-timeseries-chart .axis path,.ml-app .ml-time-series-explorer .ml-timeseries-chart .axis line{fill:none;stroke:#343741;shape-rendering:crispEdges;pointer-events:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .axis text{fill:#DFE5EF}.ml-app .ml-time-series-explorer .ml-timeseries-chart .axis .tick line{stroke:#343741}.ml-app .ml-time-series-explorer .ml-timeseries-chart .chart-border{stroke:#343741;fill:none;stroke-width:1;shape-rendering:crispEdges}.ml-app .ml-time-series-explorer .ml-timeseries-chart .chart-border-highlight{stroke:#98A2B3;stroke-width:2}.ml-app .ml-time-series-explorer .ml-timeseries-chart .chart-border-highlight:hover{opacity:1}.ml-app .ml-time-series-explorer .ml-timeseries-chart .area{stroke-width:1}.ml-app .ml-time-series-explorer .ml-timeseries-chart .area.bounds{fill:rgba(54,162,239,0.2);pointer-events:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .values-line{fill:none;stroke:#36A2EF;stroke-width:2;pointer-events:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .values-line.forecast{stroke:#D6BF57;pointer-events:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .hidden{visibility:hidden}.ml-app .ml-time-series-explorer .ml-timeseries-chart .area.forecast{fill:rgba(214,191,87,0.3);pointer-events:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .metric-value{opacity:1;fill:transparent;stroke:#36A2EF;stroke-width:0}.ml-app .ml-time-series-explorer .ml-timeseries-chart .anomaly-marker{stroke-width:1px;stroke:#535966}.ml-app .ml-time-series-explorer .ml-timeseries-chart .anomaly-marker.critical{fill:#FE5050}.ml-app .ml-time-series-explorer .ml-timeseries-chart .anomaly-marker.major{fill:#FBA740}.ml-app .ml-time-series-explorer .ml-timeseries-chart .anomaly-marker.minor{fill:#FDEC25}.ml-app .ml-time-series-explorer .ml-timeseries-chart .anomaly-marker.warning{fill:#8BC8FB}.ml-app .ml-time-series-explorer .ml-timeseries-chart .anomaly-marker.low{fill:#D2E9F7}.ml-app .ml-time-series-explorer .ml-timeseries-chart .metric-value:hover,.ml-app .ml-time-series-explorer .ml-timeseries-chart .anomaly-marker:hover,.ml-app .ml-time-series-explorer .ml-timeseries-chart .anomaly-marker.highlighted{stroke-width:6px;stroke-opacity:.65;stroke:#36A2EF}.ml-app .ml-time-series-explorer .ml-timeseries-chart rect.scheduled-event-marker{stroke-width:1px;stroke:#98A2B3;fill:#343741;pointer-events:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .forecast .metric-value,.ml-app .ml-time-series-explorer .ml-timeseries-chart .forecast .metric-value:hover{stroke:#D6BF57}.ml-app .ml-time-series-explorer .ml-timeseries-chart .focus-chart .x-axis-background line{fill:none;shape-rendering:crispEdges;stroke:#25262E}.ml-app .ml-time-series-explorer .ml-timeseries-chart .focus-chart .x-axis-background rect{fill:#25262E}.ml-app .ml-time-series-explorer .ml-timeseries-chart .focus-chart .focus-zoom{fill:#98A2B3}.ml-app .ml-time-series-explorer .ml-timeseries-chart .focus-chart .focus-zoom a text{fill:#36A2EF;cursor:pointer}.ml-app .ml-time-series-explorer .ml-timeseries-chart .focus-chart .focus-zoom a:hover,.ml-app .ml-time-series-explorer .ml-timeseries-chart .focus-chart .focus-zoom a:active,.ml-app .ml-time-series-explorer .ml-timeseries-chart .focus-chart .focus-zoom a:focus{text-decoration:underline}.ml-app .ml-time-series-explorer .ml-timeseries-chart .context-chart .x.axis path{display:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .context-chart .axis text{font-size:10px;fill:#DFE5EF}.ml-app .ml-time-series-explorer .ml-timeseries-chart .context-chart .values-line{stroke-width:1}.ml-app .ml-time-series-explorer .ml-timeseries-chart .context-chart .mask polygon{fill-opacity:.1}.ml-app .ml-time-series-explorer .ml-timeseries-chart .context-chart .mask .area.bounds{fill:#343741}.ml-app .ml-time-series-explorer .ml-timeseries-chart .context-chart .mask .values-line{stroke-width:1;stroke:#535966}.ml-app .ml-time-series-explorer .ml-timeseries-chart .swimlane .axis text{display:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .swimlane rect.swimlane-cell-hidden{display:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .brush .extent{fill-opacity:0;shape-rendering:crispEdges;stroke:#98A2B3;stroke-width:2;cursor:move}.ml-app .ml-time-series-explorer .ml-timeseries-chart .brush .extent:hover{opacity:1}.ml-app .ml-time-series-explorer .ml-timeseries-chart .top-border{fill:#1D1E24}.ml-app .ml-time-series-explorer .ml-timeseries-chart foreignObject.brush-handle{pointer-events:none;padding-top:1px}.ml-app .ml-time-series-explorer .ml-timeseries-chart div.brush-handle-inner{border:1px solid #98A2B3;background-color:#343741;height:70px;width:10px;text-align:center;cursor:ew-resize;margin-top:9px;font-size:14px;fill:#98A2B3}.ml-app .ml-time-series-explorer .ml-timeseries-chart div.brush-handle-inner-left{border-radius:6px 0 0 6px}.ml-app .ml-time-series-explorer .ml-timeseries-chart div.brush-handle-inner-right{border-radius:0 6px 6px 0}.ml-app .ml-time-series-explorer .ml-timeseries-chart rect.brush-handle{stroke-width:1;stroke:#98A2B3;fill:#343741;pointer-events:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart rect.brush-handle:hover{opacity:1}.ml-app .mlTimeSeriesExplorerProgress{background-color:#1D1E24}.ml-app .mlTimeSeriesExplorerProgress::-moz-progress-bar,.ml-app .mlTimeSeriesExplorerProgress::-webkit-progress-bar{background-color:#1D1E24}.ml-app .mlAnnotationBrush .extent{stroke:#343741;stroke-width:2px;stroke-dasharray:2 2;fill:#25262E;shape-rendering:geometricPrecision}.ml-app .mlAnnotationRect{stroke:#fff;stroke-width:2px;stroke-opacity:.2;transition:stroke-opacity 150ms;fill:#fff;fill-opacity:.05;transition:fill-opacity 150ms;shape-rendering:geometricPrecision}.ml-app .mlAnnotationRect-isHighlight{stroke-opacity:.4;transition:stroke-opacity 150ms;fill-opacity:.1;transition:fill-opacity 150ms}.ml-app .mlAnnotationRect-isBlur{stroke-opacity:.1;transition:stroke-opacity 150ms;fill-opacity:.025;transition:fill-opacity 150ms}.ml-app .mlAnnotationText{text-anchor:middle;font-size:12px;font-family:"Inter",-apple-system,BlinkMacSystemFont,"Segoe UI",Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";font-weight:500;fill:#fff;transition:fill 150ms;-webkit-user-select:none;user-select:none}.ml-app .mlAnnotationText-isBlur{fill:#535966;transition:fill 150ms}.ml-app .mlAnnotationTextRect{fill:#343741;transition:fill 150ms}.ml-app .mlAnnotationTextRect-isBlur{fill:#25262E;transition:fill 150ms}.ml-app .mlAnnotationHidden{display:none}.ml-app .mlContextAnnotationRect{stroke:#fff;stroke-width:2px;stroke-opacity:.2;transition:stroke-opacity 150ms;fill:#fff;fill-opacity:.05;transition:fill-opacity 150ms;shape-rendering:geometricPrecision}.ml-app .mlContextAnnotationRect-isBlur{stroke-opacity:.1;transition:stroke-opacity 150ms;fill-opacity:.025;transition:fill-opacity 150ms}.ml-app .euiDescriptionList.euiDescriptionList--column.ml-annotation-description-list .euiDescriptionList__title{flex-basis:30%}.ml-app .euiDescriptionList.euiDescriptionList--column.ml-annotation-description-list .euiDescriptionList__description{flex-basis:70%}.ml-app .euiDescriptionList.euiDescriptionList--column.ml-annotation-description-list>*{margin-top:4px}.ml-app .ml-anomalies-table .ml-icon-severity-critical,.ml-app .ml-anomalies-table .ml-icon-severity-major,.ml-app .ml-anomalies-table .ml-icon-severity-minor,.ml-app .ml-anomalies-table .ml-icon-severity-warning,.ml-app .ml-anomalies-table .ml-icon-severity-unknown{color:inherit;text-shadow:none}.ml-app .ml-anomalies-table .ml-icon-severity-critical .euiIcon{fill:#FE5050}.ml-app .ml-anomalies-table .ml-icon-severity-major .euiIcon{fill:#FBA740}.ml-app .ml-anomalies-table .ml-icon-severity-minor .euiIcon{fill:#FDEC25}.ml-app .ml-anomalies-table .ml-icon-severity-warning .euiIcon{fill:#8BC8FB}.ml-app .ml-anomalies-table .ml-icon-severity-unknown .euiIcon{fill:#98A2B3}.ml-app .ml-anomalies-table tr th:first-child,.ml-app .ml-anomalies-table tr td:first-child{width:32px}.ml-app .ml-anomalies-table .euiTableCellContent .euiHealth{font-size:inherit}.ml-app .ml-anomalies-table .euiTableCellContent .detector-rules-icon{margin-left:4px;opacity:.5}.ml-app .ml-anomalies-table .euiContextMenuItem{min-width:150px}.ml-app .ml-anomalies-table .mlAnomalyCategoryExamples__header{display:inline}.ml-app .ml-anomalies-table .mlAnomalyCategoryExamples__link{width:100%}.ml-app .ml-anomalies-table .category-example{display:block;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.ml-app .ml-anomalies-table .mlAnomalyCategoryExamples{padding:24px}.ml-app .ml-anomalies-table .mlAnomalyCategoryExamples__item{display:block;white-space:wrap;font-family:"Roboto Mono",Consolas,Menlo,Courier,monospace}.ml-app .ml-anomalies-table .interim-result{font-style:italic}.ml-app .ml-anomalies-table .ml-anomalies-table-details{padding:4px 32px;max-height:1000px;overflow-y:auto}.ml-app .ml-anomalies-table .ml-anomalies-table-details .anomaly-description-list .euiDescriptionList__title{margin-top:0;flex-basis:15%;font-size:inherit;line-height:1.5rem;max-width:100%;overflow:hidden !important;text-overflow:ellipsis !important;white-space:nowrap !important;word-wrap:normal !important}.ml-app .ml-anomalies-table .ml-anomalies-table-details .anomaly-description-list .euiDescriptionList__description{margin-top:0;flex-basis:85%;font-size:inherit;line-height:1.5rem}.ml-app .mlColorRangeLegend text{font-size:10px;font-size:.71429rem;fill:#98A2B3}.ml-app .mlColorRangeLegend .axis path{fill:none;stroke:none}.ml-app .mlColorRangeLegend .axis line{fill:none;stroke:#535966;shape-rendering:crispEdges}.ml-app .ml-table-controls label{font-size:12px;padding:0 0 4px 4px}.ml-app .ml-table-controls .ml-table-controls-element{display:inline-block;padding-left:16px}.ml-app .ml-table-controls select{font-size:12px;font-style:normal}.ml-app .ml-select-severity .euiFormControlLayoutClearButton{display:none}.ml-app .field-value-short{max-width:100%;overflow:hidden !important;text-overflow:ellipsis !important;white-space:nowrap !important;word-wrap:normal !important;display:inline-block;vertical-align:bottom}.ml-app .field-value-long{overflow-wrap:break-word}.ml-app .filter-button{opacity:.5;width:16px;height:16px;transform:translateY(-1px)}.ml-app .filter-button .euiIcon{width:12px;height:12px}.ml-app .filter-button:hover{opacity:1}.ml-app .ml-influencers-list{line-height:1.45}.ml-app .ml-influencers-list .field-label{font-size:12px;text-align:left;max-height:14px;max-width:calc(100% - 102px)}.ml-app .ml-influencers-list .field-label .field-value{max-width:100%;overflow:hidden !important;text-overflow:ellipsis !important;white-space:nowrap !important;word-wrap:normal !important;display:inline-block;vertical-align:bottom}.ml-app .ml-influencers-list .progress{display:inline-block;width:calc(100% - 34px);height:22px;min-width:70px;margin-bottom:0;color:#98A2B3;background-color:transparent}.ml-app .ml-influencers-list .progress .progress-bar-holder{width:calc(100% - 28px)}.ml-app .ml-influencers-list .progress .progress-bar{height:2px;margin-top:12px;text-align:right;line-height:18px;display:inline-block;transition:none}.ml-app .ml-influencers-list .progress.critical .progress-bar{background-color:#FE5050}.ml-app .ml-influencers-list .progress.critical .score-label{border-color:#FE5050}.ml-app .ml-influencers-list .progress.major .progress-bar{background-color:#FBA740}.ml-app .ml-influencers-list .progress.major .score-label{border-color:#FBA740}.ml-app .ml-influencers-list .progress.minor .progress-bar{background-color:#FDEC25}.ml-app .ml-influencers-list .progress.minor .score-label{border-color:#FDEC25}.ml-app .ml-influencers-list .progress.warning .progress-bar{background-color:#8BC8FB}.ml-app .ml-influencers-list .progress.warning .score-label{border-color:#8BC8FB}.ml-app .ml-influencers-list .score-label{text-align:center;line-height:14px;white-space:nowrap;font-size:12px;display:inline;margin-left:4px}.ml-app .ml-influencers-list .total-score-label{width:32px;vertical-align:top;text-align:center;color:#98A2B3;font-size:11px;line-height:14px;border-radius:6px;padding:2px;margin-top:4px;display:inline-block;border:1px solid #343741}.ml-app .ml-influencers-list-tooltip{word-break:break-all}.ml-app .ml-items-grid-page-size-menu{width:140px}.ml-app .mlJobSelectorBar{padding:8px}.ml-app .mlJobSelectorFlyoutBody>.euiFlyoutBody__overflow{padding-top:8px}.ml-app .mlJobSelector__ganttBar{background-color:#79ADDA;height:12px;border-radius:2px}.ml-app .mlJobSelector__ganttBarBackEdge{height:16px;border-left:1px solid #D6D6D6;border-right:1px solid #D6D6D6;margin-bottom:-14px;padding-top:8px}.ml-app .mlJobSelector__ganttBarDashed{height:1px;border-top:1px dashed #D6D6D6}.ml-app .mlJobSelector__ganttBarRunning{background-image:linear-gradient(45deg, rgba(255,255,255,0.15) 25%, transparent 25%, transparent 50%, rgba(255,255,255,0.15) 50%, rgba(255,255,255,0.15) 75%, transparent 75%, transparent);background-size:40px 40px;animation:progress-bar-stripes 2s linear infinite}.ml-app .ml-loading-indicator{text-align:center;font-size:17px;display:flex;flex-direction:column;align-items:center;justify-content:center}.ml-app .ml-rule-editor-flyout{font-size:14px}.ml-app .ml-rule-editor-flyout .select-rule-action .rule-detector-description-list{padding-left:16px}.ml-app .ml-rule-editor-flyout .select-rule-action-panel{padding:8px 0}.ml-app .ml-rule-editor-flyout .select-rule-action-panel .euiDescriptionList .euiDescriptionList__title{flex-basis:15%;padding:0 16px}.ml-app .ml-rule-editor-flyout .select-rule-action-panel .euiDescriptionList .euiDescriptionList__description{flex-basis:85%}.ml-app .ml-rule-editor-flyout .select-rule-action-panel .euiDescriptionList .euiDescriptionList__title:nth-child(1),.ml-app .ml-rule-editor-flyout .select-rule-action-panel .euiDescriptionList .euiDescriptionList__description:nth-child(2){color:#DFE5EF;font-weight:700;border-bottom:1px solid #343741;padding-bottom:12px}.ml-app .ml-rule-editor-flyout .select-rule-action-panel .euiDescriptionList .euiDescriptionList__title:nth-child(3),.ml-app .ml-rule-editor-flyout .select-rule-action-panel .euiDescriptionList .euiDescriptionList__description:nth-child(4){padding-top:8px}.ml-app .ml-rule-editor-flyout .select-rule-action-panel .euiDescriptionList.euiDescriptionList--column>*{margin-top:4px}.ml-app .ml-rule-editor-flyout .scope-enable-checkbox .euiCheckbox__input[disabled] ~ .euiCheckbox__label{color:inherit}.ml-app .ml-rule-editor-flyout .scope-field-checkbox{margin-right:2px}.ml-app .ml-rule-editor-flyout .scope-field-checkbox .euiCheckbox{margin-top:4px}.ml-app .ml-rule-editor-flyout .scope-field-button{pointer-events:none;border-bottom:none}.ml-app .ml-rule-editor-flyout .scope-edit-filter-link{line-height:32px;font-size:12px}.ml-app .ml-rule-editor-flyout .condition-edit-value-field{width:170px;height:28px;margin:0 2px}.ml-app .ml-rule-editor-flyout .condition-edit-value-field input{height:28px}.ml-app .ml-rule-editor-flyout .euiExpressionButton.disabled{pointer-events:none}.ml-app .ml-rule-editor-flyout .euiExpressionButton.disabled .euiExpressionButton__value,.ml-app .ml-rule-editor-flyout .euiExpressionButton.disabled .euiExpressionButton__description{color:#343741}.ml-app .ml-rule-editor-flyout .text-highlight{font-weight:700}.ml-app .euiDescriptionList.euiDescriptionList--column.rule-detector-description-list .euiDescriptionList__title{flex-basis:15%}.ml-app .euiDescriptionList.euiDescriptionList--column.rule-detector-description-list .euiDescriptionList__description{flex-basis:85%}.ml-app .euiDescriptionList.euiDescriptionList--column.rule-detector-description-list>*{margin-top:4px}.ml-app .stat{margin-right:8px}.ml-app .mlStatsBar{height:42px;padding:14px;background-color:#25262E}.ml-app .mlEmbeddedMapContent{width:100%;height:100%;display:flex;flex:1 1 100%;z-index:1;min-height:0}.ml-app .tab-datavisualizer_index_select,.ml-app .tab-timeseriesexplorer,.ml-app .tab-explorer{background-color:#1D1E24}.ml-app .button-wrapper{display:inline}.ml-app .button-wrapper.disabled .kuiButton[disabled]{pointer-events:none}.ml-app .button-wrapper.disabled{cursor:not-allowed}.ml-app .clear,.ml-app .clearfix{clear:both}.ml-app .mlDisableAntiAliasing{-webkit-font-smoothing:none}.ml-app .mlDisableAntiAliasing * canvas{image-rendering:pixelated}\n',""]),e.exports=t},function(e,t,a){var i=a(68),n=a(400);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var s={insert:"head",singleton:!1};i(n,s);e.exports=n.locals||{}},function(e,t,a){(t=a(69)(!1)).push([e.i,'.ml-app .ml-icon-severity-critical,.ml-app .ml-icon-severity-major,.ml-app .ml-icon-severity-minor,.ml-app .ml-icon-severity-warning,.ml-app .ml-icon-severity-unknown{text-shadow:1px 1px 1px #D3DAE6}.ml-app .ml-icon-severity-critical{color:#cf4141}.ml-app .ml-icon-severity-major{color:#9e6929}.ml-app .ml-icon-severity-minor{color:#7c7313}.ml-app .ml-icon-severity-warning{color:#537896}.ml-app .ml-icon-severity-unknown{color:#69707D}.ml-app .mlDataFrameAnalyticsRegression__evaluateStat{padding-top:24px}.ml-app .mlJobMapLegend__container{background-color:\'#FFFFFF\'}.ml-app .mlJobMapLegend__indexPattern{height:12px;width:12px;background-color:#fff;border:2px solid #D36086;transform:rotate(45deg);display:\'inline-block\'}.ml-app .mlJobMapLegend__transform{height:12px;width:12px;background-color:#fff;border:2px solid #6092C0;display:\'inline-block\'}.ml-app .mlJobMapLegend__analytics{height:12px;width:12px;background-color:#fff;border:2px solid #54B399;border-radius:50%;display:\'inline-block\'}.ml-app .mlJobMapLegend__sourceNode{height:12px;width:12px;background-color:#FEC514;border:1px solid #D3DAE6;border-radius:6px;display:\'inline-block\'}.ml-app .mlAnalyticsTable .euiTableRow-isExpandedRow .euiTableCellContent{animation:none !important}.ml-app .mlAnalyticsTable .euiTableRow-isExpandedRow .euiTableCellContent .euiTableCellContent__text{width:100%}.ml-app .mlAnalyticsTable .euiIcon-isLoaded{animation:none !important}.ml-app .mlTaskStateBadge,.ml-app .mlTaskModeBadge{max-width:100px}.ml-app .dataFrameAnalyticsCreateSearchDialog{width:720px;min-height:600px}.ml-app .dfAnalyticsCreationWizard__card{width:300px}.ml-app .ml-explorer{width:100%;display:inline-block;color:#69707D}.ml-app .ml-explorer .mlAnomalyExplorer__filterBar{padding-right:16px;padding-left:16px}.ml-app .ml-explorer .results-container{padding:0 0 16px 0}.ml-app .ml-explorer .results-container .col-xs-12{width:calc(100% - 32px);padding-left:16px}.ml-app .ml-explorer .results-container .no-influencers-warning{float:left;padding-top:4px;padding-left:16px;color:#69707D;font-size:14px}.ml-app .ml-explorer .results-container .panel-title{font-size:16px;font-weight:400;color:#69707D;display:inline-block;padding-bottom:4px}.ml-app .ml-explorer .results-container .panel-sub-title{color:#69707D;font-size:12px}.ml-app .mlSwimLaneContainer .echLegendListContainer{height:34px !important}.ml-app .mlSwimLaneContainer .echLegendList{display:flex !important;justify-content:space-between !important;flex-wrap:nowrap;position:absolute;right:0}.ml-app .ml-explorer-chart-eui-icon-tip{max-width:none}.ml-app .ml-explorer-chart-label-badges{margin-top:4px;display:flex;align-items:center}.ml-app .ml-reset-font-weight{font-weight:normal}.ml-app .ml-explorer-chart-container{overflow:hidden}.ml-app .ml-explorer-chart-container .ml-explorer-chart-svg{font-size:12px;font-family:"Inter",-apple-system,BlinkMacSystemFont,"Segoe UI",Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol"}.ml-app .ml-explorer-chart-container .ml-explorer-chart-svg .line-chart rect{fill:#fff;opacity:1}.ml-app .ml-explorer-chart-container .ml-explorer-chart-svg .line-chart rect.selected-interval{fill:rgba(200,200,200,0.1);stroke:#69707D;stroke-width:2px;stroke-opacity:.8}.ml-app .ml-explorer-chart-container .ml-explorer-chart-svg .line-chart rect.scheduled-event-marker{stroke-width:1px;stroke:#69707D;fill:#D3DAE6;pointer-events:none}.ml-app .ml-explorer-chart-container .axis path,.ml-app .ml-explorer-chart-container .axis line{fill:none;stroke:#D3DAE6;shape-rendering:crispEdges}.ml-app .ml-explorer-chart-container .axis .tick line.ml-tick-emphasis{stroke:rgba(0,0,0,0.2)}.ml-app .ml-explorer-chart-container .axis text{fill:#69707D}.ml-app .ml-explorer-chart-container .axis .tick line{stroke:#D3DAE6;stroke-width:1px}.ml-app .ml-explorer-chart-container .values-line{fill:none;stroke:#07C;stroke-width:2}.ml-app .ml-explorer-chart-container .values-dots circle,.ml-app .ml-explorer-chart-container .values-dots-circle{fill:#07C;stroke-width:0}.ml-app .ml-explorer-chart-container .values-dots circle.values-dots-circle-blur{fill:#98A2B3}.ml-app .ml-explorer-chart-container .metric-value{opacity:1;fill:transparent;stroke:#07C;stroke-width:0}.ml-app .ml-explorer-chart-container .anomaly-marker{stroke-width:1px;stroke:#98A2B3}.ml-app .ml-explorer-chart-container .anomaly-marker:hover{stroke-width:6px;stroke:#07C}.ml-app .ml-explorer-chart-container .anomaly-marker.critical{fill:#FE5050}.ml-app .ml-explorer-chart-container .anomaly-marker.major{fill:#FBA740}.ml-app .ml-explorer-chart-container .anomaly-marker.minor{fill:#FDEC25}.ml-app .ml-explorer-chart-container .anomaly-marker.warning{fill:#8BC8FB}.ml-app .ml-explorer-chart-container .anomaly-marker.low{fill:#D2E9F7}.ml-app .ml-explorer-chart-container .metric-value:hover,.ml-app .ml-explorer-chart-container .anomaly-marker:hover{stroke-width:6px;stroke-opacity:.65}.ml-app .ml-explorer-chart{overflow:hidden}.ml-app .ml-explorer-chart-content-wrapper{height:215px}.ml-app .ml-explorer-chart-axis-emphasis{font-weight:bold}.ml-app .explorer-charts ml-explorer-charts-container .row{padding:10px}.ml-app .explorer-charts ml-explorer-charts-container label{font-size:12px}.ml-app .explorer-charts ml-explorer-charts-container select{font-size:14px;font-style:400}.ml-app .explorer-charts ml-explorer-charts-container .chart-controls label{padding:0 0 10px 0}.ml-app .explorer-charts ml-explorer-charts-container .no-results-item{text-align:center;padding-top:10px}.ml-app .explorer-charts ml-explorer-charts-container .ml-anomaly-interim-result{font-style:italic;padding-bottom:3px}.ml-app .explorer-charts ml-explorer-charts-container .ml-tablerow-expanded{width:100%;padding:5px 20px;overflow:hidden;font-size:12px}.ml-app .explorer-charts ml-explorer-charts-container .ml-tablerow-expanded td{padding:0 0 2px 0}.ml-app .explorer-charts ml-explorer-charts-container .ml-tablerow-expanded table tr>td:first-child{padding-left:2px;vertical-align:top}.ml-app .explorer-charts ml-explorer-charts-container .ml-tablerow-expanded td:first-child{width:140px}.ml-app .explorer-charts ml-explorer-charts-container .ml-tablerow-expanded td:nth-child(2){padding-left:5px}.ml-app .ml-explorer-chart-icons{float:right;padding-left:5px;margin:2px -8px 0 0}.ml-app .ml-edit-url-form .url-label{width:250px}.ml-app .ml-edit-url-form .url-link-to-radio .euiRadio{display:inline-block;padding-right:24px}.ml-app .ml-edit-url-form .url-time-range{width:150px}.ml-app .new-job-button-container{float:right}.ml-app .edit-custom-url-panel .close-editor-button{position:relative;float:right;top:-4px;right:0}.ml-app .tab-contents{margin:-8px;padding:8px;background-color:#fff}.ml-app .tab-contents .col-md-6:nth-child(1){padding-right:7px}.ml-app .tab-contents .col-md-6:nth-child(2){padding-left:7px}.ml-app .tab-contents .job-section{overflow:auto;padding:5px 15px;background-color:#F5F7FA;border:1px solid #D3DAE6;border-radius:6px;margin:4px 0}.ml-app .tab-contents .job-section .euiTable{background-color:transparent}.ml-app .tab-contents .job-section .euiTable .euiTableRow:first-child .euiTableRowCell{border-top:0}.ml-app .tab-contents .job-section .euiTable .euiTableRow:last-child .euiTableRowCell{border-bottom:0}.ml-app .tab-contents .job-section .euiTable .euiTableRow .euiTableRowCell{vertical-align:top;border-bottom:1px solid #D3DAE6}.ml-app .tab-contents .job-section .euiTable .euiTableRow .euiTableRowCell .euiTableCellContent__text{word-wrap:break-word}.ml-app .tab-contents .job-section .euiTable .euiTableRow:hover{background-color:inherit}.ml-app .tab-contents .job-section .job-item{font-size:12px}.ml-app .tab-contents .job-section .job-item.header{font-weight:bold}.ml-app .tab-contents .json-textarea{height:500px}.ml-app .job-messages-table{max-height:500px;overflow:auto;text-align:left}.ml-app .job-messages-table tr:last-child td{border-bottom:none}.ml-app .job-messages-table .euiTableRowCell{background-color:#fff}.ml-app .mlJobFilterBar .euiFilterGroup .euiPopover .euiPanel .group-item{padding:8px 16px}.ml-app .mlJobFilterBar .euiFilterGroup .euiPopover .euiPanel .inline-group{border:1px solid #fff;border-radius:6px}.ml-app .mlJobFilterBar .euiFilterGroup .euiPopover .euiPanel .euiFilterSelectItem:hover,.ml-app .mlJobFilterBar .euiFilterGroup .euiPopover .euiPanel .euiFilterSelectItem:focus{text-decoration:none}.ml-app .mlJobFilterBar .euiFilterGroup .euiPopover .euiPanel .euiFilterSelectItem:hover .inline-group,.ml-app .mlJobFilterBar .euiFilterGroup .euiPopover .euiPanel .euiFilterSelectItem:focus .inline-group{border:1px solid #69707D;box-shadow:0 1px 2px #98A2B3}.ml-app .inline-group{font-size:12px;background-color:#D3DAE6;padding:2px 5px;border-radius:2px;display:inline-block;margin:0 3px;color:#fff;vertical-align:text-top}.ml-app .jobs-list-table>div>.euiTable>thead th{text-align:left;white-space:normal}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(2){width:34px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(3){width:auto}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(4){width:20px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(5){width:auto}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(6){width:100px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(7){width:85px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(8){width:80px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(9){width:80px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(10){width:150px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(11){width:80px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(12){width:30px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(12) .euiTableCellContent__text{display:none}.ml-app .jobs-list-table>div>.euiTable>tbody td:nth-child(4) .euiTableCellContent{padding:0}.ml-app .jobs-list-table>div>.euiTable>tbody td:nth-child(10){white-space:nowrap}.ml-app .jobs-list-table>div>.euiTable>tbody .euiTableCellContent{animation:unset}.ml-app .jobs-list-table>div>.euiTable>tbody .euiTableRow.euiTableRow-isExpandedRow>td>div>.euiTableCellContent__text{width:100%}.ml-app .jobs-list-table>div>.euiTable>tbody .euiTableRow.euiTableRow-isExpandedRow>td>div>.euiTableCellContent__text .euiTableRowCell{background-color:inherit}.ml-app .jobs-list-table>div>.euiTable>tbody .euiTableRow>.euiTableRowCell>.euiTableCellContent>.euiTableCellContent__hoverItem{opacity:1}.ml-app .jobs-list-table>div>.euiTable>tbody .euiContextMenuPanel .euiContextMenuItem{white-space:nowrap}.ml-app .jobs-list-table>div>.euiTable>tbody .euiContextMenuPanel .euiContextMenuItem:last-child:not(.euiContextMenuItem-isDisabled){color:#BD271E}.ml-app .jobs-list-table>div>.euiTable>tbody .results-button{margin-right:4px;width:18px}.ml-app .jobs-list-table>div>.euiTable>tbody .euiContextMenuItem .euiIcon{margin-right:4px}.ml-app .jobs-list-table>div>.euiTable .job-description{display:inline-block}.ml-app .jobs-list-table>div>.euiTable .job-loading-spinner{text-align:center}.ml-app .jobs-list-table.jobs-selected .results-button{color:#D3DAE6;pointer-events:none}.ml-app .actions-bar{min-height:60px;display:flex;align-items:center}.ml-app .job-management{padding:20px}.ml-app .multi-select-actions .actions-border,.ml-app .multi-select-actions .actions-border-large{height:20px;border-right:1px solid #D3DAE6;width:1px;display:inline-block;vertical-align:middle;margin:0 5px}.ml-app .multi-select-actions .actions-border-large{height:35px;margin:0 15px}.ml-app .multi-select-actions .results-button{margin-right:5px}.ml-app .multi-select-actions .euiContextMenuPanel .euiContextMenuItem__text{white-space:nowrap}.ml-app .multi-select-actions .euiContextMenuPanel .euiContextMenuItem:last-child:not(.euiContextMenuItem-isDisabled){color:#BD271E}.ml-app .multi-select-actions-no-display{display:none}.ml-app .group-selector{max-width:300px}.ml-app .group-selector .euiPopoverTitle{margin-bottom:8px !important}.ml-app .group-list{max-height:350px;overflow:auto}.ml-app .group-list .group-item{line-height:18px;padding:6px 0;border-bottom:1px solid #D3DAE6;cursor:pointer}.ml-app .group-list .group-item:focus{background-color:#EEF6F9;box-shadow:none}.ml-app .group-list .group-item .check{width:20px;display:inline-block}.ml-app .group-list .group-item .inline-group{border:1px solid #fff;border-radius:6px}.ml-app .group-list .group-item:hover .inline-group{border:1px solid #69707D;box-shadow:0 1px 2px #98A2B3}.ml-app .group-list .group-item:last-child{margin-bottom:0;border-bottom:none}.ml-app .new-group-input{padding-bottom:0}.ml-app .ml-custom-urls-selection>.euiFlexGroup>.euiFlexItem:first-child{max-width:388px}.ml-app .ml-custom-urls-selection>.euiFlexGroup>.euiFlexItem:last-child{flex-basis:50%}.ml-app .mlOverviewPanel{padding-top:0}.ml-app .mlOverviewPanel__isLoading{text-align:center;padding:10%}.ml-app .mlOverviewPanel__buttons{float:right}.ml-app .mlOverviewPanel__spinner{display:inline-block}.ml-app .mlOverviewPanel__refreshButton{padding-right:12px}.ml-app .mlOverviewPanel__statsBar{margin-top:0;margin-right:0}.ml-app .mlSettingsPage .mlSettingsPage__header{width:1200px;margin-left:auto;margin-right:auto}.ml-app .mlSettingsPage .mlSettingsPage__content{width:1200px;margin-top:16px;margin-bottom:16px}.ml-app .ml-list-filter-lists .ml-list-filter-lists-content{max-width:1100px;margin-top:16px;margin-bottom:16px}.ml-app .ml-list-filter-lists .ml-filter-lists-table th:last-child,.ml-app .ml-list-filter-lists .ml-filter-lists-table td:last-child{width:70px}.ml-app .ml-edit-filter-lists .ml-edit-filter-lists-content{max-width:1100px;width:100%;margin-top:16px;margin-bottom:16px}.ml-app .ml-edit-filter-lists .ml-filter-list-usage>div{display:inline}.ml-app .ml-edit-filter-lists .ml-filter-list-usage .euiButtonEmpty.euiButtonEmpty--small{padding-bottom:4px}.ml-app .ml-edit-filter-lists .ml-filter-list-usage .euiButtonEmpty .euiButtonEmpty__content{padding:0 4px}.ml-app .ml-add-filter-item-popover .euiFormRow{width:300px;padding-bottom:4px}.ml-app .ml-filter-list-usage-popover li{line-height:24px}.ml-app .mlCalendarEditForm .mlCalendarEditForm__content{max-width:1200px;width:100%;margin-top:16px;margin-bottom:16px}.ml-app .mlCalendarList .mlCalendarList__content{max-width:1200px;margin-top:16px;margin-bottom:16px}.ml-app .ml-time-series-explorer{color:#69707D}.ml-app .ml-time-series-explorer .results-container .panel-title{font-size:16px;font-weight:400;color:#69707D}.ml-app .ml-time-series-explorer .results-container .entity-count-text{color:#00BFB3;font-size:14px}.ml-app .ml-time-series-explorer .forecast-controls{float:right}.ml-app .ml-time-series-explorer .ml-timeseries-chart svg{font-size:12px;font-family:"Inter",-apple-system,BlinkMacSystemFont,"Segoe UI",Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol"}.ml-app .ml-time-series-explorer .ml-timeseries-chart .axis path,.ml-app .ml-time-series-explorer .ml-timeseries-chart .axis line{fill:none;stroke:#D3DAE6;shape-rendering:crispEdges;pointer-events:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .axis text{fill:#343741}.ml-app .ml-time-series-explorer .ml-timeseries-chart .axis .tick line{stroke:#D3DAE6}.ml-app .ml-time-series-explorer .ml-timeseries-chart .chart-border{stroke:#D3DAE6;fill:none;stroke-width:1;shape-rendering:crispEdges}.ml-app .ml-time-series-explorer .ml-timeseries-chart .chart-border-highlight{stroke:#69707D;stroke-width:2}.ml-app .ml-time-series-explorer .ml-timeseries-chart .chart-border-highlight:hover{opacity:1}.ml-app .ml-time-series-explorer .ml-timeseries-chart .area{stroke-width:1}.ml-app .ml-time-series-explorer .ml-timeseries-chart .area.bounds{fill:rgba(0,119,204,0.2);pointer-events:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .values-line{fill:none;stroke:#07C;stroke-width:2;pointer-events:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .values-line.forecast{stroke:#D6BF57;pointer-events:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .hidden{visibility:hidden}.ml-app .ml-time-series-explorer .ml-timeseries-chart .area.forecast{fill:rgba(214,191,87,0.3);pointer-events:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .metric-value{opacity:1;fill:transparent;stroke:#07C;stroke-width:0}.ml-app .ml-time-series-explorer .ml-timeseries-chart .anomaly-marker{stroke-width:1px;stroke:#98A2B3}.ml-app .ml-time-series-explorer .ml-timeseries-chart .anomaly-marker.critical{fill:#FE5050}.ml-app .ml-time-series-explorer .ml-timeseries-chart .anomaly-marker.major{fill:#FBA740}.ml-app .ml-time-series-explorer .ml-timeseries-chart .anomaly-marker.minor{fill:#FDEC25}.ml-app .ml-time-series-explorer .ml-timeseries-chart .anomaly-marker.warning{fill:#8BC8FB}.ml-app .ml-time-series-explorer .ml-timeseries-chart .anomaly-marker.low{fill:#D2E9F7}.ml-app .ml-time-series-explorer .ml-timeseries-chart .metric-value:hover,.ml-app .ml-time-series-explorer .ml-timeseries-chart .anomaly-marker:hover,.ml-app .ml-time-series-explorer .ml-timeseries-chart .anomaly-marker.highlighted{stroke-width:6px;stroke-opacity:.65;stroke:#07C}.ml-app .ml-time-series-explorer .ml-timeseries-chart rect.scheduled-event-marker{stroke-width:1px;stroke:#69707D;fill:#D3DAE6;pointer-events:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .forecast .metric-value,.ml-app .ml-time-series-explorer .ml-timeseries-chart .forecast .metric-value:hover{stroke:#D6BF57}.ml-app .ml-time-series-explorer .ml-timeseries-chart .focus-chart .x-axis-background line{fill:none;shape-rendering:crispEdges;stroke:#F5F7FA}.ml-app .ml-time-series-explorer .ml-timeseries-chart .focus-chart .x-axis-background rect{fill:#F5F7FA}.ml-app .ml-time-series-explorer .ml-timeseries-chart .focus-chart .focus-zoom{fill:#69707D}.ml-app .ml-time-series-explorer .ml-timeseries-chart .focus-chart .focus-zoom a text{fill:#07C;cursor:pointer}.ml-app .ml-time-series-explorer .ml-timeseries-chart .focus-chart .focus-zoom a:hover,.ml-app .ml-time-series-explorer .ml-timeseries-chart .focus-chart .focus-zoom a:active,.ml-app .ml-time-series-explorer .ml-timeseries-chart .focus-chart .focus-zoom a:focus{text-decoration:underline}.ml-app .ml-time-series-explorer .ml-timeseries-chart .context-chart .x.axis path{display:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .context-chart .axis text{font-size:10px;fill:#343741}.ml-app .ml-time-series-explorer .ml-timeseries-chart .context-chart .values-line{stroke-width:1}.ml-app .ml-time-series-explorer .ml-timeseries-chart .context-chart .mask polygon{fill-opacity:.1}.ml-app .ml-time-series-explorer .ml-timeseries-chart .context-chart .mask .area.bounds{fill:#D3DAE6}.ml-app .ml-time-series-explorer .ml-timeseries-chart .context-chart .mask .values-line{stroke-width:1;stroke:#98A2B3}.ml-app .ml-time-series-explorer .ml-timeseries-chart .swimlane .axis text{display:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .swimlane rect.swimlane-cell-hidden{display:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .brush .extent{fill-opacity:0;shape-rendering:crispEdges;stroke:#69707D;stroke-width:2;cursor:move}.ml-app .ml-time-series-explorer .ml-timeseries-chart .brush .extent:hover{opacity:1}.ml-app .ml-time-series-explorer .ml-timeseries-chart .top-border{fill:#fff}.ml-app .ml-time-series-explorer .ml-timeseries-chart foreignObject.brush-handle{pointer-events:none;padding-top:1px}.ml-app .ml-time-series-explorer .ml-timeseries-chart div.brush-handle-inner{border:1px solid #69707D;background-color:#D3DAE6;height:70px;width:10px;text-align:center;cursor:ew-resize;margin-top:9px;font-size:14px;fill:#69707D}.ml-app .ml-time-series-explorer .ml-timeseries-chart div.brush-handle-inner-left{border-radius:6px 0 0 6px}.ml-app .ml-time-series-explorer .ml-timeseries-chart div.brush-handle-inner-right{border-radius:0 6px 6px 0}.ml-app .ml-time-series-explorer .ml-timeseries-chart rect.brush-handle{stroke-width:1;stroke:#69707D;fill:#D3DAE6;pointer-events:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart rect.brush-handle:hover{opacity:1}.ml-app .mlTimeSeriesExplorerProgress{background-color:#fff}.ml-app .mlTimeSeriesExplorerProgress::-moz-progress-bar,.ml-app .mlTimeSeriesExplorerProgress::-webkit-progress-bar{background-color:#fff}.ml-app .mlAnnotationBrush .extent{stroke:#D3DAE6;stroke-width:2px;stroke-dasharray:2 2;fill:#F5F7FA;shape-rendering:geometricPrecision}.ml-app .mlAnnotationRect{stroke:#000;stroke-width:2px;stroke-opacity:.2;transition:stroke-opacity 150ms;fill:#000;fill-opacity:.05;transition:fill-opacity 150ms;shape-rendering:geometricPrecision}.ml-app .mlAnnotationRect-isHighlight{stroke-opacity:.4;transition:stroke-opacity 150ms;fill-opacity:.1;transition:fill-opacity 150ms}.ml-app .mlAnnotationRect-isBlur{stroke-opacity:.1;transition:stroke-opacity 150ms;fill-opacity:.025;transition:fill-opacity 150ms}.ml-app .mlAnnotationText{text-anchor:middle;font-size:12px;font-family:"Inter",-apple-system,BlinkMacSystemFont,"Segoe UI",Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";font-weight:500;fill:#000;transition:fill 150ms;-webkit-user-select:none;user-select:none}.ml-app .mlAnnotationText-isBlur{fill:#98A2B3;transition:fill 150ms}.ml-app .mlAnnotationTextRect{fill:#D3DAE6;transition:fill 150ms}.ml-app .mlAnnotationTextRect-isBlur{fill:#F5F7FA;transition:fill 150ms}.ml-app .mlAnnotationHidden{display:none}.ml-app .mlContextAnnotationRect{stroke:#000;stroke-width:2px;stroke-opacity:.2;transition:stroke-opacity 150ms;fill:#000;fill-opacity:.05;transition:fill-opacity 150ms;shape-rendering:geometricPrecision}.ml-app .mlContextAnnotationRect-isBlur{stroke-opacity:.1;transition:stroke-opacity 150ms;fill-opacity:.025;transition:fill-opacity 150ms}.ml-app .euiDescriptionList.euiDescriptionList--column.ml-annotation-description-list .euiDescriptionList__title{flex-basis:30%}.ml-app .euiDescriptionList.euiDescriptionList--column.ml-annotation-description-list .euiDescriptionList__description{flex-basis:70%}.ml-app .euiDescriptionList.euiDescriptionList--column.ml-annotation-description-list>*{margin-top:4px}.ml-app .ml-anomalies-table .ml-icon-severity-critical,.ml-app .ml-anomalies-table .ml-icon-severity-major,.ml-app .ml-anomalies-table .ml-icon-severity-minor,.ml-app .ml-anomalies-table .ml-icon-severity-warning,.ml-app .ml-anomalies-table .ml-icon-severity-unknown{color:inherit;text-shadow:none}.ml-app .ml-anomalies-table .ml-icon-severity-critical .euiIcon{fill:#cf4141}.ml-app .ml-anomalies-table .ml-icon-severity-major .euiIcon{fill:#9e6929}.ml-app .ml-anomalies-table .ml-icon-severity-minor .euiIcon{fill:#7c7313}.ml-app .ml-anomalies-table .ml-icon-severity-warning .euiIcon{fill:#537896}.ml-app .ml-anomalies-table .ml-icon-severity-unknown .euiIcon{fill:#69707D}.ml-app .ml-anomalies-table tr th:first-child,.ml-app .ml-anomalies-table tr td:first-child{width:32px}.ml-app .ml-anomalies-table .euiTableCellContent .euiHealth{font-size:inherit}.ml-app .ml-anomalies-table .euiTableCellContent .detector-rules-icon{margin-left:4px;opacity:.5}.ml-app .ml-anomalies-table .euiContextMenuItem{min-width:150px}.ml-app .ml-anomalies-table .mlAnomalyCategoryExamples__header{display:inline}.ml-app .ml-anomalies-table .mlAnomalyCategoryExamples__link{width:100%}.ml-app .ml-anomalies-table .category-example{display:block;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.ml-app .ml-anomalies-table .mlAnomalyCategoryExamples{padding:24px}.ml-app .ml-anomalies-table .mlAnomalyCategoryExamples__item{display:block;white-space:wrap;font-family:"Roboto Mono",Consolas,Menlo,Courier,monospace}.ml-app .ml-anomalies-table .interim-result{font-style:italic}.ml-app .ml-anomalies-table .ml-anomalies-table-details{padding:4px 32px;max-height:1000px;overflow-y:auto}.ml-app .ml-anomalies-table .ml-anomalies-table-details .anomaly-description-list .euiDescriptionList__title{margin-top:0;flex-basis:15%;font-size:inherit;line-height:1.5rem;max-width:100%;overflow:hidden !important;text-overflow:ellipsis !important;white-space:nowrap !important;word-wrap:normal !important}.ml-app .ml-anomalies-table .ml-anomalies-table-details .anomaly-description-list .euiDescriptionList__description{margin-top:0;flex-basis:85%;font-size:inherit;line-height:1.5rem}.ml-app .mlColorRangeLegend text{font-size:10px;font-size:.71429rem;fill:#69707D}.ml-app .mlColorRangeLegend .axis path{fill:none;stroke:none}.ml-app .mlColorRangeLegend .axis line{fill:none;stroke:#98A2B3;shape-rendering:crispEdges}.ml-app .ml-table-controls label{font-size:12px;padding:0 0 4px 4px}.ml-app .ml-table-controls .ml-table-controls-element{display:inline-block;padding-left:16px}.ml-app .ml-table-controls select{font-size:12px;font-style:normal}.ml-app .ml-select-severity .euiFormControlLayoutClearButton{display:none}.ml-app .field-value-short{max-width:100%;overflow:hidden !important;text-overflow:ellipsis !important;white-space:nowrap !important;word-wrap:normal !important;display:inline-block;vertical-align:bottom}.ml-app .field-value-long{overflow-wrap:break-word}.ml-app .filter-button{opacity:.5;width:16px;height:16px;transform:translateY(-1px)}.ml-app .filter-button .euiIcon{width:12px;height:12px}.ml-app .filter-button:hover{opacity:1}.ml-app .ml-influencers-list{line-height:1.45}.ml-app .ml-influencers-list .field-label{font-size:12px;text-align:left;max-height:14px;max-width:calc(100% - 102px)}.ml-app .ml-influencers-list .field-label .field-value{max-width:100%;overflow:hidden !important;text-overflow:ellipsis !important;white-space:nowrap !important;word-wrap:normal !important;display:inline-block;vertical-align:bottom}.ml-app .ml-influencers-list .progress{display:inline-block;width:calc(100% - 34px);height:22px;min-width:70px;margin-bottom:0;color:#69707D;background-color:transparent}.ml-app .ml-influencers-list .progress .progress-bar-holder{width:calc(100% - 28px)}.ml-app .ml-influencers-list .progress .progress-bar{height:2px;margin-top:12px;text-align:right;line-height:18px;display:inline-block;transition:none}.ml-app .ml-influencers-list .progress.critical .progress-bar{background-color:#FE5050}.ml-app .ml-influencers-list .progress.critical .score-label{border-color:#FE5050}.ml-app .ml-influencers-list .progress.major .progress-bar{background-color:#FBA740}.ml-app .ml-influencers-list .progress.major .score-label{border-color:#FBA740}.ml-app .ml-influencers-list .progress.minor .progress-bar{background-color:#FDEC25}.ml-app .ml-influencers-list .progress.minor .score-label{border-color:#FDEC25}.ml-app .ml-influencers-list .progress.warning .progress-bar{background-color:#8BC8FB}.ml-app .ml-influencers-list .progress.warning .score-label{border-color:#8BC8FB}.ml-app .ml-influencers-list .score-label{text-align:center;line-height:14px;white-space:nowrap;font-size:12px;display:inline;margin-left:4px}.ml-app .ml-influencers-list .total-score-label{width:32px;vertical-align:top;text-align:center;color:#69707D;font-size:11px;line-height:14px;border-radius:6px;padding:2px;margin-top:4px;display:inline-block;border:1px solid #D3DAE6}.ml-app .ml-influencers-list-tooltip{word-break:break-all}.ml-app .ml-items-grid-page-size-menu{width:140px}.ml-app .mlJobSelectorBar{padding:8px}.ml-app .mlJobSelectorFlyoutBody>.euiFlyoutBody__overflow{padding-top:8px}.ml-app .mlJobSelector__ganttBar{background-color:#79ADDA;height:12px;border-radius:2px}.ml-app .mlJobSelector__ganttBarBackEdge{height:16px;border-left:1px solid #D6D6D6;border-right:1px solid #D6D6D6;margin-bottom:-14px;padding-top:8px}.ml-app .mlJobSelector__ganttBarDashed{height:1px;border-top:1px dashed #D6D6D6}.ml-app .mlJobSelector__ganttBarRunning{background-image:linear-gradient(45deg, rgba(255,255,255,0.15) 25%, transparent 25%, transparent 50%, rgba(255,255,255,0.15) 50%, rgba(255,255,255,0.15) 75%, transparent 75%, transparent);background-size:40px 40px;animation:progress-bar-stripes 2s linear infinite}.ml-app .ml-loading-indicator{text-align:center;font-size:17px;display:flex;flex-direction:column;align-items:center;justify-content:center}.ml-app .ml-rule-editor-flyout{font-size:14px}.ml-app .ml-rule-editor-flyout .select-rule-action .rule-detector-description-list{padding-left:16px}.ml-app .ml-rule-editor-flyout .select-rule-action-panel{padding:8px 0}.ml-app .ml-rule-editor-flyout .select-rule-action-panel .euiDescriptionList .euiDescriptionList__title{flex-basis:15%;padding:0 16px}.ml-app .ml-rule-editor-flyout .select-rule-action-panel .euiDescriptionList .euiDescriptionList__description{flex-basis:85%}.ml-app .ml-rule-editor-flyout .select-rule-action-panel .euiDescriptionList .euiDescriptionList__title:nth-child(1),.ml-app .ml-rule-editor-flyout .select-rule-action-panel .euiDescriptionList .euiDescriptionList__description:nth-child(2){color:#1a1c21;font-weight:700;border-bottom:1px solid #D3DAE6;padding-bottom:12px}.ml-app .ml-rule-editor-flyout .select-rule-action-panel .euiDescriptionList .euiDescriptionList__title:nth-child(3),.ml-app .ml-rule-editor-flyout .select-rule-action-panel .euiDescriptionList .euiDescriptionList__description:nth-child(4){padding-top:8px}.ml-app .ml-rule-editor-flyout .select-rule-action-panel .euiDescriptionList.euiDescriptionList--column>*{margin-top:4px}.ml-app .ml-rule-editor-flyout .scope-enable-checkbox .euiCheckbox__input[disabled] ~ .euiCheckbox__label{color:inherit}.ml-app .ml-rule-editor-flyout .scope-field-checkbox{margin-right:2px}.ml-app .ml-rule-editor-flyout .scope-field-checkbox .euiCheckbox{margin-top:4px}.ml-app .ml-rule-editor-flyout .scope-field-button{pointer-events:none;border-bottom:none}.ml-app .ml-rule-editor-flyout .scope-edit-filter-link{line-height:32px;font-size:12px}.ml-app .ml-rule-editor-flyout .condition-edit-value-field{width:170px;height:28px;margin:0 2px}.ml-app .ml-rule-editor-flyout .condition-edit-value-field input{height:28px}.ml-app .ml-rule-editor-flyout .euiExpressionButton.disabled{pointer-events:none}.ml-app .ml-rule-editor-flyout .euiExpressionButton.disabled .euiExpressionButton__value,.ml-app .ml-rule-editor-flyout .euiExpressionButton.disabled .euiExpressionButton__description{color:#D3DAE6}.ml-app .ml-rule-editor-flyout .text-highlight{font-weight:700}.ml-app .euiDescriptionList.euiDescriptionList--column.rule-detector-description-list .euiDescriptionList__title{flex-basis:15%}.ml-app .euiDescriptionList.euiDescriptionList--column.rule-detector-description-list .euiDescriptionList__description{flex-basis:85%}.ml-app .euiDescriptionList.euiDescriptionList--column.rule-detector-description-list>*{margin-top:4px}.ml-app .stat{margin-right:8px}.ml-app .mlStatsBar{height:42px;padding:14px;background-color:#F5F7FA}.ml-app .mlEmbeddedMapContent{width:100%;height:100%;display:flex;flex:1 1 100%;z-index:1;min-height:0}.ml-app .tab-datavisualizer_index_select,.ml-app .tab-timeseriesexplorer,.ml-app .tab-explorer{background-color:#fff}.ml-app .button-wrapper{display:inline}.ml-app .button-wrapper.disabled .kuiButton[disabled]{pointer-events:none}.ml-app .button-wrapper.disabled{cursor:not-allowed}.ml-app .clear,.ml-app .clearfix{clear:both}.ml-app .mlDisableAntiAliasing{-webkit-font-smoothing:none}.ml-app .mlDisableAntiAliasing * canvas{image-rendering:pixelated}\n',""]),e.exports=t},,,,,function(e,t,a){switch(window.__kbnThemeTag__){case"v7dark":return a(406);case"v7light":return a(408);case"v8dark":return a(410);case"v8light":return a(412)}},function(e,t,a){var i=a(68),n=a(407);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var s={insert:"head",singleton:!1};i(n,s);e.exports=n.locals||{}},function(e,t,a){(t=a(69)(!1)).push([e.i,".mlMainTabs{padding-bottom:0 !important}\n",""]),e.exports=t},function(e,t,a){var i=a(68),n=a(409);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var s={insert:"head",singleton:!1};i(n,s);e.exports=n.locals||{}},function(e,t,a){(t=a(69)(!1)).push([e.i,".mlMainTabs{padding-bottom:0 !important}\n",""]),e.exports=t},function(e,t,a){var i=a(68),n=a(411);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var s={insert:"head",singleton:!1};i(n,s);e.exports=n.locals||{}},function(e,t,a){(t=a(69)(!1)).push([e.i,".mlMainTabs{padding-bottom:0 !important}\n",""]),e.exports=t},function(e,t,a){var i=a(68),n=a(413);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var s={insert:"head",singleton:!1};i(n,s);e.exports=n.locals||{}},function(e,t,a){(t=a(69)(!1)).push([e.i,".mlMainTabs{padding-bottom:0 !important}\n",""]),e.exports=t},,function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"ElasticsearchSqlHighlightRules",{enumerable:!0,get:function(){return i.ElasticsearchSqlHighlightRules}}),Object.defineProperty(t,"ScriptHighlightRules",{enumerable:!0,get:function(){return n.ScriptHighlightRules}}),Object.defineProperty(t,"XJsonHighlightRules",{enumerable:!0,get:function(){return s.XJsonHighlightRules}}),Object.defineProperty(t,"addXJsonToRules",{enumerable:!0,get:function(){return s.addToRules}});var i=a(274),n=a(275),s=a(416)},function(e,t,a){"use strict";var i=a(122);Object.defineProperty(t,"__esModule",{value:!0}),t.XJsonHighlightRules=u,t.addToRules=function(e,t){e.$rules=(0,n.defaultsDeep)(e.$rules,d(t)),e.embedRules(o.ScriptHighlightRules,"script-",[{token:"punctuation.end_triple_quote",regex:'"""',next:"pop"}]),e.embedRules(r.ElasticsearchSqlHighlightRules,"sql-",[{token:"punctuation.end_triple_quote",regex:'"""',next:"pop"}])};var n=a(8),s=i(a(171));a(417);var r=a(274),o=a(275);const{JsonHighlightRules:l}=s.default.acequire("ace/mode/json_highlight_rules"),c=s.default.acequire("ace/lib/oop"),d=function(e){const t={},a=[{token:["variable","whitespace","ace.punctuation.colon","whitespace","punctuation.start_triple_quote"],regex:'("(?:[^"]*_)?script"|"inline"|"source")(\\s*?)(:)(\\s*?)(""")',next:"script-start",merge:!1,push:!0},{token:"variable",regex:'["](?:(?:\\\\.)|(?:[^"\\\\]))*?["]\\s*(?=:)'},{token:"punctuation.start_triple_quote",regex:'"""',next:"string_literal",merge:!1,push:!0},{token:"string",regex:'["](?:(?:\\\\.)|(?:[^"\\\\]))*?["]'},{token:"constant.numeric",regex:"0[xX][0-9a-fA-F]+\\b"},{token:"constant.numeric",regex:"[+-]?\\d+(?:(?:\\.\\d*)?(?:[eE][+-]?\\d+)?)?\\b"},{token:"constant.language.boolean",regex:"(?:true|false)\\b"},{token:"invalid.illegal",regex:"['](?:(?:\\\\.)|(?:[^'\\\\]))*?[']"},{token:"invalid.illegal",regex:"\\/\\/.*$"},{token:"paren.lparen",merge:!1,regex:"{",next:e=e||"json",push:!0},{token:"paren.lparen",merge:!1,regex:"[[(]"},{token:"paren.rparen",merge:!1,regex:"[\\])]"},{token:"paren.rparen",regex:"}",merge:!1,next:"pop"},{token:"punctuation.comma",regex:","},{token:"punctuation.colon",regex:":"},{token:"whitespace",regex:"\\s+"},{token:"text",regex:".+?"}];return t[e]=a,t[e+"-sql"]=[{token:["variable","whitespace","ace.punctuation.colon","whitespace","punctuation.start_triple_quote"],regex:'("query")(\\s*?)(:)(\\s*?)(""")',next:"sql-start",merge:!1,push:!0}].concat(a),t.string_literal=[{token:"punctuation.end_triple_quote",regex:'"""',next:"pop"},{token:"multi_string",regex:"."}],t};function u(){this.$rules={...d("start")},this.embedRules(o.ScriptHighlightRules,"script-",[{token:"punctuation.end_triple_quote",regex:'"""',next:"pop"}]),this.embedRules(r.ElasticsearchSqlHighlightRules,"sql-",[{token:"punctuation.end_triple_quote",regex:'"""',next:"pop"}])}c.inherits(u,l)},function(e,t,a){ace.define("ace/mode/json_highlight_rules",["require","exports","module","ace/lib/oop","ace/mode/text_highlight_rules"],(function(e,t,a){"use strict";var i=e("../lib/oop"),n=e("./text_highlight_rules").TextHighlightRules,s=function(){this.$rules={start:[{token:"variable",regex:'["](?:(?:\\\\.)|(?:[^"\\\\]))*?["]\\s*(?=:)'},{token:"string",regex:'"',next:"string"},{token:"constant.numeric",regex:"0[xX][0-9a-fA-F]+\\b"},{token:"constant.numeric",regex:"[+-]?\\d+(?:(?:\\.\\d*)?(?:[eE][+-]?\\d+)?)?\\b"},{token:"constant.language.boolean",regex:"(?:true|false)\\b"},{token:"text",regex:"['](?:(?:\\\\.)|(?:[^'\\\\]))*?[']"},{token:"comment",regex:"\\/\\/.*$"},{token:"comment.start",regex:"\\/\\*",next:"comment"},{token:"paren.lparen",regex:"[[({]"},{token:"paren.rparen",regex:"[\\])}]"},{token:"text",regex:"\\s+"}],string:[{token:"constant.language.escape",regex:/\\(?:x[0-9a-fA-F]{2}|u[0-9a-fA-F]{4}|["\\\/bfnrt])/},{token:"string",regex:'"|$',next:"start"},{defaultToken:"string"}],comment:[{token:"comment.end",regex:"\\*\\/",next:"start"},{defaultToken:"comment"}]}};i.inherits(s,n),t.JsonHighlightRules=s})),ace.define("ace/mode/matching_brace_outdent",["require","exports","module","ace/range"],(function(e,t,a){"use strict";var i=e("../range").Range,n=function(){};(function(){this.checkOutdent=function(e,t){return!!/^\s+$/.test(e)&&/^\s*\}/.test(t)},this.autoOutdent=function(e,t){var a=e.getLine(t).match(/^(\s*\})/);if(!a)return 0;var n=a[1].length,s=e.findMatchingBracket({row:t,column:n});if(!s||s.row==t)return 0;var r=this.$getIndent(e.getLine(s.row));e.replace(new i(t,0,t,n-1),r)},this.$getIndent=function(e){return e.match(/^\s*/)[0]}}).call(n.prototype),t.MatchingBraceOutdent=n})),ace.define("ace/mode/folding/cstyle",["require","exports","module","ace/lib/oop","ace/range","ace/mode/folding/fold_mode"],(function(e,t,a){"use strict";var i=e("../../lib/oop"),n=e("../../range").Range,s=e("./fold_mode").FoldMode,r=t.FoldMode=function(e){e&&(this.foldingStartMarker=new RegExp(this.foldingStartMarker.source.replace(/\|[^|]*?$/,"|"+e.start)),this.foldingStopMarker=new RegExp(this.foldingStopMarker.source.replace(/\|[^|]*?$/,"|"+e.end)))};i.inherits(r,s),function(){this.foldingStartMarker=/([\{\[\(])[^\}\]\)]*$|^\s*(\/\*)/,this.foldingStopMarker=/^[^\[\{\(]*([\}\]\)])|^[\s\*]*(\*\/)/,this.singleLineBlockCommentRe=/^\s*(\/\*).*\*\/\s*$/,this.tripleStarBlockCommentRe=/^\s*(\/\*\*\*).*\*\/\s*$/,this.startRegionRe=/^\s*(\/\*|\/\/)#?region\b/,this._getFoldWidgetBase=this.getFoldWidget,this.getFoldWidget=function(e,t,a){var i=e.getLine(a);if(this.singleLineBlockCommentRe.test(i)&&!this.startRegionRe.test(i)&&!this.tripleStarBlockCommentRe.test(i))return"";var n=this._getFoldWidgetBase(e,t,a);return!n&&this.startRegionRe.test(i)?"start":n},this.getFoldWidgetRange=function(e,t,a,i){var n,s=e.getLine(a);if(this.startRegionRe.test(s))return this.getCommentRegionBlock(e,s,a);if(n=s.match(this.foldingStartMarker)){var r=n.index;if(n[1])return this.openingBracketBlock(e,n[1],a,r);var o=e.getCommentFoldRange(a,r+n[0].length,1);return o&&!o.isMultiLine()&&(i?o=this.getSectionRange(e,a):"all"!=t&&(o=null)),o}if("markbegin"!==t&&(n=s.match(this.foldingStopMarker))){r=n.index+n[0].length;return n[1]?this.closingBracketBlock(e,n[1],a,r):e.getCommentFoldRange(a,r,-1)}},this.getSectionRange=function(e,t){for(var a=e.getLine(t),i=a.search(/\S/),s=t,r=a.length,o=t+=1,l=e.getLength();++t<l;){var c=(a=e.getLine(t)).search(/\S/);if(-1!==c){if(i>c)break;var d=this.getFoldWidgetRange(e,"all",t);if(d){if(d.start.row<=s)break;if(d.isMultiLine())t=d.end.row;else if(i==c)break}o=t}}return new n(s,r,o,e.getLine(o).length)},this.getCommentRegionBlock=function(e,t,a){for(var i=t.search(/\s*$/),s=e.getLength(),r=a,o=/^\s*(?:\/\*|\/\/|--)#?(end)?region\b/,l=1;++a<s;){t=e.getLine(a);var c=o.exec(t);if(c&&(c[1]?l--:l++,!l))break}if(a>r)return new n(r,i,a,t.length)}}.call(r.prototype)})),ace.define("ace/mode/json",["require","exports","module","ace/lib/oop","ace/mode/text","ace/mode/json_highlight_rules","ace/mode/matching_brace_outdent","ace/mode/behaviour/cstyle","ace/mode/folding/cstyle","ace/worker/worker_client"],(function(e,t,i){"use strict";var n=e("../lib/oop"),s=e("./text").Mode,r=e("./json_highlight_rules").JsonHighlightRules,o=e("./matching_brace_outdent").MatchingBraceOutdent,l=e("./behaviour/cstyle").CstyleBehaviour,c=e("./folding/cstyle").FoldMode,d=e("../worker/worker_client").WorkerClient,u=function(){this.HighlightRules=r,this.$outdent=new o,this.$behaviour=new l,this.foldingRules=new c};n.inherits(u,s),function(){this.getNextLineIndent=function(e,t,a){var i=this.$getIndent(t);"start"==e&&(t.match(/^.*[\{\(\[]\s*$/)&&(i+=a));return i},this.checkOutdent=function(e,t,a){return this.$outdent.checkOutdent(t,a)},this.autoOutdent=function(e,t,a){this.$outdent.autoOutdent(t,a)},this.createWorker=function(e){var t=new d(["ace"],a(418),"JsonWorker");return t.attachToDocument(e.getDocument()),t.on("annotate",(function(t){e.setAnnotations(t.data)})),t.on("terminate",(function(){e.clearAnnotations()})),t},this.$id="ace/mode/json"}.call(u.prototype),t.Mode=u}))},function(e,t){e.exports.id="ace/mode/json_worker",e.exports.src='"no use strict";!function(window){function resolveModuleId(id,paths){for(var testPath=id,tail="";testPath;){var alias=paths[testPath];if("string"==typeof alias)return alias+tail;if(alias)return alias.location.replace(/\\/*$/,"/")+(tail||alias.main||alias.name);if(alias===!1)return"";var i=testPath.lastIndexOf("/");if(-1===i)break;tail=testPath.substr(i)+tail,testPath=testPath.slice(0,i)}return id}if(!(void 0!==window.window&&window.document||window.acequire&&window.define)){window.console||(window.console=function(){var msgs=Array.prototype.slice.call(arguments,0);postMessage({type:"log",data:msgs})},window.console.error=window.console.warn=window.console.log=window.console.trace=window.console),window.window=window,window.ace=window,window.onerror=function(message,file,line,col,err){postMessage({type:"error",data:{message:message,data:err.data,file:file,line:line,col:col,stack:err.stack}})},window.normalizeModule=function(parentId,moduleName){if(-1!==moduleName.indexOf("!")){var chunks=moduleName.split("!");return window.normalizeModule(parentId,chunks[0])+"!"+window.normalizeModule(parentId,chunks[1])}if("."==moduleName.charAt(0)){var base=parentId.split("/").slice(0,-1).join("/");for(moduleName=(base?base+"/":"")+moduleName;-1!==moduleName.indexOf(".")&&previous!=moduleName;){var previous=moduleName;moduleName=moduleName.replace(/^\\.\\//,"").replace(/\\/\\.\\//,"/").replace(/[^\\/]+\\/\\.\\.\\//,"")}}return moduleName},window.acequire=function acequire(parentId,id){if(id||(id=parentId,parentId=null),!id.charAt)throw Error("worker.js acequire() accepts only (parentId, id) as arguments");id=window.normalizeModule(parentId,id);var module=window.acequire.modules[id];if(module)return module.initialized||(module.initialized=!0,module.exports=module.factory().exports),module.exports;if(!window.acequire.tlns)return console.log("unable to load "+id);var path=resolveModuleId(id,window.acequire.tlns);return".js"!=path.slice(-3)&&(path+=".js"),window.acequire.id=id,window.acequire.modules[id]={},importScripts(path),window.acequire(parentId,id)},window.acequire.modules={},window.acequire.tlns={},window.define=function(id,deps,factory){if(2==arguments.length?(factory=deps,"string"!=typeof id&&(deps=id,id=window.acequire.id)):1==arguments.length&&(factory=id,deps=[],id=window.acequire.id),"function"!=typeof factory)return window.acequire.modules[id]={exports:factory,initialized:!0},void 0;deps.length||(deps=["require","exports","module"]);var req=function(childId){return window.acequire(id,childId)};window.acequire.modules[id]={exports:{},factory:function(){var module=this,returnExports=factory.apply(this,deps.map(function(dep){switch(dep){case"require":return req;case"exports":return module.exports;case"module":return module;default:return req(dep)}}));return returnExports&&(module.exports=returnExports),module}}},window.define.amd={},acequire.tlns={},window.initBaseUrls=function(topLevelNamespaces){for(var i in topLevelNamespaces)acequire.tlns[i]=topLevelNamespaces[i]},window.initSender=function(){var EventEmitter=window.acequire("ace/lib/event_emitter").EventEmitter,oop=window.acequire("ace/lib/oop"),Sender=function(){};return function(){oop.implement(this,EventEmitter),this.callback=function(data,callbackId){postMessage({type:"call",id:callbackId,data:data})},this.emit=function(name,data){postMessage({type:"event",name:name,data:data})}}.call(Sender.prototype),new Sender};var main=window.main=null,sender=window.sender=null;window.onmessage=function(e){var msg=e.data;if(msg.event&&sender)sender._signal(msg.event,msg.data);else if(msg.command)if(main[msg.command])main[msg.command].apply(main,msg.args);else{if(!window[msg.command])throw Error("Unknown command:"+msg.command);window[msg.command].apply(window,msg.args)}else if(msg.init){window.initBaseUrls(msg.tlns),acequire("ace/lib/es5-shim"),sender=window.sender=window.initSender();var clazz=acequire(msg.module)[msg.classname];main=window.main=new clazz(sender)}}}}(this),ace.define("ace/lib/oop",["require","exports","module"],function(acequire,exports){"use strict";exports.inherits=function(ctor,superCtor){ctor.super_=superCtor,ctor.prototype=Object.create(superCtor.prototype,{constructor:{value:ctor,enumerable:!1,writable:!0,configurable:!0}})},exports.mixin=function(obj,mixin){for(var key in mixin)obj[key]=mixin[key];return obj},exports.implement=function(proto,mixin){exports.mixin(proto,mixin)}}),ace.define("ace/range",["require","exports","module"],function(acequire,exports){"use strict";var comparePoints=function(p1,p2){return p1.row-p2.row||p1.column-p2.column},Range=function(startRow,startColumn,endRow,endColumn){this.start={row:startRow,column:startColumn},this.end={row:endRow,column:endColumn}};(function(){this.isEqual=function(range){return this.start.row===range.start.row&&this.end.row===range.end.row&&this.start.column===range.start.column&&this.end.column===range.end.column},this.toString=function(){return"Range: ["+this.start.row+"/"+this.start.column+"] -> ["+this.end.row+"/"+this.end.column+"]"},this.contains=function(row,column){return 0==this.compare(row,column)},this.compareRange=function(range){var cmp,end=range.end,start=range.start;return cmp=this.compare(end.row,end.column),1==cmp?(cmp=this.compare(start.row,start.column),1==cmp?2:0==cmp?1:0):-1==cmp?-2:(cmp=this.compare(start.row,start.column),-1==cmp?-1:1==cmp?42:0)},this.comparePoint=function(p){return this.compare(p.row,p.column)},this.containsRange=function(range){return 0==this.comparePoint(range.start)&&0==this.comparePoint(range.end)},this.intersects=function(range){var cmp=this.compareRange(range);return-1==cmp||0==cmp||1==cmp},this.isEnd=function(row,column){return this.end.row==row&&this.end.column==column},this.isStart=function(row,column){return this.start.row==row&&this.start.column==column},this.setStart=function(row,column){"object"==typeof row?(this.start.column=row.column,this.start.row=row.row):(this.start.row=row,this.start.column=column)},this.setEnd=function(row,column){"object"==typeof row?(this.end.column=row.column,this.end.row=row.row):(this.end.row=row,this.end.column=column)},this.inside=function(row,column){return 0==this.compare(row,column)?this.isEnd(row,column)||this.isStart(row,column)?!1:!0:!1},this.insideStart=function(row,column){return 0==this.compare(row,column)?this.isEnd(row,column)?!1:!0:!1},this.insideEnd=function(row,column){return 0==this.compare(row,column)?this.isStart(row,column)?!1:!0:!1},this.compare=function(row,column){return this.isMultiLine()||row!==this.start.row?this.start.row>row?-1:row>this.end.row?1:this.start.row===row?column>=this.start.column?0:-1:this.end.row===row?this.end.column>=column?0:1:0:this.start.column>column?-1:column>this.end.column?1:0},this.compareStart=function(row,column){return this.start.row==row&&this.start.column==column?-1:this.compare(row,column)},this.compareEnd=function(row,column){return this.end.row==row&&this.end.column==column?1:this.compare(row,column)},this.compareInside=function(row,column){return this.end.row==row&&this.end.column==column?1:this.start.row==row&&this.start.column==column?-1:this.compare(row,column)},this.clipRows=function(firstRow,lastRow){if(this.end.row>lastRow)var end={row:lastRow+1,column:0};else if(firstRow>this.end.row)var end={row:firstRow,column:0};if(this.start.row>lastRow)var start={row:lastRow+1,column:0};else if(firstRow>this.start.row)var start={row:firstRow,column:0};return Range.fromPoints(start||this.start,end||this.end)},this.extend=function(row,column){var cmp=this.compare(row,column);if(0==cmp)return this;if(-1==cmp)var start={row:row,column:column};else var end={row:row,column:column};return Range.fromPoints(start||this.start,end||this.end)},this.isEmpty=function(){return this.start.row===this.end.row&&this.start.column===this.end.column},this.isMultiLine=function(){return this.start.row!==this.end.row},this.clone=function(){return Range.fromPoints(this.start,this.end)},this.collapseRows=function(){return 0==this.end.column?new Range(this.start.row,0,Math.max(this.start.row,this.end.row-1),0):new Range(this.start.row,0,this.end.row,0)},this.toScreenRange=function(session){var screenPosStart=session.documentToScreenPosition(this.start),screenPosEnd=session.documentToScreenPosition(this.end);return new Range(screenPosStart.row,screenPosStart.column,screenPosEnd.row,screenPosEnd.column)},this.moveBy=function(row,column){this.start.row+=row,this.start.column+=column,this.end.row+=row,this.end.column+=column}}).call(Range.prototype),Range.fromPoints=function(start,end){return new Range(start.row,start.column,end.row,end.column)},Range.comparePoints=comparePoints,Range.comparePoints=function(p1,p2){return p1.row-p2.row||p1.column-p2.column},exports.Range=Range}),ace.define("ace/apply_delta",["require","exports","module"],function(acequire,exports){"use strict";exports.applyDelta=function(docLines,delta){var row=delta.start.row,startColumn=delta.start.column,line=docLines[row]||"";switch(delta.action){case"insert":var lines=delta.lines;if(1===lines.length)docLines[row]=line.substring(0,startColumn)+delta.lines[0]+line.substring(startColumn);else{var args=[row,1].concat(delta.lines);docLines.splice.apply(docLines,args),docLines[row]=line.substring(0,startColumn)+docLines[row],docLines[row+delta.lines.length-1]+=line.substring(startColumn)}break;case"remove":var endColumn=delta.end.column,endRow=delta.end.row;row===endRow?docLines[row]=line.substring(0,startColumn)+line.substring(endColumn):docLines.splice(row,endRow-row+1,line.substring(0,startColumn)+docLines[endRow].substring(endColumn))}}}),ace.define("ace/lib/event_emitter",["require","exports","module"],function(acequire,exports){"use strict";var EventEmitter={},stopPropagation=function(){this.propagationStopped=!0},preventDefault=function(){this.defaultPrevented=!0};EventEmitter._emit=EventEmitter._dispatchEvent=function(eventName,e){this._eventRegistry||(this._eventRegistry={}),this._defaultHandlers||(this._defaultHandlers={});var listeners=this._eventRegistry[eventName]||[],defaultHandler=this._defaultHandlers[eventName];if(listeners.length||defaultHandler){"object"==typeof e&&e||(e={}),e.type||(e.type=eventName),e.stopPropagation||(e.stopPropagation=stopPropagation),e.preventDefault||(e.preventDefault=preventDefault),listeners=listeners.slice();for(var i=0;listeners.length>i&&(listeners[i](e,this),!e.propagationStopped);i++);return defaultHandler&&!e.defaultPrevented?defaultHandler(e,this):void 0}},EventEmitter._signal=function(eventName,e){var listeners=(this._eventRegistry||{})[eventName];if(listeners){listeners=listeners.slice();for(var i=0;listeners.length>i;i++)listeners[i](e,this)}},EventEmitter.once=function(eventName,callback){var _self=this;callback&&this.addEventListener(eventName,function newCallback(){_self.removeEventListener(eventName,newCallback),callback.apply(null,arguments)})},EventEmitter.setDefaultHandler=function(eventName,callback){var handlers=this._defaultHandlers;if(handlers||(handlers=this._defaultHandlers={_disabled_:{}}),handlers[eventName]){var old=handlers[eventName],disabled=handlers._disabled_[eventName];disabled||(handlers._disabled_[eventName]=disabled=[]),disabled.push(old);var i=disabled.indexOf(callback);-1!=i&&disabled.splice(i,1)}handlers[eventName]=callback},EventEmitter.removeDefaultHandler=function(eventName,callback){var handlers=this._defaultHandlers;if(handlers){var disabled=handlers._disabled_[eventName];if(handlers[eventName]==callback)handlers[eventName],disabled&&this.setDefaultHandler(eventName,disabled.pop());else if(disabled){var i=disabled.indexOf(callback);-1!=i&&disabled.splice(i,1)}}},EventEmitter.on=EventEmitter.addEventListener=function(eventName,callback,capturing){this._eventRegistry=this._eventRegistry||{};var listeners=this._eventRegistry[eventName];return listeners||(listeners=this._eventRegistry[eventName]=[]),-1==listeners.indexOf(callback)&&listeners[capturing?"unshift":"push"](callback),callback},EventEmitter.off=EventEmitter.removeListener=EventEmitter.removeEventListener=function(eventName,callback){this._eventRegistry=this._eventRegistry||{};var listeners=this._eventRegistry[eventName];if(listeners){var index=listeners.indexOf(callback);-1!==index&&listeners.splice(index,1)}},EventEmitter.removeAllListeners=function(eventName){this._eventRegistry&&(this._eventRegistry[eventName]=[])},exports.EventEmitter=EventEmitter}),ace.define("ace/anchor",["require","exports","module","ace/lib/oop","ace/lib/event_emitter"],function(acequire,exports){"use strict";var oop=acequire("./lib/oop"),EventEmitter=acequire("./lib/event_emitter").EventEmitter,Anchor=exports.Anchor=function(doc,row,column){this.$onChange=this.onChange.bind(this),this.attach(doc),column===void 0?this.setPosition(row.row,row.column):this.setPosition(row,column)};(function(){function $pointsInOrder(point1,point2,equalPointsInOrder){var bColIsAfter=equalPointsInOrder?point1.column<=point2.column:point1.column<point2.column;return point1.row<point2.row||point1.row==point2.row&&bColIsAfter}function $getTransformedPoint(delta,point,moveIfEqual){var deltaIsInsert="insert"==delta.action,deltaRowShift=(deltaIsInsert?1:-1)*(delta.end.row-delta.start.row),deltaColShift=(deltaIsInsert?1:-1)*(delta.end.column-delta.start.column),deltaStart=delta.start,deltaEnd=deltaIsInsert?deltaStart:delta.end;return $pointsInOrder(point,deltaStart,moveIfEqual)?{row:point.row,column:point.column}:$pointsInOrder(deltaEnd,point,!moveIfEqual)?{row:point.row+deltaRowShift,column:point.column+(point.row==deltaEnd.row?deltaColShift:0)}:{row:deltaStart.row,column:deltaStart.column}}oop.implement(this,EventEmitter),this.getPosition=function(){return this.$clipPositionToDocument(this.row,this.column)},this.getDocument=function(){return this.document},this.$insertRight=!1,this.onChange=function(delta){if(!(delta.start.row==delta.end.row&&delta.start.row!=this.row||delta.start.row>this.row)){var point=$getTransformedPoint(delta,{row:this.row,column:this.column},this.$insertRight);this.setPosition(point.row,point.column,!0)}},this.setPosition=function(row,column,noClip){var pos;if(pos=noClip?{row:row,column:column}:this.$clipPositionToDocument(row,column),this.row!=pos.row||this.column!=pos.column){var old={row:this.row,column:this.column};this.row=pos.row,this.column=pos.column,this._signal("change",{old:old,value:pos})}},this.detach=function(){this.document.removeEventListener("change",this.$onChange)},this.attach=function(doc){this.document=doc||this.document,this.document.on("change",this.$onChange)},this.$clipPositionToDocument=function(row,column){var pos={};return row>=this.document.getLength()?(pos.row=Math.max(0,this.document.getLength()-1),pos.column=this.document.getLine(pos.row).length):0>row?(pos.row=0,pos.column=0):(pos.row=row,pos.column=Math.min(this.document.getLine(pos.row).length,Math.max(0,column))),0>column&&(pos.column=0),pos}}).call(Anchor.prototype)}),ace.define("ace/document",["require","exports","module","ace/lib/oop","ace/apply_delta","ace/lib/event_emitter","ace/range","ace/anchor"],function(acequire,exports){"use strict";var oop=acequire("./lib/oop"),applyDelta=acequire("./apply_delta").applyDelta,EventEmitter=acequire("./lib/event_emitter").EventEmitter,Range=acequire("./range").Range,Anchor=acequire("./anchor").Anchor,Document=function(textOrLines){this.$lines=[""],0===textOrLines.length?this.$lines=[""]:Array.isArray(textOrLines)?this.insertMergedLines({row:0,column:0},textOrLines):this.insert({row:0,column:0},textOrLines)};(function(){oop.implement(this,EventEmitter),this.setValue=function(text){var len=this.getLength()-1;this.remove(new Range(0,0,len,this.getLine(len).length)),this.insert({row:0,column:0},text)},this.getValue=function(){return this.getAllLines().join(this.getNewLineCharacter())},this.createAnchor=function(row,column){return new Anchor(this,row,column)},this.$split=0==="aaa".split(/a/).length?function(text){return text.replace(/\\r\\n|\\r/g,"\\n").split("\\n")}:function(text){return text.split(/\\r\\n|\\r|\\n/)},this.$detectNewLine=function(text){var match=text.match(/^.*?(\\r\\n|\\r|\\n)/m);this.$autoNewLine=match?match[1]:"\\n",this._signal("changeNewLineMode")},this.getNewLineCharacter=function(){switch(this.$newLineMode){case"windows":return"\\r\\n";case"unix":return"\\n";default:return this.$autoNewLine||"\\n"}},this.$autoNewLine="",this.$newLineMode="auto",this.setNewLineMode=function(newLineMode){this.$newLineMode!==newLineMode&&(this.$newLineMode=newLineMode,this._signal("changeNewLineMode"))},this.getNewLineMode=function(){return this.$newLineMode},this.isNewLine=function(text){return"\\r\\n"==text||"\\r"==text||"\\n"==text},this.getLine=function(row){return this.$lines[row]||""},this.getLines=function(firstRow,lastRow){return this.$lines.slice(firstRow,lastRow+1)},this.getAllLines=function(){return this.getLines(0,this.getLength())},this.getLength=function(){return this.$lines.length},this.getTextRange=function(range){return this.getLinesForRange(range).join(this.getNewLineCharacter())},this.getLinesForRange=function(range){var lines;if(range.start.row===range.end.row)lines=[this.getLine(range.start.row).substring(range.start.column,range.end.column)];else{lines=this.getLines(range.start.row,range.end.row),lines[0]=(lines[0]||"").substring(range.start.column);var l=lines.length-1;range.end.row-range.start.row==l&&(lines[l]=lines[l].substring(0,range.end.column))}return lines},this.insertLines=function(row,lines){return console.warn("Use of document.insertLines is deprecated. Use the insertFullLines method instead."),this.insertFullLines(row,lines)},this.removeLines=function(firstRow,lastRow){return console.warn("Use of document.removeLines is deprecated. Use the removeFullLines method instead."),this.removeFullLines(firstRow,lastRow)},this.insertNewLine=function(position){return console.warn("Use of document.insertNewLine is deprecated. Use insertMergedLines(position, [\'\', \'\']) instead."),this.insertMergedLines(position,["",""])},this.insert=function(position,text){return 1>=this.getLength()&&this.$detectNewLine(text),this.insertMergedLines(position,this.$split(text))},this.insertInLine=function(position,text){var start=this.clippedPos(position.row,position.column),end=this.pos(position.row,position.column+text.length);return this.applyDelta({start:start,end:end,action:"insert",lines:[text]},!0),this.clonePos(end)},this.clippedPos=function(row,column){var length=this.getLength();void 0===row?row=length:0>row?row=0:row>=length&&(row=length-1,column=void 0);var line=this.getLine(row);return void 0==column&&(column=line.length),column=Math.min(Math.max(column,0),line.length),{row:row,column:column}},this.clonePos=function(pos){return{row:pos.row,column:pos.column}},this.pos=function(row,column){return{row:row,column:column}},this.$clipPosition=function(position){var length=this.getLength();return position.row>=length?(position.row=Math.max(0,length-1),position.column=this.getLine(length-1).length):(position.row=Math.max(0,position.row),position.column=Math.min(Math.max(position.column,0),this.getLine(position.row).length)),position},this.insertFullLines=function(row,lines){row=Math.min(Math.max(row,0),this.getLength());var column=0;this.getLength()>row?(lines=lines.concat([""]),column=0):(lines=[""].concat(lines),row--,column=this.$lines[row].length),this.insertMergedLines({row:row,column:column},lines)},this.insertMergedLines=function(position,lines){var start=this.clippedPos(position.row,position.column),end={row:start.row+lines.length-1,column:(1==lines.length?start.column:0)+lines[lines.length-1].length};return this.applyDelta({start:start,end:end,action:"insert",lines:lines}),this.clonePos(end)},this.remove=function(range){var start=this.clippedPos(range.start.row,range.start.column),end=this.clippedPos(range.end.row,range.end.column);return this.applyDelta({start:start,end:end,action:"remove",lines:this.getLinesForRange({start:start,end:end})}),this.clonePos(start)},this.removeInLine=function(row,startColumn,endColumn){var start=this.clippedPos(row,startColumn),end=this.clippedPos(row,endColumn);return this.applyDelta({start:start,end:end,action:"remove",lines:this.getLinesForRange({start:start,end:end})},!0),this.clonePos(start)},this.removeFullLines=function(firstRow,lastRow){firstRow=Math.min(Math.max(0,firstRow),this.getLength()-1),lastRow=Math.min(Math.max(0,lastRow),this.getLength()-1);var deleteFirstNewLine=lastRow==this.getLength()-1&&firstRow>0,deleteLastNewLine=this.getLength()-1>lastRow,startRow=deleteFirstNewLine?firstRow-1:firstRow,startCol=deleteFirstNewLine?this.getLine(startRow).length:0,endRow=deleteLastNewLine?lastRow+1:lastRow,endCol=deleteLastNewLine?0:this.getLine(endRow).length,range=new Range(startRow,startCol,endRow,endCol),deletedLines=this.$lines.slice(firstRow,lastRow+1);return this.applyDelta({start:range.start,end:range.end,action:"remove",lines:this.getLinesForRange(range)}),deletedLines},this.removeNewLine=function(row){this.getLength()-1>row&&row>=0&&this.applyDelta({start:this.pos(row,this.getLine(row).length),end:this.pos(row+1,0),action:"remove",lines:["",""]})},this.replace=function(range,text){if(range instanceof Range||(range=Range.fromPoints(range.start,range.end)),0===text.length&&range.isEmpty())return range.start;if(text==this.getTextRange(range))return range.end;this.remove(range);var end;return end=text?this.insert(range.start,text):range.start},this.applyDeltas=function(deltas){for(var i=0;deltas.length>i;i++)this.applyDelta(deltas[i])},this.revertDeltas=function(deltas){for(var i=deltas.length-1;i>=0;i--)this.revertDelta(deltas[i])},this.applyDelta=function(delta,doNotValidate){var isInsert="insert"==delta.action;(isInsert?1>=delta.lines.length&&!delta.lines[0]:!Range.comparePoints(delta.start,delta.end))||(isInsert&&delta.lines.length>2e4&&this.$splitAndapplyLargeDelta(delta,2e4),applyDelta(this.$lines,delta,doNotValidate),this._signal("change",delta))},this.$splitAndapplyLargeDelta=function(delta,MAX){for(var lines=delta.lines,l=lines.length,row=delta.start.row,column=delta.start.column,from=0,to=0;;){from=to,to+=MAX-1;var chunk=lines.slice(from,to);if(to>l){delta.lines=chunk,delta.start.row=row+from,delta.start.column=column;break}chunk.push(""),this.applyDelta({start:this.pos(row+from,column),end:this.pos(row+to,column=0),action:delta.action,lines:chunk},!0)}},this.revertDelta=function(delta){this.applyDelta({start:this.clonePos(delta.start),end:this.clonePos(delta.end),action:"insert"==delta.action?"remove":"insert",lines:delta.lines.slice()})},this.indexToPosition=function(index,startRow){for(var lines=this.$lines||this.getAllLines(),newlineLength=this.getNewLineCharacter().length,i=startRow||0,l=lines.length;l>i;i++)if(index-=lines[i].length+newlineLength,0>index)return{row:i,column:index+lines[i].length+newlineLength};return{row:l-1,column:lines[l-1].length}},this.positionToIndex=function(pos,startRow){for(var lines=this.$lines||this.getAllLines(),newlineLength=this.getNewLineCharacter().length,index=0,row=Math.min(pos.row,lines.length),i=startRow||0;row>i;++i)index+=lines[i].length+newlineLength;return index+pos.column}}).call(Document.prototype),exports.Document=Document}),ace.define("ace/lib/lang",["require","exports","module"],function(acequire,exports){"use strict";exports.last=function(a){return a[a.length-1]},exports.stringReverse=function(string){return string.split("").reverse().join("")},exports.stringRepeat=function(string,count){for(var result="";count>0;)1&count&&(result+=string),(count>>=1)&&(string+=string);return result};var trimBeginRegexp=/^\\s\\s*/,trimEndRegexp=/\\s\\s*$/;exports.stringTrimLeft=function(string){return string.replace(trimBeginRegexp,"")},exports.stringTrimRight=function(string){return string.replace(trimEndRegexp,"")},exports.copyObject=function(obj){var copy={};for(var key in obj)copy[key]=obj[key];return copy},exports.copyArray=function(array){for(var copy=[],i=0,l=array.length;l>i;i++)copy[i]=array[i]&&"object"==typeof array[i]?this.copyObject(array[i]):array[i];return copy},exports.deepCopy=function deepCopy(obj){if("object"!=typeof obj||!obj)return obj;var copy;if(Array.isArray(obj)){copy=[];for(var key=0;obj.length>key;key++)copy[key]=deepCopy(obj[key]);return copy}if("[object Object]"!==Object.prototype.toString.call(obj))return obj;copy={};for(var key in obj)copy[key]=deepCopy(obj[key]);return copy},exports.arrayToMap=function(arr){for(var map={},i=0;arr.length>i;i++)map[arr[i]]=1;return map},exports.createMap=function(props){var map=Object.create(null);for(var i in props)map[i]=props[i];return map},exports.arrayRemove=function(array,value){for(var i=0;array.length>=i;i++)value===array[i]&&array.splice(i,1)},exports.escapeRegExp=function(str){return str.replace(/([.*+?^${}()|[\\]\\/\\\\])/g,"\\\\$1")},exports.escapeHTML=function(str){return str.replace(/&/g,"&#38;").replace(/"/g,"&#34;").replace(/\'/g,"&#39;").replace(/</g,"&#60;")},exports.getMatchOffsets=function(string,regExp){var matches=[];return string.replace(regExp,function(str){matches.push({offset:arguments[arguments.length-2],length:str.length})}),matches},exports.deferredCall=function(fcn){var timer=null,callback=function(){timer=null,fcn()},deferred=function(timeout){return deferred.cancel(),timer=setTimeout(callback,timeout||0),deferred};return deferred.schedule=deferred,deferred.call=function(){return this.cancel(),fcn(),deferred},deferred.cancel=function(){return clearTimeout(timer),timer=null,deferred},deferred.isPending=function(){return timer},deferred},exports.delayedCall=function(fcn,defaultTimeout){var timer=null,callback=function(){timer=null,fcn()},_self=function(timeout){null==timer&&(timer=setTimeout(callback,timeout||defaultTimeout))};return _self.delay=function(timeout){timer&&clearTimeout(timer),timer=setTimeout(callback,timeout||defaultTimeout)},_self.schedule=_self,_self.call=function(){this.cancel(),fcn()},_self.cancel=function(){timer&&clearTimeout(timer),timer=null},_self.isPending=function(){return timer},_self}}),ace.define("ace/worker/mirror",["require","exports","module","ace/range","ace/document","ace/lib/lang"],function(acequire,exports){"use strict";acequire("../range").Range;var Document=acequire("../document").Document,lang=acequire("../lib/lang"),Mirror=exports.Mirror=function(sender){this.sender=sender;var doc=this.doc=new Document(""),deferredUpdate=this.deferredUpdate=lang.delayedCall(this.onUpdate.bind(this)),_self=this;sender.on("change",function(e){var data=e.data;if(data[0].start)doc.applyDeltas(data);else for(var i=0;data.length>i;i+=2){if(Array.isArray(data[i+1]))var d={action:"insert",start:data[i],lines:data[i+1]};else var d={action:"remove",start:data[i],end:data[i+1]};doc.applyDelta(d,!0)}return _self.$timeout?deferredUpdate.schedule(_self.$timeout):(_self.onUpdate(),void 0)})};(function(){this.$timeout=500,this.setTimeout=function(timeout){this.$timeout=timeout},this.setValue=function(value){this.doc.setValue(value),this.deferredUpdate.schedule(this.$timeout)},this.getValue=function(callbackId){this.sender.callback(this.doc.getValue(),callbackId)},this.onUpdate=function(){},this.isPending=function(){return this.deferredUpdate.isPending()}}).call(Mirror.prototype)}),ace.define("ace/mode/json/json_parse",["require","exports","module"],function(){"use strict";var at,ch,text,value,escapee={\'"\':\'"\',"\\\\":"\\\\","/":"/",b:"\\b",f:"\\f",n:"\\n",r:"\\r",t:"\t"},error=function(m){throw{name:"SyntaxError",message:m,at:at,text:text}},next=function(c){return c&&c!==ch&&error("Expected \'"+c+"\' instead of \'"+ch+"\'"),ch=text.charAt(at),at+=1,ch},number=function(){var number,string="";for("-"===ch&&(string="-",next("-"));ch>="0"&&"9">=ch;)string+=ch,next();if("."===ch)for(string+=".";next()&&ch>="0"&&"9">=ch;)string+=ch;if("e"===ch||"E"===ch)for(string+=ch,next(),("-"===ch||"+"===ch)&&(string+=ch,next());ch>="0"&&"9">=ch;)string+=ch,next();return number=+string,isNaN(number)?(error("Bad number"),void 0):number},string=function(){var hex,i,uffff,string="";if(\'"\'===ch)for(;next();){if(\'"\'===ch)return next(),string;if("\\\\"===ch)if(next(),"u"===ch){for(uffff=0,i=0;4>i&&(hex=parseInt(next(),16),isFinite(hex));i+=1)uffff=16*uffff+hex;string+=String.fromCharCode(uffff)}else{if("string"!=typeof escapee[ch])break;string+=escapee[ch]}else string+=ch}error("Bad string")},white=function(){for(;ch&&" ">=ch;)next()},word=function(){switch(ch){case"t":return next("t"),next("r"),next("u"),next("e"),!0;case"f":return next("f"),next("a"),next("l"),next("s"),next("e"),!1;case"n":return next("n"),next("u"),next("l"),next("l"),null}error("Unexpected \'"+ch+"\'")},array=function(){var array=[];if("["===ch){if(next("["),white(),"]"===ch)return next("]"),array;for(;ch;){if(array.push(value()),white(),"]"===ch)return next("]"),array;next(","),white()}}error("Bad array")},object=function(){var key,object={};if("{"===ch){if(next("{"),white(),"}"===ch)return next("}"),object;for(;ch;){if(key=string(),white(),next(":"),Object.hasOwnProperty.call(object,key)&&error(\'Duplicate key "\'+key+\'"\'),object[key]=value(),white(),"}"===ch)return next("}"),object;next(","),white()}}error("Bad object")};return value=function(){switch(white(),ch){case"{":return object();case"[":return array();case\'"\':return string();case"-":return number();default:return ch>="0"&&"9">=ch?number():word()}},function(source,reviver){var result;return text=source,at=0,ch=" ",result=value(),white(),ch&&error("Syntax error"),"function"==typeof reviver?function walk(holder,key){var k,v,value=holder[key];if(value&&"object"==typeof value)for(k in value)Object.hasOwnProperty.call(value,k)&&(v=walk(value,k),void 0!==v?value[k]=v:delete value[k]);return reviver.call(holder,key,value)}({"":result},""):result}}),ace.define("ace/mode/json_worker",["require","exports","module","ace/lib/oop","ace/worker/mirror","ace/mode/json/json_parse"],function(acequire,exports){"use strict";var oop=acequire("../lib/oop"),Mirror=acequire("../worker/mirror").Mirror,parse=acequire("./json/json_parse"),JsonWorker=exports.JsonWorker=function(sender){Mirror.call(this,sender),this.setTimeout(200)};oop.inherits(JsonWorker,Mirror),function(){this.onUpdate=function(){var value=this.doc.getValue(),errors=[];try{value&&parse(value)}catch(e){var pos=this.doc.indexToPosition(e.at-1);errors.push({row:pos.row,column:pos.column,text:e.message,type:"error"})}this.sender.emit("annotate",errors)}}.call(JsonWorker.prototype)}),ace.define("ace/lib/es5-shim",["require","exports","module"],function(){function Empty(){}function doesDefinePropertyWork(object){try{return Object.defineProperty(object,"sentinel",{}),"sentinel"in object}catch(exception){}}function toInteger(n){return n=+n,n!==n?n=0:0!==n&&n!==1/0&&n!==-(1/0)&&(n=(n>0||-1)*Math.floor(Math.abs(n))),n}Function.prototype.bind||(Function.prototype.bind=function(that){var target=this;if("function"!=typeof target)throw new TypeError("Function.prototype.bind called on incompatible "+target);var args=slice.call(arguments,1),bound=function(){if(this instanceof bound){var result=target.apply(this,args.concat(slice.call(arguments)));return Object(result)===result?result:this}return target.apply(that,args.concat(slice.call(arguments)))};return target.prototype&&(Empty.prototype=target.prototype,bound.prototype=new Empty,Empty.prototype=null),bound});var defineGetter,defineSetter,lookupGetter,lookupSetter,supportsAccessors,call=Function.prototype.call,prototypeOfArray=Array.prototype,prototypeOfObject=Object.prototype,slice=prototypeOfArray.slice,_toString=call.bind(prototypeOfObject.toString),owns=call.bind(prototypeOfObject.hasOwnProperty);if((supportsAccessors=owns(prototypeOfObject,"__defineGetter__"))&&(defineGetter=call.bind(prototypeOfObject.__defineGetter__),defineSetter=call.bind(prototypeOfObject.__defineSetter__),lookupGetter=call.bind(prototypeOfObject.__lookupGetter__),lookupSetter=call.bind(prototypeOfObject.__lookupSetter__)),2!=[1,2].splice(0).length)if(function(){function makeArray(l){var a=Array(l+2);return a[0]=a[1]=0,a}var lengthBefore,array=[];return array.splice.apply(array,makeArray(20)),array.splice.apply(array,makeArray(26)),lengthBefore=array.length,array.splice(5,0,"XXX"),lengthBefore+1==array.length,lengthBefore+1==array.length?!0:void 0\n}()){var array_splice=Array.prototype.splice;Array.prototype.splice=function(start,deleteCount){return arguments.length?array_splice.apply(this,[void 0===start?0:start,void 0===deleteCount?this.length-start:deleteCount].concat(slice.call(arguments,2))):[]}}else Array.prototype.splice=function(pos,removeCount){var length=this.length;pos>0?pos>length&&(pos=length):void 0==pos?pos=0:0>pos&&(pos=Math.max(length+pos,0)),length>pos+removeCount||(removeCount=length-pos);var removed=this.slice(pos,pos+removeCount),insert=slice.call(arguments,2),add=insert.length;if(pos===length)add&&this.push.apply(this,insert);else{var remove=Math.min(removeCount,length-pos),tailOldPos=pos+remove,tailNewPos=tailOldPos+add-remove,tailCount=length-tailOldPos,lengthAfterRemove=length-remove;if(tailOldPos>tailNewPos)for(var i=0;tailCount>i;++i)this[tailNewPos+i]=this[tailOldPos+i];else if(tailNewPos>tailOldPos)for(i=tailCount;i--;)this[tailNewPos+i]=this[tailOldPos+i];if(add&&pos===lengthAfterRemove)this.length=lengthAfterRemove,this.push.apply(this,insert);else for(this.length=lengthAfterRemove+add,i=0;add>i;++i)this[pos+i]=insert[i]}return removed};Array.isArray||(Array.isArray=function(obj){return"[object Array]"==_toString(obj)});var boxedString=Object("a"),splitString="a"!=boxedString[0]||!(0 in boxedString);if(Array.prototype.forEach||(Array.prototype.forEach=function(fun){var object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,thisp=arguments[1],i=-1,length=self.length>>>0;if("[object Function]"!=_toString(fun))throw new TypeError;for(;length>++i;)i in self&&fun.call(thisp,self[i],i,object)}),Array.prototype.map||(Array.prototype.map=function(fun){var object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,length=self.length>>>0,result=Array(length),thisp=arguments[1];if("[object Function]"!=_toString(fun))throw new TypeError(fun+" is not a function");for(var i=0;length>i;i++)i in self&&(result[i]=fun.call(thisp,self[i],i,object));return result}),Array.prototype.filter||(Array.prototype.filter=function(fun){var value,object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,length=self.length>>>0,result=[],thisp=arguments[1];if("[object Function]"!=_toString(fun))throw new TypeError(fun+" is not a function");for(var i=0;length>i;i++)i in self&&(value=self[i],fun.call(thisp,value,i,object)&&result.push(value));return result}),Array.prototype.every||(Array.prototype.every=function(fun){var object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,length=self.length>>>0,thisp=arguments[1];if("[object Function]"!=_toString(fun))throw new TypeError(fun+" is not a function");for(var i=0;length>i;i++)if(i in self&&!fun.call(thisp,self[i],i,object))return!1;return!0}),Array.prototype.some||(Array.prototype.some=function(fun){var object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,length=self.length>>>0,thisp=arguments[1];if("[object Function]"!=_toString(fun))throw new TypeError(fun+" is not a function");for(var i=0;length>i;i++)if(i in self&&fun.call(thisp,self[i],i,object))return!0;return!1}),Array.prototype.reduce||(Array.prototype.reduce=function(fun){var object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,length=self.length>>>0;if("[object Function]"!=_toString(fun))throw new TypeError(fun+" is not a function");if(!length&&1==arguments.length)throw new TypeError("reduce of empty array with no initial value");var result,i=0;if(arguments.length>=2)result=arguments[1];else for(;;){if(i in self){result=self[i++];break}if(++i>=length)throw new TypeError("reduce of empty array with no initial value")}for(;length>i;i++)i in self&&(result=fun.call(void 0,result,self[i],i,object));return result}),Array.prototype.reduceRight||(Array.prototype.reduceRight=function(fun){var object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,length=self.length>>>0;if("[object Function]"!=_toString(fun))throw new TypeError(fun+" is not a function");if(!length&&1==arguments.length)throw new TypeError("reduceRight of empty array with no initial value");var result,i=length-1;if(arguments.length>=2)result=arguments[1];else for(;;){if(i in self){result=self[i--];break}if(0>--i)throw new TypeError("reduceRight of empty array with no initial value")}do i in this&&(result=fun.call(void 0,result,self[i],i,object));while(i--);return result}),Array.prototype.indexOf&&-1==[0,1].indexOf(1,2)||(Array.prototype.indexOf=function(sought){var self=splitString&&"[object String]"==_toString(this)?this.split(""):toObject(this),length=self.length>>>0;if(!length)return-1;var i=0;for(arguments.length>1&&(i=toInteger(arguments[1])),i=i>=0?i:Math.max(0,length+i);length>i;i++)if(i in self&&self[i]===sought)return i;return-1}),Array.prototype.lastIndexOf&&-1==[0,1].lastIndexOf(0,-3)||(Array.prototype.lastIndexOf=function(sought){var self=splitString&&"[object String]"==_toString(this)?this.split(""):toObject(this),length=self.length>>>0;if(!length)return-1;var i=length-1;for(arguments.length>1&&(i=Math.min(i,toInteger(arguments[1]))),i=i>=0?i:length-Math.abs(i);i>=0;i--)if(i in self&&sought===self[i])return i;return-1}),Object.getPrototypeOf||(Object.getPrototypeOf=function(object){return object.__proto__||(object.constructor?object.constructor.prototype:prototypeOfObject)}),!Object.getOwnPropertyDescriptor){var ERR_NON_OBJECT="Object.getOwnPropertyDescriptor called on a non-object: ";Object.getOwnPropertyDescriptor=function(object,property){if("object"!=typeof object&&"function"!=typeof object||null===object)throw new TypeError(ERR_NON_OBJECT+object);if(owns(object,property)){var descriptor,getter,setter;if(descriptor={enumerable:!0,configurable:!0},supportsAccessors){var prototype=object.__proto__;object.__proto__=prototypeOfObject;var getter=lookupGetter(object,property),setter=lookupSetter(object,property);if(object.__proto__=prototype,getter||setter)return getter&&(descriptor.get=getter),setter&&(descriptor.set=setter),descriptor}return descriptor.value=object[property],descriptor}}}if(Object.getOwnPropertyNames||(Object.getOwnPropertyNames=function(object){return Object.keys(object)}),!Object.create){var createEmpty;createEmpty=null===Object.prototype.__proto__?function(){return{__proto__:null}}:function(){var empty={};for(var i in empty)empty[i]=null;return empty.constructor=empty.hasOwnProperty=empty.propertyIsEnumerable=empty.isPrototypeOf=empty.toLocaleString=empty.toString=empty.valueOf=empty.__proto__=null,empty},Object.create=function(prototype,properties){var object;if(null===prototype)object=createEmpty();else{if("object"!=typeof prototype)throw new TypeError("typeof prototype["+typeof prototype+"] != \'object\'");var Type=function(){};Type.prototype=prototype,object=new Type,object.__proto__=prototype}return void 0!==properties&&Object.defineProperties(object,properties),object}}if(Object.defineProperty){var definePropertyWorksOnObject=doesDefinePropertyWork({}),definePropertyWorksOnDom="undefined"==typeof document||doesDefinePropertyWork(document.createElement("div"));if(!definePropertyWorksOnObject||!definePropertyWorksOnDom)var definePropertyFallback=Object.defineProperty}if(!Object.defineProperty||definePropertyFallback){var ERR_NON_OBJECT_DESCRIPTOR="Property description must be an object: ",ERR_NON_OBJECT_TARGET="Object.defineProperty called on non-object: ",ERR_ACCESSORS_NOT_SUPPORTED="getters & setters can not be defined on this javascript engine";Object.defineProperty=function(object,property,descriptor){if("object"!=typeof object&&"function"!=typeof object||null===object)throw new TypeError(ERR_NON_OBJECT_TARGET+object);if("object"!=typeof descriptor&&"function"!=typeof descriptor||null===descriptor)throw new TypeError(ERR_NON_OBJECT_DESCRIPTOR+descriptor);if(definePropertyFallback)try{return definePropertyFallback.call(Object,object,property,descriptor)}catch(exception){}if(owns(descriptor,"value"))if(supportsAccessors&&(lookupGetter(object,property)||lookupSetter(object,property))){var prototype=object.__proto__;object.__proto__=prototypeOfObject,delete object[property],object[property]=descriptor.value,object.__proto__=prototype}else object[property]=descriptor.value;else{if(!supportsAccessors)throw new TypeError(ERR_ACCESSORS_NOT_SUPPORTED);owns(descriptor,"get")&&defineGetter(object,property,descriptor.get),owns(descriptor,"set")&&defineSetter(object,property,descriptor.set)}return object}}Object.defineProperties||(Object.defineProperties=function(object,properties){for(var property in properties)owns(properties,property)&&Object.defineProperty(object,property,properties[property]);return object}),Object.seal||(Object.seal=function(object){return object}),Object.freeze||(Object.freeze=function(object){return object});try{Object.freeze(function(){})}catch(exception){Object.freeze=function(freezeObject){return function(object){return"function"==typeof object?object:freezeObject(object)}}(Object.freeze)}if(Object.preventExtensions||(Object.preventExtensions=function(object){return object}),Object.isSealed||(Object.isSealed=function(){return!1}),Object.isFrozen||(Object.isFrozen=function(){return!1}),Object.isExtensible||(Object.isExtensible=function(object){if(Object(object)===object)throw new TypeError;for(var name="";owns(object,name);)name+="?";object[name]=!0;var returnValue=owns(object,name);return delete object[name],returnValue}),!Object.keys){var hasDontEnumBug=!0,dontEnums=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],dontEnumsLength=dontEnums.length;for(var key in{toString:null})hasDontEnumBug=!1;Object.keys=function(object){if("object"!=typeof object&&"function"!=typeof object||null===object)throw new TypeError("Object.keys called on a non-object");var keys=[];for(var name in object)owns(object,name)&&keys.push(name);if(hasDontEnumBug)for(var i=0,ii=dontEnumsLength;ii>i;i++){var dontEnum=dontEnums[i];owns(object,dontEnum)&&keys.push(dontEnum)}return keys}}Date.now||(Date.now=function(){return(new Date).getTime()});var ws="\t\\n\v\\f\\r   ᠎             　\\u2028\\u2029\ufeff";if(!String.prototype.trim||ws.trim()){ws="["+ws+"]";var trimBeginRegexp=RegExp("^"+ws+ws+"*"),trimEndRegexp=RegExp(ws+ws+"*$");String.prototype.trim=function(){return(this+"").replace(trimBeginRegexp,"").replace(trimEndRegexp,"")}}var toObject=function(o){if(null==o)throw new TypeError("can\'t convert "+o+" to object");return Object(o)}});'},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"XJsonMode",{enumerable:!0,get:function(){return i.XJsonMode}}),Object.defineProperty(t,"installXJsonMode",{enumerable:!0,get:function(){return i.installXJsonMode}});var i=a(420)},function(e,t,a){"use strict";var i=a(122);Object.defineProperty(t,"__esModule",{value:!0}),t.XJsonMode=void 0,t.installXJsonMode=function(e){e.getSession().setMode(new b)};var n=i(a(171)),s=a(273),r=a(421);const{WorkerClient:o}=n.default.acequire("ace/worker/worker_client"),l=n.default.acequire("ace/lib/oop"),{Mode:c}=n.default.acequire("ace/mode/json"),{Tokenizer:d}=n.default.acequire("ace/tokenizer"),{MatchingBraceOutdent:u}=n.default.acequire("ace/mode/matching_brace_outdent"),{CstyleBehaviour:p}=n.default.acequire("ace/mode/behaviour/cstyle"),{FoldMode:m}=n.default.acequire("ace/mode/folding/cstyle"),b=function(){const e=new s.XJsonHighlightRules;e.normalizeRules(),this.$tokenizer=new d(e.getRules()),this.$outdent=new u,this.$behaviour=new p,this.foldingRules=new m};t.XJsonMode=b,l.inherits(b,c),b.prototype.createWorker=function(e){const t=new o(["ace"],r.workerModule,"JsonWorker");return t.attachToDocument(e.getDocument()),t.on("annotate",(function(t){e.setAnnotations(t.data)})),t.on("terminate",(function(){e.clearAnnotations()})),t}},function(e,t,a){"use strict";var i=a(122);Object.defineProperty(t,"__esModule",{value:!0}),t.workerModule=void 0;const n={id:"ace/mode/json_worker",src:i(a(422)).default};t.workerModule=n},function(e,t,a){"use strict";a.r(t),t.default='/*\n * Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one\n * or more contributor license agreements. Licensed under the Elastic License\n * 2.0 and the Server Side Public License, v 1; you may not use this file except\n * in compliance with, at your election, the Elastic License 2.0 or the Server\n * Side Public License, v 1.\n */\n\n/* @notice\n *\n * This product includes code that is based on Ace editor, which was available\n * under a "BSD" license.\n *\n * Distributed under the BSD license:\n *\n * Copyright (c) 2010, Ajax.org B.V.\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *     * Redistributions of source code must retain the above copyright\n *       notice, this list of conditions and the following disclaimer.\n *     * Redistributions in binary form must reproduce the above copyright\n *       notice, this list of conditions and the following disclaimer in the\n *       documentation and/or other materials provided with the distribution.\n *     * Neither the name of Ajax.org B.V. nor the\n *       names of its contributors may be used to endorse or promote products\n *       derived from this software without specific prior written permission.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND\n * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n * DISCLAIMED. IN NO EVENT SHALL AJAX.ORG B.V. BE LIABLE FOR ANY\n * DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\n * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\n * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\n * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\n/* eslint-disable */\n/*\n  This file is loaded up as a blob by Brace to hand to Ace to load as Jsonp\n  (hence the redefining of everything).  It is based on the json\n  mode from the brace distro.\n\n  It is very likely that this file will be removed in future but for now it enables\n  extended JSON parsing, like e.g. """{}""" (triple quotes)\n*/\n// @internal\n// @ts-nocheck\n"no use strict";\n! function(window) {\n  function resolveModuleId(id, paths) {\n    for (var testPath = id, tail = ""; testPath;) {\n      var alias = paths[testPath];\n      if ("string" == typeof alias) return alias + tail;\n      if (alias) return alias.location.replace(/\\/*$/, "/") + (tail || alias.main || alias.name);\n      if (alias === !1) return "";\n      var i = testPath.lastIndexOf("/");\n      if (-1 === i) break;\n      tail = testPath.substr(i) + tail, testPath = testPath.slice(0, i)\n    }\n    return id\n  }\n  if (!(void 0 !== window.window && window.document || window.acequire && window.define)) {\n    window.console || (window.console = function() {\n      var msgs = Array.prototype.slice.call(arguments, 0);\n      postMessage({\n        type: "log",\n        data: msgs\n      })\n    }, window.console.error = window.console.warn = window.console.log = window.console.trace = window.console), window.window = window, window.ace = window, window.onerror = function(message, file, line, col, err) {\n      postMessage({\n        type: "error",\n        data: {\n          message: message,\n          data: err.data,\n          file: file,\n          line: line,\n          col: col,\n          stack: err.stack\n        }\n      })\n    }, window.normalizeModule = function(parentId, moduleName) {\n      if (-1 !== moduleName.indexOf("!")) {\n        var chunks = moduleName.split("!");\n        return window.normalizeModule(parentId, chunks[0]) + "!" + window.normalizeModule(parentId, chunks[1])\n      }\n      if ("." == moduleName.charAt(0)) {\n        var base = parentId.split("/").slice(0, -1).join("/");\n        for (moduleName = (base ? base + "/" : "") + moduleName; - 1 !== moduleName.indexOf(".") && previous != moduleName;) {\n          var previous = moduleName;\n          moduleName = moduleName.replace(/^\\.\\//, "").replace(/\\/\\.\\//, "/").replace(/[^\\/]+\\/\\.\\.\\//, "")\n        }\n      }\n      return moduleName\n    }, window.acequire = function acequire(parentId, id) {\n      if (id || (id = parentId, parentId = null), !id.charAt) throw Error("worker.js acequire() accepts only (parentId, id) as arguments");\n      id = window.normalizeModule(parentId, id);\n      var module = window.acequire.modules[id];\n      if (module) return module.initialized || (module.initialized = !0, module.exports = module.factory().exports), module.exports;\n      if (!window.acequire.tlns) return console.log("unable to load " + id);\n      var path = resolveModuleId(id, window.acequire.tlns);\n      return ".js" != path.slice(-3) && (path += ".js"), window.acequire.id = id, window.acequire.modules[id] = {}, importScripts(path), window.acequire(parentId, id)\n    }, window.acequire.modules = {}, window.acequire.tlns = {}, window.define = function(id, deps, factory) {\n      if (2 == arguments.length ? (factory = deps, "string" != typeof id && (deps = id, id = window.acequire.id)) : 1 == arguments.length && (factory = id, deps = [], id = window.acequire.id), "function" != typeof factory) return window.acequire.modules[id] = {\n        exports: factory,\n        initialized: !0\n      }, void 0;\n      deps.length || (deps = ["require", "exports", "module"]);\n      var req = function(childId) {\n        return window.acequire(id, childId)\n      };\n      window.acequire.modules[id] = {\n        exports: {},\n        factory: function() {\n          var module = this,\n            returnExports = factory.apply(this, deps.map(function(dep) {\n              switch (dep) {\n                case "require":\n                  return req;\n                case "exports":\n                  return module.exports;\n                case "module":\n                  return module;\n                default:\n                  return req(dep)\n              }\n            }));\n          return returnExports && (module.exports = returnExports), module\n        }\n      }\n    }, window.define.amd = {}, acequire.tlns = {}, window.initBaseUrls = function(topLevelNamespaces) {\n      for (var i in topLevelNamespaces) acequire.tlns[i] = topLevelNamespaces[i]\n    }, window.initSender = function() {\n      var EventEmitter = window.acequire("ace/lib/event_emitter").EventEmitter,\n        oop = window.acequire("ace/lib/oop"),\n        Sender = function() {};\n      return function() {\n        oop.implement(this, EventEmitter), this.callback = function(data, callbackId) {\n          postMessage({\n            type: "call",\n            id: callbackId,\n            data: data\n          })\n        }, this.emit = function(name, data) {\n          postMessage({\n            type: "event",\n            name: name,\n            data: data\n          })\n        }\n      }.call(Sender.prototype), new Sender\n    };\n    var main = window.main = null,\n      sender = window.sender = null;\n    window.onmessage = function(e) {\n      var msg = e.data;\n      if (msg.event && sender) sender._signal(msg.event, msg.data);\n      else if (msg.command)\n        if (main[msg.command]) main[msg.command].apply(main, msg.args);\n        else {\n          if (!window[msg.command]) throw Error("Unknown command:" + msg.command);\n          window[msg.command].apply(window, msg.args)\n        }\n      else if (msg.init) {\n        window.initBaseUrls(msg.tlns), acequire("ace/lib/es5-shim"), sender = window.sender = window.initSender();\n        var clazz = acequire(msg.module)[msg.classname];\n        main = window.main = new clazz(sender)\n      }\n    }\n  }\n}(this), ace.define("ace/lib/oop", ["require", "exports", "module"], function(acequire, exports) {\n  "use strict";\n  exports.inherits = function(ctor, superCtor) {\n    ctor.super_ = superCtor, ctor.prototype = Object.create(superCtor.prototype, {\n      constructor: {\n        value: ctor,\n        enumerable: !1,\n        writable: !0,\n        configurable: !0\n      }\n    })\n  }, exports.mixin = function(obj, mixin) {\n    for (var key in mixin) obj[key] = mixin[key];\n    return obj\n  }, exports.implement = function(proto, mixin) {\n    exports.mixin(proto, mixin)\n  }\n}), ace.define("ace/range", ["require", "exports", "module"], function(acequire, exports) {\n  "use strict";\n  var comparePoints = function(p1, p2) {\n      return p1.row - p2.row || p1.column - p2.column\n    },\n    Range = function(startRow, startColumn, endRow, endColumn) {\n      this.start = {\n        row: startRow,\n        column: startColumn\n      }, this.end = {\n        row: endRow,\n        column: endColumn\n      }\n    };\n  (function() {\n    this.isEqual = function(range) {\n      return this.start.row === range.start.row && this.end.row === range.end.row && this.start.column === range.start.column && this.end.column === range.end.column\n    }, this.toString = function() {\n      return "Range: [" + this.start.row + "/" + this.start.column + "] -> [" + this.end.row + "/" + this.end.column + "]"\n    }, this.contains = function(row, column) {\n      return 0 == this.compare(row, column)\n    }, this.compareRange = function(range) {\n      var cmp, end = range.end,\n        start = range.start;\n      return cmp = this.compare(end.row, end.column), 1 == cmp ? (cmp = this.compare(start.row, start.column), 1 == cmp ? 2 : 0 == cmp ? 1 : 0) : -1 == cmp ? -2 : (cmp = this.compare(start.row, start.column), -1 == cmp ? -1 : 1 == cmp ? 42 : 0)\n    }, this.comparePoint = function(p) {\n      return this.compare(p.row, p.column)\n    }, this.containsRange = function(range) {\n      return 0 == this.comparePoint(range.start) && 0 == this.comparePoint(range.end)\n    }, this.intersects = function(range) {\n      var cmp = this.compareRange(range);\n      return -1 == cmp || 0 == cmp || 1 == cmp\n    }, this.isEnd = function(row, column) {\n      return this.end.row == row && this.end.column == column\n    }, this.isStart = function(row, column) {\n      return this.start.row == row && this.start.column == column\n    }, this.setStart = function(row, column) {\n      "object" == typeof row ? (this.start.column = row.column, this.start.row = row.row) : (this.start.row = row, this.start.column = column)\n    }, this.setEnd = function(row, column) {\n      "object" == typeof row ? (this.end.column = row.column, this.end.row = row.row) : (this.end.row = row, this.end.column = column)\n    }, this.inside = function(row, column) {\n      return 0 == this.compare(row, column) ? this.isEnd(row, column) || this.isStart(row, column) ? !1 : !0 : !1\n    }, this.insideStart = function(row, column) {\n      return 0 == this.compare(row, column) ? this.isEnd(row, column) ? !1 : !0 : !1\n    }, this.insideEnd = function(row, column) {\n      return 0 == this.compare(row, column) ? this.isStart(row, column) ? !1 : !0 : !1\n    }, this.compare = function(row, column) {\n      return this.isMultiLine() || row !== this.start.row ? this.start.row > row ? -1 : row > this.end.row ? 1 : this.start.row === row ? column >= this.start.column ? 0 : -1 : this.end.row === row ? this.end.column >= column ? 0 : 1 : 0 : this.start.column > column ? -1 : column > this.end.column ? 1 : 0\n    }, this.compareStart = function(row, column) {\n      return this.start.row == row && this.start.column == column ? -1 : this.compare(row, column)\n    }, this.compareEnd = function(row, column) {\n      return this.end.row == row && this.end.column == column ? 1 : this.compare(row, column)\n    }, this.compareInside = function(row, column) {\n      return this.end.row == row && this.end.column == column ? 1 : this.start.row == row && this.start.column == column ? -1 : this.compare(row, column)\n    }, this.clipRows = function(firstRow, lastRow) {\n      if (this.end.row > lastRow) var end = {\n        row: lastRow + 1,\n        column: 0\n      };\n      else if (firstRow > this.end.row) var end = {\n        row: firstRow,\n        column: 0\n      };\n      if (this.start.row > lastRow) var start = {\n        row: lastRow + 1,\n        column: 0\n      };\n      else if (firstRow > this.start.row) var start = {\n        row: firstRow,\n        column: 0\n      };\n      return Range.fromPoints(start || this.start, end || this.end)\n    }, this.extend = function(row, column) {\n      var cmp = this.compare(row, column);\n      if (0 == cmp) return this;\n      if (-1 == cmp) var start = {\n        row: row,\n        column: column\n      };\n      else var end = {\n        row: row,\n        column: column\n      };\n      return Range.fromPoints(start || this.start, end || this.end)\n    }, this.isEmpty = function() {\n      return this.start.row === this.end.row && this.start.column === this.end.column\n    }, this.isMultiLine = function() {\n      return this.start.row !== this.end.row\n    }, this.clone = function() {\n      return Range.fromPoints(this.start, this.end)\n    }, this.collapseRows = function() {\n      return 0 == this.end.column ? new Range(this.start.row, 0, Math.max(this.start.row, this.end.row - 1), 0) : new Range(this.start.row, 0, this.end.row, 0)\n    }, this.toScreenRange = function(session) {\n      var screenPosStart = session.documentToScreenPosition(this.start),\n        screenPosEnd = session.documentToScreenPosition(this.end);\n      return new Range(screenPosStart.row, screenPosStart.column, screenPosEnd.row, screenPosEnd.column)\n    }, this.moveBy = function(row, column) {\n      this.start.row += row, this.start.column += column, this.end.row += row, this.end.column += column\n    }\n  }).call(Range.prototype), Range.fromPoints = function(start, end) {\n    return new Range(start.row, start.column, end.row, end.column)\n  }, Range.comparePoints = comparePoints, Range.comparePoints = function(p1, p2) {\n    return p1.row - p2.row || p1.column - p2.column\n  }, exports.Range = Range\n}), ace.define("ace/apply_delta", ["require", "exports", "module"], function(acequire, exports) {\n  "use strict";\n  exports.applyDelta = function(docLines, delta) {\n    var row = delta.start.row,\n      startColumn = delta.start.column,\n      line = docLines[row] || "";\n    switch (delta.action) {\n      case "insert":\n        var lines = delta.lines;\n        if (1 === lines.length) docLines[row] = line.substring(0, startColumn) + delta.lines[0] + line.substring(startColumn);\n        else {\n          var args = [row, 1].concat(delta.lines);\n          docLines.splice.apply(docLines, args), docLines[row] = line.substring(0, startColumn) + docLines[row], docLines[row + delta.lines.length - 1] += line.substring(startColumn)\n        }\n        break;\n      case "remove":\n        var endColumn = delta.end.column,\n          endRow = delta.end.row;\n        row === endRow ? docLines[row] = line.substring(0, startColumn) + line.substring(endColumn) : docLines.splice(row, endRow - row + 1, line.substring(0, startColumn) + docLines[endRow].substring(endColumn))\n    }\n  }\n}), ace.define("ace/lib/event_emitter", ["require", "exports", "module"], function(acequire, exports) {\n  "use strict";\n  var EventEmitter = {},\n    stopPropagation = function() {\n      this.propagationStopped = !0\n    },\n    preventDefault = function() {\n      this.defaultPrevented = !0\n    };\n  EventEmitter._emit = EventEmitter._dispatchEvent = function(eventName, e) {\n    this._eventRegistry || (this._eventRegistry = {}), this._defaultHandlers || (this._defaultHandlers = {});\n    var listeners = this._eventRegistry[eventName] || [],\n      defaultHandler = this._defaultHandlers[eventName];\n    if (listeners.length || defaultHandler) {\n      "object" == typeof e && e || (e = {}), e.type || (e.type = eventName), e.stopPropagation || (e.stopPropagation = stopPropagation), e.preventDefault || (e.preventDefault = preventDefault), listeners = listeners.slice();\n      for (var i = 0; listeners.length > i && (listeners[i](e, this), !e.propagationStopped); i++);\n      return defaultHandler && !e.defaultPrevented ? defaultHandler(e, this) : void 0\n    }\n  }, EventEmitter._signal = function(eventName, e) {\n    var listeners = (this._eventRegistry || {})[eventName];\n    if (listeners) {\n      listeners = listeners.slice();\n      for (var i = 0; listeners.length > i; i++) listeners[i](e, this)\n    }\n  }, EventEmitter.once = function(eventName, callback) {\n    var _self = this;\n    callback && this.addEventListener(eventName, function newCallback() {\n      _self.removeEventListener(eventName, newCallback), callback.apply(null, arguments)\n    })\n  }, EventEmitter.setDefaultHandler = function(eventName, callback) {\n    var handlers = this._defaultHandlers;\n    if (handlers || (handlers = this._defaultHandlers = {\n        _disabled_: {}\n      }), handlers[eventName]) {\n      var old = handlers[eventName],\n        disabled = handlers._disabled_[eventName];\n      disabled || (handlers._disabled_[eventName] = disabled = []), disabled.push(old);\n      var i = disabled.indexOf(callback); - 1 != i && disabled.splice(i, 1)\n    }\n    handlers[eventName] = callback\n  }, EventEmitter.removeDefaultHandler = function(eventName, callback) {\n    var handlers = this._defaultHandlers;\n    if (handlers) {\n      var disabled = handlers._disabled_[eventName];\n      if (handlers[eventName] == callback) handlers[eventName], disabled && this.setDefaultHandler(eventName, disabled.pop());\n      else if (disabled) {\n        var i = disabled.indexOf(callback); - 1 != i && disabled.splice(i, 1)\n      }\n    }\n  }, EventEmitter.on = EventEmitter.addEventListener = function(eventName, callback, capturing) {\n    this._eventRegistry = this._eventRegistry || {};\n    var listeners = this._eventRegistry[eventName];\n    return listeners || (listeners = this._eventRegistry[eventName] = []), -1 == listeners.indexOf(callback) && listeners[capturing ? "unshift" : "push"](callback), callback\n  }, EventEmitter.off = EventEmitter.removeListener = EventEmitter.removeEventListener = function(eventName, callback) {\n    this._eventRegistry = this._eventRegistry || {};\n    var listeners = this._eventRegistry[eventName];\n    if (listeners) {\n      var index = listeners.indexOf(callback); - 1 !== index && listeners.splice(index, 1)\n    }\n  }, EventEmitter.removeAllListeners = function(eventName) {\n    this._eventRegistry && (this._eventRegistry[eventName] = [])\n  }, exports.EventEmitter = EventEmitter\n}), ace.define("ace/anchor", ["require", "exports", "module", "ace/lib/oop", "ace/lib/event_emitter"], function(acequire, exports) {\n  "use strict";\n  var oop = acequire("./lib/oop"),\n    EventEmitter = acequire("./lib/event_emitter").EventEmitter,\n    Anchor = exports.Anchor = function(doc, row, column) {\n      this.$onChange = this.onChange.bind(this), this.attach(doc), column === void 0 ? this.setPosition(row.row, row.column) : this.setPosition(row, column)\n    };\n  (function() {\n    function $pointsInOrder(point1, point2, equalPointsInOrder) {\n      var bColIsAfter = equalPointsInOrder ? point1.column <= point2.column : point1.column < point2.column;\n      return point1.row < point2.row || point1.row == point2.row && bColIsAfter\n    }\n\n    function $getTransformedPoint(delta, point, moveIfEqual) {\n      var deltaIsInsert = "insert" == delta.action,\n        deltaRowShift = (deltaIsInsert ? 1 : -1) * (delta.end.row - delta.start.row),\n        deltaColShift = (deltaIsInsert ? 1 : -1) * (delta.end.column - delta.start.column),\n        deltaStart = delta.start,\n        deltaEnd = deltaIsInsert ? deltaStart : delta.end;\n      return $pointsInOrder(point, deltaStart, moveIfEqual) ? {\n        row: point.row,\n        column: point.column\n      } : $pointsInOrder(deltaEnd, point, !moveIfEqual) ? {\n        row: point.row + deltaRowShift,\n        column: point.column + (point.row == deltaEnd.row ? deltaColShift : 0)\n      } : {\n        row: deltaStart.row,\n        column: deltaStart.column\n      }\n    }\n    oop.implement(this, EventEmitter), this.getPosition = function() {\n      return this.$clipPositionToDocument(this.row, this.column)\n    }, this.getDocument = function() {\n      return this.document\n    }, this.$insertRight = !1, this.onChange = function(delta) {\n      if (!(delta.start.row == delta.end.row && delta.start.row != this.row || delta.start.row > this.row)) {\n        var point = $getTransformedPoint(delta, {\n          row: this.row,\n          column: this.column\n        }, this.$insertRight);\n        this.setPosition(point.row, point.column, !0)\n      }\n    }, this.setPosition = function(row, column, noClip) {\n      var pos;\n      if (pos = noClip ? {\n          row: row,\n          column: column\n        } : this.$clipPositionToDocument(row, column), this.row != pos.row || this.column != pos.column) {\n        var old = {\n          row: this.row,\n          column: this.column\n        };\n        this.row = pos.row, this.column = pos.column, this._signal("change", {\n          old: old,\n          value: pos\n        })\n      }\n    }, this.detach = function() {\n      this.document.removeEventListener("change", this.$onChange)\n    }, this.attach = function(doc) {\n      this.document = doc || this.document, this.document.on("change", this.$onChange)\n    }, this.$clipPositionToDocument = function(row, column) {\n      var pos = {};\n      return row >= this.document.getLength() ? (pos.row = Math.max(0, this.document.getLength() - 1), pos.column = this.document.getLine(pos.row).length) : 0 > row ? (pos.row = 0, pos.column = 0) : (pos.row = row, pos.column = Math.min(this.document.getLine(pos.row).length, Math.max(0, column))), 0 > column && (pos.column = 0), pos\n    }\n  }).call(Anchor.prototype)\n}), ace.define("ace/document", ["require", "exports", "module", "ace/lib/oop", "ace/apply_delta", "ace/lib/event_emitter", "ace/range", "ace/anchor"], function(acequire, exports) {\n  "use strict";\n  var oop = acequire("./lib/oop"),\n    applyDelta = acequire("./apply_delta").applyDelta,\n    EventEmitter = acequire("./lib/event_emitter").EventEmitter,\n    Range = acequire("./range").Range,\n    Anchor = acequire("./anchor").Anchor,\n    Document = function(textOrLines) {\n      this.$lines = [""], 0 === textOrLines.length ? this.$lines = [""] : Array.isArray(textOrLines) ? this.insertMergedLines({\n        row: 0,\n        column: 0\n      }, textOrLines) : this.insert({\n        row: 0,\n        column: 0\n      }, textOrLines)\n    };\n  (function() {\n    oop.implement(this, EventEmitter), this.setValue = function(text) {\n      var len = this.getLength() - 1;\n      this.remove(new Range(0, 0, len, this.getLine(len).length)), this.insert({\n        row: 0,\n        column: 0\n      }, text)\n    }, this.getValue = function() {\n      return this.getAllLines().join(this.getNewLineCharacter())\n    }, this.createAnchor = function(row, column) {\n      return new Anchor(this, row, column)\n    }, this.$split = 0 === "aaa".split(/a/).length ? function(text) {\n      return text.replace(/\\r\\n|\\r/g, "\\n").split("\\n")\n    } : function(text) {\n      return text.split(/\\r\\n|\\r|\\n/)\n    }, this.$detectNewLine = function(text) {\n      var match = text.match(/^.*?(\\r\\n|\\r|\\n)/m);\n      this.$autoNewLine = match ? match[1] : "\\n", this._signal("changeNewLineMode")\n    }, this.getNewLineCharacter = function() {\n      switch (this.$newLineMode) {\n        case "windows":\n          return "\\r\\n";\n        case "unix":\n          return "\\n";\n        default:\n          return this.$autoNewLine || "\\n"\n      }\n    }, this.$autoNewLine = "", this.$newLineMode = "auto", this.setNewLineMode = function(newLineMode) {\n      this.$newLineMode !== newLineMode && (this.$newLineMode = newLineMode, this._signal("changeNewLineMode"))\n    }, this.getNewLineMode = function() {\n      return this.$newLineMode\n    }, this.isNewLine = function(text) {\n      return "\\r\\n" == text || "\\r" == text || "\\n" == text\n    }, this.getLine = function(row) {\n      return this.$lines[row] || ""\n    }, this.getLines = function(firstRow, lastRow) {\n      return this.$lines.slice(firstRow, lastRow + 1)\n    }, this.getAllLines = function() {\n      return this.getLines(0, this.getLength())\n    }, this.getLength = function() {\n      return this.$lines.length\n    }, this.getTextRange = function(range) {\n      return this.getLinesForRange(range).join(this.getNewLineCharacter())\n    }, this.getLinesForRange = function(range) {\n      var lines;\n      if (range.start.row === range.end.row) lines = [this.getLine(range.start.row).substring(range.start.column, range.end.column)];\n      else {\n        lines = this.getLines(range.start.row, range.end.row), lines[0] = (lines[0] || "").substring(range.start.column);\n        var l = lines.length - 1;\n        range.end.row - range.start.row == l && (lines[l] = lines[l].substring(0, range.end.column))\n      }\n      return lines\n    }, this.insertLines = function(row, lines) {\n      return console.warn("Use of document.insertLines is deprecated. Use the insertFullLines method instead."), this.insertFullLines(row, lines)\n    }, this.removeLines = function(firstRow, lastRow) {\n      return console.warn("Use of document.removeLines is deprecated. Use the removeFullLines method instead."), this.removeFullLines(firstRow, lastRow)\n    }, this.insertNewLine = function(position) {\n      return console.warn("Use of document.insertNewLine is deprecated. Use insertMergedLines(position, [\'\', \'\']) instead."), this.insertMergedLines(position, ["", ""])\n    }, this.insert = function(position, text) {\n      return 1 >= this.getLength() && this.$detectNewLine(text), this.insertMergedLines(position, this.$split(text))\n    }, this.insertInLine = function(position, text) {\n      var start = this.clippedPos(position.row, position.column),\n        end = this.pos(position.row, position.column + text.length);\n      return this.applyDelta({\n        start: start,\n        end: end,\n        action: "insert",\n        lines: [text]\n      }, !0), this.clonePos(end)\n    }, this.clippedPos = function(row, column) {\n      var length = this.getLength();\n      void 0 === row ? row = length : 0 > row ? row = 0 : row >= length && (row = length - 1, column = void 0);\n      var line = this.getLine(row);\n      return void 0 == column && (column = line.length), column = Math.min(Math.max(column, 0), line.length), {\n        row: row,\n        column: column\n      }\n    }, this.clonePos = function(pos) {\n      return {\n        row: pos.row,\n        column: pos.column\n      }\n    }, this.pos = function(row, column) {\n      return {\n        row: row,\n        column: column\n      }\n    }, this.$clipPosition = function(position) {\n      var length = this.getLength();\n      return position.row >= length ? (position.row = Math.max(0, length - 1), position.column = this.getLine(length - 1).length) : (position.row = Math.max(0, position.row), position.column = Math.min(Math.max(position.column, 0), this.getLine(position.row).length)), position\n    }, this.insertFullLines = function(row, lines) {\n      row = Math.min(Math.max(row, 0), this.getLength());\n      var column = 0;\n      this.getLength() > row ? (lines = lines.concat([""]), column = 0) : (lines = [""].concat(lines), row--, column = this.$lines[row].length), this.insertMergedLines({\n        row: row,\n        column: column\n      }, lines)\n    }, this.insertMergedLines = function(position, lines) {\n      var start = this.clippedPos(position.row, position.column),\n        end = {\n          row: start.row + lines.length - 1,\n          column: (1 == lines.length ? start.column : 0) + lines[lines.length - 1].length\n        };\n      return this.applyDelta({\n        start: start,\n        end: end,\n        action: "insert",\n        lines: lines\n      }), this.clonePos(end)\n    }, this.remove = function(range) {\n      var start = this.clippedPos(range.start.row, range.start.column),\n        end = this.clippedPos(range.end.row, range.end.column);\n      return this.applyDelta({\n        start: start,\n        end: end,\n        action: "remove",\n        lines: this.getLinesForRange({\n          start: start,\n          end: end\n        })\n      }), this.clonePos(start)\n    }, this.removeInLine = function(row, startColumn, endColumn) {\n      var start = this.clippedPos(row, startColumn),\n        end = this.clippedPos(row, endColumn);\n      return this.applyDelta({\n        start: start,\n        end: end,\n        action: "remove",\n        lines: this.getLinesForRange({\n          start: start,\n          end: end\n        })\n      }, !0), this.clonePos(start)\n    }, this.removeFullLines = function(firstRow, lastRow) {\n      firstRow = Math.min(Math.max(0, firstRow), this.getLength() - 1), lastRow = Math.min(Math.max(0, lastRow), this.getLength() - 1);\n      var deleteFirstNewLine = lastRow == this.getLength() - 1 && firstRow > 0,\n        deleteLastNewLine = this.getLength() - 1 > lastRow,\n        startRow = deleteFirstNewLine ? firstRow - 1 : firstRow,\n        startCol = deleteFirstNewLine ? this.getLine(startRow).length : 0,\n        endRow = deleteLastNewLine ? lastRow + 1 : lastRow,\n        endCol = deleteLastNewLine ? 0 : this.getLine(endRow).length,\n        range = new Range(startRow, startCol, endRow, endCol),\n        deletedLines = this.$lines.slice(firstRow, lastRow + 1);\n      return this.applyDelta({\n        start: range.start,\n        end: range.end,\n        action: "remove",\n        lines: this.getLinesForRange(range)\n      }), deletedLines\n    }, this.removeNewLine = function(row) {\n      this.getLength() - 1 > row && row >= 0 && this.applyDelta({\n        start: this.pos(row, this.getLine(row).length),\n        end: this.pos(row + 1, 0),\n        action: "remove",\n        lines: ["", ""]\n      })\n    }, this.replace = function(range, text) {\n      if (range instanceof Range || (range = Range.fromPoints(range.start, range.end)), 0 === text.length && range.isEmpty()) return range.start;\n      if (text == this.getTextRange(range)) return range.end;\n      this.remove(range);\n      var end;\n      return end = text ? this.insert(range.start, text) : range.start\n    }, this.applyDeltas = function(deltas) {\n      for (var i = 0; deltas.length > i; i++) this.applyDelta(deltas[i])\n    }, this.revertDeltas = function(deltas) {\n      for (var i = deltas.length - 1; i >= 0; i--) this.revertDelta(deltas[i])\n    }, this.applyDelta = function(delta, doNotValidate) {\n      var isInsert = "insert" == delta.action;\n      (isInsert ? 1 >= delta.lines.length && !delta.lines[0] : !Range.comparePoints(delta.start, delta.end)) || (isInsert && delta.lines.length > 2e4 && this.$splitAndapplyLargeDelta(delta, 2e4), applyDelta(this.$lines, delta, doNotValidate), this._signal("change", delta))\n    }, this.$splitAndapplyLargeDelta = function(delta, MAX) {\n      for (var lines = delta.lines, l = lines.length, row = delta.start.row, column = delta.start.column, from = 0, to = 0;;) {\n        from = to, to += MAX - 1;\n        var chunk = lines.slice(from, to);\n        if (to > l) {\n          delta.lines = chunk, delta.start.row = row + from, delta.start.column = column;\n          break\n        }\n        chunk.push(""), this.applyDelta({\n          start: this.pos(row + from, column),\n          end: this.pos(row + to, column = 0),\n          action: delta.action,\n          lines: chunk\n        }, !0)\n      }\n    }, this.revertDelta = function(delta) {\n      this.applyDelta({\n        start: this.clonePos(delta.start),\n        end: this.clonePos(delta.end),\n        action: "insert" == delta.action ? "remove" : "insert",\n        lines: delta.lines.slice()\n      })\n    }, this.indexToPosition = function(index, startRow) {\n      for (var lines = this.$lines || this.getAllLines(), newlineLength = this.getNewLineCharacter().length, i = startRow || 0, l = lines.length; l > i; i++)\n        if (index -= lines[i].length + newlineLength, 0 > index) return {\n          row: i,\n          column: index + lines[i].length + newlineLength\n        };\n      return {\n        row: l - 1,\n        column: lines[l - 1].length\n      }\n    }, this.positionToIndex = function(pos, startRow) {\n      for (var lines = this.$lines || this.getAllLines(), newlineLength = this.getNewLineCharacter().length, index = 0, row = Math.min(pos.row, lines.length), i = startRow || 0; row > i; ++i) index += lines[i].length + newlineLength;\n      return index + pos.column\n    }\n  }).call(Document.prototype), exports.Document = Document\n}), ace.define("ace/lib/lang", ["require", "exports", "module"], function(acequire, exports) {\n  "use strict";\n  exports.last = function(a) {\n    return a[a.length - 1]\n  }, exports.stringReverse = function(string) {\n    return string.split("").reverse().join("")\n  }, exports.stringRepeat = function(string, count) {\n    for (var result = ""; count > 0;) 1 & count && (result += string), (count >>= 1) && (string += string);\n    return result\n  };\n  var trimBeginRegexp = /^\\s\\s*/,\n    trimEndRegexp = /\\s\\s*$/;\n  exports.stringTrimLeft = function(string) {\n    return string.replace(trimBeginRegexp, "")\n  }, exports.stringTrimRight = function(string) {\n    return string.replace(trimEndRegexp, "")\n  }, exports.copyObject = function(obj) {\n    var copy = {};\n    for (var key in obj) copy[key] = obj[key];\n    return copy\n  }, exports.copyArray = function(array) {\n    for (var copy = [], i = 0, l = array.length; l > i; i++) copy[i] = array[i] && "object" == typeof array[i] ? this.copyObject(array[i]) : array[i];\n    return copy\n  }, exports.deepCopy = function deepCopy(obj) {\n    if ("object" != typeof obj || !obj) return obj;\n    var copy;\n    if (Array.isArray(obj)) {\n      copy = [];\n      for (var key = 0; obj.length > key; key++) copy[key] = deepCopy(obj[key]);\n      return copy\n    }\n    if ("[object Object]" !== Object.prototype.toString.call(obj)) return obj;\n    copy = {};\n    for (var key in obj) copy[key] = deepCopy(obj[key]);\n    return copy\n  }, exports.arrayToMap = function(arr) {\n    for (var map = {}, i = 0; arr.length > i; i++) map[arr[i]] = 1;\n    return map\n  }, exports.createMap = function(props) {\n    var map = Object.create(null);\n    for (var i in props) map[i] = props[i];\n    return map\n  }, exports.arrayRemove = function(array, value) {\n    for (var i = 0; array.length >= i; i++) value === array[i] && array.splice(i, 1)\n  }, exports.escapeRegExp = function(str) {\n    return str.replace(/([.*+?^${}()|[\\]\\/\\\\])/g, "\\\\$1")\n  }, exports.escapeHTML = function(str) {\n    return str.replace(/&/g, "&#38;").replace(/"/g, "&#34;").replace(/\'/g, "&#39;").replace(/</g, "&#60;")\n  }, exports.getMatchOffsets = function(string, regExp) {\n    var matches = [];\n    return string.replace(regExp, function(str) {\n      matches.push({\n        offset: arguments[arguments.length - 2],\n        length: str.length\n      })\n    }), matches\n  }, exports.deferredCall = function(fcn) {\n    var timer = null,\n      callback = function() {\n        timer = null, fcn()\n      },\n      deferred = function(timeout) {\n        return deferred.cancel(), timer = setTimeout(callback, timeout || 0), deferred\n      };\n    return deferred.schedule = deferred, deferred.call = function() {\n      return this.cancel(), fcn(), deferred\n    }, deferred.cancel = function() {\n      return clearTimeout(timer), timer = null, deferred\n    }, deferred.isPending = function() {\n      return timer\n    }, deferred\n  }, exports.delayedCall = function(fcn, defaultTimeout) {\n    var timer = null,\n      callback = function() {\n        timer = null, fcn()\n      },\n      _self = function(timeout) {\n        null == timer && (timer = setTimeout(callback, timeout || defaultTimeout))\n      };\n    return _self.delay = function(timeout) {\n      timer && clearTimeout(timer), timer = setTimeout(callback, timeout || defaultTimeout)\n    }, _self.schedule = _self, _self.call = function() {\n      this.cancel(), fcn()\n    }, _self.cancel = function() {\n      timer && clearTimeout(timer), timer = null\n    }, _self.isPending = function() {\n      return timer\n    }, _self\n  }\n}), ace.define("ace/worker/mirror", ["require", "exports", "module", "ace/range", "ace/document", "ace/lib/lang"], function(acequire, exports) {\n  "use strict";\n  acequire("../range").Range;\n  var Document = acequire("../document").Document,\n    lang = acequire("../lib/lang"),\n    Mirror = exports.Mirror = function(sender) {\n      this.sender = sender;\n      var doc = this.doc = new Document(""),\n        deferredUpdate = this.deferredUpdate = lang.delayedCall(this.onUpdate.bind(this)),\n        _self = this;\n      sender.on("change", function(e) {\n        var data = e.data;\n        if (data[0].start) doc.applyDeltas(data);\n        else\n          for (var i = 0; data.length > i; i += 2) {\n            if (Array.isArray(data[i + 1])) var d = {\n              action: "insert",\n              start: data[i],\n              lines: data[i + 1]\n            };\n            else var d = {\n              action: "remove",\n              start: data[i],\n              end: data[i + 1]\n            };\n            doc.applyDelta(d, !0)\n          }\n        return _self.$timeout ? deferredUpdate.schedule(_self.$timeout) : (_self.onUpdate(), void 0)\n      })\n    };\n  (function() {\n    this.$timeout = 500, this.setTimeout = function(timeout) {\n      this.$timeout = timeout\n    }, this.setValue = function(value) {\n      this.doc.setValue(value), this.deferredUpdate.schedule(this.$timeout)\n    }, this.getValue = function(callbackId) {\n      this.sender.callback(this.doc.getValue(), callbackId)\n    }, this.onUpdate = function() {}, this.isPending = function() {\n      return this.deferredUpdate.isPending()\n    }\n  }).call(Mirror.prototype)\n}), ace.define("ace/mode/json/json_parse", ["require", "exports", "module"], function() {\n  "use strict";\n  var at, ch, text, value, escapee = {\n      \'"\': \'"\',\n      "\\\\": "\\\\",\n      "/": "/",\n      b: "\\b",\n      f: "\\f",\n      n: "\\n",\n      r: "\\r",\n      t: "\t"\n    },\n    error = function(m) {\n      throw {\n        name: "SyntaxError",\n        message: m,\n        at: at,\n        text: text\n      }\n    },\n    reset = function (newAt) {\n      ch = text.charAt(newAt);\n      at = newAt + 1;\n    },\n    next = function(c) {\n      return c && c !== ch && error("Expected \'" + c + "\' instead of \'" + ch + "\'"), ch = text.charAt(at), at += 1, ch\n    },\n    nextUpTo = function (upTo, errorMessage) {\n      let currentAt = at,\n        i = text.indexOf(upTo, currentAt);\n      if (i < 0) {\n        error(errorMessage || \'Expected \\\'\' + upTo + \'\\\'\');\n      }\n      reset(i + upTo.length);\n      return text.substring(currentAt, i);\n    },\n    peek = function (c) {\n      return text.substr(at, c.length) === c; // nocommit - double check\n    },\n    number = function() {\n      var number, string = "";\n      for ("-" === ch && (string = "-", next("-")); ch >= "0" && "9" >= ch;) string += ch, next();\n      if ("." === ch)\n        for (string += "."; next() && ch >= "0" && "9" >= ch;) string += ch;\n      if ("e" === ch || "E" === ch)\n        for (string += ch, next(), ("-" === ch || "+" === ch) && (string += ch, next()); ch >= "0" && "9" >= ch;) string += ch, next();\n      return number = +string, isNaN(number) ? (error("Bad number"), void 0) : number\n    },\n    string = function() {\n      var hex, i, uffff, string = "";\n      if (\'"\' === ch) {\n        if (peek(\'""\')) {\n          // literal\n          next(\'"\');\n          next(\'"\');\n          return nextUpTo(\'"""\', \'failed to find closing \\\'"""\\\'\');\n        } else {\n          for (; next();) {\n            if (\'"\' === ch) return next(), string;\n            if ("\\\\" === ch)\n              if (next(), "u" === ch) {\n                for (uffff = 0, i = 0; 4 > i && (hex = parseInt(next(), 16), isFinite(hex)); i += 1) uffff = 16 * uffff + hex;\n                string += String.fromCharCode(uffff)\n              } else {\n                if ("string" != typeof escapee[ch]) break;\n                string += escapee[ch]\n              }\n            else string += ch\n          }\n        }\n      }\n      error("Bad string")\n    },\n    white = function() {\n      for (; ch && " " >= ch;) next()\n    },\n    word = function() {\n      switch (ch) {\n        case "t":\n          return next("t"), next("r"), next("u"), next("e"), !0;\n        case "f":\n          return next("f"), next("a"), next("l"), next("s"), next("e"), !1;\n        case "n":\n          return next("n"), next("u"), next("l"), next("l"), null\n      }\n      error("Unexpected \'" + ch + "\'")\n    },\n    array = function() {\n      var array = [];\n      if ("[" === ch) {\n        if (next("["), white(), "]" === ch) return next("]"), array;\n        for (; ch;) {\n          if (array.push(value()), white(), "]" === ch) return next("]"), array;\n          next(","), white()\n        }\n      }\n      error("Bad array")\n    },\n    object = function() {\n      var key, object = {};\n      if ("{" === ch) {\n        if (next("{"), white(), "}" === ch) return next("}"), object;\n        for (; ch;) {\n          if (key = string(), white(), next(":"), Object.hasOwnProperty.call(object, key) && error(\'Duplicate key "\' + key + \'"\'), object[key] = value(), white(), "}" === ch) return next("}"), object;\n          next(","), white()\n        }\n      }\n      error("Bad object")\n    };\n  return value = function() {\n      switch (white(), ch) {\n        case "{":\n          return object();\n        case "[":\n          return array();\n        case \'"\':\n          return string();\n        case "-":\n          return number();\n        default:\n          return ch >= "0" && "9" >= ch ? number() : word()\n      }\n    },\n    function(source, reviver) {\n      var result;\n      return text = source, at = 0, ch = " ", result = value(), white(), ch && error("Syntax error"), "function" == typeof reviver ? function walk(holder, key) {\n        var k, v, value = holder[key];\n        if (value && "object" == typeof value)\n          for (k in value) Object.hasOwnProperty.call(value, k) && (v = walk(value, k), void 0 !== v ? value[k] = v : delete value[k]);\n        return reviver.call(holder, key, value)\n      }({\n        "": result\n      }, "") : result\n    }\n}), ace.define("ace/mode/json_worker", ["require", "exports", "module", "ace/lib/oop", "ace/worker/mirror", "ace/mode/json/json_parse"], function(acequire, exports) {\n  "use strict";\n  var oop = acequire("../lib/oop"),\n    Mirror = acequire("../worker/mirror").Mirror,\n    parse = acequire("./json/json_parse"),\n    JsonWorker = exports.JsonWorker = function(sender) {\n      Mirror.call(this, sender), this.setTimeout(200)\n    };\n  oop.inherits(JsonWorker, Mirror),\n    function() {\n      this.onUpdate = function() {\n        var value = this.doc.getValue(),\n          errors = [];\n        try {\n          value && parse(value)\n        } catch (e) {\n          var pos = this.doc.indexToPosition(e.at - 1);\n          errors.push({\n            row: pos.row,\n            column: pos.column,\n            text: e.message,\n            type: "error"\n          })\n        }\n        this.sender.emit("annotate", errors)\n      }\n    }.call(JsonWorker.prototype)\n}), ace.define("ace/lib/es5-shim", ["require", "exports", "module"], function() {\n  function Empty() {}\n\n  function doesDefinePropertyWork(object) {\n    try {\n      return Object.defineProperty(object, "sentinel", {}), "sentinel" in object\n    } catch (exception) {}\n  }\n\n  function toInteger(n) {\n    return n = +n, n !== n ? n = 0 : 0 !== n && n !== 1 / 0 && n !== -(1 / 0) && (n = (n > 0 || -1) * Math.floor(Math.abs(n))), n\n  }\n  Function.prototype.bind || (Function.prototype.bind = function(that) {\n    var target = this;\n    if ("function" != typeof target) throw new TypeError("Function.prototype.bind called on incompatible " + target);\n    var args = slice.call(arguments, 1),\n      bound = function() {\n        if (this instanceof bound) {\n          var result = target.apply(this, args.concat(slice.call(arguments)));\n          return Object(result) === result ? result : this\n        }\n        return target.apply(that, args.concat(slice.call(arguments)))\n      };\n    return target.prototype && (Empty.prototype = target.prototype, bound.prototype = new Empty, Empty.prototype = null), bound\n  });\n  var defineGetter, defineSetter, lookupGetter, lookupSetter, supportsAccessors, call = Function.prototype.call,\n    prototypeOfArray = Array.prototype,\n    prototypeOfObject = Object.prototype,\n    slice = prototypeOfArray.slice,\n    _toString = call.bind(prototypeOfObject.toString),\n    owns = call.bind(prototypeOfObject.hasOwnProperty);\n  if ((supportsAccessors = owns(prototypeOfObject, "__defineGetter__")) && (defineGetter = call.bind(prototypeOfObject.__defineGetter__), defineSetter = call.bind(prototypeOfObject.__defineSetter__), lookupGetter = call.bind(prototypeOfObject.__lookupGetter__), lookupSetter = call.bind(prototypeOfObject.__lookupSetter__)), 2 != [1, 2].splice(0).length)\n    if (function() {\n        function makeArray(l) {\n          var a = Array(l + 2);\n          return a[0] = a[1] = 0, a\n        }\n        var lengthBefore, array = [];\n        return array.splice.apply(array, makeArray(20)), array.splice.apply(array, makeArray(26)), lengthBefore = array.length, array.splice(5, 0, "XXX"), lengthBefore + 1 == array.length, lengthBefore + 1 == array.length ? !0 : void 0\n      }()) {\n      var array_splice = Array.prototype.splice;\n      Array.prototype.splice = function(start, deleteCount) {\n        return arguments.length ? array_splice.apply(this, [void 0 === start ? 0 : start, void 0 === deleteCount ? this.length - start : deleteCount].concat(slice.call(arguments, 2))) : []\n      }\n    } else Array.prototype.splice = function(pos, removeCount) {\n      var length = this.length;\n      pos > 0 ? pos > length && (pos = length) : void 0 == pos ? pos = 0 : 0 > pos && (pos = Math.max(length + pos, 0)), length > pos + removeCount || (removeCount = length - pos);\n      var removed = this.slice(pos, pos + removeCount),\n        insert = slice.call(arguments, 2),\n        add = insert.length;\n      if (pos === length) add && this.push.apply(this, insert);\n      else {\n        var remove = Math.min(removeCount, length - pos),\n          tailOldPos = pos + remove,\n          tailNewPos = tailOldPos + add - remove,\n          tailCount = length - tailOldPos,\n          lengthAfterRemove = length - remove;\n        if (tailOldPos > tailNewPos)\n          for (var i = 0; tailCount > i; ++i) this[tailNewPos + i] = this[tailOldPos + i];\n        else if (tailNewPos > tailOldPos)\n          for (i = tailCount; i--;) this[tailNewPos + i] = this[tailOldPos + i];\n        if (add && pos === lengthAfterRemove) this.length = lengthAfterRemove, this.push.apply(this, insert);\n        else\n          for (this.length = lengthAfterRemove + add, i = 0; add > i; ++i) this[pos + i] = insert[i]\n      }\n      return removed\n    };\n  Array.isArray || (Array.isArray = function(obj) {\n    return "[object Array]" == _toString(obj)\n  });\n  var boxedString = Object("a"),\n    splitString = "a" != boxedString[0] || !(0 in boxedString);\n  if (Array.prototype.forEach || (Array.prototype.forEach = function(fun) {\n      var object = toObject(this),\n        self = splitString && "[object String]" == _toString(this) ? this.split("") : object,\n        thisp = arguments[1],\n        i = -1,\n        length = self.length >>> 0;\n      if ("[object Function]" != _toString(fun)) throw new TypeError;\n      for (; length > ++i;) i in self && fun.call(thisp, self[i], i, object)\n    }), Array.prototype.map || (Array.prototype.map = function(fun) {\n      var object = toObject(this),\n        self = splitString && "[object String]" == _toString(this) ? this.split("") : object,\n        length = self.length >>> 0,\n        result = Array(length),\n        thisp = arguments[1];\n      if ("[object Function]" != _toString(fun)) throw new TypeError(fun + " is not a function");\n      for (var i = 0; length > i; i++) i in self && (result[i] = fun.call(thisp, self[i], i, object));\n      return result\n    }), Array.prototype.filter || (Array.prototype.filter = function(fun) {\n      var value, object = toObject(this),\n        self = splitString && "[object String]" == _toString(this) ? this.split("") : object,\n        length = self.length >>> 0,\n        result = [],\n        thisp = arguments[1];\n      if ("[object Function]" != _toString(fun)) throw new TypeError(fun + " is not a function");\n      for (var i = 0; length > i; i++) i in self && (value = self[i], fun.call(thisp, value, i, object) && result.push(value));\n      return result\n    }), Array.prototype.every || (Array.prototype.every = function(fun) {\n      var object = toObject(this),\n        self = splitString && "[object String]" == _toString(this) ? this.split("") : object,\n        length = self.length >>> 0,\n        thisp = arguments[1];\n      if ("[object Function]" != _toString(fun)) throw new TypeError(fun + " is not a function");\n      for (var i = 0; length > i; i++)\n        if (i in self && !fun.call(thisp, self[i], i, object)) return !1;\n      return !0\n    }), Array.prototype.some || (Array.prototype.some = function(fun) {\n      var object = toObject(this),\n        self = splitString && "[object String]" == _toString(this) ? this.split("") : object,\n        length = self.length >>> 0,\n        thisp = arguments[1];\n      if ("[object Function]" != _toString(fun)) throw new TypeError(fun + " is not a function");\n      for (var i = 0; length > i; i++)\n        if (i in self && fun.call(thisp, self[i], i, object)) return !0;\n      return !1\n    }), Array.prototype.reduce || (Array.prototype.reduce = function(fun) {\n      var object = toObject(this),\n        self = splitString && "[object String]" == _toString(this) ? this.split("") : object,\n        length = self.length >>> 0;\n      if ("[object Function]" != _toString(fun)) throw new TypeError(fun + " is not a function");\n      if (!length && 1 == arguments.length) throw new TypeError("reduce of empty array with no initial value");\n      var result, i = 0;\n      if (arguments.length >= 2) result = arguments[1];\n      else\n        for (;;) {\n          if (i in self) {\n            result = self[i++];\n            break\n          }\n          if (++i >= length) throw new TypeError("reduce of empty array with no initial value")\n        }\n      for (; length > i; i++) i in self && (result = fun.call(void 0, result, self[i], i, object));\n      return result\n    }), Array.prototype.reduceRight || (Array.prototype.reduceRight = function(fun) {\n      var object = toObject(this),\n        self = splitString && "[object String]" == _toString(this) ? this.split("") : object,\n        length = self.length >>> 0;\n      if ("[object Function]" != _toString(fun)) throw new TypeError(fun + " is not a function");\n      if (!length && 1 == arguments.length) throw new TypeError("reduceRight of empty array with no initial value");\n      var result, i = length - 1;\n      if (arguments.length >= 2) result = arguments[1];\n      else\n        for (;;) {\n          if (i in self) {\n            result = self[i--];\n            break\n          }\n          if (0 > --i) throw new TypeError("reduceRight of empty array with no initial value")\n        }\n      do i in this && (result = fun.call(void 0, result, self[i], i, object)); while (i--);\n      return result\n    }), Array.prototype.indexOf && -1 == [0, 1].indexOf(1, 2) || (Array.prototype.indexOf = function(sought) {\n      var self = splitString && "[object String]" == _toString(this) ? this.split("") : toObject(this),\n        length = self.length >>> 0;\n      if (!length) return -1;\n      var i = 0;\n      for (arguments.length > 1 && (i = toInteger(arguments[1])), i = i >= 0 ? i : Math.max(0, length + i); length > i; i++)\n        if (i in self && self[i] === sought) return i;\n      return -1\n    }), Array.prototype.lastIndexOf && -1 == [0, 1].lastIndexOf(0, -3) || (Array.prototype.lastIndexOf = function(sought) {\n      var self = splitString && "[object String]" == _toString(this) ? this.split("") : toObject(this),\n        length = self.length >>> 0;\n      if (!length) return -1;\n      var i = length - 1;\n      for (arguments.length > 1 && (i = Math.min(i, toInteger(arguments[1]))), i = i >= 0 ? i : length - Math.abs(i); i >= 0; i--)\n        if (i in self && sought === self[i]) return i;\n      return -1\n    }), Object.getPrototypeOf || (Object.getPrototypeOf = function(object) {\n      return object.__proto__ || (object.constructor ? object.constructor.prototype : prototypeOfObject)\n    }), !Object.getOwnPropertyDescriptor) {\n    var ERR_NON_OBJECT = "Object.getOwnPropertyDescriptor called on a non-object: ";\n    Object.getOwnPropertyDescriptor = function(object, property) {\n      if ("object" != typeof object && "function" != typeof object || null === object) throw new TypeError(ERR_NON_OBJECT + object);\n      if (owns(object, property)) {\n        var descriptor, getter, setter;\n        if (descriptor = {\n            enumerable: !0,\n            configurable: !0\n          }, supportsAccessors) {\n          var prototype = object.__proto__;\n          object.__proto__ = prototypeOfObject;\n          var getter = lookupGetter(object, property),\n            setter = lookupSetter(object, property);\n          if (object.__proto__ = prototype, getter || setter) return getter && (descriptor.get = getter), setter && (descriptor.set = setter), descriptor\n        }\n        return descriptor.value = object[property], descriptor\n      }\n    }\n  }\n  if (Object.getOwnPropertyNames || (Object.getOwnPropertyNames = function(object) {\n      return Object.keys(object)\n    }), !Object.create) {\n    var createEmpty;\n    createEmpty = null === Object.prototype.__proto__ ? function() {\n      return {\n        __proto__: null\n      }\n    } : function() {\n      var empty = {};\n      for (var i in empty) empty[i] = null;\n      return empty.constructor = empty.hasOwnProperty = empty.propertyIsEnumerable = empty.isPrototypeOf = empty.toLocaleString = empty.toString = empty.valueOf = empty.__proto__ = null, empty\n    }, Object.create = function(prototype, properties) {\n      var object;\n      if (null === prototype) object = createEmpty();\n      else {\n        if ("object" != typeof prototype) throw new TypeError("typeof prototype[" + typeof prototype + "] != \'object\'");\n        var Type = function() {};\n        Type.prototype = prototype, object = new Type, object.__proto__ = prototype\n      }\n      return void 0 !== properties && Object.defineProperties(object, properties), object\n    }\n  }\n  if (Object.defineProperty) {\n    var definePropertyWorksOnObject = doesDefinePropertyWork({}),\n      definePropertyWorksOnDom = "undefined" == typeof document || doesDefinePropertyWork(document.createElement("div"));\n    if (!definePropertyWorksOnObject || !definePropertyWorksOnDom) var definePropertyFallback = Object.defineProperty\n  }\n  if (!Object.defineProperty || definePropertyFallback) {\n    var ERR_NON_OBJECT_DESCRIPTOR = "Property description must be an object: ",\n      ERR_NON_OBJECT_TARGET = "Object.defineProperty called on non-object: ",\n      ERR_ACCESSORS_NOT_SUPPORTED = "getters & setters can not be defined on this javascript engine";\n    Object.defineProperty = function(object, property, descriptor) {\n      if ("object" != typeof object && "function" != typeof object || null === object) throw new TypeError(ERR_NON_OBJECT_TARGET + object);\n      if ("object" != typeof descriptor && "function" != typeof descriptor || null === descriptor) throw new TypeError(ERR_NON_OBJECT_DESCRIPTOR + descriptor);\n      if (definePropertyFallback) try {\n        return definePropertyFallback.call(Object, object, property, descriptor)\n      } catch (exception) {}\n      if (owns(descriptor, "value"))\n        if (supportsAccessors && (lookupGetter(object, property) || lookupSetter(object, property))) {\n          var prototype = object.__proto__;\n          object.__proto__ = prototypeOfObject, delete object[property], object[property] = descriptor.value, object.__proto__ = prototype\n        } else object[property] = descriptor.value;\n      else {\n        if (!supportsAccessors) throw new TypeError(ERR_ACCESSORS_NOT_SUPPORTED);\n        owns(descriptor, "get") && defineGetter(object, property, descriptor.get), owns(descriptor, "set") && defineSetter(object, property, descriptor.set)\n      }\n      return object\n    }\n  }\n  Object.defineProperties || (Object.defineProperties = function(object, properties) {\n    for (var property in properties) owns(properties, property) && Object.defineProperty(object, property, properties[property]);\n    return object\n  }), Object.seal || (Object.seal = function(object) {\n    return object\n  }), Object.freeze || (Object.freeze = function(object) {\n    return object\n  });\n  try {\n    Object.freeze(function() {})\n  } catch (exception) {\n    Object.freeze = function(freezeObject) {\n      return function(object) {\n        return "function" == typeof object ? object : freezeObject(object)\n      }\n    }(Object.freeze)\n  }\n  if (Object.preventExtensions || (Object.preventExtensions = function(object) {\n      return object\n    }), Object.isSealed || (Object.isSealed = function() {\n      return !1\n    }), Object.isFrozen || (Object.isFrozen = function() {\n      return !1\n    }), Object.isExtensible || (Object.isExtensible = function(object) {\n      if (Object(object) === object) throw new TypeError;\n      for (var name = ""; owns(object, name);) name += "?";\n      object[name] = !0;\n      var returnValue = owns(object, name);\n      return delete object[name], returnValue\n    }), !Object.keys) {\n    var hasDontEnumBug = !0,\n      dontEnums = ["toString", "toLocaleString", "valueOf", "hasOwnProperty", "isPrototypeOf", "propertyIsEnumerable", "constructor"],\n      dontEnumsLength = dontEnums.length;\n    for (var key in {\n        toString: null\n      }) hasDontEnumBug = !1;\n    Object.keys = function(object) {\n      if ("object" != typeof object && "function" != typeof object || null === object) throw new TypeError("Object.keys called on a non-object");\n      var keys = [];\n      for (var name in object) owns(object, name) && keys.push(name);\n      if (hasDontEnumBug)\n        for (var i = 0, ii = dontEnumsLength; ii > i; i++) {\n          var dontEnum = dontEnums[i];\n          owns(object, dontEnum) && keys.push(dontEnum)\n        }\n      return keys\n    }\n  }\n  Date.now || (Date.now = function() {\n    return (new Date).getTime()\n  });\n  var ws = "\t\\n\v\\f\\r   ᠎             　\\u2028\\u2029\ufeff";\n  if (!String.prototype.trim || ws.trim()) {\n    ws = "[" + ws + "]";\n    var trimBeginRegexp = RegExp("^" + ws + ws + "*"),\n      trimEndRegexp = RegExp(ws + ws + "*$");\n    String.prototype.trim = function() {\n      return (this + "").replace(trimBeginRegexp, "").replace(trimEndRegexp, "")\n    }\n  }\n  var toObject = function(o) {\n    if (null == o) throw new TypeError("can\'t convert " + o + " to object");\n    return Object(o)\n  }\n});\n'},function(e,t,a){"use strict";var i=a(424),n=a(425);function s(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}t.parse=x,t.resolve=function(e,t){return x(e,!1,!0).resolve(t)},t.resolveObject=function(e,t){return e?x(e,!1,!0).resolveObject(t):t},t.format=function(e){n.isString(e)&&(e=x(e));return e instanceof s?e.format():s.prototype.format.call(e)},t.Url=s;var r=/^([a-z0-9.+-]+:)/i,o=/:[0-9]*$/,l=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,c=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),d=["'"].concat(c),u=["%","/","?",";","#"].concat(d),p=["/","?","#"],m=/^[+a-z0-9A-Z_-]{0,63}$/,b=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,h={javascript:!0,"javascript:":!0},f={javascript:!0,"javascript:":!0},g={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},j=a(426);function x(e,t,a){if(e&&n.isObject(e)&&e instanceof s)return e;var i=new s;return i.parse(e,t,a),i}s.prototype.parse=function(e,t,a){if(!n.isString(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var s=e.indexOf("?"),o=-1!==s&&s<e.indexOf("#")?"?":"#",c=e.split(o);c[0]=c[0].replace(/\\/g,"/");var x=e=c.join(o);if(x=x.trim(),!a&&1===e.split("#").length){var v=l.exec(x);if(v)return this.path=x,this.href=x,this.pathname=v[1],v[2]?(this.search=v[2],this.query=t?j.parse(this.search.substr(1)):this.search.substr(1)):t&&(this.search="",this.query={}),this}var y=r.exec(x);if(y){var O=(y=y[0]).toLowerCase();this.protocol=O,x=x.substr(y.length)}if(a||y||x.match(/^\/\/[^@\/]+@[^@\/]+/)){var E="//"===x.substr(0,2);!E||y&&f[y]||(x=x.substr(2),this.slashes=!0)}if(!f[y]&&(E||y&&!g[y])){for(var w,_,S=-1,M=0;M<p.length;M++){-1!==(k=x.indexOf(p[M]))&&(-1===S||k<S)&&(S=k)}-1!==(_=-1===S?x.lastIndexOf("@"):x.lastIndexOf("@",S))&&(w=x.slice(0,_),x=x.slice(_+1),this.auth=decodeURIComponent(w)),S=-1;for(M=0;M<u.length;M++){var k;-1!==(k=x.indexOf(u[M]))&&(-1===S||k<S)&&(S=k)}-1===S&&(S=x.length),this.host=x.slice(0,S),x=x.slice(S),this.parseHost(),this.hostname=this.hostname||"";var C="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!C)for(var T=this.hostname.split(/\./),F=(M=0,T.length);M<F;M++){var I=T[M];if(I&&!I.match(m)){for(var D="",A=0,L=I.length;A<L;A++)I.charCodeAt(A)>127?D+="x":D+=I[A];if(!D.match(m)){var R=T.slice(0,M),P=T.slice(M+1),N=I.match(b);N&&(R.push(N[1]),P.unshift(N[2])),P.length&&(x="/"+P.join(".")+x),this.hostname=R.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),C||(this.hostname=i.toASCII(this.hostname));var z=this.port?":"+this.port:"",B=this.hostname||"";this.host=B+z,this.href+=this.host,C&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==x[0]&&(x="/"+x))}if(!h[O])for(M=0,F=d.length;M<F;M++){var J=d[M];if(-1!==x.indexOf(J)){var V=encodeURIComponent(J);V===J&&(V=escape(J)),x=x.split(J).join(V)}}var U=x.indexOf("#");-1!==U&&(this.hash=x.substr(U),x=x.slice(0,U));var G=x.indexOf("?");if(-1!==G?(this.search=x.substr(G),this.query=x.substr(G+1),t&&(this.query=j.parse(this.query)),x=x.slice(0,G)):t&&(this.search="",this.query={}),x&&(this.pathname=x),g[O]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){z=this.pathname||"";var q=this.search||"";this.path=z+q}return this.href=this.format(),this},s.prototype.format=function(){var e=this.auth||"";e&&(e=(e=encodeURIComponent(e)).replace(/%3A/i,":"),e+="@");var t=this.protocol||"",a=this.pathname||"",i=this.hash||"",s=!1,r="";this.host?s=e+this.host:this.hostname&&(s=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(s+=":"+this.port)),this.query&&n.isObject(this.query)&&Object.keys(this.query).length&&(r=j.stringify(this.query));var o=this.search||r&&"?"+r||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||g[t])&&!1!==s?(s="//"+(s||""),a&&"/"!==a.charAt(0)&&(a="/"+a)):s||(s=""),i&&"#"!==i.charAt(0)&&(i="#"+i),o&&"?"!==o.charAt(0)&&(o="?"+o),t+s+(a=a.replace(/[?#]/g,(function(e){return encodeURIComponent(e)})))+(o=o.replace("#","%23"))+i},s.prototype.resolve=function(e){return this.resolveObject(x(e,!1,!0)).format()},s.prototype.resolveObject=function(e){if(n.isString(e)){var t=new s;t.parse(e,!1,!0),e=t}for(var a=new s,i=Object.keys(this),r=0;r<i.length;r++){var o=i[r];a[o]=this[o]}if(a.hash=e.hash,""===e.href)return a.href=a.format(),a;if(e.slashes&&!e.protocol){for(var l=Object.keys(e),c=0;c<l.length;c++){var d=l[c];"protocol"!==d&&(a[d]=e[d])}return g[a.protocol]&&a.hostname&&!a.pathname&&(a.path=a.pathname="/"),a.href=a.format(),a}if(e.protocol&&e.protocol!==a.protocol){if(!g[e.protocol]){for(var u=Object.keys(e),p=0;p<u.length;p++){var m=u[p];a[m]=e[m]}return a.href=a.format(),a}if(a.protocol=e.protocol,e.host||f[e.protocol])a.pathname=e.pathname;else{for(var b=(e.pathname||"").split("/");b.length&&!(e.host=b.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==b[0]&&b.unshift(""),b.length<2&&b.unshift(""),a.pathname=b.join("/")}if(a.search=e.search,a.query=e.query,a.host=e.host||"",a.auth=e.auth,a.hostname=e.hostname||e.host,a.port=e.port,a.pathname||a.search){var h=a.pathname||"",j=a.search||"";a.path=h+j}return a.slashes=a.slashes||e.slashes,a.href=a.format(),a}var x=a.pathname&&"/"===a.pathname.charAt(0),v=e.host||e.pathname&&"/"===e.pathname.charAt(0),y=v||x||a.host&&e.pathname,O=y,E=a.pathname&&a.pathname.split("/")||[],w=(b=e.pathname&&e.pathname.split("/")||[],a.protocol&&!g[a.protocol]);if(w&&(a.hostname="",a.port=null,a.host&&(""===E[0]?E[0]=a.host:E.unshift(a.host)),a.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===b[0]?b[0]=e.host:b.unshift(e.host)),e.host=null),y=y&&(""===b[0]||""===E[0])),v)a.host=e.host||""===e.host?e.host:a.host,a.hostname=e.hostname||""===e.hostname?e.hostname:a.hostname,a.search=e.search,a.query=e.query,E=b;else if(b.length)E||(E=[]),E.pop(),E=E.concat(b),a.search=e.search,a.query=e.query;else if(!n.isNullOrUndefined(e.search)){if(w)a.hostname=a.host=E.shift(),(C=!!(a.host&&a.host.indexOf("@")>0)&&a.host.split("@"))&&(a.auth=C.shift(),a.host=a.hostname=C.shift());return a.search=e.search,a.query=e.query,n.isNull(a.pathname)&&n.isNull(a.search)||(a.path=(a.pathname?a.pathname:"")+(a.search?a.search:"")),a.href=a.format(),a}if(!E.length)return a.pathname=null,a.search?a.path="/"+a.search:a.path=null,a.href=a.format(),a;for(var _=E.slice(-1)[0],S=(a.host||e.host||E.length>1)&&("."===_||".."===_)||""===_,M=0,k=E.length;k>=0;k--)"."===(_=E[k])?E.splice(k,1):".."===_?(E.splice(k,1),M++):M&&(E.splice(k,1),M--);if(!y&&!O)for(;M--;M)E.unshift("..");!y||""===E[0]||E[0]&&"/"===E[0].charAt(0)||E.unshift(""),S&&"/"!==E.join("/").substr(-1)&&E.push("");var C,T=""===E[0]||E[0]&&"/"===E[0].charAt(0);w&&(a.hostname=a.host=T?"":E.length?E.shift():"",(C=!!(a.host&&a.host.indexOf("@")>0)&&a.host.split("@"))&&(a.auth=C.shift(),a.host=a.hostname=C.shift()));return(y=y||a.host&&E.length)&&!T&&E.unshift(""),E.length?a.pathname=E.join("/"):(a.pathname=null,a.path=null),n.isNull(a.pathname)&&n.isNull(a.search)||(a.path=(a.pathname?a.pathname:"")+(a.search?a.search:"")),a.auth=e.auth||a.auth,a.slashes=a.slashes||e.slashes,a.href=a.format(),a},s.prototype.parseHost=function(){var e=this.host,t=o.exec(e);t&&(":"!==(t=t[0])&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},function(e,t,a){(function(e,i){var n;/*! https://mths.be/punycode v1.4.1 by @mathias */!function(s){t&&t.nodeType,e&&e.nodeType;var r="object"==typeof i&&i;r.global!==r&&r.window!==r&&r.self;var o,l=2147483647,c=36,d=/^xn--/,u=/[^\x20-\x7E]/,p=/[\x2E\u3002\uFF0E\uFF61]/g,m={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},b=Math.floor,h=String.fromCharCode;function f(e){throw new RangeError(m[e])}function g(e,t){for(var a=e.length,i=[];a--;)i[a]=t(e[a]);return i}function j(e,t){var a=e.split("@"),i="";return a.length>1&&(i=a[0]+"@",e=a[1]),i+g((e=e.replace(p,".")).split("."),t).join(".")}function x(e){for(var t,a,i=[],n=0,s=e.length;n<s;)(t=e.charCodeAt(n++))>=55296&&t<=56319&&n<s?56320==(64512&(a=e.charCodeAt(n++)))?i.push(((1023&t)<<10)+(1023&a)+65536):(i.push(t),n--):i.push(t);return i}function v(e){return g(e,(function(e){var t="";return e>65535&&(t+=h((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+=h(e)})).join("")}function y(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function O(e,t,a){var i=0;for(e=a?b(e/700):e>>1,e+=b(e/t);e>455;i+=c)e=b(e/35);return b(i+36*e/(e+38))}function E(e){var t,a,i,n,s,r,o,d,u,p,m,h=[],g=e.length,j=0,x=128,y=72;for((a=e.lastIndexOf("-"))<0&&(a=0),i=0;i<a;++i)e.charCodeAt(i)>=128&&f("not-basic"),h.push(e.charCodeAt(i));for(n=a>0?a+1:0;n<g;){for(s=j,r=1,o=c;n>=g&&f("invalid-input"),((d=(m=e.charCodeAt(n++))-48<10?m-22:m-65<26?m-65:m-97<26?m-97:c)>=c||d>b((l-j)/r))&&f("overflow"),j+=d*r,!(d<(u=o<=y?1:o>=y+26?26:o-y));o+=c)r>b(l/(p=c-u))&&f("overflow"),r*=p;y=O(j-s,t=h.length+1,0==s),b(j/t)>l-x&&f("overflow"),x+=b(j/t),j%=t,h.splice(j++,0,x)}return v(h)}function w(e){var t,a,i,n,s,r,o,d,u,p,m,g,j,v,E,w=[];for(g=(e=x(e)).length,t=128,a=0,s=72,r=0;r<g;++r)(m=e[r])<128&&w.push(h(m));for(i=n=w.length,n&&w.push("-");i<g;){for(o=l,r=0;r<g;++r)(m=e[r])>=t&&m<o&&(o=m);for(o-t>b((l-a)/(j=i+1))&&f("overflow"),a+=(o-t)*j,t=o,r=0;r<g;++r)if((m=e[r])<t&&++a>l&&f("overflow"),m==t){for(d=a,u=c;!(d<(p=u<=s?1:u>=s+26?26:u-s));u+=c)E=d-p,v=c-p,w.push(h(y(p+E%v,0))),d=b(E/v);w.push(h(y(d,0))),s=O(a,j,i==n),a=0,++i}++a,++t}return w.join("")}o={version:"1.4.1",ucs2:{decode:x,encode:v},decode:E,encode:w,toASCII:function(e){return j(e,(function(e){return u.test(e)?"xn--"+w(e):e}))},toUnicode:function(e){return j(e,(function(e){return d.test(e)?E(e.slice(4).toLowerCase()):e}))}},void 0===(n=function(){return o}.call(t,a,t,e))||(e.exports=n)}()}).call(this,a(270)(e),a(121))},function(e,t,a){"use strict";e.exports={isString:function(e){return"string"==typeof e},isObject:function(e){return"object"==typeof e&&null!==e},isNull:function(e){return null===e},isNullOrUndefined:function(e){return null==e}}},function(e,t,a){"use strict";t.decode=t.parse=a(427),t.encode=t.stringify=a(428)},function(e,t,a){"use strict";function i(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,a,s){t=t||"&",a=a||"=";var r={};if("string"!=typeof e||0===e.length)return r;var o=/\+/g;e=e.split(t);var l=1e3;s&&"number"==typeof s.maxKeys&&(l=s.maxKeys);var c=e.length;l>0&&c>l&&(c=l);for(var d=0;d<c;++d){var u,p,m,b,h=e[d].replace(o,"%20"),f=h.indexOf(a);f>=0?(u=h.substr(0,f),p=h.substr(f+1)):(u=h,p=""),m=decodeURIComponent(u),b=decodeURIComponent(p),i(r,m)?n(r[m])?r[m].push(b):r[m]=[r[m],b]:r[m]=b}return r};var n=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},function(e,t,a){"use strict";var i=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,a,o){return t=t||"&",a=a||"=",null===e&&(e=void 0),"object"==typeof e?s(r(e),(function(r){var o=encodeURIComponent(i(r))+a;return n(e[r])?s(e[r],(function(e){return o+encodeURIComponent(i(e))})).join(t):o+encodeURIComponent(i(e[r]))})).join(t):o?encodeURIComponent(i(o))+a+encodeURIComponent(i(e)):""};var n=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function s(e,t){if(e.map)return e.map(t);for(var a=[],i=0;i<e.length;i++)a.push(t(e[i],i));return a}var r=Object.keys||function(e){var t=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.push(a);return t}},function(e,t,a){switch(window.__kbnThemeTag__){case"v7dark":return a(430);case"v7light":return a(432);case"v8dark":return a(434);case"v8light":return a(436)}},function(e,t,a){var i=a(68),n=a(431);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var s={insert:"head",singleton:!1};i(n,s);e.exports=n.locals||{}},function(e,t,a){(t=a(69)(!1)).push([e.i,".time-range-selector .time-range-section-container{display:flex}.time-range-selector .time-range-section-title{font-weight:bold;margin-bottom:8px}.time-range-selector .time-range-section{flex:50%;padding:0 8px;border-right:1px solid #343741}.time-range-selector .tab-stack{margin-bottom:0;padding-left:0;list-style:none}.time-range-selector .tab-stack>li{float:none;position:relative;display:block;margin-bottom:4px}.time-range-selector .tab-stack>li>a{position:relative;display:block;padding:8px 16px;border-radius:4px}.time-range-selector .tab-stack>li>a:hover{background-color:#25262E}.time-range-selector .tab-stack>li .body{display:none}.time-range-selector .tab-stack>li.active>a{color:#1D1E24;background-color:#1BA9F5}.time-range-selector .tab-stack>li.active .body{display:block;height:315px}.time-range-selector .tab-stack>li.has-body.active>a{border-radius:4px 4px 0 0}.time-range-selector .tab-stack>li.has-body.active .react-datepicker{border-radius:0 0 4px 4px;border-top:none}.time-range-selector .time-range-section:last-child{border-right:none}\n",""]),e.exports=t},function(e,t,a){var i=a(68),n=a(433);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var s={insert:"head",singleton:!1};i(n,s);e.exports=n.locals||{}},function(e,t,a){(t=a(69)(!1)).push([e.i,".time-range-selector .time-range-section-container{display:flex}.time-range-selector .time-range-section-title{font-weight:bold;margin-bottom:8px}.time-range-selector .time-range-section{flex:50%;padding:0 8px;border-right:1px solid #D3DAE6}.time-range-selector .tab-stack{margin-bottom:0;padding-left:0;list-style:none}.time-range-selector .tab-stack>li{float:none;position:relative;display:block;margin-bottom:4px}.time-range-selector .tab-stack>li>a{position:relative;display:block;padding:8px 16px;border-radius:4px}.time-range-selector .tab-stack>li>a:hover{background-color:#F5F7FA}.time-range-selector .tab-stack>li .body{display:none}.time-range-selector .tab-stack>li.active>a{color:#fff;background-color:#006BB4}.time-range-selector .tab-stack>li.active .body{display:block;height:315px}.time-range-selector .tab-stack>li.has-body.active>a{border-radius:4px 4px 0 0}.time-range-selector .tab-stack>li.has-body.active .react-datepicker{border-radius:0 0 4px 4px;border-top:none}.time-range-selector .time-range-section:last-child{border-right:none}\n",""]),e.exports=t},function(e,t,a){var i=a(68),n=a(435);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var s={insert:"head",singleton:!1};i(n,s);e.exports=n.locals||{}},function(e,t,a){(t=a(69)(!1)).push([e.i,".time-range-selector .time-range-section-container{display:flex}.time-range-selector .time-range-section-title{font-weight:bold;margin-bottom:8px}.time-range-selector .time-range-section{flex:50%;padding:0 8px;border-right:1px solid #343741}.time-range-selector .tab-stack{margin-bottom:0;padding-left:0;list-style:none}.time-range-selector .tab-stack>li{float:none;position:relative;display:block;margin-bottom:4px}.time-range-selector .tab-stack>li>a{position:relative;display:block;padding:8px 16px;border-radius:4px}.time-range-selector .tab-stack>li>a:hover{background-color:#25262E}.time-range-selector .tab-stack>li .body{display:none}.time-range-selector .tab-stack>li.active>a{color:#1D1E24;background-color:#36A2EF}.time-range-selector .tab-stack>li.active .body{display:block;height:315px}.time-range-selector .tab-stack>li.has-body.active>a{border-radius:6px 6px 0 0}.time-range-selector .tab-stack>li.has-body.active .react-datepicker{border-radius:0 0 6px 6px;border-top:none}.time-range-selector .time-range-section:last-child{border-right:none}\n",""]),e.exports=t},function(e,t,a){var i=a(68),n=a(437);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var s={insert:"head",singleton:!1};i(n,s);e.exports=n.locals||{}},function(e,t,a){(t=a(69)(!1)).push([e.i,".time-range-selector .time-range-section-container{display:flex}.time-range-selector .time-range-section-title{font-weight:bold;margin-bottom:8px}.time-range-selector .time-range-section{flex:50%;padding:0 8px;border-right:1px solid #D3DAE6}.time-range-selector .tab-stack{margin-bottom:0;padding-left:0;list-style:none}.time-range-selector .tab-stack>li{float:none;position:relative;display:block;margin-bottom:4px}.time-range-selector .tab-stack>li>a{position:relative;display:block;padding:8px 16px;border-radius:4px}.time-range-selector .tab-stack>li>a:hover{background-color:#F5F7FA}.time-range-selector .tab-stack>li .body{display:none}.time-range-selector .tab-stack>li.active>a{color:#fff;background-color:#07C}.time-range-selector .tab-stack>li.active .body{display:block;height:315px}.time-range-selector .tab-stack>li.has-body.active>a{border-radius:6px 6px 0 0}.time-range-selector .tab-stack>li.has-body.active .react-datepicker{border-radius:0 0 6px 6px;border-top:none}.time-range-selector .time-range-section:last-child{border-right:none}\n",""]),e.exports=t},function(e,t,a){"use strict";t.byteLength=function(e){var t=c(e),a=t[0],i=t[1];return 3*(a+i)/4-i},t.toByteArray=function(e){var t,a,i=c(e),r=i[0],o=i[1],l=new s(function(e,t,a){return 3*(t+a)/4-a}(0,r,o)),d=0,u=o>0?r-4:r;for(a=0;a<u;a+=4)t=n[e.charCodeAt(a)]<<18|n[e.charCodeAt(a+1)]<<12|n[e.charCodeAt(a+2)]<<6|n[e.charCodeAt(a+3)],l[d++]=t>>16&255,l[d++]=t>>8&255,l[d++]=255&t;2===o&&(t=n[e.charCodeAt(a)]<<2|n[e.charCodeAt(a+1)]>>4,l[d++]=255&t);1===o&&(t=n[e.charCodeAt(a)]<<10|n[e.charCodeAt(a+1)]<<4|n[e.charCodeAt(a+2)]>>2,l[d++]=t>>8&255,l[d++]=255&t);return l},t.fromByteArray=function(e){for(var t,a=e.length,n=a%3,s=[],r=16383,o=0,l=a-n;o<l;o+=r)s.push(d(e,o,o+r>l?l:o+r));1===n?(t=e[a-1],s.push(i[t>>2]+i[t<<4&63]+"==")):2===n&&(t=(e[a-2]<<8)+e[a-1],s.push(i[t>>10]+i[t>>4&63]+i[t<<2&63]+"="));return s.join("")};for(var i=[],n=[],s="undefined"!=typeof Uint8Array?Uint8Array:Array,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,l=r.length;o<l;++o)i[o]=r[o],n[r.charCodeAt(o)]=o;function c(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var a=e.indexOf("=");return-1===a&&(a=t),[a,a===t?0:4-a%4]}function d(e,t,a){for(var n,s,r=[],o=t;o<a;o+=3)n=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]),r.push(i[(s=n)>>18&63]+i[s>>12&63]+i[s>>6&63]+i[63&s]);return r.join("")}n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,a,i,n){var s,r,o=8*n-i-1,l=(1<<o)-1,c=l>>1,d=-7,u=a?n-1:0,p=a?-1:1,m=e[t+u];for(u+=p,s=m&(1<<-d)-1,m>>=-d,d+=o;d>0;s=256*s+e[t+u],u+=p,d-=8);for(r=s&(1<<-d)-1,s>>=-d,d+=i;d>0;r=256*r+e[t+u],u+=p,d-=8);if(0===s)s=1-c;else{if(s===l)return r?NaN:1/0*(m?-1:1);r+=Math.pow(2,i),s-=c}return(m?-1:1)*r*Math.pow(2,s-i)},t.write=function(e,t,a,i,n,s){var r,o,l,c=8*s-n-1,d=(1<<c)-1,u=d>>1,p=23===n?Math.pow(2,-24)-Math.pow(2,-77):0,m=i?0:s-1,b=i?1:-1,h=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(o=isNaN(t)?1:0,r=d):(r=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-r))<1&&(r--,l*=2),(t+=r+u>=1?p/l:p*Math.pow(2,1-u))*l>=2&&(r++,l/=2),r+u>=d?(o=0,r=d):r+u>=1?(o=(t*l-1)*Math.pow(2,n),r+=u):(o=t*Math.pow(2,u-1)*Math.pow(2,n),r=0));n>=8;e[a+m]=255&o,m+=b,o/=256,n-=8);for(r=r<<n|o,c+=n;c>0;e[a+m]=255&r,m+=b,r/=256,c-=8);e[a+m-b]|=128*h}},function(e,t){var a={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==a.call(e)}},function(e,t){e.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var a=function(){};a.prototype=t.prototype,e.prototype=new a,e.prototype.constructor=e}},function(e,t,a){"use strict";var i=a(158),n=a(109).CalendarObject,s=a(109).schema,r=a(178).iCalendar,o=a(177).RRule,l=t.VEvent=function(e,t){e instanceof r||null==e||(t=e,e=null),n.call(this,e,"VEVENT"),void 0!==t&&(this.addProperty("DTSTAMP",new Date),this.addProperty("UID",t))};i.inherits(l,n),l.prototype.setSummary=function(e){this.addProperty("SUMMARY",e)},l.prototype.setLocation=function(e){this.addProperty("LOCATION",e)},l.prototype.setDescription=function(e){this.addProperty("DESCRIPTION",e)},l.prototype.setDate=function(e,t){this.addProperty("DTSTART",e),t instanceof Date?this.addProperty("DTEND",t):this.addProperty("DURATION",t)},l.prototype.rrule=function(){var e=this.getPropertyValue("RRULE");if(!e)return null;for(var t,a=[],i=0;t=this.getPropertyValue("EXDATE",i++);)a.push.apply(a,t);return new o(e,{DTSTART:this.getPropertyValue("DTSTART"),DTEND:this.getPropertyValue("DTEND"),EXDATE:a})},l.prototype.inTimeRange=function(e,t){var a=this.rrule();if(a){var i=a.next(e);return null!==i&&(!t||i<=t)}var n=this.getPropertyValue("DTSTART"),s=this.getPropertyValue("DTEND");if(!s){var r=this.getPropertyValue("DURATION");if(0===r)return(!e||e<=n)&&(!t||t>n);s=r?new Date(n.valueOf()+1e3*this.getPropertyValue("DURATION")):new Date(n.valueOf()+864e5)}return(!e||e<s)&&(!t||t>n)},l.prototype.reply=function(e,t,a){var i=this.clone(!0);a=a||{},!0===t||void 0===t?t="ACCEPTED":!1===t&&(t="DECLINED"),i.setProperty("ATTENDEE",e,{PARTSTAT:t,CN:a.CN||e}),i.setProperty("DTSTAMP",new Date),i.setProperty("LAST-MODIFIED",new Date);var n=new r;return n.addProperty("METHOD","REPLY"),this.calendar&&n.addComponents(this.calendar.getComponents("VTIMEZONE")),n.addComponent(i),n},s.VEVENT={factory:l,valid_properties:[],required_properties:["DTSTAMP","UID"],valid_children:[],required_children:[]}},function(e,t,a){var i=a(212),n=a(158),s=a(109).CalendarObject,r=a(109).schema,o=a(177).RRule,l=t.VTimezone=function(e,t){s.call(this,e,"VTIMEZONE"),this.addProperty("TZID",t)};n.inherits(l,s),l.prototype.getRRule=function(e){var t=this.getComponents(e)[0];return t&&t.getPropertyValue("RRULE")?new o(t.getPropertyValue("RRULE"),t.getPropertyValue("DTSTART"),t.getPropertyValue("DTEND")):null},l.prototype.getOffsetForDate=function(e){if(!this.getComponents("DAYLIGHT").length)return this.getComponents("STANDARD")[0].getPropertyValue("TZOFFSETTO");i.equal(1,this.components.STANDARD.length),i.equal(1,this.components.DAYLIGHT.length);var t=this.getRRule("STANDARD"),a=this.getRRule("DAYLIGHT");return null===t||null===a?this.getComponents("STANDARD")[0].getPropertyValue("TZOFFSETTO"):(t=t.next(e),a=a.next(e),this.getComponents(a<t?"STANDARD":"DAYLIGHT")[0].getPropertyValue("TZOFFSETTO"))},l.prototype.fromLocalTime=function(e){var t=this.getOffsetForDate(e),a=t%100;return t=(t-a)/100,new Date(Date.UTC(e[0],e[1]-1,e[2],e[3]-t,e[4]-a,e[5]))},r.VTIMEZONE={factory:l}},function(e,t,a){switch(window.__kbnThemeTag__){case"v7dark":return a(446);case"v7light":return a(448);case"v8dark":return a(450);case"v8light":return a(452)}},function(e,t,a){var i=a(68),n=a(447);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var s={insert:"head",singleton:!1};i(n,s);e.exports=n.locals||{}},function(e,t,a){(t=a(69)(!1)).push([e.i,".mlExpandedRowDetails{padding:0 8px 8px 8px}.mlExpandedRowDetailsSection thead{display:none}\n",""]),e.exports=t},function(e,t,a){var i=a(68),n=a(449);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var s={insert:"head",singleton:!1};i(n,s);e.exports=n.locals||{}},function(e,t,a){(t=a(69)(!1)).push([e.i,".mlExpandedRowDetails{padding:0 8px 8px 8px}.mlExpandedRowDetailsSection thead{display:none}\n",""]),e.exports=t},function(e,t,a){var i=a(68),n=a(451);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var s={insert:"head",singleton:!1};i(n,s);e.exports=n.locals||{}},function(e,t,a){(t=a(69)(!1)).push([e.i,".mlExpandedRowDetails{padding:0 8px 8px 8px}.mlExpandedRowDetailsSection thead{display:none}\n",""]),e.exports=t},function(e,t,a){var i=a(68),n=a(453);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var s={insert:"head",singleton:!1};i(n,s);e.exports=n.locals||{}},function(e,t,a){(t=a(69)(!1)).push([e.i,".mlExpandedRowDetails{padding:0 8px 8px 8px}.mlExpandedRowDetailsSection thead{display:none}\n",""]),e.exports=t},function(e,t,a){switch(window.__kbnThemeTag__){case"v7dark":return a(455);case"v7light":return a(457);case"v8dark":return a(459);case"v8light":return a(461)}},function(e,t,a){var i=a(68),n=a(456);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var s={insert:"head",singleton:!1};i(n,s);e.exports=n.locals||{}},function(e,t,a){(t=a(69)(!1)).push([e.i,".mlExpandedRowJobMessages{padding:0 8px 8px 8px}.mlExpandedRowJobMessages .euiTable,.mlExpandedRowJobMessages .euiTableRowCell{background-color:transparent !important}\n",""]),e.exports=t},function(e,t,a){var i=a(68),n=a(458);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var s={insert:"head",singleton:!1};i(n,s);e.exports=n.locals||{}},function(e,t,a){(t=a(69)(!1)).push([e.i,".mlExpandedRowJobMessages{padding:0 8px 8px 8px}.mlExpandedRowJobMessages .euiTable,.mlExpandedRowJobMessages .euiTableRowCell{background-color:transparent !important}\n",""]),e.exports=t},function(e,t,a){var i=a(68),n=a(460);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var s={insert:"head",singleton:!1};i(n,s);e.exports=n.locals||{}},function(e,t,a){(t=a(69)(!1)).push([e.i,".mlExpandedRowJobMessages{padding:0 8px 8px 8px}.mlExpandedRowJobMessages .euiTable,.mlExpandedRowJobMessages .euiTableRowCell{background-color:transparent !important}\n",""]),e.exports=t},function(e,t,a){var i=a(68),n=a(462);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var s={insert:"head",singleton:!1};i(n,s);e.exports=n.locals||{}},function(e,t,a){(t=a(69)(!1)).push([e.i,".mlExpandedRowJobMessages{padding:0 8px 8px 8px}.mlExpandedRowJobMessages .euiTable,.mlExpandedRowJobMessages .euiTableRowCell{background-color:transparent !important}\n",""]),e.exports=t},function(e,t,a){"use strict";(function(t){function i(e){return e&&"object"==typeof e&&"default"in e?e.default:e}var n=i(a(466)),s=i(a(467));function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var a=0;a<t.length;a++){var i=t[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function c(e,t,a){return t&&l(e.prototype,t),a&&l(e,a),e}function d(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=[],i=!0,n=!1,s=void 0;try{for(var r,o=e[Symbol.iterator]();!(i=(r=o.next()).done)&&(a.push(r.value),!t||a.length!==t);i=!0);}catch(e){n=!0,s=e}finally{try{i||null==o.return||o.return()}finally{if(n)throw s}}return a}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var u="undefined"==typeof window?null:window,p=u?u.navigator:null,m=(u&&u.document,r("")),b=r({}),h=r((function(){})),f="undefined"==typeof HTMLElement?"undefined":r(HTMLElement),g=function(e){return e&&e.instanceString&&x(e.instanceString)?e.instanceString():null},j=function(e){return null!=e&&r(e)==m},x=function(e){return null!=e&&r(e)===h},v=function(e){return Array.isArray?Array.isArray(e):null!=e&&e instanceof Array},y=function(e){return null!=e&&r(e)===b&&!v(e)&&e.constructor===Object},O=function(e){return null!=e&&r(e)===r(1)&&!isNaN(e)},E=function(e){return"undefined"===f?void 0:null!=e&&e instanceof HTMLElement},w=function(e){return _(e)||S(e)},_=function(e){return"collection"===g(e)&&e._private.single},S=function(e){return"collection"===g(e)&&!e._private.single},M=function(e){return"core"===g(e)},k=function(e){return"stylesheet"===g(e)},C=function(e){return null==e||!(""!==e&&!e.match(/^\s+$/))},T=function(e){return function(e){return null!=e&&r(e)===b}(e)&&x(e.then)},F=function(e,t){t||(t=function(){if(1===arguments.length)return arguments[0];if(0===arguments.length)return"undefined";for(var e=[],t=0;t<arguments.length;t++)e.push(arguments[t]);return e.join("$")});var a=function a(){var i,n=this,s=arguments,r=t.apply(n,s),o=a.cache;return(i=o[r])||(i=o[r]=e.apply(n,s)),i};return a.cache={},a},I=F((function(e){return e.replace(/([A-Z])/g,(function(e){return"-"+e.toLowerCase()}))})),D=F((function(e){return e.replace(/(-\w)/g,(function(e){return e[1].toUpperCase()}))})),A=F((function(e,t){return e+t[0].toUpperCase()+t.substring(1)}),(function(e,t){return e+"$"+t})),L=function(e){return C(e)?e:e.charAt(0).toUpperCase()+e.substring(1)},R="(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))",P=function(e,t){return e<t?-1:e>t?1:0},N=null!=Object.assign?Object.assign.bind(Object):function(e){for(var t=arguments,a=1;a<t.length;a++){var i=t[a];if(null!=i)for(var n=Object.keys(i),s=0;s<n.length;s++){var r=n[s];e[r]=i[r]}}return e},z=function(e){return(v(e)?e:null)||function(e){return B[e.toLowerCase()]}(e)||function(e){if((4===e.length||7===e.length)&&"#"===e[0]){var t,a,i,n=16;return 4===e.length?(t=parseInt(e[1]+e[1],n),a=parseInt(e[2]+e[2],n),i=parseInt(e[3]+e[3],n)):(t=parseInt(e[1]+e[2],n),a=parseInt(e[3]+e[4],n),i=parseInt(e[5]+e[6],n)),[t,a,i]}}(e)||function(e){var t,a=new RegExp("^rgb[a]?\\(((?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))[%]?)\\s*,\\s*((?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))[%]?)\\s*,\\s*((?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))[%]?)(?:\\s*,\\s*((?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))))?\\)$").exec(e);if(a){t=[];for(var i=[],n=1;n<=3;n++){var s=a[n];if("%"===s[s.length-1]&&(i[n]=!0),s=parseFloat(s),i[n]&&(s=s/100*255),s<0||s>255)return;t.push(Math.floor(s))}var r=i[1]||i[2]||i[3],o=i[1]&&i[2]&&i[3];if(r&&!o)return;var l=a[4];if(void 0!==l){if((l=parseFloat(l))<0||l>1)return;t.push(l)}}return t}(e)||function(e){var t,a,i,n,s,r,o,l;function c(e,t,a){return a<0&&(a+=1),a>1&&(a-=1),a<1/6?e+6*(t-e)*a:a<.5?t:a<2/3?e+(t-e)*(2/3-a)*6:e}var d=new RegExp("^hsl[a]?\\(((?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?)))\\s*,\\s*((?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))[%])\\s*,\\s*((?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))[%])(?:\\s*,\\s*((?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))))?\\)$").exec(e);if(d){if((a=parseInt(d[1]))<0?a=(360- -1*a%360)%360:a>360&&(a%=360),a/=360,(i=parseFloat(d[2]))<0||i>100)return;if(i/=100,(n=parseFloat(d[3]))<0||n>100)return;if(n/=100,void 0!==(s=d[4])&&((s=parseFloat(s))<0||s>1))return;if(0===i)r=o=l=Math.round(255*n);else{var u=n<.5?n*(1+i):n+i-n*i,p=2*n-u;r=Math.round(255*c(p,u,a+1/3)),o=Math.round(255*c(p,u,a)),l=Math.round(255*c(p,u,a-1/3))}t=[r,o,l,s]}return t}(e)},B={transparent:[0,0,0,0],aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],grey:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},J=function(e){for(var t=e.map,a=e.keys,i=a.length,n=0;n<i;n++){var s=a[n];if(y(s))throw Error("Tried to set map with object key");n<a.length-1?(null==t[s]&&(t[s]={}),t=t[s]):t[s]=e.value}},V=function(e){for(var t=e.map,a=e.keys,i=a.length,n=0;n<i;n++){var s=a[n];if(y(s))throw Error("Tried to get map with object key");if(null==(t=t[s]))return t}return t},U=u?u.performance:null,G=U&&U.now?function(){return U.now()}:function(){return Date.now()},q=function(){if(u){if(u.requestAnimationFrame)return function(e){u.requestAnimationFrame(e)};if(u.mozRequestAnimationFrame)return function(e){u.mozRequestAnimationFrame(e)};if(u.webkitRequestAnimationFrame)return function(e){u.webkitRequestAnimationFrame(e)};if(u.msRequestAnimationFrame)return function(e){u.msRequestAnimationFrame(e)}}return function(e){e&&setTimeout((function(){e(G())}),1e3/60)}}(),H=function(e){return q(e)},W=G,$=5381,Y=function(e){for(var t,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:$,i=a;!(t=e.next()).done;)i=(i<<5)+i+t.value|0;return i},X=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:$;return(t<<5)+t+e|0},Q=function(e,t){var a={value:0,done:!1},i=0,n=e.length;return Y({next:function(){return i<n?a.value=e[i++]:a.done=!0,a}},t)},K=function(e,t){var a={value:0,done:!1},i=0,n=e.length;return Y({next:function(){return i<n?a.value=e.charCodeAt(i++):a.done=!0,a}},t)},Z=function(){return ee(arguments)},ee=function(e){for(var t,a=0;a<e.length;a++){var i=e[a];t=0===a?K(i):K(i,t)}return t},te=!0,ae=null!=console.warn,ie=null!=console.trace,ne=Number.MAX_SAFE_INTEGER||9007199254740991,se=function(){return!0},re=function(){return!1},oe=function(){return 0},le=function(){},ce=function(e){throw new Error(e)},de=function(e){if(void 0===e)return te;te=!!e},ue=function(e){de()&&(ae?console.warn(e):(console.log(e),ie&&console.trace()))},pe=function(e){return null==e?e:v(e)?e.slice():y(e)?function(e){return N({},e)}(e):e},me=function(e,t){for(t=e="";e++<36;t+=51*e&52?(15^e?8^Math.random()*(20^e?16:4):4).toString(16):"-");return t},be={},he=function(){return be},fe=function(e){var t=Object.keys(e);return function(a){for(var i={},n=0;n<t.length;n++){var s=t[n],r=null==a?void 0:a[s];i[s]=void 0===r?e[s]:r}return i}},ge=function(e,t,a){for(var i=e.length;i>=0&&(e[i]!==t||(e.splice(i,1),a));i--);},je=function(e){e.splice(0,e.length)},xe=function(e,t,a){return a&&(t=A(a,t)),e[t]},ve=function(e,t,a,i){a&&(t=A(a,t)),e[t]=i},ye="undefined"!=typeof Map?Map:function(){function e(){o(this,e),this._obj={}}return c(e,[{key:"set",value:function(e,t){return this._obj[e]=t,this}},{key:"delete",value:function(e){return this._obj[e]=void 0,this}},{key:"clear",value:function(){this._obj={}}},{key:"has",value:function(e){return void 0!==this._obj[e]}},{key:"get",value:function(e){return this._obj[e]}}]),e}(),Oe=function(){function e(t){if(o(this,e),this._obj=Object.create(null),this.size=0,null!=t){var a;a=null!=t.instanceString&&t.instanceString()===this.instanceString()?t.toArray():t;for(var i=0;i<a.length;i++)this.add(a[i])}}return c(e,[{key:"instanceString",value:function(){return"set"}},{key:"add",value:function(e){var t=this._obj;1!==t[e]&&(t[e]=1,this.size++)}},{key:"delete",value:function(e){var t=this._obj;1===t[e]&&(t[e]=0,this.size--)}},{key:"clear",value:function(){this._obj=Object.create(null)}},{key:"has",value:function(e){return 1===this._obj[e]}},{key:"toArray",value:function(){var e=this;return Object.keys(this._obj).filter((function(t){return e.has(t)}))}},{key:"forEach",value:function(e,t){return this.toArray().forEach(e,t)}}]),e}(),Ee="undefined"!==("undefined"==typeof Set?"undefined":r(Set))?Set:Oe,we=function(e,t,a){if(a=!(void 0!==a&&!a),void 0!==e&&void 0!==t&&M(e)){var i=t.group;if(null==i&&(i=t.data&&null!=t.data.source&&null!=t.data.target?"edges":"nodes"),"nodes"===i||"edges"===i){this.length=1,this[0]=this;var n=this._private={cy:e,single:!0,data:t.data||{},position:t.position||{x:0,y:0},autoWidth:void 0,autoHeight:void 0,autoPadding:void 0,compoundBoundsClean:!1,listeners:[],group:i,style:{},rstyle:{},styleCxts:[],styleKeys:{},removed:!0,selected:!!t.selected,selectable:void 0===t.selectable||!!t.selectable,locked:!!t.locked,grabbed:!1,grabbable:void 0===t.grabbable||!!t.grabbable,pannable:void 0===t.pannable?"edges"===i:!!t.pannable,active:!1,classes:new Ee,animation:{current:[],queue:[]},rscratch:{},scratch:t.scratch||{},edges:[],children:[],parent:null,traversalCache:{},backgrounding:!1,bbCache:null,bbCacheShift:{x:0,y:0},bodyBounds:null,overlayBounds:null,labelBounds:{all:null,source:null,target:null,main:null},arrowBounds:{source:null,target:null,"mid-source":null,"mid-target":null}};if(null==n.position.x&&(n.position.x=0),null==n.position.y&&(n.position.y=0),t.renderedPosition){var s=t.renderedPosition,r=e.pan(),o=e.zoom();n.position={x:(s.x-r.x)/o,y:(s.y-r.y)/o}}var l=[];v(t.classes)?l=t.classes:j(t.classes)&&(l=t.classes.split(/\s+/));for(var c=0,d=l.length;c<d;c++){var u=l[c];u&&""!==u&&n.classes.add(u)}this.createEmitter();var p=t.style||t.css;p&&(ue("Setting a `style` bypass at element creation is deprecated"),this.style(p)),(void 0===a||a)&&this.restore()}else ce("An element must be of type `nodes` or `edges`; you specified `"+i+"`")}else ce("An element must have a core reference and parameters set")},_e=function(e){return e={bfs:e.bfs||!e.dfs,dfs:e.dfs||!e.bfs},function(t,a,i){var n;y(t)&&!w(t)&&(t=(n=t).roots||n.root,a=n.visit,i=n.directed),i=2!==arguments.length||x(a)?i:a,a=x(a)?a:function(){};for(var s,r=this._private.cy,o=t=j(t)?this.filter(t):t,l=[],c=[],d={},u={},p={},m=0,b=this.byGroup(),h=b.nodes,f=b.edges,g=0;g<o.length;g++){var v=o[g],O=v.id();v.isNode()&&(l.unshift(v),e.bfs&&(p[O]=!0,c.push(v)),u[O]=0)}var E=function(){var t=e.bfs?l.shift():l.pop(),n=t.id();if(e.dfs){if(p[n])return"continue";p[n]=!0,c.push(t)}var r,o=u[n],b=d[n],g=null!=b?b.source():null,j=null!=b?b.target():null,x=null==b?void 0:t.same(g)?j[0]:g[0];if(!0===(r=a(t,b,x,m++,o)))return s=t,"break";if(!1===r)return"break";for(var v=t.connectedEdges().filter((function(e){return(!i||e.source().same(t))&&f.has(e)})),y=0;y<v.length;y++){var O=v[y],E=O.connectedNodes().filter((function(e){return!e.same(t)&&h.has(e)})),w=E.id();0===E.length||p[w]||(E=E[0],l.push(E),e.bfs&&(p[w]=!0,c.push(E)),d[w]=O,u[w]=u[n]+1)}};e:for(;0!==l.length;){var _=E();switch(_){case"continue":continue;case"break":break e}}for(var S=r.collection(),M=0;M<c.length;M++){var k=c[M],C=d[k.id()];null!=C&&S.merge(C),S.merge(k)}return{path:r.collection(S),found:r.collection(s)}}},Se={breadthFirstSearch:_e({bfs:!0}),depthFirstSearch:_e({dfs:!0})};Se.bfs=Se.breadthFirstSearch,Se.dfs=Se.depthFirstSearch;var Me=fe({root:null,weight:function(e){return 1},directed:!1}),ke={dijkstra:function(e){if(!y(e)){var t=arguments;e={root:t[0],weight:t[1],directed:t[2]}}var a=Me(e),i=a.root,n=a.weight,r=a.directed,o=this,l=n,c=j(i)?this.filter(i)[0]:i[0],d={},u={},p={},m=this.byGroup(),b=m.nodes,h=m.edges;h.unmergeBy((function(e){return e.isLoop()}));for(var f=function(e){return d[e.id()]},g=function(e,t){d[e.id()]=t,x.updateItem(e)},x=new s((function(e,t){return f(e)-f(t)})),v=0;v<b.length;v++){var O=b[v];d[O.id()]=O.same(c)?0:1/0,x.push(O)}for(var E=function(e,t){for(var a,i=(r?e.edgesTo(t):e.edgesWith(t)).intersect(h),n=1/0,s=0;s<i.length;s++){var o=i[s],c=l(o);(c<n||!a)&&(n=c,a=o)}return{edge:a,dist:n}};x.size()>0;){var w=x.pop(),_=f(w),S=w.id();if(p[S]=_,_!==1/0)for(var M=w.neighborhood().intersect(b),k=0;k<M.length;k++){var C=M[k],T=C.id(),F=E(w,C),I=_+F.dist;I<f(C)&&(g(C,I),u[T]={node:w,edge:F.edge})}}return{distanceTo:function(e){var t=j(e)?b.filter(e)[0]:e[0];return p[t.id()]},pathTo:function(e){var t=j(e)?b.filter(e)[0]:e[0],a=[],i=t,n=i.id();if(t.length>0)for(a.unshift(t);u[n];){var s=u[n];a.unshift(s.edge),a.unshift(s.node),n=(i=s.node).id()}return o.spawn(a)}}}},Ce={kruskal:function(e){e=e||function(e){return 1};for(var t=this.byGroup(),a=t.nodes,i=t.edges,n=a.length,s=new Array(n),r=a,o=function(e){for(var t=0;t<s.length;t++){if(s[t].has(e))return t}},l=0;l<n;l++)s[l]=this.spawn(a[l]);for(var c=i.sort((function(t,a){return e(t)-e(a)})),d=0;d<c.length;d++){var u=c[d],p=u.source()[0],m=u.target()[0],b=o(p),h=o(m),f=s[b],g=s[h];b!==h&&(r.merge(u),f.merge(g),s.splice(h,1))}return r}},Te=fe({root:null,goal:null,weight:function(e){return 1},heuristic:function(e){return 0},directed:!1}),Fe={aStar:function(e){var t=this.cy(),a=Te(e),i=a.root,n=a.goal,r=a.heuristic,o=a.directed,l=a.weight;i=t.collection(i)[0],n=t.collection(n)[0];var c,d,u=i.id(),p=n.id(),m={},b={},h={},f=new s((function(e,t){return b[e.id()]-b[t.id()]})),g=new Ee,j={},x={},v=function(e,t){f.push(e),g.add(t)};v(i,u),m[u]=0,b[u]=r(i);for(var y,O=0;f.size()>0;){if(c=f.pop(),d=c.id(),g.delete(d),O++,d===p){for(var E=[],w=n,_=p,S=x[_];E.unshift(w),null!=S&&E.unshift(S),null!=(w=j[_]);)S=x[_=w.id()];return{found:!0,distance:m[d],path:this.spawn(E),steps:O}}h[d]=!0;for(var M=c._private.edges,k=0;k<M.length;k++){var C=M[k];if(this.hasElementWithId(C.id())&&(!o||C.data("source")===d)){var T=C.source(),F=C.target(),I=T.id()!==d?T:F,D=I.id();if(this.hasElementWithId(D)&&!h[D]){var A=m[d]+l(C);y=D,g.has(y)?A<m[D]&&(m[D]=A,b[D]=A+r(I),j[D]=c):(m[D]=A,b[D]=A+r(I),v(I,D),j[D]=c,x[D]=C)}}}}return{found:!1,distance:void 0,path:void 0,steps:O}}},Ie=fe({weight:function(e){return 1},directed:!1}),De={floydWarshall:function(e){for(var t=this.cy(),a=Ie(e),i=a.weight,n=a.directed,s=i,r=this.byGroup(),o=r.nodes,l=r.edges,c=o.length,d=c*c,u=function(e){return o.indexOf(e)},p=function(e){return o[e]},m=new Array(d),b=0;b<d;b++){var h=b%c,f=(b-h)/c;m[b]=f===h?0:1/0}for(var g=new Array(d),x=new Array(d),v=0;v<l.length;v++){var y=l[v],O=y.source()[0],E=y.target()[0];if(O!==E){var w=u(O),_=u(E),S=w*c+_,M=s(y);if(m[S]>M&&(m[S]=M,g[S]=_,x[S]=y),!n){var k=_*c+w;!n&&m[k]>M&&(m[k]=M,g[k]=w,x[k]=y)}}}for(var C=0;C<c;C++)for(var T=0;T<c;T++)for(var F=T*c+C,I=0;I<c;I++){var D=T*c+I,A=C*c+I;m[F]+m[A]<m[D]&&(m[D]=m[F]+m[A],g[D]=g[F])}var L=function(e){return u(function(e){return(j(e)?t.filter(e):e)[0]}(e))},R={distance:function(e,t){var a=L(e),i=L(t);return m[a*c+i]},path:function(e,a){var i=L(e),n=L(a),s=p(i);if(i===n)return s.collection();if(null==g[i*c+n])return t.collection();var r,o=t.collection(),l=i;for(o.merge(s);i!==n;)l=i,i=g[i*c+n],r=x[l*c+i],o.merge(r),o.merge(p(i));return o}};return R}},Ae=fe({weight:function(e){return 1},directed:!1,root:null}),Le={bellmanFord:function(e){var t=this,a=Ae(e),i=a.weight,n=a.directed,s=a.root,r=i,o=this,l=this.cy(),c=this.byGroup(),d=c.edges,u=c.nodes,p=u.length,m=new ye,b=!1;s=l.collection(s)[0],d.unmergeBy((function(e){return e.isLoop()}));for(var h=d.length,f=function(e){var t=m.get(e.id());return t||(t={},m.set(e.id(),t)),t},g=function(e){return(j(e)?l.$(e):e)[0]},x=0;x<p;x++){var v=u[x],y=f(v);v.same(s)?y.dist=0:y.dist=1/0,y.pred=null,y.edge=null}for(var O=!1,E=function(e,t,a,i,n,s){var r=i.dist+s;r<n.dist&&!a.same(i.edge)&&(n.dist=r,n.pred=e,n.edge=a,O=!0)},w=1;w<p;w++){O=!1;for(var _=0;_<h;_++){var S=d[_],M=S.source(),k=S.target(),C=r(S),T=f(M),F=f(k);E(M,0,S,T,F,C),n||E(k,0,S,F,T,C)}if(!O)break}if(O)for(var I=0;I<h;I++){var D=d[I],A=D.source(),L=D.target(),R=r(D),P=f(A).dist,N=f(L).dist;if(P+R<N||!n&&N+R<P){ue("Graph contains a negative weight cycle for Bellman-Ford"),b=!0;break}}return{distanceTo:function(e){return f(g(e)).dist},pathTo:function(e){for(var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:s,i=g(e),n=[],r=i;;){if(null==r)return t.spawn();var l=f(r),c=l.edge,d=l.pred;if(n.unshift(r[0]),r.same(a)&&n.length>0)break;null!=c&&n.unshift(c),r=d}return o.spawn(n)},hasNegativeWeightCycle:b,negativeWeightCycles:[]}}},Re=Math.sqrt(2),Pe=function(e,t,a){0===a.length&&ce("Karger-Stein must be run on a connected (sub)graph");for(var i=a[e],n=i[1],s=i[2],r=t[n],o=t[s],l=a,c=l.length-1;c>=0;c--){var d=l[c],u=d[1],p=d[2];(t[u]===r&&t[p]===o||t[u]===o&&t[p]===r)&&l.splice(c,1)}for(var m=0;m<l.length;m++){var b=l[m];b[1]===o?(l[m]=b.slice(),l[m][1]=r):b[2]===o&&(l[m]=b.slice(),l[m][2]=r)}for(var h=0;h<t.length;h++)t[h]===o&&(t[h]=r);return l},Ne=function(e,t,a,i){for(;a>i;){var n=Math.floor(Math.random()*t.length);t=Pe(n,e,t),a--}return t},ze={kargerStein:function(){var e=this.byGroup(),t=e.nodes,a=e.edges;a.unmergeBy((function(e){return e.isLoop()}));var i=t.length,n=a.length,s=Math.ceil(Math.pow(Math.log(i)/Math.LN2,2)),r=Math.floor(i/Re);if(!(i<2)){for(var o=[],l=0;l<n;l++){var c=a[l];o.push([l,t.indexOf(c.source()),t.indexOf(c.target())])}for(var d=1/0,u=[],p=new Array(i),m=new Array(i),b=new Array(i),h=function(e,t){for(var a=0;a<i;a++)t[a]=e[a]},f=0;f<=s;f++){for(var g=0;g<i;g++)m[g]=g;var j=Ne(m,o.slice(),i,r),x=j.slice();h(m,b);var v=Ne(m,j,r,2),y=Ne(b,x,r,2);v.length<=y.length&&v.length<d?(d=v.length,u=v,h(m,p)):y.length<=v.length&&y.length<d&&(d=y.length,u=y,h(b,p))}for(var O=this.spawn(u.map((function(e){return a[e[0]]}))),E=this.spawn(),w=this.spawn(),_=p[0],S=0;S<p.length;S++){var M=p[S],k=t[S];M===_?E.merge(k):w.merge(k)}return{cut:O,partition1:E,partition2:w}}ce("At least 2 nodes are required for Karger-Stein algorithm")}},Be=function(e,t,a){return{x:e.x*t+a.x,y:e.y*t+a.y}},Je=function(e,t,a){return{x:(e.x-a.x)/t,y:(e.y-a.y)/t}},Ve=function(e){return{x:e[0],y:e[1]}},Ue=function(e,t){return Math.atan2(t,e)-Math.PI/2},Ge=Math.log2||function(e){return Math.log(e)/Math.log(2)},qe=function(e){return e>0?1:e<0?-1:0},He=function(e,t){return Math.sqrt(We(e,t))},We=function(e,t){var a=t.x-e.x,i=t.y-e.y;return a*a+i*i},$e=function(e){for(var t=e.length,a=0,i=0;i<t;i++)a+=e[i];for(var n=0;n<t;n++)e[n]=e[n]/a;return e},Ye=function(e,t,a,i){return(1-i)*(1-i)*e+2*(1-i)*i*t+i*i*a},Xe=function(e,t,a,i){return{x:Ye(e.x,t.x,a.x,i),y:Ye(e.y,t.y,a.y,i)}},Qe=function(e,t,a){return Math.max(e,Math.min(a,t))},Ke=function(e){if(null==e)return{x1:1/0,y1:1/0,x2:-1/0,y2:-1/0,w:0,h:0};if(null!=e.x1&&null!=e.y1){if(null!=e.x2&&null!=e.y2&&e.x2>=e.x1&&e.y2>=e.y1)return{x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,w:e.x2-e.x1,h:e.y2-e.y1};if(null!=e.w&&null!=e.h&&e.w>=0&&e.h>=0)return{x1:e.x1,y1:e.y1,x2:e.x1+e.w,y2:e.y1+e.h,w:e.w,h:e.h}}},Ze=function(e,t,a){e.x1=Math.min(e.x1,t),e.x2=Math.max(e.x2,t),e.w=e.x2-e.x1,e.y1=Math.min(e.y1,a),e.y2=Math.max(e.y2,a),e.h=e.y2-e.y1},et=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e.x1-=t,e.x2+=t,e.y1-=t,e.y2+=t,e.w=e.x2-e.x1,e.h=e.y2-e.y1,e},tt=function(e){var t,a,i,n,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0];if(1===s.length)t=a=i=n=s[0];else if(2===s.length)t=i=s[0],n=a=s[1];else if(4===s.length){var r=d(s,4);t=r[0],a=r[1],i=r[2],n=r[3]}return e.x1-=n,e.x2+=a,e.y1-=t,e.y2+=i,e.w=e.x2-e.x1,e.h=e.y2-e.y1,e},at=function(e,t){e.x1=t.x1,e.y1=t.y1,e.x2=t.x2,e.y2=t.y2,e.w=e.x2-e.x1,e.h=e.y2-e.y1},it=function(e,t){e.x1+=t.x,e.x2+=t.x,e.y1+=t.y,e.y2+=t.y},nt=function(e,t){return!(e.x1>t.x2)&&(!(t.x1>e.x2)&&(!(e.x2<t.x1)&&(!(t.x2<e.x1)&&(!(e.y2<t.y1)&&(!(t.y2<e.y1)&&(!(e.y1>t.y2)&&!(t.y1>e.y2)))))))},st=function(e,t,a){return e.x1<=t&&t<=e.x2&&e.y1<=a&&a<=e.y2},rt=function(e,t){return st(e,t.x1,t.y1)&&st(e,t.x2,t.y2)},ot=function(e,t,a,i,n,s,r){var o,l=_t(n,s),c=n/2,d=s/2,u=i-d-r;if((o=xt(e,t,a,i,a-c+l-r,u,a+c-l+r,u,!1)).length>0)return o;var p=a+c+r;if((o=xt(e,t,a,i,p,i-d+l-r,p,i+d-l+r,!1)).length>0)return o;var m=i+d+r;if((o=xt(e,t,a,i,a-c+l-r,m,a+c-l+r,m,!1)).length>0)return o;var b,h=a-c-r;if((o=xt(e,t,a,i,h,i-d+l-r,h,i+d-l+r,!1)).length>0)return o;var f=a-c+l,g=i-d+l;if((b=gt(e,t,a,i,f,g,l+r)).length>0&&b[0]<=f&&b[1]<=g)return[b[0],b[1]];var j=a+c-l,x=i-d+l;if((b=gt(e,t,a,i,j,x,l+r)).length>0&&b[0]>=j&&b[1]<=x)return[b[0],b[1]];var v=a+c-l,y=i+d-l;if((b=gt(e,t,a,i,v,y,l+r)).length>0&&b[0]>=v&&b[1]>=y)return[b[0],b[1]];var O=a-c+l,E=i+d-l;return(b=gt(e,t,a,i,O,E,l+r)).length>0&&b[0]<=O&&b[1]>=E?[b[0],b[1]]:[]},lt=function(e,t,a,i,n,s,r){var o=r,l=Math.min(a,n),c=Math.max(a,n),d=Math.min(i,s),u=Math.max(i,s);return l-o<=e&&e<=c+o&&d-o<=t&&t<=u+o},ct=function(e,t,a,i,n,s,r,o,l){var c=Math.min(a,r,n)-l,d=Math.max(a,r,n)+l,u=Math.min(i,o,s)-l,p=Math.max(i,o,s)+l;return!(e<c||e>d||t<u||t>p)},dt=function(e,t,a,i,n,s,r,o){var l=[];!function(e,t,a,i,n){var s,r,o,l,c,d,u,p;0===e&&(e=1e-5),o=-27*(i/=e)+(t/=e)*(9*(a/=e)-t*t*2),s=(r=(3*a-t*t)/9)*r*r+(o/=54)*o,n[1]=0,u=t/3,s>0?(c=(c=o+Math.sqrt(s))<0?-Math.pow(-c,1/3):Math.pow(c,1/3),d=(d=o-Math.sqrt(s))<0?-Math.pow(-d,1/3):Math.pow(d,1/3),n[0]=-u+c+d,u+=(c+d)/2,n[4]=n[2]=-u,u=Math.sqrt(3)*(-d+c)/2,n[3]=u,n[5]=-u):(n[5]=n[3]=0,0===s?(p=o<0?-Math.pow(-o,1/3):Math.pow(o,1/3),n[0]=2*p-u,n[4]=n[2]=-(p+u)):(l=(r=-r)*r*r,l=Math.acos(o/Math.sqrt(l)),p=2*Math.sqrt(r),n[0]=-u+p*Math.cos(l/3),n[2]=-u+p*Math.cos((l+2*Math.PI)/3),n[4]=-u+p*Math.cos((l+4*Math.PI)/3)))}(1*a*a-4*a*n+2*a*r+4*n*n-4*n*r+r*r+i*i-4*i*s+2*i*o+4*s*s-4*s*o+o*o,9*a*n-3*a*a-3*a*r-6*n*n+3*n*r+9*i*s-3*i*i-3*i*o-6*s*s+3*s*o,3*a*a-6*a*n+a*r-a*e+2*n*n+2*n*e-r*e+3*i*i-6*i*s+i*o-i*t+2*s*s+2*s*t-o*t,1*a*n-a*a+a*e-n*e+i*s-i*i+i*t-s*t,l);for(var c=[],d=0;d<6;d+=2)Math.abs(l[d+1])<1e-7&&l[d]>=0&&l[d]<=1&&c.push(l[d]);c.push(1),c.push(0);for(var u,p,m,b=-1,h=0;h<c.length;h++)u=Math.pow(1-c[h],2)*a+2*(1-c[h])*c[h]*n+c[h]*c[h]*r,p=Math.pow(1-c[h],2)*i+2*(1-c[h])*c[h]*s+c[h]*c[h]*o,m=Math.pow(u-e,2)+Math.pow(p-t,2),b>=0?m<b&&(b=m):b=m;return b},ut=function(e,t,a,i,n,s){var r=[e-a,t-i],o=[n-a,s-i],l=o[0]*o[0]+o[1]*o[1],c=r[0]*r[0]+r[1]*r[1],d=r[0]*o[0]+r[1]*o[1],u=d*d/l;return d<0?c:u>l?(e-n)*(e-n)+(t-s)*(t-s):c-u},pt=function(e,t,a){for(var i,n,s,r,o=0,l=0;l<a.length/2;l++)if(i=a[2*l],n=a[2*l+1],l+1<a.length/2?(s=a[2*(l+1)],r=a[2*(l+1)+1]):(s=a[2*(l+1-a.length/2)],r=a[2*(l+1-a.length/2)+1]),i==e&&s==e);else{if(!(i>=e&&e>=s||i<=e&&e<=s))continue;(e-i)/(s-i)*(r-n)+n>t&&o++}return o%2!=0},mt=function(e,t,a,i,n,s,r,o,l){var c,d=new Array(a.length);null!=o[0]?(c=Math.atan(o[1]/o[0]),o[0]<0?c+=Math.PI/2:c=-c-Math.PI/2):c=o;for(var u,p=Math.cos(-c),m=Math.sin(-c),b=0;b<d.length/2;b++)d[2*b]=s/2*(a[2*b]*p-a[2*b+1]*m),d[2*b+1]=r/2*(a[2*b+1]*p+a[2*b]*m),d[2*b]+=i,d[2*b+1]+=n;if(l>0){var h=ht(d,-l);u=bt(h)}else u=d;return pt(e,t,u)},bt=function(e){for(var t,a,i,n,s,r,o,l,c=new Array(e.length/2),d=0;d<e.length/4;d++){t=e[4*d],a=e[4*d+1],i=e[4*d+2],n=e[4*d+3],d<e.length/4-1?(s=e[4*(d+1)],r=e[4*(d+1)+1],o=e[4*(d+1)+2],l=e[4*(d+1)+3]):(s=e[0],r=e[1],o=e[2],l=e[3]);var u=xt(t,a,i,n,s,r,o,l,!0);c[2*d]=u[0],c[2*d+1]=u[1]}return c},ht=function(e,t){for(var a,i,n,s,r=new Array(2*e.length),o=0;o<e.length/2;o++){a=e[2*o],i=e[2*o+1],o<e.length/2-1?(n=e[2*(o+1)],s=e[2*(o+1)+1]):(n=e[0],s=e[1]);var l=s-i,c=-(n-a),d=Math.sqrt(l*l+c*c),u=l/d,p=c/d;r[4*o]=a+u*t,r[4*o+1]=i+p*t,r[4*o+2]=n+u*t,r[4*o+3]=s+p*t}return r},ft=function(e,t,a,i,n,s,r){return e-=n,t-=s,(e/=a/2+r)*e+(t/=i/2+r)*t<=1},gt=function(e,t,a,i,n,s,r){var o=[a-e,i-t],l=[e-n,t-s],c=o[0]*o[0]+o[1]*o[1],d=2*(l[0]*o[0]+l[1]*o[1]),u=d*d-4*c*(l[0]*l[0]+l[1]*l[1]-r*r);if(u<0)return[];var p=(-d+Math.sqrt(u))/(2*c),m=(-d-Math.sqrt(u))/(2*c),b=Math.min(p,m),h=Math.max(p,m),f=[];if(b>=0&&b<=1&&f.push(b),h>=0&&h<=1&&f.push(h),0===f.length)return[];var g=f[0]*o[0]+e,j=f[0]*o[1]+t;return f.length>1?f[0]==f[1]?[g,j]:[g,j,f[1]*o[0]+e,f[1]*o[1]+t]:[g,j]},jt=function(e,t,a){return t<=e&&e<=a||a<=e&&e<=t?e:e<=t&&t<=a||a<=t&&t<=e?t:a},xt=function(e,t,a,i,n,s,r,o,l){var c=e-n,d=a-e,u=r-n,p=t-s,m=i-t,b=o-s,h=u*p-b*c,f=d*p-m*c,g=b*d-u*m;if(0!==g){var j=h/g,x=f/g,v=-.001;return v<=j&&j<=1.001&&v<=x&&x<=1.001||l?[e+j*d,t+j*m]:[]}return 0===h||0===f?jt(e,a,r)===r?[r,o]:jt(e,a,n)===n?[n,s]:jt(n,r,a)===a?[a,i]:[]:[]},vt=function(e,t,a,i,n,s,r,o){var l,c,d,u,p,m,b=[],h=new Array(a.length),f=!0;if(null==s&&(f=!1),f){for(var g=0;g<h.length/2;g++)h[2*g]=a[2*g]*s+i,h[2*g+1]=a[2*g+1]*r+n;if(o>0){var j=ht(h,-o);c=bt(j)}else c=h}else c=a;for(var x=0;x<c.length/2;x++)d=c[2*x],u=c[2*x+1],x<c.length/2-1?(p=c[2*(x+1)],m=c[2*(x+1)+1]):(p=c[0],m=c[1]),0!==(l=xt(e,t,i,n,d,u,p,m)).length&&b.push(l[0],l[1]);return b},yt=function(e,t,a){var i=[e[0]-t[0],e[1]-t[1]],n=Math.sqrt(i[0]*i[0]+i[1]*i[1]),s=(n-a)/n;return s<0&&(s=1e-5),[t[0]+s*i[0],t[1]+s*i[1]]},Ot=function(e,t){var a=wt(e,t);return a=Et(a)},Et=function(e){for(var t,a,i=e.length/2,n=1/0,s=1/0,r=-1/0,o=-1/0,l=0;l<i;l++)t=e[2*l],a=e[2*l+1],n=Math.min(n,t),r=Math.max(r,t),s=Math.min(s,a),o=Math.max(o,a);for(var c=2/(r-n),d=2/(o-s),u=0;u<i;u++)t=e[2*u]=e[2*u]*c,a=e[2*u+1]=e[2*u+1]*d,n=Math.min(n,t),r=Math.max(r,t),s=Math.min(s,a),o=Math.max(o,a);if(s<-1)for(var p=0;p<i;p++)a=e[2*p+1]=e[2*p+1]+(-1-s);return e},wt=function(e,t){var a=1/e*2*Math.PI,i=e%2==0?Math.PI/2+a/2:Math.PI/2;i+=t;for(var n,s=new Array(2*e),r=0;r<e;r++)n=r*a+i,s[2*r]=Math.cos(n),s[2*r+1]=Math.sin(-n);return s},_t=function(e,t){return Math.min(e/4,t/4,8)},St=function(e,t){return{heightOffset:Math.min(15,.05*t),widthOffset:Math.min(100,.25*e),ctrlPtOffsetPct:.05}},Mt=fe({dampingFactor:.8,precision:1e-6,iterations:200,weight:function(e){return 1}}),kt={pageRank:function(e){for(var t=Mt(e),a=t.dampingFactor,i=t.precision,n=t.iterations,s=t.weight,r=this._private.cy,o=this.byGroup(),l=o.nodes,c=o.edges,d=l.length,u=d*d,p=c.length,m=new Array(u),b=new Array(d),h=(1-a)/d,f=0;f<d;f++){for(var g=0;g<d;g++){m[f*d+g]=0}b[f]=0}for(var j=0;j<p;j++){var x=c[j],v=x.data("source"),y=x.data("target");if(v!==y){var O=l.indexOfId(v),E=l.indexOfId(y),w=s(x);m[E*d+O]+=w,b[O]+=w}}for(var _=1/d+h,S=0;S<d;S++)if(0===b[S])for(var M=0;M<d;M++){m[M*d+S]=_}else for(var k=0;k<d;k++){var C=k*d+S;m[C]=m[C]/b[S]+h}for(var T,F=new Array(d),I=new Array(d),D=0;D<d;D++)F[D]=1;for(var A=0;A<n;A++){for(var L=0;L<d;L++)I[L]=0;for(var R=0;R<d;R++)for(var P=0;P<d;P++){var N=R*d+P;I[R]+=m[N]*F[P]}$e(I),T=F,F=I,I=T;for(var z=0,B=0;B<d;B++){var J=T[B]-F[B];z+=J*J}if(z<i)break}return{rank:function(e){return e=r.collection(e)[0],F[l.indexOf(e)]}}}},Ct=fe({root:null,weight:function(e){return 1},directed:!1,alpha:0}),Tt={degreeCentralityNormalized:function(e){e=Ct(e);var t=this.cy(),a=this.nodes(),i=a.length;if(e.directed){for(var n={},s={},r=0,o=0,l=0;l<i;l++){var c=a[l],d=c.id();e.root=c;var u=this.degreeCentrality(e);r<u.indegree&&(r=u.indegree),o<u.outdegree&&(o=u.outdegree),n[d]=u.indegree,s[d]=u.outdegree}return{indegree:function(e){return 0==r?0:(j(e)&&(e=t.filter(e)),n[e.id()]/r)},outdegree:function(e){return 0===o?0:(j(e)&&(e=t.filter(e)),s[e.id()]/o)}}}for(var p={},m=0,b=0;b<i;b++){var h=a[b];e.root=h;var f=this.degreeCentrality(e);m<f.degree&&(m=f.degree),p[h.id()]=f.degree}return{degree:function(e){return 0===m?0:(j(e)&&(e=t.filter(e)),p[e.id()]/m)}}},degreeCentrality:function(e){e=Ct(e);var t=this.cy(),a=this,i=e,n=i.root,s=i.weight,r=i.directed,o=i.alpha;if(n=t.collection(n)[0],r){for(var l=n.connectedEdges(),c=l.filter((function(e){return e.target().same(n)&&a.has(e)})),d=l.filter((function(e){return e.source().same(n)&&a.has(e)})),u=c.length,p=d.length,m=0,b=0,h=0;h<c.length;h++)m+=s(c[h]);for(var f=0;f<d.length;f++)b+=s(d[f]);return{indegree:Math.pow(u,1-o)*Math.pow(m,o),outdegree:Math.pow(p,1-o)*Math.pow(b,o)}}for(var g=n.connectedEdges().intersection(a),j=g.length,x=0,v=0;v<g.length;v++)x+=s(g[v]);return{degree:Math.pow(j,1-o)*Math.pow(x,o)}}};Tt.dc=Tt.degreeCentrality,Tt.dcn=Tt.degreeCentralityNormalised=Tt.degreeCentralityNormalized;var Ft=fe({harmonic:!0,weight:function(){return 1},directed:!1,root:null}),It={closenessCentralityNormalized:function(e){for(var t=Ft(e),a=t.harmonic,i=t.weight,n=t.directed,s=this.cy(),r={},o=0,l=this.nodes(),c=this.floydWarshall({weight:i,directed:n}),d=0;d<l.length;d++){for(var u=0,p=l[d],m=0;m<l.length;m++)if(d!==m){var b=c.distance(p,l[m]);u+=a?1/b:b}a||(u=1/u),o<u&&(o=u),r[p.id()]=u}return{closeness:function(e){return 0==o?0:(e=j(e)?s.filter(e)[0].id():e.id(),r[e]/o)}}},closenessCentrality:function(e){var t=Ft(e),a=t.root,i=t.weight,n=t.directed,s=t.harmonic;a=this.filter(a)[0];for(var r=this.dijkstra({root:a,weight:i,directed:n}),o=0,l=this.nodes(),c=0;c<l.length;c++){var d=l[c];if(!d.same(a)){var u=r.distanceTo(d);o+=s?1/u:u}}return s?o:1/o}};It.cc=It.closenessCentrality,It.ccn=It.closenessCentralityNormalised=It.closenessCentralityNormalized;var Dt=fe({weight:null,directed:!1}),At={betweennessCentrality:function(e){for(var t=Dt(e),a=t.directed,i=t.weight,n=null!=i,r=this.cy(),o=this.nodes(),l={},c={},d=0,u=function(e,t){c[e]=t,t>d&&(d=t)},p=function(e){return c[e]},m=0;m<o.length;m++){var b=o[m],h=b.id();l[h]=a?b.outgoers().nodes():b.openNeighborhood().nodes(),u(h,0)}for(var f=function(e){for(var t=o[e].id(),a=[],c={},d={},m={},b=new s((function(e,t){return m[e]-m[t]})),h=0;h<o.length;h++){var f=o[h].id();c[f]=[],d[f]=0,m[f]=1/0}for(d[t]=1,m[t]=0,b.push(t);!b.empty();){var g=b.pop();if(a.push(g),n)for(var j=0;j<l[g].length;j++){var x=l[g][j],v=r.getElementById(g),y=void 0;y=v.edgesTo(x).length>0?v.edgesTo(x)[0]:x.edgesTo(v)[0];var O=i(y);x=x.id(),m[x]>m[g]+O&&(m[x]=m[g]+O,b.nodes.indexOf(x)<0?b.push(x):b.updateItem(x),d[x]=0,c[x]=[]),m[x]==m[g]+O&&(d[x]=d[x]+d[g],c[x].push(g))}else for(var E=0;E<l[g].length;E++){var w=l[g][E].id();m[w]==1/0&&(b.push(w),m[w]=m[g]+1),m[w]==m[g]+1&&(d[w]=d[w]+d[g],c[w].push(g))}}for(var _={},S=0;S<o.length;S++)_[o[S].id()]=0;for(;a.length>0;)for(var M=a.pop(),k=0;k<c[M].length;k++){var C=c[M][k];_[C]=_[C]+d[C]/d[M]*(1+_[M]),M!=o[e].id()&&u(M,p(M)+_[M])}},g=0;g<o.length;g++)f(g);var j={betweenness:function(e){var t=r.collection(e).id();return p(t)},betweennessNormalized:function(e){if(0==d)return 0;var t=r.collection(e).id();return p(t)/d}};return j.betweennessNormalised=j.betweennessNormalized,j}};At.bc=At.betweennessCentrality;var Lt=fe({expandFactor:2,inflateFactor:2,multFactor:1,maxIterations:20,attributes:[function(e){return 1}]}),Rt=function(e,t){for(var a=0,i=0;i<t.length;i++)a+=t[i](e);return a},Pt=function(e,t){for(var a,i=0;i<t;i++){a=0;for(var n=0;n<t;n++)a+=e[n*t+i];for(var s=0;s<t;s++)e[s*t+i]=e[s*t+i]/a}},Nt=function(e,t,a){for(var i=new Array(a*a),n=0;n<a;n++){for(var s=0;s<a;s++)i[n*a+s]=0;for(var r=0;r<a;r++)for(var o=0;o<a;o++)i[n*a+o]+=e[n*a+r]*t[r*a+o]}return i},zt=function(e,t,a){for(var i=e.slice(0),n=1;n<a;n++)e=Nt(e,i,t);return e},Bt=function(e,t,a){for(var i=new Array(t*t),n=0;n<t*t;n++)i[n]=Math.pow(e[n],a);return Pt(i,t),i},Jt=function(e,t,a,i){for(var n=0;n<a;n++){if(Math.round(e[n]*Math.pow(10,i))/Math.pow(10,i)!==Math.round(t[n]*Math.pow(10,i))/Math.pow(10,i))return!1}return!0},Vt=function(e,t){for(var a=0;a<e.length;a++)if(!t[a]||e[a].id()!==t[a].id())return!1;return!0},Ut=function(e){for(var t=this.nodes(),a=this.edges(),i=this.cy(),n=function(e){return Lt(e)}(e),s={},r=0;r<t.length;r++)s[t[r].id()]=r;for(var o,l=t.length,c=l*l,d=new Array(c),u=0;u<c;u++)d[u]=0;for(var p=0;p<a.length;p++){var m=a[p],b=s[m.source().id()],h=s[m.target().id()],f=Rt(m,n.attributes);d[b*l+h]+=f,d[h*l+b]+=f}!function(e,t,a){for(var i=0;i<t;i++)e[i*t+i]=a}(d,l,n.multFactor),Pt(d,l);for(var g=!0,j=0;g&&j<n.maxIterations;)g=!1,o=zt(d,l,n.expandFactor),d=Bt(o,l,n.inflateFactor),Jt(d,o,c,4)||(g=!0),j++;var x=function(e,t,a,i){for(var n=[],s=0;s<t;s++){for(var r=[],o=0;o<t;o++)Math.round(1e3*e[s*t+o])/1e3>0&&r.push(a[o]);0!==r.length&&n.push(i.collection(r))}return n}(d,l,t,i);return x=function(e){for(var t=0;t<e.length;t++)for(var a=0;a<e.length;a++)t!=a&&Vt(e[t],e[a])&&e.splice(a,1);return e}(x),x},Gt={markovClustering:Ut,mcl:Ut},qt=function(e){return e},Ht=function(e,t){return Math.abs(t-e)},Wt=function(e,t,a){return e+Ht(t,a)},$t=function(e,t,a){return e+Math.pow(a-t,2)},Yt=function(e){return Math.sqrt(e)},Xt=function(e,t,a){return Math.max(e,Ht(t,a))},Qt=function(e,t,a,i,n){for(var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:qt,r=i,o=0;o<e;o++)r=n(r,t(o),a(o));return s(r)},Kt={euclidean:function(e,t,a){return e>=2?Qt(e,t,a,0,$t,Yt):Qt(e,t,a,0,Wt)},squaredEuclidean:function(e,t,a){return Qt(e,t,a,0,$t)},manhattan:function(e,t,a){return Qt(e,t,a,0,Wt)},max:function(e,t,a){return Qt(e,t,a,-1/0,Xt)}};function Zt(e,t,a,i,n,s){var r;return r=x(e)?e:Kt[e]||Kt.euclidean,0===t&&x(e)?r(n,s):r(t,a,i,n,s)}Kt["squared-euclidean"]=Kt.squaredEuclidean,Kt.squaredeuclidean=Kt.squaredEuclidean;var ea=fe({k:2,m:2,sensitivityThreshold:1e-4,distance:"euclidean",maxIterations:10,attributes:[],testMode:!1,testCentroids:null}),ta=function(e){return ea(e)},aa=function(e,t,a,i,n){var s="kMedoids"!==n?function(e){return a[e]}:function(e){return i[e](a)},r=a,o=t;return Zt(e,i.length,s,(function(e){return i[e](t)}),r,o)},ia=function(e,t,a){for(var i=a.length,n=new Array(i),s=new Array(i),r=new Array(t),o=null,l=0;l<i;l++)n[l]=e.min(a[l]).value,s[l]=e.max(a[l]).value;for(var c=0;c<t;c++){o=[];for(var d=0;d<i;d++)o[d]=Math.random()*(s[d]-n[d])+n[d];r[c]=o}return r},na=function(e,t,a,i,n){for(var s=1/0,r=0,o=0;o<t.length;o++){var l=aa(a,e,t[o],i,n);l<s&&(s=l,r=o)}return r},sa=function(e,t,a){for(var i=[],n=null,s=0;s<t.length;s++)a[(n=t[s]).id()]===e&&i.push(n);return i},ra=function(e,t,a){for(var i=0;i<e.length;i++)for(var n=0;n<e[i].length;n++){if(Math.abs(e[i][n]-t[i][n])>a)return!1}return!0},oa=function(e,t,a){for(var i=0;i<a;i++)if(e===t[i])return!0;return!1},la=function(e,t){var a=new Array(t);if(e.length<50)for(var i=0;i<t;i++){for(var n=e[Math.floor(Math.random()*e.length)];oa(n,a,i);)n=e[Math.floor(Math.random()*e.length)];a[i]=n}else for(var s=0;s<t;s++)a[s]=e[Math.floor(Math.random()*e.length)];return a},ca=function(e,t,a){for(var i=0,n=0;n<t.length;n++)i+=aa("manhattan",t[n],e,a,"kMedoids");return i},da=function(e,t,a,i,n){for(var s,r,o=0;o<t.length;o++)for(var l=0;l<e.length;l++)i[o][l]=Math.pow(a[o][l],n.m);for(var c=0;c<e.length;c++)for(var d=0;d<n.attributes.length;d++){s=0,r=0;for(var u=0;u<t.length;u++)s+=i[u][c]*n.attributes[d](t[u]),r+=i[u][c];e[c][d]=s/r}},ua=function(e,t,a,i,n){for(var s=0;s<e.length;s++)t[s]=e[s].slice();for(var r,o,l,c=2/(n.m-1),d=0;d<a.length;d++)for(var u=0;u<i.length;u++){r=0;for(var p=0;p<a.length;p++)o=aa(n.distance,i[u],a[d],n.attributes,"cmeans"),l=aa(n.distance,i[u],a[p],n.attributes,"cmeans"),r+=Math.pow(o/l,c);e[u][d]=1/r}},pa=function(e){var t,a,i,n,s,r=this.cy(),o=this.nodes(),l=ta(e);n=new Array(o.length);for(var c=0;c<o.length;c++)n[c]=new Array(l.k);i=new Array(o.length);for(var d=0;d<o.length;d++)i[d]=new Array(l.k);for(var u=0;u<o.length;u++){for(var p=0,m=0;m<l.k;m++)i[u][m]=Math.random(),p+=i[u][m];for(var b=0;b<l.k;b++)i[u][b]=i[u][b]/p}a=new Array(l.k);for(var h=0;h<l.k;h++)a[h]=new Array(l.attributes.length);s=new Array(o.length);for(var f=0;f<o.length;f++)s[f]=new Array(l.k);for(var g=!0,j=0;g&&j<l.maxIterations;)g=!1,da(a,o,i,s,l),ua(i,n,a,o,l),ra(i,n,l.sensitivityThreshold)||(g=!0),j++;return t=function(e,t,a,i){for(var n,s,r=new Array(a.k),o=0;o<r.length;o++)r[o]=[];for(var l=0;l<t.length;l++){n=-1/0,s=-1;for(var c=0;c<t[0].length;c++)t[l][c]>n&&(n=t[l][c],s=c);r[s].push(e[l])}for(var d=0;d<r.length;d++)r[d]=i.collection(r[d]);return r}(o,i,l,r),{clusters:t,degreeOfMembership:i}},ma={kMeans:function(e){var t,a=this.cy(),i=this.nodes(),n=null,s=ta(e),o=new Array(s.k),l={};t=s.testMode?"number"==typeof s.testCentroids?ia(i,s.k,s.attributes):"object"===r(s.testCentroids)?s.testCentroids:ia(i,s.k,s.attributes):ia(i,s.k,s.attributes);for(var c,d,u,p=!0,m=0;p&&m<s.maxIterations;){for(var b=0;b<i.length;b++)l[(n=i[b]).id()]=na(n,t,s.distance,s.attributes,"kMeans");p=!1;for(var h=0;h<s.k;h++){var f=sa(h,i,l);if(0!==f.length){for(var g=s.attributes.length,j=t[h],x=new Array(g),v=new Array(g),y=0;y<g;y++){v[y]=0;for(var O=0;O<f.length;O++)n=f[O],v[y]+=s.attributes[y](n);x[y]=v[y]/f.length,c=x[y],d=j[y],u=s.sensitivityThreshold,Math.abs(d-c)<=u||(p=!0)}t[h]=x,o[h]=a.collection(f)}}m++}return o},kMedoids:function(e){var t,a,i=this.cy(),n=this.nodes(),s=null,o=ta(e),l=new Array(o.k),c={},d=new Array(o.k);o.testMode?"number"==typeof o.testCentroids||(t="object"===r(o.testCentroids)?o.testCentroids:la(n,o.k)):t=la(n,o.k);for(var u=!0,p=0;u&&p<o.maxIterations;){for(var m=0;m<n.length;m++)c[(s=n[m]).id()]=na(s,t,o.distance,o.attributes,"kMedoids");u=!1;for(var b=0;b<t.length;b++){var h=sa(b,n,c);if(0!==h.length){d[b]=ca(t[b],h,o.attributes);for(var f=0;f<h.length;f++)(a=ca(h[f],h,o.attributes))<d[b]&&(d[b]=a,t[b]=h[f],u=!0);l[b]=i.collection(h)}}p++}return l},fuzzyCMeans:pa,fcm:pa},ba=fe({distance:"euclidean",linkage:"min",mode:"threshold",threshold:1/0,addDendrogram:!1,dendrogramDepth:0,attributes:[]}),ha={single:"min",complete:"max"},fa=function(e,t,a,i,n){for(var s,r=0,o=1/0,l=n.attributes,c=function(e,t){return Zt(n.distance,l.length,(function(t){return l[t](e)}),(function(e){return l[e](t)}),e,t)},d=0;d<e.length;d++){var u=e[d].key,p=a[u][i[u]];p<o&&(r=u,o=p)}if("threshold"===n.mode&&o>=n.threshold||"dendrogram"===n.mode&&1===e.length)return!1;var m,b=t[r],h=t[i[r]];m="dendrogram"===n.mode?{left:b,right:h,key:b.key}:{value:b.value.concat(h.value),key:b.key},e[b.index]=m,e.splice(h.index,1),t[b.key]=m;for(var f=0;f<e.length;f++){var g=e[f];b.key===g.key?s=1/0:"min"===n.linkage?(s=a[b.key][g.key],a[b.key][g.key]>a[h.key][g.key]&&(s=a[h.key][g.key])):"max"===n.linkage?(s=a[b.key][g.key],a[b.key][g.key]<a[h.key][g.key]&&(s=a[h.key][g.key])):s="mean"===n.linkage?(a[b.key][g.key]*b.size+a[h.key][g.key]*h.size)/(b.size+h.size):"dendrogram"===n.mode?c(g.value,b.value):c(g.value[0],b.value[0]),a[b.key][g.key]=a[g.key][b.key]=s}for(var j=0;j<e.length;j++){var x=e[j].key;if(i[x]===b.key||i[x]===h.key){for(var v=x,y=0;y<e.length;y++){var O=e[y].key;a[x][O]<a[x][v]&&(v=O)}i[x]=v}e[j].index=j}return b.key=h.key=b.index=h.index=null,!0},ga=function e(t,a,i){t&&(t.value?a.push(t.value):(t.left&&e(t.left,a),t.right&&e(t.right,a)))},ja=function e(t,a){if(!t)return"";if(t.left&&t.right){var i=e(t.left,a),n=e(t.right,a),s=a.add({group:"nodes",data:{id:i+","+n}});return a.add({group:"edges",data:{source:i,target:s.id()}}),a.add({group:"edges",data:{source:n,target:s.id()}}),s.id()}return t.value?t.value.id():void 0},xa=function e(t,a,i){if(!t)return[];var n=[],s=[],r=[];return 0===a?(t.left&&ga(t.left,n),t.right&&ga(t.right,s),r=n.concat(s),[i.collection(r)]):1===a?t.value?[i.collection(t.value)]:(t.left&&ga(t.left,n),t.right&&ga(t.right,s),[i.collection(n),i.collection(s)]):t.value?[i.collection(t.value)]:(t.left&&(n=e(t.left,a-1,i)),t.right&&(s=e(t.right,a-1,i)),n.concat(s))},va=function(e){for(var t=this.cy(),a=this.nodes(),i=function(e){var t=ba(e),a=ha[t.linkage];return null!=a&&(t.linkage=a),t}(e),n=i.attributes,s=function(e,t){return Zt(i.distance,n.length,(function(t){return n[t](e)}),(function(e){return n[e](t)}),e,t)},r=[],o=[],l=[],c=[],d=0;d<a.length;d++){var u={value:"dendrogram"===i.mode?a[d]:[a[d]],key:d,index:d};r[d]=u,c[d]=u,o[d]=[],l[d]=0}for(var p=0;p<r.length;p++)for(var m=0;m<=p;m++){var b=void 0;b="dendrogram"===i.mode?p===m?1/0:s(r[p].value,r[m].value):p===m?1/0:s(r[p].value[0],r[m].value[0]),o[p][m]=b,o[m][p]=b,b<o[p][l[p]]&&(l[p]=m)}for(var h,f=fa(r,c,o,l,i);f;)f=fa(r,c,o,l,i);return"dendrogram"===i.mode?(h=xa(r[0],i.dendrogramDepth,t),i.addDendrogram&&ja(r[0],t)):(h=new Array(r.length),r.forEach((function(e,a){e.key=e.index=null,h[a]=t.collection(e.value)}))),h},ya={hierarchicalClustering:va,hca:va},Oa=fe({distance:"euclidean",preference:"median",damping:.8,maxIterations:1e3,minIterations:100,attributes:[]}),Ea=function(e,t,a,i){var n=function(e,t){return i[t](e)};return-Zt(e,i.length,(function(e){return n(t,e)}),(function(e){return n(a,e)}),t,a)},wa=function(e,t){var a=null;return a="median"===t?function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.length,i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],n=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];arguments.length>3&&void 0!==arguments[3]&&!arguments[3]?(a<e.length&&e.splice(a,e.length-a),t>0&&e.splice(0,t)):e=e.slice(t,a);for(var s=0,r=e.length-1;r>=0;r--){var o=e[r];n?isFinite(o)||(e[r]=-1/0,s++):e.splice(r,1)}i&&e.sort((function(e,t){return e-t}));var l=e.length,c=Math.floor(l/2);return l%2!=0?e[c+1+s]:(e[c-1+s]+e[c+s])/2}(e):"mean"===t?function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.length,i=0,n=0,s=t;s<a;s++){var r=e[s];isFinite(r)&&(i+=r,n++)}return i/n}(e):"min"===t?function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.length,i=1/0,n=t;n<a;n++){var s=e[n];isFinite(s)&&(i=Math.min(s,i))}return i}(e):"max"===t?function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.length,i=-1/0,n=t;n<a;n++){var s=e[n];isFinite(s)&&(i=Math.max(s,i))}return i}(e):t,a},_a=function(e,t,a){for(var i=[],n=0;n<e;n++){for(var s=-1,r=-1/0,o=0;o<a.length;o++){var l=a[o];t[n*e+l]>r&&(s=l,r=t[n*e+l])}s>0&&i.push(s)}for(var c=0;c<a.length;c++)i[a[c]]=a[c];return i},Sa=function(e){for(var t,a,i,n,s,r,o=this.cy(),l=this.nodes(),c=function(e){var t=e.damping,a=e.preference;.5<=t&&t<1||ce("Damping must range on [0.5, 1).  Got: ".concat(t));var i=["median","mean","min","max"];return i.some((function(e){return e===a}))||O(a)||ce("Preference must be one of [".concat(i.map((function(e){return"'".concat(e,"'")})).join(", "),"] or a number.  Got: ").concat(a)),Oa(e)}(e),d={},u=0;u<l.length;u++)d[l[u].id()]=u;a=(t=l.length)*t,i=new Array(a);for(var p=0;p<a;p++)i[p]=-1/0;for(var m=0;m<t;m++)for(var b=0;b<t;b++)m!==b&&(i[m*t+b]=Ea(c.distance,l[m],l[b],c.attributes));n=wa(i,c.preference);for(var h=0;h<t;h++)i[h*t+h]=n;s=new Array(a);for(var f=0;f<a;f++)s[f]=0;r=new Array(a);for(var g=0;g<a;g++)r[g]=0;for(var j=new Array(t),x=new Array(t),v=new Array(t),y=0;y<t;y++)j[y]=0,x[y]=0,v[y]=0;for(var E,w=new Array(t*c.minIterations),_=0;_<w.length;_++)w[_]=0;for(E=0;E<c.maxIterations;E++){for(var S=0;S<t;S++){for(var M=-1/0,k=-1/0,C=-1,T=0,F=0;F<t;F++)j[F]=s[S*t+F],(T=r[S*t+F]+i[S*t+F])>=M?(k=M,M=T,C=F):T>k&&(k=T);for(var I=0;I<t;I++)s[S*t+I]=(1-c.damping)*(i[S*t+I]-M)+c.damping*j[I];s[S*t+C]=(1-c.damping)*(i[S*t+C]-k)+c.damping*j[C]}for(var D=0;D<t;D++){for(var A=0,L=0;L<t;L++)j[L]=r[L*t+D],x[L]=Math.max(0,s[L*t+D]),A+=x[L];A-=x[D],x[D]=s[D*t+D],A+=x[D];for(var R=0;R<t;R++)r[R*t+D]=(1-c.damping)*Math.min(0,A-x[R])+c.damping*j[R];r[D*t+D]=(1-c.damping)*(A-x[D])+c.damping*j[D]}for(var P=0,N=0;N<t;N++){var z=r[N*t+N]+s[N*t+N]>0?1:0;w[E%c.minIterations*t+N]=z,P+=z}if(P>0&&(E>=c.minIterations-1||E==c.maxIterations-1)){for(var B=0,J=0;J<t;J++){v[J]=0;for(var V=0;V<c.minIterations;V++)v[J]+=w[V*t+J];0!==v[J]&&v[J]!==c.minIterations||B++}if(B===t)break}}for(var U=function(e,t,a){for(var i=[],n=0;n<e;n++)t[n*e+n]+a[n*e+n]>0&&i.push(n);return i}(t,s,r),G=function(e,t,a){for(var i=_a(e,t,a),n=0;n<a.length;n++){for(var s=[],r=0;r<i.length;r++)i[r]===a[n]&&s.push(r);for(var o=-1,l=-1/0,c=0;c<s.length;c++){for(var d=0,u=0;u<s.length;u++)d+=t[s[u]*e+s[c]];d>l&&(o=c,l=d)}a[n]=s[o]}return _a(e,t,a)}(t,i,U),q={},H=0;H<U.length;H++)q[U[H]]=[];for(var W=0;W<l.length;W++){var $=G[d[l[W].id()]];null!=$&&q[$].push(l[W])}for(var Y=new Array(U.length),X=0;X<U.length;X++)Y[X]=o.collection(q[U[X]]);return Y},Ma={};[Se,ke,Ce,Fe,De,Le,ze,kt,Tt,It,At,Gt,ma,ya,{affinityPropagation:Sa,ap:Sa}].forEach((function(e){N(Ma,e)}));
/*!
Embeddable Minimum Strictly-Compliant Promises/A+ 1.1.1 Thenable
Copyright (c) 2013-2014 Ralf S. Engelschall (http://engelschall.com)
Licensed under The MIT License (http://opensource.org/licenses/MIT)
*/
var ka=function e(t){if(!(this instanceof e))return new e(t);this.id="Thenable/1.0.7",this.state=0,this.fulfillValue=void 0,this.rejectReason=void 0,this.onFulfilled=[],this.onRejected=[],this.proxy={then:this.then.bind(this)},"function"==typeof t&&t.call(this,this.fulfill.bind(this),this.reject.bind(this))};ka.prototype={fulfill:function(e){return Ca(this,1,"fulfillValue",e)},reject:function(e){return Ca(this,2,"rejectReason",e)},then:function(e,t){var a=this,i=new ka;return a.onFulfilled.push(Ia(e,i,"fulfill")),a.onRejected.push(Ia(t,i,"reject")),Ta(a),i.proxy}};var Ca=function(e,t,a,i){return 0===e.state&&(e.state=t,e[a]=i,Ta(e)),e},Ta=function(e){1===e.state?Fa(e,"onFulfilled",e.fulfillValue):2===e.state&&Fa(e,"onRejected",e.rejectReason)},Fa=function(e,a,i){if(0!==e[a].length){var n=e[a];e[a]=[];var s=function(){for(var e=0;e<n.length;e++)n[e](i)};"function"==typeof t?t(s):setTimeout(s,0)}},Ia=function(e,t,a){return function(i){if("function"!=typeof e)t[a].call(t,i);else{var n;try{n=e(i)}catch(e){return void t.reject(e)}Da(t,n)}}},Da=function e(t,a){if(t!==a&&t.proxy!==a){var i;if("object"===r(a)&&null!==a||"function"==typeof a)try{i=a.then}catch(e){return void t.reject(e)}if("function"!=typeof i)t.fulfill(a);else{var n=!1;try{i.call(a,(function(i){n||(n=!0,i===a?t.reject(new TypeError("circular thenable chain")):e(t,i))}),(function(e){n||(n=!0,t.reject(e))}))}catch(e){n||t.reject(e)}}}else t.reject(new TypeError("cannot resolve promise with itself"))};ka.all=function(e){return new ka((function(t,a){for(var i=new Array(e.length),n=0,s=function(a,s){i[a]=s,++n===e.length&&t(i)},r=0;r<e.length;r++)!function(t){var i=e[t];null!=i&&null!=i.then?i.then((function(e){s(t,e)}),(function(e){a(e)})):s(t,i)}(r)}))},ka.resolve=function(e){return new ka((function(t,a){t(e)}))},ka.reject=function(e){return new ka((function(t,a){a(e)}))};var Aa="undefined"!=typeof Promise?Promise:ka,La=function(e,t,a){var i=M(e),n=!i,s=this._private=N({duration:1e3},t,a);if(s.target=e,s.style=s.style||s.css,s.started=!1,s.playing=!1,s.hooked=!1,s.applying=!1,s.progress=0,s.completes=[],s.frames=[],s.complete&&x(s.complete)&&s.completes.push(s.complete),n){var r=e.position();s.startPosition=s.startPosition||{x:r.x,y:r.y},s.startStyle=s.startStyle||e.cy().style().getAnimationStartStyle(e,s.style)}if(i){var o=e.pan();s.startPan={x:o.x,y:o.y},s.startZoom=e.zoom()}this.length=1,this[0]=this},Ra=La.prototype;N(Ra,{instanceString:function(){return"animation"},hook:function(){var e=this._private;if(!e.hooked){var t=e.target._private.animation;(e.queue?t.queue:t.current).push(this),w(e.target)&&e.target.cy().addToAnimationPool(e.target),e.hooked=!0}return this},play:function(){var e=this._private;return 1===e.progress&&(e.progress=0),e.playing=!0,e.started=!1,e.stopped=!1,this.hook(),this},playing:function(){return this._private.playing},apply:function(){var e=this._private;return e.applying=!0,e.started=!1,e.stopped=!1,this.hook(),this},applying:function(){return this._private.applying},pause:function(){var e=this._private;return e.playing=!1,e.started=!1,this},stop:function(){var e=this._private;return e.playing=!1,e.started=!1,e.stopped=!0,this},rewind:function(){return this.progress(0)},fastforward:function(){return this.progress(1)},time:function(e){var t=this._private;return void 0===e?t.progress*t.duration:this.progress(e/t.duration)},progress:function(e){var t=this._private,a=t.playing;return void 0===e?t.progress:(a&&this.pause(),t.progress=e,t.started=!1,a&&this.play(),this)},completed:function(){return 1===this._private.progress},reverse:function(){var e=this._private,t=e.playing;t&&this.pause(),e.progress=1-e.progress,e.started=!1;var a=function(t,a){var i=e[t];null!=i&&(e[t]=e[a],e[a]=i)};if(a("zoom","startZoom"),a("pan","startPan"),a("position","startPosition"),e.style)for(var i=0;i<e.style.length;i++){var n=e.style[i],s=n.name,r=e.startStyle[s];e.startStyle[s]=n,e.style[i]=r}return t&&this.play(),this},promise:function(e){var t,a=this._private;if("frame"===e)t=a.frames;else t=a.completes;return new Aa((function(e,a){t.push((function(){e()}))}))}}),Ra.complete=Ra.completed,Ra.run=Ra.play,Ra.running=Ra.playing;var Pa={animated:function(){return function(){var e=this,t=void 0!==e.length?e:[e];if(!(this._private.cy||this).styleEnabled())return!1;var a=t[0];return a?a._private.animation.current.length>0:void 0}},clearQueue:function(){return function(){var e=this,t=void 0!==e.length?e:[e];if(!(this._private.cy||this).styleEnabled())return this;for(var a=0;a<t.length;a++){t[a]._private.animation.queue=[]}return this}},delay:function(){return function(e,t){return(this._private.cy||this).styleEnabled()?this.animate({delay:e,duration:e,complete:t}):this}},delayAnimation:function(){return function(e,t){return(this._private.cy||this).styleEnabled()?this.animation({delay:e,duration:e,complete:t}):this}},animation:function(){return function(e,t){var a=this,i=void 0!==a.length,n=i?a:[a],s=this._private.cy||this,r=!i,o=!r;if(!s.styleEnabled())return this;var l=s.style();if(e=N({},e,t),0===Object.keys(e).length)return new La(n[0],e);switch(void 0===e.duration&&(e.duration=400),e.duration){case"slow":e.duration=600;break;case"fast":e.duration=200}if(o&&(e.style=l.getPropsList(e.style||e.css),e.css=void 0),o&&null!=e.renderedPosition){var c=e.renderedPosition,d=s.pan(),u=s.zoom();e.position=Je(c,u,d)}if(r&&null!=e.panBy){var p=e.panBy,m=s.pan();e.pan={x:m.x+p.x,y:m.y+p.y}}var b=e.center||e.centre;if(r&&null!=b){var h=s.getCenterPan(b.eles,e.zoom);null!=h&&(e.pan=h)}if(r&&null!=e.fit){var f=e.fit,g=s.getFitViewport(f.eles||f.boundingBox,f.padding);null!=g&&(e.pan=g.pan,e.zoom=g.zoom)}if(r&&y(e.zoom)){var j=s.getZoomedViewport(e.zoom);null!=j&&(j.zoomed&&(e.zoom=j.zoom),j.panned&&(e.pan=j.pan))}return new La(n[0],e)}},animate:function(){return function(e,t){var a=this,i=void 0!==a.length?a:[a];if(!(this._private.cy||this).styleEnabled())return this;t&&(e=N({},e,t));for(var n=0;n<i.length;n++){var s=i[n],r=s.animated()&&(void 0===e.queue||e.queue);s.animation(e,r?{queue:!0}:void 0).play()}return this}},stop:function(){return function(e,t){var a=this,i=void 0!==a.length?a:[a],n=this._private.cy||this;if(!n.styleEnabled())return this;for(var s=0;s<i.length;s++){for(var r=i[s]._private,o=r.animation.current,l=0;l<o.length;l++){var c=o[l]._private;t&&(c.duration=0)}e&&(r.animation.queue=[]),t||(r.animation.current=[])}return n.notify("draw"),this}}},Na={data:function(e){return e=N({},{field:"data",bindingEvent:"data",allowBinding:!1,allowSetting:!1,allowGetting:!1,settingEvent:"data",settingTriggersEvent:!1,triggerFnName:"trigger",immutableKeys:{},updateStyle:!1,beforeGet:function(e){},beforeSet:function(e,t){},onSet:function(e){},canSet:function(e){return!0}},e),function(t,a){var i=e,n=this,s=void 0!==n.length,r=s?n:[n],o=s?n[0]:n;if(j(t)){var l;if(i.allowGetting&&void 0===a)return o&&(i.beforeGet(o),l=o._private[i.field][t]),l;if(i.allowSetting&&void 0!==a&&!i.immutableKeys[t]){var c=function(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}({},t,a);i.beforeSet(n,c);for(var d=0,u=r.length;d<u;d++){var p=r[d];i.canSet(p)&&(p._private[i.field][t]=a)}i.updateStyle&&n.updateStyle(),i.onSet(n),i.settingTriggersEvent&&n[i.triggerFnName](i.settingEvent)}}else if(i.allowSetting&&y(t)){var m,b,h=t,f=Object.keys(h);i.beforeSet(n,h);for(var g=0;g<f.length;g++){if(b=h[m=f[g]],!i.immutableKeys[m])for(var v=0;v<r.length;v++){var O=r[v];i.canSet(O)&&(O._private[i.field][m]=b)}}i.updateStyle&&n.updateStyle(),i.onSet(n),i.settingTriggersEvent&&n[i.triggerFnName](i.settingEvent)}else if(i.allowBinding&&x(t)){var E=t;n.on(i.bindingEvent,E)}else if(i.allowGetting&&void 0===t){var w;return o&&(i.beforeGet(o),w=o._private[i.field]),w}return n}},removeData:function(e){return e=N({},{field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!1,immutableKeys:{}},e),function(t){var a=e,i=this,n=void 0!==i.length?i:[i];if(j(t)){for(var s=t.split(/\s+/),r=s.length,o=0;o<r;o++){var l=s[o];if(!C(l))if(!a.immutableKeys[l])for(var c=0,d=n.length;c<d;c++)n[c]._private[a.field][l]=void 0}a.triggerEvent&&i[a.triggerFnName](a.event)}else if(void 0===t){for(var u=0,p=n.length;u<p;u++)for(var m=n[u]._private[a.field],b=Object.keys(m),h=0;h<b.length;h++){var f=b[h];!a.immutableKeys[f]&&(m[f]=void 0)}a.triggerEvent&&i[a.triggerFnName](a.event)}return i}}},za={eventAliasesOn:function(e){var t=e;t.addListener=t.listen=t.bind=t.on,t.unlisten=t.unbind=t.off=t.removeListener,t.trigger=t.emit,t.pon=t.promiseOn=function(e,t){var a=this,i=Array.prototype.slice.call(arguments,0);return new Aa((function(e,t){var n=i.concat([function(t){a.off.apply(a,s),e(t)}]),s=n.concat([]);a.on.apply(a,n)}))}}},Ba={};[Pa,Na,za].forEach((function(e){N(Ba,e)}));var Ja={animate:Ba.animate(),animation:Ba.animation(),animated:Ba.animated(),clearQueue:Ba.clearQueue(),delay:Ba.delay(),delayAnimation:Ba.delayAnimation(),stop:Ba.stop()},Va={classes:function(e){var t=this;if(void 0===e){var a=[];return t[0]._private.classes.forEach((function(e){return a.push(e)})),a}v(e)||(e=(e||"").match(/\S+/g)||[]);for(var i=[],n=new Ee(e),s=0;s<t.length;s++){for(var r=t[s],o=r._private,l=o.classes,c=!1,d=0;d<e.length;d++){var u=e[d];if(!l.has(u)){c=!0;break}}c||(c=l.size!==e.length),c&&(o.classes=n,i.push(r))}return i.length>0&&this.spawn(i).updateStyle().emit("class"),t},addClass:function(e){return this.toggleClass(e,!0)},hasClass:function(e){var t=this[0];return null!=t&&t._private.classes.has(e)},toggleClass:function(e,t){v(e)||(e=e.match(/\S+/g)||[]);for(var a=this,i=void 0===t,n=[],s=0,r=a.length;s<r;s++)for(var o=a[s],l=o._private.classes,c=!1,d=0;d<e.length;d++){var u=e[d],p=l.has(u),m=!1;t||i&&!p?(l.add(u),m=!0):(!t||i&&p)&&(l.delete(u),m=!0),!c&&m&&(n.push(o),c=!0)}return n.length>0&&this.spawn(n).updateStyle().emit("class"),a},removeClass:function(e){return this.toggleClass(e,!1)},flashClass:function(e,t){var a=this;if(null==t)t=250;else if(0===t)return a;return a.addClass(e),setTimeout((function(){a.removeClass(e)}),t),a}};Va.className=Va.classNames=Va.classes;var Ua={metaChar:"[\\!\\\"\\#\\$\\%\\&\\'\\(\\)\\*\\+\\,\\.\\/\\:\\;\\<\\=\\>\\?\\@\\[\\]\\^\\`\\{\\|\\}\\~]",comparatorOp:"=|\\!=|>|>=|<|<=|\\$=|\\^=|\\*=",boolOp:"\\?|\\!|\\^",string:"\"(?:\\\\\"|[^\"])*\"|'(?:\\\\'|[^'])*'",number:R,meta:"degree|indegree|outdegree",separator:"\\s*,\\s*",descendant:"\\s+",child:"\\s+>\\s+",subject:"\\$",group:"node|edge|\\*",directedEdge:"\\s+->\\s+",undirectedEdge:"\\s+<->\\s+"};Ua.variable="(?:[\\w-]|(?:\\\\"+Ua.metaChar+"))+",Ua.value=Ua.string+"|"+Ua.number,Ua.className=Ua.variable,Ua.id=Ua.variable,function(){var e,t,a;for(e=Ua.comparatorOp.split("|"),a=0;a<e.length;a++)t=e[a],Ua.comparatorOp+="|@"+t;for(e=Ua.comparatorOp.split("|"),a=0;a<e.length;a++)(t=e[a]).indexOf("!")>=0||"="!==t&&(Ua.comparatorOp+="|\\!"+t)}();var Ga=0,qa=1,Ha=2,Wa=3,$a=4,Ya=5,Xa=6,Qa=7,Ka=8,Za=9,ei=10,ti=11,ai=12,ii=13,ni=14,si=15,ri=16,oi=17,li=18,ci=19,di=20,ui=[{selector:":selected",matches:function(e){return e.selected()}},{selector:":unselected",matches:function(e){return!e.selected()}},{selector:":selectable",matches:function(e){return e.selectable()}},{selector:":unselectable",matches:function(e){return!e.selectable()}},{selector:":locked",matches:function(e){return e.locked()}},{selector:":unlocked",matches:function(e){return!e.locked()}},{selector:":visible",matches:function(e){return e.visible()}},{selector:":hidden",matches:function(e){return!e.visible()}},{selector:":transparent",matches:function(e){return e.transparent()}},{selector:":grabbed",matches:function(e){return e.grabbed()}},{selector:":free",matches:function(e){return!e.grabbed()}},{selector:":removed",matches:function(e){return e.removed()}},{selector:":inside",matches:function(e){return!e.removed()}},{selector:":grabbable",matches:function(e){return e.grabbable()}},{selector:":ungrabbable",matches:function(e){return!e.grabbable()}},{selector:":animated",matches:function(e){return e.animated()}},{selector:":unanimated",matches:function(e){return!e.animated()}},{selector:":parent",matches:function(e){return e.isParent()}},{selector:":childless",matches:function(e){return e.isChildless()}},{selector:":child",matches:function(e){return e.isChild()}},{selector:":orphan",matches:function(e){return e.isOrphan()}},{selector:":nonorphan",matches:function(e){return e.isChild()}},{selector:":compound",matches:function(e){return e.isNode()?e.isParent():e.source().isParent()||e.target().isParent()}},{selector:":loop",matches:function(e){return e.isLoop()}},{selector:":simple",matches:function(e){return e.isSimple()}},{selector:":active",matches:function(e){return e.active()}},{selector:":inactive",matches:function(e){return!e.active()}},{selector:":backgrounding",matches:function(e){return e.backgrounding()}},{selector:":nonbackgrounding",matches:function(e){return!e.backgrounding()}}].sort((function(e,t){return function(e,t){return-1*P(e,t)}(e.selector,t.selector)})),pi=function(){for(var e,t={},a=0;a<ui.length;a++)t[(e=ui[a]).selector]=e.matches;return t}(),mi="("+ui.map((function(e){return e.selector})).join("|")+")",bi=function(e){return e.replace(new RegExp("\\\\("+Ua.metaChar+")","g"),(function(e,t){return t}))},hi=function(e,t,a){e[e.length-1]=a},fi=[{name:"group",query:!0,regex:"("+Ua.group+")",populate:function(e,t,a){var i=d(a,1)[0];t.checks.push({type:Ga,value:"*"===i?i:i+"s"})}},{name:"state",query:!0,regex:mi,populate:function(e,t,a){var i=d(a,1)[0];t.checks.push({type:Qa,value:i})}},{name:"id",query:!0,regex:"\\#("+Ua.id+")",populate:function(e,t,a){var i=d(a,1)[0];t.checks.push({type:Ka,value:bi(i)})}},{name:"className",query:!0,regex:"\\.("+Ua.className+")",populate:function(e,t,a){var i=d(a,1)[0];t.checks.push({type:Za,value:bi(i)})}},{name:"dataExists",query:!0,regex:"\\[\\s*("+Ua.variable+")\\s*\\]",populate:function(e,t,a){var i=d(a,1)[0];t.checks.push({type:$a,field:bi(i)})}},{name:"dataCompare",query:!0,regex:"\\[\\s*("+Ua.variable+")\\s*("+Ua.comparatorOp+")\\s*("+Ua.value+")\\s*\\]",populate:function(e,t,a){var i=d(a,3),n=i[0],s=i[1],r=i[2];r=null!=new RegExp("^"+Ua.string+"$").exec(r)?r.substring(1,r.length-1):parseFloat(r),t.checks.push({type:Wa,field:bi(n),operator:s,value:r})}},{name:"dataBool",query:!0,regex:"\\[\\s*("+Ua.boolOp+")\\s*("+Ua.variable+")\\s*\\]",populate:function(e,t,a){var i=d(a,2),n=i[0],s=i[1];t.checks.push({type:Ya,field:bi(s),operator:n})}},{name:"metaCompare",query:!0,regex:"\\[\\[\\s*("+Ua.meta+")\\s*("+Ua.comparatorOp+")\\s*("+Ua.number+")\\s*\\]\\]",populate:function(e,t,a){var i=d(a,3),n=i[0],s=i[1],r=i[2];t.checks.push({type:Xa,field:bi(n),operator:s,value:parseFloat(r)})}},{name:"nextQuery",separator:!0,regex:Ua.separator,populate:function(e,t){var a=e.currentSubject,i=e.edgeCount,n=e.compoundCount,s=e[e.length-1];return null!=a&&(s.subject=a,e.currentSubject=null),s.edgeCount=i,s.compoundCount=n,e.edgeCount=0,e.compoundCount=0,e[e.length++]={checks:[]}}},{name:"directedEdge",separator:!0,regex:Ua.directedEdge,populate:function(e,t){if(null==e.currentSubject){var a={checks:[]},i=t,n={checks:[]};return a.checks.push({type:ti,source:i,target:n}),hi(e,0,a),e.edgeCount++,n}var s={checks:[]},r=t,o={checks:[]};return s.checks.push({type:ai,source:r,target:o}),hi(e,0,s),e.edgeCount++,o}},{name:"undirectedEdge",separator:!0,regex:Ua.undirectedEdge,populate:function(e,t){if(null==e.currentSubject){var a={checks:[]},i=t,n={checks:[]};return a.checks.push({type:ei,nodes:[i,n]}),hi(e,0,a),e.edgeCount++,n}var s={checks:[]},r=t,o={checks:[]};return s.checks.push({type:ni,node:r,neighbor:o}),hi(e,0,s),o}},{name:"child",separator:!0,regex:Ua.child,populate:function(e,t){if(null==e.currentSubject){var a={checks:[]},i={checks:[]},n=e[e.length-1];return a.checks.push({type:si,parent:n,child:i}),hi(e,0,a),e.compoundCount++,i}if(e.currentSubject===t){var s={checks:[]},r=e[e.length-1],o={checks:[]},l={checks:[]},c={checks:[]},d={checks:[]};return s.checks.push({type:ci,left:r,right:o,subject:l}),l.checks=t.checks,t.checks=[{type:di}],d.checks.push({type:di}),o.checks.push({type:oi,parent:d,child:c}),hi(e,0,s),e.currentSubject=l,e.compoundCount++,c}var u={checks:[]},p={checks:[]},m=[{type:oi,parent:u,child:p}];return u.checks=t.checks,t.checks=m,e.compoundCount++,p}},{name:"descendant",separator:!0,regex:Ua.descendant,populate:function(e,t){if(null==e.currentSubject){var a={checks:[]},i={checks:[]},n=e[e.length-1];return a.checks.push({type:ri,ancestor:n,descendant:i}),hi(e,0,a),e.compoundCount++,i}if(e.currentSubject===t){var s={checks:[]},r=e[e.length-1],o={checks:[]},l={checks:[]},c={checks:[]},d={checks:[]};return s.checks.push({type:ci,left:r,right:o,subject:l}),l.checks=t.checks,t.checks=[{type:di}],d.checks.push({type:di}),o.checks.push({type:li,ancestor:d,descendant:c}),hi(e,0,s),e.currentSubject=l,e.compoundCount++,c}var u={checks:[]},p={checks:[]},m=[{type:li,ancestor:u,descendant:p}];return u.checks=t.checks,t.checks=m,e.compoundCount++,p}},{name:"subject",modifier:!0,regex:Ua.subject,populate:function(e,t){if(null!=e.currentSubject&&e.currentSubject!==t)return ue("Redefinition of subject in selector `"+e.toString()+"`"),!1;e.currentSubject=t;var a=e[e.length-1].checks[0],i=null==a?null:a.type;i===ti?a.type=ii:i===ei&&(a.type=ni,a.node=a.nodes[1],a.neighbor=a.nodes[0],a.nodes=null)}}];fi.forEach((function(e){return e.regexObj=new RegExp("^"+e.regex)}));var gi=function(e){for(var t,a,i,n=0;n<fi.length;n++){var s=fi[n],r=s.name,o=e.match(s.regexObj);if(null!=o){a=o,t=s,i=r;var l=o[0];e=e.substring(l.length);break}}return{expr:t,match:a,name:i,remaining:e}},ji={parse:function(e){var t=this,a=t.inputText=e,i=t[0]={checks:[]};for(t.length=1,a=function(e){var t=e.match(/^\s+/);if(t){var a=t[0];e=e.substring(a.length)}return e}(a);;){var n=gi(a);if(null==n.expr)return ue("The selector `"+e+"`is invalid"),!1;var s=n.match.slice(1),r=n.expr.populate(t,i,s);if(!1===r)return!1;if(null!=r&&(i=r),(a=n.remaining).match(/^\s*$/))break}var o=t[t.length-1];null!=t.currentSubject&&(o.subject=t.currentSubject),o.edgeCount=t.edgeCount,o.compoundCount=t.compoundCount;for(var l=0;l<t.length;l++){var c=t[l];if(c.compoundCount>0&&c.edgeCount>0)return ue("The selector `"+e+"` is invalid because it uses both a compound selector and an edge selector"),!1;if(c.edgeCount>1)return ue("The selector `"+e+"` is invalid because it uses multiple edge selectors"),!1;1===c.edgeCount&&ue("The selector `"+e+"` is deprecated.  Edge selectors do not take effect on changes to source and target nodes after an edge is added, for performance reasons.  Use a class or data selector on edges instead, updating the class or data of an edge when your app detects a change in source or target nodes.")}return!0},toString:function(){if(null!=this.toStringCache)return this.toStringCache;for(var e=function(e){return null==e?"":e},t=function(t){return j(t)?'"'+t+'"':e(t)},a=function(e){return" "+e+" "},i=function(i,s){var r=i.type,o=i.value;switch(r){case Ga:var l=e(o);return l.substring(0,l.length-1);case Wa:var c=i.field,d=i.operator;return"["+c+a(e(d))+t(o)+"]";case Ya:var u=i.operator,p=i.field;return"["+e(u)+p+"]";case $a:return"["+i.field+"]";case Xa:var m=i.operator;return"[["+i.field+a(e(m))+t(o)+"]]";case Qa:return o;case Ka:return"#"+o;case Za:return"."+o;case oi:case si:return n(i.parent,s)+a(">")+n(i.child,s);case li:case ri:return n(i.ancestor,s)+" "+n(i.descendant,s);case ci:var b=n(i.left,s),h=n(i.subject,s),f=n(i.right,s);return b+(b.length>0?" ":"")+h+f;case di:return""}},n=function(e,t){return e.checks.reduce((function(a,n,s){return a+(t===e&&0===s?"$":"")+i(n,t)}),"")},s="",r=0;r<this.length;r++){var o=this[r];s+=n(o,o.subject),this.length>1&&r<this.length-1&&(s+=", ")}return this.toStringCache=s,s}},xi=function(e,t,a){var i,n,s,r=j(e),o=O(e),l=j(a),c=!1,d=!1,u=!1;switch(t.indexOf("!")>=0&&(t=t.replace("!",""),d=!0),t.indexOf("@")>=0&&(t=t.replace("@",""),c=!0),(r||l||c)&&(n=r||o?""+e:"",s=""+a),c&&(e=n=n.toLowerCase(),a=s=s.toLowerCase()),t){case"*=":i=n.indexOf(s)>=0;break;case"$=":i=n.indexOf(s,n.length-s.length)>=0;break;case"^=":i=0===n.indexOf(s);break;case"=":i=e===a;break;case">":u=!0,i=e>a;break;case">=":u=!0,i=e>=a;break;case"<":u=!0,i=e<a;break;case"<=":u=!0,i=e<=a;break;default:i=!1}return!d||null==e&&u||(i=!i),i},vi=function(e,t){return e.data(t)},yi=[],Oi=function(e,t){return e.checks.every((function(e){return yi[e.type](e,t)}))};yi[Ga]=function(e,t){var a=e.value;return"*"===a||a===t.group()},yi[Qa]=function(e,t){return function(e,t){return pi[e](t)}(e.value,t)},yi[Ka]=function(e,t){var a=e.value;return t.id()===a},yi[Za]=function(e,t){var a=e.value;return t.hasClass(a)},yi[Xa]=function(e,t){var a=e.field,i=e.operator,n=e.value;return xi(function(e,t){return e[t]()}(t,a),i,n)},yi[Wa]=function(e,t){var a=e.field,i=e.operator,n=e.value;return xi(vi(t,a),i,n)},yi[Ya]=function(e,t){var a=e.field,i=e.operator;return function(e,t){switch(t){case"?":return!!e;case"!":return!e;case"^":return void 0===e}}(vi(t,a),i)},yi[$a]=function(e,t){var a=e.field;e.operator;return void 0!==vi(t,a)},yi[ei]=function(e,t){var a=e.nodes[0],i=e.nodes[1],n=t.source(),s=t.target();return Oi(a,n)&&Oi(i,s)||Oi(i,n)&&Oi(a,s)},yi[ni]=function(e,t){return Oi(e.node,t)&&t.neighborhood().some((function(t){return t.isNode()&&Oi(e.neighbor,t)}))},yi[ti]=function(e,t){return Oi(e.source,t.source())&&Oi(e.target,t.target())},yi[ai]=function(e,t){return Oi(e.source,t)&&t.outgoers().some((function(t){return t.isNode()&&Oi(e.target,t)}))},yi[ii]=function(e,t){return Oi(e.target,t)&&t.incomers().some((function(t){return t.isNode()&&Oi(e.source,t)}))},yi[si]=function(e,t){return Oi(e.child,t)&&Oi(e.parent,t.parent())},yi[oi]=function(e,t){return Oi(e.parent,t)&&t.children().some((function(t){return Oi(e.child,t)}))},yi[ri]=function(e,t){return Oi(e.descendant,t)&&t.ancestors().some((function(t){return Oi(e.ancestor,t)}))},yi[li]=function(e,t){return Oi(e.ancestor,t)&&t.descendants().some((function(t){return Oi(e.descendant,t)}))},yi[ci]=function(e,t){return Oi(e.subject,t)&&Oi(e.left,t)&&Oi(e.right,t)},yi[di]=function(){return!0},yi[qa]=function(e,t){return e.value.has(t)},yi[Ha]=function(e,t){return(0,e.value)(t)};var Ei={matches:function(e){for(var t=0;t<this.length;t++){var a=this[t];if(Oi(a,e))return!0}return!1},filter:function(e){var t=this;if(1===t.length&&1===t[0].checks.length&&t[0].checks[0].type===Ka)return e.getElementById(t[0].checks[0].value).collection();var a=function(e){for(var a=0;a<t.length;a++){var i=t[a];if(Oi(i,e))return!0}return!1};return null==t.text()&&(a=function(){return!0}),e.filter(a)}},wi=function(e){this.inputText=e,this.currentSubject=null,this.compoundCount=0,this.edgeCount=0,this.length=0,null==e||j(e)&&e.match(/^\s*$/)||(w(e)?this.addQuery({checks:[{type:qa,value:e.collection()}]}):x(e)?this.addQuery({checks:[{type:Ha,value:e}]}):j(e)?this.parse(e)||(this.invalid=!0):ce("A selector must be created from a string; found "))},_i=wi.prototype;[ji,Ei].forEach((function(e){return N(_i,e)})),_i.text=function(){return this.inputText},_i.size=function(){return this.length},_i.eq=function(e){return this[e]},_i.sameText=function(e){return!this.invalid&&!e.invalid&&this.text()===e.text()},_i.addQuery=function(e){this[this.length++]=e},_i.selector=_i.toString;var Si={allAre:function(e){var t=new wi(e);return this.every((function(e){return t.matches(e)}))},is:function(e){var t=new wi(e);return this.some((function(e){return t.matches(e)}))},some:function(e,t){for(var a=0;a<this.length;a++){if(t?e.apply(t,[this[a],a,this]):e(this[a],a,this))return!0}return!1},every:function(e,t){for(var a=0;a<this.length;a++){if(!(t?e.apply(t,[this[a],a,this]):e(this[a],a,this)))return!1}return!0},same:function(e){if(this===e)return!0;e=this.cy().collection(e);var t=this.length;return t===e.length&&(1===t?this[0]===e[0]:this.every((function(t){return e.hasElementWithId(t.id())})))},anySame:function(e){return e=this.cy().collection(e),this.some((function(t){return e.hasElementWithId(t.id())}))},allAreNeighbors:function(e){e=this.cy().collection(e);var t=this.neighborhood();return e.every((function(e){return t.hasElementWithId(e.id())}))},contains:function(e){e=this.cy().collection(e);var t=this;return e.every((function(e){return t.hasElementWithId(e.id())}))}};Si.allAreNeighbours=Si.allAreNeighbors,Si.has=Si.contains,Si.equal=Si.equals=Si.same;var Mi,ki,Ci=function(e,t){return function(a,i,n,s){var r,o=a,l=this;if(null==o?r="":w(o)&&1===o.length&&(r=o.id()),1===l.length&&r){var c=l[0]._private,d=c.traversalCache=c.traversalCache||{},u=d[t]=d[t]||[],p=K(r),m=u[p];return m||(u[p]=e.call(l,a,i,n,s))}return e.call(l,a,i,n,s)}},Ti={parent:function(e){var t=[];if(1===this.length){var a=this[0]._private.parent;if(a)return a}for(var i=0;i<this.length;i++){var n=this[i]._private.parent;n&&t.push(n)}return this.spawn(t,{unique:!0}).filter(e)},parents:function(e){for(var t=[],a=this.parent();a.nonempty();){for(var i=0;i<a.length;i++){var n=a[i];t.push(n)}a=a.parent()}return this.spawn(t,{unique:!0}).filter(e)},commonAncestors:function(e){for(var t,a=0;a<this.length;a++){var i=this[a].parents();t=(t=t||i).intersect(i)}return t.filter(e)},orphans:function(e){return this.stdFilter((function(e){return e.isOrphan()})).filter(e)},nonorphans:function(e){return this.stdFilter((function(e){return e.isChild()})).filter(e)},children:Ci((function(e){for(var t=[],a=0;a<this.length;a++)for(var i=this[a]._private.children,n=0;n<i.length;n++)t.push(i[n]);return this.spawn(t,{unique:!0}).filter(e)}),"children"),siblings:function(e){return this.parent().children().not(this).filter(e)},isParent:function(){var e=this[0];if(e)return e.isNode()&&0!==e._private.children.length},isChildless:function(){var e=this[0];if(e)return e.isNode()&&0===e._private.children.length},isChild:function(){var e=this[0];if(e)return e.isNode()&&null!=e._private.parent},isOrphan:function(){var e=this[0];if(e)return e.isNode()&&null==e._private.parent},descendants:function(e){var t=[];return function e(a){for(var i=0;i<a.length;i++){var n=a[i];t.push(n),n.children().nonempty()&&e(n.children())}}(this.children()),this.spawn(t,{unique:!0}).filter(e)}};function Fi(e,t,a,i){for(var n=[],s=new Ee,r=e.cy().hasCompoundNodes(),o=0;o<e.length;o++){var l=e[o];a?n.push(l):r&&i(n,s,l)}for(;n.length>0;){var c=n.shift();t(c),s.add(c.id()),r&&i(n,s,c)}return e}function Ii(e,t,a){if(a.isParent())for(var i=a._private.children,n=0;n<i.length;n++){var s=i[n];t.has(s.id())||e.push(s)}}function Di(e,t,a){if(a.isChild()){var i=a._private.parent;t.has(i.id())||e.push(i)}}function Ai(e,t,a){Di(e,t,a),Ii(e,t,a)}Ti.forEachDown=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return Fi(this,e,t,Ii)},Ti.forEachUp=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return Fi(this,e,t,Di)},Ti.forEachUpAndDown=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return Fi(this,e,t,Ai)},Ti.ancestors=Ti.parents,(Mi=ki={data:Ba.data({field:"data",bindingEvent:"data",allowBinding:!0,allowSetting:!0,settingEvent:"data",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,immutableKeys:{id:!0,source:!0,target:!0,parent:!0},updateStyle:!0}),removeData:Ba.removeData({field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!0,immutableKeys:{id:!0,source:!0,target:!0,parent:!0},updateStyle:!0}),scratch:Ba.data({field:"scratch",bindingEvent:"scratch",allowBinding:!0,allowSetting:!0,settingEvent:"scratch",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,updateStyle:!0}),removeScratch:Ba.removeData({field:"scratch",event:"scratch",triggerFnName:"trigger",triggerEvent:!0,updateStyle:!0}),rscratch:Ba.data({field:"rscratch",allowBinding:!1,allowSetting:!0,settingTriggersEvent:!1,allowGetting:!0}),removeRscratch:Ba.removeData({field:"rscratch",triggerEvent:!1}),id:function(){var e=this[0];if(e)return e._private.data.id}}).attr=Mi.data,Mi.removeAttr=Mi.removeData;var Li,Ri,Pi=ki,Ni={};function zi(e){return function(t){var a=this;if(void 0===t&&(t=!0),0!==a.length&&a.isNode()&&!a.removed()){for(var i=0,n=a[0],s=n._private.edges,r=0;r<s.length;r++){var o=s[r];!t&&o.isLoop()||(i+=e(n,o))}return i}}}function Bi(e,t){return function(a){for(var i,n=this.nodes(),s=0;s<n.length;s++){var r=n[s][e](a);void 0===r||void 0!==i&&!t(r,i)||(i=r)}return i}}N(Ni,{degree:zi((function(e,t){return t.source().same(t.target())?2:1})),indegree:zi((function(e,t){return t.target().same(e)?1:0})),outdegree:zi((function(e,t){return t.source().same(e)?1:0}))}),N(Ni,{minDegree:Bi("degree",(function(e,t){return e<t})),maxDegree:Bi("degree",(function(e,t){return e>t})),minIndegree:Bi("indegree",(function(e,t){return e<t})),maxIndegree:Bi("indegree",(function(e,t){return e>t})),minOutdegree:Bi("outdegree",(function(e,t){return e<t})),maxOutdegree:Bi("outdegree",(function(e,t){return e>t}))}),N(Ni,{totalDegree:function(e){for(var t=0,a=this.nodes(),i=0;i<a.length;i++)t+=a[i].degree(e);return t}});var Ji=function(e,t,a){for(var i=0;i<e.length;i++){var n=e[i];if(!n.locked()){var s=n._private.position,r={x:null!=t.x?t.x-s.x:0,y:null!=t.y?t.y-s.y:0};!n.isParent()||0===r.x&&0===r.y||n.children().shift(r,a),n.shiftCachedBoundingBox(r)}}},Vi={field:"position",bindingEvent:"position",allowBinding:!0,allowSetting:!0,settingEvent:"position",settingTriggersEvent:!0,triggerFnName:"emitAndNotify",allowGetting:!0,validKeys:["x","y"],beforeGet:function(e){e.updateCompoundBounds()},beforeSet:function(e,t){Ji(e,t,!1)},onSet:function(e){e.dirtyCompoundBoundsCache()},canSet:function(e){return!e.locked()}};Li=Ri={position:Ba.data(Vi),silentPosition:Ba.data(N({},Vi,{allowBinding:!1,allowSetting:!0,settingTriggersEvent:!1,allowGetting:!1,beforeSet:function(e,t){Ji(e,t,!0)}})),positions:function(e,t){if(y(e))t?this.silentPosition(e):this.position(e);else if(x(e)){var a=e,i=this.cy();i.startBatch();for(var n=0;n<this.length;n++){var s,r=this[n];(s=a(r,n))&&(t?r.silentPosition(s):r.position(s))}i.endBatch()}return this},silentPositions:function(e){return this.positions(e,!0)},shift:function(e,t,a){var i;if(y(e)?(i={x:O(e.x)?e.x:0,y:O(e.y)?e.y:0},a=t):j(e)&&O(t)&&((i={x:0,y:0})[e]=t),null!=i){var n=this.cy();n.startBatch();for(var s=0;s<this.length;s++){var r=this[s],o=r.position(),l={x:o.x+i.x,y:o.y+i.y};a?r.silentPosition(l):r.position(l)}n.endBatch()}return this},silentShift:function(e,t){return y(e)?this.shift(e,!0):j(e)&&O(t)&&this.shift(e,t,!0),this},renderedPosition:function(e,t){var a=this[0],i=this.cy(),n=i.zoom(),s=i.pan(),r=y(e)?e:void 0,o=void 0!==r||void 0!==t&&j(e);if(a&&a.isNode()){if(!o){var l=a.position();return r=Be(l,n,s),void 0===e?r:r[e]}for(var c=0;c<this.length;c++){var d=this[c];void 0!==t?d.position(e,(t-s[e])/n):void 0!==r&&d.position(Je(r,n,s))}}else if(!o)return;return this},relativePosition:function(e,t){var a=this[0],i=this.cy(),n=y(e)?e:void 0,s=void 0!==n||void 0!==t&&j(e),r=i.hasCompoundNodes();if(a&&a.isNode()){if(!s){var o=a.position(),l=r?a.parent():null,c=l&&l.length>0,d=c;c&&(l=l[0]);var u=d?l.position():{x:0,y:0};return n={x:o.x-u.x,y:o.y-u.y},void 0===e?n:n[e]}for(var p=0;p<this.length;p++){var m=this[p],b=r?m.parent():null,h=b&&b.length>0,f=h;h&&(b=b[0]);var g=f?b.position():{x:0,y:0};void 0!==t?m.position(e,t+g[e]):void 0!==n&&m.position({x:n.x+g.x,y:n.y+g.y})}}else if(!s)return;return this}},Li.modelPosition=Li.point=Li.position,Li.modelPositions=Li.points=Li.positions,Li.renderedPoint=Li.renderedPosition,Li.relativePoint=Li.relativePosition;var Ui,Gi,qi=Ri;Ui=Gi={},Gi.renderedBoundingBox=function(e){var t=this.boundingBox(e),a=this.cy(),i=a.zoom(),n=a.pan(),s=t.x1*i+n.x,r=t.x2*i+n.x,o=t.y1*i+n.y,l=t.y2*i+n.y;return{x1:s,x2:r,y1:o,y2:l,w:r-s,h:l-o}},Gi.dirtyCompoundBoundsCache=function(){var e=this.cy();return e.styleEnabled()&&e.hasCompoundNodes()?(this.forEachUp((function(e){if(e.isParent()){var t=e._private;t.compoundBoundsClean=!1,t.bbCache=null,e.emitAndNotify("bounds")}})),this):this},Gi.updateCompoundBounds=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.cy();if(!t.styleEnabled()||!t.hasCompoundNodes())return this;if(!e&&t.batching())return this;function a(e){if(e.isParent()){var t=e._private,a=e.children(),i="include"===e.pstyle("compound-sizing-wrt-labels").value,n={width:{val:e.pstyle("min-width").pfValue,left:e.pstyle("min-width-bias-left"),right:e.pstyle("min-width-bias-right")},height:{val:e.pstyle("min-height").pfValue,top:e.pstyle("min-height-bias-top"),bottom:e.pstyle("min-height-bias-bottom")}},s=a.boundingBox({includeLabels:i,includeOverlays:!1,useCache:!1}),r=t.position;0!==s.w&&0!==s.h||((s={w:e.pstyle("width").pfValue,h:e.pstyle("height").pfValue}).x1=r.x-s.w/2,s.x2=r.x+s.w/2,s.y1=r.y-s.h/2,s.y2=r.y+s.h/2);var o=n.width.left.value;"px"===n.width.left.units&&n.width.val>0&&(o=100*o/n.width.val);var l=n.width.right.value;"px"===n.width.right.units&&n.width.val>0&&(l=100*l/n.width.val);var c=n.height.top.value;"px"===n.height.top.units&&n.height.val>0&&(c=100*c/n.height.val);var d=n.height.bottom.value;"px"===n.height.bottom.units&&n.height.val>0&&(d=100*d/n.height.val);var u=g(n.width.val-s.w,o,l),p=u.biasDiff,m=u.biasComplementDiff,b=g(n.height.val-s.h,c,d),h=b.biasDiff,f=b.biasComplementDiff;t.autoPadding=function(e,t,a,i){if("%"!==a.units)return"px"===a.units?a.pfValue:0;switch(i){case"width":return e>0?a.pfValue*e:0;case"height":return t>0?a.pfValue*t:0;case"average":return e>0&&t>0?a.pfValue*(e+t)/2:0;case"min":return e>0&&t>0?e>t?a.pfValue*t:a.pfValue*e:0;case"max":return e>0&&t>0?e>t?a.pfValue*e:a.pfValue*t:0;default:return 0}}(s.w,s.h,e.pstyle("padding"),e.pstyle("padding-relative-to").value),t.autoWidth=Math.max(s.w,n.width.val),r.x=(-p+s.x1+s.x2+m)/2,t.autoHeight=Math.max(s.h,n.height.val),r.y=(-h+s.y1+s.y2+f)/2}function g(e,t,a){var i=0,n=0,s=t+a;return e>0&&s>0&&(i=t/s*e,n=a/s*e),{biasDiff:i,biasComplementDiff:n}}}for(var i=0;i<this.length;i++){var n=this[i],s=n._private;s.compoundBoundsClean||(a(n),t.batching()||(s.compoundBoundsClean=!0))}return this};var Hi=function(e){return e===1/0||e===-1/0?0:e},Wi=function(e,t,a,i,n){i-t!=0&&n-a!=0&&null!=t&&null!=a&&null!=i&&null!=n&&(e.x1=t<e.x1?t:e.x1,e.x2=i>e.x2?i:e.x2,e.y1=a<e.y1?a:e.y1,e.y2=n>e.y2?n:e.y2,e.w=e.x2-e.x1,e.h=e.y2-e.y1)},$i=function(e,t){return null==t?e:Wi(e,t.x1,t.y1,t.x2,t.y2)},Yi=function(e,t,a){return xe(e,t,a)},Xi=function(e,t,a){if(!t.cy().headless()){var i,n,s=t._private,r=s.rstyle,o=r.arrowWidth/2;if("none"!==t.pstyle(a+"-arrow-shape").value){"source"===a?(i=r.srcX,n=r.srcY):"target"===a?(i=r.tgtX,n=r.tgtY):(i=r.midX,n=r.midY);var l=s.arrowBounds=s.arrowBounds||{},c=l[a]=l[a]||{};c.x1=i-o,c.y1=n-o,c.x2=i+o,c.y2=n+o,c.w=c.x2-c.x1,c.h=c.y2-c.y1,et(c,1),Wi(e,c.x1,c.y1,c.x2,c.y2)}}},Qi=function(e,t,a){if(!t.cy().headless()){var i;i=a?a+"-":"";var n=t._private,s=n.rstyle;if(t.pstyle(i+"label").strValue){var r,o,l,c,d=t.pstyle("text-halign"),u=t.pstyle("text-valign"),p=Yi(s,"labelWidth",a),m=Yi(s,"labelHeight",a),b=Yi(s,"labelX",a),h=Yi(s,"labelY",a),f=t.pstyle(i+"text-margin-x").pfValue,g=t.pstyle(i+"text-margin-y").pfValue,j=t.isEdge(),x=t.pstyle(i+"text-rotation"),v=t.pstyle("text-outline-width").pfValue,y=t.pstyle("text-border-width").pfValue/2,O=t.pstyle("text-background-padding").pfValue,E=m,w=p,_=w/2,S=E/2;if(j)r=b-_,o=b+_,l=h-S,c=h+S;else{switch(d.value){case"left":r=b-w,o=b;break;case"center":r=b-_,o=b+_;break;case"right":r=b,o=b+w}switch(u.value){case"top":l=h-E,c=h;break;case"center":l=h-S,c=h+S;break;case"bottom":l=h,c=h+E}}r+=f-Math.max(v,y)-O,o+=f+Math.max(v,y)+O,l+=g-Math.max(v,y)-O,c+=g+Math.max(v,y)+O;var M=a||"main",k=n.labelBounds,C=k[M]=k[M]||{};C.x1=r,C.y1=l,C.x2=o,C.y2=c,C.w=o-r,C.h=c-l,et(C,1);var T=j&&"autorotate"===x.strValue,F=null!=x.pfValue&&0!==x.pfValue;if(T||F){var I=T?Yi(n.rstyle,"labelAngle",a):x.pfValue,D=Math.cos(I),A=Math.sin(I),L=(r+o)/2,R=(l+c)/2;if(!j){switch(d.value){case"left":L=o;break;case"right":L=r}switch(u.value){case"top":R=c;break;case"bottom":R=l}}var P=function(e,t){return{x:(e-=L)*D-(t-=R)*A+L,y:e*A+t*D+R}},N=P(r,l),z=P(r,c),B=P(o,l),J=P(o,c);r=Math.min(N.x,z.x,B.x,J.x),o=Math.max(N.x,z.x,B.x,J.x),l=Math.min(N.y,z.y,B.y,J.y),c=Math.max(N.y,z.y,B.y,J.y)}Wi(e,r,l,o,c),Wi(n.labelBounds.all,r,l,o,c)}return e}},Ki=function(e){var t=0,a=function(e){return(e?1:0)<<t++},i=0;return i+=a(e.incudeNodes),i+=a(e.includeEdges),i+=a(e.includeLabels),i+=a(e.includeMainLabels),i+=a(e.includeSourceLabels),i+=a(e.includeTargetLabels),i+=a(e.includeOverlays)},Zi=function(e){if(e.isEdge()){var t=e.source().position(),a=e.target().position(),i=function(e){return Math.round(e)};return Q([i(t.x),i(t.y),i(a.x),i(a.y)])}return 0},en=function(e,t){var a,i=e._private,n=e.isEdge(),s=(null==t?an:Ki(t))===an,r=Zi(e),o=i.bbCachePosKey===r,l=!(t.useCache&&o)||null==i.bbCache;if(l?(o||e.recalculateRenderedStyle(),a=function(e,t){var a,i,n,s,r,o,l,c=e._private.cy,d=c.styleEnabled(),u=c.headless(),p=Ke(),m=e._private,b=e.isNode(),h=e.isEdge(),f=m.rstyle,g=b&&d?e.pstyle("bounds-expansion").pfValue:[0],j=function(e){return"none"!==e.pstyle("display").value},x=!d||j(e)&&(!h||j(e.source())&&j(e.target()));if(x){var v=0;d&&t.includeOverlays&&0!==e.pstyle("overlay-opacity").value&&(v=e.pstyle("overlay-padding").value);var y=0;if(d&&(y=e.pstyle("width").pfValue/2),b&&t.includeNodes){var O=e.position();r=O.x,o=O.y;var E=e.outerWidth()/2,w=e.outerHeight()/2;Wi(p,a=r-E,n=o-w,i=r+E,s=o+w)}else if(h&&t.includeEdges)if(d&&!u&&(a=Math.min(f.srcX,f.midX,f.tgtX),i=Math.max(f.srcX,f.midX,f.tgtX),n=Math.min(f.srcY,f.midY,f.tgtY),s=Math.max(f.srcY,f.midY,f.tgtY),Wi(p,a-=y,n-=y,i+=y,s+=y)),d&&!u&&"haystack"===e.pstyle("curve-style").strValue){var _=f.haystackPts||[];if(a=_[0].x,n=_[0].y,a>(i=_[1].x)){var S=a;a=i,i=S}if(n>(s=_[1].y)){var M=n;n=s,s=M}Wi(p,a-y,n-y,i+y,s+y)}else{for(var k=f.bezierPts||f.linePts||[],C=0;C<k.length;C++){var T=k[C];a=T.x-y,i=T.x+y,n=T.y-y,s=T.y+y,Wi(p,a,n,i,s)}if(0===k.length){var F=e.source().position(),I=e.target().position();if((a=F.x)>(i=I.x)){var D=a;a=i,i=D}if((n=F.y)>(s=I.y)){var A=n;n=s,s=A}Wi(p,a-=y,n-=y,i+=y,s+=y)}}if(d&&t.includeEdges&&h&&(Xi(p,e,"mid-source"),Xi(p,e,"mid-target"),Xi(p,e,"source"),Xi(p,e,"target")),d&&"yes"===e.pstyle("ghost").value){var L=e.pstyle("ghost-offset-x").pfValue,R=e.pstyle("ghost-offset-y").pfValue;Wi(p,p.x1+L,p.y1+R,p.x2+L,p.y2+R)}var P=m.bodyBounds=m.bodyBounds||{};at(P,p),tt(P,g),et(P,1),d&&(a=p.x1,i=p.x2,n=p.y1,s=p.y2,Wi(p,a-v,n-v,i+v,s+v));var N=m.overlayBounds=m.overlayBounds||{};at(N,p),tt(N,g),et(N,1);var z=m.labelBounds=m.labelBounds||{};null!=z.all?((l=z.all).x1=1/0,l.y1=1/0,l.x2=-1/0,l.y2=-1/0,l.w=0,l.h=0):z.all=Ke(),d&&t.includeLabels&&(t.includeMainLabels&&Qi(p,e,null),h&&(t.includeSourceLabels&&Qi(p,e,"source"),t.includeTargetLabels&&Qi(p,e,"target")))}return p.x1=Hi(p.x1),p.y1=Hi(p.y1),p.x2=Hi(p.x2),p.y2=Hi(p.y2),p.w=Hi(p.x2-p.x1),p.h=Hi(p.y2-p.y1),p.w>0&&p.h>0&&x&&(tt(p,g),et(p,1)),p}(e,tn),i.bbCache=a,i.bbCacheShift.x=i.bbCacheShift.y=0,i.bbCachePosKey=r):a=i.bbCache,!l&&(0!==i.bbCacheShift.x||0!==i.bbCacheShift.y)){var c=it,d=i.bbCacheShift,u=function(e,t){null!=e&&c(e,t)};c(a,d);var p=i.bodyBounds,m=i.overlayBounds,b=i.labelBounds,h=i.arrowBounds;u(p,d),u(m,d),null!=h&&(u(h.source,d),u(h.target,d),u(h["mid-source"],d),u(h["mid-target"],d)),null!=b&&(u(b.main,d),u(b.all,d),u(b.source,d),u(b.target,d))}if(i.bbCacheShift.x=i.bbCacheShift.y=0,!s){var f=e.isNode();a=Ke(),(t.includeNodes&&f||t.includeEdges&&!f)&&(t.includeOverlays?$i(a,i.overlayBounds):$i(a,i.bodyBounds)),t.includeLabels&&(t.includeMainLabels&&(!n||t.includeSourceLabels&&t.includeTargetLabels)?$i(a,i.labelBounds.all):(t.includeMainLabels&&$i(a,i.labelBounds.main),t.includeSourceLabels&&$i(a,i.labelBounds.source),t.includeTargetLabels&&$i(a,i.labelBounds.target))),a.w=a.x2-a.x1,a.h=a.y2-a.y1}return a},tn={includeNodes:!0,includeEdges:!0,includeLabels:!0,includeMainLabels:!0,includeSourceLabels:!0,includeTargetLabels:!0,includeOverlays:!0,useCache:!0},an=Ki(tn),nn=fe(tn);Gi.boundingBox=function(e){var t;if(1!==this.length||null==this[0]._private.bbCache||void 0!==e&&void 0!==e.useCache&&!0!==e.useCache){t=Ke();var a=nn(e=e||tn),i=this;if(i.cy().styleEnabled())for(var n=0;n<i.length;n++){var s=i[n],r=s._private,o=Zi(s),l=r.bbCachePosKey===o,c=a.useCache&&l;s.recalculateRenderedStyle(c)}this.updateCompoundBounds();for(var d=0;d<i.length;d++){var u=i[d];$i(t,en(u,a))}}else e=void 0===e?tn:nn(e),t=en(this[0],e);return t.x1=Hi(t.x1),t.y1=Hi(t.y1),t.x2=Hi(t.x2),t.y2=Hi(t.y2),t.w=Hi(t.x2-t.x1),t.h=Hi(t.y2-t.y1),t},Gi.dirtyBoundingBoxCache=function(){for(var e=0;e<this.length;e++){var t=this[e]._private;t.bbCache=null,t.bbCacheShift.x=t.bbCacheShift.y=0,t.bbCachePosKey=null,t.bodyBounds=null,t.overlayBounds=null,t.labelBounds.all=null,t.labelBounds.source=null,t.labelBounds.target=null,t.labelBounds.main=null,t.arrowBounds.source=null,t.arrowBounds.target=null,t.arrowBounds["mid-source"]=null,t.arrowBounds["mid-target"]=null}return this.emitAndNotify("bounds"),this},Gi.shiftCachedBoundingBox=function(e){for(var t=0;t<this.length;t++){var a=this[t]._private;null!=a.bbCache&&(a.bbCacheShift.x+=e.x,a.bbCacheShift.y+=e.y)}return this.emitAndNotify("bounds"),this},Gi.boundingBoxAt=function(e){var t=this.nodes(),a=this.cy(),i=a.hasCompoundNodes();if(i&&(t=t.filter((function(e){return!e.isParent()}))),y(e)){var n=e;e=function(){return n}}a.startBatch(),t.forEach((function(t,a){return t._private.bbAtOldPos=e(t,a)})).silentPositions(e),i&&this.updateCompoundBounds(!0);var s=function(e){return{x1:e.x1,x2:e.x2,w:e.w,y1:e.y1,y2:e.y2,h:e.h}}(this.boundingBox({useCache:!1}));return t.silentPositions((function(e){return e._private.bbAtOldPos})),a.endBatch(),s},Ui.boundingbox=Ui.bb=Ui.boundingBox,Ui.renderedBoundingbox=Ui.renderedBoundingBox;var sn,rn,on=Gi;sn=rn={};var ln=function(e){e.uppercaseName=L(e.name),e.autoName="auto"+e.uppercaseName,e.labelName="label"+e.uppercaseName,e.outerName="outer"+e.uppercaseName,e.uppercaseOuterName=L(e.outerName),sn[e.name]=function(){var t=this[0],a=t._private,i=a.cy._private.styleEnabled;if(t){if(i){if(t.isParent())return t.updateCompoundBounds(),a[e.autoName]||0;var n=t.pstyle(e.name);return"label"===n.strValue?(t.recalculateRenderedStyle(),a.rstyle[e.labelName]||0):n.pfValue}return 1}},sn["outer"+e.uppercaseName]=function(){var t=this[0],a=t._private.cy._private.styleEnabled;if(t)return a?t[e.name]()+t.pstyle("border-width").pfValue+2*t.padding():1},sn["rendered"+e.uppercaseName]=function(){var t=this[0];if(t)return t[e.name]()*this.cy().zoom()},sn["rendered"+e.uppercaseOuterName]=function(){var t=this[0];if(t)return t[e.outerName]()*this.cy().zoom()}};ln({name:"width"}),ln({name:"height"}),rn.padding=function(){var e=this[0],t=e._private;return e.isParent()?(e.updateCompoundBounds(),void 0!==t.autoPadding?t.autoPadding:e.pstyle("padding").pfValue):e.pstyle("padding").pfValue},rn.paddedHeight=function(){var e=this[0];return e.height()+2*e.padding()},rn.paddedWidth=function(){var e=this[0];return e.width()+2*e.padding()};var cn=rn,dn={controlPoints:{get:function(e){return e.renderer().getControlPoints(e)},mult:!0},segmentPoints:{get:function(e){return e.renderer().getSegmentPoints(e)},mult:!0},sourceEndpoint:{get:function(e){return e.renderer().getSourceEndpoint(e)}},targetEndpoint:{get:function(e){return e.renderer().getTargetEndpoint(e)}},midpoint:{get:function(e){return e.renderer().getEdgeMidpoint(e)}}},un=Object.keys(dn).reduce((function(e,t){var a=dn[t],i=function(e){return"rendered"+e[0].toUpperCase()+e.substr(1)}(t);return e[t]=function(){return function(e,t){if(e.isEdge())return t(e)}(this,a.get)},a.mult?e[i]=function(){return function(e,t){if(e.isEdge()){var a=e.cy(),i=a.pan(),n=a.zoom();return t(e).map((function(e){return Be(e,n,i)}))}}(this,a.get)}:e[i]=function(){return function(e,t){if(e.isEdge()){var a=e.cy();return Be(t(e),a.zoom(),a.pan())}}(this,a.get)},e}),{}),pn=N({},qi,on,cn,un),mn=function(e,t){this.recycle(e,t)};function bn(){return!1}function hn(){return!0}mn.prototype={instanceString:function(){return"event"},recycle:function(e,t){if(this.isImmediatePropagationStopped=this.isPropagationStopped=this.isDefaultPrevented=bn,null!=e&&e.preventDefault?(this.type=e.type,this.isDefaultPrevented=e.defaultPrevented?hn:bn):null!=e&&e.type?t=e:this.type=e,null!=t&&(this.originalEvent=t.originalEvent,this.type=null!=t.type?t.type:this.type,this.cy=t.cy,this.target=t.target,this.position=t.position,this.renderedPosition=t.renderedPosition,this.namespace=t.namespace,this.layout=t.layout),null!=this.cy&&null!=this.position&&null==this.renderedPosition){var a=this.position,i=this.cy.zoom(),n=this.cy.pan();this.renderedPosition={x:a.x*i+n.x,y:a.y*i+n.y}}this.timeStamp=e&&e.timeStamp||Date.now()},preventDefault:function(){this.isDefaultPrevented=hn;var e=this.originalEvent;e&&e.preventDefault&&e.preventDefault()},stopPropagation:function(){this.isPropagationStopped=hn;var e=this.originalEvent;e&&e.stopPropagation&&e.stopPropagation()},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=hn,this.stopPropagation()},isDefaultPrevented:bn,isPropagationStopped:bn,isImmediatePropagationStopped:bn};var fn=/^([^.]+)(\.(?:[^.]+))?$/,gn={qualifierCompare:function(e,t){return e===t},eventMatches:function(){return!0},addEventFields:function(){},callbackContext:function(e){return e},beforeEmit:function(){},afterEmit:function(){},bubble:function(){return!1},parent:function(){return null},context:null},jn=Object.keys(gn),xn={};function vn(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:xn,t=arguments.length>1?arguments[1]:void 0,a=0;a<jn.length;a++){var i=jn[a];this[i]=e[i]||gn[i]}this.context=t||this.context,this.listeners=[],this.emitting=0}var yn=vn.prototype,On=function(e,t,a,i,n,s,r){x(i)&&(n=i,i=null),r&&(s=null==s?r:N({},s,r));for(var o=v(a)?a:a.split(/\s+/),l=0;l<o.length;l++){var c=o[l];if(!C(c)){var d=c.match(fn);if(d)if(!1===t(e,c,d[1],d[2]?d[2]:null,i,n,s))break}}},En=function(e,t){return e.addEventFields(e.context,t),new mn(t.type,t)},wn=function(e,t,a){if("event"!==g(a))if(y(a))t(e,En(e,a));else for(var i=v(a)?a:a.split(/\s+/),n=0;n<i.length;n++){var s=i[n];if(!C(s)){var r=s.match(fn);if(r){var o=r[1],l=r[2]?r[2]:null;t(e,En(e,{type:o,namespace:l,target:e.context}))}}}else t(e,a)};yn.on=yn.addListener=function(e,t,a,i,n){return On(this,(function(e,t,a,i,n,s,r){x(s)&&e.listeners.push({event:t,callback:s,type:a,namespace:i,qualifier:n,conf:r})}),e,t,a,i,n),this},yn.one=function(e,t,a,i){return this.on(e,t,a,i,{one:!0})},yn.removeListener=yn.off=function(e,t,a,i){var n=this;0!==this.emitting&&(this.listeners=this.listeners.slice());for(var s=this.listeners,r=function(r){var o=s[r];On(n,(function(t,a,i,n,l,c){if((o.type===i||"*"===e)&&(!n&&".*"!==o.namespace||o.namespace===n)&&(!l||t.qualifierCompare(o.qualifier,l))&&(!c||o.callback===c))return s.splice(r,1),!1}),e,t,a,i)},o=s.length-1;o>=0;o--)r(o);return this},yn.removeAllListeners=function(){return this.removeListener("*")},yn.emit=yn.trigger=function(e,t,a){var i=this.listeners,n=i.length;return this.emitting++,v(t)||(t=[t]),wn(this,(function(e,s){null!=a&&(i=[{event:s.event,type:s.type,namespace:s.namespace,callback:a}],n=i.length);for(var r=function(a){var n=i[a];if(n.type===s.type&&(!n.namespace||n.namespace===s.namespace||".*"===n.namespace)&&e.eventMatches(e.context,n,s)){var r=[s];null!=t&&function(e,t){for(var a=0;a<t.length;a++){var i=t[a];e.push(i)}}(r,t),e.beforeEmit(e.context,n,s),n.conf&&n.conf.one&&(e.listeners=e.listeners.filter((function(e){return e!==n})));var o=e.callbackContext(e.context,n,s),l=n.callback.apply(o,r);e.afterEmit(e.context,n,s),!1===l&&(s.stopPropagation(),s.preventDefault())}},o=0;o<n;o++)r(o);e.bubble(e.context)&&!s.isPropagationStopped()&&e.parent(e.context).emit(s,t)}),e),this.emitting--,this};var _n={qualifierCompare:function(e,t){return null==e||null==t?null==e&&null==t:e.sameText(t)},eventMatches:function(e,t,a){var i=t.qualifier;return null==i||e!==a.target&&_(a.target)&&i.matches(a.target)},addEventFields:function(e,t){t.cy=e.cy(),t.target=e},callbackContext:function(e,t,a){return null!=t.qualifier?a.target:e},beforeEmit:function(e,t){t.conf&&t.conf.once&&t.conf.onceCollection.removeListener(t.event,t.qualifier,t.callback)},bubble:function(){return!0},parent:function(e){return e.isChild()?e.parent():e.cy()}},Sn=function(e){return j(e)?new wi(e):e},Mn={createEmitter:function(){for(var e=0;e<this.length;e++){var t=this[e],a=t._private;a.emitter||(a.emitter=new vn(_n,t))}return this},emitter:function(){return this._private.emitter},on:function(e,t,a){for(var i=Sn(t),n=0;n<this.length;n++){this[n].emitter().on(e,i,a)}return this},removeListener:function(e,t,a){for(var i=Sn(t),n=0;n<this.length;n++){this[n].emitter().removeListener(e,i,a)}return this},removeAllListeners:function(){for(var e=0;e<this.length;e++){this[e].emitter().removeAllListeners()}return this},one:function(e,t,a){for(var i=Sn(t),n=0;n<this.length;n++){this[n].emitter().one(e,i,a)}return this},once:function(e,t,a){for(var i=Sn(t),n=0;n<this.length;n++){this[n].emitter().on(e,i,a,{once:!0,onceCollection:this})}},emit:function(e,t){for(var a=0;a<this.length;a++){this[a].emitter().emit(e,t)}return this},emitAndNotify:function(e,t){if(0!==this.length)return this.cy().notify(e,this),this.emit(e,t),this}};Ba.eventAliasesOn(Mn);var kn={nodes:function(e){return this.filter((function(e){return e.isNode()})).filter(e)},edges:function(e){return this.filter((function(e){return e.isEdge()})).filter(e)},byGroup:function(){for(var e=this.spawn(),t=this.spawn(),a=0;a<this.length;a++){var i=this[a];i.isNode()?e.merge(i):t.merge(i)}return{nodes:e,edges:t}},filter:function(e,t){if(void 0===e)return this;if(j(e)||w(e))return new wi(e).filter(this);if(x(e)){for(var a=this.spawn(),i=this,n=0;n<i.length;n++){var s=i[n];(t?e.apply(t,[s,n,i]):e(s,n,i))&&a.merge(s)}return a}return this.spawn()},not:function(e){if(e){j(e)&&(e=this.filter(e));for(var t=[],a=e._private.map,i=0;i<this.length;i++){var n=this[i];a.has(n.id())||t.push(n)}return this.spawn(t)}return this},absoluteComplement:function(){return this.cy().mutableElements().not(this)},intersect:function(e){if(j(e)){var t=e;return this.filter(t)}for(var a=[],i=e,n=this.length<e.length,s=n?i._private.map:this._private.map,r=n?this:i,o=0;o<r.length;o++){var l=r[o]._private.data.id,c=s.get(l);c&&a.push(c.ele)}return this.spawn(a)},xor:function(e){var t=this._private.cy;j(e)&&(e=t.$(e));var a=[],i=e,n=function(e,t){for(var i=0;i<e.length;i++){var n=e[i],s=n._private.data.id;t.hasElementWithId(s)||a.push(n)}};return n(this,i),n(i,this),this.spawn(a)},diff:function(e){var t=this._private.cy;j(e)&&(e=t.$(e));var a=[],i=[],n=[],s=e,r=function(e,t,a){for(var i=0;i<e.length;i++){var s=e[i],r=s._private.data.id;t.hasElementWithId(r)?n.push(s):a.push(s)}};return r(this,s,a),r(s,this,i),{left:this.spawn(a,{unique:!0}),right:this.spawn(i,{unique:!0}),both:this.spawn(n,{unique:!0})}},add:function(e){var t=this._private.cy;if(!e)return this;if(j(e)){var a=e;e=t.mutableElements().filter(a)}for(var i=[],n=0;n<this.length;n++)i.push(this[n]);for(var s=this._private.map,r=0;r<e.length;r++){var o=!s.has(e[r].id());o&&i.push(e[r])}return this.spawn(i)},merge:function(e){var t=this._private,a=t.cy;if(!e)return this;if(e&&j(e)){var i=e;e=a.mutableElements().filter(i)}for(var n=t.map,s=0;s<e.length;s++){var r=e[s],o=r._private.data.id;if(!n.has(o)){var l=this.length++;this[l]=r,n.set(o,{ele:r,index:l})}else{var c=n.get(o).index;this[c]=r,n.set(o,{ele:r,index:c})}}return this},unmergeAt:function(e){var t=this[e].id(),a=this._private.map;this[e]=void 0,a.delete(t);var i=e===this.length-1;if(this.length>1&&!i){var n=this.length-1,s=this[n],r=s._private.data.id;this[n]=void 0,this[e]=s,a.set(r,{ele:s,index:e})}return this.length--,this},unmergeOne:function(e){e=e[0];var t=this._private,a=e._private.data.id,i=t.map.get(a);if(!i)return this;var n=i.index;return this.unmergeAt(n),this},unmerge:function(e){var t=this._private.cy;if(!e)return this;if(e&&j(e)){var a=e;e=t.mutableElements().filter(a)}for(var i=0;i<e.length;i++)this.unmergeOne(e[i]);return this},unmergeBy:function(e){for(var t=this.length-1;t>=0;t--){e(this[t])&&this.unmergeAt(t)}return this},map:function(e,t){for(var a=[],i=this,n=0;n<i.length;n++){var s=i[n],r=t?e.apply(t,[s,n,i]):e(s,n,i);a.push(r)}return a},reduce:function(e,t){for(var a=t,i=this,n=0;n<i.length;n++)a=e(a,i[n],n,i);return a},max:function(e,t){for(var a,i=-1/0,n=this,s=0;s<n.length;s++){var r=n[s],o=t?e.apply(t,[r,s,n]):e(r,s,n);o>i&&(i=o,a=r)}return{value:i,ele:a}},min:function(e,t){for(var a,i=1/0,n=this,s=0;s<n.length;s++){var r=n[s],o=t?e.apply(t,[r,s,n]):e(r,s,n);o<i&&(i=o,a=r)}return{value:i,ele:a}}},Cn=kn;Cn.u=Cn["|"]=Cn["+"]=Cn.union=Cn.or=Cn.add,Cn["\\"]=Cn["!"]=Cn["-"]=Cn.difference=Cn.relativeComplement=Cn.subtract=Cn.not,Cn.n=Cn["&"]=Cn["."]=Cn.and=Cn.intersection=Cn.intersect,Cn["^"]=Cn["(+)"]=Cn["(-)"]=Cn.symmetricDifference=Cn.symdiff=Cn.xor,Cn.fnFilter=Cn.filterFn=Cn.stdFilter=Cn.filter,Cn.complement=Cn.abscomp=Cn.absoluteComplement;var Tn=function(e,t){var a=e.cy().hasCompoundNodes();function i(e){var t=e.pstyle("z-compound-depth");return"auto"===t.value?a?e.zDepth():0:"bottom"===t.value?-1:"top"===t.value?ne:0}var n=i(e)-i(t);if(0!==n)return n;function s(e){return"auto"===e.pstyle("z-index-compare").value&&e.isNode()?1:0}var r=s(e)-s(t);if(0!==r)return r;var o=e.pstyle("z-index").value-t.pstyle("z-index").value;return 0!==o?o:e.poolIndex()-t.poolIndex()},Fn={forEach:function(e,t){if(x(e))for(var a=this.length,i=0;i<a;i++){var n=this[i];if(!1===(t?e.apply(t,[n,i,this]):e(n,i,this)))break}return this},toArray:function(){for(var e=[],t=0;t<this.length;t++)e.push(this[t]);return e},slice:function(e,t){var a=[],i=this.length;null==t&&(t=i),null==e&&(e=0),e<0&&(e=i+e),t<0&&(t=i+t);for(var n=e;n>=0&&n<t&&n<i;n++)a.push(this[n]);return this.spawn(a)},size:function(){return this.length},eq:function(e){return this[e]||this.spawn()},first:function(){return this[0]||this.spawn()},last:function(){return this[this.length-1]||this.spawn()},empty:function(){return 0===this.length},nonempty:function(){return!this.empty()},sort:function(e){if(!x(e))return this;var t=this.toArray().sort(e);return this.spawn(t)},sortByZIndex:function(){return this.sort(Tn)},zDepth:function(){var e=this[0];if(e){var t=e._private;if("nodes"===t.group){var a=t.data.parent?e.parents().size():0;return e.isParent()?a:ne-1}var i=t.source,n=t.target,s=i.zDepth(),r=n.zDepth();return Math.max(s,r,0)}}};Fn.each=Fn.forEach;var In=fe({nodeDimensionsIncludeLabels:!1}),Dn={layoutDimensions:function(e){var t;if(e=In(e),this.takesUpSpace())if(e.nodeDimensionsIncludeLabels){var a=this.boundingBox();t={w:a.w,h:a.h}}else t={w:this.outerWidth(),h:this.outerHeight()};else t={w:0,h:0};return 0!==t.w&&0!==t.h||(t.w=t.h=1),t},layoutPositions:function(e,t,a){var i=this.nodes(),n=this.cy(),s=t.eles,r=function(e){return e.id()},o=F(a,r);e.emit({type:"layoutstart",layout:e}),e.animations=[];var l=t.spacingFactor&&1!==t.spacingFactor,c=function(){if(!l)return null;for(var e=Ke(),t=0;t<i.length;t++){var a=i[t],n=o(a,t);Ze(e,n.x,n.y)}return e}(),d=F((function(e,a){var i=o(e,a);l&&(i=function(e,t,a){var i=t.x1+t.w/2,n=t.y1+t.h/2;return{x:i+(a.x-i)*e,y:n+(a.y-n)*e}}(Math.abs(t.spacingFactor),c,i));return null!=t.transform&&(i=t.transform(e,i)),i}),r);if(t.animate){for(var u=0;u<i.length;u++){var p=i[u],m=d(p,u);if(null==t.animateFilter||t.animateFilter(p,u)){var b=p.animation({position:m,duration:t.animationDuration,easing:t.animationEasing});e.animations.push(b)}else p.position(m)}if(t.fit){var h=n.animation({fit:{boundingBox:s.boundingBoxAt(d),padding:t.padding},duration:t.animationDuration,easing:t.animationEasing});e.animations.push(h)}else if(void 0!==t.zoom&&void 0!==t.pan){var f=n.animation({zoom:t.zoom,pan:t.pan,duration:t.animationDuration,easing:t.animationEasing});e.animations.push(f)}e.animations.forEach((function(e){return e.play()})),e.one("layoutready",t.ready),e.emit({type:"layoutready",layout:e}),Aa.all(e.animations.map((function(e){return e.promise()}))).then((function(){e.one("layoutstop",t.stop),e.emit({type:"layoutstop",layout:e})}))}else i.positions(d),t.fit&&n.fit(t.eles,t.padding),null!=t.zoom&&n.zoom(t.zoom),t.pan&&n.pan(t.pan),e.one("layoutready",t.ready),e.emit({type:"layoutready",layout:e}),e.one("layoutstop",t.stop),e.emit({type:"layoutstop",layout:e});return this},layout:function(e){return this.cy().makeLayout(N({},e,{eles:this}))}};function An(e,t,a){var i,n=a._private,s=n.styleCache=n.styleCache||[];return null!=(i=s[e])?i:i=s[e]=t(a)}function Ln(e,t){return e=K(e),function(a){return An(e,t,a)}}function Rn(e,t){e=K(e);var a=function(e){return t.call(e)};return function(){var t=this[0];if(t)return An(e,a,t)}}Dn.createLayout=Dn.makeLayout=Dn.layout;var Pn={recalculateRenderedStyle:function(e){var t=this.cy(),a=t.renderer(),i=t.styleEnabled();return a&&i&&a.recalculateRenderedStyle(this,e),this},dirtyStyleCache:function(){var e,t=this.cy(),a=function(e){return e._private.styleCache=null};t.hasCompoundNodes()?((e=this.spawnSelf().merge(this.descendants()).merge(this.parents())).merge(e.connectedEdges()),e.forEach(a)):this.forEach((function(e){a(e),e.connectedEdges().forEach(a)}));return this},updateStyle:function(e){var t=this._private.cy;if(!t.styleEnabled())return this;if(t.batching())return t._private.batchStyleEles.merge(this),this;var a=t.hasCompoundNodes(),i=t.style(),n=this;e=!(!e&&void 0!==e),a&&(n=this.spawnSelf().merge(this.descendants()).merge(this.parents()));var s=i.apply(n);return e?s.emitAndNotify("style"):s.emit("style"),this},parsedStyle:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=this[0],i=a.cy();if(i.styleEnabled()&&a){var n=a._private.style[e];return null!=n?n:t?i.style().getDefaultProperty(e):null}},numericStyle:function(e){var t=this[0];if(t.cy().styleEnabled()&&t){var a=t.pstyle(e);return void 0!==a.pfValue?a.pfValue:a.value}},numericStyleUnits:function(e){var t=this[0];if(t.cy().styleEnabled())return t?t.pstyle(e).units:void 0},renderedStyle:function(e){var t=this.cy();if(!t.styleEnabled())return this;var a=this[0];return a?t.style().getRenderedStyle(a,e):void 0},style:function(e,t){var a=this.cy();if(!a.styleEnabled())return this;var i=a.style();if(y(e)){var n=e;i.applyBypass(this,n,false),this.emitAndNotify("style")}else if(j(e)){if(void 0===t){var s=this[0];return s?i.getStylePropertyValue(s,e):void 0}i.applyBypass(this,e,t,false),this.emitAndNotify("style")}else if(void 0===e){var r=this[0];return r?i.getRawStyle(r):void 0}return this},removeStyle:function(e){var t=this.cy();if(!t.styleEnabled())return this;var a=t.style(),i=this;if(void 0===e)for(var n=0;n<i.length;n++){var s=i[n];a.removeAllBypasses(s,false)}else{e=e.split(/\s+/);for(var r=0;r<i.length;r++){var o=i[r];a.removeBypasses(o,e,false)}}return this.emitAndNotify("style"),this},show:function(){return this.css("display","element"),this},hide:function(){return this.css("display","none"),this},effectiveOpacity:function(){var e=this.cy();if(!e.styleEnabled())return 1;var t=e.hasCompoundNodes(),a=this[0];if(a){var i=a._private,n=a.pstyle("opacity").value;if(!t)return n;var s=i.data.parent?a.parents():null;if(s)for(var r=0;r<s.length;r++){n*=s[r].pstyle("opacity").value}return n}},transparent:function(){if(!this.cy().styleEnabled())return!1;var e=this[0],t=e.cy().hasCompoundNodes();return e?t?0===e.effectiveOpacity():0===e.pstyle("opacity").value:void 0},backgrounding:function(){return!!this.cy().styleEnabled()&&!!this[0]._private.backgrounding}};function Nn(e,t){var a=e._private.data.parent?e.parents():null;if(a)for(var i=0;i<a.length;i++){if(!t(a[i]))return!1}return!0}function zn(e){var t=e.ok,a=e.edgeOkViaNode||e.ok,i=e.parentOk||e.ok;return function(){var e=this.cy();if(!e.styleEnabled())return!0;var n=this[0],s=e.hasCompoundNodes();if(n){var r=n._private;if(!t(n))return!1;if(n.isNode())return!s||Nn(n,i);var o=r.source,l=r.target;return a(o)&&(!s||Nn(o,a))&&(o===l||a(l)&&(!s||Nn(l,a)))}}}var Bn=Ln("eleTakesUpSpace",(function(e){return"element"===e.pstyle("display").value&&0!==e.width()&&(!e.isNode()||0!==e.height())}));Pn.takesUpSpace=Rn("takesUpSpace",zn({ok:Bn}));var Jn=Ln("eleInteractive",(function(e){return"yes"===e.pstyle("events").value&&"visible"===e.pstyle("visibility").value&&Bn(e)})),Vn=Ln("parentInteractive",(function(e){return"visible"===e.pstyle("visibility").value&&Bn(e)}));Pn.interactive=Rn("interactive",zn({ok:Jn,parentOk:Vn,edgeOkViaNode:Bn})),Pn.noninteractive=function(){var e=this[0];if(e)return!e.interactive()};var Un=Ln("eleVisible",(function(e){return"visible"===e.pstyle("visibility").value&&0!==e.pstyle("opacity").pfValue&&Bn(e)})),Gn=Bn;Pn.visible=Rn("visible",zn({ok:Un,edgeOkViaNode:Gn})),Pn.hidden=function(){var e=this[0];if(e)return!e.visible()},Pn.isBundledBezier=Rn("isBundledBezier",(function(){return!!this.cy().styleEnabled()&&(!this.removed()&&"bezier"===this.pstyle("curve-style").value&&this.takesUpSpace())})),Pn.bypass=Pn.css=Pn.style,Pn.renderedCss=Pn.renderedStyle,Pn.removeBypass=Pn.removeCss=Pn.removeStyle,Pn.pstyle=Pn.parsedStyle;var qn={};function Hn(e){return function(){var t=arguments,a=[];if(2===t.length){var i=t[0],n=t[1];this.on(e.event,i,n)}else if(1===t.length&&x(t[0])){var s=t[0];this.on(e.event,s)}else if(0===t.length||1===t.length&&v(t[0])){for(var r=1===t.length?t[0]:null,o=0;o<this.length;o++){var l=this[o],c=!e.ableField||l._private[e.ableField],d=l._private[e.field]!=e.value;if(e.overrideAble){var u=e.overrideAble(l);if(void 0!==u&&(c=u,!u))return this}c&&(l._private[e.field]=e.value,d&&a.push(l))}var p=this.spawn(a);p.updateStyle(),p.emit(e.event),r&&p.emit(r)}return this}}function Wn(e){qn[e.field]=function(){var t=this[0];if(t){if(e.overrideField){var a=e.overrideField(t);if(void 0!==a)return a}return t._private[e.field]}},qn[e.on]=Hn({event:e.on,field:e.field,ableField:e.ableField,overrideAble:e.overrideAble,value:!0}),qn[e.off]=Hn({event:e.off,field:e.field,ableField:e.ableField,overrideAble:e.overrideAble,value:!1})}Wn({field:"locked",overrideField:function(e){return!!e.cy().autolock()||void 0},on:"lock",off:"unlock"}),Wn({field:"grabbable",overrideField:function(e){return!e.cy().autoungrabify()&&!e.pannable()&&void 0},on:"grabify",off:"ungrabify"}),Wn({field:"selected",ableField:"selectable",overrideAble:function(e){return!e.cy().autounselectify()&&void 0},on:"select",off:"unselect"}),Wn({field:"selectable",overrideField:function(e){return!e.cy().autounselectify()&&void 0},on:"selectify",off:"unselectify"}),qn.deselect=qn.unselect,qn.grabbed=function(){var e=this[0];if(e)return e._private.grabbed},Wn({field:"active",on:"activate",off:"unactivate"}),Wn({field:"pannable",on:"panify",off:"unpanify"}),qn.inactive=function(){var e=this[0];if(e)return!e._private.active};var $n={},Yn=function(e){return function(t){for(var a=[],i=0;i<this.length;i++){var n=this[i];if(n.isNode()){for(var s=!1,r=n.connectedEdges(),o=0;o<r.length;o++){var l=r[o],c=l.source(),d=l.target();if(e.noIncomingEdges&&d===n&&c!==n||e.noOutgoingEdges&&c===n&&d!==n){s=!0;break}}s||a.push(n)}}return this.spawn(a,{unique:!0}).filter(t)}},Xn=function(e){return function(t){for(var a=[],i=0;i<this.length;i++){var n=this[i];if(n.isNode())for(var s=n.connectedEdges(),r=0;r<s.length;r++){var o=s[r],l=o.source(),c=o.target();e.outgoing&&l===n?(a.push(o),a.push(c)):e.incoming&&c===n&&(a.push(o),a.push(l))}}return this.spawn(a,{unique:!0}).filter(t)}},Qn=function(e){return function(t){for(var a=this,i=[],n={};;){var s=e.outgoing?a.outgoers():a.incomers();if(0===s.length)break;for(var r=!1,o=0;o<s.length;o++){var l=s[o],c=l.id();n[c]||(n[c]=!0,i.push(l),r=!0)}if(!r)break;a=s}return this.spawn(i,{unique:!0}).filter(t)}};function Kn(e){return function(t){for(var a=[],i=0;i<this.length;i++){var n=this[i]._private[e.attr];n&&a.push(n)}return this.spawn(a,{unique:!0}).filter(t)}}function Zn(e){return function(t){var a=[],i=this._private.cy,n=e||{};j(t)&&(t=i.$(t));for(var s=0;s<t.length;s++)for(var r=t[s]._private.edges,o=0;o<r.length;o++){var l=r[o],c=l._private.data,d=this.hasElementWithId(c.source)&&t.hasElementWithId(c.target),u=t.hasElementWithId(c.source)&&this.hasElementWithId(c.target);if(d||u){if(n.thisIsSrc||n.thisIsTgt){if(n.thisIsSrc&&!d)continue;if(n.thisIsTgt&&!u)continue}a.push(l)}}return this.spawn(a,{unique:!0})}}function es(e){return e=N({},{codirected:!1},e),function(t){for(var a=[],i=this.edges(),n=e,s=0;s<i.length;s++)for(var r=i[s]._private,o=r.source,l=o._private.data.id,c=r.data.target,d=o._private.edges,u=0;u<d.length;u++){var p=d[u],m=p._private.data,b=m.target,h=m.source,f=b===c&&h===l,g=l===b&&c===h;(n.codirected&&f||!n.codirected&&(f||g))&&a.push(p)}return this.spawn(a,{unique:!0}).filter(t)}}$n.clearTraversalCache=function(){for(var e=0;e<this.length;e++)this[e]._private.traversalCache=null},N($n,{roots:Yn({noIncomingEdges:!0}),leaves:Yn({noOutgoingEdges:!0}),outgoers:Ci(Xn({outgoing:!0}),"outgoers"),successors:Qn({outgoing:!0}),incomers:Ci(Xn({incoming:!0}),"incomers"),predecessors:Qn({incoming:!0})}),N($n,{neighborhood:Ci((function(e){for(var t=[],a=this.nodes(),i=0;i<a.length;i++)for(var n=a[i],s=n.connectedEdges(),r=0;r<s.length;r++){var o=s[r],l=o.source(),c=o.target(),d=n===l?c:l;d.length>0&&t.push(d[0]),t.push(o[0])}return this.spawn(t,{unique:!0}).filter(e)}),"neighborhood"),closedNeighborhood:function(e){return this.neighborhood().add(this).filter(e)},openNeighborhood:function(e){return this.neighborhood(e)}}),$n.neighbourhood=$n.neighborhood,$n.closedNeighbourhood=$n.closedNeighborhood,$n.openNeighbourhood=$n.openNeighborhood,N($n,{source:Ci((function(e){var t,a=this[0];return a&&(t=a._private.source||a.cy().collection()),t&&e?t.filter(e):t}),"source"),target:Ci((function(e){var t,a=this[0];return a&&(t=a._private.target||a.cy().collection()),t&&e?t.filter(e):t}),"target"),sources:Kn({attr:"source"}),targets:Kn({attr:"target"})}),N($n,{edgesWith:Ci(Zn(),"edgesWith"),edgesTo:Ci(Zn({thisIsSrc:!0}),"edgesTo")}),N($n,{connectedEdges:Ci((function(e){for(var t=[],a=0;a<this.length;a++){var i=this[a];if(i.isNode())for(var n=i._private.edges,s=0;s<n.length;s++){var r=n[s];t.push(r)}}return this.spawn(t,{unique:!0}).filter(e)}),"connectedEdges"),connectedNodes:Ci((function(e){for(var t=[],a=0;a<this.length;a++){var i=this[a];i.isEdge()&&(t.push(i.source()[0]),t.push(i.target()[0]))}return this.spawn(t,{unique:!0}).filter(e)}),"connectedNodes"),parallelEdges:Ci(es(),"parallelEdges"),codirectedEdges:Ci(es({codirected:!0}),"codirectedEdges")}),N($n,{components:function(e){var t=this,a=t.cy(),i=a.collection(),n=null==e?t.nodes():e.nodes(),s=[];null!=e&&n.empty()&&(n=e.sources());var r=function(e,t){i.merge(e),n.unmerge(e),t.merge(e)};if(n.empty())return t.spawn();var o=function(){var e=a.collection();s.push(e);var i=n[0];r(i,e),t.bfs({directed:!1,roots:i,visit:function(t){return r(t,e)}}),e.forEach((function(t){t.connectedEdges().forEach((function(t){e.has(t.source())&&e.has(t.target())&&e.merge(t)}))}))};do{o()}while(n.length>0);return s},component:function(){var e=this[0];return e.cy().mutableElements().components(e)[0]}}),$n.componentsOf=$n.components;var ts=function(e,t,a){for(var i=null!=a?a:me();e.hasElementWithId(i);)i=me();return i},as=function(e,t,a){if(void 0!==e&&M(e)){var i=new ye,n=!1;if(t){if(t.length>0&&y(t[0])&&!_(t[0])){n=!0;for(var s=[],r=new Ee,o=0,l=t.length;o<l;o++){var c=t[o];null==c.data&&(c.data={});var d=c.data;if(null==d.id)d.id=ts(e,c);else if(e.hasElementWithId(d.id)||r.has(d.id))continue;var u=new we(e,c,!1);s.push(u),r.add(d.id)}t=s}}else t=[];this.length=0;for(var p=0,m=t.length;p<m;p++){var b=t[p][0];if(null!=b){var h=b._private.data.id;(null==a||a.unique&&!i.has(h))&&(i.set(h,{index:this.length,ele:b}),this[this.length]=b,this.length++)}}this._private={cy:e,map:i},n&&this.restore()}else ce("A collection must have a reference to the core")},is=we.prototype=as.prototype;is.instanceString=function(){return"collection"},is.spawn=function(e,t,a){return M(e)||(a=t,t=e,e=this.cy()),new as(e,t,a)},is.spawnSelf=function(){return this.spawn(this)},is.cy=function(){return this._private.cy},is.renderer=function(){return this._private.cy.renderer()},is.element=function(){return this[0]},is.collection=function(){return S(this)?this:new as(this._private.cy,[this])},is.unique=function(){return new as(this._private.cy,this,{unique:!0})},is.hasElementWithId=function(e){return e=""+e,this._private.map.has(e)},is.getElementById=function(e){e=""+e;var t=this._private.cy,a=this._private.map.get(e);return a?a.ele:new as(t)},is.$id=is.getElementById,is.poolIndex=function(){var e=this._private.cy._private.elements,t=this[0]._private.data.id;return e._private.map.get(t).index},is.indexOf=function(e){var t=e[0]._private.data.id;return this._private.map.get(t).index},is.indexOfId=function(e){return e=""+e,this._private.map.get(e).index},is.json=function(e){var t=this.element(),a=this.cy();if(null==t&&e)return this;if(null!=t){var i=t._private;if(y(e)){if(a.startBatch(),e.data){t.data(e.data);var n=i.data;if(t.isEdge()){var s=!1,r={},o=e.data.source,l=e.data.target;null!=o&&o!=n.source&&(r.source=""+o,s=!0),null!=l&&l!=n.target&&(r.target=""+l,s=!0),s&&(t=t.move(r))}else{var c=e.data.parent;null==c&&null==n.parent||c==n.parent||(void 0===c&&(c=null),null!=c&&(c=""+c),t=t.move({parent:c}))}}e.position&&t.position(e.position);var d=function(a,n,s){var r=e[a];null!=r&&r!==i[a]&&(r?t[n]():t[s]())};return d("removed","remove","restore"),d("selected","select","unselect"),d("selectable","selectify","unselectify"),d("locked","lock","unlock"),d("grabbable","grabify","ungrabify"),d("pannable","panify","unpanify"),null!=e.classes&&t.classes(e.classes),a.endBatch(),this}if(void 0===e){var u={data:pe(i.data),position:pe(i.position),group:i.group,removed:i.removed,selected:i.selected,selectable:i.selectable,locked:i.locked,grabbable:i.grabbable,pannable:i.pannable,classes:null};u.classes="";var p=0;return i.classes.forEach((function(e){return u.classes+=0==p++?e:" "+e})),u}}},is.jsons=function(){for(var e=[],t=0;t<this.length;t++){var a=this[t].json();e.push(a)}return e},is.clone=function(){for(var e=this.cy(),t=[],a=0;a<this.length;a++){var i=this[a].json(),n=new we(e,i,!1);t.push(n)}return new as(e,t)},is.copy=is.clone,is.restore=function(){for(var e,t,a=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this,s=n.cy(),r=s._private,o=[],l=[],c=0,d=n.length;c<d;c++){var u=n[c];i&&!u.removed()||(u.isNode()?o.push(u):l.push(u))}e=o.concat(l);var p=function(){e.splice(t,1),t--};for(t=0;t<e.length;t++){var m=e[t],b=m._private,h=b.data;if(m.clearTraversalCache(),i||b.removed)if(void 0===h.id)h.id=ts(s,m);else if(O(h.id))h.id=""+h.id;else{if(C(h.id)||!j(h.id)){ce("Can not create element with invalid string ID `"+h.id+"`"),p();continue}if(s.hasElementWithId(h.id)){ce("Can not create second element with ID `"+h.id+"`"),p();continue}}else;var f=h.id;if(m.isNode()){var g=b.position;null==g.x&&(g.x=0),null==g.y&&(g.y=0)}if(m.isEdge()){for(var x=m,v=["source","target"],y=v.length,E=!1,w=0;w<y;w++){var _=v[w],S=h[_];O(S)&&(S=h[_]=""+h[_]),null==S||""===S?(ce("Can not create edge `"+f+"` with unspecified "+_),E=!0):s.hasElementWithId(S)||(ce("Can not create edge `"+f+"` with nonexistant "+_+" `"+S+"`"),E=!0)}if(E){p();continue}var M=s.getElementById(h.source),k=s.getElementById(h.target);M.same(k)?M._private.edges.push(x):(M._private.edges.push(x),k._private.edges.push(x)),x._private.source=M,x._private.target=k}b.map=new ye,b.map.set(f,{ele:m,index:0}),b.removed=!1,i&&s.addToPool(m)}for(var T=0;T<o.length;T++){var F=o[T],I=F._private.data;O(I.parent)&&(I.parent=""+I.parent);var D=I.parent,A=null!=D;if(A){var L=s.getElementById(D);if(L.empty())I.parent=void 0;else{for(var R=!1,P=L;!P.empty();){if(F.same(P)){R=!0,I.parent=void 0;break}P=P.parent()}R||(L[0]._private.children.push(F),F._private.parent=L[0],r.hasCompoundNodes=!0)}}}if(e.length>0){for(var N=new as(s,e),z=0;z<N.length;z++){var B=N[z];B.isNode()||(B.parallelEdges().clearTraversalCache(),B.source().clearTraversalCache(),B.target().clearTraversalCache())}(r.hasCompoundNodes?s.collection().merge(N).merge(N.connectedNodes()).merge(N.parent()):N).dirtyCompoundBoundsCache().dirtyBoundingBoxCache().updateStyle(a),a?N.emitAndNotify("add"):i&&N.emit("add")}return n},is.removed=function(){var e=this[0];return e&&e._private.removed},is.inside=function(){var e=this[0];return e&&!e._private.removed},is.remove=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=this,i=[],n={},s=a._private.cy;function r(e){for(var t=e._private.edges,a=0;a<t.length;a++)l(t[a])}function o(e){for(var t=e._private.children,a=0;a<t.length;a++)l(t[a])}function l(e){var a=n[e.id()];t&&e.removed()||a||(n[e.id()]=!0,e.isNode()?(i.push(e),r(e),o(e)):i.unshift(e))}for(var c=0,d=a.length;c<d;c++){var u=a[c];l(u)}function p(e,t){var a=e._private.edges;ge(a,t),e.clearTraversalCache()}function m(e){e.clearTraversalCache()}var b=[];function h(e,t){t=t[0];var a=(e=e[0])._private.children,i=e.id();ge(a,t),t._private.parent=null,b.ids[i]||(b.ids[i]=!0,b.push(e))}b.ids={},a.dirtyCompoundBoundsCache(),t&&s.removeFromPool(i);for(var f=0;f<i.length;f++){var g=i[f];if(g.isEdge()){var j=g.source()[0],x=g.target()[0];p(j,g),p(x,g);for(var v=g.parallelEdges(),y=0;y<v.length;y++){var O=v[y];m(O),O.isBundledBezier()&&O.dirtyBoundingBoxCache()}}else{var E=g.parent();0!==E.length&&h(E,g)}t&&(g._private.removed=!0)}var w=s._private.elements;s._private.hasCompoundNodes=!1;for(var _=0;_<w.length;_++){var S=w[_];if(S.isParent()){s._private.hasCompoundNodes=!0;break}}var M=new as(this.cy(),i);M.size()>0&&(e?M.emitAndNotify("remove"):t&&M.emit("remove"));for(var k=0;k<b.length;k++){var C=b[k];t&&C.removed()||C.updateStyle()}return M},is.move=function(e){var t=this._private.cy,a=this,i=!1,n=!1,s=function(e){return null==e?e:""+e};if(void 0!==e.source||void 0!==e.target){var r=s(e.source),o=s(e.target),l=null!=r&&t.hasElementWithId(r),c=null!=o&&t.hasElementWithId(o);(l||c)&&(t.batch((function(){a.remove(i,n),a.emitAndNotify("moveout");for(var e=0;e<a.length;e++){var t=a[e],s=t._private.data;t.isEdge()&&(l&&(s.source=r),c&&(s.target=o))}a.restore(i,n)})),a.emitAndNotify("move"))}else if(void 0!==e.parent){var d=s(e.parent);if(null===d||t.hasElementWithId(d)){var u=null===d?void 0:d;t.batch((function(){var e=a.remove(i,n);e.emitAndNotify("moveout");for(var t=0;t<a.length;t++){var s=a[t],r=s._private.data;s.isNode()&&(r.parent=u)}e.restore(i,n)})),a.emitAndNotify("move")}}return this},[Ma,Ja,Va,Si,Ti,Pi,Ni,pn,Mn,kn,{isNode:function(){return"nodes"===this.group()},isEdge:function(){return"edges"===this.group()},isLoop:function(){return this.isEdge()&&this.source()[0]===this.target()[0]},isSimple:function(){return this.isEdge()&&this.source()[0]!==this.target()[0]},group:function(){var e=this[0];if(e)return e._private.group}},Fn,Dn,Pn,qn,$n].forEach((function(e){N(is,e)}));var ns={add:function(e){var t,a=this;if(w(e)){var i=e;if(i._private.cy===a)t=i.restore();else{for(var n=[],s=0;s<i.length;s++){var r=i[s];n.push(r.json())}t=new as(a,n)}}else if(v(e)){t=new as(a,e)}else if(y(e)&&(v(e.nodes)||v(e.edges))){for(var o=e,l=[],c=["nodes","edges"],d=0,u=c.length;d<u;d++){var p=c[d],m=o[p];if(v(m))for(var b=0,h=m.length;b<h;b++){var f=N({group:p},m[b]);l.push(f)}}t=new as(a,l)}else{t=new we(a,e).collection()}return t},remove:function(e){if(w(e));else if(j(e)){var t=e;e=this.$(t)}return e.remove()}};
/*! Bezier curve function generator. Copyright Gaetan Renaudeau. MIT License: http://en.wikipedia.org/wiki/MIT_License */
/*! Runge-Kutta spring physics function generator. Adapted from Framer.js, copyright Koen Bok. MIT License: http://en.wikipedia.org/wiki/MIT_License */
var ss=function(){function e(e){return-e.tension*e.x-e.friction*e.v}function t(t,a,i){var n={x:t.x+i.dx*a,v:t.v+i.dv*a,tension:t.tension,friction:t.friction};return{dx:n.v,dv:e(n)}}function a(a,i){var n={dx:a.v,dv:e(a)},s=t(a,.5*i,n),r=t(a,.5*i,s),o=t(a,i,r),l=1/6*(n.dx+2*(s.dx+r.dx)+o.dx),c=1/6*(n.dv+2*(s.dv+r.dv)+o.dv);return a.x=a.x+l*i,a.v=a.v+c*i,a}return function e(t,i,n){var s,r,o,l={x:-1,v:0,tension:null,friction:null},c=[0],d=0,u=1e-4;for(t=parseFloat(t)||500,i=parseFloat(i)||20,n=n||null,l.tension=t,l.friction=i,r=(s=null!==n)?(d=e(t,i))/n*.016:.016;o=a(o||l,r),c.push(1+o.x),d+=16,Math.abs(o.x)>u&&Math.abs(o.v)>u;);return s?function(e){return c[e*(c.length-1)|0]}:d}}(),rs=function(e,t,a,i){var n=function(e,t,a,i){var n=4,s=.001,r=1e-7,o=10,l=11,c=1/(l-1),d="undefined"!=typeof Float32Array;if(4!==arguments.length)return!1;for(var u=0;u<4;++u)if("number"!=typeof arguments[u]||isNaN(arguments[u])||!isFinite(arguments[u]))return!1;e=Math.min(e,1),a=Math.min(a,1),e=Math.max(e,0),a=Math.max(a,0);var p=d?new Float32Array(l):new Array(l);function m(e,t){return 1-3*t+3*e}function b(e,t){return 3*t-6*e}function h(e){return 3*e}function f(e,t,a){return((m(t,a)*e+b(t,a))*e+h(t))*e}function g(e,t,a){return 3*m(t,a)*e*e+2*b(t,a)*e+h(t)}function j(t,i){for(var s=0;s<n;++s){var r=g(i,e,a);if(0===r)return i;i-=(f(i,e,a)-t)/r}return i}function x(){for(var t=0;t<l;++t)p[t]=f(t*c,e,a)}function v(t,i,n){var s,l,c=0;do{(s=f(l=i+(n-i)/2,e,a)-t)>0?n=l:i=l}while(Math.abs(s)>r&&++c<o);return l}function y(t){for(var i=0,n=1,r=l-1;n!==r&&p[n]<=t;++n)i+=c;--n;var o=i+(t-p[n])/(p[n+1]-p[n])*c,d=g(o,e,a);return d>=s?j(t,o):0===d?o:v(t,i,i+c)}var O=!1;function E(){O=!0,e===t&&a===i||x()}var w=function(n){return O||E(),e===t&&a===i?n:0===n?0:1===n?1:f(y(n),t,i)};w.getControlPoints=function(){return[{x:e,y:t},{x:a,y:i}]};var _="generateBezier("+[e,t,a,i]+")";return w.toString=function(){return _},w}(e,t,a,i);return function(e,t,a){return e+(t-e)*n(a)}},os={linear:function(e,t,a){return e+(t-e)*a},ease:rs(.25,.1,.25,1),"ease-in":rs(.42,0,1,1),"ease-out":rs(0,0,.58,1),"ease-in-out":rs(.42,0,.58,1),"ease-in-sine":rs(.47,0,.745,.715),"ease-out-sine":rs(.39,.575,.565,1),"ease-in-out-sine":rs(.445,.05,.55,.95),"ease-in-quad":rs(.55,.085,.68,.53),"ease-out-quad":rs(.25,.46,.45,.94),"ease-in-out-quad":rs(.455,.03,.515,.955),"ease-in-cubic":rs(.55,.055,.675,.19),"ease-out-cubic":rs(.215,.61,.355,1),"ease-in-out-cubic":rs(.645,.045,.355,1),"ease-in-quart":rs(.895,.03,.685,.22),"ease-out-quart":rs(.165,.84,.44,1),"ease-in-out-quart":rs(.77,0,.175,1),"ease-in-quint":rs(.755,.05,.855,.06),"ease-out-quint":rs(.23,1,.32,1),"ease-in-out-quint":rs(.86,0,.07,1),"ease-in-expo":rs(.95,.05,.795,.035),"ease-out-expo":rs(.19,1,.22,1),"ease-in-out-expo":rs(1,0,0,1),"ease-in-circ":rs(.6,.04,.98,.335),"ease-out-circ":rs(.075,.82,.165,1),"ease-in-out-circ":rs(.785,.135,.15,.86),spring:function(e,t,a){if(0===a)return os.linear;var i=ss(e,t,a);return function(e,t,a){return e+(t-e)*i(a)}},"cubic-bezier":rs};function ls(e,t,a,i,n){if(1===i)return a;var s=n(t,a,i);return null==e||((e.roundValue||e.color)&&(s=Math.round(s)),void 0!==e.min&&(s=Math.max(s,e.min)),void 0!==e.max&&(s=Math.min(s,e.max))),s}function cs(e,t){return null!=e.pfValue||null!=e.value?null==e.pfValue||null!=t&&"%"===t.type.units?e.value:e.pfValue:e}function ds(e,t,a,i,n){var s=null!=n?n.type:null;a<0?a=0:a>1&&(a=1);var r=cs(e,n),o=cs(t,n);if(O(r)&&O(o))return ls(s,r,o,a,i);if(v(r)&&v(o)){for(var l=[],c=0;c<o.length;c++){var d=r[c],u=o[c];if(null!=d&&null!=u){var p=ls(s,d,u,a,i);l.push(p)}else l.push(u)}return l}}function us(e,t,a,i){var n=!i,s=e._private,r=t._private,o=r.easing,l=r.startTime,c=(i?e:e.cy()).style();if(!r.easingImpl)if(null==o)r.easingImpl=os.linear;else{var d,u,p;if(j(o))d=c.parse("transition-timing-function",o).value;else d=o;j(d)?(u=d,p=[]):(u=d[1],p=d.slice(2).map((function(e){return+e}))),p.length>0?("spring"===u&&p.push(r.duration),r.easingImpl=os[u].apply(null,p)):r.easingImpl=os[u]}var m,b=r.easingImpl;if(m=0===r.duration?1:(a-l)/r.duration,r.applying&&(m=r.progress),m<0?m=0:m>1&&(m=1),null==r.delay){var h=r.startPosition,f=r.position;if(f&&n&&!e.locked()){var g={};ps(h.x,f.x)&&(g.x=ds(h.x,f.x,m,b)),ps(h.y,f.y)&&(g.y=ds(h.y,f.y,m,b)),e.position(g)}var x=r.startPan,v=r.pan,y=s.pan,O=null!=v&&i;O&&(ps(x.x,v.x)&&(y.x=ds(x.x,v.x,m,b)),ps(x.y,v.y)&&(y.y=ds(x.y,v.y,m,b)),e.emit("pan"));var E=r.startZoom,w=r.zoom,_=null!=w&&i;_&&(ps(E,w)&&(s.zoom=Qe(s.minZoom,ds(E,w,m,b),s.maxZoom)),e.emit("zoom")),(O||_)&&e.emit("viewport");var S=r.style;if(S&&S.length>0&&n){for(var M=0;M<S.length;M++){var k=S[M],C=k.name,T=k,F=r.startStyle[C],I=ds(F,T,m,b,c.properties[F.name]);c.overrideBypass(e,C,I)}e.emit("style")}}return r.progress=m,m}function ps(e,t){return null!=e&&null!=t&&(!(!O(e)||!O(t))||!(!e||!t))}function ms(e,t,a,i){var n=t._private;n.started=!0,n.startTime=a-n.progress*n.duration}function bs(e,t){var a=t._private.aniEles,i=[];function n(t,a){var n=t._private,s=n.animation.current,r=n.animation.queue,o=!1;if(!a&&"none"===t.pstyle("display").value){s=s.splice(0,s.length).concat(r.splice(0,r.length));for(var l=0;l<s.length;l++)s[l].stop()}if(0===s.length){var c=r.shift();c&&s.push(c)}for(var d=function(e){for(var t=e.length-1;t>=0;t--){(0,e[t])()}e.splice(0,e.length)},u=s.length-1;u>=0;u--){var p=s[u],m=p._private;m.stopped?(s.splice(u,1),m.hooked=!1,m.playing=!1,m.started=!1,d(m.frames)):(m.playing||m.applying)&&(m.playing&&m.applying&&(m.applying=!1),m.started||ms(0,p,e),us(t,p,e,a),m.applying&&(m.applying=!1),d(m.frames),null!=m.step&&m.step(e),p.completed()&&(s.splice(u,1),m.hooked=!1,m.playing=!1,m.started=!1,d(m.completes)),o=!0)}return a||0!==s.length||0!==r.length||i.push(t),o}for(var s=!1,r=0;r<a.length;r++){var o=n(a[r]);s=s||o}var l=n(t,!0);(s||l)&&(a.length>0?t.notify("draw",a):t.notify("draw")),a.unmerge(i),t.emit("step")}var hs={animate:Ba.animate(),animation:Ba.animation(),animated:Ba.animated(),clearQueue:Ba.clearQueue(),delay:Ba.delay(),delayAnimation:Ba.delayAnimation(),stop:Ba.stop(),addToAnimationPool:function(e){this.styleEnabled()&&this._private.aniEles.merge(e)},stopAnimationLoop:function(){this._private.animationsRunning=!1},startAnimationLoop:function(){var e=this;if(e._private.animationsRunning=!0,e.styleEnabled()){var t=e.renderer();t&&t.beforeRender?t.beforeRender((function(t,a){bs(a,e)}),t.beforeRenderPriorities.animations):function t(){e._private.animationsRunning&&H((function(a){bs(a,e),t()}))}()}}},fs={qualifierCompare:function(e,t){return null==e||null==t?null==e&&null==t:e.sameText(t)},eventMatches:function(e,t,a){var i=t.qualifier;return null==i||e!==a.target&&_(a.target)&&i.matches(a.target)},addEventFields:function(e,t){t.cy=e,t.target=e},callbackContext:function(e,t,a){return null!=t.qualifier?a.target:e}},gs=function(e){return j(e)?new wi(e):e},js={createEmitter:function(){var e=this._private;return e.emitter||(e.emitter=new vn(fs,this)),this},emitter:function(){return this._private.emitter},on:function(e,t,a){return this.emitter().on(e,gs(t),a),this},removeListener:function(e,t,a){return this.emitter().removeListener(e,gs(t),a),this},removeAllListeners:function(){return this.emitter().removeAllListeners(),this},one:function(e,t,a){return this.emitter().one(e,gs(t),a),this},once:function(e,t,a){return this.emitter().one(e,gs(t),a),this},emit:function(e,t){return this.emitter().emit(e,t),this},emitAndNotify:function(e,t){return this.emit(e),this.notify(e,t),this}};Ba.eventAliasesOn(js);var xs={png:function(e){return e=e||{},this._private.renderer.png(e)},jpg:function(e){var t=this._private.renderer;return(e=e||{}).bg=e.bg||"#fff",t.jpg(e)}};xs.jpeg=xs.jpg;var vs={layout:function(e){var t=this;if(null!=e)if(null!=e.name){var a=e.name,i=t.extension("layout",a);if(null!=i){var n;n=j(e.eles)?t.$(e.eles):null!=e.eles?e.eles:t.$();var s=new i(N({},e,{cy:t,eles:n}));return s}ce("No such layout `"+a+"` found.  Did you forget to import it and `cytoscape.use()` it?")}else ce("A `name` must be specified to make a layout");else ce("Layout options must be specified to make a layout")}};vs.createLayout=vs.makeLayout=vs.layout;var ys={notify:function(e,t){var a=this._private;if(this.batching()){a.batchNotifications=a.batchNotifications||{};var i=a.batchNotifications[e]=a.batchNotifications[e]||this.collection();null!=t&&i.merge(t)}else if(a.notificationsEnabled){var n=this.renderer();!this.destroyed()&&n&&n.notify(e,t)}},notifications:function(e){var t=this._private;return void 0===e?t.notificationsEnabled:(t.notificationsEnabled=!!e,this)},noNotifications:function(e){this.notifications(!1),e(),this.notifications(!0)},batching:function(){return this._private.batchCount>0},startBatch:function(){var e=this._private;return null==e.batchCount&&(e.batchCount=0),0===e.batchCount&&(e.batchStyleEles=this.collection(),e.batchNotifications={}),e.batchCount++,this},endBatch:function(){var e=this._private;if(0===e.batchCount)return this;if(e.batchCount--,0===e.batchCount){e.batchStyleEles.updateStyle();var t=this.renderer();Object.keys(e.batchNotifications).forEach((function(a){var i=e.batchNotifications[a];i.empty()?t.notify(a):t.notify(a,i)}))}return this},batch:function(e){return this.startBatch(),e(),this.endBatch(),this},batchData:function(e){var t=this;return this.batch((function(){for(var a=Object.keys(e),i=0;i<a.length;i++){var n=a[i],s=e[n];t.getElementById(n).data(s)}}))}},Os=fe({hideEdgesOnViewport:!1,textureOnViewport:!1,motionBlur:!1,motionBlurOpacity:.05,pixelRatio:void 0,desktopTapThreshold:4,touchTapThreshold:8,wheelSensitivity:1,debug:!1,showFps:!1}),Es={renderTo:function(e,t,a,i){return this._private.renderer.renderTo(e,t,a,i),this},renderer:function(){return this._private.renderer},forceRender:function(){return this.notify("draw"),this},resize:function(){return this.invalidateSize(),this.emitAndNotify("resize"),this},initRenderer:function(e){var t=this,a=t.extension("renderer",e.name);if(null!=a){void 0!==e.wheelSensitivity&&ue("You have set a custom wheel sensitivity.  This will make your app zoom unnaturally when using mainstream mice.  You should change this value from the default only if you can guarantee that all your users will use the same hardware and OS configuration as your current machine.");var i=Os(e);i.cy=t,t._private.renderer=new a(i),this.notify("init")}else ce("Can not initialise: No such renderer `".concat(e.name,"` found. Did you forget to import it and `cytoscape.use()` it?"))},destroyRenderer:function(){var e=this;e.notify("destroy");var t=e.container();if(t)for(t._cyreg=null;t.childNodes.length>0;)t.removeChild(t.childNodes[0]);e._private.renderer=null,e.mutableElements().forEach((function(e){var t=e._private;t.rscratch={},t.rstyle={},t.animation.current=[],t.animation.queue=[]}))},onRender:function(e){return this.on("render",e)},offRender:function(e){return this.off("render",e)}};Es.invalidateDimensions=Es.resize;var ws={collection:function(e,t){return j(e)?this.$(e):w(e)?e.collection():v(e)?new as(this,e,t):new as(this)},nodes:function(e){var t=this.$((function(e){return e.isNode()}));return e?t.filter(e):t},edges:function(e){var t=this.$((function(e){return e.isEdge()}));return e?t.filter(e):t},$:function(e){var t=this._private.elements;return e?t.filter(e):t.spawnSelf()},mutableElements:function(){return this._private.elements}};ws.elements=ws.filter=ws.$;var _s={},Ss="t";_s.apply=function(e){var t=this,a=t._private,i=a.cy.collection();a.newStyle&&(a.contextStyles={},a.propDiffs={},t.cleanElements(e,!0));for(var n=0;n<e.length;n++){var s=e[n],r=t.getContextMeta(s);if(!r.empty){var o=t.getContextStyle(r),l=t.applyContextStyle(r,o,s);a.newStyle||t.updateTransitions(s,l.diffProps),t.updateStyleHints(s)&&i.merge(s)}}return a.newStyle=!1,i},_s.getPropertiesDiff=function(e,t){var a=this,i=a._private.propDiffs=a._private.propDiffs||{},n=e+"-"+t,s=i[n];if(s)return s;for(var r=[],o={},l=0;l<a.length;l++){var c=a[l],d=e[l]===Ss,u=t[l]===Ss,p=d!==u,m=c.mappedProperties.length>0;if(p||u&&m){var b=void 0;p&&m||p?b=c.properties:m&&(b=c.mappedProperties);for(var h=0;h<b.length;h++){for(var f=b[h],g=f.name,j=!1,x=l+1;x<a.length;x++){var v=a[x];if(t[x]===Ss&&(j=null!=v.properties[f.name]))break}o[g]||j||(o[g]=!0,r.push(g))}}}return i[n]=r,r},_s.getContextMeta=function(e){var t,a=this,i="",n=e._private.styleCxtKey||"";a._private.newStyle&&(n="");for(var s=0;s<a.length;s++){var r=a[s];i+=r.selector&&r.selector.matches(e)?Ss:"f"}return t=a.getPropertiesDiff(n,i),e._private.styleCxtKey=i,{key:i,diffPropNames:t,empty:0===t.length}},_s.getContextStyle=function(e){var t=e.key,a=this._private.contextStyles=this._private.contextStyles||{};if(a[t])return a[t];for(var i={_private:{key:t}},n=0;n<this.length;n++){var s=this[n];if(t[n]===Ss)for(var r=0;r<s.properties.length;r++){var o=s.properties[r];i[o.name]=o}}return a[t]=i,i},_s.applyContextStyle=function(e,t,a){for(var i=e.diffPropNames,n={},s=this.types,r=0;r<i.length;r++){var o=i[r],l=t[o],c=a.pstyle(o);if(!l){if(!c)continue;l=c.bypass?{name:o,deleteBypassed:!0}:{name:o,delete:!0}}if(c!==l){if(l.mapped===s.fn&&null!=c&&null!=c.mapping&&c.mapping.value===l.value){var d=c.mapping;if((d.fnValue=l.value(a))===d.prevFnValue)continue}var u=n[o]={prev:c};this.applyParsedProperty(a,l),u.next=a.pstyle(o),u.next&&u.next.bypass&&(u.next=u.next.bypassed)}}return{diffProps:n}},_s.updateStyleHints=function(e){var t=e._private,a=this,i=a.propertyGroupNames,n=a.propertyGroupKeys,s=function(e,t,i){return a.getPropertiesHash(e,t,i)},r=t.styleKey;if(e.removed())return!1;var o="nodes"===t.group,l=e._private.style;i=Object.keys(l);for(var c=0;c<n.length;c++){var d=n[c];t.styleKeys[d]=0}for(var u=function(e,a){return t.styleKeys[a]=X(e,t.styleKeys[a])},p=function(e,t){for(var a=0;a<e.length;a++)u(e.charCodeAt(a),t)},m=function(e){return-128<e&&e<128&&Math.floor(e)!==e?2e9-(1024*e|0):e},b=0;b<i.length;b++){var h=i[b],f=l[h];if(null!=f){var g=this.properties[h],j=g.type,x=g.groupKey,v=void 0;null!=g.hashOverride?v=g.hashOverride(e,f):null!=f.pfValue&&(v=f.pfValue);var y=null==g.enums?f.value:null,O=null!=v,E=O||null!=y,w=f.units;if(j.number&&E){var _=O?v:y;if(j.multiple)for(var S=0;S<_.length;S++)u(m(_[S]),x);else u(m(_),x);O||null==w||p(w,x)}else p(f.strValue,x)}}for(var M=0,k=0;k<n.length;k++){var C=n[k],T=t.styleKeys[C];M=X(T,M)}t.styleKey=M;var F=t.labelDimsKey=t.styleKeys.labelDimensions;if(t.labelKey=s(e,["label"],F),t.labelStyleKey=X(t.styleKeys.commonLabel,t.labelKey),o||(t.sourceLabelKey=s(e,["source-label"],F),t.sourceLabelStyleKey=X(t.styleKeys.commonLabel,t.sourceLabelKey),t.targetLabelKey=s(e,["target-label"],F),t.targetLabelStyleKey=X(t.styleKeys.commonLabel,t.targetLabelKey)),o){var I=t.styleKeys,D=I.nodeBody,A=I.nodeBorder,L=I.backgroundImage,R=I.compound,P=I.pie;t.nodeKey=Q([A,L,R,P],D),t.hasPie=0!=P}return r!==t.styleKey},_s.clearStyleHints=function(e){var t=e._private;t.styleKeys={},t.styleKey=null,t.labelKey=null,t.labelStyleKey=null,t.sourceLabelKey=null,t.sourceLabelStyleKey=null,t.targetLabelKey=null,t.targetLabelStyleKey=null,t.nodeKey=null,t.hasPie=null},_s.applyParsedProperty=function(e,t){var a,i=this,n=t,s=e._private.style,r=i.types,o=i.properties[n.name].type,l=n.bypass,c=s[n.name],d=c&&c.bypass,u=e._private,p="mapping",m=function(e){return null==e?null:null!=e.pfValue?e.pfValue:e.value},b=function(){var t=m(c),a=m(n);i.checkTriggers(e,n.name,t,a)};if("curve-style"===t.name&&e.isEdge()&&("bezier"!==t.value&&e.isLoop()||"haystack"===t.value&&(e.source().isParent()||e.target().isParent()))&&(n=t=this.parse(t.name,"bezier",l)),n.delete)return s[n.name]=void 0,b(),!0;if(n.deleteBypassed)return c?!!c.bypass&&(c.bypassed=void 0,b(),!0):(b(),!0);if(n.deleteBypass)return c?!!c.bypass&&(s[n.name]=c.bypassed,b(),!0):(b(),!0);var h=function(){ue("Do not assign mappings to elements without corresponding data (i.e. ele `"+e.id()+"` has no mapping for property `"+n.name+"` with data field `"+n.field+"`); try a `["+n.field+"]` selector to limit scope to elements with `"+n.field+"` defined")};switch(n.mapped){case r.mapData:for(var f,g=n.field.split("."),j=u.data,x=0;x<g.length&&j;x++){j=j[g[x]]}if(null==j)return h(),!1;if(!O(j))return ue("Do not use continuous mappers without specifying numeric data (i.e. `"+n.field+": "+j+"` for `"+e.id()+"` is non-numeric)"),!1;var v=n.fieldMax-n.fieldMin;if((f=0===v?0:(j-n.fieldMin)/v)<0?f=0:f>1&&(f=1),o.color){var y=n.valueMin[0],E=n.valueMax[0],w=n.valueMin[1],_=n.valueMax[1],S=n.valueMin[2],M=n.valueMax[2],k=null==n.valueMin[3]?1:n.valueMin[3],C=null==n.valueMax[3]?1:n.valueMax[3],T=[Math.round(y+(E-y)*f),Math.round(w+(_-w)*f),Math.round(S+(M-S)*f),Math.round(k+(C-k)*f)];a={bypass:n.bypass,name:n.name,value:T,strValue:"rgb("+T[0]+", "+T[1]+", "+T[2]+")"}}else{if(!o.number)return!1;var F=n.valueMin+(n.valueMax-n.valueMin)*f;a=this.parse(n.name,F,n.bypass,p)}if(!a)return h(),!1;a.mapping=n,n=a;break;case r.data:for(var I=n.field.split("."),D=u.data,A=0;A<I.length&&D;A++){D=D[I[A]]}if(null!=D&&(a=this.parse(n.name,D,n.bypass,p)),!a)return h(),!1;a.mapping=n,n=a;break;case r.fn:var L=n.value,R=null!=n.fnValue?n.fnValue:L(e);if(n.prevFnValue=R,null==R)return ue("Custom function mappers may not return null (i.e. `"+n.name+"` for ele `"+e.id()+"` is null)"),!1;if(!(a=this.parse(n.name,R,n.bypass,p)))return ue("Custom function mappers may not return invalid values for the property type (i.e. `"+n.name+"` for ele `"+e.id()+"` is invalid)"),!1;a.mapping=pe(n),n=a;break;case void 0:break;default:return!1}return l?(n.bypassed=d?c.bypassed:c,s[n.name]=n):d?c.bypassed=n:s[n.name]=n,b(),!0},_s.cleanElements=function(e,t){for(var a=0;a<e.length;a++){var i=e[a];if(this.clearStyleHints(i),i.dirtyCompoundBoundsCache(),i.dirtyBoundingBoxCache(),t)for(var n=i._private.style,s=Object.keys(n),r=0;r<s.length;r++){var o=s[r],l=n[o];null!=l&&(l.bypass?l.bypassed=null:n[o]=null)}else i._private.style={}}},_s.update=function(){this._private.cy.mutableElements().updateStyle()},_s.updateTransitions=function(e,t){var a=this,i=e._private,n=e.pstyle("transition-property").value,s=e.pstyle("transition-duration").pfValue,r=e.pstyle("transition-delay").pfValue;if(n.length>0&&s>0){for(var o={},l=!1,c=0;c<n.length;c++){var d=n[c],u=e.pstyle(d),p=t[d];if(p){var m=p.prev,b=null!=p.next?p.next:u,h=!1,f=void 0,g=1e-6;m&&(O(m.pfValue)&&O(b.pfValue)?(h=b.pfValue-m.pfValue,f=m.pfValue+g*h):O(m.value)&&O(b.value)?(h=b.value-m.value,f=m.value+g*h):v(m.value)&&v(b.value)&&(h=m.value[0]!==b.value[0]||m.value[1]!==b.value[1]||m.value[2]!==b.value[2],f=m.strValue),h&&(o[d]=b.strValue,this.applyBypass(e,d,f),l=!0))}}if(!l)return;i.transitioning=!0,new Aa((function(t){r>0?e.delayAnimation(r).play().promise().then(t):t()})).then((function(){return e.animation({style:o,duration:s,easing:e.pstyle("transition-timing-function").value,queue:!1}).play().promise()})).then((function(){a.removeBypasses(e,n),e.emitAndNotify("style"),i.transitioning=!1}))}else i.transitioning&&(this.removeBypasses(e,n),e.emitAndNotify("style"),i.transitioning=!1)},_s.checkTrigger=function(e,t,a,i,n,s){var r=this.properties[t],o=n(r);null!=o&&o(a,i)&&s(r)},_s.checkZOrderTrigger=function(e,t,a,i){var n=this;this.checkTrigger(e,t,a,i,(function(e){return e.triggersZOrder}),(function(){n._private.cy.notify("zorder",e)}))},_s.checkBoundsTrigger=function(e,t,a,i){this.checkTrigger(e,t,a,i,(function(e){return e.triggersBounds}),(function(n){e.dirtyCompoundBoundsCache(),e.dirtyBoundingBoxCache(),"bezier"!==e.pstyle("curve-style").value&&("curve-style"!==t||"bezier"!==a&&"bezier"!==i)||!n.triggersBoundsOfParallelBeziers||e.parallelEdges().forEach((function(e){e.isBundledBezier()&&e.dirtyBoundingBoxCache()}))}))},_s.checkTriggers=function(e,t,a,i){e.dirtyStyleCache(),this.checkZOrderTrigger(e,t,a,i),this.checkBoundsTrigger(e,t,a,i)};var Ms={applyBypass:function(e,t,a,i){var n=[];if("*"===t||"**"===t){if(void 0!==a)for(var s=0;s<this.properties.length;s++){var r=this.properties[s].name,o=this.parse(r,a,!0);o&&n.push(o)}}else if(j(t)){var l=this.parse(t,a,!0);l&&n.push(l)}else{if(!y(t))return!1;var c=t;i=a;for(var d=Object.keys(c),u=0;u<d.length;u++){var p=d[u],m=c[p];if(void 0===m&&(m=c[D(p)]),void 0!==m){var b=this.parse(p,m,!0);b&&n.push(b)}}}if(0===n.length)return!1;for(var h=!1,f=0;f<e.length;f++){for(var g=e[f],x={},v=void 0,O=0;O<n.length;O++){var E=n[O];if(i){var w=g.pstyle(E.name);v=x[E.name]={prev:w}}h=this.applyParsedProperty(g,E)||h,i&&(v.next=g.pstyle(E.name))}h&&this.updateStyleHints(g),i&&this.updateTransitions(g,x,true)}return h},overrideBypass:function(e,t,a){t=I(t);for(var i=0;i<e.length;i++){var n=e[i],s=n._private.style[t],r=this.properties[t].type,o=r.color,l=r.mutiple,c=s?null!=s.pfValue?s.pfValue:s.value:null;s&&s.bypass?(s.value=a,null!=s.pfValue&&(s.pfValue=a),s.strValue=o?"rgb("+a.join(",")+")":l?a.join(" "):""+a,this.updateStyleHints(n)):this.applyBypass(n,t,a),this.checkTriggers(n,t,c,a)}},removeAllBypasses:function(e,t){return this.removeBypasses(e,this.propertyNames,t)},removeBypasses:function(e,t,a){for(var i=0;i<e.length;i++){for(var n=e[i],s={},r=0;r<t.length;r++){var o=t[r],l=this.properties[o],c=n.pstyle(l.name);if(c&&c.bypass){var d=this.parse(o,"",!0),u=s[l.name]={prev:c};this.applyParsedProperty(n,d),u.next=n.pstyle(l.name)}}this.updateStyleHints(n),a&&this.updateTransitions(n,s,true)}}},ks={getEmSizeInPixels:function(){var e=this.containerCss("font-size");return null!=e?parseFloat(e):1},containerCss:function(e){var t=this._private.cy.container();if(u&&t&&u.getComputedStyle)return u.getComputedStyle(t).getPropertyValue(e)}},Cs={getRenderedStyle:function(e,t){return t?this.getStylePropertyValue(e,t,!0):this.getRawStyle(e,!0)},getRawStyle:function(e,t){var a=this;if(e=e[0]){for(var i={},n=0;n<a.properties.length;n++){var s=a.properties[n],r=a.getStylePropertyValue(e,s.name,t);null!=r&&(i[s.name]=r,i[D(s.name)]=r)}return i}},getIndexedStyle:function(e,t,a,i){var n=e.pstyle(t)[a][i];return null!=n?n:e.cy().style().getDefaultProperty(t)[a][0]},getStylePropertyValue:function(e,t,a){if(e=e[0]){var i=this.properties[t];i.alias&&(i=i.pointsTo);var n=i.type,s=e.pstyle(i.name);if(s){var r=s.value,o=s.units,l=s.strValue;if(a&&n.number&&null!=r&&O(r)){var c=e.cy().zoom(),d=function(e){return e*c},u=function(e,t){return d(e)+t},p=v(r);return(p?o.every((function(e){return null!=e})):null!=o)?p?r.map((function(e,t){return u(e,o[t])})).join(" "):u(r,o):p?r.map((function(e){return j(e)?e:""+d(e)})).join(" "):""+d(r)}if(null!=l)return l}return null}},getAnimationStartStyle:function(e,t){for(var a={},i=0;i<t.length;i++){var n=t[i].name,s=e.pstyle(n);void 0!==s&&(s=y(s)?this.parse(n,s.strValue):this.parse(n,s)),s&&(a[n]=s)}return a},getPropsList:function(e){var t=[],a=e,i=this.properties;if(a)for(var n=Object.keys(a),s=0;s<n.length;s++){var r=n[s],o=a[r],l=i[r]||i[I(r)],c=this.parse(l.name,o);c&&t.push(c)}return t},getNonDefaultPropertiesHash:function(e,t,a){var i,n,s,r,o,l,c=a;for(o=0;o<t.length;o++)if(i=t[o],null!=(n=e.pstyle(i,!1)))if(null!=n.pfValue)c=X(r,c);else for(s=n.strValue,l=0;l<s.length;l++)r=s.charCodeAt(l),c=X(r,c);return c}};Cs.getPropertiesHash=Cs.getNonDefaultPropertiesHash;var Ts={appendFromJson:function(e){for(var t=this,a=0;a<e.length;a++){var i=e[a],n=i.selector,s=i.style||i.css,r=Object.keys(s);t.selector(n);for(var o=0;o<r.length;o++){var l=r[o],c=s[l];t.css(l,c)}}return t},fromJson:function(e){var t=this;return t.resetToDefault(),t.appendFromJson(e),t},json:function(){for(var e=[],t=this.defaultLength;t<this.length;t++){for(var a=this[t],i=a.selector,n=a.properties,s={},r=0;r<n.length;r++){var o=n[r];s[o.name]=o.strValue}e.push({selector:i?i.toString():"core",style:s})}return e}},Fs={appendFromString:function(e){var t,a,i,n=this,s=""+e;function r(){s=s.length>t.length?s.substr(t.length):""}function o(){a=a.length>i.length?a.substr(i.length):""}for(s=s.replace(/[/][*](\s|.)+?[*][/]/g,"");;){if(s.match(/^\s*$/))break;var l=s.match(/^\s*((?:.|\s)+?)\s*\{((?:.|\s)+?)\}/);if(!l){ue("Halting stylesheet parsing: String stylesheet contains more to parse but no selector and block found in: "+s);break}t=l[0];var c=l[1];if("core"!==c)if(new wi(c).invalid){ue("Skipping parsing of block: Invalid selector found in string stylesheet: "+c),r();continue}var d=l[2],u=!1;a=d;for(var p=[];;){if(a.match(/^\s*$/))break;var m=a.match(/^\s*(.+?)\s*:\s*(.+?)\s*;/);if(!m){ue("Skipping parsing of block: Invalid formatting of style property and value definitions found in:"+d),u=!0;break}i=m[0];var b=m[1],h=m[2];if(this.properties[b])n.parse(b,h)?(p.push({name:b,val:h}),o()):(ue("Skipping property: Invalid property definition in: "+i),o());else ue("Skipping property: Invalid property name in: "+i),o()}if(u){r();break}n.selector(c);for(var f=0;f<p.length;f++){var g=p[f];n.css(g.name,g.val)}r()}return n},fromString:function(e){var t=this;return t.resetToDefault(),t.appendFromString(e),t}},Is={};!function(){var e=R,t=function(e){return"^"+e+"\\s*\\(\\s*([\\w\\.]+)\\s*\\)$"},a=function(t){var a=e+"|\\w+|rgb[a]?\\((?:(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))[%]?)\\s*,\\s*(?:(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))[%]?)\\s*,\\s*(?:(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))[%]?)(?:\\s*,\\s*(?:(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))))?\\)|hsl[a]?\\((?:(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?)))\\s*,\\s*(?:(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))[%])\\s*,\\s*(?:(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))[%])(?:\\s*,\\s*(?:(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))))?\\)|\\#[0-9a-fA-F]{3}|\\#[0-9a-fA-F]{6}";return"^"+t+"\\s*\\(([\\w\\.]+)\\s*\\,\\s*("+e+")\\s*\\,\\s*("+e+")\\s*,\\s*("+a+")\\s*\\,\\s*("+a+")\\)$"},i=["^url\\s*\\(\\s*['\"]?(.+?)['\"]?\\s*\\)$","^(none)$","^(.+)$"];Is.types={time:{number:!0,min:0,units:"s|ms",implicitUnits:"ms"},percent:{number:!0,min:0,max:100,units:"%",implicitUnits:"%"},percentages:{number:!0,min:0,max:100,units:"%",implicitUnits:"%",multiple:!0},zeroOneNumber:{number:!0,min:0,max:1,unitless:!0},zeroOneNumbers:{number:!0,min:0,max:1,unitless:!0,multiple:!0},nOneOneNumber:{number:!0,min:-1,max:1,unitless:!0},nonNegativeInt:{number:!0,min:0,integer:!0,unitless:!0},position:{enums:["parent","origin"]},nodeSize:{number:!0,min:0,enums:["label"]},number:{number:!0,unitless:!0},numbers:{number:!0,unitless:!0,multiple:!0},positiveNumber:{number:!0,unitless:!0,min:0,strictMin:!0},size:{number:!0,min:0},bidirectionalSize:{number:!0},bidirectionalSizes:{number:!0,multiple:!0},sizeMaybePercent:{number:!0,min:0,allowPercent:!0},axisDirection:{enums:["horizontal","leftward","rightward","vertical","upward","downward","auto"]},paddingRelativeTo:{enums:["width","height","average","min","max"]},bgWH:{number:!0,min:0,allowPercent:!0,enums:["auto"],multiple:!0},bgPos:{number:!0,allowPercent:!0,multiple:!0},bgRelativeTo:{enums:["inner","include-padding"],multiple:!0},bgRepeat:{enums:["repeat","repeat-x","repeat-y","no-repeat"],multiple:!0},bgFit:{enums:["none","contain","cover"],multiple:!0},bgCrossOrigin:{enums:["anonymous","use-credentials"],multiple:!0},bgClip:{enums:["none","node"],multiple:!0},color:{color:!0},colors:{color:!0,multiple:!0},fill:{enums:["solid","linear-gradient","radial-gradient"]},bool:{enums:["yes","no"]},lineStyle:{enums:["solid","dotted","dashed"]},lineCap:{enums:["butt","round","square"]},borderStyle:{enums:["solid","dotted","dashed","double"]},curveStyle:{enums:["bezier","unbundled-bezier","haystack","segments","straight","taxi"]},fontFamily:{regex:'^([\\w- \\"]+(?:\\s*,\\s*[\\w- \\"]+)*)$'},fontStyle:{enums:["italic","normal","oblique"]},fontWeight:{enums:["normal","bold","bolder","lighter","100","200","300","400","500","600","800","900",100,200,300,400,500,600,700,800,900]},textDecoration:{enums:["none","underline","overline","line-through"]},textTransform:{enums:["none","uppercase","lowercase"]},textWrap:{enums:["none","wrap","ellipsis"]},textOverflowWrap:{enums:["whitespace","anywhere"]},textBackgroundShape:{enums:["rectangle","roundrectangle","round-rectangle"]},nodeShape:{enums:["rectangle","roundrectangle","round-rectangle","cutrectangle","cut-rectangle","bottomroundrectangle","bottom-round-rectangle","barrel","ellipse","triangle","square","pentagon","hexagon","concavehexagon","concave-hexagon","heptagon","octagon","tag","star","diamond","vee","rhomboid","polygon"]},compoundIncludeLabels:{enums:["include","exclude"]},arrowShape:{enums:["tee","triangle","triangle-tee","triangle-cross","triangle-backcurve","vee","square","circle","diamond","chevron","none"]},arrowFill:{enums:["filled","hollow"]},display:{enums:["element","none"]},visibility:{enums:["hidden","visible"]},zCompoundDepth:{enums:["bottom","orphan","auto","top"]},zIndexCompare:{enums:["auto","manual"]},valign:{enums:["top","center","bottom"]},halign:{enums:["left","center","right"]},justification:{enums:["left","center","right","auto"]},text:{string:!0},data:{mapping:!0,regex:t("data")},layoutData:{mapping:!0,regex:t("layoutData")},scratch:{mapping:!0,regex:t("scratch")},mapData:{mapping:!0,regex:a("mapData")},mapLayoutData:{mapping:!0,regex:a("mapLayoutData")},mapScratch:{mapping:!0,regex:a("mapScratch")},fn:{mapping:!0,fn:!0},url:{regexes:i,singleRegexMatchValue:!0},urls:{regexes:i,singleRegexMatchValue:!0,multiple:!0},propList:{propList:!0},angle:{number:!0,units:"deg|rad",implicitUnits:"rad"},textRotation:{number:!0,units:"deg|rad",implicitUnits:"rad",enums:["none","autorotate"]},polygonPointList:{number:!0,multiple:!0,evenMultiple:!0,min:-1,max:1,unitless:!0},edgeDistances:{enums:["intersection","node-position"]},edgeEndpoint:{number:!0,multiple:!0,units:"%|px|em|deg|rad",implicitUnits:"px",enums:["inside-to-node","outside-to-node","outside-to-node-or-label","outside-to-line","outside-to-line-or-label"],singleEnum:!0,validate:function(e,t){switch(e.length){case 2:return"deg"!==t[0]&&"rad"!==t[0]&&"deg"!==t[1]&&"rad"!==t[1];case 1:return j(e[0])||"deg"===t[0]||"rad"===t[0];default:return!1}}},easing:{regexes:["^(spring)\\s*\\(\\s*("+e+")\\s*,\\s*("+e+")\\s*\\)$","^(cubic-bezier)\\s*\\(\\s*("+e+")\\s*,\\s*("+e+")\\s*,\\s*("+e+")\\s*,\\s*("+e+")\\s*\\)$"],enums:["linear","ease","ease-in","ease-out","ease-in-out","ease-in-sine","ease-out-sine","ease-in-out-sine","ease-in-quad","ease-out-quad","ease-in-out-quad","ease-in-cubic","ease-out-cubic","ease-in-out-cubic","ease-in-quart","ease-out-quart","ease-in-out-quart","ease-in-quint","ease-out-quint","ease-in-out-quint","ease-in-expo","ease-out-expo","ease-in-out-expo","ease-in-circ","ease-out-circ","ease-in-out-circ"]},gradientDirection:{enums:["to-bottom","to-top","to-left","to-right","to-bottom-right","to-bottom-left","to-top-right","to-top-left","to-right-bottom","to-left-bottom","to-right-top","to-left-top"]},boundsExpansion:{number:!0,multiple:!0,min:0,validate:function(e){var t=e.length;return 1===t||2===t||4===t}}};var n={zeroNonZero:function(e,t){return(null==e||null==t)&&e!==t||(0==e&&0!=t||0!=e&&0==t)},any:function(e,t){return e!=t}},s=Is.types,r=[{name:"label",type:s.text,triggersBounds:n.any},{name:"text-rotation",type:s.textRotation,triggersBounds:n.any},{name:"text-margin-x",type:s.bidirectionalSize,triggersBounds:n.any},{name:"text-margin-y",type:s.bidirectionalSize,triggersBounds:n.any}],o=[{name:"source-label",type:s.text,triggersBounds:n.any},{name:"source-text-rotation",type:s.textRotation,triggersBounds:n.any},{name:"source-text-margin-x",type:s.bidirectionalSize,triggersBounds:n.any},{name:"source-text-margin-y",type:s.bidirectionalSize,triggersBounds:n.any},{name:"source-text-offset",type:s.size,triggersBounds:n.any}],l=[{name:"target-label",type:s.text,triggersBounds:n.any},{name:"target-text-rotation",type:s.textRotation,triggersBounds:n.any},{name:"target-text-margin-x",type:s.bidirectionalSize,triggersBounds:n.any},{name:"target-text-margin-y",type:s.bidirectionalSize,triggersBounds:n.any},{name:"target-text-offset",type:s.size,triggersBounds:n.any}],c=[{name:"font-family",type:s.fontFamily,triggersBounds:n.any},{name:"font-style",type:s.fontStyle,triggersBounds:n.any},{name:"font-weight",type:s.fontWeight,triggersBounds:n.any},{name:"font-size",type:s.size,triggersBounds:n.any},{name:"text-transform",type:s.textTransform,triggersBounds:n.any},{name:"text-wrap",type:s.textWrap,triggersBounds:n.any},{name:"text-overflow-wrap",type:s.textOverflowWrap,triggersBounds:n.any},{name:"text-max-width",type:s.size,triggersBounds:n.any},{name:"text-outline-width",type:s.size,triggersBounds:n.any},{name:"line-height",type:s.positiveNumber,triggersBounds:n.any}],d=[{name:"text-valign",type:s.valign,triggersBounds:n.any},{name:"text-halign",type:s.halign,triggersBounds:n.any},{name:"color",type:s.color},{name:"text-outline-color",type:s.color},{name:"text-outline-opacity",type:s.zeroOneNumber},{name:"text-background-color",type:s.color},{name:"text-background-opacity",type:s.zeroOneNumber},{name:"text-background-padding",type:s.size,triggersBounds:n.any},{name:"text-border-opacity",type:s.zeroOneNumber},{name:"text-border-color",type:s.color},{name:"text-border-width",type:s.size,triggersBounds:n.any},{name:"text-border-style",type:s.borderStyle,triggersBounds:n.any},{name:"text-background-shape",type:s.textBackgroundShape,triggersBounds:n.any},{name:"text-justification",type:s.justification}],u=[{name:"events",type:s.bool},{name:"text-events",type:s.bool}],p=[{name:"display",type:s.display,triggersZOrder:n.any,triggersBounds:n.any,triggersBoundsOfParallelBeziers:!0},{name:"visibility",type:s.visibility,triggersZOrder:n.any},{name:"opacity",type:s.zeroOneNumber,triggersZOrder:n.zeroNonZero},{name:"text-opacity",type:s.zeroOneNumber},{name:"min-zoomed-font-size",type:s.size},{name:"z-compound-depth",type:s.zCompoundDepth,triggersZOrder:n.any},{name:"z-index-compare",type:s.zIndexCompare,triggersZOrder:n.any},{name:"z-index",type:s.nonNegativeInt,triggersZOrder:n.any}],m=[{name:"overlay-padding",type:s.size,triggersBounds:n.any},{name:"overlay-color",type:s.color},{name:"overlay-opacity",type:s.zeroOneNumber,triggersBounds:n.zeroNonZero}],b=[{name:"transition-property",type:s.propList},{name:"transition-duration",type:s.time},{name:"transition-delay",type:s.time},{name:"transition-timing-function",type:s.easing}],h=function(e,t){return"label"===t.value?-e.poolIndex():t.pfValue},f=[{name:"height",type:s.nodeSize,triggersBounds:n.any,hashOverride:h},{name:"width",type:s.nodeSize,triggersBounds:n.any,hashOverride:h},{name:"shape",type:s.nodeShape,triggersBounds:n.any},{name:"shape-polygon-points",type:s.polygonPointList,triggersBounds:n.any},{name:"background-color",type:s.color},{name:"background-fill",type:s.fill},{name:"background-opacity",type:s.zeroOneNumber},{name:"background-blacken",type:s.nOneOneNumber},{name:"background-gradient-stop-colors",type:s.colors},{name:"background-gradient-stop-positions",type:s.percentages},{name:"background-gradient-direction",type:s.gradientDirection},{name:"padding",type:s.sizeMaybePercent,triggersBounds:n.any},{name:"padding-relative-to",type:s.paddingRelativeTo,triggersBounds:n.any},{name:"bounds-expansion",type:s.boundsExpansion,triggersBounds:n.any}],g=[{name:"border-color",type:s.color},{name:"border-opacity",type:s.zeroOneNumber},{name:"border-width",type:s.size,triggersBounds:n.any},{name:"border-style",type:s.borderStyle}],x=[{name:"background-image",type:s.urls},{name:"background-image-crossorigin",type:s.bgCrossOrigin},{name:"background-image-opacity",type:s.zeroOneNumbers},{name:"background-position-x",type:s.bgPos},{name:"background-position-y",type:s.bgPos},{name:"background-width-relative-to",type:s.bgRelativeTo},{name:"background-height-relative-to",type:s.bgRelativeTo},{name:"background-repeat",type:s.bgRepeat},{name:"background-fit",type:s.bgFit},{name:"background-clip",type:s.bgClip},{name:"background-width",type:s.bgWH},{name:"background-height",type:s.bgWH},{name:"background-offset-x",type:s.bgPos},{name:"background-offset-y",type:s.bgPos}],v=[{name:"position",type:s.position,triggersBounds:n.any},{name:"compound-sizing-wrt-labels",type:s.compoundIncludeLabels,triggersBounds:n.any},{name:"min-width",type:s.size,triggersBounds:n.any},{name:"min-width-bias-left",type:s.sizeMaybePercent,triggersBounds:n.any},{name:"min-width-bias-right",type:s.sizeMaybePercent,triggersBounds:n.any},{name:"min-height",type:s.size,triggersBounds:n.any},{name:"min-height-bias-top",type:s.sizeMaybePercent,triggersBounds:n.any},{name:"min-height-bias-bottom",type:s.sizeMaybePercent,triggersBounds:n.any}],y=[{name:"line-style",type:s.lineStyle},{name:"line-color",type:s.color},{name:"line-fill",type:s.fill},{name:"line-cap",type:s.lineCap},{name:"line-dash-pattern",type:s.numbers},{name:"line-dash-offset",type:s.number},{name:"line-gradient-stop-colors",type:s.colors},{name:"line-gradient-stop-positions",type:s.percentages},{name:"curve-style",type:s.curveStyle,triggersBounds:n.any,triggersBoundsOfParallelBeziers:!0},{name:"haystack-radius",type:s.zeroOneNumber,triggersBounds:n.any},{name:"source-endpoint",type:s.edgeEndpoint,triggersBounds:n.any},{name:"target-endpoint",type:s.edgeEndpoint,triggersBounds:n.any},{name:"control-point-step-size",type:s.size,triggersBounds:n.any},{name:"control-point-distances",type:s.bidirectionalSizes,triggersBounds:n.any},{name:"control-point-weights",type:s.numbers,triggersBounds:n.any},{name:"segment-distances",type:s.bidirectionalSizes,triggersBounds:n.any},{name:"segment-weights",type:s.numbers,triggersBounds:n.any},{name:"taxi-turn",type:s.sizeMaybePercent,triggersBounds:n.any},{name:"taxi-turn-min-distance",type:s.size,triggersBounds:n.any},{name:"taxi-direction",type:s.axisDirection,triggersBounds:n.any},{name:"edge-distances",type:s.edgeDistances,triggersBounds:n.any},{name:"arrow-scale",type:s.positiveNumber,triggersBounds:n.any},{name:"loop-direction",type:s.angle,triggersBounds:n.any},{name:"loop-sweep",type:s.angle,triggersBounds:n.any},{name:"source-distance-from-node",type:s.size,triggersBounds:n.any},{name:"target-distance-from-node",type:s.size,triggersBounds:n.any}],O=[{name:"ghost",type:s.bool,triggersBounds:n.any},{name:"ghost-offset-x",type:s.bidirectionalSize,triggersBounds:n.any},{name:"ghost-offset-y",type:s.bidirectionalSize,triggersBounds:n.any},{name:"ghost-opacity",type:s.zeroOneNumber}],E=[{name:"selection-box-color",type:s.color},{name:"selection-box-opacity",type:s.zeroOneNumber},{name:"selection-box-border-color",type:s.color},{name:"selection-box-border-width",type:s.size},{name:"active-bg-color",type:s.color},{name:"active-bg-opacity",type:s.zeroOneNumber},{name:"active-bg-size",type:s.size},{name:"outside-texture-bg-color",type:s.color},{name:"outside-texture-bg-opacity",type:s.zeroOneNumber}],w=[];Is.pieBackgroundN=16,w.push({name:"pie-size",type:s.sizeMaybePercent});for(var _=1;_<=Is.pieBackgroundN;_++)w.push({name:"pie-"+_+"-background-color",type:s.color}),w.push({name:"pie-"+_+"-background-size",type:s.percent}),w.push({name:"pie-"+_+"-background-opacity",type:s.zeroOneNumber});var S=[],M=Is.arrowPrefixes=["source","mid-source","target","mid-target"];[{name:"arrow-shape",type:s.arrowShape,triggersBounds:n.any},{name:"arrow-color",type:s.color},{name:"arrow-fill",type:s.arrowFill}].forEach((function(e){M.forEach((function(t){var a=t+"-"+e.name,i=e.type,n=e.triggersBounds;S.push({name:a,type:i,triggersBounds:n})}))}),{});var k=Is.properties=[].concat(u,b,p,m,O,d,c,r,o,l,f,g,x,w,v,y,S,E),C=Is.propertyGroups={behavior:u,transition:b,visibility:p,overlay:m,ghost:O,commonLabel:d,labelDimensions:c,mainLabel:r,sourceLabel:o,targetLabel:l,nodeBody:f,nodeBorder:g,backgroundImage:x,pie:w,compound:v,edgeLine:y,edgeArrow:S,core:E},T=Is.propertyGroupNames={};(Is.propertyGroupKeys=Object.keys(C)).forEach((function(e){T[e]=C[e].map((function(e){return e.name})),C[e].forEach((function(t){return t.groupKey=e}))}));var F=Is.aliases=[{name:"content",pointsTo:"label"},{name:"control-point-distance",pointsTo:"control-point-distances"},{name:"control-point-weight",pointsTo:"control-point-weights"},{name:"edge-text-rotation",pointsTo:"text-rotation"},{name:"padding-left",pointsTo:"padding"},{name:"padding-right",pointsTo:"padding"},{name:"padding-top",pointsTo:"padding"},{name:"padding-bottom",pointsTo:"padding"}];Is.propertyNames=k.map((function(e){return e.name}));for(var I=0;I<k.length;I++){var D=k[I];k[D.name]=D}for(var A=0;A<F.length;A++){var L=F[A],P=k[L.pointsTo],N={name:L.name,alias:!0,pointsTo:P};k.push(N),k[L.name]=N}}(),Is.getDefaultProperty=function(e){return this.getDefaultProperties()[e]},Is.getDefaultProperties=function(){var e=this._private;if(null!=e.defaultProperties)return e.defaultProperties;for(var t=N({"selection-box-color":"#ddd","selection-box-opacity":.65,"selection-box-border-color":"#aaa","selection-box-border-width":1,"active-bg-color":"black","active-bg-opacity":.15,"active-bg-size":30,"outside-texture-bg-color":"#000","outside-texture-bg-opacity":.125,events:"yes","text-events":"no","text-valign":"top","text-halign":"center","text-justification":"auto","line-height":1,color:"#000","text-outline-color":"#000","text-outline-width":0,"text-outline-opacity":1,"text-opacity":1,"text-decoration":"none","text-transform":"none","text-wrap":"none","text-overflow-wrap":"whitespace","text-max-width":9999,"text-background-color":"#000","text-background-opacity":0,"text-background-shape":"rectangle","text-background-padding":0,"text-border-opacity":0,"text-border-width":0,"text-border-style":"solid","text-border-color":"#000","font-family":"Helvetica Neue, Helvetica, sans-serif","font-style":"normal","font-weight":"normal","font-size":16,"min-zoomed-font-size":0,"text-rotation":"none","source-text-rotation":"none","target-text-rotation":"none",visibility:"visible",display:"element",opacity:1,"z-compound-depth":"auto","z-index-compare":"auto","z-index":0,label:"","text-margin-x":0,"text-margin-y":0,"source-label":"","source-text-offset":0,"source-text-margin-x":0,"source-text-margin-y":0,"target-label":"","target-text-offset":0,"target-text-margin-x":0,"target-text-margin-y":0,"overlay-opacity":0,"overlay-color":"#000","overlay-padding":10,"transition-property":"none","transition-duration":0,"transition-delay":0,"transition-timing-function":"linear","background-blacken":0,"background-color":"#999","background-fill":"solid","background-opacity":1,"background-image":"none","background-image-crossorigin":"anonymous","background-image-opacity":1,"background-position-x":"50%","background-position-y":"50%","background-offset-x":0,"background-offset-y":0,"background-width-relative-to":"include-padding","background-height-relative-to":"include-padding","background-repeat":"no-repeat","background-fit":"none","background-clip":"node","background-width":"auto","background-height":"auto","border-color":"#000","border-opacity":1,"border-width":0,"border-style":"solid",height:30,width:30,shape:"ellipse","shape-polygon-points":"-1, -1,   1, -1,   1, 1,   -1, 1","bounds-expansion":0,"background-gradient-direction":"to-bottom","background-gradient-stop-colors":"#999","background-gradient-stop-positions":"0%",ghost:"no","ghost-offset-y":0,"ghost-offset-x":0,"ghost-opacity":0,padding:0,"padding-relative-to":"width",position:"origin","compound-sizing-wrt-labels":"include","min-width":0,"min-width-bias-left":0,"min-width-bias-right":0,"min-height":0,"min-height-bias-top":0,"min-height-bias-bottom":0},{"pie-size":"100%"},[{name:"pie-{{i}}-background-color",value:"black"},{name:"pie-{{i}}-background-size",value:"0%"},{name:"pie-{{i}}-background-opacity",value:1}].reduce((function(e,t){for(var a=1;a<=Is.pieBackgroundN;a++){var i=t.name.replace("{{i}}",a),n=t.value;e[i]=n}return e}),{}),{"line-style":"solid","line-color":"#999","line-fill":"solid","line-cap":"butt","line-gradient-stop-colors":"#999","line-gradient-stop-positions":"0%","control-point-step-size":40,"control-point-weights":.5,"segment-weights":.5,"segment-distances":20,"taxi-turn":"50%","taxi-turn-min-distance":10,"taxi-direction":"auto","edge-distances":"intersection","curve-style":"haystack","haystack-radius":0,"arrow-scale":1,"loop-direction":"-45deg","loop-sweep":"-90deg","source-distance-from-node":0,"target-distance-from-node":0,"source-endpoint":"outside-to-node","target-endpoint":"outside-to-node","line-dash-pattern":[6,3],"line-dash-offset":0},[{name:"arrow-shape",value:"none"},{name:"arrow-color",value:"#999"},{name:"arrow-fill",value:"filled"}].reduce((function(e,t){return Is.arrowPrefixes.forEach((function(a){var i=a+"-"+t.name,n=t.value;e[i]=n})),e}),{})),a={},i=0;i<this.properties.length;i++){var n=this.properties[i];if(!n.pointsTo){var s=n.name,r=t[s],o=this.parse(s,r);a[s]=o}}return e.defaultProperties=a,e.defaultProperties},Is.addDefaultStylesheet=function(){this.selector(":parent").css({shape:"rectangle",padding:10,"background-color":"#eee","border-color":"#ccc","border-width":1}).selector("edge").css({width:3}).selector(":loop").css({"curve-style":"bezier"}).selector("edge:compound").css({"curve-style":"bezier","source-endpoint":"outside-to-line","target-endpoint":"outside-to-line"}).selector(":selected").css({"background-color":"#0169D9","line-color":"#0169D9","source-arrow-color":"#0169D9","target-arrow-color":"#0169D9","mid-source-arrow-color":"#0169D9","mid-target-arrow-color":"#0169D9"}).selector(":parent:selected").css({"background-color":"#CCE1F9","border-color":"#aec8e5"}).selector(":active").css({"overlay-color":"black","overlay-padding":10,"overlay-opacity":.25}),this.defaultLength=this.length};var Ds={parse:function(e,t,a,i){var n=this;if(x(t))return n.parseImplWarn(e,t,a,i);var s,r=Z(e,""+t,a?"t":"f","mapping"===i||!0===i||!1===i||null==i?"dontcare":i),o=n.propCache=n.propCache||[];return(s=o[r])||(s=o[r]=n.parseImplWarn(e,t,a,i)),(a||"mapping"===i)&&(s=pe(s))&&(s.value=pe(s.value)),s},parseImplWarn:function(e,t,a,i){var n=this.parseImpl(e,t,a,i);return n||null==t||ue("The style property `".concat(e,": ").concat(t,"` is invalid")),n}};Ds.parseImpl=function(e,t,a,i){var n=this;e=I(e);var s=n.properties[e],r=t,o=n.types;if(!s)return null;if(void 0===t)return null;s.alias&&(s=s.pointsTo,e=s.name);var l=j(t);l&&(t=t.trim());var c,d,u=s.type;if(!u)return null;if(a&&(""===t||null===t))return{name:e,value:t,bypass:!0,deleteBypass:!0};if(x(t))return{name:e,value:t,strValue:"fn",mapped:o.fn,bypass:a};if(!l||i||t.length<7||"a"!==t[1]);else{if(t.length>=7&&"d"===t[0]&&(c=new RegExp(o.data.regex).exec(t))){if(a)return!1;var p=o.data;return{name:e,value:c,strValue:""+t,mapped:p,field:c[1],bypass:a}}if(t.length>=10&&"m"===t[0]&&(d=new RegExp(o.mapData.regex).exec(t))){if(a)return!1;if(u.multiple)return!1;var m=o.mapData;if(!u.color&&!u.number)return!1;var b=this.parse(e,d[4]);if(!b||b.mapped)return!1;var h=this.parse(e,d[5]);if(!h||h.mapped)return!1;if(b.pfValue===h.pfValue||b.strValue===h.strValue)return ue("`"+e+": "+t+"` is not a valid mapper because the output range is zero; converting to `"+e+": "+b.strValue+"`"),this.parse(e,b.strValue);if(u.color){var f=b.value,g=h.value;if(!(f[0]!==g[0]||f[1]!==g[1]||f[2]!==g[2]||f[3]!==g[3]&&(null!=f[3]&&1!==f[3]||null!=g[3]&&1!==g[3])))return!1}return{name:e,value:d,strValue:""+t,mapped:m,field:d[1],fieldMin:parseFloat(d[2]),fieldMax:parseFloat(d[3]),valueMin:b.value,valueMax:h.value,bypass:a}}}if(u.multiple&&"multiple"!==i){var y;if(y=l?t.split(/\s+/):v(t)?t:[t],u.evenMultiple&&y.length%2!=0)return null;for(var E=[],w=[],_=[],S="",M=!1,k=0;k<y.length;k++){var C=n.parse(e,y[k],a,"multiple");M=M||j(C.value),E.push(C.value),_.push(null!=C.pfValue?C.pfValue:C.value),w.push(C.units),S+=(k>0?" ":"")+C.strValue}return u.validate&&!u.validate(E,w)?null:u.singleEnum&&M?1===E.length&&j(E[0])?{name:e,value:E[0],strValue:E[0],bypass:a}:null:{name:e,value:E,pfValue:_,strValue:S,bypass:a,units:w}}var T,F,D=function(){for(var i=0;i<u.enums.length;i++){if(u.enums[i]===t)return{name:e,value:t,strValue:""+t,bypass:a}}return null};if(u.number){var A,L="px";if(u.units&&(A=u.units),u.implicitUnits&&(L=u.implicitUnits),!u.unitless)if(l){var P="px|em"+(u.allowPercent?"|\\%":"");A&&(P=A);var N=t.match("^("+R+")("+P+")?$");N&&(t=N[1],A=N[2]||L)}else A&&!u.implicitUnits||(A=L);if(t=parseFloat(t),isNaN(t)&&void 0===u.enums)return null;if(isNaN(t)&&void 0!==u.enums)return t=r,D();if(u.integer&&(!O(F=t)||Math.floor(F)!==F))return null;if(void 0!==u.min&&(t<u.min||u.strictMin&&t===u.min)||void 0!==u.max&&(t>u.max||u.strictMax&&t===u.max))return null;var B={name:e,value:t,strValue:""+t+(A||""),units:A,bypass:a};return u.unitless||"px"!==A&&"em"!==A?B.pfValue=t:B.pfValue="px"!==A&&A?this.getEmSizeInPixels()*t:t,"ms"!==A&&"s"!==A||(B.pfValue="ms"===A?t:1e3*t),"deg"!==A&&"rad"!==A||(B.pfValue="rad"===A?t:(T=t,Math.PI*T/180)),"%"===A&&(B.pfValue=t/100),B}if(u.propList){var J=[],V=""+t;if("none"===V);else{for(var U=V.split(/\s*,\s*|\s+/),G=0;G<U.length;G++){var q=U[G].trim();n.properties[q]?J.push(q):ue("`"+q+"` is not a valid property name")}if(0===J.length)return null}return{name:e,value:J,strValue:0===J.length?"none":J.join(" "),bypass:a}}if(u.color){var H=z(t);return H?{name:e,value:H,pfValue:H,strValue:"rgb("+H[0]+","+H[1]+","+H[2]+")",bypass:a}:null}if(u.regex||u.regexes){if(u.enums){var W=D();if(W)return W}for(var $=u.regexes?u.regexes:[u.regex],Y=0;Y<$.length;Y++){var X=new RegExp($[Y]).exec(t);if(X)return{name:e,value:u.singleRegexMatchValue?X[1]:X,strValue:""+t,bypass:a}}return null}return u.string?{name:e,value:""+t,strValue:""+t,bypass:a}:u.enums?D():null};var As=function e(t){if(!(this instanceof e))return new e(t);M(t)?(this._private={cy:t,coreStyle:{}},this.length=0,this.resetToDefault()):ce("A style must have a core reference")},Ls=As.prototype;Ls.instanceString=function(){return"style"},Ls.clear=function(){for(var e=0;e<this.length;e++)this[e]=void 0;return this.length=0,this._private.newStyle=!0,this},Ls.resetToDefault=function(){return this.clear(),this.addDefaultStylesheet(),this},Ls.core=function(e){return this._private.coreStyle[e]||this.getDefaultProperty(e)},Ls.selector=function(e){var t="core"===e?null:new wi(e),a=this.length++;return this[a]={selector:t,properties:[],mappedProperties:[],index:a},this},Ls.css=function(){var e=this,t=arguments;if(1===t.length)for(var a=t[0],i=0;i<e.properties.length;i++){var n=e.properties[i],s=a[n.name];void 0===s&&(s=a[D(n.name)]),void 0!==s&&this.cssRule(n.name,s)}else 2===t.length&&this.cssRule(t[0],t[1]);return this},Ls.style=Ls.css,Ls.cssRule=function(e,t){var a=this.parse(e,t);if(a){var i=this.length-1;this[i].properties.push(a),this[i].properties[a.name]=a,a.name.match(/pie-(\d+)-background-size/)&&a.value&&(this._private.hasPie=!0),a.mapped&&this[i].mappedProperties.push(a),!this[i].selector&&(this._private.coreStyle[a.name]=a)}return this},Ls.append=function(e){return k(e)?e.appendToStyle(this):v(e)?this.appendFromJson(e):j(e)&&this.appendFromString(e),this},As.fromJson=function(e,t){var a=new As(e);return a.fromJson(t),a},As.fromString=function(e,t){return new As(e).fromString(t)},[_s,Ms,ks,Cs,Ts,Fs,Is,Ds].forEach((function(e){N(Ls,e)})),As.types=Ls.types,As.properties=Ls.properties,As.propertyGroups=Ls.propertyGroups,As.propertyGroupNames=Ls.propertyGroupNames,As.propertyGroupKeys=Ls.propertyGroupKeys;var Rs={style:function(e){e&&this.setStyle(e).update();return this._private.style},setStyle:function(e){var t=this._private;return k(e)?t.style=e.generateStyle(this):v(e)?t.style=As.fromJson(this,e):j(e)?t.style=As.fromString(this,e):t.style=As(this),t.style}},Ps={autolock:function(e){return void 0===e?this._private.autolock:(this._private.autolock=!!e,this)},autoungrabify:function(e){return void 0===e?this._private.autoungrabify:(this._private.autoungrabify=!!e,this)},autounselectify:function(e){return void 0===e?this._private.autounselectify:(this._private.autounselectify=!!e,this)},selectionType:function(e){var t=this._private;return null==t.selectionType&&(t.selectionType="single"),void 0===e?t.selectionType:("additive"!==e&&"single"!==e||(t.selectionType=e),this)},panningEnabled:function(e){return void 0===e?this._private.panningEnabled:(this._private.panningEnabled=!!e,this)},userPanningEnabled:function(e){return void 0===e?this._private.userPanningEnabled:(this._private.userPanningEnabled=!!e,this)},zoomingEnabled:function(e){return void 0===e?this._private.zoomingEnabled:(this._private.zoomingEnabled=!!e,this)},userZoomingEnabled:function(e){return void 0===e?this._private.userZoomingEnabled:(this._private.userZoomingEnabled=!!e,this)},boxSelectionEnabled:function(e){return void 0===e?this._private.boxSelectionEnabled:(this._private.boxSelectionEnabled=!!e,this)},pan:function(){var e,t,a,i,n,s=arguments,r=this._private.pan;switch(s.length){case 0:return r;case 1:if(j(s[0]))return r[e=s[0]];if(y(s[0])){if(!this._private.panningEnabled)return this;i=(a=s[0]).x,n=a.y,O(i)&&(r.x=i),O(n)&&(r.y=n),this.emit("pan viewport")}break;case 2:if(!this._private.panningEnabled)return this;e=s[0],t=s[1],"x"!==e&&"y"!==e||!O(t)||(r[e]=t),this.emit("pan viewport")}return this.notify("viewport"),this},panBy:function(e,t){var a,i,n,s,r,o=arguments,l=this._private.pan;if(!this._private.panningEnabled)return this;switch(o.length){case 1:y(e)&&(s=(n=o[0]).x,r=n.y,O(s)&&(l.x+=s),O(r)&&(l.y+=r),this.emit("pan viewport"));break;case 2:i=t,"x"!==(a=e)&&"y"!==a||!O(i)||(l[a]+=i),this.emit("pan viewport")}return this.notify("viewport"),this},fit:function(e,t){var a=this.getFitViewport(e,t);if(a){var i=this._private;i.zoom=a.zoom,i.pan=a.pan,this.emit("pan zoom viewport"),this.notify("viewport")}return this},getFitViewport:function(e,t){if(O(e)&&void 0===t&&(t=e,e=void 0),this._private.panningEnabled&&this._private.zoomingEnabled){var a,i;if(j(e)){var n=e;e=this.$(n)}else if(y(i=e)&&O(i.x1)&&O(i.x2)&&O(i.y1)&&O(i.y2)){var s=e;(a={x1:s.x1,y1:s.y1,x2:s.x2,y2:s.y2}).w=a.x2-a.x1,a.h=a.y2-a.y1}else w(e)||(e=this.mutableElements());if(!w(e)||!e.empty()){a=a||e.boundingBox();var r,o=this.width(),l=this.height();if(t=O(t)?t:0,!isNaN(o)&&!isNaN(l)&&o>0&&l>0&&!isNaN(a.w)&&!isNaN(a.h)&&a.w>0&&a.h>0)return{zoom:r=(r=(r=Math.min((o-2*t)/a.w,(l-2*t)/a.h))>this._private.maxZoom?this._private.maxZoom:r)<this._private.minZoom?this._private.minZoom:r,pan:{x:(o-r*(a.x1+a.x2))/2,y:(l-r*(a.y1+a.y2))/2}}}}},zoomRange:function(e,t){var a=this._private;if(null==t){var i=e;e=i.min,t=i.max}return O(e)&&O(t)&&e<=t?(a.minZoom=e,a.maxZoom=t):O(e)&&void 0===t&&e<=a.maxZoom?a.minZoom=e:O(t)&&void 0===e&&t>=a.minZoom&&(a.maxZoom=t),this},minZoom:function(e){return void 0===e?this._private.minZoom:this.zoomRange({min:e})},maxZoom:function(e){return void 0===e?this._private.maxZoom:this.zoomRange({max:e})},getZoomedViewport:function(e){var t,a,i=this._private,n=i.pan,s=i.zoom,r=!1;if(i.zoomingEnabled||(r=!0),O(e)?a=e:y(e)&&(a=e.level,null!=e.position?t=Be(e.position,s,n):null!=e.renderedPosition&&(t=e.renderedPosition),null==t||i.panningEnabled||(r=!0)),a=(a=a>i.maxZoom?i.maxZoom:a)<i.minZoom?i.minZoom:a,r||!O(a)||a===s||null!=t&&(!O(t.x)||!O(t.y)))return null;if(null!=t){var o=n,l=s,c=a;return{zoomed:!0,panned:!0,zoom:c,pan:{x:-c/l*(t.x-o.x)+t.x,y:-c/l*(t.y-o.y)+t.y}}}return{zoomed:!0,panned:!1,zoom:a,pan:n}},zoom:function(e){if(void 0===e)return this._private.zoom;var t=this.getZoomedViewport(e),a=this._private;return null!=t&&t.zoomed?(a.zoom=t.zoom,t.panned&&(a.pan.x=t.pan.x,a.pan.y=t.pan.y),this.emit("zoom"+(t.panned?" pan":"")+" viewport"),this.notify("viewport"),this):this},viewport:function(e){var t=this._private,a=!0,i=!0,n=[],s=!1,r=!1;if(!e)return this;if(O(e.zoom)||(a=!1),y(e.pan)||(i=!1),!a&&!i)return this;if(a){var o=e.zoom;o<t.minZoom||o>t.maxZoom||!t.zoomingEnabled?s=!0:(t.zoom=o,n.push("zoom"))}if(i&&(!s||!e.cancelOnFailedZoom)&&t.panningEnabled){var l=e.pan;O(l.x)&&(t.pan.x=l.x,r=!1),O(l.y)&&(t.pan.y=l.y,r=!1),r||n.push("pan")}return n.length>0&&(n.push("viewport"),this.emit(n.join(" ")),this.notify("viewport")),this},center:function(e){var t=this.getCenterPan(e);return t&&(this._private.pan=t,this.emit("pan viewport"),this.notify("viewport")),this},getCenterPan:function(e,t){if(this._private.panningEnabled){if(j(e)){var a=e;e=this.mutableElements().filter(a)}else w(e)||(e=this.mutableElements());if(0!==e.length){var i=e.boundingBox(),n=this.width(),s=this.height();return{x:(n-(t=void 0===t?this._private.zoom:t)*(i.x1+i.x2))/2,y:(s-t*(i.y1+i.y2))/2}}}},reset:function(){return this._private.panningEnabled&&this._private.zoomingEnabled?(this.viewport({pan:{x:0,y:0},zoom:1}),this):this},invalidateSize:function(){this._private.sizeCache=null},size:function(){var e,t,a=this._private,i=a.container;return a.sizeCache=a.sizeCache||(i?(e=u.getComputedStyle(i),t=function(t){return parseFloat(e.getPropertyValue(t))},{width:i.clientWidth-t("padding-left")-t("padding-right"),height:i.clientHeight-t("padding-top")-t("padding-bottom")}):{width:1,height:1})},width:function(){return this.size().width},height:function(){return this.size().height},extent:function(){var e=this._private.pan,t=this._private.zoom,a=this.renderedExtent(),i={x1:(a.x1-e.x)/t,x2:(a.x2-e.x)/t,y1:(a.y1-e.y)/t,y2:(a.y2-e.y)/t};return i.w=i.x2-i.x1,i.h=i.y2-i.y1,i},renderedExtent:function(){var e=this.width(),t=this.height();return{x1:0,y1:0,x2:e,y2:t,w:e,h:t}}};Ps.centre=Ps.center,Ps.autolockNodes=Ps.autolock,Ps.autoungrabifyNodes=Ps.autoungrabify;var Ns={data:Ba.data({field:"data",bindingEvent:"data",allowBinding:!0,allowSetting:!0,settingEvent:"data",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0}),removeData:Ba.removeData({field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!0}),scratch:Ba.data({field:"scratch",bindingEvent:"scratch",allowBinding:!0,allowSetting:!0,settingEvent:"scratch",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0}),removeScratch:Ba.removeData({field:"scratch",event:"scratch",triggerFnName:"trigger",triggerEvent:!0})};Ns.attr=Ns.data,Ns.removeAttr=Ns.removeData;var zs=function(e){var t=this,a=(e=N({},e)).container;a&&!E(a)&&E(a[0])&&(a=a[0]);var i=a?a._cyreg:null;(i=i||{})&&i.cy&&(i.cy.destroy(),i={});var n=i.readies=i.readies||[];a&&(a._cyreg=i),i.cy=t;var s=void 0!==u&&void 0!==a&&!e.headless,r=e;r.layout=N({name:s?"grid":"null"},r.layout),r.renderer=N({name:s?"canvas":"null"},r.renderer);var o=function(e,t,a){return void 0!==t?t:void 0!==a?a:e},l=this._private={container:a,ready:!1,options:r,elements:new as(this),listeners:[],aniEles:new as(this),data:{},scratch:{},layout:null,renderer:null,destroyed:!1,notificationsEnabled:!0,minZoom:1e-50,maxZoom:1e50,zoomingEnabled:o(!0,r.zoomingEnabled),userZoomingEnabled:o(!0,r.userZoomingEnabled),panningEnabled:o(!0,r.panningEnabled),userPanningEnabled:o(!0,r.userPanningEnabled),boxSelectionEnabled:o(!0,r.boxSelectionEnabled),autolock:o(!1,r.autolock,r.autolockNodes),autoungrabify:o(!1,r.autoungrabify,r.autoungrabifyNodes),autounselectify:o(!1,r.autounselectify),styleEnabled:void 0===r.styleEnabled?s:r.styleEnabled,zoom:O(r.zoom)?r.zoom:1,pan:{x:y(r.pan)&&O(r.pan.x)?r.pan.x:0,y:y(r.pan)&&O(r.pan.y)?r.pan.y:0},animation:{current:[],queue:[]},hasCompoundNodes:!1};this.createEmitter(),this.selectionType(r.selectionType),this.zoomRange({min:r.minZoom,max:r.maxZoom});l.styleEnabled&&t.setStyle([]);var c=N({},r,r.renderer);t.initRenderer(c);!function(e,t){if(e.some(T))return Aa.all(e).then(t);t(e)}([r.style,r.elements],(function(e){var a=e[0],s=e[1];l.styleEnabled&&t.style().append(a),function(e,a,i){t.notifications(!1);var n=t.mutableElements();n.length>0&&n.remove(),null!=e&&(y(e)||v(e))&&t.add(e),t.one("layoutready",(function(e){t.notifications(!0),t.emit(e),t.one("load",a),t.emitAndNotify("load")})).one("layoutstop",(function(){t.one("done",i),t.emit("done")}));var s=N({},t._private.options.layout);s.eles=t.elements(),t.layout(s).run()}(s,(function(){t.startAnimationLoop(),l.ready=!0,x(r.ready)&&t.on("ready",r.ready);for(var e=0;e<n.length;e++){var a=n[e];t.on("ready",a)}i&&(i.readies=[]),t.emit("ready")}),r.done)}))},Bs=zs.prototype;N(Bs,{instanceString:function(){return"core"},isReady:function(){return this._private.ready},destroyed:function(){return this._private.destroyed},ready:function(e){return this.isReady()?this.emitter().emit("ready",[],e):this.on("ready",e),this},destroy:function(){var e=this;if(!e.destroyed())return e.stopAnimationLoop(),e.destroyRenderer(),this.emit("destroy"),e._private.destroyed=!0,e},hasElementWithId:function(e){return this._private.elements.hasElementWithId(e)},getElementById:function(e){return this._private.elements.getElementById(e)},hasCompoundNodes:function(){return this._private.hasCompoundNodes},headless:function(){return this._private.renderer.isHeadless()},styleEnabled:function(){return this._private.styleEnabled},addToPool:function(e){return this._private.elements.merge(e),this},removeFromPool:function(e){return this._private.elements.unmerge(e),this},container:function(){return this._private.container||null},mount:function(e){if(null!=e){var t=this,a=t._private,i=a.options;return!E(e)&&E(e[0])&&(e=e[0]),t.stopAnimationLoop(),t.destroyRenderer(),a.container=e,a.styleEnabled=!0,t.invalidateSize(),t.initRenderer(N({},i,i.renderer,{name:"null"===i.renderer.name?"canvas":i.renderer.name})),t.startAnimationLoop(),t.style(i.style),t.emit("mount"),t}},unmount:function(){var e=this;return e.stopAnimationLoop(),e.destroyRenderer(),e.initRenderer({name:"null"}),e.emit("unmount"),e},options:function(){return pe(this._private.options)},json:function(e){var t=this,a=t._private,i=t.mutableElements();if(y(e)){if(t.startBatch(),e.elements){var n={},s=function(e,a){for(var i=[],s=[],r=0;r<e.length;r++){var o=e[r],l=""+o.data.id,c=t.getElementById(l);n[l]=!0,0!==c.length?s.push({ele:c,json:o}):a?(o.group=a,i.push(o)):i.push(o)}t.add(i);for(var d=0;d<s.length;d++){var u=s[d],p=u.ele,m=u.json;p.json(m)}};if(v(e.elements))s(e.elements);else for(var r=["nodes","edges"],o=0;o<r.length;o++){var l=r[o],c=e.elements[l];v(c)&&s(c,l)}var d=t.collection();i.filter((function(e){return!n[e.id()]})).forEach((function(e){e.isParent()?d.merge(e):e.remove()})),d.forEach((function(e){return e.children().move({parent:null})})),d.forEach((function(e){return function(e){return t.getElementById(e.id())}(e).remove()}))}e.style&&t.style(e.style),null!=e.zoom&&e.zoom!==a.zoom&&t.zoom(e.zoom),e.pan&&(e.pan.x===a.pan.x&&e.pan.y===a.pan.y||t.pan(e.pan)),e.data&&t.data(e.data);for(var u=["minZoom","maxZoom","zoomingEnabled","userZoomingEnabled","panningEnabled","userPanningEnabled","boxSelectionEnabled","autolock","autoungrabify","autounselectify"],p=0;p<u.length;p++){var m=u[p];null!=e[m]&&t[m](e[m])}return t.endBatch(),this}var b={};!!e?b.elements=this.elements().map((function(e){return e.json()})):(b.elements={},i.forEach((function(e){var t=e.group();b.elements[t]||(b.elements[t]=[]),b.elements[t].push(e.json())}))),this._private.styleEnabled&&(b.style=t.style().json()),b.data=pe(t.data());var h=a.options;return b.zoomingEnabled=a.zoomingEnabled,b.userZoomingEnabled=a.userZoomingEnabled,b.zoom=a.zoom,b.minZoom=a.minZoom,b.maxZoom=a.maxZoom,b.panningEnabled=a.panningEnabled,b.userPanningEnabled=a.userPanningEnabled,b.pan=pe(a.pan),b.boxSelectionEnabled=a.boxSelectionEnabled,b.renderer=pe(h.renderer),b.hideEdgesOnViewport=h.hideEdgesOnViewport,b.textureOnViewport=h.textureOnViewport,b.wheelSensitivity=h.wheelSensitivity,b.motionBlur=h.motionBlur,b}}),Bs.$id=Bs.getElementById,[ns,hs,js,xs,vs,ys,Es,ws,Rs,Ps,Ns].forEach((function(e){N(Bs,e)}));var Js={fit:!0,directed:!1,padding:30,circle:!1,grid:!1,spacingFactor:1.75,boundingBox:void 0,avoidOverlap:!0,nodeDimensionsIncludeLabels:!1,roots:void 0,maximal:!1,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,t){return!0},ready:void 0,stop:void 0,transform:function(e,t){return t}},Vs=function(e){return e.scratch("breadthfirst")},Us=function(e,t){return e.scratch("breadthfirst",t)};function Gs(e){this.options=N({},Js,e)}Gs.prototype.run=function(){var e,t=this.options,a=t,i=t.cy,n=a.eles,s=n.nodes().filter((function(e){return!e.isParent()})),r=n,o=a.directed,l=a.maximal||a.maximalAdjustments>0,c=Ke(a.boundingBox?a.boundingBox:{x1:0,y1:0,w:i.width(),h:i.height()});if(w(a.roots))e=a.roots;else if(v(a.roots)){for(var d=[],u=0;u<a.roots.length;u++){var p=a.roots[u],m=i.getElementById(p);d.push(m)}e=i.collection(d)}else if(j(a.roots))e=i.$(a.roots);else if(o)e=s.roots();else{var b=n.components();e=i.collection();for(var h=function(t){var a=b[t],i=a.maxDegree(!1),n=a.filter((function(e){return e.degree(!1)===i}));e=e.add(n)},f=0;f<b.length;f++)h(f)}var g=[],x={},y=function(e,t){null==g[t]&&(g[t]=[]);var a=g[t].length;g[t].push(e),Us(e,{index:a,depth:t})};r.bfs({roots:e,directed:a.directed,visit:function(e,t,a,i,n){var s=e[0],r=s.id();y(s,n),x[r]=!0}});for(var O=[],E=0;E<s.length;E++){var _=s[E];x[_.id()]||O.push(_)}var S=function(e){for(var t=g[e],a=0;a<t.length;a++){var i=t[a];null!=i?Us(i,{depth:e,index:a}):(t.splice(a,1),a--)}},M=function(){for(var e=0;e<g.length;e++)S(e)},k=function(e,t){for(var a=Vs(e),i=e.incomers().filter((function(e){return e.isNode()&&n.has(e)})),s=-1,r=e.id(),o=0;o<i.length;o++){var l=i[o],c=Vs(l);s=Math.max(s,c.depth)}return a.depth<=s&&(t[r]?null:(function(e,t){var a=Vs(e),i=a.depth,n=a.index;g[i][n]=null,y(e,t)}(e,s+1),t[r]=!0,!0))};if(o&&l){var C=[],T={},F=function(e){return C.push(e)};for(s.forEach((function(e){return C.push(e)}));C.length>0;){var I=C.shift(),D=k(I,T);if(D)I.outgoers().filter((function(e){return e.isNode()&&n.has(e)})).forEach(F);else if(null===D){ue("Detected double maximal shift for node `"+I.id()+"`.  Bailing maximal adjustment due to cycle.  Use `options.maximal: true` only on DAGs.");break}}}M();var A=0;if(a.avoidOverlap)for(var L=0;L<s.length;L++){var R=s[L].layoutDimensions(a),N=R.w,z=R.h;A=Math.max(A,N,z)}for(var B={},J=function(e){if(B[e.id()])return B[e.id()];for(var t=Vs(e).depth,a=e.neighborhood(),i=0,n=0,r=0;r<a.length;r++){var o=a[r];if(!o.isEdge()&&!o.isParent()&&s.has(o)){var l=Vs(o),c=l.index,d=l.depth;if(null!=c&&null!=d){var u=g[d].length;d<t&&(i+=c/u,n++)}}}return i/=n=Math.max(1,n),0===n&&(i=0),B[e.id()]=i,i},V=function(e,t){var a=J(e)-J(t);return 0===a?P(e.id(),t.id()):a},U=0;U<g.length;U++)g[U].sort(V),S(U);for(var G=[],q=0;q<O.length;q++)G.push(O[q]);g.unshift(G),M();for(var H=0,W=0;W<g.length;W++)H=Math.max(g[W].length,H);var $=c.x1+c.w/2,Y=c.x1+c.h/2,X=g.reduce((function(e,t){return Math.max(e,t.length)}),0);return s.layoutPositions(this,a,(function(e){var t=Vs(e),i=t.depth,n=t.index,s=g[i].length,r=Math.max(c.w/((a.grid?X:s)+1),A),o=Math.max(c.h/(g.length+1),A),l=Math.min(c.w/2/g.length,c.h/2/g.length);if(l=Math.max(l,A),a.circle){var d=l*i+l-(g.length>0&&g[0].length<=3?l/2:0),u=2*Math.PI/g[i].length*n;return 0===i&&1===g[0].length&&(d=1),{x:$+d*Math.cos(u),y:Y+d*Math.sin(u)}}return{x:$+(n+1-(s+1)/2)*r,y:(i+1)*o}})),this};var qs={fit:!0,padding:30,boundingBox:void 0,avoidOverlap:!0,nodeDimensionsIncludeLabels:!1,spacingFactor:void 0,radius:void 0,startAngle:1.5*Math.PI,sweep:void 0,clockwise:!0,sort:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,t){return!0},ready:void 0,stop:void 0,transform:function(e,t){return t}};function Hs(e){this.options=N({},qs,e)}Hs.prototype.run=function(){var e=this.options,t=e,a=e.cy,i=t.eles,n=void 0!==t.counterclockwise?!t.counterclockwise:t.clockwise,s=i.nodes().not(":parent");t.sort&&(s=s.sort(t.sort));for(var r,o=Ke(t.boundingBox?t.boundingBox:{x1:0,y1:0,w:a.width(),h:a.height()}),l=o.x1+o.w/2,c=o.y1+o.h/2,d=(void 0===t.sweep?2*Math.PI-2*Math.PI/s.length:t.sweep)/Math.max(1,s.length-1),u=0,p=0;p<s.length;p++){var m=s[p].layoutDimensions(t),b=m.w,h=m.h;u=Math.max(u,b,h)}if(r=O(t.radius)?t.radius:s.length<=1?0:Math.min(o.h,o.w)/2-u,s.length>1&&t.avoidOverlap){u*=1.75;var f=Math.cos(d)-Math.cos(0),g=Math.sin(d)-Math.sin(0),j=Math.sqrt(u*u/(f*f+g*g));r=Math.max(j,r)}return s.layoutPositions(this,t,(function(e,a){var i=t.startAngle+a*d*(n?1:-1),s=r*Math.cos(i),o=r*Math.sin(i);return{x:l+s,y:c+o}})),this};var Ws,$s={fit:!0,padding:30,startAngle:1.5*Math.PI,sweep:void 0,clockwise:!0,equidistant:!1,minNodeSpacing:10,boundingBox:void 0,avoidOverlap:!0,nodeDimensionsIncludeLabels:!1,height:void 0,width:void 0,spacingFactor:void 0,concentric:function(e){return e.degree()},levelWidth:function(e){return e.maxDegree()/4},animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,t){return!0},ready:void 0,stop:void 0,transform:function(e,t){return t}};function Ys(e){this.options=N({},$s,e)}Ys.prototype.run=function(){for(var e=this.options,t=e,a=void 0!==t.counterclockwise?!t.counterclockwise:t.clockwise,i=e.cy,n=t.eles.nodes().not(":parent"),s=Ke(t.boundingBox?t.boundingBox:{x1:0,y1:0,w:i.width(),h:i.height()}),r=s.x1+s.w/2,o=s.y1+s.h/2,l=[],c=0,d=0;d<n.length;d++){var u,p=n[d];u=t.concentric(p),l.push({value:u,node:p}),p._private.scratch.concentric=u}n.updateStyle();for(var m=0;m<n.length;m++){var b=n[m].layoutDimensions(t);c=Math.max(c,b.w,b.h)}l.sort((function(e,t){return t.value-e.value}));for(var h=t.levelWidth(n),f=[[]],g=f[0],j=0;j<l.length;j++){var x=l[j];if(g.length>0)Math.abs(g[0].value-x.value)>=h&&(g=[],f.push(g));g.push(x)}var v=c+t.minNodeSpacing;if(!t.avoidOverlap){var y=f.length>0&&f[0].length>1,O=(Math.min(s.w,s.h)/2-v)/(f.length+y?1:0);v=Math.min(v,O)}for(var E=0,w=0;w<f.length;w++){var _=f[w],S=void 0===t.sweep?2*Math.PI-2*Math.PI/_.length:t.sweep,M=_.dTheta=S/Math.max(1,_.length-1);if(_.length>1&&t.avoidOverlap){var k=Math.cos(M)-Math.cos(0),C=Math.sin(M)-Math.sin(0),T=Math.sqrt(v*v/(k*k+C*C));E=Math.max(T,E)}_.r=E,E+=v}if(t.equidistant){for(var F=0,I=0,D=0;D<f.length;D++){var A=f[D].r-I;F=Math.max(F,A)}I=0;for(var L=0;L<f.length;L++){var R=f[L];0===L&&(I=R.r),R.r=I,I+=F}}for(var P={},N=0;N<f.length;N++)for(var z=f[N],B=z.dTheta,J=z.r,V=0;V<z.length;V++){var U=z[V],G=t.startAngle+(a?1:-1)*B*V,q={x:r+J*Math.cos(G),y:o+J*Math.sin(G)};P[U.node.id()]=q}return n.layoutPositions(this,t,(function(e){var t=e.id();return P[t]})),this};var Xs={ready:function(){},stop:function(){},animate:!0,animationEasing:void 0,animationDuration:void 0,animateFilter:function(e,t){return!0},animationThreshold:250,refresh:20,fit:!0,padding:30,boundingBox:void 0,nodeDimensionsIncludeLabels:!1,randomize:!1,componentSpacing:40,nodeRepulsion:function(e){return 2048},nodeOverlap:4,idealEdgeLength:function(e){return 32},edgeElasticity:function(e){return 32},nestingFactor:1.2,gravity:1,numIter:1e3,initialTemp:1e3,coolingFactor:.99,minTemp:1};function Qs(e){this.options=N({},Xs,e),this.options.layout=this}Qs.prototype.run=function(){var e=this.options,t=e.cy,a=this;a.stopped=!1,!0!==e.animate&&!1!==e.animate||a.emit({type:"layoutstart",layout:a}),Ws=!0===e.debug;var i=Ks(t,a,e);Ws&&undefined(i),e.randomize&&tr(i);var n=W(),s=function(){ir(i,t,e),!0===e.fit&&t.fit(e.padding)},r=function(t){return!(a.stopped||t>=e.numIter)&&(nr(i,e),i.temperature=i.temperature*e.coolingFactor,!(i.temperature<e.minTemp))},o=function(){if(!0===e.animate||!1===e.animate)s(),a.one("layoutstop",e.stop),a.emit({type:"layoutstop",layout:a});else{var t=e.eles.nodes(),n=ar(i,e,t);t.layoutPositions(a,e,n)}},l=0,c=!0;if(!0===e.animate){!function t(){for(var a=0;c&&a<e.refresh;)c=r(l),l++,a++;c?(W()-n>=e.animationThreshold&&s(),H(t)):(fr(i,e),o())}()}else{for(;c;)c=r(l),l++;fr(i,e),o()}return this},Qs.prototype.stop=function(){return this.stopped=!0,this.thread&&this.thread.stop(),this.emit("layoutstop"),this},Qs.prototype.destroy=function(){return this.thread&&this.thread.stop(),this};var Ks=function(e,t,a){for(var i=a.eles.edges(),n=a.eles.nodes(),s={isCompound:e.hasCompoundNodes(),layoutNodes:[],idToIndex:{},nodeSize:n.size(),graphSet:[],indexToGraph:[],layoutEdges:[],edgeSize:i.size(),temperature:a.initialTemp,clientWidth:e.width(),clientHeight:e.width(),boundingBox:Ke(a.boundingBox?a.boundingBox:{x1:0,y1:0,w:e.width(),h:e.height()})},r=a.eles.components(),o={},l=0;l<r.length;l++)for(var c=r[l],d=0;d<c.length;d++){o[c[d].id()]=l}for(l=0;l<s.nodeSize;l++){var u=(f=n[l]).layoutDimensions(a);(D={}).isLocked=f.locked(),D.id=f.data("id"),D.parentId=f.data("parent"),D.cmptId=o[f.id()],D.children=[],D.positionX=f.position("x"),D.positionY=f.position("y"),D.offsetX=0,D.offsetY=0,D.height=u.w,D.width=u.h,D.maxX=D.positionX+D.width/2,D.minX=D.positionX-D.width/2,D.maxY=D.positionY+D.height/2,D.minY=D.positionY-D.height/2,D.padLeft=parseFloat(f.style("padding")),D.padRight=parseFloat(f.style("padding")),D.padTop=parseFloat(f.style("padding")),D.padBottom=parseFloat(f.style("padding")),D.nodeRepulsion=x(a.nodeRepulsion)?a.nodeRepulsion(f):a.nodeRepulsion,s.layoutNodes.push(D),s.idToIndex[D.id]=l}var p=[],m=0,b=-1,h=[];for(l=0;l<s.nodeSize;l++){var f,g=(f=s.layoutNodes[l]).parentId;null!=g?s.layoutNodes[s.idToIndex[g]].children.push(f.id):(p[++b]=f.id,h.push(f.id))}for(s.graphSet.push(h);m<=b;){var j=p[m++],v=s.idToIndex[j],y=s.layoutNodes[v].children;if(y.length>0){s.graphSet.push(y);for(l=0;l<y.length;l++)p[++b]=y[l]}}for(l=0;l<s.graphSet.length;l++){var O=s.graphSet[l];for(d=0;d<O.length;d++){var E=s.idToIndex[O[d]];s.indexToGraph[E]=l}}for(l=0;l<s.edgeSize;l++){var w=i[l],_={};_.id=w.data("id"),_.sourceId=w.data("source"),_.targetId=w.data("target");var S=x(a.idealEdgeLength)?a.idealEdgeLength(w):a.idealEdgeLength,M=x(a.edgeElasticity)?a.edgeElasticity(w):a.edgeElasticity,k=s.idToIndex[_.sourceId],C=s.idToIndex[_.targetId];if(s.indexToGraph[k]!=s.indexToGraph[C]){for(var T=Zs(_.sourceId,_.targetId,s),F=s.graphSet[T],I=0,D=s.layoutNodes[k];-1===F.indexOf(D.id);)D=s.layoutNodes[s.idToIndex[D.parentId]],I++;for(D=s.layoutNodes[C];-1===F.indexOf(D.id);)D=s.layoutNodes[s.idToIndex[D.parentId]],I++;S*=I*a.nestingFactor}_.idealLength=S,_.elasticity=M,s.layoutEdges.push(_)}return s},Zs=function(e,t,a){var i=er(e,t,0,a);return 2>i.count?0:i.graph},er=function e(t,a,i,n){var s=n.graphSet[i];if(-1<s.indexOf(t)&&-1<s.indexOf(a))return{count:2,graph:i};for(var r=0,o=0;o<s.length;o++){var l=s[o],c=n.idToIndex[l],d=n.layoutNodes[c].children;if(0!==d.length){var u=e(t,a,n.indexToGraph[n.idToIndex[d[0]]],n);if(0!==u.count){if(1!==u.count)return u;if(2===++r)break}}}return{count:r,graph:i}},tr=function(e,t){for(var a=e.clientWidth,i=e.clientHeight,n=0;n<e.nodeSize;n++){var s=e.layoutNodes[n];0!==s.children.length||s.isLocked||(s.positionX=Math.random()*a,s.positionY=Math.random()*i)}},ar=function(e,t,a){var i=e.boundingBox,n={x1:1/0,x2:-1/0,y1:1/0,y2:-1/0};return t.boundingBox&&(a.forEach((function(t){var a=e.layoutNodes[e.idToIndex[t.data("id")]];n.x1=Math.min(n.x1,a.positionX),n.x2=Math.max(n.x2,a.positionX),n.y1=Math.min(n.y1,a.positionY),n.y2=Math.max(n.y2,a.positionY)})),n.w=n.x2-n.x1,n.h=n.y2-n.y1),function(a,s){var r=e.layoutNodes[e.idToIndex[a.data("id")]];if(t.boundingBox){var o=(r.positionX-n.x1)/n.w,l=(r.positionY-n.y1)/n.h;return{x:i.x1+o*i.w,y:i.y1+l*i.h}}return{x:r.positionX,y:r.positionY}}},ir=function(e,t,a){var i=a.layout,n=a.eles.nodes(),s=ar(e,a,n);n.positions(s),!0!==e.ready&&(e.ready=!0,i.one("layoutready",a.ready),i.emit({type:"layoutready",layout:this}))},nr=function(e,t,a){sr(e,t),dr(e),ur(e,t),pr(e),mr(e)},sr=function(e,t){for(var a=0;a<e.graphSet.length;a++)for(var i=e.graphSet[a],n=i.length,s=0;s<n;s++)for(var r=e.layoutNodes[e.idToIndex[i[s]]],o=s+1;o<n;o++){var l=e.layoutNodes[e.idToIndex[i[o]]];or(r,l,e,t)}},rr=function(e){return-e+2*e*Math.random()},or=function(e,t,a,i){if(e.cmptId===t.cmptId||a.isCompound){var n=t.positionX-e.positionX,s=t.positionY-e.positionY;0===n&&0===s&&(n=rr(1),s=rr(1));var r=lr(e,t,n,s);if(r>0)var o=(c=i.nodeOverlap*r)*n/(h=Math.sqrt(n*n+s*s)),l=c*s/h;else{var c,d=cr(e,n,s),u=cr(t,-1*n,-1*s),p=u.x-d.x,m=u.y-d.y,b=p*p+m*m,h=Math.sqrt(b);o=(c=(e.nodeRepulsion+t.nodeRepulsion)/b)*p/h,l=c*m/h}e.isLocked||(e.offsetX-=o,e.offsetY-=l),t.isLocked||(t.offsetX+=o,t.offsetY+=l)}},lr=function(e,t,a,i){if(a>0)var n=e.maxX-t.minX;else n=t.maxX-e.minX;if(i>0)var s=e.maxY-t.minY;else s=t.maxY-e.minY;return n>=0&&s>=0?Math.sqrt(n*n+s*s):0},cr=function(e,t,a){var i=e.positionX,n=e.positionY,s=e.height||1,r=e.width||1,o=a/t,l=s/r,c={};return 0===t&&0<a||0===t&&0>a?(c.x=i,c.y=n+s/2,c):0<t&&-1*l<=o&&o<=l?(c.x=i+r/2,c.y=n+r*a/2/t,c):0>t&&-1*l<=o&&o<=l?(c.x=i-r/2,c.y=n-r*a/2/t,c):0<a&&(o<=-1*l||o>=l)?(c.x=i+s*t/2/a,c.y=n+s/2,c):0>a&&(o<=-1*l||o>=l)?(c.x=i-s*t/2/a,c.y=n-s/2,c):c},dr=function(e,t){for(var a=0;a<e.edgeSize;a++){var i=e.layoutEdges[a],n=e.idToIndex[i.sourceId],s=e.layoutNodes[n],r=e.idToIndex[i.targetId],o=e.layoutNodes[r],l=o.positionX-s.positionX,c=o.positionY-s.positionY;if(0!==l||0!==c){var d=cr(s,l,c),u=cr(o,-1*l,-1*c),p=u.x-d.x,m=u.y-d.y,b=Math.sqrt(p*p+m*m),h=Math.pow(i.idealLength-b,2)/i.elasticity;if(0!==b)var f=h*p/b,g=h*m/b;else f=0,g=0;s.isLocked||(s.offsetX+=f,s.offsetY+=g),o.isLocked||(o.offsetX-=f,o.offsetY-=g)}}},ur=function(e,t){for(var a=0;a<e.graphSet.length;a++){var i=e.graphSet[a],n=i.length;if(0===a)var s=e.clientHeight/2,r=e.clientWidth/2;else{var o=e.layoutNodes[e.idToIndex[i[0]]],l=e.layoutNodes[e.idToIndex[o.parentId]];s=l.positionX,r=l.positionY}for(var c=0;c<n;c++){var d=e.layoutNodes[e.idToIndex[i[c]]];if(!d.isLocked){var u=s-d.positionX,p=r-d.positionY,m=Math.sqrt(u*u+p*p);if(m>1){var b=t.gravity*u/m,h=t.gravity*p/m;d.offsetX+=b,d.offsetY+=h}}}}},pr=function(e,t){var a=[],i=0,n=-1;for(a.push.apply(a,e.graphSet[0]),n+=e.graphSet[0].length;i<=n;){var s=a[i++],r=e.idToIndex[s],o=e.layoutNodes[r],l=o.children;if(0<l.length&&!o.isLocked){for(var c=o.offsetX,d=o.offsetY,u=0;u<l.length;u++){var p=e.layoutNodes[e.idToIndex[l[u]]];p.offsetX+=c,p.offsetY+=d,a[++n]=l[u]}o.offsetX=0,o.offsetY=0}}},mr=function(e,t){for(var a=0;a<e.nodeSize;a++){0<(n=e.layoutNodes[a]).children.length&&(n.maxX=void 0,n.minX=void 0,n.maxY=void 0,n.minY=void 0)}for(a=0;a<e.nodeSize;a++){if(!(0<(n=e.layoutNodes[a]).children.length||n.isLocked)){var i=br(n.offsetX,n.offsetY,e.temperature);n.positionX+=i.x,n.positionY+=i.y,n.offsetX=0,n.offsetY=0,n.minX=n.positionX-n.width,n.maxX=n.positionX+n.width,n.minY=n.positionY-n.height,n.maxY=n.positionY+n.height,hr(n,e)}}for(a=0;a<e.nodeSize;a++){var n;0<(n=e.layoutNodes[a]).children.length&&!n.isLocked&&(n.positionX=(n.maxX+n.minX)/2,n.positionY=(n.maxY+n.minY)/2,n.width=n.maxX-n.minX,n.height=n.maxY-n.minY)}},br=function(e,t,a){var i=Math.sqrt(e*e+t*t);if(i>a)var n={x:a*e/i,y:a*t/i};else n={x:e,y:t};return n},hr=function e(t,a){var i=t.parentId;if(null!=i){var n=a.layoutNodes[a.idToIndex[i]],s=!1;return(null==n.maxX||t.maxX+n.padRight>n.maxX)&&(n.maxX=t.maxX+n.padRight,s=!0),(null==n.minX||t.minX-n.padLeft<n.minX)&&(n.minX=t.minX-n.padLeft,s=!0),(null==n.maxY||t.maxY+n.padBottom>n.maxY)&&(n.maxY=t.maxY+n.padBottom,s=!0),(null==n.minY||t.minY-n.padTop<n.minY)&&(n.minY=t.minY-n.padTop,s=!0),s?e(n,a):void 0}},fr=function(e,t){for(var a=e.layoutNodes,i=[],n=0;n<a.length;n++){var s=a[n],r=s.cmptId;(i[r]=i[r]||[]).push(s)}var o=0;for(n=0;n<i.length;n++){if(h=i[n]){h.x1=1/0,h.x2=-1/0,h.y1=1/0,h.y2=-1/0;for(var l=0;l<h.length;l++){var c=h[l];h.x1=Math.min(h.x1,c.positionX-c.width/2),h.x2=Math.max(h.x2,c.positionX+c.width/2),h.y1=Math.min(h.y1,c.positionY-c.height/2),h.y2=Math.max(h.y2,c.positionY+c.height/2)}h.w=h.x2-h.x1,h.h=h.y2-h.y1,o+=h.w*h.h}}i.sort((function(e,t){return t.w*t.h-e.w*e.h}));var d=0,u=0,p=0,m=0,b=Math.sqrt(o)*e.clientWidth/e.clientHeight;for(n=0;n<i.length;n++){var h;if(h=i[n]){for(l=0;l<h.length;l++){(c=h[l]).isLocked||(c.positionX+=d-h.x1,c.positionY+=u-h.y1)}d+=h.w+t.componentSpacing,p+=h.w+t.componentSpacing,m=Math.max(m,h.h),p>b&&(u+=m+t.componentSpacing,d=0,p=0,m=0)}}},gr={fit:!0,padding:30,boundingBox:void 0,avoidOverlap:!0,avoidOverlapPadding:10,nodeDimensionsIncludeLabels:!1,spacingFactor:void 0,condense:!1,rows:void 0,cols:void 0,position:function(e){},sort:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,t){return!0},ready:void 0,stop:void 0,transform:function(e,t){return t}};function jr(e){this.options=N({},gr,e)}jr.prototype.run=function(){var e=this.options,t=e,a=e.cy,i=t.eles.nodes().not(":parent");t.sort&&(i=i.sort(t.sort));var n=Ke(t.boundingBox?t.boundingBox:{x1:0,y1:0,w:a.width(),h:a.height()});if(0===n.h||0===n.w)i.layoutPositions(this,t,(function(e){return{x:n.x1,y:n.y1}}));else{var s=i.size(),r=Math.sqrt(s*n.h/n.w),o=Math.round(r),l=Math.round(n.w/n.h*r),c=function(e){if(null==e)return Math.min(o,l);Math.min(o,l)==o?o=e:l=e},d=function(e){if(null==e)return Math.max(o,l);Math.max(o,l)==o?o=e:l=e},u=t.rows,p=null!=t.cols?t.cols:t.columns;if(null!=u&&null!=p)o=u,l=p;else if(null!=u&&null==p)o=u,l=Math.ceil(s/o);else if(null==u&&null!=p)l=p,o=Math.ceil(s/l);else if(l*o>s){var m=c(),b=d();(m-1)*b>=s?c(m-1):(b-1)*m>=s&&d(b-1)}else for(;l*o<s;){var h=c(),f=d();(f+1)*h>=s?d(f+1):c(h+1)}var g=n.w/l,j=n.h/o;if(t.condense&&(g=0,j=0),t.avoidOverlap)for(var x=0;x<i.length;x++){var v=i[x],y=v._private.position;null!=y.x&&null!=y.y||(y.x=0,y.y=0);var O=v.layoutDimensions(t),E=t.avoidOverlapPadding,w=O.w+E,_=O.h+E;g=Math.max(g,w),j=Math.max(j,_)}for(var S={},M=function(e,t){return!!S["c-"+e+"-"+t]},k=function(e,t){S["c-"+e+"-"+t]=!0},C=0,T=0,F=function(){++T>=l&&(T=0,C++)},I={},D=0;D<i.length;D++){var A=i[D],L=t.position(A);if(L&&(void 0!==L.row||void 0!==L.col)){var R={row:L.row,col:L.col};if(void 0===R.col)for(R.col=0;M(R.row,R.col);)R.col++;else if(void 0===R.row)for(R.row=0;M(R.row,R.col);)R.row++;I[A.id()]=R,k(R.row,R.col)}}i.layoutPositions(this,t,(function(e,t){var a,i;if(e.locked()||e.isParent())return!1;var s=I[e.id()];if(s)a=s.col*g+g/2+n.x1,i=s.row*j+j/2+n.y1;else{for(;M(C,T);)F();a=T*g+g/2+n.x1,i=C*j+j/2+n.y1,k(C,T),F()}return{x:a,y:i}}))}return this};var xr={ready:function(){},stop:function(){}};function vr(e){this.options=N({},xr,e)}vr.prototype.run=function(){var e=this.options,t=e.eles,a=this;e.cy;return a.emit("layoutstart"),t.nodes().positions((function(){return{x:0,y:0}})),a.one("layoutready",e.ready),a.emit("layoutready"),a.one("layoutstop",e.stop),a.emit("layoutstop"),this},vr.prototype.stop=function(){return this};var yr={positions:void 0,zoom:void 0,pan:void 0,fit:!0,padding:30,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,t){return!0},ready:void 0,stop:void 0,transform:function(e,t){return t}};function Or(e){this.options=N({},yr,e)}Or.prototype.run=function(){var e=this.options,t=e.eles.nodes(),a=x(e.positions);return t.layoutPositions(this,e,(function(t,i){var n=function(t){if(null==e.positions)return function(e){return{x:e.x,y:e.y}}(t.position());if(a)return e.positions(t);var i=e.positions[t._private.data.id];return null==i?null:i}(t);return!t.locked()&&null!=n&&n})),this};var Er={fit:!0,padding:30,boundingBox:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,t){return!0},ready:void 0,stop:void 0,transform:function(e,t){return t}};function wr(e){this.options=N({},Er,e)}wr.prototype.run=function(){var e=this.options,t=e.cy,a=e.eles.nodes().not(":parent"),i=Ke(e.boundingBox?e.boundingBox:{x1:0,y1:0,w:t.width(),h:t.height()});return a.layoutPositions(this,e,(function(e,t){return{x:i.x1+Math.round(Math.random()*i.w),y:i.y1+Math.round(Math.random()*i.h)}})),this};var _r=[{name:"breadthfirst",impl:Gs},{name:"circle",impl:Hs},{name:"concentric",impl:Ys},{name:"cose",impl:Qs},{name:"grid",impl:jr},{name:"null",impl:vr},{name:"preset",impl:Or},{name:"random",impl:wr}];function Sr(e){this.options=e,this.notifications=0}var Mr=function(){};Sr.prototype={recalculateRenderedStyle:Mr,notify:function(){this.notifications++},init:Mr,isHeadless:function(){return!0}};var kr={arrowShapeWidth:.3,registerArrowShapes:function(){var e=this.arrowShapes={},t=this,a=function(e,t,a,i,n,s,r){var o=n.x-a/2-r,l=n.x+a/2+r,c=n.y-a/2-r,d=n.y+a/2+r;return o<=e&&e<=l&&c<=t&&t<=d},i=function(e,t,a,i,n){var s=e*Math.cos(i)-t*Math.sin(i),r=(e*Math.sin(i)+t*Math.cos(i))*a;return{x:s*a+n.x,y:r+n.y}},n=function(e,t,a,n){for(var s=[],r=0;r<e.length;r+=2){var o=e[r],l=e[r+1];s.push(i(o,l,t,a,n))}return s},s=function(e){for(var t=[],a=0;a<e.length;a++){var i=e[a];t.push(i.x,i.y)}return t},r=function(e){return e.pstyle("width").pfValue*e.pstyle("arrow-scale").pfValue*2},o=function(i,o){j(o)&&(o=e[o]),e[i]=N({name:i,points:[-.15,-.3,.15,-.3,.15,.3,-.15,.3],collide:function(e,t,a,i,r,o){var l=s(n(this.points,a+2*o,i,r));return pt(e,t,l)},roughCollide:a,draw:function(e,a,i,s){var r=n(this.points,a,i,s);t.arrowShapeImpl("polygon")(e,r)},spacing:function(e){return 0},gap:r},o)};o("none",{collide:re,roughCollide:re,draw:le,spacing:oe,gap:oe}),o("triangle",{points:[-.15,-.3,0,0,.15,-.3]}),o("arrow","triangle"),o("triangle-backcurve",{points:e.triangle.points,controlPoint:[0,-.15],roughCollide:a,draw:function(e,a,s,r,o){var l=n(this.points,a,s,r),c=this.controlPoint,d=i(c[0],c[1],a,s,r);t.arrowShapeImpl(this.name)(e,l,d)},gap:function(e){return.8*r(e)}}),o("triangle-tee",{points:[0,0,.15,-.3,-.15,-.3,0,0],pointsTee:[-.15,-.4,-.15,-.5,.15,-.5,.15,-.4],collide:function(e,t,a,i,r,o,l){var c=s(n(this.points,a+2*l,i,r)),d=s(n(this.pointsTee,a+2*l,i,r));return pt(e,t,c)||pt(e,t,d)},draw:function(e,a,i,s,r){var o=n(this.points,a,i,s),l=n(this.pointsTee,a,i,s);t.arrowShapeImpl(this.name)(e,o,l)}}),o("triangle-cross",{points:[0,0,.15,-.3,-.15,-.3,0,0],baseCrossLinePts:[-.15,-.4,-.15,-.4,.15,-.4,.15,-.4],crossLinePts:function(e,t){var a=this.baseCrossLinePts.slice(),i=t/e;return a[3]=a[3]-i,a[5]=a[5]-i,a},collide:function(e,t,a,i,r,o,l){var c=s(n(this.points,a+2*l,i,r)),d=s(n(this.crossLinePts(a,o),a+2*l,i,r));return pt(e,t,c)||pt(e,t,d)},draw:function(e,a,i,s,r){var o=n(this.points,a,i,s),l=n(this.crossLinePts(a,r),a,i,s);t.arrowShapeImpl(this.name)(e,o,l)}}),o("vee",{points:[-.15,-.3,0,0,.15,-.3,0,-.15],gap:function(e){return.525*r(e)}}),o("circle",{radius:.15,collide:function(e,t,a,i,n,s,r){var o=n;return Math.pow(o.x-e,2)+Math.pow(o.y-t,2)<=Math.pow((a+2*r)*this.radius,2)},draw:function(e,a,i,n,s){t.arrowShapeImpl(this.name)(e,n.x,n.y,this.radius*a)},spacing:function(e){return t.getArrowWidth(e.pstyle("width").pfValue,e.pstyle("arrow-scale").value)*this.radius}}),o("tee",{points:[-.15,0,-.15,-.1,.15,-.1,.15,0],spacing:function(e){return 1},gap:function(e){return 1}}),o("square",{points:[-.15,0,.15,0,.15,-.3,-.15,-.3]}),o("diamond",{points:[-.15,-.15,0,-.3,.15,-.15,0,0],gap:function(e){return e.pstyle("width").pfValue*e.pstyle("arrow-scale").value}}),o("chevron",{points:[0,0,-.15,-.15,-.1,-.2,0,-.1,.1,-.2,.15,-.15],gap:function(e){return.95*e.pstyle("width").pfValue*e.pstyle("arrow-scale").value}})}},Cr={projectIntoViewport:function(e,t){var a=this.cy,i=this.findContainerClientCoords(),n=i[0],s=i[1],r=i[4],o=a.pan(),l=a.zoom();return[((e-n)/r-o.x)/l,((t-s)/r-o.y)/l]},findContainerClientCoords:function(){if(this.containerBB)return this.containerBB;var e=this.container,t=e.getBoundingClientRect(),a=u.getComputedStyle(e),i=function(e){return parseFloat(a.getPropertyValue(e))},n=i("padding-left"),s=i("padding-right"),r=i("padding-top"),o=i("padding-bottom"),l=i("border-left-width"),c=i("border-right-width"),d=i("border-top-width"),p=(i("border-bottom-width"),e.clientWidth),m=e.clientHeight,b=n+s,h=r+o,f=l+c,g=t.width/(p+f),j=p-b,x=m-h,v=t.left+n+l,y=t.top+r+d;return this.containerBB=[v,y,j,x,g]},invalidateContainerClientCoordsCache:function(){this.containerBB=null},findNearestElement:function(e,t,a,i){return this.findNearestElements(e,t,a,i)[0]},findNearestElements:function(e,t,a,i){var n,s,r=this,o=this,l=o.getCachedZSortedEles(),c=[],d=o.cy.zoom(),u=o.cy.hasCompoundNodes(),p=(i?24:8)/d,m=(i?8:2)/d,b=(i?8:2)/d,h=1/0;function f(e,t){if(e.isNode()){if(s)return;s=e,c.push(e)}if(e.isEdge()&&(null==t||t<h))if(n){if(n.pstyle("z-compound-depth").value===e.pstyle("z-compound-depth").value&&n.pstyle("z-compound-depth").value===e.pstyle("z-compound-depth").value)for(var a=0;a<c.length;a++)if(c[a].isEdge()){c[a]=e,n=e,h=null!=t?t:h;break}}else c.push(e),n=e,h=null!=t?t:h}function g(a){var i=a.outerWidth()+2*m,n=a.outerHeight()+2*m,s=i/2,l=n/2,c=a.position();if(c.x-s<=e&&e<=c.x+s&&c.y-l<=t&&t<=c.y+l&&o.nodeShapes[r.getNodeShape(a)].checkPoint(e,t,0,i,n,c.x,c.y))return f(a,0),!0}function j(a){var i,n=a._private,s=n.rscratch,l=a.pstyle("width").pfValue,d=a.pstyle("arrow-scale").value,m=l/2+p,b=m*m,h=2*m,j=n.source,x=n.target;if("segments"===s.edgeType||"straight"===s.edgeType||"haystack"===s.edgeType){for(var v=s.allpts,y=0;y+3<v.length;y+=2)if(lt(e,t,v[y],v[y+1],v[y+2],v[y+3],h)&&b>(i=ut(e,t,v[y],v[y+1],v[y+2],v[y+3])))return f(a,i),!0}else if("bezier"===s.edgeType||"multibezier"===s.edgeType||"self"===s.edgeType||"compound"===s.edgeType)for(v=s.allpts,y=0;y+5<s.allpts.length;y+=4)if(ct(e,t,v[y],v[y+1],v[y+2],v[y+3],v[y+4],v[y+5],h)&&b>(i=dt(e,t,v[y],v[y+1],v[y+2],v[y+3],v[y+4],v[y+5])))return f(a,i),!0;j=j||n.source,x=x||n.target;var O=r.getArrowWidth(l,d),E=[{name:"source",x:s.arrowStartX,y:s.arrowStartY,angle:s.srcArrowAngle},{name:"target",x:s.arrowEndX,y:s.arrowEndY,angle:s.tgtArrowAngle},{name:"mid-source",x:s.midX,y:s.midY,angle:s.midsrcArrowAngle},{name:"mid-target",x:s.midX,y:s.midY,angle:s.midtgtArrowAngle}];for(y=0;y<E.length;y++){var w=E[y],_=o.arrowShapes[a.pstyle(w.name+"-arrow-shape").value],S=a.pstyle("width").pfValue;if(_.roughCollide(e,t,O,w.angle,{x:w.x,y:w.y},S,p)&&_.collide(e,t,O,w.angle,{x:w.x,y:w.y},S,p))return f(a),!0}u&&c.length>0&&(g(j),g(x))}function x(e,t,a){return xe(e,t,a)}function v(a,i){var n,s=a._private,r=b;n=i?i+"-":"";var o=s.labelBounds[i||"main"],l=a.pstyle(n+"label").value;if("yes"===a.pstyle("text-events").strValue&&l){var c=s.rstyle,d=x(c,"labelX",i),u=x(c,"labelY",i),p=x(s.rscratch,"labelAngle",i),m=o.x1-r,h=o.x2+r,g=o.y1-r,j=o.y2+r;if(p){var v=Math.cos(p),y=Math.sin(p),O=function(e,t){return{x:(e-=d)*v-(t-=u)*y+d,y:e*y+t*v+u}},E=O(m,g),w=O(m,j),_=O(h,g),S=O(h,j),M=[E.x,E.y,_.x,_.y,S.x,S.y,w.x,w.y];if(pt(e,t,M))return f(a),!0}else if(st(o,e,t))return f(a),!0}}a&&(l=l.interactive);for(var y=l.length-1;y>=0;y--){var O=l[y];O.isNode()?g(O)||v(O):j(O)||v(O)||v(O,"source")||v(O,"target")}return c},getAllInBox:function(e,t,a,i){for(var n,s,r=this.getCachedZSortedEles().interactive,o=[],l=Math.min(e,a),c=Math.max(e,a),d=Math.min(t,i),u=Math.max(t,i),p=Ke({x1:e=l,y1:t=d,x2:a=c,y2:i=u}),m=0;m<r.length;m++){var b=r[m];if(b.isNode()){var h=b,f=h.boundingBox({includeNodes:!0,includeEdges:!1,includeLabels:!1});nt(p,f)&&!rt(f,p)&&o.push(h)}else{var g=b,j=g._private,x=j.rscratch;if(null!=x.startX&&null!=x.startY&&!st(p,x.startX,x.startY))continue;if(null!=x.endX&&null!=x.endY&&!st(p,x.endX,x.endY))continue;if("bezier"===x.edgeType||"multibezier"===x.edgeType||"self"===x.edgeType||"compound"===x.edgeType||"segments"===x.edgeType||"haystack"===x.edgeType){for(var v=j.rstyle.bezierPts||j.rstyle.linePts||j.rstyle.haystackPts,y=!0,O=0;O<v.length;O++)if(n=p,s=v[O],!st(n,s.x,s.y)){y=!1;break}y&&o.push(g)}else"haystack"!==x.edgeType&&"straight"!==x.edgeType||o.push(g)}}return o}},Tr={calculateArrowAngles:function(e){var t,a,i,n,s,r,o=e._private.rscratch,l="haystack"===o.edgeType,c="bezier"===o.edgeType,d="multibezier"===o.edgeType,u="segments"===o.edgeType,p="compound"===o.edgeType,m="self"===o.edgeType;if(l?(i=o.haystackPts[0],n=o.haystackPts[1],s=o.haystackPts[2],r=o.haystackPts[3]):(i=o.arrowStartX,n=o.arrowStartY,s=o.arrowEndX,r=o.arrowEndY),h=o.midX,f=o.midY,u)t=i-o.segpts[0],a=n-o.segpts[1];else if(d||p||m||c){var b=o.allpts;t=i-Ye(b[0],b[2],b[4],.1),a=n-Ye(b[1],b[3],b[5],.1)}else t=i-h,a=n-f;o.srcArrowAngle=Ue(t,a);var h=o.midX,f=o.midY;if(l&&(h=(i+s)/2,f=(n+r)/2),t=s-i,a=r-n,u)if((b=o.allpts).length/2%2==0){var g=(j=b.length/2)-2;t=b[j]-b[g],a=b[j+1]-b[g+1]}else{g=(j=b.length/2-1)-2;var j,x=j+2;t=b[j]-b[g],a=b[j+1]-b[g+1]}else if(d||p||m){var v,y,O,E,b=o.allpts;if(o.ctrlpts.length/2%2==0){var w=(_=(S=b.length/2-1)+2)+2;v=Ye(b[S],b[_],b[w],0),y=Ye(b[S+1],b[_+1],b[w+1],0),O=Ye(b[S],b[_],b[w],1e-4),E=Ye(b[S+1],b[_+1],b[w+1],1e-4)}else{var _,S;w=(_=b.length/2-1)+2;v=Ye(b[S=_-2],b[_],b[w],.4999),y=Ye(b[S+1],b[_+1],b[w+1],.4999),O=Ye(b[S],b[_],b[w],.5),E=Ye(b[S+1],b[_+1],b[w+1],.5)}t=O-v,a=E-y}(o.midtgtArrowAngle=Ue(t,a),o.midDispX=t,o.midDispY=a,t*=-1,a*=-1,u)&&((b=o.allpts).length/2%2==0||(t=-(b[x=(j=b.length/2-1)+2]-b[j]),a=-(b[x+1]-b[j+1])));if(o.midsrcArrowAngle=Ue(t,a),u)t=s-o.segpts[o.segpts.length-2],a=r-o.segpts[o.segpts.length-1];else if(d||p||m||c){var M=(b=o.allpts).length;t=s-Ye(b[M-6],b[M-4],b[M-2],.9),a=r-Ye(b[M-5],b[M-3],b[M-1],.9)}else t=s-h,a=r-f;o.tgtArrowAngle=Ue(t,a)}};Tr.getArrowWidth=Tr.getArrowHeight=function(e,t){var a=this.arrowWidthCache=this.arrowWidthCache||{},i=a[e+", "+t];return i||(i=Math.max(Math.pow(13.37*e,.9),29)*t,a[e+", "+t]=i,i)};var Fr={};function Ir(e){var t=[];if(null!=e){for(var a=0;a<e.length;a+=2){var i=e[a],n=e[a+1];t.push({x:i,y:n})}return t}}Fr.findHaystackPoints=function(e){for(var t=0;t<e.length;t++){var a=e[t],i=a._private,n=i.rscratch;if(!n.haystack){var s=2*Math.random()*Math.PI;n.source={x:Math.cos(s),y:Math.sin(s)},s=2*Math.random()*Math.PI,n.target={x:Math.cos(s),y:Math.sin(s)}}var r=i.source,o=i.target,l=r.position(),c=o.position(),d=r.width(),u=o.width(),p=r.height(),m=o.height(),b=a.pstyle("haystack-radius").value/2;n.haystackPts=n.allpts=[n.source.x*d*b+l.x,n.source.y*p*b+l.y,n.target.x*u*b+c.x,n.target.y*m*b+c.y],n.midX=(n.allpts[0]+n.allpts[2])/2,n.midY=(n.allpts[1]+n.allpts[3])/2,n.edgeType="haystack",n.haystack=!0,this.storeEdgeProjections(a),this.calculateArrowAngles(a),this.recalculateEdgeLabelProjections(a),this.calculateLabelAngles(a)}},Fr.findSegmentsPoints=function(e,t){var a=e._private.rscratch,i=t.posPts,n=t.intersectionPts,s=t.vectorNormInverse,r=e.pstyle("edge-distances").value,o=e.pstyle("segment-weights"),l=e.pstyle("segment-distances"),c=Math.min(o.pfValue.length,l.pfValue.length);a.edgeType="segments",a.segpts=[];for(var d=0;d<c;d++){var u=o.pfValue[d],p=l.pfValue[d],m=1-u,b=u,h="node-position"===r?i:n,f={x:h.x1*m+h.x2*b,y:h.y1*m+h.y2*b};a.segpts.push(f.x+s.x*p,f.y+s.y*p)}},Fr.findLoopPoints=function(e,t,a,i){var n=e._private.rscratch,s=t.dirCounts,r=t.srcPos,o=e.pstyle("control-point-distances"),l=o?o.pfValue[0]:void 0,c=e.pstyle("loop-direction").pfValue,d=e.pstyle("loop-sweep").pfValue,u=e.pstyle("control-point-step-size").pfValue;n.edgeType="self";var p=a,m=u;i&&(p=0,m=l);var b=c-Math.PI/2,h=b-d/2,f=b+d/2,g=String(c+"_"+d);p=void 0===s[g]?s[g]=0:++s[g],n.ctrlpts=[r.x+1.4*Math.cos(h)*m*(p/3+1),r.y+1.4*Math.sin(h)*m*(p/3+1),r.x+1.4*Math.cos(f)*m*(p/3+1),r.y+1.4*Math.sin(f)*m*(p/3+1)]},Fr.findCompoundLoopPoints=function(e,t,a,i){var n=e._private.rscratch;n.edgeType="compound";var s=t.srcPos,r=t.tgtPos,o=t.srcW,l=t.srcH,c=t.tgtW,d=t.tgtH,u=e.pstyle("control-point-step-size").pfValue,p=e.pstyle("control-point-distances"),m=p?p.pfValue[0]:void 0,b=a,h=u;i&&(b=0,h=m);var f={x:s.x-o/2,y:s.y-l/2},g={x:r.x-c/2,y:r.y-d/2},j={x:Math.min(f.x,g.x),y:Math.min(f.y,g.y)},x=Math.max(.5,Math.log(.01*o)),v=Math.max(.5,Math.log(.01*c));n.ctrlpts=[j.x,j.y-(1+Math.pow(50,1.12)/100)*h*(b/3+1)*x,j.x-(1+Math.pow(50,1.12)/100)*h*(b/3+1)*v,j.y]},Fr.findStraightEdgePoints=function(e){e._private.rscratch.edgeType="straight"},Fr.findBezierPoints=function(e,t,a,i,n){var s=e._private.rscratch,r=t.vectorNormInverse,o=t.posPts,l=t.intersectionPts,c=e.pstyle("edge-distances").value,d=e.pstyle("control-point-step-size").pfValue,u=e.pstyle("control-point-distances"),p=e.pstyle("control-point-weights"),m=u&&p?Math.min(u.value.length,p.value.length):1,b=u?u.pfValue[0]:void 0,h=p.value[0],f=i;s.edgeType=f?"multibezier":"bezier",s.ctrlpts=[];for(var g=0;g<m;g++){var j=(.5-t.eles.length/2+a)*d*(n?-1:1),x=void 0,v=qe(j);f&&(b=u?u.pfValue[g]:d,h=p.value[g]);var y=void 0!==(x=i?b:void 0!==b?v*b:void 0)?x:j,O=1-h,E=h,w="node-position"===c?o:l,_={x:w.x1*O+w.x2*E,y:w.y1*O+w.y2*E};s.ctrlpts.push(_.x+r.x*y,_.y+r.y*y)}},Fr.findTaxiPoints=function(e,t){var a=e._private.rscratch;a.edgeType="segments";var i="vertical",n="horizontal",s="leftward",r="rightward",o="downward",l="upward",c=t.posPts,d=t.srcW,u=t.srcH,p=t.tgtW,m=t.tgtH,b="node-position"!==e.pstyle("edge-distances").value,h=e.pstyle("taxi-direction").value,f=h,g=e.pstyle("taxi-turn"),j=g.pfValue,x=e.pstyle("taxi-turn-min-distance").pfValue,v="%"===g.units,y=b?(d+p)/2:0,O=b?(u+m)/2:0,E=c.x2-c.x1,w=c.y2-c.y1,_=function(e,t){return e>0?Math.max(e-t,0):Math.min(e+t,0)},S=_(E,y),M=_(w,O),k=!1;"auto"===h?h=Math.abs(S)>Math.abs(M)?n:i:h===l||h===o?(h=i,k=!0):h!==s&&h!==r||(h=n,k=!0);var C=h===i,T=C?M:S,F=C?w:E,I=qe(F),D=!1;k&&v||!(f===o&&F<0||f===l&&F>0||f===s&&F>0||f===r&&F<0)||(T=(I*=-1)*Math.abs(T),D=!0);var A=v?j*T:j*I,L=function(e){return Math.abs(e)<x||Math.abs(e)>=Math.abs(T)},R=L(A),P=L(T-A);if((R||P)&&!D)if(C){var N=Math.abs(F)<=u/2,z=Math.abs(E)<=p/2;if(N){var B=(c.x1+c.x2)/2,J=c.y1,V=c.y2;a.segpts=[B,J,B,V]}else if(z){var U=(c.y1+c.y2)/2,G=c.x1,q=c.x2;a.segpts=[G,U,q,U]}else a.segpts=[c.x1,c.y2]}else{var H=Math.abs(F)<=d/2,W=Math.abs(w)<=m/2;if(H){var $=(c.y1+c.y2)/2,Y=c.x1,X=c.x2;a.segpts=[Y,$,X,$]}else if(W){var Q=(c.x1+c.x2)/2,K=c.y1,Z=c.y2;a.segpts=[Q,K,Q,Z]}else a.segpts=[c.x2,c.y1]}else if(C){var ee=c.y1+A+(b?u/2*I:0),te=c.x1,ae=c.x2;a.segpts=[te,ee,ae,ee]}else{var ie=c.x1+A+(b?d/2*I:0),ne=c.y1,se=c.y2;a.segpts=[ie,ne,ie,se]}},Fr.tryToCorrectInvalidPoints=function(e,t){var a=e._private.rscratch;if("bezier"===a.edgeType){var i=t.srcPos,n=t.tgtPos,s=t.srcW,r=t.srcH,o=t.tgtW,l=t.tgtH,c=t.srcShape,d=t.tgtShape,u=!O(a.startX)||!O(a.startY),p=!O(a.arrowStartX)||!O(a.arrowStartY),m=!O(a.endX)||!O(a.endY),b=!O(a.arrowEndX)||!O(a.arrowEndY),h=3*(this.getArrowWidth(e.pstyle("width").pfValue,e.pstyle("arrow-scale").value)*this.arrowShapeWidth),f=He({x:a.ctrlpts[0],y:a.ctrlpts[1]},{x:a.startX,y:a.startY}),g=f<h,j=He({x:a.ctrlpts[0],y:a.ctrlpts[1]},{x:a.endX,y:a.endY}),x=j<h,v=!1;if(u||p||g){v=!0;var y={x:a.ctrlpts[0]-i.x,y:a.ctrlpts[1]-i.y},E=Math.sqrt(y.x*y.x+y.y*y.y),w={x:y.x/E,y:y.y/E},_=Math.max(s,r),S={x:a.ctrlpts[0]+2*w.x*_,y:a.ctrlpts[1]+2*w.y*_},M=c.intersectLine(i.x,i.y,s,r,S.x,S.y,0);g?(a.ctrlpts[0]=a.ctrlpts[0]+w.x*(h-f),a.ctrlpts[1]=a.ctrlpts[1]+w.y*(h-f)):(a.ctrlpts[0]=M[0]+w.x*h,a.ctrlpts[1]=M[1]+w.y*h)}if(m||b||x){v=!0;var k={x:a.ctrlpts[0]-n.x,y:a.ctrlpts[1]-n.y},C=Math.sqrt(k.x*k.x+k.y*k.y),T={x:k.x/C,y:k.y/C},F=Math.max(s,r),I={x:a.ctrlpts[0]+2*T.x*F,y:a.ctrlpts[1]+2*T.y*F},D=d.intersectLine(n.x,n.y,o,l,I.x,I.y,0);x?(a.ctrlpts[0]=a.ctrlpts[0]+T.x*(h-j),a.ctrlpts[1]=a.ctrlpts[1]+T.y*(h-j)):(a.ctrlpts[0]=D[0]+T.x*h,a.ctrlpts[1]=D[1]+T.y*h)}v&&this.findEndpoints(e)}},Fr.storeAllpts=function(e){var t=e._private.rscratch;if("multibezier"===t.edgeType||"bezier"===t.edgeType||"self"===t.edgeType||"compound"===t.edgeType){t.allpts=[],t.allpts.push(t.startX,t.startY);for(var a=0;a+1<t.ctrlpts.length;a+=2)t.allpts.push(t.ctrlpts[a],t.ctrlpts[a+1]),a+3<t.ctrlpts.length&&t.allpts.push((t.ctrlpts[a]+t.ctrlpts[a+2])/2,(t.ctrlpts[a+1]+t.ctrlpts[a+3])/2);var i;t.allpts.push(t.endX,t.endY),t.ctrlpts.length/2%2==0?(i=t.allpts.length/2-1,t.midX=t.allpts[i],t.midY=t.allpts[i+1]):(i=t.allpts.length/2-3,.5,t.midX=Ye(t.allpts[i],t.allpts[i+2],t.allpts[i+4],.5),t.midY=Ye(t.allpts[i+1],t.allpts[i+3],t.allpts[i+5],.5))}else if("straight"===t.edgeType)t.allpts=[t.startX,t.startY,t.endX,t.endY],t.midX=(t.startX+t.endX+t.arrowStartX+t.arrowEndX)/4,t.midY=(t.startY+t.endY+t.arrowStartY+t.arrowEndY)/4;else if("segments"===t.edgeType)if(t.allpts=[],t.allpts.push(t.startX,t.startY),t.allpts.push.apply(t.allpts,t.segpts),t.allpts.push(t.endX,t.endY),t.segpts.length%4==0){var n=t.segpts.length/2,s=n-2;t.midX=(t.segpts[s]+t.segpts[n])/2,t.midY=(t.segpts[s+1]+t.segpts[n+1])/2}else{var r=t.segpts.length/2-1;t.midX=t.segpts[r],t.midY=t.segpts[r+1]}},Fr.checkForInvalidEdgeWarning=function(e){var t=e[0]._private.rscratch;t.nodesOverlap||O(t.startX)&&O(t.startY)&&O(t.endX)&&O(t.endY)?t.loggedErr=!1:t.loggedErr||(t.loggedErr=!0,ue("Edge `"+e.id()+"` has invalid endpoints and so it is impossible to draw.  Adjust your edge style (e.g. control points) accordingly or use an alternative edge type.  This is expected behaviour when the source node and the target node overlap."))},Fr.findEdgeControlPoints=function(e){var t=this;if(e&&0!==e.length){for(var a=this,i=a.cy.hasCompoundNodes(),n={map:new ye,get:function(e){var t=this.map.get(e[0]);return null!=t?t.get(e[1]):null},set:function(e,t){var a=this.map.get(e[0]);null==a&&(a=new ye,this.map.set(e[0],a)),a.set(e[1],t)}},s=[],r=[],o=0;o<e.length;o++){var l=e[o],c=l._private,d=l.pstyle("curve-style").value;if(!l.removed()&&l.takesUpSpace())if("haystack"!==d){var u="unbundled-bezier"===d||"segments"===d||"straight"===d||"taxi"===d,p="unbundled-bezier"===d||"bezier"===d,m=c.source,b=c.target,h=[m.poolIndex(),b.poolIndex()].sort(),f=n.get(h);null==f&&(f={eles:[]},n.set(h,f),s.push(h)),f.eles.push(l),u&&(f.hasUnbundled=!0),p&&(f.hasBezier=!0)}else r.push(l)}for(var g=function(e){var r=s[e],o=n.get(r),l=void 0;if(!o.hasUnbundled){var c=o.eles[0].parallelEdges().filter((function(e){return e.isBundledBezier()}));je(o.eles),c.forEach((function(e){return o.eles.push(e)})),o.eles.sort((function(e,t){return e.poolIndex()-t.poolIndex()}))}var d=o.eles[0],u=d.source(),p=d.target();if(u.poolIndex()>p.poolIndex()){var m=u;u=p,p=m}var b=o.srcPos=u.position(),h=o.tgtPos=p.position(),f=o.srcW=u.outerWidth(),g=o.srcH=u.outerHeight(),j=o.tgtW=p.outerWidth(),x=o.tgtH=p.outerHeight(),v=o.srcShape=a.nodeShapes[t.getNodeShape(u)],y=o.tgtShape=a.nodeShapes[t.getNodeShape(p)];o.dirCounts={north:0,west:0,south:0,east:0,northwest:0,southwest:0,northeast:0,southeast:0};for(var E=0;E<o.eles.length;E++){var w=o.eles[E],_=w[0]._private.rscratch,S=w.pstyle("curve-style").value,M="unbundled-bezier"===S||"segments"===S||"taxi"===S,k=!u.same(w.source());if(!o.calculatedIntersection&&u!==p&&(o.hasBezier||o.hasUnbundled)){o.calculatedIntersection=!0;var C=v.intersectLine(b.x,b.y,f,g,h.x,h.y,0),T=o.srcIntn=C,F=y.intersectLine(h.x,h.y,j,x,b.x,b.y,0),I=o.tgtIntn=F,D=o.intersectionPts={x1:C[0],x2:F[0],y1:C[1],y2:F[1]},A=o.posPts={x1:b.x,x2:h.x,y1:b.y,y2:h.y},L=F[1]-C[1],R=F[0]-C[0],P=Math.sqrt(R*R+L*L),N=o.vector={x:R,y:L},z=o.vectorNorm={x:N.x/P,y:N.y/P},B={x:-z.y,y:z.x};o.nodesOverlap=!O(P)||y.checkPoint(C[0],C[1],0,j,x,h.x,h.y)||v.checkPoint(F[0],F[1],0,f,g,b.x,b.y),o.vectorNormInverse=B,l={nodesOverlap:o.nodesOverlap,dirCounts:o.dirCounts,calculatedIntersection:!0,hasBezier:o.hasBezier,hasUnbundled:o.hasUnbundled,eles:o.eles,srcPos:h,tgtPos:b,srcW:j,srcH:x,tgtW:f,tgtH:g,srcIntn:I,tgtIntn:T,srcShape:y,tgtShape:v,posPts:{x1:A.x2,y1:A.y2,x2:A.x1,y2:A.y1},intersectionPts:{x1:D.x2,y1:D.y2,x2:D.x1,y2:D.y1},vector:{x:-N.x,y:-N.y},vectorNorm:{x:-z.x,y:-z.y},vectorNormInverse:{x:-B.x,y:-B.y}}}var J=k?l:o;_.nodesOverlap=J.nodesOverlap,_.srcIntn=J.srcIntn,_.tgtIntn=J.tgtIntn,i&&(u.isParent()||u.isChild()||p.isParent()||p.isChild())&&(u.parents().anySame(p)||p.parents().anySame(u)||u.same(p)&&u.isParent())?t.findCompoundLoopPoints(w,J,E,M):u===p?t.findLoopPoints(w,J,E,M):"segments"===S?t.findSegmentsPoints(w,J):"taxi"===S?t.findTaxiPoints(w,J):"straight"===S||!M&&o.eles.length%2==1&&E===Math.floor(o.eles.length/2)?t.findStraightEdgePoints(w):t.findBezierPoints(w,J,E,M,k),t.findEndpoints(w),t.tryToCorrectInvalidPoints(w,J),t.checkForInvalidEdgeWarning(w),t.storeAllpts(w),t.storeEdgeProjections(w),t.calculateArrowAngles(w),t.recalculateEdgeLabelProjections(w),t.calculateLabelAngles(w)}},j=0;j<s.length;j++)g(j);this.findHaystackPoints(r)}},Fr.getSegmentPoints=function(e){var t=e[0]._private.rscratch;if("segments"===t.edgeType)return this.recalculateRenderedStyle(e),Ir(t.segpts)},Fr.getControlPoints=function(e){var t=e[0]._private.rscratch,a=t.edgeType;if("bezier"===a||"multibezier"===a||"self"===a||"compound"===a)return this.recalculateRenderedStyle(e),Ir(t.ctrlpts)},Fr.getEdgeMidpoint=function(e){var t=e[0]._private.rscratch;return this.recalculateRenderedStyle(e),{x:t.midX,y:t.midY}};var Dr={manualEndptToPx:function(e,t){var a=e.position(),i=e.outerWidth(),n=e.outerHeight();if(2===t.value.length){var s=[t.pfValue[0],t.pfValue[1]];return"%"===t.units[0]&&(s[0]=s[0]*i),"%"===t.units[1]&&(s[1]=s[1]*n),s[0]+=a.x,s[1]+=a.y,s}var r=t.pfValue[0];r=-Math.PI/2+r;var o=2*Math.max(i,n),l=[a.x+Math.cos(r)*o,a.y+Math.sin(r)*o];return this.nodeShapes[this.getNodeShape(e)].intersectLine(a.x,a.y,i,n,l[0],l[1],0)},findEndpoints:function(e){var t,a,i,n,s,r=this,o=e.source()[0],l=e.target()[0],c=o.position(),d=l.position(),u=e.pstyle("target-arrow-shape").value,p=e.pstyle("source-arrow-shape").value,m=e.pstyle("target-distance-from-node").pfValue,b=e.pstyle("source-distance-from-node").pfValue,h=e.pstyle("curve-style").value,f=e._private.rscratch,g=f.edgeType,j="self"===g||"compound"===g,x="bezier"===g||"multibezier"===g||j,v="bezier"!==g,y="straight"===g||"segments"===g,E="segments"===g,w=x||v||y,_=j||"taxi"===h,S=e.pstyle("source-endpoint"),M=_?"outside-to-node":S.value,k=e.pstyle("target-endpoint"),C=_?"outside-to-node":k.value;if(f.srcManEndpt=S,f.tgtManEndpt=k,x){var T=[f.ctrlpts[0],f.ctrlpts[1]];a=v?[f.ctrlpts[f.ctrlpts.length-2],f.ctrlpts[f.ctrlpts.length-1]]:T,i=T}else if(y){var F=E?f.segpts.slice(0,2):[d.x,d.y];a=E?f.segpts.slice(f.segpts.length-2):[c.x,c.y],i=F}if("inside-to-node"===C)t=[d.x,d.y];else if(k.units)t=this.manualEndptToPx(l,k);else if("outside-to-line"===C)t=f.tgtIntn;else if("outside-to-node"===C||"outside-to-node-or-label"===C?n=a:"outside-to-line"!==C&&"outside-to-line-or-label"!==C||(n=[c.x,c.y]),t=r.nodeShapes[this.getNodeShape(l)].intersectLine(d.x,d.y,l.outerWidth(),l.outerHeight(),n[0],n[1],0),"outside-to-node-or-label"===C||"outside-to-line-or-label"===C){var I=l._private.rscratch,D=I.labelWidth,A=I.labelHeight,L=I.labelX,R=I.labelY,P=l.pstyle("text-valign").value;"top"===P?R-=A/2:"bottom"===P&&(R+=A/2);var N=l.pstyle("text-halign").value;"left"===N?L-=D/2:"right"===N&&(L+=D/2);var z=r.nodeShapes.rectangle.intersectLine(L,R,D,A,n[0],n[1],0),B=c,J=We(B,Ve(t));We(B,Ve(z))<J&&(t=z)}var V=yt(t,a,r.arrowShapes[u].spacing(e)+m),U=yt(t,a,r.arrowShapes[u].gap(e)+m);if(f.endX=U[0],f.endY=U[1],f.arrowEndX=V[0],f.arrowEndY=V[1],"inside-to-node"===M)t=[c.x,c.y];else if(S.units)t=this.manualEndptToPx(o,S);else if("outside-to-line"===M)t=f.srcIntn;else if("outside-to-node"===M||"outside-to-node-or-label"===M?s=i:"outside-to-line"!==M&&"outside-to-line-or-label"!==M||(s=[d.x,d.y]),t=r.nodeShapes[this.getNodeShape(o)].intersectLine(c.x,c.y,o.outerWidth(),o.outerHeight(),s[0],s[1],0),"outside-to-node-or-label"===M||"outside-to-line-or-label"===M){var G=o._private.rscratch,q=G.labelWidth,H=G.labelHeight,W=G.labelX,$=G.labelY,Y=o.pstyle("text-valign").value;"top"===Y?$-=H/2:"bottom"===Y&&($+=H/2);var X=o.pstyle("text-halign").value;"left"===X?W-=q/2:"right"===X&&(W+=q/2);var Q=r.nodeShapes.rectangle.intersectLine(W,$,q,H,s[0],s[1],0),K=d,Z=We(K,Ve(t));We(K,Ve(Q))<Z&&(t=Q)}var ee=yt(t,i,r.arrowShapes[p].spacing(e)+b),te=yt(t,i,r.arrowShapes[p].gap(e)+b);f.startX=te[0],f.startY=te[1],f.arrowStartX=ee[0],f.arrowStartY=ee[1],w&&(O(f.startX)&&O(f.startY)&&O(f.endX)&&O(f.endY)?f.badLine=!1:f.badLine=!0)},getSourceEndpoint:function(e){var t=e[0]._private.rscratch;return this.recalculateRenderedStyle(e),"haystack"===t.edgeType?{x:t.haystackPts[0],y:t.haystackPts[1]}:{x:t.arrowStartX,y:t.arrowStartY}},getTargetEndpoint:function(e){var t=e[0]._private.rscratch;return this.recalculateRenderedStyle(e),"haystack"===t.edgeType?{x:t.haystackPts[2],y:t.haystackPts[3]}:{x:t.arrowEndX,y:t.arrowEndY}}},Ar={};function Lr(e,t,a){for(var i=function(e,t,a,i){return Ye(e,t,a,i)},n=t._private.rstyle.bezierPts,s=0;s<e.bezierProjPcts.length;s++){var r=e.bezierProjPcts[s];n.push({x:i(a[0],a[2],a[4],r),y:i(a[1],a[3],a[5],r)})}}Ar.storeEdgeProjections=function(e){var t=e._private,a=t.rscratch,i=a.edgeType;if(t.rstyle.bezierPts=null,t.rstyle.linePts=null,t.rstyle.haystackPts=null,"multibezier"===i||"bezier"===i||"self"===i||"compound"===i){t.rstyle.bezierPts=[];for(var n=0;n+5<a.allpts.length;n+=4)Lr(this,e,a.allpts.slice(n,n+6))}else if("segments"===i){var s=t.rstyle.linePts=[];for(n=0;n+1<a.allpts.length;n+=2)s.push({x:a.allpts[n],y:a.allpts[n+1]})}else if("haystack"===i){var r=a.haystackPts;t.rstyle.haystackPts=[{x:r[0],y:r[1]},{x:r[2],y:r[3]}]}t.rstyle.arrowWidth=this.getArrowWidth(e.pstyle("width").pfValue,e.pstyle("arrow-scale").value)*this.arrowShapeWidth},Ar.recalculateEdgeProjections=function(e){this.findEdgeControlPoints(e)};var Rr={recalculateNodeLabelProjection:function(e){var t=e.pstyle("label").strValue;if(!C(t)){var a,i,n=e._private,s=e.width(),r=e.height(),o=e.padding(),l=e.position(),c=e.pstyle("text-halign").strValue,d=e.pstyle("text-valign").strValue,u=n.rscratch,p=n.rstyle;switch(c){case"left":a=l.x-s/2-o;break;case"right":a=l.x+s/2+o;break;default:a=l.x}switch(d){case"top":i=l.y-r/2-o;break;case"bottom":i=l.y+r/2+o;break;default:i=l.y}u.labelX=a,u.labelY=i,p.labelX=a,p.labelY=i,this.applyLabelDimensions(e)}}},Pr=function(e,t){var a=Math.atan(t/e);return 0===e&&a<0&&(a*=-1),a},Nr=function(e,t){var a=t.x-e.x,i=t.y-e.y;return Pr(a,i)};Rr.recalculateEdgeLabelProjections=function(e){var t,a=e._private,i=a.rscratch,n=this,s={mid:e.pstyle("label").strValue,source:e.pstyle("source-label").strValue,target:e.pstyle("target-label").strValue};if(s.mid||s.source||s.target){t={x:i.midX,y:i.midY};var r=function(e,t,i){ve(a.rscratch,e,t,i),ve(a.rstyle,e,t,i)};r("labelX",null,t.x),r("labelY",null,t.y);var o=Pr(i.midDispX,i.midDispY);r("labelAutoAngle",null,o);var l=function e(){if(e.cache)return e.cache;for(var t=[],s=0;s+5<i.allpts.length;s+=4){var r={x:i.allpts[s],y:i.allpts[s+1]},o={x:i.allpts[s+2],y:i.allpts[s+3]},l={x:i.allpts[s+4],y:i.allpts[s+5]};t.push({p0:r,p1:o,p2:l,startDist:0,length:0,segments:[]})}var c=a.rstyle.bezierPts,d=n.bezierProjPcts.length;function u(e,t,a,i,n){var s=He(t,a),r=e.segments[e.segments.length-1],o={p0:t,p1:a,t0:i,t1:n,startDist:r?r.startDist+r.length:0,length:s};e.segments.push(o),e.length+=s}for(var p=0;p<t.length;p++){var m=t[p],b=t[p-1];b&&(m.startDist=b.startDist+b.length),u(m,m.p0,c[p*d],0,n.bezierProjPcts[0]);for(var h=0;h<d-1;h++)u(m,c[p*d+h],c[p*d+h+1],n.bezierProjPcts[h],n.bezierProjPcts[h+1]);u(m,c[p*d+d-1],m.p2,n.bezierProjPcts[d-1],1)}return e.cache=t},c=function(a){var n,o="source"===a;if(s[a]){var c=e.pstyle(a+"-text-offset").pfValue;switch(i.edgeType){case"self":case"compound":case"bezier":case"multibezier":for(var d,u=l(),p=0,m=0,b=0;b<u.length;b++){for(var h=u[o?b:u.length-1-b],f=0;f<h.segments.length;f++){var g=h.segments[o?f:h.segments.length-1-f],j=b===u.length-1&&f===h.segments.length-1;if(p=m,(m+=g.length)>=c||j){d={cp:h,segment:g};break}}if(d)break}var x=d.cp,v=d.segment,y=(c-p)/v.length,O=v.t1-v.t0,E=o?v.t0+O*y:v.t1-O*y;E=Qe(0,E,1),t=Xe(x.p0,x.p1,x.p2,E),n=function(e,t,a,i){var n=Qe(0,i-.001,1),s=Qe(0,i+.001,1),r=Xe(e,t,a,n),o=Xe(e,t,a,s);return Nr(r,o)}(x.p0,x.p1,x.p2,E);break;case"straight":case"segments":case"haystack":for(var w,_,S,M,k=0,C=i.allpts.length,T=0;T+3<C&&(o?(S={x:i.allpts[T],y:i.allpts[T+1]},M={x:i.allpts[T+2],y:i.allpts[T+3]}):(S={x:i.allpts[C-2-T],y:i.allpts[C-1-T]},M={x:i.allpts[C-4-T],y:i.allpts[C-3-T]}),_=k,!((k+=w=He(S,M))>=c));T+=2);var F=(c-_)/w;F=Qe(0,F,1),t=function(e,t,a,i){var n=t.x-e.x,s=t.y-e.y,r=He(e,t),o=n/r,l=s/r;return a=null==a?0:a,i=null!=i?i:a*r,{x:e.x+o*i,y:e.y+l*i}}(S,M,F),n=Nr(S,M)}r("labelX",a,t.x),r("labelY",a,t.y),r("labelAutoAngle",a,n)}};c("source"),c("target"),this.applyLabelDimensions(e)}},Rr.applyLabelDimensions=function(e){this.applyPrefixedLabelDimensions(e),e.isEdge()&&(this.applyPrefixedLabelDimensions(e,"source"),this.applyPrefixedLabelDimensions(e,"target"))},Rr.applyPrefixedLabelDimensions=function(e,t){var a=e._private,i=this.getLabelText(e,t),n=this.calculateLabelDimensions(e,i),s=e.pstyle("line-height").pfValue,r=e.pstyle("text-wrap").strValue,o=xe(a.rscratch,"labelWrapCachedLines",t)||[],l="wrap"!==r?1:Math.max(o.length,1),c=n.height/l,d=c*s,u=n.width,p=n.height+(l-1)*(s-1)*c;ve(a.rstyle,"labelWidth",t,u),ve(a.rscratch,"labelWidth",t,u),ve(a.rstyle,"labelHeight",t,p),ve(a.rscratch,"labelHeight",t,p),ve(a.rscratch,"labelLineHeight",t,d)},Rr.getLabelText=function(e,t){var a=e._private,i=t?t+"-":"",n=e.pstyle(i+"label").strValue,s=e.pstyle("text-transform").value,r=function(e,i){return i?(ve(a.rscratch,e,t,i),i):xe(a.rscratch,e,t)};if(!n)return"";"none"==s||("uppercase"==s?n=n.toUpperCase():"lowercase"==s&&(n=n.toLowerCase()));var o=e.pstyle("text-wrap").value;if("wrap"===o){var l=r("labelKey");if(null!=l&&r("labelWrapKey")===l)return r("labelWrapCachedText");for(var c=n.split("\n"),d=e.pstyle("text-max-width").pfValue,u="anywhere"===e.pstyle("text-overflow-wrap").value,p=[],m=/[\s\u200b]+/,b=u?"":" ",h=0;h<c.length;h++){var f=c[h],g=this.calculateLabelDimensions(e,f).width;if(u){var j=f.split("").join("​");f=j}if(g>d){for(var x=f.split(m),v="",y=0;y<x.length;y++){var O=x[y],E=0===v.length?O:v+b+O;this.calculateLabelDimensions(e,E).width<=d?v+=O+b:(p.push(v),v=O+b)}v.match(/^[\s\u200b]+$/)||p.push(v)}else p.push(f)}r("labelWrapCachedLines",p),n=r("labelWrapCachedText",p.join("\n")),r("labelWrapKey",l)}else if("ellipsis"===o){for(var w=e.pstyle("text-max-width").pfValue,_="",S=!1,M=0;M<n.length;M++){if(this.calculateLabelDimensions(e,_+n[M]+"…").width>w)break;_+=n[M],M===n.length-1&&(S=!0)}return S||(_+="…"),_}return n},Rr.getLabelJustification=function(e){var t=e.pstyle("text-justification").strValue,a=e.pstyle("text-halign").strValue;if("auto"!==t)return t;if(!e.isNode())return"center";switch(a){case"left":return"right";case"right":return"left";default:return"center"}},Rr.calculateLabelDimensions=function(e,t){var a=K(t,e._private.labelDimsKey),i=this.labelDimCache||(this.labelDimCache=[]),n=i[a];if(null!=n)return n;var s=e.pstyle("font-style").strValue,r=1*e.pstyle("font-size").pfValue+"px",o=e.pstyle("font-family").strValue,l=e.pstyle("font-weight").strValue,c=this.labelCalcDiv;c||(c=this.labelCalcDiv=document.createElement("div"),document.body.appendChild(c));var d=c.style;return d.fontFamily=o,d.fontStyle=s,d.fontSize=r,d.fontWeight=l,d.position="absolute",d.left="-9999px",d.top="-9999px",d.zIndex="-1",d.visibility="hidden",d.pointerEvents="none",d.padding="0",d.lineHeight="1","wrap"===e.pstyle("text-wrap").value?d.whiteSpace="pre":d.whiteSpace="normal",c.textContent=t,i[a]={width:Math.ceil(c.clientWidth/1),height:Math.ceil(c.clientHeight/1)}},Rr.calculateLabelAngle=function(e,t){var a=e._private.rscratch,i=e.isEdge(),n=t?t+"-":"",s=e.pstyle(n+"text-rotation"),r=s.strValue;return"none"===r?0:i&&"autorotate"===r?a.labelAutoAngle:"autorotate"===r?0:s.pfValue},Rr.calculateLabelAngles=function(e){var t=this,a=e.isEdge(),i=e._private.rscratch;i.labelAngle=t.calculateLabelAngle(e),a&&(i.sourceLabelAngle=t.calculateLabelAngle(e,"source"),i.targetLabelAngle=t.calculateLabelAngle(e,"target"))};var zr={},Br=!1;zr.getNodeShape=function(e){var t=e.pstyle("shape").value;if("cutrectangle"===t&&(e.width()<28||e.height()<28))return Br||(ue("The `cutrectangle` node shape can not be used at small sizes so `rectangle` is used instead"),Br=!0),"rectangle";if(e.isParent())return"rectangle"===t||"roundrectangle"===t||"cutrectangle"===t||"barrel"===t?t:"rectangle";if("polygon"===t){var a=e.pstyle("shape-polygon-points").value;return this.nodeShapes.makePolygon(a).name}return t};var Jr={registerCalculationListeners:function(){var e=this.cy,t=e.collection(),a=this,i=function(e){var a=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(t.merge(e),a)for(var i=0;i<e.length;i++){var n=e[i],s=n._private,r=s.rstyle;r.clean=!1,r.cleanConnected=!1}};a.binder(e).on("bounds.* dirty.*",(function(e){var t=e.target;i(t)})).on("style.* background.*",(function(e){var t=e.target;i(t,!1)}));var n=function(n){if(n){for(var s=a.onUpdateEleCalcsFns,r=0;r<t.length;r++){var o=t[r],l=o._private.rstyle;o.isNode()&&!l.cleanConnected&&(i(o.connectedEdges()),l.cleanConnected=!0)}if(s)for(r=0;r<s.length;r++){(0,s[r])(n,t)}a.recalculateRenderedStyle(t),t=e.collection()}};a.flushRenderedStyleQueue=function(){n(!0)},a.beforeRender(n,a.beforeRenderPriorities.eleCalcs)},onUpdateEleCalcs:function(e){(this.onUpdateEleCalcsFns=this.onUpdateEleCalcsFns||[]).push(e)},recalculateRenderedStyle:function(e,t){var a=[],i=[];if(!this.destroyed){void 0===t&&(t=!0);for(var n=0;n<e.length;n++){var s=(l=(o=e[n])._private).rstyle;t&&s.clean||o.removed()||"none"!==o.pstyle("display").value&&("nodes"===l.group?i.push(o):a.push(o),s.clean=!0)}for(n=0;n<i.length;n++){s=(l=(o=i[n])._private).rstyle;var r=o.position();this.recalculateNodeLabelProjection(o),s.nodeX=r.x,s.nodeY=r.y,s.nodeW=o.pstyle("width").pfValue,s.nodeH=o.pstyle("height").pfValue}this.recalculateEdgeProjections(a);for(n=0;n<a.length;n++){s=(l=(o=a[n])._private).rstyle;var o,l,c=l.rscratch;s.srcX=c.arrowStartX,s.srcY=c.arrowStartY,s.tgtX=c.arrowEndX,s.tgtY=c.arrowEndY,s.midX=c.midX,s.midY=c.midY,s.labelAngle=c.labelAngle,s.sourceLabelAngle=c.sourceLabelAngle,s.targetLabelAngle=c.targetLabelAngle}}}},Vr={updateCachedGrabbedEles:function(){var e=this.cachedZSortedEles;if(e){e.drag=[],e.nondrag=[];for(var t=[],a=0;a<e.length;a++){var i=(n=e[a])._private.rscratch;n.grabbed()&&!n.isParent()?t.push(n):i.inDragLayer?e.drag.push(n):e.nondrag.push(n)}for(a=0;a<t.length;a++){var n=t[a];e.drag.push(n)}}},invalidateCachedZSortedEles:function(){this.cachedZSortedEles=null},getCachedZSortedEles:function(e){if(e||!this.cachedZSortedEles){var t=this.cy.mutableElements().toArray();t.sort(Tn),t.interactive=t.filter((function(e){return e.interactive()})),this.cachedZSortedEles=t,this.updateCachedGrabbedEles()}else t=this.cachedZSortedEles;return t}},Ur={};[Cr,Tr,Fr,Dr,Ar,Rr,zr,Jr,Vr].forEach((function(e){N(Ur,e)}));var Gr={getCachedImage:function(e,t,a){var i=this.imageCache=this.imageCache||{},n=i[e];if(n)return n.image.complete||n.image.addEventListener("load",a),n.image;var s=(n=i[e]=i[e]||{}).image=new Image;s.addEventListener("load",a),s.addEventListener("error",(function(){s.error=!0}));var r="data:";return e.substring(0,r.length).toLowerCase()===r||(s.crossOrigin=t),s.src=e,s}},qr={registerBinding:function(e,t,a,i){var n=Array.prototype.slice.apply(arguments,[1]),s=this.binder(e);return s.on.apply(s,n)}};qr.binder=function(e){var t,a=this,i=e===window||e===document||e===document.body||(t=e,"undefined"!=typeof HTMLElement&&t instanceof HTMLElement);if(null==a.supportsPassiveEvents){var n=!1;try{var s=Object.defineProperty({},"passive",{get:function(){return n=!0,!0}});window.addEventListener("test",null,s)}catch(e){}a.supportsPassiveEvents=n}var r=function(t,n,s){var r=Array.prototype.slice.call(arguments);return i&&a.supportsPassiveEvents&&(r[2]={capture:null!=s&&s,passive:!1,once:!1}),a.bindings.push({target:e,args:r}),(e.addEventListener||e.on).apply(e,r),this};return{on:r,addEventListener:r,addListener:r,bind:r}},qr.nodeIsDraggable=function(e){return e&&e.isNode()&&!e.locked()&&e.grabbable()},qr.nodeIsGrabbable=function(e){return this.nodeIsDraggable(e)&&e.interactive()},qr.load=function(){var e=this,t=function(e){return e.selected()},a=function(t,a,i,n){null==t&&(t=e.cy);for(var s=0;s<a.length;s++){var r=a[s];t.emit({originalEvent:i,type:r,position:n})}},i=function(e){return e.shiftKey||e.metaKey||e.ctrlKey},s=function(t,a){var i=!0;if(e.cy.hasCompoundNodes()&&t&&t.pannable())for(var n=0;a&&n<a.length;n++){if((t=a[n]).isNode()&&t.isParent()){i=!1;break}}else i=!0;return i},r=function(e){e[0]._private.rscratch.inDragLayer=!0},o=function(e){e[0]._private.rscratch.isGrabTarget=!0},l=function(e,t){var a=t.addToList;a.has(e)||(a.merge(e),function(e){e[0]._private.grabbed=!0}(e))},c=function(t,a){a=a||{};var i=t.cy().hasCompoundNodes();a.inDragLayer&&(t.forEach(r),t.neighborhood().stdFilter((function(e){return!i||e.isEdge()})).forEach(r)),a.addToList&&t.forEach((function(e){l(e,a)})),function(e,t){if(e.cy().hasCompoundNodes()&&(null!=t.inDragLayer||null!=t.addToList)){var a=e.descendants();t.inDragLayer&&(a.forEach(r),a.connectedEdges().forEach(r)),t.addToList&&t.addToList.unmerge(a)}}(t,a),p(t,{inDragLayer:a.inDragLayer}),e.updateCachedGrabbedEles()},d=c,u=function(t){t&&(e.getCachedZSortedEles().forEach((function(e){!function(e){e[0]._private.grabbed=!1}(e),function(e){e[0]._private.rscratch.inDragLayer=!1}(e),function(e){e[0]._private.rscratch.isGrabTarget=!1}(e)})),e.updateCachedGrabbedEles())},p=function(e,t){if((null!=t.inDragLayer||null!=t.addToList)&&e.cy().hasCompoundNodes()){var a=e.ancestors().orphans();if(!a.same(e)){var i=a.descendants().spawnSelf().merge(a).unmerge(e).unmerge(e.descendants()),n=i.connectedEdges();t.inDragLayer&&(n.forEach(r),i.forEach(r)),t.addToList&&i.forEach((function(e){l(e,t)}))}}},m=function(){null!=document.activeElement&&null!=document.activeElement.blur&&document.activeElement.blur()},b="undefined"!=typeof MutationObserver,h="undefined"!=typeof ResizeObserver;b?(e.removeObserver=new MutationObserver((function(t){for(var a=0;a<t.length;a++){var i=t[a].removedNodes;if(i)for(var n=0;n<i.length;n++){if(i[n]===e.container){e.destroy();break}}}})),e.container.parentNode&&e.removeObserver.observe(e.container.parentNode,{childList:!0})):e.registerBinding(e.container,"DOMNodeRemoved",(function(t){e.destroy()}));var f=n((function(){e.cy.resize()}),100);b&&(e.styleObserver=new MutationObserver(f),e.styleObserver.observe(e.container,{attributes:!0})),e.registerBinding(window,"resize",f),h&&(e.resizeObserver=new ResizeObserver(f),e.resizeObserver.observe(e.container));var g=function(){e.invalidateContainerClientCoordsCache()};!function(e,t){for(;null!=e;)t(e),e=e.parentNode}(e.container,(function(t){e.registerBinding(t,"transitionend",g),e.registerBinding(t,"animationend",g),e.registerBinding(t,"scroll",g)})),e.registerBinding(e.container,"contextmenu",(function(e){e.preventDefault()}));var j=function(t){for(var a=e.findContainerClientCoords(),i=a[0],n=a[1],s=a[2],r=a[3],o=t.touches?t.touches:[t],l=!1,c=0;c<o.length;c++){var d=o[c];if(i<=d.clientX&&d.clientX<=i+s&&n<=d.clientY&&d.clientY<=n+r){l=!0;break}}if(!l)return!1;for(var u=e.container,p=t.target.parentNode,m=!1;p;){if(p===u){m=!0;break}p=p.parentNode}return!!m};e.registerBinding(e.container,"mousedown",(function(t){if(j(t)){t.preventDefault(),m(),e.hoverData.capture=!0,e.hoverData.which=t.which;var i=e.cy,n=[t.clientX,t.clientY],s=e.projectIntoViewport(n[0],n[1]),r=e.selection,l=e.findNearestElements(s[0],s[1],!0,!1),u=l[0],p=e.dragData.possibleDragElements;e.hoverData.mdownPos=s,e.hoverData.mdownGPos=n;if(3==t.which){e.hoverData.cxtStarted=!0;var b={originalEvent:t,type:"cxttapstart",position:{x:s[0],y:s[1]}};u?(u.activate(),u.emit(b),e.hoverData.down=u):i.emit(b),e.hoverData.downTime=(new Date).getTime(),e.hoverData.cxtDragged=!1}else if(1==t.which){if(u&&u.activate(),null!=u&&e.nodeIsGrabbable(u)){var h=function(e){return{originalEvent:t,type:e,position:{x:s[0],y:s[1]}}};if(o(u),u.selected()){p=e.dragData.possibleDragElements=i.collection();var f=i.$((function(t){return t.isNode()&&t.selected()&&e.nodeIsGrabbable(t)}));c(f,{addToList:p}),u.emit(h("grabon")),f.forEach((function(e){e.emit(h("grab"))}))}else p=e.dragData.possibleDragElements=i.collection(),d(u,{addToList:p}),u.emit(h("grabon")).emit(h("grab"));e.redrawHint("eles",!0),e.redrawHint("drag",!0)}e.hoverData.down=u,e.hoverData.downs=l,e.hoverData.downTime=(new Date).getTime(),a(u,["mousedown","tapstart","vmousedown"],t,{x:s[0],y:s[1]}),null==u?(r[4]=1,e.data.bgActivePosistion={x:s[0],y:s[1]},e.redrawHint("select",!0),e.redraw()):u.pannable()&&(r[4]=1),e.hoverData.tapholdCancelled=!1,clearTimeout(e.hoverData.tapholdTimeout),e.hoverData.tapholdTimeout=setTimeout((function(){if(!e.hoverData.tapholdCancelled){var a=e.hoverData.down;a?a.emit({originalEvent:t,type:"taphold",position:{x:s[0],y:s[1]}}):i.emit({originalEvent:t,type:"taphold",position:{x:s[0],y:s[1]}})}}),e.tapholdDuration)}r[0]=r[2]=s[0],r[1]=r[3]=s[1]}}),!1),e.registerBinding(window,"mousemove",(function(t){if(e.hoverData.capture||j(t)){var n=!1,r=e.cy,o=r.zoom(),l=[t.clientX,t.clientY],d=e.projectIntoViewport(l[0],l[1]),p=e.hoverData.mdownPos,m=e.hoverData.mdownGPos,b=e.selection,h=null;e.hoverData.draggingEles||e.hoverData.dragging||e.hoverData.selecting||(h=e.findNearestElement(d[0],d[1],!0,!1));var f,g=e.hoverData.last,x=e.hoverData.down,v=[d[0]-b[2],d[1]-b[3]],y=e.dragData.possibleDragElements;if(m){var E=l[0]-m[0],w=E*E,_=l[1]-m[1],S=w+_*_;e.hoverData.isOverThresholdDrag=f=S>=e.desktopTapThreshold2}var M=i(t);f&&(e.hoverData.tapholdCancelled=!0);n=!0,a(h,["mousemove","vmousemove","tapdrag"],t,{x:d[0],y:d[1]});var k=function(){e.data.bgActivePosistion=void 0,e.hoverData.selecting||r.emit({originalEvent:t,type:"boxstart",position:{x:d[0],y:d[1]}}),b[4]=1,e.hoverData.selecting=!0,e.redrawHint("select",!0),e.redraw()};if(3===e.hoverData.which){if(f){var C={originalEvent:t,type:"cxtdrag",position:{x:d[0],y:d[1]}};x?x.emit(C):r.emit(C),e.hoverData.cxtDragged=!0,e.hoverData.cxtOver&&h===e.hoverData.cxtOver||(e.hoverData.cxtOver&&e.hoverData.cxtOver.emit({originalEvent:t,type:"cxtdragout",position:{x:d[0],y:d[1]}}),e.hoverData.cxtOver=h,h&&h.emit({originalEvent:t,type:"cxtdragover",position:{x:d[0],y:d[1]}}))}}else if(e.hoverData.dragging){if(n=!0,r.panningEnabled()&&r.userPanningEnabled()){var T;if(e.hoverData.justStartedPan){var F=e.hoverData.mdownPos;T={x:(d[0]-F[0])*o,y:(d[1]-F[1])*o},e.hoverData.justStartedPan=!1}else T={x:v[0]*o,y:v[1]*o};r.panBy(T),e.hoverData.dragged=!0}d=e.projectIntoViewport(t.clientX,t.clientY)}else if(1!=b[4]||null!=x&&!x.pannable()){if(x&&x.pannable()&&x.active()&&x.unactivate(),x&&x.grabbed()||h==g||(g&&a(g,["mouseout","tapdragout"],t,{x:d[0],y:d[1]}),h&&a(h,["mouseover","tapdragover"],t,{x:d[0],y:d[1]}),e.hoverData.last=h),x)if(f){if(r.boxSelectionEnabled()&&M)x&&x.grabbed()&&(u(y),x.emit("freeon"),y.emit("free"),e.dragData.didDrag&&(x.emit("dragfreeon"),y.emit("dragfree"))),k();else if(x&&x.grabbed()&&e.nodeIsDraggable(x)){var I=!e.dragData.didDrag;I&&e.redrawHint("eles",!0),e.dragData.didDrag=!0;var D=r.collection();e.hoverData.draggingEles||c(y,{inDragLayer:!0});var A={x:0,y:0};if(O(v[0])&&O(v[1])&&(A.x+=v[0],A.y+=v[1],I)){var L=e.hoverData.dragDelta;L&&O(L[0])&&O(L[1])&&(A.x+=L[0],A.y+=L[1])}for(var R=0;R<y.length;R++){var P=y[R];e.nodeIsDraggable(P)&&P.grabbed()&&D.merge(P)}e.hoverData.draggingEles=!0,D.silentShift(A).emit("position drag"),e.redrawHint("drag",!0),e.redraw()}}else!function(){var t=e.hoverData.dragDelta=e.hoverData.dragDelta||[];0===t.length?(t.push(v[0]),t.push(v[1])):(t[0]+=v[0],t[1]+=v[1])}();n=!0}else if(f){if(e.hoverData.dragging||!r.boxSelectionEnabled()||!M&&r.panningEnabled()&&r.userPanningEnabled()){if(!e.hoverData.selecting&&r.panningEnabled()&&r.userPanningEnabled()){s(x,e.hoverData.downs)&&(e.hoverData.dragging=!0,e.hoverData.justStartedPan=!0,b[4]=0,e.data.bgActivePosistion=Ve(p),e.redrawHint("select",!0),e.redraw())}}else k();x&&x.pannable()&&x.active()&&x.unactivate()}return b[2]=d[0],b[3]=d[1],n?(t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),!1):void 0}}),!1),e.registerBinding(window,"mouseup",(function(n){if(e.hoverData.capture){e.hoverData.capture=!1;var s=e.cy,r=e.projectIntoViewport(n.clientX,n.clientY),o=e.selection,l=e.findNearestElement(r[0],r[1],!0,!1),c=e.dragData.possibleDragElements,d=e.hoverData.down,p=i(n);if(e.data.bgActivePosistion&&(e.redrawHint("select",!0),e.redraw()),e.hoverData.tapholdCancelled=!0,e.data.bgActivePosistion=void 0,d&&d.unactivate(),3===e.hoverData.which){var m={originalEvent:n,type:"cxttapend",position:{x:r[0],y:r[1]}};if(d?d.emit(m):s.emit(m),!e.hoverData.cxtDragged){var b={originalEvent:n,type:"cxttap",position:{x:r[0],y:r[1]}};d?d.emit(b):s.emit(b)}e.hoverData.cxtDragged=!1,e.hoverData.which=null}else if(1===e.hoverData.which){if(a(l,["mouseup","tapend","vmouseup"],n,{x:r[0],y:r[1]}),e.dragData.didDrag||e.hoverData.dragged||e.hoverData.selecting||e.hoverData.isOverThresholdDrag||a(d,["click","tap","vclick"],n,{x:r[0],y:r[1]}),null!=d||e.dragData.didDrag||e.hoverData.selecting||e.hoverData.dragged||i(n)||(s.$(t).unselect(["tapunselect"]),c.length>0&&e.redrawHint("eles",!0),e.dragData.possibleDragElements=c=s.collection()),l!=d||e.dragData.didDrag||e.hoverData.selecting||null!=l&&l._private.selectable&&(e.hoverData.dragging||("additive"===s.selectionType()||p?l.selected()?l.unselect(["tapunselect"]):l.select(["tapselect"]):p||(s.$(t).unmerge(l).unselect(["tapunselect"]),l.select(["tapselect"]))),e.redrawHint("eles",!0)),e.hoverData.selecting){var h=s.collection(e.getAllInBox(o[0],o[1],o[2],o[3]));e.redrawHint("select",!0),h.length>0&&e.redrawHint("eles",!0),s.emit({type:"boxend",originalEvent:n,position:{x:r[0],y:r[1]}});var f=function(e){return e.selectable()&&!e.selected()};"additive"===s.selectionType()||p||s.$(t).unmerge(h).unselect(),h.emit("box").stdFilter(f).select().emit("boxselect"),e.redraw()}if(e.hoverData.dragging&&(e.hoverData.dragging=!1,e.redrawHint("select",!0),e.redrawHint("eles",!0),e.redraw()),!o[4]){e.redrawHint("drag",!0),e.redrawHint("eles",!0);var g=d&&d.grabbed();u(c),g&&(d.emit("freeon"),c.emit("free"),e.dragData.didDrag&&(d.emit("dragfreeon"),c.emit("dragfree")))}}o[4]=0,e.hoverData.down=null,e.hoverData.cxtStarted=!1,e.hoverData.draggingEles=!1,e.hoverData.selecting=!1,e.hoverData.isOverThresholdDrag=!1,e.dragData.didDrag=!1,e.hoverData.dragged=!1,e.hoverData.dragDelta=[],e.hoverData.mdownPos=null,e.hoverData.mdownGPos=null}}),!1);var x,v,y,E,w,_,S,M,k,C,T,F,I;e.registerBinding(e.container,"wheel",(function(t){if(!e.scrollingPage){var a,i=e.cy,n=e.projectIntoViewport(t.clientX,t.clientY),s=[n[0]*i.zoom()+i.pan().x,n[1]*i.zoom()+i.pan().y];if(e.hoverData.draggingEles||e.hoverData.dragging||e.hoverData.cxtStarted||0!==e.selection[4])t.preventDefault();else if(i.panningEnabled()&&i.userPanningEnabled()&&i.zoomingEnabled()&&i.userZoomingEnabled())t.preventDefault(),e.data.wheelZooming=!0,clearTimeout(e.data.wheelTimeout),e.data.wheelTimeout=setTimeout((function(){e.data.wheelZooming=!1,e.redrawHint("eles",!0),e.redraw()}),150),a=null!=t.deltaY?t.deltaY/-250:null!=t.wheelDeltaY?t.wheelDeltaY/1e3:t.wheelDelta/1e3,a*=e.wheelSensitivity,1===t.deltaMode&&(a*=33),i.zoom({level:i.zoom()*Math.pow(10,a),renderedPosition:{x:s[0],y:s[1]}})}}),!0),e.registerBinding(window,"scroll",(function(t){e.scrollingPage=!0,clearTimeout(e.scrollingPageTimeout),e.scrollingPageTimeout=setTimeout((function(){e.scrollingPage=!1}),250)}),!0),e.registerBinding(e.container,"mouseout",(function(t){var a=e.projectIntoViewport(t.clientX,t.clientY);e.cy.emit({originalEvent:t,type:"mouseout",position:{x:a[0],y:a[1]}})}),!1),e.registerBinding(e.container,"mouseover",(function(t){var a=e.projectIntoViewport(t.clientX,t.clientY);e.cy.emit({originalEvent:t,type:"mouseover",position:{x:a[0],y:a[1]}})}),!1);var D,A,L,R,P=function(e,t,a,i){return Math.sqrt((a-e)*(a-e)+(i-t)*(i-t))},N=function(e,t,a,i){return(a-e)*(a-e)+(i-t)*(i-t)};if(e.registerBinding(e.container,"touchstart",D=function(t){if(j(t)){m(),e.touchData.capture=!0,e.data.bgActivePosistion=void 0;var i=e.cy,n=e.touchData.now,s=e.touchData.earlier;if(t.touches[0]){var r=e.projectIntoViewport(t.touches[0].clientX,t.touches[0].clientY);n[0]=r[0],n[1]=r[1]}if(t.touches[1]){r=e.projectIntoViewport(t.touches[1].clientX,t.touches[1].clientY);n[2]=r[0],n[3]=r[1]}if(t.touches[2]){r=e.projectIntoViewport(t.touches[2].clientX,t.touches[2].clientY);n[4]=r[0],n[5]=r[1]}if(t.touches[1]){e.touchData.singleTouchMoved=!0,u(e.dragData.touchDragEles);var l=e.findContainerClientCoords();k=l[0],C=l[1],T=l[2],F=l[3],x=t.touches[0].clientX-k,v=t.touches[0].clientY-C,y=t.touches[1].clientX-k,E=t.touches[1].clientY-C,I=0<=x&&x<=T&&0<=y&&y<=T&&0<=v&&v<=F&&0<=E&&E<=F;var p=i.pan(),b=i.zoom();w=P(x,v,y,E),_=N(x,v,y,E),M=[((S=[(x+y)/2,(v+E)/2])[0]-p.x)/b,(S[1]-p.y)/b];if(_<4e4&&!t.touches[2]){var h=e.findNearestElement(n[0],n[1],!0,!0),f=e.findNearestElement(n[2],n[3],!0,!0);return h&&h.isNode()?(h.activate().emit({originalEvent:t,type:"cxttapstart",position:{x:n[0],y:n[1]}}),e.touchData.start=h):f&&f.isNode()?(f.activate().emit({originalEvent:t,type:"cxttapstart",position:{x:n[0],y:n[1]}}),e.touchData.start=f):i.emit({originalEvent:t,type:"cxttapstart",position:{x:n[0],y:n[1]}}),e.touchData.start&&(e.touchData.start._private.grabbed=!1),e.touchData.cxt=!0,e.touchData.cxtDragged=!1,e.data.bgActivePosistion=void 0,void e.redraw()}}if(t.touches[2])i.boxSelectionEnabled()&&t.preventDefault();else if(t.touches[1]);else if(t.touches[0]){var g=e.findNearestElements(n[0],n[1],!0,!0),O=g[0];if(null!=O&&(O.activate(),e.touchData.start=O,e.touchData.starts=g,e.nodeIsGrabbable(O))){var D=e.dragData.touchDragEles=i.collection(),A=null;e.redrawHint("eles",!0),e.redrawHint("drag",!0),O.selected()?(A=i.$((function(t){return t.selected()&&e.nodeIsGrabbable(t)})),c(A,{addToList:D})):d(O,{addToList:D}),o(O);var L=function(e){return{originalEvent:t,type:e,position:{x:n[0],y:n[1]}}};O.emit(L("grabon")),A?A.forEach((function(e){e.emit(L("grab"))})):O.emit(L("grab"))}a(O,["touchstart","tapstart","vmousedown"],t,{x:n[0],y:n[1]}),null==O&&(e.data.bgActivePosistion={x:r[0],y:r[1]},e.redrawHint("select",!0),e.redraw()),e.touchData.singleTouchMoved=!1,e.touchData.singleTouchStartTime=+new Date,clearTimeout(e.touchData.tapholdTimeout),e.touchData.tapholdTimeout=setTimeout((function(){!1!==e.touchData.singleTouchMoved||e.pinching||e.touchData.selecting||a(e.touchData.start,["taphold"],t,{x:n[0],y:n[1]})}),e.tapholdDuration)}if(t.touches.length>=1){for(var R=e.touchData.startPosition=[],z=0;z<n.length;z++)R[z]=s[z]=n[z];var B=t.touches[0];e.touchData.startGPosition=[B.clientX,B.clientY]}}},!1),e.registerBinding(window,"touchmove",A=function(t){var i=e.touchData.capture;if(i||j(t)){var n=e.selection,r=e.cy,o=e.touchData.now,l=e.touchData.earlier,d=r.zoom();if(t.touches[0]){var p=e.projectIntoViewport(t.touches[0].clientX,t.touches[0].clientY);o[0]=p[0],o[1]=p[1]}if(t.touches[1]){p=e.projectIntoViewport(t.touches[1].clientX,t.touches[1].clientY);o[2]=p[0],o[3]=p[1]}if(t.touches[2]){p=e.projectIntoViewport(t.touches[2].clientX,t.touches[2].clientY);o[4]=p[0],o[5]=p[1]}var m,b=e.touchData.startGPosition;if(i&&t.touches[0]&&b){for(var h=[],f=0;f<o.length;f++)h[f]=o[f]-l[f];var g=t.touches[0].clientX-b[0],S=g*g,T=t.touches[0].clientY-b[1];m=S+T*T>=e.touchTapThreshold2}if(i&&e.touchData.cxt){t.preventDefault();var F=t.touches[0].clientX-k,D=t.touches[0].clientY-C,A=t.touches[1].clientX-k,L=t.touches[1].clientY-C,R=N(F,D,A,L);if(R/_>=2.25||R>=22500){e.touchData.cxt=!1,e.data.bgActivePosistion=void 0,e.redrawHint("select",!0);var z={originalEvent:t,type:"cxttapend",position:{x:o[0],y:o[1]}};e.touchData.start?(e.touchData.start.unactivate().emit(z),e.touchData.start=null):r.emit(z)}}if(i&&e.touchData.cxt){z={originalEvent:t,type:"cxtdrag",position:{x:o[0],y:o[1]}};e.data.bgActivePosistion=void 0,e.redrawHint("select",!0),e.touchData.start?e.touchData.start.emit(z):r.emit(z),e.touchData.start&&(e.touchData.start._private.grabbed=!1),e.touchData.cxtDragged=!0;var B=e.findNearestElement(o[0],o[1],!0,!0);e.touchData.cxtOver&&B===e.touchData.cxtOver||(e.touchData.cxtOver&&e.touchData.cxtOver.emit({originalEvent:t,type:"cxtdragout",position:{x:o[0],y:o[1]}}),e.touchData.cxtOver=B,B&&B.emit({originalEvent:t,type:"cxtdragover",position:{x:o[0],y:o[1]}}))}else if(i&&t.touches[2]&&r.boxSelectionEnabled())t.preventDefault(),e.data.bgActivePosistion=void 0,this.lastThreeTouch=+new Date,e.touchData.selecting||r.emit({originalEvent:t,type:"boxstart",position:{x:o[0],y:o[1]}}),e.touchData.selecting=!0,e.touchData.didSelect=!0,n[4]=1,n&&0!==n.length&&void 0!==n[0]?(n[2]=(o[0]+o[2]+o[4])/3,n[3]=(o[1]+o[3]+o[5])/3):(n[0]=(o[0]+o[2]+o[4])/3,n[1]=(o[1]+o[3]+o[5])/3,n[2]=(o[0]+o[2]+o[4])/3+1,n[3]=(o[1]+o[3]+o[5])/3+1),e.redrawHint("select",!0),e.redraw();else if(i&&t.touches[1]&&!e.touchData.didSelect&&r.zoomingEnabled()&&r.panningEnabled()&&r.userZoomingEnabled()&&r.userPanningEnabled()){if(t.preventDefault(),e.data.bgActivePosistion=void 0,e.redrawHint("select",!0),ee=e.dragData.touchDragEles){e.redrawHint("drag",!0);for(var J=0;J<ee.length;J++){var V=ee[J]._private;V.grabbed=!1,V.rscratch.inDragLayer=!1}}var U=e.touchData.start,G=(F=t.touches[0].clientX-k,D=t.touches[0].clientY-C,A=t.touches[1].clientX-k,L=t.touches[1].clientY-C,P(F,D,A,L)),q=G/w;if(I){var H=(F-x+(A-y))/2,W=(D-v+(L-E))/2,$=r.zoom(),Y=$*q,X=r.pan(),Q=M[0]*$+X.x,K=M[1]*$+X.y,Z={x:-Y/$*(Q-X.x-H)+Q,y:-Y/$*(K-X.y-W)+K};if(U&&U.active()){var ee=e.dragData.touchDragEles;u(ee),e.redrawHint("drag",!0),e.redrawHint("eles",!0),U.unactivate().emit("freeon"),ee.emit("free"),e.dragData.didDrag&&(U.emit("dragfreeon"),ee.emit("dragfree"))}r.viewport({zoom:Y,pan:Z,cancelOnFailedZoom:!0}),w=G,x=F,v=D,y=A,E=L,e.pinching=!0}if(t.touches[0]){p=e.projectIntoViewport(t.touches[0].clientX,t.touches[0].clientY);o[0]=p[0],o[1]=p[1]}if(t.touches[1]){p=e.projectIntoViewport(t.touches[1].clientX,t.touches[1].clientY);o[2]=p[0],o[3]=p[1]}if(t.touches[2]){p=e.projectIntoViewport(t.touches[2].clientX,t.touches[2].clientY);o[4]=p[0],o[5]=p[1]}}else if(t.touches[0]&&!e.touchData.didSelect){var te=e.touchData.start,ae=e.touchData.last;if(e.hoverData.draggingEles||e.swipePanning||(B=e.findNearestElement(o[0],o[1],!0,!0)),i&&null!=te&&t.preventDefault(),i&&null!=te&&e.nodeIsDraggable(te))if(m){ee=e.dragData.touchDragEles;var ie=!e.dragData.didDrag;ie&&c(ee,{inDragLayer:!0}),e.dragData.didDrag=!0;var ne={x:0,y:0};if(O(h[0])&&O(h[1]))if(ne.x+=h[0],ne.y+=h[1],ie)e.redrawHint("eles",!0),(se=e.touchData.dragDelta)&&O(se[0])&&O(se[1])&&(ne.x+=se[0],ne.y+=se[1]);e.hoverData.draggingEles=!0,ee.silentShift(ne).emit("position drag"),e.redrawHint("drag",!0),e.touchData.startPosition[0]==l[0]&&e.touchData.startPosition[1]==l[1]&&e.redrawHint("eles",!0),e.redraw()}else{var se;0===(se=e.touchData.dragDelta=e.touchData.dragDelta||[]).length?(se.push(h[0]),se.push(h[1])):(se[0]+=h[0],se[1]+=h[1])}if(a(te||B,["touchmove","tapdrag","vmousemove"],t,{x:o[0],y:o[1]}),te&&te.grabbed()||B==ae||(ae&&ae.emit({originalEvent:t,type:"tapdragout",position:{x:o[0],y:o[1]}}),B&&B.emit({originalEvent:t,type:"tapdragover",position:{x:o[0],y:o[1]}})),e.touchData.last=B,i)for(J=0;J<o.length;J++)o[J]&&e.touchData.startPosition[J]&&m&&(e.touchData.singleTouchMoved=!0);if(i&&(null==te||te.pannable())&&r.panningEnabled()&&r.userPanningEnabled()){s(te,e.touchData.starts)&&(t.preventDefault(),e.data.bgActivePosistion||(e.data.bgActivePosistion=Ve(e.touchData.startPosition)),e.swipePanning?r.panBy({x:h[0]*d,y:h[1]*d}):m&&(e.swipePanning=!0,r.panBy({x:g*d,y:T*d}),te&&(te.unactivate(),e.redrawHint("select",!0),e.touchData.start=null)));p=e.projectIntoViewport(t.touches[0].clientX,t.touches[0].clientY);o[0]=p[0],o[1]=p[1]}}for(f=0;f<o.length;f++)l[f]=o[f];i&&t.touches.length>0&&!e.hoverData.draggingEles&&!e.swipePanning&&null!=e.data.bgActivePosistion&&(e.data.bgActivePosistion=void 0,e.redrawHint("select",!0),e.redraw())}},!1),e.registerBinding(window,"touchcancel",L=function(t){var a=e.touchData.start;e.touchData.capture=!1,a&&a.unactivate()}),e.registerBinding(window,"touchend",R=function(i){var n=e.touchData.start;if(e.touchData.capture){0===i.touches.length&&(e.touchData.capture=!1),i.preventDefault();var s=e.selection;e.swipePanning=!1,e.hoverData.draggingEles=!1;var r,o=e.cy,l=o.zoom(),c=e.touchData.now,d=e.touchData.earlier;if(i.touches[0]){var p=e.projectIntoViewport(i.touches[0].clientX,i.touches[0].clientY);c[0]=p[0],c[1]=p[1]}if(i.touches[1]){p=e.projectIntoViewport(i.touches[1].clientX,i.touches[1].clientY);c[2]=p[0],c[3]=p[1]}if(i.touches[2]){p=e.projectIntoViewport(i.touches[2].clientX,i.touches[2].clientY);c[4]=p[0],c[5]=p[1]}if(n&&n.unactivate(),e.touchData.cxt){if(r={originalEvent:i,type:"cxttapend",position:{x:c[0],y:c[1]}},n?n.emit(r):o.emit(r),!e.touchData.cxtDragged){var m={originalEvent:i,type:"cxttap",position:{x:c[0],y:c[1]}};n?n.emit(m):o.emit(m)}return e.touchData.start&&(e.touchData.start._private.grabbed=!1),e.touchData.cxt=!1,e.touchData.start=null,void e.redraw()}if(!i.touches[2]&&o.boxSelectionEnabled()&&e.touchData.selecting){e.touchData.selecting=!1;var b=o.collection(e.getAllInBox(s[0],s[1],s[2],s[3]));s[0]=void 0,s[1]=void 0,s[2]=void 0,s[3]=void 0,s[4]=0,e.redrawHint("select",!0),o.emit({type:"boxend",originalEvent:i,position:{x:c[0],y:c[1]}});b.emit("box").stdFilter((function(e){return e.selectable()&&!e.selected()})).select().emit("boxselect"),b.nonempty()&&e.redrawHint("eles",!0),e.redraw()}if(null!=n&&n.unactivate(),i.touches[2])e.data.bgActivePosistion=void 0,e.redrawHint("select",!0);else if(i.touches[1]);else if(i.touches[0]);else if(!i.touches[0]){e.data.bgActivePosistion=void 0,e.redrawHint("select",!0);var h=e.dragData.touchDragEles;if(null!=n){var f=n._private.grabbed;u(h),e.redrawHint("drag",!0),e.redrawHint("eles",!0),f&&(n.emit("freeon"),h.emit("free"),e.dragData.didDrag&&(n.emit("dragfreeon"),h.emit("dragfree"))),a(n,["touchend","tapend","vmouseup","tapdragout"],i,{x:c[0],y:c[1]}),n.unactivate(),e.touchData.start=null}else{var g=e.findNearestElement(c[0],c[1],!0,!0);a(g,["touchend","tapend","vmouseup","tapdragout"],i,{x:c[0],y:c[1]})}var j=e.touchData.startPosition[0]-c[0],x=j*j,v=e.touchData.startPosition[1]-c[1],y=(x+v*v)*l*l;e.touchData.singleTouchMoved||(n||o.$(":selected").unselect(["tapunselect"]),a(n,["tap","vclick"],i,{x:c[0],y:c[1]})),null!=n&&!e.dragData.didDrag&&n._private.selectable&&y<e.touchTapThreshold2&&!e.pinching&&("single"===o.selectionType()?(o.$(t).unmerge(n).unselect(["tapunselect"]),n.select(["tapselect"])):n.selected()?n.unselect(["tapunselect"]):n.select(["tapselect"]),e.redrawHint("eles",!0)),e.touchData.singleTouchMoved=!0}for(var O=0;O<c.length;O++)d[O]=c[O];e.dragData.didDrag=!1,0===i.touches.length&&(e.touchData.dragDelta=[],e.touchData.startPosition=null,e.touchData.startGPosition=null,e.touchData.didSelect=!1),i.touches.length<2&&(1===i.touches.length&&(e.touchData.startGPosition=[i.touches[0].clientX,i.touches[0].clientY]),e.pinching=!1,e.redrawHint("eles",!0),e.redraw())}},!1),"undefined"==typeof TouchEvent){var z=[],B=function(e){return{clientX:e.clientX,clientY:e.clientY,force:1,identifier:e.pointerId,pageX:e.pageX,pageY:e.pageY,radiusX:e.width/2,radiusY:e.height/2,screenX:e.screenX,screenY:e.screenY,target:e.target}},J=function(e){z.push(function(e){return{event:e,touch:B(e)}}(e))},V=function(e){for(var t=0;t<z.length;t++){if(z[t].event.pointerId===e.pointerId)return void z.splice(t,1)}},U=function(e){e.touches=z.map((function(e){return e.touch}))},G=function(e){return"mouse"===e.pointerType||4===e.pointerType};e.registerBinding(e.container,"pointerdown",(function(e){G(e)||(e.preventDefault(),J(e),U(e),D(e))})),e.registerBinding(e.container,"pointerup",(function(e){G(e)||(V(e),U(e),R(e))})),e.registerBinding(e.container,"pointercancel",(function(e){G(e)||(V(e),U(e),L())})),e.registerBinding(e.container,"pointermove",(function(e){G(e)||(e.preventDefault(),function(e){var t=z.filter((function(t){return t.event.pointerId===e.pointerId}))[0];t.event=e,t.touch=B(e)}(e),U(e),A(e))}))}};var Hr={generatePolygon:function(e,t){return this.nodeShapes[e]={renderer:this,name:e,points:t,draw:function(e,t,a,i,n){this.renderer.nodeShapeImpl("polygon",e,t,a,i,n,this.points)},intersectLine:function(e,t,a,i,n,s,r){return vt(n,s,this.points,e,t,a/2,i/2,r)},checkPoint:function(e,t,a,i,n,s,r){return mt(e,t,this.points,s,r,i,n,[0,-1],a)}}}};Hr.generateEllipse=function(){return this.nodeShapes.ellipse={renderer:this,name:"ellipse",draw:function(e,t,a,i,n){this.renderer.nodeShapeImpl(this.name,e,t,a,i,n)},intersectLine:function(e,t,a,i,n,s,r){return function(e,t,a,i,n,s){var r=a-e,o=i-t;r/=n,o/=s;var l=Math.sqrt(r*r+o*o),c=l-1;if(c<0)return[];var d=c/l;return[(a-e)*d+e,(i-t)*d+t]}(n,s,e,t,a/2+r,i/2+r)},checkPoint:function(e,t,a,i,n,s,r){return ft(e,t,i,n,s,r,a)}}},Hr.generateRoundRectangle=function(){return this.nodeShapes["round-rectangle"]=this.nodeShapes.roundrectangle={renderer:this,name:"round-rectangle",points:Ot(4,0),draw:function(e,t,a,i,n){this.renderer.nodeShapeImpl(this.name,e,t,a,i,n)},intersectLine:function(e,t,a,i,n,s,r){return ot(n,s,e,t,a,i,r)},checkPoint:function(e,t,a,i,n,s,r){var o=_t(i,n),l=2*o;return!!mt(e,t,this.points,s,r,i,n-l,[0,-1],a)||(!!mt(e,t,this.points,s,r,i-l,n,[0,-1],a)||(!!ft(e,t,l,l,s-i/2+o,r-n/2+o,a)||(!!ft(e,t,l,l,s+i/2-o,r-n/2+o,a)||(!!ft(e,t,l,l,s+i/2-o,r+n/2-o,a)||!!ft(e,t,l,l,s-i/2+o,r+n/2-o,a)))))}}},Hr.generateCutRectangle=function(){return this.nodeShapes["cut-rectangle"]=this.nodeShapes.cutrectangle={renderer:this,name:"cut-rectangle",cornerLength:8,points:Ot(4,0),draw:function(e,t,a,i,n){this.renderer.nodeShapeImpl(this.name,e,t,a,i,n)},generateCutTrianglePts:function(e,t,a,i){var n=this.cornerLength,s=t/2,r=e/2,o=a-r,l=a+r,c=i-s,d=i+s;return{topLeft:[o,c+n,o+n,c,o+n,c+n],topRight:[l-n,c,l,c+n,l-n,c+n],bottomRight:[l,d-n,l-n,d,l-n,d-n],bottomLeft:[o+n,d,o,d-n,o+n,d-n]}},intersectLine:function(e,t,a,i,n,s,r){var o=this.generateCutTrianglePts(a+2*r,i+2*r,e,t),l=[].concat.apply([],[o.topLeft.splice(0,4),o.topRight.splice(0,4),o.bottomRight.splice(0,4),o.bottomLeft.splice(0,4)]);return vt(n,s,l,e,t)},checkPoint:function(e,t,a,i,n,s,r){if(mt(e,t,this.points,s,r,i,n-2*this.cornerLength,[0,-1],a))return!0;if(mt(e,t,this.points,s,r,i-2*this.cornerLength,n,[0,-1],a))return!0;var o=this.generateCutTrianglePts(i,n,s,r);return pt(e,t,o.topLeft)||pt(e,t,o.topRight)||pt(e,t,o.bottomRight)||pt(e,t,o.bottomLeft)}}},Hr.generateBarrel=function(){return this.nodeShapes.barrel={renderer:this,name:"barrel",points:Ot(4,0),draw:function(e,t,a,i,n){this.renderer.nodeShapeImpl(this.name,e,t,a,i,n)},intersectLine:function(e,t,a,i,n,s,r){var o=this.generateBarrelBezierPts(a+2*r,i+2*r,e,t),l=function(e){var t=Xe({x:e[0],y:e[1]},{x:e[2],y:e[3]},{x:e[4],y:e[5]},.15),a=Xe({x:e[0],y:e[1]},{x:e[2],y:e[3]},{x:e[4],y:e[5]},.5),i=Xe({x:e[0],y:e[1]},{x:e[2],y:e[3]},{x:e[4],y:e[5]},.85);return[e[0],e[1],t.x,t.y,a.x,a.y,i.x,i.y,e[4],e[5]]},c=[].concat(l(o.topLeft),l(o.topRight),l(o.bottomRight),l(o.bottomLeft));return vt(n,s,c,e,t)},generateBarrelBezierPts:function(e,t,a,i){var n=t/2,s=e/2,r=a-s,o=a+s,l=i-n,c=i+n,d=St(e,t),u=d.heightOffset,p=d.widthOffset,m=d.ctrlPtOffsetPct*e,b={topLeft:[r,l+u,r+m,l,r+p,l],topRight:[o-p,l,o-m,l,o,l+u],bottomRight:[o,c-u,o-m,c,o-p,c],bottomLeft:[r+p,c,r+m,c,r,c-u]};return b.topLeft.isTop=!0,b.topRight.isTop=!0,b.bottomLeft.isBottom=!0,b.bottomRight.isBottom=!0,b},checkPoint:function(e,t,a,i,n,s,r){var o=St(i,n),l=o.heightOffset,c=o.widthOffset;if(mt(e,t,this.points,s,r,i,n-2*l,[0,-1],a))return!0;if(mt(e,t,this.points,s,r,i-2*c,n,[0,-1],a))return!0;for(var d=this.generateBarrelBezierPts(i,n,s,r),u=function(e,t,a){var i,n,s=a[4],r=a[2],o=a[0],l=a[5],c=a[1],d=Math.min(s,o),u=Math.max(s,o),p=Math.min(l,c),m=Math.max(l,c);if(d<=e&&e<=u&&p<=t&&t<=m){var b=[(i=s)-2*(n=r)+o,2*(n-i),i],h=function(e,t,a,i){var n=t*t-4*e*(a-=i);if(n<0)return[];var s=Math.sqrt(n),r=2*e;return[(-t+s)/r,(-t-s)/r]}(b[0],b[1],b[2],e).filter((function(e){return 0<=e&&e<=1}));if(h.length>0)return h[0]}return null},p=Object.keys(d),m=0;m<p.length;m++){var b=d[p[m]],h=u(e,t,b);if(null!=h){var f=b[5],g=b[3],j=b[1],x=Ye(f,g,j,h);if(b.isTop&&x<=t)return!0;if(b.isBottom&&t<=x)return!0}}return!1}}},Hr.generateBottomRoundrectangle=function(){return this.nodeShapes["bottom-round-rectangle"]=this.nodeShapes.bottomroundrectangle={renderer:this,name:"bottom-round-rectangle",points:Ot(4,0),draw:function(e,t,a,i,n){this.renderer.nodeShapeImpl(this.name,e,t,a,i,n)},intersectLine:function(e,t,a,i,n,s,r){var o=t-(i/2+r),l=xt(n,s,e,t,e-(a/2+r),o,e+(a/2+r),o,!1);return l.length>0?l:ot(n,s,e,t,a,i,r)},checkPoint:function(e,t,a,i,n,s,r){var o=_t(i,n),l=2*o;if(mt(e,t,this.points,s,r,i,n-l,[0,-1],a))return!0;if(mt(e,t,this.points,s,r,i-l,n,[0,-1],a))return!0;var c=i/2+2*a,d=n/2+2*a;return!!pt(e,t,[s-c,r-d,s-c,r,s+c,r,s+c,r-d])||(!!ft(e,t,l,l,s+i/2-o,r+n/2-o,a)||!!ft(e,t,l,l,s-i/2+o,r+n/2-o,a))}}},Hr.registerNodeShapes=function(){var e=this.nodeShapes={},t=this;this.generateEllipse(),this.generatePolygon("triangle",Ot(3,0)),this.generatePolygon("rectangle",Ot(4,0)),e.square=e.rectangle,this.generateRoundRectangle(),this.generateCutRectangle(),this.generateBarrel(),this.generateBottomRoundrectangle(),this.generatePolygon("diamond",[0,1,1,0,0,-1,-1,0]),this.generatePolygon("pentagon",Ot(5,0)),this.generatePolygon("hexagon",Ot(6,0)),this.generatePolygon("heptagon",Ot(7,0)),this.generatePolygon("octagon",Ot(8,0));var a=new Array(20),i=wt(5,0),n=wt(5,Math.PI/5),s=.5*(3-Math.sqrt(5));s*=1.57;for(var r=0;r<n.length/2;r++)n[2*r]*=s,n[2*r+1]*=s;for(r=0;r<5;r++)a[4*r]=i[2*r],a[4*r+1]=i[2*r+1],a[4*r+2]=n[2*r],a[4*r+3]=n[2*r+1];a=Et(a),this.generatePolygon("star",a),this.generatePolygon("vee",[-1,-1,0,-.333,1,-1,0,1]),this.generatePolygon("rhomboid",[-1,-1,.333,-1,1,1,-.333,1]),this.nodeShapes.concavehexagon=this.generatePolygon("concave-hexagon",[-1,-.95,-.75,0,-1,.95,1,.95,.75,0,1,-.95]),this.generatePolygon("tag",[-1,-1,.25,-1,1,0,.25,1,-1,1]),e.makePolygon=function(e){var a,i="polygon-"+e.join("$");return(a=this[i])?a:t.generatePolygon(i,e)}};var Wr={timeToRender:function(){return this.redrawTotalTime/this.redrawCount},redraw:function(e){e=e||he();var t=this;void 0===t.averageRedrawTime&&(t.averageRedrawTime=0),void 0===t.lastRedrawTime&&(t.lastRedrawTime=0),void 0===t.lastDrawTime&&(t.lastDrawTime=0),t.requestedFrame=!0,t.renderOptions=e},beforeRender:function(e,t){if(!this.destroyed){null==t&&ce("Priority is not optional for beforeRender");var a=this.beforeRenderCallbacks;a.push({fn:e,priority:t}),a.sort((function(e,t){return t.priority-e.priority}))}}},$r=function(e,t,a){for(var i=e.beforeRenderCallbacks,n=0;n<i.length;n++)i[n].fn(t,a)};Wr.startRenderLoop=function(){var e=this,t=e.cy;if(!e.renderLoopStarted){e.renderLoopStarted=!0;H((function a(i){if(!e.destroyed){if(t.batching());else if(e.requestedFrame&&!e.skipFrame){$r(e,!0,i);var n=W();e.render(e.renderOptions);var s=e.lastDrawTime=W();void 0===e.averageRedrawTime&&(e.averageRedrawTime=s-n),void 0===e.redrawCount&&(e.redrawCount=0),e.redrawCount++,void 0===e.redrawTotalTime&&(e.redrawTotalTime=0);var r=s-n;e.redrawTotalTime+=r,e.lastRedrawTime=r,e.averageRedrawTime=e.averageRedrawTime/2+r/2,e.requestedFrame=!1}else $r(e,!1,i);e.skipFrame=!1,H(a)}}))}};var Yr=function(e){this.init(e)},Xr=Yr.prototype;Xr.clientFunctions=["redrawHint","render","renderTo","matchCanvasSize","nodeShapeImpl","arrowShapeImpl"],Xr.init=function(e){var t=this;t.options=e,t.cy=e.cy;var a=t.container=e.cy.container();if(u){var i=u.document,n=i.head,s="__________cytoscape_stylesheet",r="__________cytoscape_container",o=null!=i.getElementById(s);if(a.className.indexOf(r)<0&&(a.className=(a.className||"")+" "+r),!o){var l=i.createElement("style");l.id=s,l.innerHTML="."+r+" { position: relative; }",n.insertBefore(l,n.children[0])}"static"===u.getComputedStyle(a).getPropertyValue("position")&&ue("A Cytoscape container has style position:static and so can not use UI extensions properly")}t.selection=[void 0,void 0,void 0,void 0,0],t.bezierProjPcts=[.05,.225,.4,.5,.6,.775,.95],t.hoverData={down:null,last:null,downTime:null,triggerMode:null,dragging:!1,initialPan:[null,null],capture:!1},t.dragData={possibleDragElements:[]},t.touchData={start:null,capture:!1,startPosition:[null,null,null,null,null,null],singleTouchStartTime:null,singleTouchMoved:!0,now:[null,null,null,null,null,null],earlier:[null,null,null,null,null,null]},t.redraws=0,t.showFps=e.showFps,t.debug=e.debug,t.hideEdgesOnViewport=e.hideEdgesOnViewport,t.hideLabelsOnViewport=e.hideLabelsOnViewport,t.textureOnViewport=e.textureOnViewport,t.wheelSensitivity=e.wheelSensitivity,t.motionBlurEnabled=e.motionBlur,t.forcedPixelRatio=O(e.pixelRatio)?e.pixelRatio:null,t.motionBlur=e.motionBlur,t.motionBlurOpacity=e.motionBlurOpacity,t.motionBlurTransparency=1-t.motionBlurOpacity,t.motionBlurPxRatio=1,t.mbPxRBlurry=1,t.minMbLowQualFrames=4,t.fullQualityMb=!1,t.clearedForMotionBlur=[],t.desktopTapThreshold=e.desktopTapThreshold,t.desktopTapThreshold2=e.desktopTapThreshold*e.desktopTapThreshold,t.touchTapThreshold=e.touchTapThreshold,t.touchTapThreshold2=e.touchTapThreshold*e.touchTapThreshold,t.tapholdDuration=500,t.bindings=[],t.beforeRenderCallbacks=[],t.beforeRenderPriorities={animations:400,eleCalcs:300,eleTxrDeq:200,lyrTxrDeq:150,lyrTxrSkip:100},t.registerNodeShapes(),t.registerArrowShapes(),t.registerCalculationListeners()},Xr.notify=function(e,t){var a=this,i=a.cy;this.destroyed||("init"!==e?"destroy"!==e?(("add"===e||"remove"===e||"move"===e&&i.hasCompoundNodes()||"load"===e||"zorder"===e||"mount"===e)&&a.invalidateCachedZSortedEles(),"viewport"===e&&a.redrawHint("select",!0),"load"!==e&&"resize"!==e&&"mount"!==e||(a.invalidateContainerClientCoordsCache(),a.matchCanvasSize(a.container)),a.redrawHint("eles",!0),a.redrawHint("drag",!0),this.startRenderLoop(),this.redraw()):a.destroy():a.load())},Xr.destroy=function(){var e=this;e.destroyed=!0,e.cy.stopAnimationLoop();for(var t=0;t<e.bindings.length;t++){var a=e.bindings[t],i=a.target;(i.off||i.removeEventListener).apply(i,a.args)}if(e.bindings=[],e.beforeRenderCallbacks=[],e.onUpdateEleCalcsFns=[],e.removeObserver&&e.removeObserver.disconnect(),e.styleObserver&&e.styleObserver.disconnect(),e.resizeObserver&&e.resizeObserver.disconnect(),e.labelCalcDiv)try{document.body.removeChild(e.labelCalcDiv)}catch(e){}},Xr.isHeadless=function(){return!1},[kr,Ur,Gr,qr,Hr,Wr].forEach((function(e){N(Xr,e)}));var Qr=1e3/60,Kr=function(e){return function(){var t=this,a=this.renderer;if(!t.dequeueingSetup){t.dequeueingSetup=!0;var i=n((function(){a.redrawHint("eles",!0),a.redrawHint("drag",!0),a.redraw()}),e.deqRedrawThreshold),s=e.priority||le;a.beforeRender((function(n,s){var r=W(),o=a.averageRedrawTime,l=a.lastRedrawTime,c=[],d=a.cy.extent(),u=a.getPixelRatio();for(n||a.flushRenderedStyleQueue();;){var p=W(),m=p-r,b=p-s;if(l<Qr){var h=Qr-(n?o:0);if(b>=e.deqFastCost*h)break}else if(n){if(m>=e.deqCost*l||m>=e.deqAvgCost*o)break}else if(b>=e.deqNoDrawCost*Qr)break;var f=e.deq(t,u,d);if(!(f.length>0))break;for(var g=0;g<f.length;g++)c.push(f[g])}c.length>0&&(e.onDeqd(t,c),!n&&e.shouldRedraw(t,c,u,d)&&i())}),s(t))}}},Zr=function(){function e(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:re;o(this,e),this.idsByKey=new ye,this.keyForId=new ye,this.cachesByLvl=new ye,this.lvls=[],this.getKey=t,this.doesEleInvalidateKey=a}return c(e,[{key:"getIdsFor",value:function(e){null==e&&ce("Can not get id list for null key");var t=this.idsByKey,a=this.idsByKey.get(e);return a||(a=new Ee,t.set(e,a)),a}},{key:"addIdForKey",value:function(e,t){null!=e&&this.getIdsFor(e).add(t)}},{key:"deleteIdForKey",value:function(e,t){null!=e&&this.getIdsFor(e).delete(t)}},{key:"getNumberOfIdsForKey",value:function(e){return null==e?0:this.getIdsFor(e).size}},{key:"updateKeyMappingFor",value:function(e){var t=e.id(),a=this.keyForId.get(t),i=this.getKey(e);this.deleteIdForKey(a,t),this.addIdForKey(i,t),this.keyForId.set(t,i)}},{key:"deleteKeyMappingFor",value:function(e){var t=e.id(),a=this.keyForId.get(t);this.deleteIdForKey(a,t),this.keyForId.delete(t)}},{key:"keyHasChangedFor",value:function(e){var t=e.id();return this.keyForId.get(t)!==this.getKey(e)}},{key:"isInvalid",value:function(e){return this.keyHasChangedFor(e)||this.doesEleInvalidateKey(e)}},{key:"getCachesAt",value:function(e){var t=this.cachesByLvl,a=this.lvls,i=t.get(e);return i||(i=new ye,t.set(e,i),a.push(e)),i}},{key:"getCache",value:function(e,t){return this.getCachesAt(t).get(e)}},{key:"get",value:function(e,t){var a=this.getKey(e),i=this.getCache(a,t);return null!=i&&this.updateKeyMappingFor(e),i}},{key:"getForCachedKey",value:function(e,t){var a=this.keyForId.get(e.id());return this.getCache(a,t)}},{key:"hasCache",value:function(e,t){return this.getCachesAt(t).has(e)}},{key:"has",value:function(e,t){var a=this.getKey(e);return this.hasCache(a,t)}},{key:"setCache",value:function(e,t,a){a.key=e,this.getCachesAt(t).set(e,a)}},{key:"set",value:function(e,t,a){var i=this.getKey(e);this.setCache(i,t,a),this.updateKeyMappingFor(e)}},{key:"deleteCache",value:function(e,t){this.getCachesAt(t).delete(e)}},{key:"delete",value:function(e,t){var a=this.getKey(e);this.deleteCache(a,t)}},{key:"invalidateKey",value:function(e){var t=this;this.lvls.forEach((function(a){return t.deleteCache(e,a)}))}},{key:"invalidate",value:function(e){var t=e.id(),a=this.keyForId.get(t);this.deleteKeyMappingFor(e);var i=this.doesEleInvalidateKey(e);return i&&this.invalidateKey(a),i||0===this.getNumberOfIdsForKey(a)}}]),e}(),eo={dequeue:"dequeue",downscale:"downscale",highQuality:"highQuality"},to=fe({getKey:null,doesEleInvalidateKey:re,drawElement:null,getBoundingBox:null,getRotationPoint:null,getRotationOffset:null,isVisible:se,allowEdgeTxrCaching:!0,allowParentTxrCaching:!0}),ao=function(e,t){var a=this;a.renderer=e,a.onDequeues=[];var i=to(t);N(a,i),a.lookup=new Zr(i.getKey,i.doesEleInvalidateKey),a.setupDequeueing()},io=ao.prototype;io.reasons=eo,io.getTextureQueue=function(e){var t=this;return t.eleImgCaches=t.eleImgCaches||{},t.eleImgCaches[e]=t.eleImgCaches[e]||[]},io.getRetiredTextureQueue=function(e){var t=this.eleImgCaches.retired=this.eleImgCaches.retired||{};return t[e]=t[e]||[]},io.getElementQueue=function(){return this.eleCacheQueue=this.eleCacheQueue||new s((function(e,t){return t.reqs-e.reqs}))},io.getElementKeyToQueue=function(){return this.eleKeyToCacheQueue=this.eleKeyToCacheQueue||{}},io.getElement=function(e,t,a,i,n){var s=this,r=this.renderer,o=r.cy.zoom(),l=this.lookup;if(0===t.w||0===t.h||isNaN(t.w)||isNaN(t.h)||!e.visible())return null;if(!s.allowEdgeTxrCaching&&e.isEdge()||!s.allowParentTxrCaching&&e.isParent())return null;if(null==i&&(i=Math.ceil(Ge(o*a))),i<-4)i=-4;else if(o>=7.99||i>3)return null;var c=Math.pow(2,i),d=t.h*c,u=t.w*c,p=r.eleTextBiggerThanMin(e,c);if(!this.isVisible(e,p))return null;var m,b=l.get(e,i);if(b&&b.invalidated&&(b.invalidated=!1,b.texture.invalidatedWidth-=b.width),b)return b;if(m=d<=25?25:d<=50?50:50*Math.ceil(d/50),d>1024||u>1024)return null;var h=s.getTextureQueue(m),f=h[h.length-2],g=function(){return s.recycleTexture(m,u)||s.addTexture(m,u)};f||(f=h[h.length-1]),f||(f=g()),f.width-f.usedWidth<u&&(f=g());for(var j,x=function(e){return e&&e.scaledLabelShown===p},v=n&&n===eo.dequeue,y=n&&n===eo.highQuality,O=n&&n===eo.downscale,E=i+1;E<=3;E++){var w=l.get(e,E);if(w){j=w;break}}var _=j&&j.level===i+1?j:null,S=function(){f.context.drawImage(_.texture.canvas,_.x,0,_.width,_.height,f.usedWidth,0,u,d)};if(f.context.setTransform(1,0,0,1,0,0),f.context.clearRect(f.usedWidth,0,u,m),x(_))S();else if(x(j)){if(!y)return s.queueElement(e,j.level-1),j;for(var M=j.level;M>i;M--)_=s.getElement(e,t,a,M,eo.downscale);S()}else{var k;if(!v&&!y&&!O)for(var C=i-1;C>=-4;C--){var T=l.get(e,C);if(T){k=T;break}}if(x(k))return s.queueElement(e,i),k;f.context.translate(f.usedWidth,0),f.context.scale(c,c),this.drawElement(f.context,e,t,p,!1),f.context.scale(1/c,1/c),f.context.translate(-f.usedWidth,0)}return b={x:f.usedWidth,texture:f,level:i,scale:c,width:u,height:d,scaledLabelShown:p},f.usedWidth+=Math.ceil(u+8),f.eleCaches.push(b),l.set(e,i,b),s.checkTextureFullness(f),b},io.invalidateElements=function(e){for(var t=0;t<e.length;t++)this.invalidateElement(e[t])},io.invalidateElement=function(e){var t=this,a=t.lookup,i=[];if(a.isInvalid(e)){for(var n=-4;n<=3;n++){var s=a.getForCachedKey(e,n);s&&i.push(s)}if(a.invalidate(e))for(var r=0;r<i.length;r++){var o=i[r],l=o.texture;l.invalidatedWidth+=o.width,o.invalidated=!0,t.checkTextureUtility(l)}t.removeFromQueue(e)}},io.checkTextureUtility=function(e){e.invalidatedWidth>=.2*e.width&&this.retireTexture(e)},io.checkTextureFullness=function(e){var t=this.getTextureQueue(e.height);e.usedWidth/e.width>.8&&e.fullnessChecks>=10?ge(t,e):e.fullnessChecks++},io.retireTexture=function(e){var t=e.height,a=this.getTextureQueue(t),i=this.lookup;ge(a,e),e.retired=!0;for(var n=e.eleCaches,s=0;s<n.length;s++){var r=n[s];i.deleteCache(r.key,r.level)}je(n),this.getRetiredTextureQueue(t).push(e)},io.addTexture=function(e,t){var a={};return this.getTextureQueue(e).push(a),a.eleCaches=[],a.height=e,a.width=Math.max(1024,t),a.usedWidth=0,a.invalidatedWidth=0,a.fullnessChecks=0,a.canvas=this.renderer.makeOffscreenCanvas(a.width,a.height),a.context=a.canvas.getContext("2d"),a},io.recycleTexture=function(e,t){for(var a=this.getTextureQueue(e),i=this.getRetiredTextureQueue(e),n=0;n<i.length;n++){var s=i[n];if(s.width>=t)return s.retired=!1,s.usedWidth=0,s.invalidatedWidth=0,s.fullnessChecks=0,je(s.eleCaches),s.context.setTransform(1,0,0,1,0,0),s.context.clearRect(0,0,s.width,s.height),ge(i,s),a.push(s),s}},io.queueElement=function(e,t){var a=this.getElementQueue(),i=this.getElementKeyToQueue(),n=this.getKey(e),s=i[n];if(s)s.level=Math.max(s.level,t),s.eles.merge(e),s.reqs++,a.updateItem(s);else{var r={eles:e.spawn().merge(e),level:t,reqs:1,key:n};a.push(r),i[n]=r}},io.dequeue=function(e){for(var t=this,a=t.getElementQueue(),i=t.getElementKeyToQueue(),n=[],s=t.lookup,r=0;r<1&&a.size()>0;r++){var o=a.pop(),l=o.key,c=o.eles[0],d=s.hasCache(c,o.level);if(i[l]=null,!d){n.push(o);var u=t.getBoundingBox(c);t.getElement(c,u,e,o.level,eo.dequeue)}}return n},io.removeFromQueue=function(e){var t=this.getElementQueue(),a=this.getElementKeyToQueue(),i=this.getKey(e),n=a[i];null!=n&&(1===n.eles.length?(n.reqs=ne,t.updateItem(n),t.pop(),a[i]=null):n.eles.unmerge(e))},io.onDequeue=function(e){this.onDequeues.push(e)},io.offDequeue=function(e){ge(this.onDequeues,e)},io.setupDequeueing=Kr({deqRedrawThreshold:100,deqCost:.15,deqAvgCost:.1,deqNoDrawCost:.9,deqFastCost:.9,deq:function(e,t,a){return e.dequeue(t,a)},onDeqd:function(e,t){for(var a=0;a<e.onDequeues.length;a++){(0,e.onDequeues[a])(t)}},shouldRedraw:function(e,t,a,i){for(var n=0;n<t.length;n++)for(var s=t[n].eles,r=0;r<s.length;r++){var o=s[r].boundingBox();if(nt(o,i))return!0}return!1},priority:function(e){return e.renderer.beforeRenderPriorities.eleTxrDeq}});var no=function(e){var t=this,a=t.renderer=e,i=a.cy;t.layersByLevel={},t.firstGet=!0,t.lastInvalidationTime=W()-500,t.skipping=!1,t.eleTxrDeqs=i.collection(),t.scheduleElementRefinement=n((function(){t.refineElementTextures(t.eleTxrDeqs),t.eleTxrDeqs.unmerge(t.eleTxrDeqs)}),50),a.beforeRender((function(e,a){a-t.lastInvalidationTime<=250?t.skipping=!0:t.skipping=!1}),a.beforeRenderPriorities.lyrTxrSkip);t.layersQueue=new s((function(e,t){return t.reqs-e.reqs})),t.setupDequeueing()},so=no.prototype,ro=0,oo=Math.pow(2,53)-1;so.makeLayer=function(e,t){var a=Math.pow(2,t),i=Math.ceil(e.w*a),n=Math.ceil(e.h*a),s=this.renderer.makeOffscreenCanvas(i,n),r={id:ro=++ro%oo,bb:e,level:t,width:i,height:n,canvas:s,context:s.getContext("2d"),eles:[],elesQueue:[],reqs:0},o=r.context,l=-r.bb.x1,c=-r.bb.y1;return o.scale(a,a),o.translate(l,c),r},so.getLayers=function(e,t,a){var i=this,n=i.renderer.cy.zoom(),s=i.firstGet;if(i.firstGet=!1,null==a)if((a=Math.ceil(Ge(n*t)))<-4)a=-4;else if(n>=3.99||a>2)return null;i.validateLayersElesOrdering(a,e);var r,o,l=i.layersByLevel,c=Math.pow(2,a),d=l[a]=l[a]||[];if(i.levelIsComplete(a,e))return d;!function(){var t=function(t){if(i.validateLayersElesOrdering(t,e),i.levelIsComplete(t,e))return o=l[t],!0},n=function(e){if(!o)for(var i=a+e;-4<=i&&i<=2&&!t(i);i+=e);};n(1),n(-1);for(var s=d.length-1;s>=0;s--){var r=d[s];r.invalid&&ge(d,r)}}();var u=function(t){var n=(t=t||{}).after;if(function(){if(!r){r=Ke();for(var t=0;t<e.length;t++)a=r,i=e[t].boundingBox(),a.x1=Math.min(a.x1,i.x1),a.x2=Math.max(a.x2,i.x2),a.w=a.x2-a.x1,a.y1=Math.min(a.y1,i.y1),a.y2=Math.max(a.y2,i.y2),a.h=a.y2-a.y1}var a,i}(),r.w*c*(r.h*c)>16e6)return null;var s=i.makeLayer(r,a);if(null!=n){var o=d.indexOf(n)+1;d.splice(o,0,s)}else(void 0===t.insert||t.insert)&&d.unshift(s);return s};if(i.skipping&&!s)return null;for(var p=null,m=e.length/1,b=!s,h=0;h<e.length;h++){var f=e[h],g=f._private.rscratch,j=g.imgLayerCaches=g.imgLayerCaches||{},x=j[a];if(x)p=x;else{if((!p||p.eles.length>=m||!rt(p.bb,f.boundingBox()))&&!(p=u({insert:!0,after:p})))return null;o||b?i.queueLayer(p,f):i.drawEleInLayer(p,f,a,t),p.eles.push(f),j[a]=p}}return o||(b?null:d)},so.getEleLevelForLayerLevel=function(e,t){return e},so.drawEleInLayer=function(e,t,a,i){var n=this.renderer,s=e.context,r=t.boundingBox();0!==r.w&&0!==r.h&&t.visible()&&(a=this.getEleLevelForLayerLevel(a,i),n.setImgSmoothing(s,!1),n.drawCachedElement(s,t,null,null,a,true),n.setImgSmoothing(s,!0))},so.levelIsComplete=function(e,t){var a=this.layersByLevel[e];if(!a||0===a.length)return!1;for(var i=0,n=0;n<a.length;n++){var s=a[n];if(s.reqs>0)return!1;if(s.invalid)return!1;i+=s.eles.length}return i===t.length},so.validateLayersElesOrdering=function(e,t){var a=this.layersByLevel[e];if(a)for(var i=0;i<a.length;i++){for(var n=a[i],s=-1,r=0;r<t.length;r++)if(n.eles[0]===t[r]){s=r;break}if(s<0)this.invalidateLayer(n);else{var o=s;for(r=0;r<n.eles.length;r++)if(n.eles[r]!==t[o+r]){this.invalidateLayer(n);break}}}},so.updateElementsInLayers=function(e,t){for(var a=_(e[0]),i=0;i<e.length;i++)for(var n=a?null:e[i],s=a?e[i]:e[i].ele,r=s._private.rscratch,o=r.imgLayerCaches=r.imgLayerCaches||{},l=-4;l<=2;l++){var c=o[l];c&&(n&&this.getEleLevelForLayerLevel(c.level)!==n.level||t(c,s,n))}},so.haveLayers=function(){for(var e=!1,t=-4;t<=2;t++){var a=this.layersByLevel[t];if(a&&a.length>0){e=!0;break}}return e},so.invalidateElements=function(e){var t=this;0!==e.length&&(t.lastInvalidationTime=W(),0!==e.length&&t.haveLayers()&&t.updateElementsInLayers(e,(function(e,a,i){t.invalidateLayer(e)})))},so.invalidateLayer=function(e){if(this.lastInvalidationTime=W(),!e.invalid){var t=e.level,a=e.eles,i=this.layersByLevel[t];ge(i,e),e.elesQueue=[],e.invalid=!0,e.replacement&&(e.replacement.invalid=!0);for(var n=0;n<a.length;n++){var s=a[n]._private.rscratch.imgLayerCaches;s&&(s[t]=null)}}},so.refineElementTextures=function(e){var t=this;t.updateElementsInLayers(e,(function(e,a,i){var n=e.replacement;if(n||((n=e.replacement=t.makeLayer(e.bb,e.level)).replaces=e,n.eles=e.eles),!n.reqs)for(var s=0;s<n.eles.length;s++)t.queueLayer(n,n.eles[s])}))},so.enqueueElementRefinement=function(e){this.eleTxrDeqs.merge(e),this.scheduleElementRefinement()},so.queueLayer=function(e,t){var a=this.layersQueue,i=e.elesQueue,n=i.hasId=i.hasId||{};if(!e.replacement){if(t){if(n[t.id()])return;i.push(t),n[t.id()]=!0}e.reqs?(e.reqs++,a.updateItem(e)):(e.reqs=1,a.push(e))}},so.dequeue=function(e){for(var t=this,a=t.layersQueue,i=[],n=0;n<1&&0!==a.size();){var s=a.peek();if(s.replacement)a.pop();else if(s.replaces&&s!==s.replaces.replacement)a.pop();else if(s.invalid)a.pop();else{var r=s.elesQueue.shift();r&&(t.drawEleInLayer(s,r,s.level,e),n++),0===i.length&&i.push(!0),0===s.elesQueue.length&&(a.pop(),s.reqs=0,s.replaces&&t.applyLayerReplacement(s),t.requestRedraw())}}return i},so.applyLayerReplacement=function(e){var t=this.layersByLevel[e.level],a=e.replaces,i=t.indexOf(a);if(!(i<0||a.invalid)){t[i]=e;for(var n=0;n<e.eles.length;n++){var s=e.eles[n]._private,r=s.imgLayerCaches=s.imgLayerCaches||{};r&&(r[e.level]=e)}this.requestRedraw()}},so.requestRedraw=n((function(){var e=this.renderer;e.redrawHint("eles",!0),e.redrawHint("drag",!0),e.redraw()}),100),so.setupDequeueing=Kr({deqRedrawThreshold:50,deqCost:.15,deqAvgCost:.1,deqNoDrawCost:.9,deqFastCost:.9,deq:function(e,t){return e.dequeue(t)},onDeqd:le,shouldRedraw:se,priority:function(e){return e.renderer.beforeRenderPriorities.lyrTxrDeq}});var lo,co={};function uo(e,t){for(var a=0;a<t.length;a++){var i=t[a];e.lineTo(i.x,i.y)}}function po(e,t,a){for(var i,n=0;n<t.length;n++){var s=t[n];0===n&&(i=s),e.lineTo(s.x,s.y)}e.quadraticCurveTo(a.x,a.y,i.x,i.y)}function mo(e,t,a){e.beginPath&&e.beginPath();for(var i=t,n=0;n<i.length;n++){var s=i[n];e.lineTo(s.x,s.y)}var r=a,o=a[0];e.moveTo(o.x,o.y);for(n=1;n<r.length;n++){s=r[n];e.lineTo(s.x,s.y)}e.closePath&&e.closePath()}function bo(e,t,a,i){e.arc(t,a,i,0,2*Math.PI,!1)}co.arrowShapeImpl=function(e){return(lo||(lo={polygon:uo,"triangle-backcurve":po,"triangle-tee":mo,"triangle-cross":mo,circle:bo}))[e]};var ho={drawElement:function(e,t,a,i,n,s){t.isNode()?this.drawNode(e,t,a,i,n,s):this.drawEdge(e,t,a,i,n,s)},drawElementOverlay:function(e,t){t.isNode()?this.drawNodeOverlay(e,t):this.drawEdgeOverlay(e,t)},drawCachedElementPortion:function(e,t,a,i,n,s,r,o){var l=this,c=a.getBoundingBox(t);if(0!==c.w&&0!==c.h){var d=a.getElement(t,c,i,n,s);if(null!=d){var u=o(l,t);if(0===u)return;var p,m,b,h,f,g,j=r(l,t),x=c.x1,v=c.y1,y=c.w,O=c.h;if(0!==j){var E=a.getRotationPoint(t);b=E.x,h=E.y,e.translate(b,h),e.rotate(j),(f=l.getImgSmoothing(e))||l.setImgSmoothing(e,!0);var w=a.getRotationOffset(t);p=w.x,m=w.y}else p=x,m=v;1!==u&&(g=e.globalAlpha,e.globalAlpha=g*u),e.drawImage(d.texture.canvas,d.x,0,d.width,d.height,p,m,y,O),1!==u&&(e.globalAlpha=g),0!==j&&(e.rotate(-j),e.translate(-b,-h),f||l.setImgSmoothing(e,!1))}else a.drawElement(e,t)}}},fo=function(){return 0},go=function(e,t){return e.getTextAngle(t,null)},jo=function(e,t){return e.getTextAngle(t,"source")},xo=function(e,t){return e.getTextAngle(t,"target")},vo=function(e,t){return t.effectiveOpacity()},yo=function(e,t){return t.pstyle("text-opacity").pfValue*t.effectiveOpacity()};ho.drawCachedElement=function(e,t,a,i,n,s){var r=this,o=r.data,l=o.eleTxrCache,c=o.lblTxrCache,d=o.slbTxrCache,u=o.tlbTxrCache,p=t.boundingBox(),m=!0===s?l.reasons.highQuality:null;0!==p.w&&0!==p.h&&t.visible()&&(i&&!nt(p,i)||(r.drawCachedElementPortion(e,t,l,a,n,m,fo,vo),r.drawCachedElementPortion(e,t,c,a,n,m,go,yo),t.isEdge()&&(r.drawCachedElementPortion(e,t,d,a,n,m,jo,yo),r.drawCachedElementPortion(e,t,u,a,n,m,xo,yo)),r.drawElementOverlay(e,t)))},ho.drawElements=function(e,t){for(var a=0;a<t.length;a++){var i=t[a];this.drawElement(e,i)}},ho.drawCachedElements=function(e,t,a,i){for(var n=0;n<t.length;n++){var s=t[n];this.drawCachedElement(e,s,a,i)}},ho.drawCachedNodes=function(e,t,a,i){for(var n=0;n<t.length;n++){var s=t[n];s.isNode()&&this.drawCachedElement(e,s,a,i)}},ho.drawLayeredElements=function(e,t,a,i){var n=this.data.lyrTxrCache.getLayers(t,a);if(n)for(var s=0;s<n.length;s++){var r=n[s],o=r.bb;0!==o.w&&0!==o.h&&e.drawImage(r.canvas,o.x1,o.y1,o.w,o.h)}else this.drawCachedElements(e,t,a,i)};var Oo={drawEdge:function(e,t,a){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],n=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],s=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],r=this,o=t._private.rscratch;if((!s||t.visible())&&!o.badLine&&null!=o.allpts&&!isNaN(o.allpts[0])){var l;a&&(l=a,e.translate(-l.x1,-l.y1));var c=s?t.pstyle("opacity").value:1,d=t.pstyle("line-style").value,u=t.pstyle("width").pfValue,p=t.pstyle("line-cap").value,m=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c;e.lineWidth=u,e.lineCap=p,r.eleStrokeStyle(e,t,a),r.drawEdgePath(t,e,o.allpts,d),e.lineCap="butt"},b=function(){n&&r.drawEdgeOverlay(e,t)},h=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c;r.drawArrowheads(e,t,a)},f=function(){r.drawElementText(e,t,null,i)};e.lineJoin="round";var g="yes"===t.pstyle("ghost").value;if(g){var j=t.pstyle("ghost-offset-x").pfValue,x=t.pstyle("ghost-offset-y").pfValue,v=t.pstyle("ghost-opacity").value,y=c*v;e.translate(j,x),m(y),h(y),e.translate(-j,-x)}m(),h(),b(),f(),a&&e.translate(l.x1,l.y1)}},drawEdgeOverlay:function(e,t){if(t.visible()){var a=t.pstyle("overlay-opacity").value;if(0!==a){var i=this,n=i.usePaths(),s=t._private.rscratch,r=2*t.pstyle("overlay-padding").pfValue,o=t.pstyle("overlay-color").value;e.lineWidth=r,"self"!==s.edgeType||n?e.lineCap="round":e.lineCap="butt",i.colorStrokeStyle(e,o[0],o[1],o[2],a),i.drawEdgePath(t,e,s.allpts,"solid")}}},drawEdgePath:function(e,t,a,i){var n,s=e._private.rscratch,r=t,o=!1,l=this.usePaths(),c=e.pstyle("line-dash-pattern").pfValue,d=e.pstyle("line-dash-offset").pfValue;if(l){var u=a.join("$");s.pathCacheKey&&s.pathCacheKey===u?(n=t=s.pathCache,o=!0):(n=t=new Path2D,s.pathCacheKey=u,s.pathCache=n)}if(r.setLineDash)switch(i){case"dotted":r.setLineDash([1,1]);break;case"dashed":r.setLineDash(c),r.lineDashOffset=d;break;case"solid":r.setLineDash([])}if(!o&&!s.badLine)switch(t.beginPath&&t.beginPath(),t.moveTo(a[0],a[1]),s.edgeType){case"bezier":case"self":case"compound":case"multibezier":for(var p=2;p+3<a.length;p+=4)t.quadraticCurveTo(a[p],a[p+1],a[p+2],a[p+3]);break;case"straight":case"segments":case"haystack":for(var m=2;m+1<a.length;m+=2)t.lineTo(a[m],a[m+1])}t=r,l?t.stroke(n):t.stroke(),t.setLineDash&&t.setLineDash([])},drawArrowheads:function(e,t,a){var i=t._private.rscratch,n="haystack"===i.edgeType;n||this.drawArrowhead(e,t,"source",i.arrowStartX,i.arrowStartY,i.srcArrowAngle,a),this.drawArrowhead(e,t,"mid-target",i.midX,i.midY,i.midtgtArrowAngle,a),this.drawArrowhead(e,t,"mid-source",i.midX,i.midY,i.midsrcArrowAngle,a),n||this.drawArrowhead(e,t,"target",i.arrowEndX,i.arrowEndY,i.tgtArrowAngle,a)},drawArrowhead:function(e,t,a,i,n,s,r){if(!(isNaN(i)||null==i||isNaN(n)||null==n||isNaN(s)||null==s)){var o=this,l=t.pstyle(a+"-arrow-shape").value;if("none"!==l){var c="hollow"===t.pstyle(a+"-arrow-fill").value?"both":"filled",d=t.pstyle(a+"-arrow-fill").value,u=t.pstyle("width").pfValue,p=t.pstyle("opacity").value;void 0===r&&(r=p);var m=e.globalCompositeOperation;1===r&&"hollow"!==d||(e.globalCompositeOperation="destination-out",o.colorFillStyle(e,255,255,255,1),o.colorStrokeStyle(e,255,255,255,1),o.drawArrowShape(t,e,c,u,l,i,n,s),e.globalCompositeOperation=m);var b=t.pstyle(a+"-arrow-color").value;o.colorFillStyle(e,b[0],b[1],b[2],r),o.colorStrokeStyle(e,b[0],b[1],b[2],r),o.drawArrowShape(t,e,d,u,l,i,n,s)}}},drawArrowShape:function(e,t,a,i,n,s,r,o){var l,c=this,d=this.usePaths()&&"triangle-cross"!==n,u=!1,p=t,m={x:s,y:r},b=e.pstyle("arrow-scale").value,h=this.getArrowWidth(i,b),f=c.arrowShapes[n];if(d){var g=c.arrowPathCache=c.arrowPathCache||[],j=K(n),x=g[j];null!=x?(l=t=x,u=!0):(l=t=new Path2D,g[j]=l)}t.beginPath&&t.beginPath(),u||(d?f.draw(t,1,0,{x:0,y:0},1):f.draw(t,h,o,m,i)),t.closePath&&t.closePath(),t=p,d&&(t.translate(s,r),t.rotate(o),t.scale(h,h)),"filled"!==a&&"both"!==a||(d?t.fill(l):t.fill()),"hollow"!==a&&"both"!==a||(t.lineWidth=(f.matchEdgeWidth?i:1)/(d?h:1),t.lineJoin="miter",d?t.stroke(l):t.stroke()),d&&(t.scale(1/h,1/h),t.rotate(-o),t.translate(-s,-r))}},Eo={safeDrawImage:function(e,t,a,i,n,s,r,o,l,c){n<=0||s<=0||l<=0||c<=0||e.drawImage(t,a,i,n,s,r,o,l,c)},drawInscribedImage:function(e,t,a,i,n){var s=this,r=a.position(),o=r.x,l=r.y,c=a.cy().style(),d=c.getIndexedStyle.bind(c),u=d(a,"background-fit","value",i),p=d(a,"background-repeat","value",i),m=a.width(),b=a.height(),h=2*a.padding(),f=m+("inner"===d(a,"background-width-relative-to","value",i)?0:h),g=b+("inner"===d(a,"background-height-relative-to","value",i)?0:h),j=a._private.rscratch,x="node"===d(a,"background-clip","value",i),v=d(a,"background-image-opacity","value",i)*n,y=t.width||t.cachedW,O=t.height||t.cachedH;null!=y&&null!=O||(document.body.appendChild(t),y=t.cachedW=t.width||t.offsetWidth,O=t.cachedH=t.height||t.offsetHeight,document.body.removeChild(t));var E=y,w=O;if("auto"!==d(a,"background-width","value",i)&&(E="%"===d(a,"background-width","units",i)?d(a,"background-width","pfValue",i)*f:d(a,"background-width","pfValue",i)),"auto"!==d(a,"background-height","value",i)&&(w="%"===d(a,"background-height","units",i)?d(a,"background-height","pfValue",i)*g:d(a,"background-height","pfValue",i)),0!==E&&0!==w){if("contain"===u)E*=_=Math.min(f/E,g/w),w*=_;else if("cover"===u){var _;E*=_=Math.max(f/E,g/w),w*=_}var S=o-f/2,M=d(a,"background-position-x","units",i),k=d(a,"background-position-x","pfValue",i);S+="%"===M?(f-E)*k:k;var C=d(a,"background-offset-x","units",i),T=d(a,"background-offset-x","pfValue",i);S+="%"===C?(f-E)*T:T;var F=l-g/2,I=d(a,"background-position-y","units",i),D=d(a,"background-position-y","pfValue",i);F+="%"===I?(g-w)*D:D;var A=d(a,"background-offset-y","units",i),L=d(a,"background-offset-y","pfValue",i);F+="%"===A?(g-w)*L:L,j.pathCache&&(S-=o,F-=l,o=0,l=0);var R=e.globalAlpha;if(e.globalAlpha=v,"no-repeat"===p)x&&(e.save(),j.pathCache?e.clip(j.pathCache):(s.nodeShapes[s.getNodeShape(a)].draw(e,o,l,f,g),e.clip())),s.safeDrawImage(e,t,0,0,y,O,S,F,E,w),x&&e.restore();else{var P=e.createPattern(t,p);e.fillStyle=P,s.nodeShapes[s.getNodeShape(a)].draw(e,o,l,f,g),e.translate(S,F),e.fill(),e.translate(-S,-F)}e.globalAlpha=R}}},wo={};function _o(e,t,a,i,n){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:5;e.beginPath(),e.moveTo(t+s,a),e.lineTo(t+i-s,a),e.quadraticCurveTo(t+i,a,t+i,a+s),e.lineTo(t+i,a+n-s),e.quadraticCurveTo(t+i,a+n,t+i-s,a+n),e.lineTo(t+s,a+n),e.quadraticCurveTo(t,a+n,t,a+n-s),e.lineTo(t,a+s),e.quadraticCurveTo(t,a,t+s,a),e.closePath(),e.fill()}wo.eleTextBiggerThanMin=function(e,t){if(!t){var a=e.cy().zoom(),i=this.getPixelRatio(),n=Math.ceil(Ge(a*i));t=Math.pow(2,n)}return!(e.pstyle("font-size").pfValue*t<e.pstyle("min-zoomed-font-size").pfValue)},wo.drawElementText=function(e,t,a,i,n){var s=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],r=this;if(null==i){if(s&&!r.eleTextBiggerThanMin(t))return}else if(!1===i)return;if(t.isNode()){var o=t.pstyle("label");if(!o||!o.value)return;var l=r.getLabelJustification(t);e.textAlign=l,e.textBaseline="bottom"}else{var c=t.pstyle("label"),d=t.pstyle("source-label"),u=t.pstyle("target-label");if(!(c&&c.value||d&&d.value||u&&u.value))return;e.textAlign="center",e.textBaseline="bottom"}var p,m=!a;a&&(p=a,e.translate(-p.x1,-p.y1)),null==n?(r.drawText(e,t,null,m,s),t.isEdge()&&(r.drawText(e,t,"source",m,s),r.drawText(e,t,"target",m,s))):r.drawText(e,t,n,m,s),a&&e.translate(p.x1,p.y1)},wo.getFontCache=function(e){var t;this.fontCaches=this.fontCaches||[];for(var a=0;a<this.fontCaches.length;a++)if((t=this.fontCaches[a]).context===e)return t;return t={context:e},this.fontCaches.push(t),t},wo.setupTextStyle=function(e,t){var a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=t.pstyle("font-style").strValue,n=t.pstyle("font-size").pfValue+"px",s=t.pstyle("font-family").strValue,r=t.pstyle("font-weight").strValue,o=a?t.effectiveOpacity()*t.pstyle("text-opacity").value:1,l=t.pstyle("text-outline-opacity").value*o,c=t.pstyle("color").value,d=t.pstyle("text-outline-color").value;e.font=i+" "+r+" "+n+" "+s,e.lineJoin="round",this.colorFillStyle(e,c[0],c[1],c[2],o),this.colorStrokeStyle(e,d[0],d[1],d[2],l)},wo.getTextAngle=function(e,t){var a=e._private.rscratch,i=t?t+"-":"",n=e.pstyle(i+"text-rotation"),s=xe(a,"labelAngle",t);return"autorotate"===n.strValue?e.isEdge()?s:0:"none"===n.strValue?0:n.pfValue},wo.drawText=function(e,t,a){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],n=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],s=t._private,r=s.rscratch,o=n?t.effectiveOpacity():1;if(!n||0!==o&&0!==t.pstyle("text-opacity").value){"main"===a&&(a=null);var l,c,d=xe(r,"labelX",a),u=xe(r,"labelY",a),p=this.getLabelText(t,a);if(null!=p&&""!==p&&!isNaN(d)&&!isNaN(u)){this.setupTextStyle(e,t,n);var m,b=a?a+"-":"",h=xe(r,"labelWidth",a),f=xe(r,"labelHeight",a),g=t.pstyle(b+"text-margin-x").pfValue,j=t.pstyle(b+"text-margin-y").pfValue,x=t.isEdge(),v=t.pstyle("text-halign").value,y=t.pstyle("text-valign").value;switch(x&&(v="center",y="center"),d+=g,u+=j,0!==(m=i?this.getTextAngle(t,a):0)&&(l=d,c=u,e.translate(l,c),e.rotate(m),d=0,u=0),y){case"top":break;case"center":u+=f/2;break;case"bottom":u+=f}var O=t.pstyle("text-background-opacity").value,E=t.pstyle("text-border-opacity").value,w=t.pstyle("text-border-width").pfValue,_=t.pstyle("text-background-padding").pfValue;if(O>0||w>0&&E>0){var S=d-_;switch(v){case"left":S-=h;break;case"center":S-=h/2}var M=u-f-_,k=h+2*_,C=f+2*_;if(O>0){var T=e.fillStyle,F=t.pstyle("text-background-color").value;e.fillStyle="rgba("+F[0]+","+F[1]+","+F[2]+","+O*o+")";var I=t.pstyle("text-background-shape").strValue;"roundrectangle"==I?_o(e,S,M,k,C,2):e.fillRect(S,M,k,C),e.fillStyle=T}if(w>0&&E>0){var D=e.strokeStyle,A=e.lineWidth,L=t.pstyle("text-border-color").value,R=t.pstyle("text-border-style").value;if(e.strokeStyle="rgba("+L[0]+","+L[1]+","+L[2]+","+E*o+")",e.lineWidth=w,e.setLineDash)switch(R){case"dotted":e.setLineDash([1,1]);break;case"dashed":e.setLineDash([4,2]);break;case"double":e.lineWidth=w/4,e.setLineDash([]);break;case"solid":e.setLineDash([])}if(e.strokeRect(S,M,k,C),"double"===R){var P=w/2;e.strokeRect(S+P,M+P,k-2*P,C-2*P)}e.setLineDash&&e.setLineDash([]),e.lineWidth=A,e.strokeStyle=D}}var N=2*t.pstyle("text-outline-width").pfValue;if(N>0&&(e.lineWidth=N),"wrap"===t.pstyle("text-wrap").value){var z=xe(r,"labelWrapCachedLines",a),B=xe(r,"labelLineHeight",a),J=h/2,V=this.getLabelJustification(t);switch("auto"===V||("left"===v?"left"===V?d+=-h:"center"===V&&(d+=-J):"center"===v?"left"===V?d+=-J:"right"===V&&(d+=J):"right"===v&&("center"===V?d+=J:"right"===V&&(d+=h))),y){case"top":case"center":case"bottom":u-=(z.length-1)*B}for(var U=0;U<z.length;U++)N>0&&e.strokeText(z[U],d,u),e.fillText(z[U],d,u),u+=B}else N>0&&e.strokeText(p,d,u),e.fillText(p,d,u);0!==m&&(e.rotate(-m),e.translate(-l,-c))}}};var So={drawNode:function(e,t,a){var i,n,s=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],o=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],l=this,c=t._private,d=c.rscratch,u=t.position();if(O(u.x)&&O(u.y)&&(!o||t.visible())){var p,m,b=o?t.effectiveOpacity():1,h=l.usePaths(),f=!1,g=t.padding();i=t.width()+2*g,n=t.height()+2*g,a&&(m=a,e.translate(-m.x1,-m.y1));for(var j=t.pstyle("background-image"),x=j.value,v=new Array(x.length),y=new Array(x.length),E=0,w=0;w<x.length;w++){var _=x[w],S=v[w]=null!=_&&"none"!==_;if(S){var M=t.cy().style().getIndexedStyle(t,"background-image-crossorigin","value",w);E++,y[w]=l.getCachedImage(_,M,(function(){c.backgroundTimestamp=Date.now(),t.emitAndNotify("background")}))}}var k=t.pstyle("background-blacken").value,C=t.pstyle("border-width").pfValue,T=t.pstyle("background-opacity").value*b,F=t.pstyle("border-color").value,I=t.pstyle("border-style").value,D=t.pstyle("border-opacity").value*b;e.lineJoin="miter";var A=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:T;l.eleFillStyle(e,t,a)},L=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:D;l.colorStrokeStyle(e,F[0],F[1],F[2],t)},R=t.pstyle("shape").strValue,P=t.pstyle("shape-polygon-points").pfValue;if(h){e.translate(u.x,u.y);var N=l.nodePathCache=l.nodePathCache||[],z=Z("polygon"===R?R+","+P.join(","):R,""+n,""+i),B=N[z];null!=B?(p=B,f=!0,d.pathCache=p):(p=new Path2D,N[z]=d.pathCache=p)}var J=function(){if(!f){var a=u;h&&(a={x:0,y:0}),l.nodeShapes[l.getNodeShape(t)].draw(p||e,a.x,a.y,i,n)}h?e.fill(p):e.fill()},V=function(){for(var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:b,i=c.backgrounding,n=0,s=0;s<y.length;s++)v[s]&&y[s].complete&&!y[s].error&&(n++,l.drawInscribedImage(e,y[s],t,s,a));c.backgrounding=!(n===E),i!==c.backgrounding&&t.updateStyle(!1)},U=function(){var a=arguments.length>0&&void 0!==arguments[0]&&arguments[0],s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:b;l.hasPie(t)&&(l.drawPie(e,t,s),a&&(h||l.nodeShapes[l.getNodeShape(t)].draw(e,u.x,u.y,i,n)))},G=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:b,a=(k>0?k:-k)*t,i=k>0?0:255;0!==k&&(l.colorFillStyle(e,i,i,i,a),h?e.fill(p):e.fill())},q=function(){if(C>0){if(e.lineWidth=C,e.lineCap="butt",e.setLineDash)switch(I){case"dotted":e.setLineDash([1,1]);break;case"dashed":e.setLineDash([4,2]);break;case"solid":case"double":e.setLineDash([])}if(h?e.stroke(p):e.stroke(),"double"===I){e.lineWidth=C/3;var t=e.globalCompositeOperation;e.globalCompositeOperation="destination-out",h?e.stroke(p):e.stroke(),e.globalCompositeOperation=t}e.setLineDash&&e.setLineDash([])}},H=function(){r&&l.drawNodeOverlay(e,t,u,i,n)},W=function(){l.drawElementText(e,t,null,s)},$="yes"===t.pstyle("ghost").value;if($){var Y=t.pstyle("ghost-offset-x").pfValue,X=t.pstyle("ghost-offset-y").pfValue,Q=t.pstyle("ghost-opacity").value,K=Q*b;e.translate(Y,X),A(Q*T),J(),V(K),U(0!==k||0!==C),G(K),L(Q*D),q(),e.translate(-Y,-X)}A(),J(),V(),U(0!==k||0!==C),G(),L(),q(),h&&e.translate(-u.x,-u.y),W(),H(),a&&e.translate(m.x1,m.y1)}},drawNodeOverlay:function(e,t,a,i,n){if(t.visible()){var s=t.pstyle("overlay-padding").pfValue,r=t.pstyle("overlay-opacity").value,o=t.pstyle("overlay-color").value;if(r>0){if(a=a||t.position(),null==i||null==n){var l=t.padding();i=t.width()+2*l,n=t.height()+2*l}this.colorFillStyle(e,o[0],o[1],o[2],r),this.nodeShapes.roundrectangle.draw(e,a.x,a.y,i+2*s,n+2*s),e.fill()}}},hasPie:function(e){return(e=e[0])._private.hasPie},drawPie:function(e,t,a,i){t=t[0],i=i||t.position();var n=t.cy().style(),s=t.pstyle("pie-size"),r=i.x,o=i.y,l=t.width(),c=t.height(),d=Math.min(l,c)/2,u=0;this.usePaths()&&(r=0,o=0),"%"===s.units?d*=s.pfValue:void 0!==s.pfValue&&(d=s.pfValue/2);for(var p=1;p<=n.pieBackgroundN;p++){var m=t.pstyle("pie-"+p+"-background-size").value,b=t.pstyle("pie-"+p+"-background-color").value,h=t.pstyle("pie-"+p+"-background-opacity").value*a,f=m/100;f+u>1&&(f=1-u);var g=1.5*Math.PI+2*Math.PI*u,j=g+2*Math.PI*f;0===m||u>=1||u+f>1||(e.beginPath(),e.moveTo(r,o),e.arc(r,o,d,g,j),e.closePath(),this.colorFillStyle(e,b[0],b[1],b[2],h),e.fill(),u+=f)}}},Mo={};Mo.getPixelRatio=function(){var e=this.data.contexts[0];if(null!=this.forcedPixelRatio)return this.forcedPixelRatio;var t=e.backingStorePixelRatio||e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1;return(window.devicePixelRatio||1)/t},Mo.paintCache=function(e){for(var t,a=this.paintCaches=this.paintCaches||[],i=!0,n=0;n<a.length;n++)if((t=a[n]).context===e){i=!1;break}return i&&(t={context:e},a.push(t)),t},Mo.createGradientStyleFor=function(e,t,a,i,n){var s,r=this.usePaths(),o=a.pstyle(t+"-gradient-stop-colors").value,l=a.pstyle(t+"-gradient-stop-positions").pfValue;if("radial-gradient"===i)if(a.isEdge()){var c=a.sourceEndpoint(),d=a.targetEndpoint(),u=a.midpoint(),p=He(c,u),m=He(d,u);s=e.createRadialGradient(u.x,u.y,0,u.x,u.y,Math.max(p,m))}else{var b=r?{x:0,y:0}:a.position(),h=a.paddedWidth(),f=a.paddedHeight();s=e.createRadialGradient(b.x,b.y,0,b.x,b.y,Math.max(h,f))}else if(a.isEdge()){var g=a.sourceEndpoint(),j=a.targetEndpoint();s=e.createLinearGradient(g.x,g.y,j.x,j.y)}else{var x=r?{x:0,y:0}:a.position(),v=a.paddedWidth()/2,y=a.paddedHeight()/2;switch(a.pstyle("background-gradient-direction").value){case"to-bottom":s=e.createLinearGradient(x.x,x.y-y,x.x,x.y+y);break;case"to-top":s=e.createLinearGradient(x.x,x.y+y,x.x,x.y-y);break;case"to-left":s=e.createLinearGradient(x.x+v,x.y,x.x-v,x.y);break;case"to-right":s=e.createLinearGradient(x.x-v,x.y,x.x+v,x.y);break;case"to-bottom-right":case"to-right-bottom":s=e.createLinearGradient(x.x-v,x.y-y,x.x+v,x.y+y);break;case"to-top-right":case"to-right-top":s=e.createLinearGradient(x.x-v,x.y+y,x.x+v,x.y-y);break;case"to-bottom-left":case"to-left-bottom":s=e.createLinearGradient(x.x+v,x.y-y,x.x-v,x.y+y);break;case"to-top-left":case"to-left-top":s=e.createLinearGradient(x.x+v,x.y+y,x.x-v,x.y-y)}}if(!s)return null;for(var O=l.length===o.length,E=o.length,w=0;w<E;w++)s.addColorStop(O?l[w]:w/(E-1),"rgba("+o[w][0]+","+o[w][1]+","+o[w][2]+","+n+")");return s},Mo.gradientFillStyle=function(e,t,a,i){var n=this.createGradientStyleFor(e,"background",t,a,i);if(!n)return null;e.fillStyle=n},Mo.colorFillStyle=function(e,t,a,i,n){e.fillStyle="rgba("+t+","+a+","+i+","+n+")"},Mo.eleFillStyle=function(e,t,a){var i=t.pstyle("background-fill").value;if("linear-gradient"===i||"radial-gradient"===i)this.gradientFillStyle(e,t,i,a);else{var n=t.pstyle("background-color").value;this.colorFillStyle(e,n[0],n[1],n[2],a)}},Mo.gradientStrokeStyle=function(e,t,a,i){var n=this.createGradientStyleFor(e,"line",t,a,i);if(!n)return null;e.strokeStyle=n},Mo.colorStrokeStyle=function(e,t,a,i,n){e.strokeStyle="rgba("+t+","+a+","+i+","+n+")"},Mo.eleStrokeStyle=function(e,t,a){var i=t.pstyle("line-fill").value;if("linear-gradient"===i||"radial-gradient"===i)this.gradientStrokeStyle(e,t,i,a);else{var n=t.pstyle("line-color").value;this.colorStrokeStyle(e,n[0],n[1],n[2],a)}},Mo.matchCanvasSize=function(e){var t=this,a=t.data,i=t.findContainerClientCoords(),n=i[2],s=i[3],r=t.getPixelRatio(),o=t.motionBlurPxRatio;e!==t.data.bufferCanvases[t.MOTIONBLUR_BUFFER_NODE]&&e!==t.data.bufferCanvases[t.MOTIONBLUR_BUFFER_DRAG]||(r=o);var l,c=n*r,d=s*r;if(c!==t.canvasWidth||d!==t.canvasHeight){t.fontCaches=null;var u=a.canvasContainer;u.style.width=n+"px",u.style.height=s+"px";for(var p=0;p<t.CANVAS_LAYERS;p++)(l=a.canvases[p]).width=c,l.height=d,l.style.width=n+"px",l.style.height=s+"px";for(p=0;p<t.BUFFER_COUNT;p++)(l=a.bufferCanvases[p]).width=c,l.height=d,l.style.width=n+"px",l.style.height=s+"px";t.textureMult=1,r<=1&&(l=a.bufferCanvases[t.TEXTURE_BUFFER],t.textureMult=2,l.width=c*t.textureMult,l.height=d*t.textureMult),t.canvasWidth=c,t.canvasHeight=d}},Mo.renderTo=function(e,t,a,i){this.render({forcedContext:e,forcedZoom:t,forcedPan:a,drawAllLayers:!0,forcedPxRatio:i})},Mo.render=function(e){var t=(e=e||he()).forcedContext,a=e.drawAllLayers,i=e.drawOnlyNodeLayer,n=e.forcedZoom,s=e.forcedPan,r=this,o=void 0===e.forcedPxRatio?this.getPixelRatio():e.forcedPxRatio,l=r.cy,c=r.data,d=c.canvasNeedsRedraw,u=r.textureOnViewport&&!t&&(r.pinching||r.hoverData.dragging||r.swipePanning||r.data.wheelZooming),p=void 0!==e.motionBlur?e.motionBlur:r.motionBlur,m=r.motionBlurPxRatio,b=l.hasCompoundNodes(),h=r.hoverData.draggingEles,f=!(!r.hoverData.selecting&&!r.touchData.selecting),g=p=p&&!t&&r.motionBlurEnabled&&!f;t||(r.prevPxRatio!==o&&(r.invalidateContainerClientCoordsCache(),r.matchCanvasSize(r.container),r.redrawHint("eles",!0),r.redrawHint("drag",!0)),r.prevPxRatio=o),!t&&r.motionBlurTimeout&&clearTimeout(r.motionBlurTimeout),p&&(null==r.mbFrames&&(r.mbFrames=0),r.mbFrames++,r.mbFrames<3&&(g=!1),r.mbFrames>r.minMbLowQualFrames&&(r.motionBlurPxRatio=r.mbPxRBlurry)),r.clearingMotionBlur&&(r.motionBlurPxRatio=1),r.textureDrawLastFrame&&!u&&(d[r.NODE]=!0,d[r.SELECT_BOX]=!0);var j=l.style(),x=l.zoom(),v=void 0!==n?n:x,y=l.pan(),O={x:y.x,y:y.y},E={zoom:x,pan:{x:y.x,y:y.y}},w=r.prevViewport;void 0===w||E.zoom!==w.zoom||E.pan.x!==w.pan.x||E.pan.y!==w.pan.y||h&&!b||(r.motionBlurPxRatio=1),s&&(O=s),v*=o,O.x*=o,O.y*=o;var _=r.getCachedZSortedEles();function S(e,t,a,i,n){var s=e.globalCompositeOperation;e.globalCompositeOperation="destination-out",r.colorFillStyle(e,255,255,255,r.motionBlurTransparency),e.fillRect(t,a,i,n),e.globalCompositeOperation=s}function M(e,i){var o,l,d,u;r.clearingMotionBlur||e!==c.bufferContexts[r.MOTIONBLUR_BUFFER_NODE]&&e!==c.bufferContexts[r.MOTIONBLUR_BUFFER_DRAG]?(o=O,l=v,d=r.canvasWidth,u=r.canvasHeight):(o={x:y.x*m,y:y.y*m},l=x*m,d=r.canvasWidth*m,u=r.canvasHeight*m),e.setTransform(1,0,0,1,0,0),"motionBlur"===i?S(e,0,0,d,u):t||void 0!==i&&!i||e.clearRect(0,0,d,u),a||(e.translate(o.x,o.y),e.scale(l,l)),s&&e.translate(s.x,s.y),n&&e.scale(n,n)}if(u||(r.textureDrawLastFrame=!1),u){if(r.textureDrawLastFrame=!0,!r.textureCache){r.textureCache={},r.textureCache.bb=l.mutableElements().boundingBox(),r.textureCache.texture=r.data.bufferCanvases[r.TEXTURE_BUFFER];var k=r.data.bufferContexts[r.TEXTURE_BUFFER];k.setTransform(1,0,0,1,0,0),k.clearRect(0,0,r.canvasWidth*r.textureMult,r.canvasHeight*r.textureMult),r.render({forcedContext:k,drawOnlyNodeLayer:!0,forcedPxRatio:o*r.textureMult}),(E=r.textureCache.viewport={zoom:l.zoom(),pan:l.pan(),width:r.canvasWidth,height:r.canvasHeight}).mpan={x:(0-E.pan.x)/E.zoom,y:(0-E.pan.y)/E.zoom}}d[r.DRAG]=!1,d[r.NODE]=!1;var C=c.contexts[r.NODE],T=r.textureCache.texture;E=r.textureCache.viewport;C.setTransform(1,0,0,1,0,0),p?S(C,0,0,E.width,E.height):C.clearRect(0,0,E.width,E.height);var F=j.core("outside-texture-bg-color").value,I=j.core("outside-texture-bg-opacity").value;r.colorFillStyle(C,F[0],F[1],F[2],I),C.fillRect(0,0,E.width,E.height);x=l.zoom();M(C,!1),C.clearRect(E.mpan.x,E.mpan.y,E.width/E.zoom/o,E.height/E.zoom/o),C.drawImage(T,E.mpan.x,E.mpan.y,E.width/E.zoom/o,E.height/E.zoom/o)}else r.textureOnViewport&&!t&&(r.textureCache=null);var D=l.extent(),A=r.pinching||r.hoverData.dragging||r.swipePanning||r.data.wheelZooming||r.hoverData.draggingEles||r.cy.animated(),L=r.hideEdgesOnViewport&&A,R=[];if(R[r.NODE]=!d[r.NODE]&&p&&!r.clearedForMotionBlur[r.NODE]||r.clearingMotionBlur,R[r.NODE]&&(r.clearedForMotionBlur[r.NODE]=!0),R[r.DRAG]=!d[r.DRAG]&&p&&!r.clearedForMotionBlur[r.DRAG]||r.clearingMotionBlur,R[r.DRAG]&&(r.clearedForMotionBlur[r.DRAG]=!0),d[r.NODE]||a||i||R[r.NODE]){var P=p&&!R[r.NODE]&&1!==m;M(C=t||(P?r.data.bufferContexts[r.MOTIONBLUR_BUFFER_NODE]:c.contexts[r.NODE]),p&&!P?"motionBlur":void 0),L?r.drawCachedNodes(C,_.nondrag,o,D):r.drawLayeredElements(C,_.nondrag,o,D),r.debug&&r.drawDebugPoints(C,_.nondrag),a||p||(d[r.NODE]=!1)}if(!i&&(d[r.DRAG]||a||R[r.DRAG])){P=p&&!R[r.DRAG]&&1!==m;M(C=t||(P?r.data.bufferContexts[r.MOTIONBLUR_BUFFER_DRAG]:c.contexts[r.DRAG]),p&&!P?"motionBlur":void 0),L?r.drawCachedNodes(C,_.drag,o,D):r.drawCachedElements(C,_.drag,o,D),r.debug&&r.drawDebugPoints(C,_.drag),a||p||(d[r.DRAG]=!1)}if(r.showFps||!i&&d[r.SELECT_BOX]&&!a){if(M(C=t||c.contexts[r.SELECT_BOX]),1==r.selection[4]&&(r.hoverData.selecting||r.touchData.selecting)){x=r.cy.zoom();var N=j.core("selection-box-border-width").value/x;C.lineWidth=N,C.fillStyle="rgba("+j.core("selection-box-color").value[0]+","+j.core("selection-box-color").value[1]+","+j.core("selection-box-color").value[2]+","+j.core("selection-box-opacity").value+")",C.fillRect(r.selection[0],r.selection[1],r.selection[2]-r.selection[0],r.selection[3]-r.selection[1]),N>0&&(C.strokeStyle="rgba("+j.core("selection-box-border-color").value[0]+","+j.core("selection-box-border-color").value[1]+","+j.core("selection-box-border-color").value[2]+","+j.core("selection-box-opacity").value+")",C.strokeRect(r.selection[0],r.selection[1],r.selection[2]-r.selection[0],r.selection[3]-r.selection[1]))}if(c.bgActivePosistion&&!r.hoverData.selecting){x=r.cy.zoom();var z=c.bgActivePosistion;C.fillStyle="rgba("+j.core("active-bg-color").value[0]+","+j.core("active-bg-color").value[1]+","+j.core("active-bg-color").value[2]+","+j.core("active-bg-opacity").value+")",C.beginPath(),C.arc(z.x,z.y,j.core("active-bg-size").pfValue/x,0,2*Math.PI),C.fill()}var B=r.lastRedrawTime;if(r.showFps&&B){B=Math.round(B);var J=Math.round(1e3/B);C.setTransform(1,0,0,1,0,0),C.fillStyle="rgba(255, 0, 0, 0.75)",C.strokeStyle="rgba(255, 0, 0, 0.75)",C.lineWidth=1,C.fillText("1 frame = "+B+" ms = "+J+" fps",0,20);C.strokeRect(0,30,250,20),C.fillRect(0,30,250*Math.min(J/60,1),20)}a||(d[r.SELECT_BOX]=!1)}if(p&&1!==m){var V=c.contexts[r.NODE],U=r.data.bufferCanvases[r.MOTIONBLUR_BUFFER_NODE],G=c.contexts[r.DRAG],q=r.data.bufferCanvases[r.MOTIONBLUR_BUFFER_DRAG],H=function(e,t,a){e.setTransform(1,0,0,1,0,0),a||!g?e.clearRect(0,0,r.canvasWidth,r.canvasHeight):S(e,0,0,r.canvasWidth,r.canvasHeight);var i=m;e.drawImage(t,0,0,r.canvasWidth*i,r.canvasHeight*i,0,0,r.canvasWidth,r.canvasHeight)};(d[r.NODE]||R[r.NODE])&&(H(V,U,R[r.NODE]),d[r.NODE]=!1),(d[r.DRAG]||R[r.DRAG])&&(H(G,q,R[r.DRAG]),d[r.DRAG]=!1)}r.prevViewport=E,r.clearingMotionBlur&&(r.clearingMotionBlur=!1,r.motionBlurCleared=!0,r.motionBlur=!0),p&&(r.motionBlurTimeout=setTimeout((function(){r.motionBlurTimeout=null,r.clearedForMotionBlur[r.NODE]=!1,r.clearedForMotionBlur[r.DRAG]=!1,r.motionBlur=!1,r.clearingMotionBlur=!u,r.mbFrames=0,d[r.NODE]=!0,d[r.DRAG]=!0,r.redraw()}),100)),t||l.emit("render")};for(var ko={drawPolygonPath:function(e,t,a,i,n,s){var r=i/2,o=n/2;e.beginPath&&e.beginPath(),e.moveTo(t+r*s[0],a+o*s[1]);for(var l=1;l<s.length/2;l++)e.lineTo(t+r*s[2*l],a+o*s[2*l+1]);e.closePath()},drawRoundRectanglePath:function(e,t,a,i,n){var s=i/2,r=n/2,o=_t(i,n);e.beginPath&&e.beginPath(),e.moveTo(t,a-r),e.arcTo(t+s,a-r,t+s,a,o),e.arcTo(t+s,a+r,t,a+r,o),e.arcTo(t-s,a+r,t-s,a,o),e.arcTo(t-s,a-r,t,a-r,o),e.lineTo(t,a-r),e.closePath()},drawBottomRoundRectanglePath:function(e,t,a,i,n){var s=i/2,r=n/2,o=_t(i,n);e.beginPath&&e.beginPath(),e.moveTo(t,a-r),e.lineTo(t+s,a-r),e.lineTo(t+s,a),e.arcTo(t+s,a+r,t,a+r,o),e.arcTo(t-s,a+r,t-s,a,o),e.lineTo(t-s,a-r),e.lineTo(t,a-r),e.closePath()},drawCutRectanglePath:function(e,t,a,i,n){var s=i/2,r=n/2;e.beginPath&&e.beginPath(),e.moveTo(t-s+8,a-r),e.lineTo(t+s-8,a-r),e.lineTo(t+s,a-r+8),e.lineTo(t+s,a+r-8),e.lineTo(t+s-8,a+r),e.lineTo(t-s+8,a+r),e.lineTo(t-s,a+r-8),e.lineTo(t-s,a-r+8),e.closePath()},drawBarrelPath:function(e,t,a,i,n){var s=i/2,r=n/2,o=t-s,l=t+s,c=a-r,d=a+r,u=St(i,n),p=u.widthOffset,m=u.heightOffset,b=u.ctrlPtOffsetPct*p;e.beginPath&&e.beginPath(),e.moveTo(o,c+m),e.lineTo(o,d-m),e.quadraticCurveTo(o+b,d,o+p,d),e.lineTo(l-p,d),e.quadraticCurveTo(l-b,d,l,d-m),e.lineTo(l,c+m),e.quadraticCurveTo(l-b,c,l-p,c),e.lineTo(o+p,c),e.quadraticCurveTo(o+b,c,o,c+m),e.closePath()}},Co=Math.sin(0),To=Math.cos(0),Fo={},Io={},Do=Math.PI/40,Ao=0*Math.PI;Ao<2*Math.PI;Ao+=Do)Fo[Ao]=Math.sin(Ao),Io[Ao]=Math.cos(Ao);ko.drawEllipsePath=function(e,t,a,i,n){if(e.beginPath&&e.beginPath(),e.ellipse)e.ellipse(t,a,i/2,n/2,0,0,2*Math.PI);else for(var s,r,o=i/2,l=n/2,c=0*Math.PI;c<2*Math.PI;c+=Do)s=t-o*Fo[c]*Co+o*Io[c]*To,r=a+l*Io[c]*Co+l*Fo[c]*To,0===c?e.moveTo(s,r):e.lineTo(s,r);e.closePath()};var Lo={};function Ro(e){var t=e.indexOf(",");return e.substr(t+1)}function Po(e,t,a){var i=function(){return t.toDataURL(a,e.quality)};switch(e.output){case"blob-promise":return new Aa((function(i,n){try{t.toBlob((function(e){null!=e?i(e):n(new Error("`canvas.toBlob()` sent a null value in its callback"))}),a,e.quality)}catch(e){n(e)}}));case"blob":return function(e,t){for(var a=atob(e),i=new ArrayBuffer(a.length),n=new Uint8Array(i),s=0;s<a.length;s++)n[s]=a.charCodeAt(s);return new Blob([i],{type:t})}(Ro(i()),a);case"base64":return Ro(i());default:return i()}}Lo.createBuffer=function(e,t){var a=document.createElement("canvas");return a.width=e,a.height=t,[a,a.getContext("2d")]},Lo.bufferCanvasImage=function(e){var t=this.cy,a=t.mutableElements().boundingBox(),i=this.findContainerClientCoords(),n=e.full?Math.ceil(a.w):i[2],s=e.full?Math.ceil(a.h):i[3],r=O(e.maxWidth)||O(e.maxHeight),o=this.getPixelRatio(),l=1;if(void 0!==e.scale)n*=e.scale,s*=e.scale,l=e.scale;else if(r){var c=1/0,d=1/0;O(e.maxWidth)&&(c=l*e.maxWidth/n),O(e.maxHeight)&&(d=l*e.maxHeight/s),n*=l=Math.min(c,d),s*=l}r||(n*=o,s*=o,l*=o);var u=document.createElement("canvas");u.width=n,u.height=s,u.style.width=n+"px",u.style.height=s+"px";var p=u.getContext("2d");if(n>0&&s>0){p.clearRect(0,0,n,s),p.globalCompositeOperation="source-over";var m=this.getCachedZSortedEles();if(e.full)p.translate(-a.x1*l,-a.y1*l),p.scale(l,l),this.drawElements(p,m),p.scale(1/l,1/l),p.translate(a.x1*l,a.y1*l);else{var b=t.pan(),h={x:b.x*l,y:b.y*l};l*=t.zoom(),p.translate(h.x,h.y),p.scale(l,l),this.drawElements(p,m),p.scale(1/l,1/l),p.translate(-h.x,-h.y)}e.bg&&(p.globalCompositeOperation="destination-over",p.fillStyle=e.bg,p.rect(0,0,n,s),p.fill())}return u},Lo.png=function(e){return Po(e,this.bufferCanvasImage(e),"image/png")},Lo.jpg=function(e){return Po(e,this.bufferCanvasImage(e),"image/jpeg")};var No={nodeShapeImpl:function(e,t,a,i,n,s,r){switch(e){case"ellipse":return this.drawEllipsePath(t,a,i,n,s);case"polygon":return this.drawPolygonPath(t,a,i,n,s,r);case"roundrectangle":case"round-rectangle":return this.drawRoundRectanglePath(t,a,i,n,s);case"cutrectangle":case"cut-rectangle":return this.drawCutRectanglePath(t,a,i,n,s);case"bottomroundrectangle":case"bottom-round-rectangle":return this.drawBottomRoundRectanglePath(t,a,i,n,s);case"barrel":return this.drawBarrelPath(t,a,i,n,s)}}},zo=Jo,Bo=Jo.prototype;function Jo(e){var t=this;t.data={canvases:new Array(Bo.CANVAS_LAYERS),contexts:new Array(Bo.CANVAS_LAYERS),canvasNeedsRedraw:new Array(Bo.CANVAS_LAYERS),bufferCanvases:new Array(Bo.BUFFER_COUNT),bufferContexts:new Array(Bo.CANVAS_LAYERS)};var a="-webkit-tap-highlight-color",i="rgba(0,0,0,0)";t.data.canvasContainer=document.createElement("div");var n=t.data.canvasContainer.style;t.data.canvasContainer.style[a]=i,n.position="relative",n.zIndex="0",n.overflow="hidden";var s=e.cy.container();s.appendChild(t.data.canvasContainer),s.style[a]=i;var r={"-webkit-user-select":"none","-moz-user-select":"-moz-none","user-select":"none","-webkit-tap-highlight-color":"rgba(0,0,0,0)","outline-style":"none"};p&&p.userAgent.match(/msie|trident|edge/i)&&(r["-ms-touch-action"]="none",r["touch-action"]="none");for(var o=0;o<Bo.CANVAS_LAYERS;o++){var l=t.data.canvases[o]=document.createElement("canvas");t.data.contexts[o]=l.getContext("2d"),Object.keys(r).forEach((function(e){l.style[e]=r[e]})),l.style.position="absolute",l.setAttribute("data-id","layer"+o),l.style.zIndex=String(Bo.CANVAS_LAYERS-o),t.data.canvasContainer.appendChild(l),t.data.canvasNeedsRedraw[o]=!1}t.data.topCanvas=t.data.canvases[0],t.data.canvases[Bo.NODE].setAttribute("data-id","layer"+Bo.NODE+"-node"),t.data.canvases[Bo.SELECT_BOX].setAttribute("data-id","layer"+Bo.SELECT_BOX+"-selectbox"),t.data.canvases[Bo.DRAG].setAttribute("data-id","layer"+Bo.DRAG+"-drag");for(o=0;o<Bo.BUFFER_COUNT;o++)t.data.bufferCanvases[o]=document.createElement("canvas"),t.data.bufferContexts[o]=t.data.bufferCanvases[o].getContext("2d"),t.data.bufferCanvases[o].style.position="absolute",t.data.bufferCanvases[o].setAttribute("data-id","buffer"+o),t.data.bufferCanvases[o].style.zIndex=String(-o-1),t.data.bufferCanvases[o].style.visibility="hidden";t.pathsEnabled=!0;var c=Ke(),d=function(e){return{x:-e.w/2,y:-e.h/2}},u=function(e){return e.boundingBox(),e[0]._private.bodyBounds},m=function(e){return e.boundingBox(),e[0]._private.labelBounds.main||c},b=function(e){return e.boundingBox(),e[0]._private.labelBounds.source||c},h=function(e){return e.boundingBox(),e[0]._private.labelBounds.target||c},f=function(e,t){return t},g=function(e,t){return{x:e.x+t.pstyle("text-margin-x").pfValue,y:e.y+t.pstyle("text-margin-y").pfValue}},j=function(e,t,a){var i=e[0]._private.rscratch;return{x:i[t],y:i[a]}},x=t.data.eleTxrCache=new ao(t,{getKey:function(e){return e[0]._private.nodeKey},doesEleInvalidateKey:function(e){var t=e[0]._private;return!(t.oldBackgroundTimestamp===t.backgroundTimestamp)},drawElement:function(e,a,i,n,s){return t.drawElement(e,a,i,!1,!1,s)},getBoundingBox:u,getRotationPoint:function(e){return{x:((t=u(e)).x1+t.x2)/2,y:(t.y1+t.y2)/2};var t},getRotationOffset:function(e){return d(u(e))},allowEdgeTxrCaching:!1,allowParentTxrCaching:!1}),v=t.data.lblTxrCache=new ao(t,{getKey:function(e){return e[0]._private.labelStyleKey},drawElement:function(e,a,i,n,s){return t.drawElementText(e,a,i,n,"main",s)},getBoundingBox:m,getRotationPoint:function(e){return g(j(e,"labelX","labelY"),e)},getRotationOffset:function(e){var t=m(e),a=d(m(e));if(e.isNode()){switch(e.pstyle("text-halign").value){case"left":a.x=-t.w;break;case"right":a.x=0}switch(e.pstyle("text-valign").value){case"top":a.y=-t.h;break;case"bottom":a.y=0}}return a},isVisible:f}),y=t.data.slbTxrCache=new ao(t,{getKey:function(e){return e[0]._private.sourceLabelStyleKey},drawElement:function(e,a,i,n,s){return t.drawElementText(e,a,i,n,"source",s)},getBoundingBox:b,getRotationPoint:function(e){return g(j(e,"sourceLabelX","sourceLabelY"),e)},getRotationOffset:function(e){return d(b(e))},isVisible:f}),O=t.data.tlbTxrCache=new ao(t,{getKey:function(e){return e[0]._private.targetLabelStyleKey},drawElement:function(e,a,i,n,s){return t.drawElementText(e,a,i,n,"target",s)},getBoundingBox:h,getRotationPoint:function(e){return g(j(e,"targetLabelX","targetLabelY"),e)},getRotationOffset:function(e){return d(h(e))},isVisible:f}),E=t.data.lyrTxrCache=new no(t);t.onUpdateEleCalcs((function(e,t){x.invalidateElements(t),v.invalidateElements(t),y.invalidateElements(t),O.invalidateElements(t),E.invalidateElements(t);for(var a=0;a<t.length;a++){var i=t[a]._private;i.oldBackgroundTimestamp=i.backgroundTimestamp}}));var w=function(e){for(var t=0;t<e.length;t++)E.enqueueElementRefinement(e[t].ele)};x.onDequeue(w),v.onDequeue(w),y.onDequeue(w),O.onDequeue(w)}Bo.CANVAS_LAYERS=3,Bo.SELECT_BOX=0,Bo.DRAG=1,Bo.NODE=2,Bo.BUFFER_COUNT=3,Bo.TEXTURE_BUFFER=0,Bo.MOTIONBLUR_BUFFER_NODE=1,Bo.MOTIONBLUR_BUFFER_DRAG=2,Bo.redrawHint=function(e,t){var a=this;switch(e){case"eles":a.data.canvasNeedsRedraw[Bo.NODE]=t;break;case"drag":a.data.canvasNeedsRedraw[Bo.DRAG]=t;break;case"select":a.data.canvasNeedsRedraw[Bo.SELECT_BOX]=t}};var Vo="undefined"!=typeof Path2D;Bo.path2dEnabled=function(e){if(void 0===e)return this.pathsEnabled;this.pathsEnabled=!!e},Bo.usePaths=function(){return Vo&&this.pathsEnabled},Bo.setImgSmoothing=function(e,t){null!=e.imageSmoothingEnabled?e.imageSmoothingEnabled=t:(e.webkitImageSmoothingEnabled=t,e.mozImageSmoothingEnabled=t,e.msImageSmoothingEnabled=t)},Bo.getImgSmoothing=function(e){return null!=e.imageSmoothingEnabled?e.imageSmoothingEnabled:e.webkitImageSmoothingEnabled||e.mozImageSmoothingEnabled||e.msImageSmoothingEnabled},Bo.makeOffscreenCanvas=function(e,t){var a;return"undefined"!==("undefined"==typeof OffscreenCanvas?"undefined":r(OffscreenCanvas))?a=new OffscreenCanvas(e,t):((a=document.createElement("canvas")).width=e,a.height=t),a},[co,ho,Oo,Eo,wo,So,Mo,ko,Lo,No].forEach((function(e){N(Bo,e)}));var Uo=[{type:"layout",extensions:_r},{type:"renderer",extensions:[{name:"null",impl:Sr},{name:"base",impl:Yr},{name:"canvas",impl:zo}]}],Go={},qo={};function Ho(e,t,a){var i=a,n=function(a){ce("Can not register `"+t+"` for `"+e+"` since `"+a+"` already exists in the prototype and can not be overridden")};if("core"===e){if(zs.prototype[t])return n(t);zs.prototype[t]=a}else if("collection"===e){if(as.prototype[t])return n(t);as.prototype[t]=a}else if("layout"===e){for(var s=function(e){this.options=e,a.call(this,e),y(this._private)||(this._private={}),this._private.cy=e.cy,this._private.listeners=[],this.createEmitter()},r=s.prototype=Object.create(a.prototype),o=[],l=0;l<o.length;l++){var c=o[l];r[c]=r[c]||function(){return this}}r.start&&!r.run?r.run=function(){return this.start(),this}:!r.start&&r.run&&(r.start=function(){return this.run(),this});var d=a.prototype.stop;r.stop=function(){var e=this.options;if(e&&e.animate){var t=this.animations;if(t)for(var a=0;a<t.length;a++)t[a].stop()}return d?d.call(this):this.emit("layoutstop"),this},r.destroy||(r.destroy=function(){return this}),r.cy=function(){return this._private.cy};var u=function(e){return e._private.cy},p={addEventFields:function(e,t){t.layout=e,t.cy=u(e),t.target=e},bubble:function(){return!0},parent:function(e){return u(e)}};N(r,{createEmitter:function(){return this._private.emitter=new vn(p,this),this},emitter:function(){return this._private.emitter},on:function(e,t){return this.emitter().on(e,t),this},one:function(e,t){return this.emitter().one(e,t),this},once:function(e,t){return this.emitter().one(e,t),this},removeListener:function(e,t){return this.emitter().removeListener(e,t),this},removeAllListeners:function(){return this.emitter().removeAllListeners(),this},emit:function(e,t){return this.emitter().emit(e,t),this}}),Ba.eventAliasesOn(r),i=s}else if("renderer"===e&&"null"!==t&&"base"!==t){var m=Wo("renderer","base"),b=m.prototype,h=a,f=a.prototype,g=function(){m.apply(this,arguments),h.apply(this,arguments)},j=g.prototype;for(var x in b){var v=b[x];if(null!=f[x])return n(x);j[x]=v}for(var O in f)j[O]=f[O];b.clientFunctions.forEach((function(e){j[e]=j[e]||function(){ce("Renderer does not implement `renderer."+e+"()` on its prototype")}})),i=g}return J({map:Go,keys:[e,t],value:i})}function Wo(e,t){return V({map:Go,keys:[e,t]})}function $o(e,t,a,i,n){return J({map:qo,keys:[e,t,a,i],value:n})}function Yo(e,t,a,i){return V({map:qo,keys:[e,t,a,i]})}var Xo=function(){return 2===arguments.length?Wo.apply(null,arguments):3===arguments.length?Ho.apply(null,arguments):4===arguments.length?Yo.apply(null,arguments):5===arguments.length?$o.apply(null,arguments):void ce("Invalid extension access syntax")};zs.prototype.extension=Xo,Uo.forEach((function(e){e.extensions.forEach((function(t){Ho(e.type,t.name,t.impl)}))}));var Qo=function e(){if(!(this instanceof e))return new e;this.length=0},Ko=Qo.prototype;Ko.instanceString=function(){return"stylesheet"},Ko.selector=function(e){return this[this.length++]={selector:e,properties:[]},this},Ko.css=function(e,t){var a=this.length-1;if(j(e))this[a].properties.push({name:e,value:t});else if(y(e))for(var i=e,n=Object.keys(i),s=0;s<n.length;s++){var r=n[s],o=i[r];if(null!=o){var l=As.properties[r]||As.properties[D(r)];if(null!=l){var c=l.name,d=o;this[a].properties.push({name:c,value:d})}}}return this},Ko.style=Ko.css,Ko.generateStyle=function(e){var t=new As(e);return this.appendToStyle(t)},Ko.appendToStyle=function(e){for(var t=0;t<this.length;t++){var a=this[t],i=a.selector,n=a.properties;e.selector(i);for(var s=0;s<n.length;s++){var r=n[s];e.css(r.name,r.value)}}return e};var Zo=function(e){return void 0===e&&(e={}),y(e)?new zs(e):j(e)?Xo.apply(Xo,arguments):void 0};Zo.use=function(e){var t=Array.prototype.slice.call(arguments,1);return t.unshift(Zo),e.apply(null,t),this},Zo.warnings=function(e){return de(e)},Zo.version="3.10.0",Zo.stylesheet=Zo.Stylesheet=Qo,e.exports=Zo}).call(this,a(464).setImmediate)},function(e,t,a){(function(e){var i=Function.prototype.apply;function n(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new n(i.call(setTimeout,window,arguments),clearTimeout)},t.setInterval=function(){return new n(i.call(setInterval,window,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},n.prototype.unref=n.prototype.ref=function(){},n.prototype.close=function(){this._clearFn.call(window,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout((function(){e._onTimeout&&e._onTimeout()}),t))},a(465),t.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||this&&this.clearImmediate}).call(this,a(121))},function(e,t,a){(function(e,t){!function(e,a){"use strict";if(!e.setImmediate){var i,n,s,r,o,l=1,c={},d=!1,u=e.document,p=Object.getPrototypeOf&&Object.getPrototypeOf(e);p=p&&p.setTimeout?p:e,"[object process]"==={}.toString.call(e.process)?i=function(e){t.nextTick((function(){b(e)}))}:!function(){if(e.postMessage&&!e.importScripts){var t=!0,a=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=a,t}}()?e.MessageChannel?((s=new MessageChannel).port1.onmessage=function(e){b(e.data)},i=function(e){s.port2.postMessage(e)}):u&&"onreadystatechange"in u.createElement("script")?(n=u.documentElement,i=function(e){var t=u.createElement("script");t.onreadystatechange=function(){b(e),t.onreadystatechange=null,n.removeChild(t),t=null},n.appendChild(t)}):i=function(e){setTimeout(b,0,e)}:(r="setImmediate$"+Math.random()+"$",o=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(r)&&b(+t.data.slice(r.length))},e.addEventListener?e.addEventListener("message",o,!1):e.attachEvent("onmessage",o),i=function(t){e.postMessage(r+t,"*")}),p.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),a=0;a<t.length;a++)t[a]=arguments[a+1];var n={callback:e,args:t};return c[l]=n,i(l),l++},p.clearImmediate=m}function m(e){delete c[e]}function b(e){if(d)setTimeout(b,0,e);else{var t=c[e];if(t){d=!0;try{!function(e){var t=e.callback,a=e.args;switch(a.length){case 0:t();break;case 1:t(a[0]);break;case 2:t(a[0],a[1]);break;case 3:t(a[0],a[1],a[2]);break;default:t.apply(void 0,a)}}(t)}finally{m(e),d=!1}}}}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,a(121),a(197))},function(e,t,a){(function(t){var a=/^\s+|\s+$/g,i=/^[-+]0x[0-9a-f]+$/i,n=/^0b[01]+$/i,s=/^0o[0-7]+$/i,r=parseInt,o="object"==typeof t&&t&&t.Object===Object&&t,l="object"==typeof self&&self&&self.Object===Object&&self,c=o||l||Function("return this")(),d=Object.prototype.toString,u=Math.max,p=Math.min,m=function(){return c.Date.now()};function b(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function h(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==d.call(e)}(e))return NaN;if(b(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=b(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(a,"");var o=n.test(e);return o||s.test(e)?r(e.slice(2),o?2:8):i.test(e)?NaN:+e}e.exports=function(e,t,a){var i,n,s,r,o,l,c=0,d=!1,f=!1,g=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function j(t){var a=i,s=n;return i=n=void 0,c=t,r=e.apply(s,a)}function x(e){return c=e,o=setTimeout(y,t),d?j(e):r}function v(e){var a=e-l;return void 0===l||a>=t||a<0||f&&e-c>=s}function y(){var e=m();if(v(e))return O(e);o=setTimeout(y,function(e){var a=t-(e-l);return f?p(a,s-(e-c)):a}(e))}function O(e){return o=void 0,g&&i?j(e):(i=n=void 0,r)}function E(){var e=m(),a=v(e);if(i=arguments,n=this,l=e,a){if(void 0===o)return x(l);if(f)return o=setTimeout(y,t),j(l)}return void 0===o&&(o=setTimeout(y,t)),r}return t=h(t)||0,b(a)&&(d=!!a.leading,s=(f="maxWait"in a)?u(h(a.maxWait)||0,t):s,g="trailing"in a?!!a.trailing:g),E.cancel=function(){void 0!==o&&clearTimeout(o),c=0,i=l=n=o=void 0},E.flush=function(){return void 0===o?r:O(m())},E}}).call(this,a(121))},function(e,t,a){e.exports=a(468)},function(e,t,a){var i,n,s;(function(){var a,r,o,l,c,d,u,p,m,b,h,f,g,j,x;o=Math.floor,b=Math.min,r=function(e,t){return e<t?-1:e>t?1:0},m=function(e,t,a,i,n){var s;if(null==a&&(a=0),null==n&&(n=r),a<0)throw new Error("lo must be non-negative");for(null==i&&(i=e.length);a<i;)n(t,e[s=o((a+i)/2)])<0?i=s:a=s+1;return[].splice.apply(e,[a,a-a].concat(t)),t},d=function(e,t,a){return null==a&&(a=r),e.push(t),j(e,0,e.length-1,a)},c=function(e,t){var a,i;return null==t&&(t=r),a=e.pop(),e.length?(i=e[0],e[0]=a,x(e,0,t)):i=a,i},p=function(e,t,a){var i;return null==a&&(a=r),i=e[0],e[0]=t,x(e,0,a),i},u=function(e,t,a){var i;return null==a&&(a=r),e.length&&a(e[0],t)<0&&(t=(i=[e[0],t])[0],e[0]=i[1],x(e,0,a)),t},l=function(e,t){var a,i,n,s,l,c;for(null==t&&(t=r),s=function(){c=[];for(var t=0,a=o(e.length/2);0<=a?t<a:t>a;0<=a?t++:t--)c.push(t);return c}.apply(this).reverse(),l=[],i=0,n=s.length;i<n;i++)a=s[i],l.push(x(e,a,t));return l},g=function(e,t,a){var i;if(null==a&&(a=r),-1!==(i=e.indexOf(t)))return j(e,0,i,a),x(e,i,a)},h=function(e,t,a){var i,n,s,o,c;if(null==a&&(a=r),!(n=e.slice(0,t)).length)return n;for(l(n,a),s=0,o=(c=e.slice(t)).length;s<o;s++)i=c[s],u(n,i,a);return n.sort(a).reverse()},f=function(e,t,a){var i,n,s,o,d,u,p,h,f;if(null==a&&(a=r),10*t<=e.length){if(!(s=e.slice(0,t).sort(a)).length)return s;for(n=s[s.length-1],o=0,u=(p=e.slice(t)).length;o<u;o++)a(i=p[o],n)<0&&(m(s,i,0,null,a),s.pop(),n=s[s.length-1]);return s}for(l(e,a),f=[],d=0,h=b(t,e.length);0<=h?d<h:d>h;0<=h?++d:--d)f.push(c(e,a));return f},j=function(e,t,a,i){var n,s,o;for(null==i&&(i=r),n=e[a];a>t&&i(n,s=e[o=a-1>>1])<0;)e[a]=s,a=o;return e[a]=n},x=function(e,t,a){var i,n,s,o,l;for(null==a&&(a=r),n=e.length,l=t,s=e[t],i=2*t+1;i<n;)(o=i+1)<n&&!(a(e[i],e[o])<0)&&(i=o),e[t]=e[i],i=2*(t=i)+1;return e[t]=s,j(e,l,t,a)},a=function(){function e(e){this.cmp=null!=e?e:r,this.nodes=[]}return e.push=d,e.pop=c,e.replace=p,e.pushpop=u,e.heapify=l,e.updateItem=g,e.nlargest=h,e.nsmallest=f,e.prototype.push=function(e){return d(this.nodes,e,this.cmp)},e.prototype.pop=function(){return c(this.nodes,this.cmp)},e.prototype.peek=function(){return this.nodes[0]},e.prototype.contains=function(e){return-1!==this.nodes.indexOf(e)},e.prototype.replace=function(e){return p(this.nodes,e,this.cmp)},e.prototype.pushpop=function(e){return u(this.nodes,e,this.cmp)},e.prototype.heapify=function(){return l(this.nodes,this.cmp)},e.prototype.updateItem=function(e){return g(this.nodes,e,this.cmp)},e.prototype.clear=function(){return this.nodes=[]},e.prototype.empty=function(){return 0===this.nodes.length},e.prototype.size=function(){return this.nodes.length},e.prototype.clone=function(){var t;return(t=new e).nodes=this.nodes.slice(0),t},e.prototype.toArray=function(){return this.nodes.slice(0)},e.prototype.insert=e.prototype.push,e.prototype.top=e.prototype.peek,e.prototype.front=e.prototype.peek,e.prototype.has=e.prototype.contains,e.prototype.copy=e.prototype.clone,e}(),n=[],void 0===(s="function"==typeof(i=function(){return a})?i.apply(t,n):i)||(e.exports=s)}).call(this)},function(e,t,a){var i;i=function(e){return function(e){var t={};function a(i){if(t[i])return t[i].exports;var n=t[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,a),n.l=!0,n.exports}return a.m=e,a.c=t,a.i=function(e){return e},a.d=function(e,t,i){a.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:i})},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=3)}([function(e,t,a){"use strict";var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=a(2),s=a(1),r=a(4);function o(e){this.options=s({},n,e)}o.prototype.run=function(){var e=this.options,t=e.cy,a=e.eles,n=function(e,t){return"function"==typeof t?t.apply(e,[e]):t},s=e.boundingBox||{x1:0,y1:0,w:t.width(),h:t.height()};void 0===s.x2&&(s.x2=s.x1+s.w),void 0===s.w&&(s.w=s.x2-s.x1),void 0===s.y2&&(s.y2=s.y1+s.h),void 0===s.h&&(s.h=s.y2-s.y1);var o=new r.graphlib.Graph({multigraph:!0,compound:!0}),l={},c=function(e,t){null!=t&&(l[e]=t)};c("nodesep",e.nodeSep),c("edgesep",e.edgeSep),c("ranksep",e.rankSep),c("rankdir",e.rankDir),c("ranker",e.ranker),o.setGraph(l),o.setDefaultEdgeLabel((function(){return{}})),o.setDefaultNodeLabel((function(){return{}}));for(var d=a.nodes(),u=0;u<d.length;u++){var p=d[u],m=p.layoutDimensions(e);o.setNode(p.id(),{width:m.w,height:m.h,name:p.id()})}for(var b=0;b<d.length;b++){var h=d[b];h.isChild()&&o.setParent(h.id(),h.parent().id())}for(var f=a.edges().stdFilter((function(e){return!e.source().isParent()&&!e.target().isParent()})),g=0;g<f.length;g++){var j=f[g];o.setEdge(j.source().id(),j.target().id(),{minlen:n(j,e.minLen),weight:n(j,e.edgeWeight),name:j.id()},j.id())}r.layout(o);for(var x=o.nodes(),v=0;v<x.length;v++){var y=x[v],O=o.node(y);t.getElementById(y).scratch().dagre=O}var E=void 0;return e.boundingBox?(E={x1:1/0,x2:-1/0,y1:1/0,y2:-1/0},d.forEach((function(e){var t=e.scratch().dagre;E.x1=Math.min(E.x1,t.x),E.x2=Math.max(E.x2,t.x),E.y1=Math.min(E.y1,t.y),E.y2=Math.max(E.y2,t.y)})),E.w=E.x2-E.x1,E.h=E.y2-E.y1):E=s,d.layoutPositions(this,e,(function(t){var a=(t="object"===(void 0===t?"undefined":i(t))?t:this).scratch().dagre;return function(t){if(e.boundingBox){var a=0===E.w?0:(t.x-E.x1)/E.w,i=0===E.h?0:(t.y-E.y1)/E.h;return{x:s.x1+a*s.w,y:s.y1+i*s.h}}return t}({x:a.x,y:a.y})})),this},e.exports=o},function(e,t,a){"use strict";e.exports=null!=Object.assign?Object.assign.bind(Object):function(e){for(var t=arguments.length,a=Array(t>1?t-1:0),i=1;i<t;i++)a[i-1]=arguments[i];return a.forEach((function(t){Object.keys(t).forEach((function(a){return e[a]=t[a]}))})),e}},function(e,t,a){"use strict";var i={nodeSep:void 0,edgeSep:void 0,rankSep:void 0,rankDir:void 0,ranker:void 0,minLen:function(e){return 1},edgeWeight:function(e){return 1},fit:!0,padding:30,spacingFactor:void 0,nodeDimensionsIncludeLabels:!1,animate:!1,animateFilter:function(e,t){return!0},animationDuration:500,animationEasing:void 0,boundingBox:void 0,transform:function(e,t){return t},ready:function(){},stop:function(){}};e.exports=i},function(e,t,a){"use strict";var i=a(0),n=function(e){e&&e("layout","dagre",i)};"undefined"!=typeof cytoscape&&n(cytoscape),e.exports=n},function(t,a){t.exports=e}])},e.exports=i(a(470))},function(e,t,a){e.exports={graphlib:a(113),layout:a(526),debug:a(592),util:{time:a(102).time,notime:a(102).notime},version:a(593)}},function(e,t,a){var i=a(472);e.exports={Graph:i.Graph,json:a(516),alg:a(517),version:i.version}},function(e,t,a){e.exports={Graph:a(214),version:a(515)}},function(e,t,a){var i=a(288);e.exports=function(e){return i(e,4)}},function(e,t){e.exports=function(e){return function(t,a,i){for(var n=-1,s=Object(t),r=i(t),o=r.length;o--;){var l=r[e?o:++n];if(!1===a(s[l],l,s))break}return t}}},function(e,t,a){var i=a(147);e.exports=function(e,t){return function(a,n){if(null==a)return a;if(!i(a))return e(a,n);for(var s=a.length,r=t?s:-1,o=Object(a);(t?r--:++r<s)&&!1!==n(o[r],r,o););return a}}},function(e,t,a){e.exports=a(20)(2991)},function(e,t,a){var i=a(180);e.exports=function(e,t){var a=[];return i(e,(function(e,i,n){t(e,i,n)&&a.push(e)})),a}},function(e,t,a){var i=a(479),n=a(480),s=a(298);e.exports=function(e){var t=n(e);return 1==t.length&&t[0][2]?s(t[0][0],t[0][1]):function(a){return a===e||i(a,e,t)}}},function(e,t,a){var i=a(295),n=a(296);e.exports=function(e,t,a,s){var r=a.length,o=r,l=!s;if(null==e)return!o;for(e=Object(e);r--;){var c=a[r];if(l&&c[2]?c[1]!==e[c[0]]:!(c[0]in e))return!1}for(;++r<o;){var d=(c=a[r])[0],u=e[d],p=c[1];if(l&&c[2]){if(void 0===u&&!(d in e))return!1}else{var m=new i;if(s)var b=s(u,p,d,e,t,m);if(!(void 0===b?n(p,u,3,s,m):b))return!1}}return!0}},function(e,t,a){var i=a(297),n=a(159);e.exports=function(e){for(var t=n(e),a=t.length;a--;){var s=t[a],r=e[s];t[a]=[s,r,i(r)]}return t}},function(e,t,a){var i=a(296),n=a(482),s=a(299),r=a(302),o=a(297),l=a(298),c=a(181);e.exports=function(e,t){return r(e)&&o(t)?l(c(e),t):function(a){var r=n(a,e);return void 0===r&&r===t?s(a,e):i(t,r,3)}}},function(e,t,a){e.exports=a(20)(944)},function(e,t){e.exports=function(e,t){return null!=e&&t in Object(e)}},function(e,t,a){e.exports=a(20)(1254)},function(e,t,a){var i=a(303),n=a(486),s=a(302),r=a(181);e.exports=function(e){return s(e)?i(r(e)):n(e)}},function(e,t,a){var i=a(219);e.exports=function(e){return function(t){return i(t,e)}}},function(e,t){var a=Object.prototype.hasOwnProperty;e.exports=function(e,t){return null!=e&&a.call(e,t)}},function(e,t,a){var i=a(305),n=a(306),s=a(218),r=a(114),o=a(147),l=a(220),c=a(489),d=a(221),u=Object.prototype.hasOwnProperty;e.exports=function(e){if(null==e)return!0;if(o(e)&&(r(e)||"string"==typeof e||"function"==typeof e.splice||l(e)||d(e)||s(e)))return!e.length;var t=n(e);if("[object Map]"==t||"[object Set]"==t)return!e.size;if(c(e))return!i(e).length;for(var a in e)if(u.call(e,a))return!1;return!0}},function(e,t,a){e.exports=a(20)(898)},function(e,t){e.exports=function(e,t,a,i){var n=-1,s=null==e?0:e.length;for(i&&s&&(a=e[++n]);++n<s;)a=t(a,e[n],n,e);return a}},function(e,t){e.exports=function(e,t,a,i,n){return n(e,(function(e,n,s){a=i?(i=!1,e):t(a,e,n,s)})),a}},function(e,t,a){var i=a(305),n=a(306),s=a(147),r=a(493),o=a(494);e.exports=function(e){if(null==e)return 0;if(s(e))return r(e)?o(e):e.length;var t=n(e);return"[object Map]"==t||"[object Set]"==t?e.size:i(e).length}},function(e,t,a){e.exports=a(20)(928)},function(e,t,a){var i=a(495),n=a(496),s=a(497);e.exports=function(e){return n(e)?s(e):i(e)}},function(e,t,a){var i=a(303)("length");e.exports=i},function(e,t){var a=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");e.exports=function(e){return a.test(e)}},function(e,t){var a="[\\ud800-\\udfff]",i="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",n="\\ud83c[\\udffb-\\udfff]",s="[^\\ud800-\\udfff]",r="(?:\\ud83c[\\udde6-\\uddff]){2}",o="[\\ud800-\\udbff][\\udc00-\\udfff]",l="(?:"+i+"|"+n+")"+"?",c="[\\ufe0e\\ufe0f]?",d=c+l+("(?:\\u200d(?:"+[s,r,o].join("|")+")"+c+l+")*"),u="(?:"+[s+i+"?",i,r,o,a].join("|")+")",p=RegExp(n+"(?="+n+")|"+u+d,"g");e.exports=function(e){for(var t=p.lastIndex=0;p.test(e);)++t;return t}},function(e,t,a){var i=a(292),n=a(499),s=a(215),r=a(123),o=a(500),l=a(114),c=a(220),d=a(222),u=a(160),p=a(221);e.exports=function(e,t,a){var m=l(e),b=m||c(e)||p(e);if(t=r(t,4),null==a){var h=e&&e.constructor;a=b?m?new h:[]:u(e)&&d(h)?n(o(e)):{}}return(b?i:s)(e,(function(e,i,n){return t(a,e,i,n)})),a}},function(e,t,a){e.exports=a(20)(3004)},function(e,t,a){e.exports=a(20)(902)},function(e,t,a){var i=a(311),n=a(224),s=a(502),r=a(314),o=n((function(e){return s(i(e,1,r,!0))}));e.exports=o},function(e,t,a){var i=a(503),n=a(504),s=a(508),r=a(509),o=a(510),l=a(313);e.exports=function(e,t,a){var c=-1,d=n,u=e.length,p=!0,m=[],b=m;if(a)p=!1,d=s;else if(u>=200){var h=t?null:o(e);if(h)return l(h);p=!1,d=r,b=new i}else b=t?[]:m;e:for(;++c<u;){var f=e[c],g=t?t(f):f;if(f=a||0!==f?f:0,p&&g==g){for(var j=b.length;j--;)if(b[j]===g)continue e;t&&b.push(g),m.push(f)}else d(b,g,a)||(b!==m&&b.push(g),m.push(f))}return m}},function(e,t,a){e.exports=a(20)(3027)},function(e,t,a){var i=a(505);e.exports=function(e,t){return!!(null==e?0:e.length)&&i(e,t,0)>-1}},function(e,t,a){var i=a(312),n=a(506),s=a(507);e.exports=function(e,t,a){return t==t?s(e,t,a):i(e,n,a)}},function(e,t){e.exports=function(e){return e!=e}},function(e,t){e.exports=function(e,t,a){for(var i=a-1,n=e.length;++i<n;)if(e[i]===t)return i;return-1}},function(e,t){e.exports=function(e,t,a){for(var i=-1,n=null==e?0:e.length;++i<n;)if(a(t,e[i]))return!0;return!1}},function(e,t,a){e.exports=a(20)(3031)},function(e,t,a){var i=a(511),n=a(512),s=a(313),r=i&&1/s(new i([,-0]))[1]==1/0?function(e){return new i(e)}:n;e.exports=r},function(e,t,a){e.exports=a(20)(2995)},function(e,t){e.exports=function(){}},function(e,t,a){e.exports=a(20)(205)},function(e,t,a){var i=a(223);e.exports=function(e,t){return i(t,(function(t){return e[t]}))}},function(e,t){e.exports="2.1.8"},function(e,t,a){var i=a(110),n=a(214);function s(e){return i.map(e.nodes(),(function(t){var a=e.node(t),n=e.parent(t),s={v:t};return i.isUndefined(a)||(s.value=a),i.isUndefined(n)||(s.parent=n),s}))}function r(e){return i.map(e.edges(),(function(t){var a=e.edge(t),n={v:t.v,w:t.w};return i.isUndefined(t.name)||(n.name=t.name),i.isUndefined(a)||(n.value=a),n}))}e.exports={write:function(e){var t={options:{directed:e.isDirected(),multigraph:e.isMultigraph(),compound:e.isCompound()},nodes:s(e),edges:r(e)};i.isUndefined(e.graph())||(t.value=i.clone(e.graph()));return t},read:function(e){var t=new n(e.options).setGraph(e.value);return i.each(e.nodes,(function(e){t.setNode(e.v,e.value),e.parent&&t.setParent(e.v,e.parent)})),i.each(e.edges,(function(e){t.setEdge({v:e.v,w:e.w,name:e.name},e.value)})),t}}},function(e,t,a){e.exports={components:a(518),dijkstra:a(316),dijkstraAll:a(519),findCycles:a(520),floydWarshall:a(521),isAcyclic:a(522),postorder:a(523),preorder:a(524),prim:a(525),tarjan:a(318),topsort:a(319)}},function(e,t,a){var i=a(110);e.exports=function(e){var t,a={},n=[];function s(n){i.has(a,n)||(a[n]=!0,t.push(n),i.each(e.successors(n),s),i.each(e.predecessors(n),s))}return i.each(e.nodes(),(function(e){t=[],s(e),t.length&&n.push(t)})),n}},function(e,t,a){var i=a(316),n=a(110);e.exports=function(e,t,a){return n.transform(e.nodes(),(function(n,s){n[s]=i(e,s,t,a)}),{})}},function(e,t,a){var i=a(110),n=a(318);e.exports=function(e){return i.filter(n(e),(function(t){return t.length>1||1===t.length&&e.hasEdge(t[0],t[0])}))}},function(e,t,a){var i=a(110);e.exports=function(e,t,a){return function(e,t,a){var i={},n=e.nodes();return n.forEach((function(e){i[e]={},i[e][e]={distance:0},n.forEach((function(t){e!==t&&(i[e][t]={distance:Number.POSITIVE_INFINITY})})),a(e).forEach((function(a){var n=a.v===e?a.w:a.v,s=t(a);i[e][n]={distance:s,predecessor:e}}))})),n.forEach((function(e){var t=i[e];n.forEach((function(a){var s=i[a];n.forEach((function(a){var i=s[e],n=t[a],r=s[a],o=i.distance+n.distance;o<r.distance&&(r.distance=o,r.predecessor=n.predecessor)}))}))})),i}(e,t||n,a||function(t){return e.outEdges(t)})};var n=i.constant(1)},function(e,t,a){var i=a(319);e.exports=function(e){try{i(e)}catch(e){if(e instanceof i.CycleException)return!1;throw e}return!0}},function(e,t,a){var i=a(320);e.exports=function(e,t){return i(e,t,"post")}},function(e,t,a){var i=a(320);e.exports=function(e,t){return i(e,t,"pre")}},function(e,t,a){var i=a(110),n=a(214),s=a(317);e.exports=function(e,t){var a,r=new n,o={},l=new s;function c(e){var i=e.v===a?e.w:e.v,n=l.priority(i);if(void 0!==n){var s=t(e);s<n&&(o[i]=a,l.decrease(i,s))}}if(0===e.nodeCount())return r;i.each(e.nodes(),(function(e){l.add(e,Number.POSITIVE_INFINITY),r.setNode(e)})),l.decrease(e.nodes()[0],0);var d=!1;for(;l.size()>0;){if(a=l.removeMin(),i.has(o,a))r.setEdge(a,o[a]);else{if(d)throw new Error("Input graph is not connected: "+e);d=!0}e.nodeEdges(a).forEach(c)}return r}},function(e,t,a){"use strict";var i=a(80),n=a(571),s=a(574),r=a(575),o=a(102).normalizeRanks,l=a(577),c=a(102).removeEmptyRanks,d=a(578),u=a(579),p=a(580),m=a(581),b=a(590),h=a(102),f=a(113).Graph;e.exports=function(e,t){var a=t&&t.debugTiming?h.time:h.notime;a("layout",(function(){var t=a("  buildLayoutGraph",(function(){return function(e){var t=new f({multigraph:!0,compound:!0}),a=S(e.graph());return t.setGraph(i.merge({},j,_(a,g),i.pick(a,x))),i.forEach(e.nodes(),(function(a){var n=S(e.node(a));t.setNode(a,i.defaults(_(n,v),y)),t.setParent(a,e.parent(a))})),i.forEach(e.edges(),(function(a){var n=S(e.edge(a));t.setEdge(a,i.merge({},E,_(n,O),i.pick(n,w)))})),t}(e)}));a("  runLayout",(function(){!function(e,t){t("    makeSpaceForEdgeLabels",(function(){!function(e){var t=e.graph();t.ranksep/=2,i.forEach(e.edges(),(function(a){var i=e.edge(a);i.minlen*=2,"c"!==i.labelpos.toLowerCase()&&("TB"===t.rankdir||"BT"===t.rankdir?i.width+=i.labeloffset:i.height+=i.labeloffset)}))}(e)})),t("    removeSelfEdges",(function(){!function(e){i.forEach(e.edges(),(function(t){if(t.v===t.w){var a=e.node(t.v);a.selfEdges||(a.selfEdges=[]),a.selfEdges.push({e:t,label:e.edge(t)}),e.removeEdge(t)}}))}(e)})),t("    acyclic",(function(){n.run(e)})),t("    nestingGraph.run",(function(){d.run(e)})),t("    rank",(function(){r(h.asNonCompoundGraph(e))})),t("    injectEdgeLabelProxies",(function(){!function(e){i.forEach(e.edges(),(function(t){var a=e.edge(t);if(a.width&&a.height){var i=e.node(t.v),n={rank:(e.node(t.w).rank-i.rank)/2+i.rank,e:t};h.addDummyNode(e,"edge-proxy",n,"_ep")}}))}(e)})),t("    removeEmptyRanks",(function(){c(e)})),t("    nestingGraph.cleanup",(function(){d.cleanup(e)})),t("    normalizeRanks",(function(){o(e)})),t("    assignRankMinMax",(function(){!function(e){var t=0;i.forEach(e.nodes(),(function(a){var n=e.node(a);n.borderTop&&(n.minRank=e.node(n.borderTop).rank,n.maxRank=e.node(n.borderBottom).rank,t=i.max(t,n.maxRank))})),e.graph().maxRank=t}(e)})),t("    removeEdgeLabelProxies",(function(){!function(e){i.forEach(e.nodes(),(function(t){var a=e.node(t);"edge-proxy"===a.dummy&&(e.edge(a.e).labelRank=a.rank,e.removeNode(t))}))}(e)})),t("    normalize.run",(function(){s.run(e)})),t("    parentDummyChains",(function(){l(e)})),t("    addBorderSegments",(function(){u(e)})),t("    order",(function(){m(e)})),t("    insertSelfEdges",(function(){!function(e){var t=h.buildLayerMatrix(e);i.forEach(t,(function(t){var a=0;i.forEach(t,(function(t,n){var s=e.node(t);s.order=n+a,i.forEach(s.selfEdges,(function(t){h.addDummyNode(e,"selfedge",{width:t.label.width,height:t.label.height,rank:s.rank,order:n+ ++a,e:t.e,label:t.label},"_se")})),delete s.selfEdges}))}))}(e)})),t("    adjustCoordinateSystem",(function(){p.adjust(e)})),t("    position",(function(){b(e)})),t("    positionSelfEdges",(function(){!function(e){i.forEach(e.nodes(),(function(t){var a=e.node(t);if("selfedge"===a.dummy){var i=e.node(a.e.v),n=i.x+i.width/2,s=i.y,r=a.x-n,o=i.height/2;e.setEdge(a.e,a.label),e.removeNode(t),a.label.points=[{x:n+2*r/3,y:s-o},{x:n+5*r/6,y:s-o},{x:n+r,y:s},{x:n+5*r/6,y:s+o},{x:n+2*r/3,y:s+o}],a.label.x=a.x,a.label.y=a.y}}))}(e)})),t("    removeBorderNodes",(function(){!function(e){i.forEach(e.nodes(),(function(t){if(e.children(t).length){var a=e.node(t),n=e.node(a.borderTop),s=e.node(a.borderBottom),r=e.node(i.last(a.borderLeft)),o=e.node(i.last(a.borderRight));a.width=Math.abs(o.x-r.x),a.height=Math.abs(s.y-n.y),a.x=r.x+a.width/2,a.y=n.y+a.height/2}})),i.forEach(e.nodes(),(function(t){"border"===e.node(t).dummy&&e.removeNode(t)}))}(e)})),t("    normalize.undo",(function(){s.undo(e)})),t("    fixupEdgeLabelCoords",(function(){!function(e){i.forEach(e.edges(),(function(t){var a=e.edge(t);if(i.has(a,"x"))switch("l"!==a.labelpos&&"r"!==a.labelpos||(a.width-=a.labeloffset),a.labelpos){case"l":a.x-=a.width/2+a.labeloffset;break;case"r":a.x+=a.width/2+a.labeloffset}}))}(e)})),t("    undoCoordinateSystem",(function(){p.undo(e)})),t("    translateGraph",(function(){!function(e){var t=Number.POSITIVE_INFINITY,a=0,n=Number.POSITIVE_INFINITY,s=0,r=e.graph(),o=r.marginx||0,l=r.marginy||0;function c(e){var i=e.x,r=e.y,o=e.width,l=e.height;t=Math.min(t,i-o/2),a=Math.max(a,i+o/2),n=Math.min(n,r-l/2),s=Math.max(s,r+l/2)}i.forEach(e.nodes(),(function(t){c(e.node(t))})),i.forEach(e.edges(),(function(t){var a=e.edge(t);i.has(a,"x")&&c(a)})),t-=o,n-=l,i.forEach(e.nodes(),(function(a){var i=e.node(a);i.x-=t,i.y-=n})),i.forEach(e.edges(),(function(a){var s=e.edge(a);i.forEach(s.points,(function(e){e.x-=t,e.y-=n})),i.has(s,"x")&&(s.x-=t),i.has(s,"y")&&(s.y-=n)})),r.width=a-t+o,r.height=s-n+l}(e)})),t("    assignNodeIntersects",(function(){!function(e){i.forEach(e.edges(),(function(t){var a,i,n=e.edge(t),s=e.node(t.v),r=e.node(t.w);n.points?(a=n.points[0],i=n.points[n.points.length-1]):(n.points=[],a=r,i=s),n.points.unshift(h.intersectRect(s,a)),n.points.push(h.intersectRect(r,i))}))}(e)})),t("    reversePoints",(function(){!function(e){i.forEach(e.edges(),(function(t){var a=e.edge(t);a.reversed&&a.points.reverse()}))}(e)})),t("    acyclic.undo",(function(){n.undo(e)}))}(t,a)})),a("  updateInputGraph",(function(){!function(e,t){i.forEach(e.nodes(),(function(a){var i=e.node(a),n=t.node(a);i&&(i.x=n.x,i.y=n.y,t.children(a).length&&(i.width=n.width,i.height=n.height))})),i.forEach(e.edges(),(function(a){var n=e.edge(a),s=t.edge(a);n.points=s.points,i.has(s,"x")&&(n.x=s.x,n.y=s.y)})),e.graph().width=t.graph().width,e.graph().height=t.graph().height}(e,t)}))}))};var g=["nodesep","edgesep","ranksep","marginx","marginy"],j={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},x=["acyclicer","ranker","rankdir","align"],v=["width","height"],y={width:0,height:0},O=["minlen","weight","width","height","labeloffset"],E={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},w=["labelpos"];function _(e,t){return i.mapValues(i.pick(e,t),Number)}function S(e){var t={};return i.forEach(e,(function(e,a){t[a.toLowerCase()]=e})),t}},function(e,t,a){var i=a(288);e.exports=function(e){return i(e,5)}},function(e,t,a){e.exports=a(20)(1598)},function(e,t,a){var i=a(530)(a(531));e.exports=i},function(e,t,a){var i=a(123),n=a(147),s=a(159);e.exports=function(e){return function(t,a,r){var o=Object(t);if(!n(t)){var l=i(a,3);t=s(t),a=function(e){return l(o[e],e,o)}}var c=e(t,a,r);return c>-1?o[l?t[c]:c]:void 0}}},function(e,t,a){var i=a(312),n=a(123),s=a(532),r=Math.max;e.exports=function(e,t,a){var o=null==e?0:e.length;if(!o)return-1;var l=null==a?0:s(a);return l<0&&(l=r(o+l,0)),i(e,n(t,3),l)}},function(e,t,a){e.exports=a(20)(2939)},function(e,t,a){e.exports=a(20)(3016)},function(e,t,a){var i=a(216),n=a(293),s=a(225);e.exports=function(e,t){return null==e?e:i(e,n(t),s)}},function(e,t,a){e.exports=a(20)(3010)},function(e,t,a){var i=a(321),n=a(215),s=a(123);e.exports=function(e,t){var a={};return t=s(t,3),n(e,(function(e,n,s){i(a,n,t(e,n,s))})),a}},function(e,t,a){var i=a(226),n=a(538),s=a(182);e.exports=function(e){return e&&e.length?i(e,s,n):void 0}},function(e,t){e.exports=function(e,t){return e>t}},function(e,t,a){var i=a(540),n=a(550)((function(e,t,a){i(e,t,a)}));e.exports=n},function(e,t,a){var i=a(295),n=a(323),s=a(216),r=a(542),o=a(160),l=a(225),c=a(324);e.exports=function e(t,a,d,u,p){t!==a&&s(a,(function(s,l){if(p||(p=new i),o(s))r(t,a,l,d,e,u,p);else{var m=u?u(c(t,l),s,l+"",t,a,p):void 0;void 0===m&&(m=s),n(t,l,m)}}),l)}},function(e,t,a){e.exports=a(20)(516)},function(e,t,a){var i=a(323),n=a(543),s=a(544),r=a(545),o=a(546),l=a(218),c=a(114),d=a(314),u=a(220),p=a(222),m=a(160),b=a(547),h=a(221),f=a(324),g=a(548);e.exports=function(e,t,a,j,x,v,y){var O=f(e,a),E=f(t,a),w=y.get(E);if(w)i(e,a,w);else{var _=v?v(O,E,a+"",e,t,y):void 0,S=void 0===_;if(S){var M=c(E),k=!M&&u(E),C=!M&&!k&&h(E);_=E,M||k||C?c(O)?_=O:d(O)?_=r(O):k?(S=!1,_=n(E,!0)):C?(S=!1,_=s(E,!0)):_=[]:b(E)||l(E)?(_=O,l(O)?_=g(O):m(O)&&!p(O)||(_=o(E))):S=!1}S&&(y.set(E,_),x(_,E,j,v,y),y.delete(E)),i(e,a,_)}}},function(e,t,a){e.exports=a(20)(2988)},function(e,t,a){e.exports=a(20)(3002)},function(e,t,a){e.exports=a(20)(2989)},function(e,t,a){e.exports=a(20)(3003)},function(e,t,a){e.exports=a(20)(3014)},function(e,t,a){var i=a(549),n=a(225);e.exports=function(e){return i(e,n(e))}},function(e,t,a){e.exports=a(20)(517)},function(e,t,a){var i=a(224),n=a(325);e.exports=function(e){return i((function(t,a){var i=-1,s=a.length,r=s>1?a[s-1]:void 0,o=s>2?a[2]:void 0;for(r=e.length>3&&"function"==typeof r?(s--,r):void 0,o&&n(a[0],a[1],o)&&(r=s<3?void 0:r,s=1),t=Object(t);++i<s;){var l=a[i];l&&e(t,l,i,r)}return t}))}},function(e,t,a){var i=a(226),n=a(326),s=a(182);e.exports=function(e){return e&&e.length?i(e,s,n):void 0}},function(e,t,a){var i=a(226),n=a(123),s=a(326);e.exports=function(e,t){return e&&e.length?i(e,n(t,2),s):void 0}},function(e,t,a){var i=a(554);e.exports=function(){return i.Date.now()}},function(e,t,a){e.exports=a(20)(227)},function(e,t,a){var i=a(556),n=a(559)((function(e,t){return null==e?{}:i(e,t)}));e.exports=n},function(e,t,a){var i=a(557),n=a(299);e.exports=function(e,t){return i(e,t,(function(t,a){return n(e,a)}))}},function(e,t,a){var i=a(219),n=a(558),s=a(217);e.exports=function(e,t,a){for(var r=-1,o=t.length,l={};++r<o;){var c=t[r],d=i(e,c);a(d,c)&&n(l,s(c,e),d)}return l}},function(e,t,a){var i=a(327),n=a(217),s=a(301),r=a(160),o=a(181);e.exports=function(e,t,a,l){if(!r(e))return e;for(var c=-1,d=(t=n(t,e)).length,u=d-1,p=e;null!=p&&++c<d;){var m=o(t[c]),b=a;if("__proto__"===m||"constructor"===m||"prototype"===m)return e;if(c!=u){var h=p[m];void 0===(b=l?l(h,m,p):void 0)&&(b=r(h)?h:s(t[c+1])?[]:{})}i(p,m,b),p=p[m]}return e}},function(e,t,a){e.exports=a(20)(3015)},function(e,t,a){e.exports=a(20)(1587)},function(e,t,a){var i=a(311),n=a(562),s=a(224),r=a(325),o=s((function(e,t){if(null==e)return[];var a=t.length;return a>1&&r(e,t[0],t[1])?t=[]:a>2&&r(t[0],t[1],t[2])&&(t=[t[0]]),n(e,i(t,1),[])}));e.exports=o},function(e,t,a){var i=a(223),n=a(219),s=a(123),r=a(309),o=a(563),l=a(564),c=a(565),d=a(182),u=a(114);e.exports=function(e,t,a){t=t.length?i(t,(function(e){return u(e)?function(t){return n(t,1===e.length?e[0]:e)}:e})):[d];var p=-1;t=i(t,l(s));var m=r(e,(function(e,a,n){return{criteria:i(t,(function(t){return t(e)})),index:++p,value:e}}));return o(m,(function(e,t){return c(e,t,a)}))}},function(e,t){e.exports=function(e,t){var a=e.length;for(e.sort(t);a--;)e[a]=e[a].value;return e}},function(e,t,a){e.exports=a(20)(896)},function(e,t,a){var i=a(566);e.exports=function(e,t,a){for(var n=-1,s=e.criteria,r=t.criteria,o=s.length,l=a.length;++n<o;){var c=i(s[n],r[n]);if(c)return n>=l?c:c*("desc"==a[n]?-1:1)}return e.index-t.index}},function(e,t,a){var i=a(322);e.exports=function(e,t){if(e!==t){var a=void 0!==e,n=null===e,s=e==e,r=i(e),o=void 0!==t,l=null===t,c=t==t,d=i(t);if(!l&&!d&&!r&&e>t||r&&o&&c&&!l&&!d||n&&o&&c||!a&&c||!s)return 1;if(!n&&!r&&!d&&e<t||d&&a&&s&&!n&&!r||l&&a&&s||!o&&s||!c)return-1}return 0}},function(e,t,a){var i=a(568),n=0;e.exports=function(e){var t=++n;return i(e)+t}},function(e,t,a){e.exports=a(20)(2970)},function(e,t,a){var i=a(327),n=a(570);e.exports=function(e,t){return n(e||[],t||[],i)}},function(e,t){e.exports=function(e,t,a){for(var i=-1,n=e.length,s=t.length,r={};++i<n;){var o=i<s?t[i]:void 0;a(r,e[i],o)}return r}},function(e,t,a){"use strict";var i=a(80),n=a(572);e.exports={run:function(e){var t="greedy"===e.graph().acyclicer?n(e,function(e){return function(t){return e.edge(t).weight}}(e)):function(e){var t=[],a={},n={};function s(r){i.has(n,r)||(n[r]=!0,a[r]=!0,i.forEach(e.outEdges(r),(function(e){i.has(a,e.w)?t.push(e):s(e.w)})),delete a[r])}return i.forEach(e.nodes(),s),t}(e);i.forEach(t,(function(t){var a=e.edge(t);e.removeEdge(t),a.forwardName=t.name,a.reversed=!0,e.setEdge(t.w,t.v,a,i.uniqueId("rev"))}))},undo:function(e){i.forEach(e.edges(),(function(t){var a=e.edge(t);if(a.reversed){e.removeEdge(t);var i=a.forwardName;delete a.reversed,delete a.forwardName,e.setEdge(t.w,t.v,a,i)}}))}}},function(e,t,a){var i=a(80),n=a(113).Graph,s=a(573);e.exports=function(e,t){if(e.nodeCount()<=1)return[];var a=function(e,t){var a=new n,r=0,o=0;i.forEach(e.nodes(),(function(e){a.setNode(e,{v:e,in:0,out:0})})),i.forEach(e.edges(),(function(e){var i=a.edge(e.v,e.w)||0,n=t(e),s=i+n;a.setEdge(e.v,e.w,s),o=Math.max(o,a.node(e.v).out+=n),r=Math.max(r,a.node(e.w).in+=n)}));var c=i.range(o+r+3).map((function(){return new s})),d=r+1;return i.forEach(a.nodes(),(function(e){l(c,d,a.node(e))})),{graph:a,buckets:c,zeroIdx:d}}(e,t||r),c=function(e,t,a){var i,n=[],s=t[t.length-1],r=t[0];for(;e.nodeCount();){for(;i=r.dequeue();)o(e,t,a,i);for(;i=s.dequeue();)o(e,t,a,i);if(e.nodeCount())for(var l=t.length-2;l>0;--l)if(i=t[l].dequeue()){n=n.concat(o(e,t,a,i,!0));break}}return n}(a.graph,a.buckets,a.zeroIdx);return i.flatten(i.map(c,(function(t){return e.outEdges(t.v,t.w)})),!0)};var r=i.constant(1);function o(e,t,a,n,s){var r=s?[]:void 0;return i.forEach(e.inEdges(n.v),(function(i){var n=e.edge(i),o=e.node(i.v);s&&r.push({v:i.v,w:i.w}),o.out-=n,l(t,a,o)})),i.forEach(e.outEdges(n.v),(function(i){var n=e.edge(i),s=i.w,r=e.node(s);r.in-=n,l(t,a,r)})),e.removeNode(n.v),r}function l(e,t,a){a.out?a.in?e[a.out-a.in+t].enqueue(a):e[e.length-1].enqueue(a):e[0].enqueue(a)}},function(e,t){function a(){var e={};e._next=e._prev=e,this._sentinel=e}function i(e){e._prev._next=e._next,e._next._prev=e._prev,delete e._next,delete e._prev}function n(e,t){if("_next"!==e&&"_prev"!==e)return t}e.exports=a,a.prototype.dequeue=function(){var e=this._sentinel,t=e._prev;if(t!==e)return i(t),t},a.prototype.enqueue=function(e){var t=this._sentinel;e._prev&&e._next&&i(e),e._next=t._next,t._next._prev=e,t._next=e,e._prev=t},a.prototype.toString=function(){for(var e=[],t=this._sentinel,a=t._prev;a!==t;)e.push(JSON.stringify(a,n)),a=a._prev;return"["+e.join(", ")+"]"}},function(e,t,a){"use strict";var i=a(80),n=a(102);e.exports={run:function(e){e.graph().dummyChains=[],i.forEach(e.edges(),(function(t){!function(e,t){var a,i,s,r=t.v,o=e.node(r).rank,l=t.w,c=e.node(l).rank,d=t.name,u=e.edge(t),p=u.labelRank;if(c===o+1)return;for(e.removeEdge(t),s=0,++o;o<c;++s,++o)u.points=[],i={width:0,height:0,edgeLabel:u,edgeObj:t,rank:o},a=n.addDummyNode(e,"edge",i,"_d"),o===p&&(i.width=u.width,i.height=u.height,i.dummy="edge-label",i.labelpos=u.labelpos),e.setEdge(r,a,{weight:u.weight},d),0===s&&e.graph().dummyChains.push(a),r=a;e.setEdge(r,l,{weight:u.weight},d)}(e,t)}))},undo:function(e){i.forEach(e.graph().dummyChains,(function(t){var a,i=e.node(t),n=i.edgeLabel;for(e.setEdge(i.edgeObj,n);i.dummy;)a=e.successors(t)[0],e.removeNode(t),n.points.push({x:i.x,y:i.y}),"edge-label"===i.dummy&&(n.x=i.x,n.y=i.y,n.width=i.width,n.height=i.height),t=a,i=e.node(t)}))}}},function(e,t,a){"use strict";var i=a(183).longestPath,n=a(328),s=a(576);e.exports=function(e){switch(e.graph().ranker){case"network-simplex":default:o(e);break;case"tight-tree":!function(e){i(e),n(e)}(e);break;case"longest-path":r(e)}};var r=i;function o(e){s(e)}},function(e,t,a){"use strict";var i=a(80),n=a(328),s=a(183).slack,r=a(183).longestPath,o=a(113).alg.preorder,l=a(113).alg.postorder,c=a(102).simplify;function d(e){e=c(e),r(e);var t,a=n(e);for(m(a),u(a,e);t=h(a);)g(a,e,t,f(a,e,t))}function u(e,t){var a=l(e,e.nodes());a=a.slice(0,a.length-1),i.forEach(a,(function(a){!function(e,t,a){var i=e.node(a).parent;e.edge(a,i).cutvalue=p(e,t,a)}(e,t,a)}))}function p(e,t,a){var n=e.node(a).parent,s=!0,r=t.edge(a,n),o=0;return r||(s=!1,r=t.edge(n,a)),o=r.weight,i.forEach(t.nodeEdges(a),(function(i){var r,l,c=i.v===a,d=c?i.w:i.v;if(d!==n){var u=c===s,p=t.edge(i).weight;if(o+=u?p:-p,r=a,l=d,e.hasEdge(r,l)){var m=e.edge(a,d).cutvalue;o+=u?-m:m}}})),o}function m(e,t){arguments.length<2&&(t=e.nodes()[0]),b(e,{},1,t)}function b(e,t,a,n,s){var r=a,o=e.node(n);return t[n]=!0,i.forEach(e.neighbors(n),(function(s){i.has(t,s)||(a=b(e,t,a,s,n))})),o.low=r,o.lim=a++,s?o.parent=s:delete o.parent,a}function h(e){return i.find(e.edges(),(function(t){return e.edge(t).cutvalue<0}))}function f(e,t,a){var n=a.v,r=a.w;t.hasEdge(n,r)||(n=a.w,r=a.v);var o=e.node(n),l=e.node(r),c=o,d=!1;o.lim>l.lim&&(c=l,d=!0);var u=i.filter(t.edges(),(function(t){return d===j(e,e.node(t.v),c)&&d!==j(e,e.node(t.w),c)}));return i.minBy(u,(function(e){return s(t,e)}))}function g(e,t,a,n){var s=a.v,r=a.w;e.removeEdge(s,r),e.setEdge(n.v,n.w,{}),m(e),u(e,t),function(e,t){var a=i.find(e.nodes(),(function(e){return!t.node(e).parent})),n=o(e,a);n=n.slice(1),i.forEach(n,(function(a){var i=e.node(a).parent,n=t.edge(a,i),s=!1;n||(n=t.edge(i,a),s=!0),t.node(a).rank=t.node(i).rank+(s?n.minlen:-n.minlen)}))}(e,t)}function j(e,t,a){return a.low<=t.lim&&t.lim<=a.lim}e.exports=d,d.initLowLimValues=m,d.initCutValues=u,d.calcCutValue=p,d.leaveEdge=h,d.enterEdge=f,d.exchangeEdges=g},function(e,t,a){var i=a(80);e.exports=function(e){var t=function(e){var t={},a=0;function n(s){var r=a;i.forEach(e.children(s),n),t[s]={low:r,lim:a++}}return i.forEach(e.children(),n),t}(e);i.forEach(e.graph().dummyChains,(function(a){for(var i=e.node(a),n=i.edgeObj,s=function(e,t,a,i){var n,s,r=[],o=[],l=Math.min(t[a].low,t[i].low),c=Math.max(t[a].lim,t[i].lim);n=a;do{n=e.parent(n),r.push(n)}while(n&&(t[n].low>l||c>t[n].lim));s=n,n=i;for(;(n=e.parent(n))!==s;)o.push(n);return{path:r.concat(o.reverse()),lca:s}}(e,t,n.v,n.w),r=s.path,o=s.lca,l=0,c=r[l],d=!0;a!==n.w;){if(i=e.node(a),d){for(;(c=r[l])!==o&&e.node(c).maxRank<i.rank;)l++;c===o&&(d=!1)}if(!d){for(;l<r.length-1&&e.node(c=r[l+1]).minRank<=i.rank;)l++;c=r[l]}e.setParent(a,c),a=e.successors(a)[0]}}))}},function(e,t,a){var i=a(80),n=a(102);function s(e,t,a,r,o,l,c){var d=e.children(c);if(d.length){var u=n.addBorderNode(e,"_bt"),p=n.addBorderNode(e,"_bb"),m=e.node(c);e.setParent(u,c),m.borderTop=u,e.setParent(p,c),m.borderBottom=p,i.forEach(d,(function(i){s(e,t,a,r,o,l,i);var n=e.node(i),d=n.borderTop?n.borderTop:i,m=n.borderBottom?n.borderBottom:i,b=n.borderTop?r:2*r,h=d!==m?1:o-l[c]+1;e.setEdge(u,d,{weight:b,minlen:h,nestingEdge:!0}),e.setEdge(m,p,{weight:b,minlen:h,nestingEdge:!0})})),e.parent(c)||e.setEdge(t,u,{weight:0,minlen:o+l[c]})}else c!==t&&e.setEdge(t,c,{weight:0,minlen:a})}e.exports={run:function(e){var t=n.addDummyNode(e,"root",{},"_root"),a=function(e){var t={};function a(n,s){var r=e.children(n);r&&r.length&&i.forEach(r,(function(e){a(e,s+1)})),t[n]=s}return i.forEach(e.children(),(function(e){a(e,1)})),t}(e),r=i.max(i.values(a))-1,o=2*r+1;e.graph().nestingRoot=t,i.forEach(e.edges(),(function(t){e.edge(t).minlen*=o}));var l=function(e){return i.reduce(e.edges(),(function(t,a){return t+e.edge(a).weight}),0)}(e)+1;i.forEach(e.children(),(function(i){s(e,t,o,l,r,a,i)})),e.graph().nodeRankFactor=o},cleanup:function(e){var t=e.graph();e.removeNode(t.nestingRoot),delete t.nestingRoot,i.forEach(e.edges(),(function(t){e.edge(t).nestingEdge&&e.removeEdge(t)}))}}},function(e,t,a){var i=a(80),n=a(102);function s(e,t,a,i,s,r){var o={width:0,height:0,rank:r,borderType:t},l=s[t][r-1],c=n.addDummyNode(e,"border",o,a);s[t][r]=c,e.setParent(c,i),l&&e.setEdge(l,c,{weight:1})}e.exports=function(e){i.forEach(e.children(),(function t(a){var n=e.children(a),r=e.node(a);if(n.length&&i.forEach(n,t),i.has(r,"minRank")){r.borderLeft=[],r.borderRight=[];for(var o=r.minRank,l=r.maxRank+1;o<l;++o)s(e,"borderLeft","_bl",a,r,o),s(e,"borderRight","_br",a,r,o)}}))}},function(e,t,a){"use strict";var i=a(80);function n(e){i.forEach(e.nodes(),(function(t){s(e.node(t))})),i.forEach(e.edges(),(function(t){s(e.edge(t))}))}function s(e){var t=e.width;e.width=e.height,e.height=t}function r(e){e.y=-e.y}function o(e){var t=e.x;e.x=e.y,e.y=t}e.exports={adjust:function(e){var t=e.graph().rankdir.toLowerCase();"lr"!==t&&"rl"!==t||n(e)},undo:function(e){var t=e.graph().rankdir.toLowerCase();"bt"!==t&&"rl"!==t||function(e){i.forEach(e.nodes(),(function(t){r(e.node(t))})),i.forEach(e.edges(),(function(t){var a=e.edge(t);i.forEach(a.points,r),i.has(a,"y")&&r(a)}))}(e);"lr"!==t&&"rl"!==t||(!function(e){i.forEach(e.nodes(),(function(t){o(e.node(t))})),i.forEach(e.edges(),(function(t){var a=e.edge(t);i.forEach(a.points,o),i.has(a,"x")&&o(a)}))}(e),n(e))}}},function(e,t,a){"use strict";var i=a(80),n=a(582),s=a(583),r=a(584),o=a(588),l=a(589),c=a(113).Graph,d=a(102);function u(e,t,a){return i.map(t,(function(t){return o(e,t,a)}))}function p(e,t){var a=new c;i.forEach(e,(function(e){var n=e.graph().root,s=r(e,n,a,t);i.forEach(s.vs,(function(t,a){e.node(t).order=a})),l(e,a,s.vs)}))}function m(e,t){i.forEach(t,(function(t){i.forEach(t,(function(t,a){e.node(t).order=a}))}))}e.exports=function(e){var t=d.maxRank(e),a=u(e,i.range(1,t+1),"inEdges"),r=u(e,i.range(t-1,-1,-1),"outEdges"),o=n(e);m(e,o);for(var l,c=Number.POSITIVE_INFINITY,b=0,h=0;h<4;++b,++h){p(b%2?a:r,b%4>=2),o=d.buildLayerMatrix(e);var f=s(e,o);f<c&&(h=0,l=i.cloneDeep(o),c=f)}m(e,l)}},function(e,t,a){"use strict";var i=a(80);e.exports=function(e){var t={},a=i.filter(e.nodes(),(function(t){return!e.children(t).length})),n=i.max(i.map(a,(function(t){return e.node(t).rank}))),s=i.map(i.range(n+1),(function(){return[]}));var r=i.sortBy(a,(function(t){return e.node(t).rank}));return i.forEach(r,(function a(n){if(i.has(t,n))return;t[n]=!0;var r=e.node(n);s[r.rank].push(n),i.forEach(e.successors(n),a)})),s}},function(e,t,a){"use strict";var i=a(80);function n(e,t,a){for(var n=i.zipObject(a,i.map(a,(function(e,t){return t}))),s=i.flatten(i.map(t,(function(t){return i.sortBy(i.map(e.outEdges(t),(function(t){return{pos:n[t.w],weight:e.edge(t).weight}})),"pos")})),!0),r=1;r<a.length;)r<<=1;var o=2*r-1;r-=1;var l=i.map(new Array(o),(function(){return 0})),c=0;return i.forEach(s.forEach((function(e){var t=e.pos+r;l[t]+=e.weight;for(var a=0;t>0;)t%2&&(a+=l[t+1]),l[t=t-1>>1]+=e.weight;c+=e.weight*a}))),c}e.exports=function(e,t){for(var a=0,i=1;i<t.length;++i)a+=n(e,t[i-1],t[i]);return a}},function(e,t,a){var i=a(80),n=a(585),s=a(586),r=a(587);e.exports=function e(t,a,o,l){var c=t.children(a),d=t.node(a),u=d?d.borderLeft:void 0,p=d?d.borderRight:void 0,m={};u&&(c=i.filter(c,(function(e){return e!==u&&e!==p})));var b=n(t,c);i.forEach(b,(function(a){if(t.children(a.v).length){var n=e(t,a.v,o,l);m[a.v]=n,i.has(n,"barycenter")&&(s=a,r=n,i.isUndefined(s.barycenter)?(s.barycenter=r.barycenter,s.weight=r.weight):(s.barycenter=(s.barycenter*s.weight+r.barycenter*r.weight)/(s.weight+r.weight),s.weight+=r.weight))}var s,r}));var h=s(b,o);!function(e,t){i.forEach(e,(function(e){e.vs=i.flatten(e.vs.map((function(e){return t[e]?t[e].vs:e})),!0)}))}(h,m);var f=r(h,l);if(u&&(f.vs=i.flatten([u,f.vs,p],!0),t.predecessors(u).length)){var g=t.node(t.predecessors(u)[0]),j=t.node(t.predecessors(p)[0]);i.has(f,"barycenter")||(f.barycenter=0,f.weight=0),f.barycenter=(f.barycenter*f.weight+g.order+j.order)/(f.weight+2),f.weight+=2}return f}},function(e,t,a){var i=a(80);e.exports=function(e,t){return i.map(t,(function(t){var a=e.inEdges(t);if(a.length){var n=i.reduce(a,(function(t,a){var i=e.edge(a),n=e.node(a.v);return{sum:t.sum+i.weight*n.order,weight:t.weight+i.weight}}),{sum:0,weight:0});return{v:t,barycenter:n.sum/n.weight,weight:n.weight}}return{v:t}}))}},function(e,t,a){"use strict";var i=a(80);e.exports=function(e,t){var a={};return i.forEach(e,(function(e,t){var n=a[e.v]={indegree:0,in:[],out:[],vs:[e.v],i:t};i.isUndefined(e.barycenter)||(n.barycenter=e.barycenter,n.weight=e.weight)})),i.forEach(t.edges(),(function(e){var t=a[e.v],n=a[e.w];i.isUndefined(t)||i.isUndefined(n)||(n.indegree++,t.out.push(a[e.w]))})),function(e){var t=[];function a(e){return function(t){t.merged||(i.isUndefined(t.barycenter)||i.isUndefined(e.barycenter)||t.barycenter>=e.barycenter)&&function(e,t){var a=0,i=0;e.weight&&(a+=e.barycenter*e.weight,i+=e.weight);t.weight&&(a+=t.barycenter*t.weight,i+=t.weight);e.vs=t.vs.concat(e.vs),e.barycenter=a/i,e.weight=i,e.i=Math.min(t.i,e.i),t.merged=!0}(e,t)}}function n(t){return function(a){a.in.push(t),0==--a.indegree&&e.push(a)}}for(;e.length;){var s=e.pop();t.push(s),i.forEach(s.in.reverse(),a(s)),i.forEach(s.out,n(s))}return i.map(i.filter(t,(function(e){return!e.merged})),(function(e){return i.pick(e,["vs","i","barycenter","weight"])}))}(i.filter(a,(function(e){return!e.indegree})))}},function(e,t,a){var i=a(80),n=a(102);function s(e,t,a){for(var n;t.length&&(n=i.last(t)).i<=a;)t.pop(),e.push(n.vs),a++;return a}e.exports=function(e,t){var a=n.partition(e,(function(e){return i.has(e,"barycenter")})),r=a.lhs,o=i.sortBy(a.rhs,(function(e){return-e.i})),l=[],c=0,d=0,u=0;r.sort((p=!!t,function(e,t){return e.barycenter<t.barycenter?-1:e.barycenter>t.barycenter?1:p?t.i-e.i:e.i-t.i})),u=s(l,o,u),i.forEach(r,(function(e){u+=e.vs.length,l.push(e.vs),c+=e.barycenter*e.weight,d+=e.weight,u=s(l,o,u)}));var p;var m={vs:i.flatten(l,!0)};d&&(m.barycenter=c/d,m.weight=d);return m}},function(e,t,a){var i=a(80),n=a(113).Graph;e.exports=function(e,t,a){var s=function(e){var t;for(;e.hasNode(t=i.uniqueId("_root")););return t}(e),r=new n({compound:!0}).setGraph({root:s}).setDefaultNodeLabel((function(t){return e.node(t)}));return i.forEach(e.nodes(),(function(n){var o=e.node(n),l=e.parent(n);(o.rank===t||o.minRank<=t&&t<=o.maxRank)&&(r.setNode(n),r.setParent(n,l||s),i.forEach(e[a](n),(function(t){var a=t.v===n?t.w:t.v,s=r.edge(a,n),o=i.isUndefined(s)?0:s.weight;r.setEdge(a,n,{weight:e.edge(t).weight+o})})),i.has(o,"minRank")&&r.setNode(n,{borderLeft:o.borderLeft[t],borderRight:o.borderRight[t]}))})),r}},function(e,t,a){var i=a(80);e.exports=function(e,t,a){var n,s={};i.forEach(a,(function(a){for(var i,r,o=e.parent(a);o;){if((i=e.parent(o))?(r=s[i],s[i]=o):(r=n,n=o),r&&r!==o)return void t.setEdge(r,o);o=i}}))}},function(e,t,a){"use strict";var i=a(80),n=a(102),s=a(591).positionX;e.exports=function(e){(function(e){var t=n.buildLayerMatrix(e),a=e.graph().ranksep,s=0;i.forEach(t,(function(t){var n=i.max(i.map(t,(function(t){return e.node(t).height})));i.forEach(t,(function(t){e.node(t).y=s+n/2})),s+=n+a}))})(e=n.asNonCompoundGraph(e)),i.forEach(s(e),(function(t,a){e.node(a).x=t}))}},function(e,t,a){"use strict";var i=a(80),n=a(113).Graph,s=a(102);function r(e,t){var a={};return i.reduce(t,(function(t,n){var s=0,r=0,o=t.length,c=i.last(n);return i.forEach(n,(function(t,d){var u=function(e,t){if(e.node(t).dummy)return i.find(e.predecessors(t),(function(t){return e.node(t).dummy}))}(e,t),p=u?e.node(u).order:o;(u||t===c)&&(i.forEach(n.slice(r,d+1),(function(t){i.forEach(e.predecessors(t),(function(i){var n=e.node(i),r=n.order;!(r<s||p<r)||n.dummy&&e.node(t).dummy||l(a,i,t)}))})),r=d+1,s=p)})),n})),a}function o(e,t){var a={};function n(t,n,s,r,o){var c;i.forEach(i.range(n,s),(function(n){c=t[n],e.node(c).dummy&&i.forEach(e.predecessors(c),(function(t){var i=e.node(t);i.dummy&&(i.order<r||i.order>o)&&l(a,t,c)}))}))}return i.reduce(t,(function(t,a){var s,r=-1,o=0;return i.forEach(a,(function(i,l){if("border"===e.node(i).dummy){var c=e.predecessors(i);c.length&&(s=e.node(c[0]).order,n(a,o,l,r,s),o=l,r=s)}n(a,o,a.length,s,t.length)})),a})),a}function l(e,t,a){if(t>a){var i=t;t=a,a=i}var n=e[t];n||(e[t]=n={}),n[a]=!0}function c(e,t,a){if(t>a){var n=t;t=a,a=n}return i.has(e[t],a)}function d(e,t,a,n){var s={},r={},o={};return i.forEach(t,(function(e){i.forEach(e,(function(e,t){s[e]=e,r[e]=e,o[e]=t}))})),i.forEach(t,(function(e){var t=-1;i.forEach(e,(function(e){var l=n(e);if(l.length){l=i.sortBy(l,(function(e){return o[e]}));for(var d=(l.length-1)/2,u=Math.floor(d),p=Math.ceil(d);u<=p;++u){var m=l[u];r[e]===e&&t<o[m]&&!c(a,e,m)&&(r[m]=e,r[e]=s[e]=s[m],t=o[m])}}}))})),{root:s,align:r}}function u(e,t,a,s,r){var o={},l=function(e,t,a,s){var r=new n,o=e.graph(),l=function(e,t,a){return function(n,s,r){var o,l=n.node(s),c=n.node(r),d=0;if(d+=l.width/2,i.has(l,"labelpos"))switch(l.labelpos.toLowerCase()){case"l":o=-l.width/2;break;case"r":o=l.width/2}if(o&&(d+=a?o:-o),o=0,d+=(l.dummy?t:e)/2,d+=(c.dummy?t:e)/2,d+=c.width/2,i.has(c,"labelpos"))switch(c.labelpos.toLowerCase()){case"l":o=c.width/2;break;case"r":o=-c.width/2}return o&&(d+=a?o:-o),o=0,d}}(o.nodesep,o.edgesep,s);return i.forEach(t,(function(t){var n;i.forEach(t,(function(t){var i=a[t];if(r.setNode(i),n){var s=a[n],o=r.edge(s,i);r.setEdge(s,i,Math.max(l(e,t,n),o||0))}n=t}))})),r}(e,t,a,r),c=r?"borderLeft":"borderRight";function d(e,t){for(var a=l.nodes(),i=a.pop(),n={};i;)n[i]?e(i):(n[i]=!0,a.push(i),a=a.concat(t(i))),i=a.pop()}return d((function(e){o[e]=l.inEdges(e).reduce((function(e,t){return Math.max(e,o[t.v]+l.edge(t))}),0)}),l.predecessors.bind(l)),d((function(t){var a=l.outEdges(t).reduce((function(e,t){return Math.min(e,o[t.w]-l.edge(t))}),Number.POSITIVE_INFINITY),i=e.node(t);a!==Number.POSITIVE_INFINITY&&i.borderType!==c&&(o[t]=Math.max(o[t],a))}),l.successors.bind(l)),i.forEach(s,(function(e){o[e]=o[a[e]]})),o}function p(e,t){return i.minBy(i.values(t),(function(t){var a=Number.NEGATIVE_INFINITY,n=Number.POSITIVE_INFINITY;return i.forIn(t,(function(t,i){var s=function(e,t){return e.node(t).width}(e,i)/2;a=Math.max(t+s,a),n=Math.min(t-s,n)})),a-n}))}function m(e,t){var a=i.values(t),n=i.min(a),s=i.max(a);i.forEach(["u","d"],(function(a){i.forEach(["l","r"],(function(r){var o,l=a+r,c=e[l];if(c!==t){var d=i.values(c);(o="l"===r?n-i.min(d):s-i.max(d))&&(e[l]=i.mapValues(c,(function(e){return e+o})))}}))}))}function b(e,t){return i.mapValues(e.ul,(function(a,n){if(t)return e[t.toLowerCase()][n];var s=i.sortBy(i.map(e,n));return(s[1]+s[2])/2}))}e.exports={positionX:function(e){var t,a=s.buildLayerMatrix(e),n=i.merge(r(e,a),o(e,a)),l={};i.forEach(["u","d"],(function(s){t="u"===s?a:i.values(a).reverse(),i.forEach(["l","r"],(function(a){"r"===a&&(t=i.map(t,(function(e){return i.values(e).reverse()})));var r=("u"===s?e.predecessors:e.successors).bind(e),o=d(e,t,n,r),c=u(e,t,o.root,o.align,"r"===a);"r"===a&&(c=i.mapValues(c,(function(e){return-e}))),l[s+a]=c}))}));var c=p(e,l);return m(l,c),b(l,e.graph().align)},findType1Conflicts:r,findType2Conflicts:o,addConflict:l,hasConflict:c,verticalAlignment:d,horizontalCompaction:u,alignCoordinates:m,findSmallestWidthAlignment:p,balance:b}},function(e,t,a){var i=a(80),n=a(102),s=a(113).Graph;e.exports={debugOrdering:function(e){var t=n.buildLayerMatrix(e),a=new s({compound:!0,multigraph:!0}).setGraph({});return i.forEach(e.nodes(),(function(t){a.setNode(t,{label:t}),a.setParent(t,"layer"+e.node(t).rank)})),i.forEach(e.edges(),(function(e){a.setEdge(e.v,e.w,{},e.name)})),i.forEach(t,(function(e,t){var n="layer"+t;a.setNode(n,{rank:"same"}),i.reduce(e,(function(e,t){return a.setEdge(e,t,{style:"invis"}),t}))})),a}}},function(e,t){e.exports="0.8.5"},function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMiIgaGVpZ2h0PSIzMiIgdmlld0JveD0iMCAwIDMyIDMyIiBmaWxsPSIjMzQzNzQxIj4KICA8cGF0aCBkPSJNNi45OTk4NSAxNnY1LjAwMDJIOS4wMzc5QzkuMDEyOCAyMS4zMzAxIDkgMjEuNjYzNiA5IDIyYzAgLjMzNjQuMDEyOC42Njk5LjAzNzkuOTk5OEg2Ljk5OTg1VjI4aC0xLjk5OTd2LTUuMDAwMkgwdi0xLjk5OTZoNS4wMDAxNVYxNmgxLjk5OTd6bTAtMTZ2NS4wMDAxNUgxMnYxLjk5OTdINi45OTk4NVYxMmgtMS45OTk3VjYuOTk5ODVIMHYtMS45OTk3aDUuMDAwMTVWMGgxLjk5OTd6TTIyLjk5OTggMHY1LjAwMDE1SDI4djEuOTk5N2gtNS4wMDAyVjkuMDM3OUMyMi42Njk5IDkuMDEyOCAyMi4zMzY0IDkgMjIgOWMtLjMzNjQgMC0uNjY5OS4wMTI4LS45OTk4LjAzNzlWNi45OTk4NUgxNnYtMS45OTk3aDUuMDAwMlYwaDEuOTk5NnoiIC8+CiAgICA8cGF0aAogICAgICBmaWxsPSIjMDE3RDczIgogICAgICBkPSJNMjIgMTBjMy4wNzM0IDAgNS44NzcgMS4xNTU0IDggMy4wNTU2djMuMjUyNWMtLjMxNS0uNDQyNy0uNjY4Mi0uODYxMy0xLjA1NzUtMS4yNTA2LTEuODQxMy0xLjg0MTMtNC4zMzg2LTIuODc1Ny02Ljk0MjUtMi44NzU3LTUuNDIyNCAwLTkuODE4MiA0LjM5NTgtOS44MTgyIDkuODE4MiAwIDMuMzAwMSAxLjYyODIgNi4yMTk5IDQuMTI1MSA4aC0zLjI1MTNDMTEuMTU1NCAyNy44NzcgMTAgMjUuMDczNCAxMCAyMmMwLTYuNjI3NCA1LjM3MjYtMTIgMTItMTJ6bS45OTk4IDh2My4wMDAySDI2djEuOTk5NmgtMy4wMDAyVjI2aC0xLjk5OTZ2LTMuMDAwMkgxOHYtMS45OTk2aDMuMDAwMlYxOGgxLjk5OTZ6IgogICAgLz4KPC9zdmc+Cg=="},function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMiIgaGVpZ2h0PSIzMiIgdmlld0JveD0iMCAwIDMyIDMyIiBmaWxsPSIjMzQzNzQxIj4KICAgIDxwYXRoIGQ9Ik0yIDEydjZoNnYySDB2LThoMnptMTggMHY4aC04di0yaDZ2LTZoMnpNOCAwdjJIMnY2SDBWMGg4em0xMiAwdjhoLTJWMmgtNlYwaDh6IiAvPgogICAgPHBhdGgKICAgICAgZmlsbD0iIzAxN0Q3MyIKICAgICAgZD0iTTE2IDI0YzIuMjA5MSAwIDQgMS43OTA5IDQgNCAwIDIuMjA5MS0xLjc5MDkgNC00IDQtMi4yMDkxIDAtNC0xLjc5MDktNC00IDAtMi4yMDkxIDEuNzkwOS00IDQtNHptMTIgMGMyLjIwOTEgMCA0IDEuNzkwOSA0IDQgMCAyLjIwOTEtMS43OTA5IDQtNCA0LTIuMjA5MSAwLTQtMS43OTA5LTQtNCAwLTIuMjA5MSAxLjc5MDktNCA0LTR6bS0xMiAxLjc1Yy0xLjI0MjYgMC0yLjI1IDEuMDA3NC0yLjI1IDIuMjVzMS4wMDc0IDIuMjUgMi4yNSAyLjI1IDIuMjUtMS4wMDc0IDIuMjUtMi4yNS0xLjAwNzQtMi4yNS0yLjI1LTIuMjV6bTEyIDBjLTEuMjQyNiAwLTIuMjUgMS4wMDc0LTIuMjUgMi4yNXMxLjAwNzQgMi4yNSAyLjI1IDIuMjUgMi4yNS0xLjAwNzQgMi4yNS0yLjI1LTEuMDA3NC0yLjI1LTIuMjUtMi4yNXpNMjggMTJjMi4yMDkxIDAgNCAxLjc5MDkgNCA0IDAgMi4yMDkxLTEuNzkwOSA0LTQgNC0yLjIwOTEgMC00LTEuNzkwOS00LTQgMC0yLjIwOTEgMS43OTA5LTQgNC00em0wIDEuNzVjLTEuMjQyNiAwLTIuMjUgMS4wMDc0LTIuMjUgMi4yNXMxLjAwNzQgMi4yNSAyLjI1IDIuMjUgMi4yNS0xLjAwNzQgMi4yNS0yLjI1LTEuMDA3NC0yLjI1LTIuMjUtMi4yNXpNMTAgNmMyLjIwOTEgMCA0IDEuNzkwODYgNCA0IDAgMi4yMDkxLTEuNzkwOSA0LTQgNC0yLjIwOTE0IDAtNC0xLjc5MDktNC00IDAtMi4yMDkxNCAxLjc5MDg2LTQgNC00em0wIDEuNzVjLTEuMjQyNjQgMC0yLjI1IDEuMDA3MzYtMi4yNSAyLjI1IDAgMS4yNDI2IDEuMDA3MzYgMi4yNSAyLjI1IDIuMjUgMS4yNDI2IDAgMi4yNS0xLjAwNzQgMi4yNS0yLjI1IDAtMS4yNDI2NC0xLjAwNzQtMi4yNS0yLjI1LTIuMjV6IgogICAgLz4KPC9zdmc+Cg=="},function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMiIgaGVpZ2h0PSIzMiIgdmlld0JveD0iMCAwIDMyIDMyIiBmaWxsPSIjMzQzNzQxIj4KICA8cGF0aCBkPSJNMjQgMGM0LjQxODMgMCA4IDMuNTgxNzIgOCA4IDAgMi4xMjE3LS44NDI5IDQuMTU2Ni0yLjM0MzEgNS42NTY5QzI4LjE1NjYgMTUuMTU3MSAyNi4xMjE3IDE2IDI0IDE2Yy0xLjg0ODcgMC0zLjU1MDktLjYyNzEtNC45MDU2LTEuNjgwMWwtNC43NzQ1IDQuNzc0NUMxNS4zNzI5IDIwLjQ0OTEgMTYgMjIuMTUxMyAxNiAyNGMwIDIuMTIxNy0uODQyOSA0LjE1NjYtMi4zNDMxIDUuNjU2OUMxMi4xNTY2IDMxLjE1NzEgMTAuMTIxNyAzMiA4IDMyYy00LjQxODI4IDAtOC0zLjU4MTctOC04czMuNTgxNzItOCA4LThjMS44NDg3MiAwIDMuNTUxLjYyNzEgNC45MDU3IDEuNjgwMmw0Ljc3NDUtNC43NzQ1QzE2LjYyNzEgMTEuNTUxIDE2IDkuODQ4NzIgMTYgOGMwLTQuNDE4MjggMy41ODE3LTggOC04ek04IDE4Yy0zLjMxMzcxIDAtNiAyLjY4NjMtNiA2czIuNjg2MjkgNiA2IDZjMy4zMTM3IDAgNi0yLjY4NjMgNi02IDAtMS41OTEzLS42MzIxLTMuMTE3NC0xLjc1NzQtNC4yNDI2QzExLjExNzQgMTguNjMyMSA5LjU5MTMgMTggOCAxOHpNMjQgMmMtMy4zMTM3IDAtNiAyLjY4NjI5LTYgNiAwIDMuMzEzNyAyLjY4NjMgNiA2IDZzNi0yLjY4NjMgNi02YzAtMS41OTEzLS42MzIxLTMuMTE3NDItMS43NTc0LTQuMjQyNjRDMjcuMTE3NCAyLjYzMjE0IDI1LjU5MTMgMiAyNCAyeiIvPgogIDxwYXRoIGZpbGw9IiMwMTdENzMiICBkPSJNMzIgMjB2MTJIMjBWMjBoMTJ6bS0yIDJoLTh2OGg4di04ek0xMiAwdjEySDBWMGgxMnptLTIgMkgydjhoOFYyeiIvPgo8L3N2Zz4K"},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a(47),n=a(15),s=i.__importDefault(a(598)),r=a(600);t.default=function(e,t){void 0===e&&(e=1/0),void 0===t&&(t=1/0);var a=s.default({width:r.isClient?window.innerWidth:e,height:r.isClient?window.innerHeight:t}),i=a[0],o=a[1];return n.useEffect((function(){if(r.isClient){var e=function(){o({width:window.innerWidth,height:window.innerHeight})};return window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}}),[]),i}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a(47),n=a(15),s=i.__importDefault(a(599));t.default=function(e){var t=n.useRef(0),a=n.useState(e),i=a[0],r=a[1],o=n.useCallback((function(e){cancelAnimationFrame(t.current),t.current=requestAnimationFrame((function(){r(e)}))}),[]);return s.default((function(){cancelAnimationFrame(t.current)})),[i,o]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a(47),n=a(15),s=i.__importDefault(a(227));t.default=function(e){var t=n.useRef(e);t.current=e,s.default((function(){return function(){return t.current()}}))}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isDeepEqual=t.off=t.on=t.isClient=void 0;var i=a(47).__importDefault(a(601));t.isClient="object"==typeof window,t.on=function(e){for(var t=[],a=1;a<arguments.length;a++)t[a-1]=arguments[a];return e.addEventListener.apply(e,t)},t.off=function(e){for(var t=[],a=1;a<arguments.length;a++)t[a-1]=arguments[a];return e.removeEventListener.apply(e,t)},t.isDeepEqual=i.default},function(e,t,a){"use strict";e.exports=function e(t,a){if(t===a)return!0;if(t&&a&&"object"==typeof t&&"object"==typeof a){if(t.constructor!==a.constructor)return!1;var i,n,s;if(Array.isArray(t)){if((i=t.length)!=a.length)return!1;for(n=i;0!=n--;)if(!e(t[n],a[n]))return!1;return!0}if(t.constructor===RegExp)return t.source===a.source&&t.flags===a.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===a.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===a.toString();if((i=(s=Object.keys(t)).length)!==Object.keys(a).length)return!1;for(n=i;0!=n--;)if(!Object.prototype.hasOwnProperty.call(a,s[n]))return!1;for(n=i;0!=n--;){var r=s[n];if(("_owner"!==r||!t.$$typeof)&&!e(t[r],a[r]))return!1}return!0}return t!=t&&a!=a}},function(e,t,a){switch(window.__kbnThemeTag__){case"v7dark":return a(603);case"v7light":return a(605);case"v8dark":return a(607);case"v8light":return a(609)}},function(e,t,a){var i=a(68),n=a(604);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var s={insert:"head",singleton:!1};i(n,s);e.exports=n.locals||{}},function(e,t,a){(t=a(69)(!1)).push([e.i,".mlScatterplotMatrix{overflow-x:auto}.mlScatterplotMatrix .vega-bind span{font-size:12px;padding:0 4px}\n",""]),e.exports=t},function(e,t,a){var i=a(68),n=a(606);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var s={insert:"head",singleton:!1};i(n,s);e.exports=n.locals||{}},function(e,t,a){(t=a(69)(!1)).push([e.i,".mlScatterplotMatrix{overflow-x:auto}.mlScatterplotMatrix .vega-bind span{font-size:12px;padding:0 4px}\n",""]),e.exports=t},function(e,t,a){var i=a(68),n=a(608);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var s={insert:"head",singleton:!1};i(n,s);e.exports=n.locals||{}},function(e,t,a){(t=a(69)(!1)).push([e.i,".mlScatterplotMatrix{overflow-x:auto}.mlScatterplotMatrix .vega-bind span{font-size:12px;padding:0 4px}\n",""]),e.exports=t},function(e,t,a){var i=a(68),n=a(610);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var s={insert:"head",singleton:!1};i(n,s);e.exports=n.locals||{}},function(e,t,a){(t=a(69)(!1)).push([e.i,".mlScatterplotMatrix{overflow-x:auto}.mlScatterplotMatrix .vega-bind span{font-size:12px;padding:0 4px}\n",""]),e.exports=t},function(e,t,a){var i=a(68),n=a(612);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var s={insert:"head",singleton:!1};i(n,s);e.exports=n.locals||{}},function(e,t,a){(t=a(69)(!1)).push([e.i,".mlExpandableSection{padding:0 8px 8px 8px}.mlExpandableSection-contentPadding{padding:8px}[id^='echTooltipPortal']{z-index:9000 !important}\n",""]),e.exports=t},function(e,t,a){var i=a(68),n=a(614);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var s={insert:"head",singleton:!1};i(n,s);e.exports=n.locals||{}},function(e,t,a){(t=a(69)(!1)).push([e.i,".mlExpandableSection{padding:0 8px 8px 8px}.mlExpandableSection-contentPadding{padding:8px}[id^='echTooltipPortal']{z-index:9000 !important}\n",""]),e.exports=t},function(e,t,a){var i=a(68),n=a(616);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var s={insert:"head",singleton:!1};i(n,s);e.exports=n.locals||{}},function(e,t,a){(t=a(69)(!1)).push([e.i,".mlExpandableSection{padding:0 8px 8px 8px}.mlExpandableSection-contentPadding{padding:8px}[id^='echTooltipPortal']{z-index:9000 !important}\n",""]),e.exports=t},function(e,t,a){var i=a(68),n=a(618);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var s={insert:"head",singleton:!1};i(n,s);e.exports=n.locals||{}},function(e,t,a){(t=a(69)(!1)).push([e.i,".mlExpandableSection{padding:0 8px 8px 8px}.mlExpandableSection-contentPadding{padding:8px}[id^='echTooltipPortal']{z-index:9000 !important}\n",""]),e.exports=t},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a(15),n=a(620);t.default=function(e,t){var a=n.useFirstMountState();i.useEffect((function(){if(!a)return e()}),t)}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useFirstMountState=void 0;var i=a(15);t.useFirstMountState=function(){var e=i.useRef(!0);return e.current?(e.current=!1,!0):e.current}},function(e,t,a){switch(window.__kbnThemeTag__){case"v7dark":return a(622);case"v7light":return a(624);case"v8dark":return a(626);case"v8light":return a(628)}},function(e,t,a){var i=a(68),n=a(623);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var s={insert:"head",singleton:!1};i(n,s);e.exports=n.locals||{}},function(e,t,a){(t=a(69)(!1)).push([e.i,".mlDataFrameAnalyticsClassification{width:100%}.mlDataFrameAnalyticsClassification__evaluateSectionContent{padding:0 5%}.mlDataFrameAnalyticsClassification__evaluateSectionContent:after{content:'';display:table;clear:both}.mlDataFrameAnalyticsClassification__actualLabel{float:left;width:80px;padding-top:64px}.mlDataFrameAnalyticsClassification__dataGridMinWidth{float:left;min-width:480px;width:calc(100% - 80px)}.mlDataFrameAnalyticsClassification__dataGridMinWidth .euiDataGridRowCell--boolean{text-transform:none}.mlDataFrameAnalyticsClassification__evaluationMetrics{width:60%}\n",""]),e.exports=t},function(e,t,a){var i=a(68),n=a(625);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var s={insert:"head",singleton:!1};i(n,s);e.exports=n.locals||{}},function(e,t,a){(t=a(69)(!1)).push([e.i,".mlDataFrameAnalyticsClassification{width:100%}.mlDataFrameAnalyticsClassification__evaluateSectionContent{padding:0 5%}.mlDataFrameAnalyticsClassification__evaluateSectionContent:after{content:'';display:table;clear:both}.mlDataFrameAnalyticsClassification__actualLabel{float:left;width:80px;padding-top:64px}.mlDataFrameAnalyticsClassification__dataGridMinWidth{float:left;min-width:480px;width:calc(100% - 80px)}.mlDataFrameAnalyticsClassification__dataGridMinWidth .euiDataGridRowCell--boolean{text-transform:none}.mlDataFrameAnalyticsClassification__evaluationMetrics{width:60%}\n",""]),e.exports=t},function(e,t,a){var i=a(68),n=a(627);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var s={insert:"head",singleton:!1};i(n,s);e.exports=n.locals||{}},function(e,t,a){(t=a(69)(!1)).push([e.i,".mlDataFrameAnalyticsClassification{width:100%}.mlDataFrameAnalyticsClassification__evaluateSectionContent{padding:0 5%}.mlDataFrameAnalyticsClassification__evaluateSectionContent:after{content:'';display:table;clear:both}.mlDataFrameAnalyticsClassification__actualLabel{float:left;width:80px;padding-top:64px}.mlDataFrameAnalyticsClassification__dataGridMinWidth{float:left;min-width:480px;width:calc(100% - 80px)}.mlDataFrameAnalyticsClassification__dataGridMinWidth .euiDataGridRowCell--boolean{text-transform:none}.mlDataFrameAnalyticsClassification__evaluationMetrics{width:60%}\n",""]),e.exports=t},function(e,t,a){var i=a(68),n=a(629);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var s={insert:"head",singleton:!1};i(n,s);e.exports=n.locals||{}},function(e,t,a){(t=a(69)(!1)).push([e.i,".mlDataFrameAnalyticsClassification{width:100%}.mlDataFrameAnalyticsClassification__evaluateSectionContent{padding:0 5%}.mlDataFrameAnalyticsClassification__evaluateSectionContent:after{content:'';display:table;clear:both}.mlDataFrameAnalyticsClassification__actualLabel{float:left;width:80px;padding-top:64px}.mlDataFrameAnalyticsClassification__dataGridMinWidth{float:left;min-width:480px;width:calc(100% - 80px)}.mlDataFrameAnalyticsClassification__dataGridMinWidth .euiDataGridRowCell--boolean{text-transform:none}.mlDataFrameAnalyticsClassification__evaluationMetrics{width:60%}\n",""]),e.exports=t},function(e,t,a){switch(window.__kbnThemeTag__){case"v7dark":return a(631);case"v7light":return a(633);case"v8dark":return a(635);case"v8light":return a(637)}},function(e,t,a){var i=a(68),n=a(632);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var s={insert:"head",singleton:!1};i(n,s);e.exports=n.locals||{}},function(e,t,a){(t=a(69)(!1)).push([e.i,".mlHelpPopover__panel{max-width:480px}.mlHelpPopover__content{scrollbar-color:rgba(152,162,179,0.5) rgba(0,0,0,0);scrollbar-width:thin;height:100%;overflow-y:auto;overflow-x:hidden;-webkit-mask-image:linear-gradient(to bottom, rgba(255,0,0,0.1) 0%,red 7.5px,red calc(100% - 7.5px),rgba(255,0,0,0.1) 100%);mask-image:linear-gradient(to bottom, rgba(255,0,0,0.1) 0%,red 7.5px,red calc(100% - 7.5px),rgba(255,0,0,0.1) 100%);max-height:40vh;padding:8px}.mlHelpPopover__content::-webkit-scrollbar{width:16px;height:16px}.mlHelpPopover__content::-webkit-scrollbar-thumb{background-color:rgba(152,162,179,0.5);background-clip:content-box;border-radius:16px;border:6px solid rgba(0,0,0,0)}.mlHelpPopover__content::-webkit-scrollbar-corner,.mlHelpPopover__content::-webkit-scrollbar-track{background-color:rgba(0,0,0,0)}.mlHelpPopover__content:focus{outline:none}.mlHelpPopover__content[tabindex='0']:focus:focus-visible{outline-style:auto}\n",""]),e.exports=t},function(e,t,a){var i=a(68),n=a(634);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var s={insert:"head",singleton:!1};i(n,s);e.exports=n.locals||{}},function(e,t,a){(t=a(69)(!1)).push([e.i,".mlHelpPopover__panel{max-width:480px}.mlHelpPopover__content{scrollbar-color:rgba(105,112,125,0.5) rgba(0,0,0,0);scrollbar-width:thin;height:100%;overflow-y:auto;overflow-x:hidden;-webkit-mask-image:linear-gradient(to bottom, rgba(255,0,0,0.1) 0%,red 7.5px,red calc(100% - 7.5px),rgba(255,0,0,0.1) 100%);mask-image:linear-gradient(to bottom, rgba(255,0,0,0.1) 0%,red 7.5px,red calc(100% - 7.5px),rgba(255,0,0,0.1) 100%);max-height:40vh;padding:8px}.mlHelpPopover__content::-webkit-scrollbar{width:16px;height:16px}.mlHelpPopover__content::-webkit-scrollbar-thumb{background-color:rgba(105,112,125,0.5);background-clip:content-box;border-radius:16px;border:6px solid rgba(0,0,0,0)}.mlHelpPopover__content::-webkit-scrollbar-corner,.mlHelpPopover__content::-webkit-scrollbar-track{background-color:rgba(0,0,0,0)}.mlHelpPopover__content:focus{outline:none}.mlHelpPopover__content[tabindex='0']:focus:focus-visible{outline-style:auto}\n",""]),e.exports=t},function(e,t,a){var i=a(68),n=a(636);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var s={insert:"head",singleton:!1};i(n,s);e.exports=n.locals||{}},function(e,t,a){(t=a(69)(!1)).push([e.i,".mlHelpPopover__panel{max-width:480px}.mlHelpPopover__content{scrollbar-color:rgba(152,162,179,0.5) rgba(0,0,0,0);scrollbar-width:thin;height:100%;overflow-y:auto;overflow-x:hidden;-webkit-mask-image:linear-gradient(to bottom, rgba(255,0,0,0.1) 0%,red 7.5px,red calc(100% - 7.5px),rgba(255,0,0,0.1) 100%);mask-image:linear-gradient(to bottom, rgba(255,0,0,0.1) 0%,red 7.5px,red calc(100% - 7.5px),rgba(255,0,0,0.1) 100%);max-height:40vh;padding:8px}.mlHelpPopover__content::-webkit-scrollbar{width:16px;height:16px}.mlHelpPopover__content::-webkit-scrollbar-thumb{background-color:rgba(152,162,179,0.5);background-clip:content-box;border-radius:16px;border:6px solid rgba(0,0,0,0)}.mlHelpPopover__content::-webkit-scrollbar-corner,.mlHelpPopover__content::-webkit-scrollbar-track{background-color:rgba(0,0,0,0)}.mlHelpPopover__content:focus{outline:none}.mlHelpPopover__content[tabindex='0']:focus:focus-visible{outline-style:auto}\n",""]),e.exports=t},function(e,t,a){var i=a(68),n=a(638);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var s={insert:"head",singleton:!1};i(n,s);e.exports=n.locals||{}},function(e,t,a){(t=a(69)(!1)).push([e.i,".mlHelpPopover__panel{max-width:480px}.mlHelpPopover__content{scrollbar-color:rgba(105,112,125,0.5) rgba(0,0,0,0);scrollbar-width:thin;height:100%;overflow-y:auto;overflow-x:hidden;-webkit-mask-image:linear-gradient(to bottom, rgba(255,0,0,0.1) 0%,red 7.5px,red calc(100% - 7.5px),rgba(255,0,0,0.1) 100%);mask-image:linear-gradient(to bottom, rgba(255,0,0,0.1) 0%,red 7.5px,red calc(100% - 7.5px),rgba(255,0,0,0.1) 100%);max-height:40vh;padding:8px}.mlHelpPopover__content::-webkit-scrollbar{width:16px;height:16px}.mlHelpPopover__content::-webkit-scrollbar-thumb{background-color:rgba(105,112,125,0.5);background-clip:content-box;border-radius:16px;border:6px solid rgba(0,0,0,0)}.mlHelpPopover__content::-webkit-scrollbar-corner,.mlHelpPopover__content::-webkit-scrollbar-track{background-color:rgba(0,0,0,0)}.mlHelpPopover__content:focus{outline:none}.mlHelpPopover__content[tabindex='0']:focus:focus-visible{outline-style:auto}\n",""]),e.exports=t},function(e,t,a){switch(window.__kbnThemeTag__){case"v7dark":return a(640);case"v7light":return a(642);case"v8dark":return a(644);case"v8light":return a(646)}},function(e,t,a){var i=a(68),n=a(641);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var s={insert:"head",singleton:!1};i(n,s);e.exports=n.locals||{}},function(e,t,a){(t=a(69)(!1)).push([e.i,".mlJobSelectorBar{padding:8px}.mlJobSelectorFlyoutBody>.euiFlyoutBody__overflow{padding-top:8px}.mlJobSelector__ganttBar{background-color:#79ADDA;height:12px;border-radius:2px}.mlJobSelector__ganttBarBackEdge{height:16px;border-left:1px solid #D6D6D6;border-right:1px solid #D6D6D6;margin-bottom:-14px;padding-top:8px}.mlJobSelector__ganttBarDashed{height:1px;border-top:1px dashed #D6D6D6}.mlJobSelector__ganttBarRunning{background-image:linear-gradient(45deg, rgba(255,255,255,0.15) 25%, transparent 25%, transparent 50%, rgba(255,255,255,0.15) 50%, rgba(255,255,255,0.15) 75%, transparent 75%, transparent);background-size:40px 40px;animation:progress-bar-stripes 2s linear infinite}\n",""]),e.exports=t},function(e,t,a){var i=a(68),n=a(643);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var s={insert:"head",singleton:!1};i(n,s);e.exports=n.locals||{}},function(e,t,a){(t=a(69)(!1)).push([e.i,".mlJobSelectorBar{padding:8px}.mlJobSelectorFlyoutBody>.euiFlyoutBody__overflow{padding-top:8px}.mlJobSelector__ganttBar{background-color:#79ADDA;height:12px;border-radius:2px}.mlJobSelector__ganttBarBackEdge{height:16px;border-left:1px solid #D6D6D6;border-right:1px solid #D6D6D6;margin-bottom:-14px;padding-top:8px}.mlJobSelector__ganttBarDashed{height:1px;border-top:1px dashed #D6D6D6}.mlJobSelector__ganttBarRunning{background-image:linear-gradient(45deg, rgba(255,255,255,0.15) 25%, transparent 25%, transparent 50%, rgba(255,255,255,0.15) 50%, rgba(255,255,255,0.15) 75%, transparent 75%, transparent);background-size:40px 40px;animation:progress-bar-stripes 2s linear infinite}\n",""]),e.exports=t},function(e,t,a){var i=a(68),n=a(645);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var s={insert:"head",singleton:!1};i(n,s);e.exports=n.locals||{}},function(e,t,a){(t=a(69)(!1)).push([e.i,".mlJobSelectorBar{padding:8px}.mlJobSelectorFlyoutBody>.euiFlyoutBody__overflow{padding-top:8px}.mlJobSelector__ganttBar{background-color:#79ADDA;height:12px;border-radius:2px}.mlJobSelector__ganttBarBackEdge{height:16px;border-left:1px solid #D6D6D6;border-right:1px solid #D6D6D6;margin-bottom:-14px;padding-top:8px}.mlJobSelector__ganttBarDashed{height:1px;border-top:1px dashed #D6D6D6}.mlJobSelector__ganttBarRunning{background-image:linear-gradient(45deg, rgba(255,255,255,0.15) 25%, transparent 25%, transparent 50%, rgba(255,255,255,0.15) 50%, rgba(255,255,255,0.15) 75%, transparent 75%, transparent);background-size:40px 40px;animation:progress-bar-stripes 2s linear infinite}\n",""]),e.exports=t},function(e,t,a){var i=a(68),n=a(647);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var s={insert:"head",singleton:!1};i(n,s);e.exports=n.locals||{}},function(e,t,a){(t=a(69)(!1)).push([e.i,".mlJobSelectorBar{padding:8px}.mlJobSelectorFlyoutBody>.euiFlyoutBody__overflow{padding-top:8px}.mlJobSelector__ganttBar{background-color:#79ADDA;height:12px;border-radius:2px}.mlJobSelector__ganttBarBackEdge{height:16px;border-left:1px solid #D6D6D6;border-right:1px solid #D6D6D6;margin-bottom:-14px;padding-top:8px}.mlJobSelector__ganttBarDashed{height:1px;border-top:1px dashed #D6D6D6}.mlJobSelector__ganttBarRunning{background-image:linear-gradient(45deg, rgba(255,255,255,0.15) 25%, transparent 25%, transparent 50%, rgba(255,255,255,0.15) 50%, rgba(255,255,255,0.15) 75%, transparent 75%, transparent);background-size:40px 40px;animation:progress-bar-stripes 2s linear infinite}\n",""]),e.exports=t},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a(15);t.default=function(e){var t=i.useRef();return i.useEffect((function(){t.current=e})),t.current}}])]);