/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.ml_bundle_jsonpfunction=window.ml_bundle_jsonpfunction||[]).push([[9,11],{188:function(e,t,o){"use strict";o.r(t),o.d(t,"AnomalyDetectorService",(function(){return AnomalyDetectorService}));var n=o(4),s=o.n(n),a=o(25),r=o(67);class AnomalyDetectorService{constructor(e){s()(this,"apiBasePath",Object(r.basePath)()+"/anomaly_detectors"),this.httpService=e}getJobById$(e){return this.httpService.http$({path:`${this.apiBasePath}/${e}`}).pipe(Object(a.map)((e=>e.jobs[0])))}getJobs$(e){return this.httpService.http$({path:`${this.apiBasePath}/${e.join(",")}`}).pipe(Object(a.map)((e=>e.jobs)))}extractInfluencers(e){Array.isArray(e)||(e=[e]);const t=new Set;for(const o of e)for(const e of o.analysis_config.influencers)t.add(e);return Array.from(t)}}},256:function(e,t,o){"use strict";o.d(t,"a",(function(){return j}));var n=o(21),s=o.n(n),a=o(25),r=o(23),i=o(15),c=o(189),l=o(42),u=o(247),p=o(55),b=o(250),d=o(11);const m=({selectedIds:e,withTimeRangeSelector:t,dateFormatTz:o,singleSelection:n,timeseriesOnly:s,onFlyoutClose:a,onSelectionConfirmed:r,maps:c})=>{const[l,u]=Object(i.useState)(!0);return Object(d.jsx)(b.b,{selectedIds:e,withTimeRangeSelector:t,dateFormatTz:o,singleSelection:n,timeseriesOnly:s,onFlyoutClose:a,onSelectionConfirmed:r,onTimeRangeConfigChange:u,applyTimeRangeConfig:l,maps:c})};async function j(e,t){const{http:o,uiSettings:n,application:{currentAppId$:i}}=e;return new Promise((async(b,j)=>{try{const h={groupsMap:Object(c.b)([]),jobsMap:{}},y=n.get("dateFormat:tz"),f="Browser"!==y?y:s.a.tz.guess(),S=()=>{v.close(),j()},g=async({jobIds:e,groups:t})=>{await v.close(),b({jobIds:e,groups:t})},v=e.overlays.openFlyout(Object(l.toMountPoint)(Object(d.jsx)(l.KibanaContextProvider,{services:{...e,mlServices:Object(u.getMlGlobalServices)(o)}},Object(d.jsx)(m,{selectedIds:t,withTimeRangeSelector:!1,dateFormatTz:f,singleSelection:!1,timeseriesOnly:!0,onFlyoutClose:S,onSelectionConfirmed:g,maps:h}))),{"data-test-subj":"mlFlyoutJobSelector",ownFocus:!0,closeButtonAriaLabel:"jobSelectorFlyout"});i.pipe(Object(a.takeUntil)(Object(r.from)(v.onClose))).subscribe((e=>{e!==p.DashboardConstants.DASHBOARDS_ID&&v.close()}))}catch(e){j(e)}}))}},755:function(e,t,o){"use strict";o.r(t),o.d(t,"resolveEmbeddableAnomalyChartsUserInput",(function(){return p}));o(15);var n=o(78),s=o(42),a=o(188),r=o(255),i=o(100),c=o(256),l=o(345),u=o(11);async function p(e,t){const{http:o,overlays:p}=e,b=new a.AnomalyDetectorService(new i.a(o));return new Promise((async(o,a)=>{try{var i;const{jobIds:d}=await Object(c.a)(e,null==t?void 0:t.jobIds),m=null!==(i=null==t?void 0:t.title)&&void 0!==i?i:Object(r.getDefaultExplorerChartsPanelTitle)(d),j=await b.getJobs$(d).toPromise();b.extractInfluencers(j).push(n.j);const h=p.openModal(Object(s.toMountPoint)(Object(u.jsx)(l.a,{defaultTitle:m,initialInput:t,onCreate:({panelTitle:e,maxSeriesToPlot:t})=>{h.close(),o({jobIds:d,title:e,maxSeriesToPlot:t})},onCancel:()=>{h.close(),a()}})))}catch(e){a(e)}}))}}}]);