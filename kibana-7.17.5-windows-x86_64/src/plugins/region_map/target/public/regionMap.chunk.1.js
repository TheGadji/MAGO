(window.regionMap_bundle_jsonpfunction=window.regionMap_bundle_jsonpfunction||[]).push([[1],{22:function(e,t,a){"use strict";var r,n=function(){return void 0===r&&(r=Boolean(window&&document&&document.all&&!window.atob)),r},i=function(){var e={};return function(t){if(void 0===e[t]){var a=document.querySelector(t);if(window.HTMLIFrameElement&&a instanceof window.HTMLIFrameElement)try{a=a.contentDocument.head}catch(e){a=null}e[t]=a}return e[t]}}(),s=[];function o(e){for(var t=-1,a=0;a<s.length;a++)if(s[a].identifier===e){t=a;break}return t}function c(e,t){for(var a={},r=[],n=0;n<e.length;n++){var i=e[n],c=t.base?i[0]+t.base:i[0],l=a[c]||0,h="".concat(c," ").concat(l);a[c]=l+1;var u=o(h),p={css:i[1],media:i[2],sourceMap:i[3]};-1!==u?(s[u].references++,s[u].updater(p)):s.push({identifier:h,updater:_(p,t),references:1}),r.push(h)}return r}function l(e){var t=document.createElement("style"),r=e.attributes||{};if(void 0===r.nonce){var n=a.nc;n&&(r.nonce=n)}if(Object.keys(r).forEach((function(e){t.setAttribute(e,r[e])})),"function"==typeof e.insert)e.insert(t);else{var s=i(e.insert||"head");if(!s)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");s.appendChild(t)}return t}var h,u=(h=[],function(e,t){return h[e]=t,h.filter(Boolean).join("\n")});function p(e,t,a,r){var n=a?"":r.media?"@media ".concat(r.media," {").concat(r.css,"}"):r.css;if(e.styleSheet)e.styleSheet.cssText=u(t,n);else{var i=document.createTextNode(n),s=e.childNodes;s[t]&&e.removeChild(s[t]),s.length?e.insertBefore(i,s[t]):e.appendChild(i)}}function d(e,t,a){var r=a.css,n=a.media,i=a.sourceMap;if(n?e.setAttribute("media",n):e.removeAttribute("media"),i&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),e.styleSheet)e.styleSheet.cssText=r;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(r))}}var f=null,m=0;function _(e,t){var a,r,n;if(t.singleton){var i=m++;a=f||(f=l(t)),r=p.bind(null,a,i,!1),n=p.bind(null,a,i,!0)}else a=l(t),r=d.bind(null,a,t),n=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(a)};return r(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;r(e=t)}else n()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=n());var a=c(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var r=0;r<a.length;r++){var n=o(a[r]);s[n].references--}for(var i=c(e,t),l=0;l<a.length;l++){var h=o(a[l]);0===s[h].references&&(s[h].updater(),s.splice(h,1))}a=i}}}},23:function(e,t,a){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var a=function(e,t){var a=e[1]||"",r=e[3];if(!r)return a;if(t&&"function"==typeof btoa){var n=(s=r,o=btoa(unescape(encodeURIComponent(JSON.stringify(s)))),c="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(o),"/*# ".concat(c," */")),i=r.sources.map((function(e){return"/*# sourceURL=".concat(r.sourceRoot||"").concat(e," */")}));return[a].concat(i).concat([n]).join("\n")}var s,o,c;return[a].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(a,"}"):a})).join("")},t.i=function(e,a,r){"string"==typeof e&&(e=[[null,e,""]]);var n={};if(r)for(var i=0;i<this.length;i++){var s=this[i][0];null!=s&&(n[s]=!0)}for(var o=0;o<e.length;o++){var c=[].concat(e[o]);r&&n[c[0]]||(a&&(c[2]?c[2]="".concat(a," and ").concat(c[2]):c[2]=a),t.push(c))}},t}},24:function(e,t,a){switch(window.__kbnThemeTag__){case"v7dark":return a(25);case"v7light":return a(27);case"v8dark":return a(29);case"v8light":return a(31)}},25:function(e,t,a){var r=a(22),n=a(26);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var i={insert:"head",singleton:!1};r(n,i);e.exports=n.locals||{}},26:function(e,t,a){(t=a(23)(!1)).push([e.i,".rgmChart__wrapper,.rgmChart{flex:1 1 0;display:flex}\n",""]),e.exports=t},27:function(e,t,a){var r=a(22),n=a(28);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var i={insert:"head",singleton:!1};r(n,i);e.exports=n.locals||{}},28:function(e,t,a){(t=a(23)(!1)).push([e.i,".rgmChart__wrapper,.rgmChart{flex:1 1 0;display:flex}\n",""]),e.exports=t},29:function(e,t,a){var r=a(22),n=a(30);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var i={insert:"head",singleton:!1};r(n,i);e.exports=n.locals||{}},30:function(e,t,a){(t=a(23)(!1)).push([e.i,".rgmChart__wrapper,.rgmChart{flex:1 1 0;display:flex}\n",""]),e.exports=t},31:function(e,t,a){var r=a(22),n=a(32);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var i={insert:"head",singleton:!1};r(n,i);e.exports=n.locals||{}},32:function(e,t,a){(t=a(23)(!1)).push([e.i,".rgmChart__wrapper,.rgmChart{flex:1 1 0;display:flex}\n",""]),e.exports=t},37:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return d}));var r=a(5),n=a(17),i=a(18),s=a(1),o=a(0),c=a(16);function l(e,t,a,r){if(!e)return"";const n=[];return a&&e&&n.push({label:a,value:e.term}),e&&n.push({label:r,value:t?t.convert(e.value,"text"):e.value}),n}var h=a(9),u=a(6);a(24);var p=a(3);const d=({deps:e,handlers:t,visData:d,visConfig:f})=>{const m=Object(r.useRef)(null),_=Object(r.useRef)(null),v=Object(r.useRef)(!0),y=t.uiState;Object(r.useEffect)((()=>{if(m.current&&v.current){v.current=!1;const r=function({regionmapsConfig:e,uiSettings:t,BaseMapsVisualization:r,getServiceSettings:n}){return class RegionMapsVisualization extends r{constructor(e,t,a){super(e,t,a),this._choroplethLayer=null,this._tooltipFormatter=Object(h.mapTooltipProvider)(e,l)}async render(e,t){Object(o.b)().loadFontAwesome(),await super.render(e,t),this._choroplethLayer&&await this._choroplethLayer.whenDataLoaded()}async _updateData(e){this._chartData=e;const t=this._params.bucket?e.columns[this._params.bucket.accessor]:null,a=e.columns[this._params.metric.accessor];let r;r=this._hasColumns()&&e.rows.length?e.rows.map((e=>({term:e[t.id],value:e[a.id]}))):[];const n=await this._loadConfig(this._params.selectedLayer);if(!this._params.selectedJoinField&&n&&(this._params.selectedJoinField=n.fields[0]),!n)return;await this._updateChoroplethLayerForNewMetrics(n.name,n.attribution,this._params.showAllShapes,r);const i=Object(o.a)().deserialize(this._params.metric.format);this._choroplethLayer.setMetrics(r,i,a.name),t&&a&&this._choroplethLayer.setTooltipFormatter(this._tooltipFormatter,i,t.name,a.name),this._kibanaMap.useUiStateFromVisualization(this.handlers.uiState)}async _loadConfig(t){const{escape:r}=await Promise.resolve().then(a.t.bind(null,18,7));if(t.isEMS||t.layerId&&t.layerId.startsWith(`${u.ORIGIN.EMS}.`)){const e=await n();return await e.loadFileLayerConfig(t)}const i=e.layers.find((e=>e.name===t.name));return i?{...i,attribution:r(i.attribution?i.attribution:"")}:null}async _updateParams(){await super._updateParams();const e=await this._loadConfig(this._params.selectedLayer);if(!this._params.selectedJoinField&&e&&(this._params.selectedJoinField=e.fields[0]),!this._params.selectedJoinField||!e)return;await this._updateChoroplethLayerForNewProperties(e.name,e.attribution,this._params.showAllShapes);const t=Object(o.a)().deserialize(this._params.metric.format);this._choroplethLayer.setJoinField(this._params.selectedJoinField.name),this._choroplethLayer.setColorRamp(c.truncatedColorMaps[this._params.colorSchema].value),this._choroplethLayer.setLineWeight(this._params.outlineWeight),this._choroplethLayer.setTooltipFormatter(this._tooltipFormatter,t,this._metricLabel)}async _updateChoroplethLayerForNewMetrics(e,t,a,r){this._choroplethLayer&&this._choroplethLayer.canReuseInstanceForNewMetrics(e,a,r)||await this._recreateChoroplethLayer(e,t,a)}async _updateChoroplethLayerForNewProperties(e,t,a){this._choroplethLayer&&this._choroplethLayer.canReuseInstance(e,a)||await this._recreateChoroplethLayer(e,t,a)}async _recreateChoroplethLayer(e,r,i){const c=await this._loadConfig(this._params.selectedLayer);if(this._kibanaMap.removeLayer(this._choroplethLayer),this._choroplethLayer)this._choroplethLayer=this._choroplethLayer.cloneChoroplethLayerForNewData(e,r,c.format,i,c.meta,c,await n(),(await Object(h.lazyLoadMapsLegacyModules)()).L);else{const{ChoroplethLayer:t}=await a.e(2).then(a.bind(null,36));this._choroplethLayer=new t(e,r,c.format,i,c.meta,c,await n(),(await Object(h.lazyLoadMapsLegacyModules)()).L)}this._choroplethLayer.on("select",(e=>{const{rows:t,columns:a}=this._chartData,r=t.findIndex((t=>t[a[0].id]===e));this.handlers.event({name:"filterBucket",data:{data:[{table:this._chartData,column:0,row:r,value:e}]}})})),this._choroplethLayer.on("styleChanged",(e=>{const a=this._params.isDisplayWarning&&t.get("visualization:regionmap:showWarnings");e.mismatches.length>0&&a&&Object(o.c)().toasts.addWarning({title:s.i18n.translate("regionMap.visualization.unableToShowMismatchesWarningTitle",{defaultMessage:"Unable to show {mismatchesLength} {oneMismatch, plural, one {result} other {results}} on map",values:{mismatchesLength:e.mismatches.length,oneMismatch:e.mismatches.length>1?0:1}}),text:s.i18n.translate("regionMap.visualization.unableToShowMismatchesWarningText",{defaultMessage:"Ensure that each of these term matches a shape on that shape's join field: {mismatches}",values:{mismatches:e.mismatches?e.mismatches.join(", "):""}})})})),this._kibanaMap.addLayer(this._choroplethLayer)}_hasColumns(){return this._chartData&&2===this._chartData.columns.length}}}(e);_.current=new r(m.current,t,f)}}),[e,t,f,d]),Object(r.useEffect)((()=>{var e;null===(e=_.current)||void 0===e||e.render(d,f).then(t.done)}),[d,f,t.done]),Object(r.useEffect)((()=>{const e=()=>{var e;null===(e=_.current)||void 0===e||e.render().then(t.done)};return null==y||y.on("change",e),()=>{null==y||y.off("change",e)}}),[y,t.done]),Object(r.useEffect)((()=>()=>{var e;null===(e=_.current)||void 0===e||e.destroy(),_.current=null}),[]);const g=Object(r.useMemo)((()=>Object(i.throttle)((()=>{var e;return null===(e=_.current)||void 0===e?void 0:e.resize()}),300)),[]);return Object(p.jsx)(n.EuiResizeObserver,{onResize:g},(e=>Object(p.jsx)("div",{className:"rgmChart__wrapper",ref:e},Object(p.jsx)("div",{className:"rgmChart",ref:m}))))}}}]);